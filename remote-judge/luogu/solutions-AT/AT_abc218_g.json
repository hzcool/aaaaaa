[
    {
        "content": "\u53d1\u73b0\u8fd9\u4e2a\u535a\u5f08\u662f\u5047\u7684\uff0c\u56e0\u4e3a $A$ \u4e00\u5b9a\u4f1a\u9009\u62e9\u5f53\u524d\u5b50\u6811\u4e2d\u6700\u5927\u7684\u4e00\u4e2a\uff0c\u800c $B$ \u4f1a\u9009\u62e9\u6700\u5c0f\u7684\u4e00\u4e2a\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u627e\u51fa\u53f6\u5b50\u8282\u70b9\u7684\u7b54\u6848\u3002\n\n\u8fd9\u4e2a\u53ef\u4ee5\u5728 $\\text{dfs} $ \u7684\u65f6\u5019\u7ef4\u62a4\u4e00\u4e0b\u8be5\u8282\u70b9\u5230\u6839\u4e0a\u9762\u6240\u6709\u70b9\u7684\u6743\u503c\uff0c\u4e2d\u4f4d\u6570\u53ef\u4ee5\u4e8c\u5206\u6c42\u3002\u79bb\u6563\u5316\u4e00\u4e0b\u5c31\u53ef\u4ee5\u76f4\u63a5\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u4e86\u3002\u5728\u56de\u6eaf\u65f6\u6e05\u7a7a\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n \\log^2 n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define vi vector<int>\n#define pii pair<int,int>\n#define pb(x) push_back(x)\n#define lowbit(x) x&-x\nusing namespace std;\nconst int N=1e5+10;\nstruct node{\n\tint to,nxt;\n}a[N<<1];\nstruct BIT{\n\tint d[N];\n\tinline void add(int x,int c){for(;x<N;x+=lowbit(x)) d[x]+=c;}\n\tinline int query(int x,int res=0){for(;x;x-=lowbit(x)) res+=d[x];return res;}\n}t;\nll ans;\nint n,m,T,w[N],b[N],head[N],cnt,f[N],dep[N];\ninline int read(){\n\tint s=0,f=0;\n\tchar ch=getchar();\n\twhile(ch>'9'||ch<'0') f|=(ch=='-'),ch=getchar();\n\twhile(ch<='9'&&ch>='0') s=(s<<3)+(s<<1)+(ch^48),ch=getchar();\n\treturn f?-s:s;\n}\ninline void add(int from,int to){\n\ta[++cnt]=(node){to,head[from]};\n\thead[from]=cnt;\n}\ninline void dfs(int x,int fa){\n\tdep[x]=dep[fa]+1;\n\tif(dep[x]&1) f[x]=0;\n\telse f[x]=1e9;\n\tbool flg=0;\n\tt.add(w[x],1);\n\tfor(register int i=head[x];i;i=a[i].nxt){\n\t\tint to=a[i].to;\n\t\tif(to==fa) continue;\n\t\tflg=1;\n\t\tdfs(to,x);\n\t\tif(dep[x]&1) f[x]=max(f[x],f[to]);\n\t\telse f[x]=min(f[x],f[to]);\n\t}\n\tif(!flg){\n\t\tint l=1,r=m;\n\t\twhile(l<r){\n\t\t\tint mid=(l+r)>>1;\n\t\t\tif(t.query(mid)>=(dep[x]+1)/2) r=mid;\n\t\t\telse l=mid+1;\n\t\t}\n\t\tif(dep[x]&1) f[x]=b[r];\n\t\telse{\n\t\t\tif(t.query(r)>dep[x]/2) f[x]=b[r];\n\t\t\telse{\n\t\t\t\tint k=r;\n\t\t\t\tl=r+1,r=m;\n\t\t\t\twhile(l<r){\n\t\t\t\t\tint mid=(l+r)>>1;\n\t\t\t\t\tif(t.query(mid)-t.query(k)) r=mid;\n\t\t\t\t\telse l=mid+1;\n\t\t\t\t}\n\t\t\t\tf[x]=(b[r]+b[k])/2;\n\t\t\t}\n\t\t}\n\t}\n\tt.add(w[x],-1);\n}\nint main(){\n\tn=read();\n\tfor(register int i=1;i<=n;++i) w[i]=read(),b[i]=w[i];\n\tsort(b+1,b+n+1);m=unique(b+1,b+n+1)-b-1;\n\tfor(register int i=1;i<=n;++i) w[i]=lower_bound(b+1,b+m+1,w[i])-b;\n\tfor(register int i=1;i<n;++i){\n\t\tint u=read(),v=read();\n\t\tadd(u,v),add(v,u);\n\t}\n\tdfs(1,0);\n\tcout<<f[1]<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1681277397,
        "uid": 428089,
        "name": "HMZHMZHMZ",
        "ccfLevel": 7,
        "title": "ABC218G"
    }
]
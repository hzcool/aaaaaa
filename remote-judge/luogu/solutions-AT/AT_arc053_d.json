[
    {
        "content": "[\u535a\u5ba2\u94fe\u63a5](https://www.cnblogs.com/Laoli-2020/p/16717848.html)\n\n\u9898\u610f\u7b80\u8ff0\uff1a\u7ed9\u5b9a\u4e24\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217 $A$ \u548c $B$\uff0c\u6309\u7167\u4e00\u4e0b\u65b9\u5f0f\u751f\u6210\u4e00\u4e2a\u957f\u5ea6\u4e3a $2n-2$ \u7684\u5e8f\u5217\uff1a\u4f60\u5bf9\u6bcf\u4e00\u4e2a\u6392\u5217\u5206\u522b\u505a $n-1$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u4e00\u6b21\u9009\u62e9\u4e00\u4e2a\u5e8f\u5217\u8fdb\u884c\u64cd\u4f5c\uff0c\u5220\u9664\u8be5\u6392\u5217\u7684\u7b2c\u4e00\u4e2a\u6570\uff0c\u5c06\u53e6\u4e00\u4e2a\u6392\u5217\u7b2c\u4e00\u4e2a\u6570\u52a0\u5165\u5e8f\u5217\uff0c\u95ee\u6700\u7ec8\u80fd\u5f97\u5230\u591a\u5c11\u79cd\u5e8f\u5217\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1 \\le n \\le 10^3$\u3002\n\n\u6709\u4e00\u4e2a\u5f88\u663e\u7136\u7684 dp\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u4fdd\u7559\u7b2c\u4e00\u4e2a\u6392\u5217\u4e2d\u7b2c $i$ \u5230 $n$ \u4e2a\u5143\u7d20\u548c\u7b2c\u4e8c\u4e2a\u6392\u5217\u4e2d\u7b2c $j$ \u5230 $n$ \u4e2a\u5143\u7d20\uff0c\u8fdb\u884c\u64cd\u4f5c\u76f4\u5230\u4e24\u4e2a\u5e8f\u5217\u7684\u957f\u5ea6\u90fd\u4e3a $1$\uff0c\u80fd\u5f97\u5230\u7684\u5e8f\u5217\u6570\u76ee\u3002\n\n\u8fd9\u4e2a dp \u6709\u4e00\u4e2a\u5f88 naive \u7684\u8f6c\u79fb\uff1a$f_{i,j}=f_{i+1,j}+f_{i,j+1}$\uff0c\u5373\u8981\u4e48\u64cd\u4f5c\u5e8f\u5217\u4e00\uff0c\u8981\u4e48\u64cd\u4f5c\u5e8f\u5217\u4e8c\uff0c\u5012\u5e8f\u679a\u4e3e\u8ba1\u7b97 $f$ \u6570\u7ec4\u5373\u53ef\u3002\n\n\u4f46\u662f\u8fd9\u6837\u8f6c\u79fb\u4f1a\u7b97\u91cd\uff0c\u6211\u4eec\u6765\u8003\u8651\u5982\u4f55\u53bb\u91cd\u3002\n\n\u9996\u5148\uff0c\u53ea\u6709 $A_i=B_j$ \u7684\u65f6\u5019\u624d\u4f1a\u7b97\u91cd\uff0c\u800c\u4e14 $f_{i.j}$ \u591a\u7b97\u7684\u90e8\u5206\u4e00\u5b9a\u662f $f_{i+1,j}$ \u548c $f_{i,j+1}$ \u4e2d\u76f8\u540c\u7684\u5e8f\u5217\u6570\u3002\n\n\u8bbe $g_{i,j,k}$ \u8868\u793a $f_{i+k,j}$ \u4e0e $f_{i,j+k}$ \u4e2d\u76f8\u540c\u7684\u5e8f\u5217\u6570\uff0c\u72b6\u6001\u6570 $n^3$ \u7ea7\u522b\uff0c\u663e\u7136\u4e0d\u884c\u3002\n\n\u4f46\u662f\u5bb9\u6613\u53d1\u73b0\uff0c\u53ea\u6709\u5f53 $A_i=B_j$ \u65f6\uff0c$g_{i,j,k}$ \u624d\u6709\u610f\u4e49\uff0c\u53c8\u7531\u4e8e\u5e8f\u5217 $A$ \u548c $B$ \u90fd\u662f\u6392\u5217\uff0c\u4e00\u4e2a $i$ \u552f\u4e00\u5bf9\u5e94\u4e00\u4e2a $j$\uff0c\u56e0\u6b64 $i$ \u548c $j$ \u4e2d\u53ea\u6709\u4e00\u4e2a\u9700\u8981\u8868\u793a\u8fdb\u72b6\u6001\uff0c\u5373\u8bb0 $g_{i,k}$ \u5373\u53ef\u3002\n\n\u8003\u8651\u8f6c\u79fb\uff0c\u9996\u5148\uff0c$g_{i,k}$ \u662f $f_{i+k,j}$ \u548c $f_{i,j+k}$ \u4e2d\u7684\u91cd\u590d\u5e8f\u5217\u6570\uff0c\u5176\u4e2d\u53ef\u80fd\u5904\u4e8e\u6b64\u65f6\u6392\u5217\u4e2d\u7684\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u7684\u6570\u53ea\u6709\u53ef\u80fd\u662f $a_i$\u3001$b_j$\u3001 $a_{i+k}$ \u548c $b_{j+k}$\uff0c\u5176\u4e2d\u53ef\u80fd\u76f8\u7b49\u7684\u6570\u5bf9\u53ea\u6709 $(a_i,b_j)$ \u548c $(a_{i+k},b_{j+k})$\u3002\n\n\u56e0\u6b64\u6709\u4e24\u79cd\u8f6c\u79fb\uff0c\u4e00\u79cd\u662f $f_{i+k,j}$ \u548c $f_{i,j+k}$ \u5206\u522b\u4ece $f_{i+k+1,j}$ \u548c $f_{i,j+k+1}$ \u8f6c\u79fb\u8fc7\u6765\uff0c\u5373 $g_{i,k} \\leftarrow g_{i,k+1}$ \uff0c\u6761\u4ef6\u662f $a_i=b_j$ \uff0c\u6839\u636e $g$ \u7684\u5b9a\u4e49\uff0c\u4e00\u5b9a\u6ee1\u8db3\u3002\n\n\u53e6\u4e00\u79cd\u662f $f_{i+k,j}$ \u548c $f_{i,j+k}$ \u5206\u522b\u4ece $f_{i+k,j+1}$ \u548c $f_{i+1,j+k}$ \u8f6c\u79fb\u8fc7\u6765\uff0c\u6761\u4ef6\u662f $a_{i+k}=b_{j+k}$\u3002\n\n\u4f46\u662f\u6ce8\u610f\uff0c\u7b2c\u4e8c\u79cd\u8f6c\u79fb\u4e0d\u80fd\u76f4\u63a5\u8ba4\u4e3a\u662f $g_{i,k} \\leftarrow g_{i+1,k-1}$\uff0c\u56e0\u4e3a $a_{i+1}$ \u548c $b_{j+1}$ \u4e0d\u4e00\u5b9a\u76f8\u7b49\uff0c\u8be5\u8f6c\u79fb\u7684\u6b63\u786e\u65b9\u5f0f\u5e94\u8be5\u4e3a $g_{i,k} \\leftarrow g_{i+k,1-k}$\u3002\n\n\u7531\u4e8e\u4e0a\u8ff0\u8f6c\u79fb\u4e2d\u7528\u5230\u4e86 $g_{i,k}(k \\le 0)$\uff0c\u56e0\u6b64 $k$ \u4e3a\u975e\u6b63\u6570\u7684 $g$ \u4e5f\u9700\u8981\u8ba1\u7b97\uff0c\u5176\u4e2d $g_{i,0}=f_{i,j}$ \uff0c$k$ \u4e3a\u8d1f\u6570\u7684\u8f6c\u79fb\u548c\u6b63\u6570\u4e00\u81f4\uff0c\u4f46\u662f\u8981\u6ce8\u610f\uff0c$g_{i,k}(k <0)$ \u7684\u8ba1\u7b97\u4e0d\u80fd\u5728\u5012\u5e8f\u679a\u4e3e\u5230 $i$ \u65f6\u8ba1\u7b97\uff0c\u800c\u5e94\u8be5\u5728\u679a\u4e3e\u5230 $i+k$ \u65f6\u8ba1\u7b97\uff0c\u56e0\u4e3a\u679a\u4e3e\u5230 $i$ \u65f6\uff0c$f_{i-k,j}$ \u8fd8\u6ca1\u6709\u88ab\u8ba1\u7b97\uff0c\u56e0\u6b64\u6b64\u65f6\u7684 $g_{i,k}$ \u8fd8\u6ca1\u6709\u610f\u4e49\u3002\n\n\u7136\u540e $f$ \u7684\u8f6c\u79fb\u5c31\u5f88\u7b80\u5355\u4e86\uff0c$f_{i,j}=f_{i+1,j}+f_{i,j+1}-[a_i=b_j]g_{i,1}$\uff0c\u521d\u503c\u4e3a $f_{n,n}=1$\u3002\n\n\u5012\u5e8f\u679a\u4e3e\u4e00\u4e0b\u8f6c\u79fb $f$ \u548c $g$ \u5373\u53ef\uff0c\u6ce8\u610f $g_{i,k}(k > 0)$ \u8981\u5728 $f_{i,j}$ \u4e4b\u524d\u8ba1\u7b97\uff0c\u56e0\u4e3a $f$ \u7684\u8f6c\u79fb\u4f1a\u7528\u5230\uff0c$g_{i,0}$ \u8981\u5728 $f_{i,j}$ \u4e4b\u540e\u8ba1\u7b97\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4ece $f_{i,j}$ \u8f6c\u79fb\u8fc7\u6765\u3002\n\nCode\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1000000007;\nint n,a[1005],b[1005];\nint f[1005][1005];\nmap<int,int> g[1005];\nint id1[1005],id2[1005];\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%d\",&a[i]),id1[a[i]]=i;\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%d\",&b[i]),id2[b[i]]=i;//\u8bb0\u53cc\u5c04\uff0c\u65b9\u4fbf\u67e5\u8be2\u4e0e a[i] \u76f8\u540c\u7684 b[j]\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tint k=id2[a[i]];\n\t\tfor(int j=n-max(i,k);j>=1;j--)//\u8ba1\u7b97g[i][j](j>0)\n\t\t{\n\t\t\tg[i][j]=g[i][j+1];\n\t\t\tif(a[i+j]==b[k+j])\n\t\t\t\tg[i][j]=(g[i][j]+g[i+j][1-j])%mod;\n\t\t}\n\t\tfor(int j=-1;j>=-n;j--)//\u8ba1\u7b97g[i-j][j](j<0)\n\t\t{\n\t\t\tif(i-j>n)\n\t\t\t\tbreak;\n\t\t\tint k=id2[a[i-j]];\n\t\t\tg[i-j][j]=g[i-j][j+1];\n\t\t\tif(a[i]==b[k+j])\n\t\t\t\tg[i-j][j]=(g[i-j][j]+g[i][1-j])%mod;\n\t\t}\n\t\tfor(int j=n;j>=1;j--)//\u8ba1\u7b97f[i][j]\n\t\t{\n\t\t\tif(i+j==2*n)\n\t\t\t\tf[i][j]=1;\n\t\t\telse\n\t\t\t{\n\t\t\t\tf[i][j]=(f[i+1][j]+f[i][j+1])%mod;\n\t\t\t\tif(a[i]==b[j])\n\t\t\t\t\tf[i][j]=(f[i][j]-g[i][1]+mod)%mod;\n\t\t}\n\t\tg[i][0]=f[i][k];//\u8ba1\u7b97g[i][0]\n\t}\n\tprintf(\"%d\\n\",f[1][1]);\n\t\n\treturn 0;\n}\n```",
        "postTime": 1663805552,
        "uid": 104711,
        "name": "\u6211\u6253",
        "ccfLevel": 0,
        "title": "2 \u3064\u306e\u5c71\u672d\u9898\u89e3"
    },
    {
        "content": "\u76f4\u63a5\u6c42\u89e3\u6bd4\u8f83\u9ebb\u70e6\uff0c\u8003\u8651\u5c06\u95ee\u9898\u8fdb\u884c\u8f6c\u5316\u3002\n\n\u8bbe\u5e8f\u5217$a = \\{3, 1, 4, 2, 5\\}, b = \\{3, 2, 4, 1, 5\\}$\uff0c\u90a3\u4e48\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u6b63\u65b9\u5f62\u65b9\u683c\uff0c\u5c06$a$\u653e\u5728\u6a2a\u884c\uff0c$b$\u653e\u5728\u7ad6\u884c\uff0c\u53ef\u4ee5\u753b\u51fa\u4e0b\u56fe\u3002\n\n![](https://i.loli.net/2019/07/06/5d20109f0058322756.png)\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u65b9\u6848\u6570\u5c31\u662f\u4ece\u5de6\u4e0a\u8d70\u5230\u53f3\u4e0b\u7684\u4e0d\u540c\u5e8f\u5217\u4e2a\u6570\u3002\n\n\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5$\\texttt{d}\\texttt{p}$\uff0c\u8bbe$f[i][j]$\u8868\u793a\u8d70\u5230$(i, j)$\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u663e\u7136$f[i][j] = f[i - 1][j] + f[i][j - 1]$\u3002\n\n\u4e0d\u8fc7\u8fd9\u6837\u8f6c\u79fb\u53d1\u73b0\u6709\u91cd\u590d\u3002\u8003\u8651\u5230$a_i = b_j$\u662f$f[i][j]$\u51fa\u73b0\u91cd\u590d\u7684\u5fc5\u8981\u6761\u4ef6\uff0c\u901a\u8fc7\u63a8\u5bfc\u53ef\u4ee5\u5f97\u51fa\u65b9\u7a0b\uff1a$f[i][j] = f[i][j - 1] + f[i - 1][j] + [a_i = b_j]\\sum_{k \\geq 1}[a_{i - k} = b_{j - k}]f[i - k][j - k]\\mathrm{C}(t - 1)$\uff0c\u5176\u4e2d$\\mathrm{C}$\u8868\u793a\u5361\u7279\u5170\u6570\uff0c$t$\u8868\u793a$1$\u5230$k$\u4e4b\u95f4\u6709\u591a\u5c11\u4e2a$l$\u6ee1\u8db3$a_l = b_l$\u3002\n\n\u7531\u4e8e$a_i = b_j$\u53ea\u6709$n$\u5bf9\uff0c\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\mathrm{O}(n ^ 2)$\u3002\n\n\u4ee3\u7801\u89c1\u6211\u7684[$\\texttt{blog}$](https://www.cnblogs.com/cj-xxz/p/11142101.html)",
        "postTime": 1562383406,
        "uid": 46800,
        "name": "xgzc",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 AT1879 \u30102 \u3064\u306e\u5c71\u672d\u3011"
    }
]
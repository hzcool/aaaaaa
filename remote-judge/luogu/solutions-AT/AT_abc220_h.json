[
    {
        "content": "\u62a2\u4e00\u4e2a\u6b64\u9898\u9996\u53d1\u9898\u89e3\u3002\n\n\u9996\u5148\u8f6c\u6210\u8865\u56fe\uff0c\u53d8\u6210\u53d6\u4e00\u4e2a\u5bfc\u51fa\u5b50\u56fe\uff0c\u90a3\u4e48\u73b0\u5728\u8981\u6c42\u70b9\u96c6\u5185\u8fb9\u7684\u5947\u5076\u6027\u548c $M$ \u4e00\u81f4\u3002\n\n\u628a $N$ \u4e2a\u70b9\u5e73\u5747\u5206\u6210\u4e24\u90e8\u5206\uff0c\u5206\u522b\u6c42\u51fa $f(S),g(T)$ \u8868\u793a\u5de6\u4fa7\u7684 $S$ \u70b9\u96c6\u4e0e\u53f3\u4fa7\u70b9\u96c6 $T$ \u5185\u8fb9\u6570\u5947\u5076\u6027\u3002\n\n\u73b0\u5728\u8003\u8651\u62fc\u63a5\u4e24\u4e2a\u96c6\u5408 $S,T$\uff0c\u53d1\u73b0\u4f1a\u6709\u82e5\u5e72\u8de8\u8fc7\u53bb\u7684\u8fb9\u3002\u679a\u4e3e\u5de6\u4fa7\u96c6\u5408 $S$\uff0c\u8bbe $S$ \u5ef6\u4f38\u5230\u53f3\u4fa7\u7684\u82e5\u5e72\u8fb9\u7684\u53e6\u4e00\u7aef\u70b9\u6784\u6210\u96c6\u5408\u4e3a $T_0$\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e\u8981\u5728\u53f3\u4fa7\u9009\u51fa\u4e00\u4e2a $T$\uff0c\u8fd9\u4e2a\u70b9\u96c6 $S\\cup T$ \u7684\u5bfc\u51fa\u5b50\u56fe\u5185\u7684\u8fb9\u6570\u5947\u5076\u6027\u5c31\u662f $f(S)\\text{ xor }g(T)\\text{ xor }x$\uff0c\u5176\u4e2d $x$ \u4e3a $S$ \u5ef6\u4f38\u8fc7\u53bb\u7684\u8fb9\u6570\u7684\u5947\u5076\u6027\u3002\n\n\u6211\u4eec\u4ed4\u7ec6\u60f3\u4e00\u4e0b\u8fd9\u4e2a\u5ef6\u4f38\u8fc7\u53bb\u7684\u8fb9\u6570\u5230\u5e95\u662f\u5565\uff0c\u53d1\u73b0\u53ea\u6709 $T_0$ \u4e2d\u4e0e $S$ \u4e2d\u8fde\u8fb9\u4e2a\u6570\u4e3a\u5947\u6570\u7684\u70b9\u80fd\u9020\u6210\u8d21\u732e\u3002\u8bbe $c(S)$ \u8868\u793a\u6240\u6709\u6ee1\u8db3 $x$ \u5230 $S$ \u4e2d\u8fde\u8fb9\u4e2a\u6570\u4e3a\u5947\u6570\u7684\u70b9\u6784\u6210\u7684\u96c6\u5408\uff0c\u90a3\u4e48\u8de8\u8d8a\u4e24\u7aef\u7684\u8fb9\u6570\u7684\u5947\u5076\u6027\u5c31\u662f $\\text{popcount}(c(S)\\text{ and }T)$ \u7684\u5947\u5076\u6027\u3002\n\n\u770b\u7740\u5c31\u5f88\u50cf FWT \u5bf9\u5427\uff01\u5957\u8def\u5730\u628a\u8fd9\u4e2a\u5947\u5076\u6027\u53d8\u4e3a $\\frac{1}{2}(1+(-1)^{\\text{popcount}(c(S)\\text{ and }T)})$\uff0c\u7136\u540e\u5c31\u6210\u529f\u51d1\u51fa\u4e86 FWT \u7684\u5f62\u5f0f\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u6309\u7167 $f,g$ \u7684\u5947\u5076\u6027\u5206\u6210\u56db\u7c7b\uff0c\u4ee5 $f(S)=0$ \u7684 $S$ \u4e3a\u4f8b\uff0c\u9996\u5148\u6c42\u51fa $h(S)$ \u8868\u793a\u6ee1\u8db3 $c(S_0)=S$ \u7684 $S_0$ \u4e2a\u6570\uff0c\u90a3\u4e48\u5bf9\u4e8e\u53f3\u4fa7\u7684 $T$\uff0c\u6839\u636e $g(T)$ \u7684\u503c\u5c31\u53ef\u4ee5\u77e5\u9053\u6211\u4eec\u60f3\u8981\u7684 $\\text{popcount}(c(S)\\text{ and }T)$ \u7684\u5947\u5076\u6027\u3002\n\n\u5982\u679c\u60f3\u8981 $\\text{popcount}(c(S)\\text{ and }T)$ \u4e3a\u5076\u6570\uff0c\u90a3\u4e48\u5de6\u4fa7\u80fd\u548c $T$ \u62fc\u4e0a\u7684 $S$ \u7684\u6570\u76ee\u5c31\u662f\n$$\n\\begin{aligned}\\text{ans}(T)&=\\sum_{f(S)=0}\\frac{1+(-1)^{\\text{popcount}(c(S)\\text{ and }T)}}{2}\\\\&=\\frac{1}{2}\\left(\\sum_{f(S)=0}1+\\sum_{S}h(S)(-1)^{\\text{popcount}(S\\text{ and }T)}\\right)=\\dfrac{1}{2}\\left(\\text{FWT}(h)[T]+\\sum_{f(S)=0}1\\right)\\end{aligned}\n$$\n\u53d1\u73b0\u53ea\u9700\u8981\u7ed9 $h$ \u505a\u4e00\u4e2a FWT \u5c31\u53ef\u4ee5\u4e86\u3002\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(N2^{N/2})$\u3002\n\n\u6700\u540e\u6765\u70b9\u79d1\u6280\uff0c127 \u5728\u8bfe\u4e0a\u8bf4\u672c\u9898\u53ef\u4ee5\u5728 $O\\left(\\frac{N^3}{w}\\right)$ \u65f6\u95f4\u5185[\u5f97\u5230\u89e3\u51b3](https://atcoder.jp/contests/abc220/submissions/27805654)\u3002\u4f46\u662f\u5230\u5e95\u600e\u4e48\u505a\u7684\u6211\u5b9e\u5728\u662f\u6ca1\u542c\u61c2\u3002\n\n```cpp\n#include<bits/stdc++.h>\n\n#define int long long\n#define yunqian 114514\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\tfor(;(c<'0'||c>'9');c=getchar()){if(c=='-')f=-1;}\n\tfor(;(c>='0'&&c<='9');c=getchar())x=x*10+(c&15);\n\treturn x*f;\n}\n\nconst int N=20;\nvector<int>f,g,h;\nint pc[1<<N],St[1<<N],st[1<<N],G[N][N];\n\nvoid FMT(vector<int>&A,int k){\n\tfor(int i=0;i<k;i++){\n\t\tfor(int S=0;S<(1<<k);S++)if(S&(1<<i))A[S]^=A[S^(1<<i)];\n\t}\n}\nvoid FWT(vector<int>&A,int k){\n\tfor(int i=0;i<k;i++){\n\t\tfor(int S=0;S<(1<<k);S++){\n\t\t\tif(!(S&(1<<i)))continue;\n\t\t\tint x=A[S^(1<<i)],y=A[S];\n\t\t\tA[S]=x-y,A[S^(1<<i)]=x+y;\n\t\t}\n\t}\n}\n\nint n,m;\n\nsigned main(void){\n\n#ifdef YUNQIAN\n\tfreopen(\"in.in\",\"r\",stdin);\n#endif\n\n\tn=read(),m=read();\n\tint L=(int)(n/2),R=n-L;\n\tf.resize(1<<L),g.resize(1<<R),h.resize(1<<R);\n\tfor(int i=1;i<=m;i++){\n\t\tint u=read()-1,v=read()-1;\n\t\tif(v<L)f[(1<<u)|(1<<v)]^=1;\n\t\telse{\n\t\t\tv-=L;\n\t\t\tif(u<L)G[u][v]^=1;\n\t\t\telse u-=L,g[(1<<u)|(1<<v)]^=1;\n\t\t}\n\t}\n\tFMT(f,L),FMT(g,R);\n\tfor(int i=0;i<L;i++){\n\t\tfor(int j=0;j<R;j++)if(G[i][j])St[1<<i]|=(1<<j);\n\t}\n\tfor(int S=1;S<(1<<L);S++)if(__builtin_popcount(S)>1)St[S]=(St[S^(S&(-S))]^St[S&(-S)]);\n\t\n\tint ans=0,cnt=0,pm=(m&1);\n\t\n\tfor(int S=0;S<(1<<L);S++){\n\t\tif(f[S]==0)h[St[S]]++,cnt++;\n\t}\n\tFWT(h,R);\n\tfor(int S=0;S<(1<<R);S++){\n\t\tif(g[S]==pm)ans+=(cnt+h[S])/2;\n\t\telse ans+=(cnt-h[S])/2;\n\t}\n\t\n\tfor(int S=0;S<(1<<R);S++)h[S]=0;cnt=0;\n\tfor(int S=0;S<(1<<L);S++){\n\t\tif(f[S]==1)h[St[S]]++,cnt++;\n\t}\n\tFWT(h,R);\n\tfor(int S=0;S<(1<<R);S++){\n\t\tif(g[S]!=pm)ans+=(cnt+h[S])/2;\n\t\telse ans+=(cnt-h[S])/2;\n\t}\n\t\n\tcout<<ans<<endl;\n\n\treturn 0;\n}\n```",
        "postTime": 1685015857,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "Security Camera"
    }
]
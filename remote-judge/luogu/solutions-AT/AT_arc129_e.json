[
    {
        "content": "\u770b\u6570\u636e\u8303\u56f4\uff0c\u4e00\u773c $N^M$ \u4f46\u662f\u65e0\u6cd5\u5b9e\u73b0\u3002\u90a3\u8fd9\u4e48\u70b9\u7684\u6570\u636e\u8303\u56f4\u5c31\u53ef\u80fd\u662f\u7f51\u7edc\u6d41\u4e86\u3002\n\n\u5148\u770b $\\mid x_i-x_j\\mid\\times W_{i,j}$ \u90a3\u90e8\u5206\u7684\u4ee3\u4ef7\u3002\u7edd\u5bf9\u503c\u6309\u5957\u8def\u5bb9\u6613\u60f3\u5230\u6392\u5e8f\u540e\u6309\u5927\u5c0f\u6c42\uff0c\u628a\u6240\u6709\u6743\u503c\u7cca\u4e00\u5757\u663e\u7136\u662f\u4e0d\u884c\u7684\uff0c\u8003\u8651\u5982\u4f55\u8868\u793a\u6bcf\u4e2a $x_i<x_j$ \u7684\u4ee3\u4ef7\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u4e00\u5bf9 $A_i,A_j$\uff0c\u628a\u4ed6\u4eec\u7684\u53d6\u503c\u90fd\u653e\u5230\u4e00\u4e2a\u6570\u8f74\u4e0a\u4e00\u70b9\uff0c\u4ece\u5c0f\u5230\u5927\u7b2c $i$ \u4e2a\u70b9\u7684\u503c\u8bb0\u4e3a $a_i$\u3002\u7edd\u5bf9\u503c\u5c31\u662f\u67d0\u4e24\u4e2a\u70b9\u8fde\u7ebf\u7684\u8ddd\u79bb\u3002\u53d1\u73b0\u90a3\u4e9b\u8fde\u7ebf\u672c\u8d28\u4e0a\u662f\u6570\u8f74\u4e0a\u82e5\u5e72\u4e2a\u8fde\u7eed**\u70b9\u7684\u7a7a\u9699**\u7684\u7ed3\u5408\u3002\n\n\u4e8e\u662f\u5bf9\u7edd\u5bf9\u503c\u6362\u4e00\u79cd\u7406\u89e3\u3002\u5bf9\u4e8e\u4e24\u4e2a\u6574\u6570 $x,y\\,(x\\leq y)$\uff0c\u4ed6\u4eec\u7684\u7edd\u5bf9\u503c\u662f\uff1a\u6ee1\u8db3 $x\\leq a<y$ \u7684\u6574\u6570 $a$ \u7684\u6570\u91cf\u3002\n\n\u518d\u5bf9\u6bcf\u4e2a\u7a7a\u9699\u8003\u8651\u3002\u5982\u679c $A_i,A_j$ \u7684\u53d6\u5230\u7684\u4e24\u4e2a\u503c\u5206\u522b\u5728\u8fd9\u4e2a\u7a7a\u9699\u4e24\u8fb9\u7684\u8bdd\uff0c\u7a7a\u9699\u5185\u7684\u6574\u6570\u5c31\u4f1a\u4f5c\u51fa\u8d21\u732e\u3002\n\n\u518d\u628a\u95ee\u9898\u7528\u7f51\u7edc\u6d41\u8868\u793a\u51fa\u6765\u3002\u7528\u6700\u5c0f\u5272\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u5148\u5bf9\u4e8e\u6bcf\u4e2a\u6570\u6709\u4e00\u6761\u8def\u5f84 $S=V_{i,0}\\to V_{i,1}\\to \\cdots V_{i,m}=T$\uff0c\u5bf9\u6bcf\u4e2a $V_{i,j} \\to V_{i,j-1}\\,(j>0)$ \u8fde\u4e00\u6761\u6d41\u91cf $\\infty$ \u7684\u8fb9\uff0c\u4f7f\u5f97\u6bcf\u6761\u8def\u5f84\u90fd\u662f\u5de6\u8fb9\u5206\u5230 $S$\uff0c\u53f3\u8fb9\u5206\u5230 $T$\u3002\u518d\u5bf9\u6bcf\u4e2a $V_{i,j-1} \\to V_{i,j}\\,(j>0)$ \u8fde\u4e00\u6761\u6d41\u91cf $C_{i,j}$ \u7684\u8fb9\uff0c\u8868\u793a\u53d6\u8fd9\u4e2a\u503c\u7684\u8d39\u7528\u3002\n\n\u679a\u4e3e\u6bcf\u4e2a $1\\leq i<j\\leq n$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7a7a\u9699 $(a_k,a_{k-1})$\uff0c\u5148\u627e\u5230\u6700\u540e\u4e00\u4e2a\u5c0f\u4e8e\u7b49\u4e8e\u5b83 $A_{i,x}$ \u518d\u627e\u5230\u7b2c\u4e00\u4e2a\u5927\u4e8e\u5b83\u7684 $A_{j,y}$ \u5f53 $A_i$ \u7684\u53d6\u503c $p\\leq x$ \u5e76\u4e14 $A_j$ \u7684\u53d6\u503c $q\\geq y$ \u65f6\uff0c\u8fd9\u4e2a\u7a7a\u9699\u4f1a\u4ea7\u751f\u4ee3\u4ef7\u3002\u8fde $V_{j,y-1} \\to V_{i,x}$ \u6d41\u91cf $(a_k-a_{k-1})\\times W_{i,j}$ \u7684\u8fb9\uff0c\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u7a7a\u9699\u7684\u4ee3\u4ef7\u5728\u6700\u5c0f\u5272\u4e2d\u8868\u793a\u51fa\u6765\u3002\u8fd9\u662f $A_{i,x}<A_{j,y}$ \u7684\u60c5\u51b5\uff0c$A_{i,x}>A_{j,y}$ \u65f6\u540c\u7406\u3002\u53ef\u4ee5\u53cc\u6307\u9488\u7ef4\u62a4\uff0c\u4e5f\u53ef\u4ee5\u66b4\u529b\u626b\uff0c\u590d\u6742\u5ea6\u74f6\u9888\u4e0d\u5728\u8fd9\u3002\n\n\u70b9\u6570 $O(NM)$\uff0c\u8fb9\u6570 $O(N^2M)$\uff0c\u7528 Dinic \u8dd1\u590d\u6742\u5ea6\u662f $O(N^4M^3)$ \u7684\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\nconst int maxn=253,maxe=1e6+3;\nstruct{int to,next;ll c;}e[maxe];\nint len=1,head[maxn];\ninline void insert(int u,int v,ll c){\n\te[++len].to=v,e[len].c=c,e[len].next=head[u],head[u]=len;\n\te[++len].to=u,e[len].c=0,e[len].next=head[v],head[v]=len;\n}\nint S,T,dep[maxn],now[maxn];\ninline bool bfs(){\n\tmemset(dep,0,sizeof(dep));\n\tstatic int q[maxn];int l=1,r=1;\n\tdep[q[r]=S]=1,now[S]=head[S];\n\twhile(l<=r){\n\t\tint u=q[l++];\n\t\tfor(reg i=head[u],v;i;i=e[i].next)\n\t\t\tif(e[i].c&&!dep[v=e[i].to]){\n\t\t\t\tdep[q[++r]=v]=dep[u]+1,now[v]=head[v];\n\t\t\t\tif(v==T)return true;\n\t\t\t}\n\t}\n\treturn false;\n}\ninline ll dfs(int u,ll flow){\n\tif(u==T||!flow)return flow;\n\tll rest=flow,k;\n\tfor(reg i=head[u],v;i;now[u]=i=e[i].next)\n\t\tif(e[i].c&&dep[v=e[i].to]==dep[u]+1){\n\t\t\tk=dfs(v,min(rest,e[i].c));\n\t\t\tif(!k)dep[v]=0;\n\t\t\te[i].c-=k,e[i^1].c+=k,rest-=k;\n\t\t\tif(!rest)break;\n\t\t}\n\treturn flow-rest;\n}\ninline ll Dinic(){\n\tll flow=0,maxflow=0;\n\twhile(bfs())while(flow=dfs(S,LLONG_MAX))maxflow+=flow;\n\treturn maxflow;\n}\nint n,m,a[51][6],id[51][6],w[51][51];ll c[51][6];\ninline void MyDearMoments(){\n\tn=read<int>(),m=read<int>(),S=n*(m-1)+1,T=S+1;\n\tfor(reg i=1;i<=n;++i){\n\t\tid[i][0]=S;\n\t\tfor(reg j=1;j<=m;++j){\n\t\t\ta[i][j]=read<int>(),c[i][j]=read<ll>(),id[i][j]=j==m?T:(i-1)*(m-1)+j;\n\t\t\tinsert(id[i][j],id[i][j-1],LLONG_MAX),insert(id[i][j-1],id[i][j],c[i][j]);\n\t\t}\n\t}\n\tfor(reg i=1;i<=n;++i)for(reg j=i+1;j<=n;++j){\n\t\tw[i][j]=w[j][i]=read<int>();\n\t\tstatic int b[102];int cnt=0;\n\t\tfor(reg k=1;k<=m;++k)b[++cnt]=a[i][k],b[++cnt]=a[j][k];\n\t\tsort(b+1,b+cnt+1);\n\t\tint pa1=0,pb1=1,pa2=1,pb2=0;\n\t\tfor(reg k=1;k<cnt;++k){\n\t\t\twhile(pa1<m&&a[i][pa1+1]<=b[k])++pa1;\n\t\t\twhile(pb1<=m&&a[j][pb1]<=b[k])++pb1;\n\t\t\tif(pa1&&pb1<=m)insert(id[j][pb1-1],id[i][pa1],1ll*(b[k+1]-b[k])*w[i][j]);\n\t\t\twhile(pa2<=m&&a[i][pa2]<=b[k])++pa2;\n\t\t\twhile(pb2<m&&a[j][pb2+1]<=b[k])++pb2;\n\t\t\tif(pb2&&pa2<=m)insert(id[i][pa2-1],id[j][pb2],1ll*(b[k+1]-b[k])*w[i][j]);\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",Dinic());\n}\nint main(){return MyDearMoments(),0;}\n```",
        "postTime": 1668680053,
        "uid": 280633,
        "name": "Muel_imj",
        "ccfLevel": 7,
        "title": "[ARC129E] Yet Another Minimization \u9898\u89e3"
    },
    {
        "content": "\n\n\u9898\u610f\uff1a\u6784\u9020\u5e8f\u5217 $\\{x_n\\}$\uff0c$x_i\\in\\{a_{i,1},a_{i,2},\\cdots,a_{i,m}\\}$\uff0c\u9009\u62e9 $a_{i,j}$ \u8981\u4ed8\u51fa $c_{i,j}$ \u7684\u4ee3\u4ef7\uff0c\u9009\u5b8c\u540e\u8fd8\u6709 $\\sum\\limits_{i<j} |x_i-x_j|w_{i,j}$ \u7684\u4ee3\u4ef7\uff0c\u6700\u5c0f\u5316\u4ee3\u4ef7\u548c\u3002$n\\leqslant 50,m\\leqslant 5$\u3002\n\n\u778e\u626f\uff1a\u8fd9\u8981\u4e0d\u662f\u7f51\u7edc\u6d41\u6211\u5012\u7acb\u62c9\u7a00\u3002\n\n\u9898\u89e3\uff1a\u611f\u89c9\u505a\u8fd9\u79cd\u8d85\u7ea7\u7384\u5b66\u7f51\u7edc\u6d41\u771f\u7684\u6ca1\u5565\u6536\u83b7\u554a\uff01\u8fd8\u662f\u5c3d\u529b\u63cf\u8ff0\u4e00\u4e0b\u5427\u3002\n\n\u9996\u5148\u8003\u8651 $c_{i,j}$ \u90a3\u4e00\u5757\uff0c\u6392\u51fa $n$ \u6392\u957f\u5ea6\u4e3a $m$ \u7684\u94fe\uff0c\u4ee4 $V_{i,0}=S,V_{i,m}=T$\uff0c\u8fde\u8fb9 $(V_{i,j-1},V_{i,j},c_{i,j})$\uff0c\u65ad\u5f00\u8fd9\u4e00\u6761\u8868\u793a\u9009 $a_{i,j}$\uff0c\u8fd9\u90e8\u5206\u662f\u7ecf\u5178\u7684\u3002\u7136\u540e\u8003\u8651\u7edd\u5bf9\u503c\u7684\u90e8\u5206\uff1a\n$$\n\\sum_{i<j} |x_i-x_j|w_{i,j}=\\sum_{i,j} w_{i,j} \\sum_{a\\in Z} [x_j\\leqslant a,a+1\\leqslant x_i]\n$$\n\u6240\u4ee5\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684 $a\\in Z$\uff0c\u82e5\u6ee1\u8db3\u6761\u4ef6\u5219\u5fc5\u987b\u8981\u5272\u6389\uff0c\u53cd\u4e4b\u4e00\u5b9a\u4e0d\u9700\u8981\u5272\uff0c\u6bd4\u8f83\u62bd\u8c61\uff0c\u8003\u8651\u76f4\u89c2\u4e00\u70b9\u3002\u5047\u5982\u6211\u628a\u6bcf\u4e2a $a$ \u90fd\u5efa\u4e00\u4e2a\u70b9\uff0c\u7136\u540e\u53ea\u628a $a_{i,*}$ \u8bbe\u8fb9\u6743\uff0c\u5176\u4f59\u90fd\u662f $+\\infty$\uff0c\u7136\u540e\u8fde\u8fb9 $(V_{i,a},V_{j,a},w_{i,j})$\uff0c\u663e\u7136\u8dd1\u51fa\u6765\u5c31\u662f\u4e0a\u5f0f\u3002\u90a3\u4e48\u6211\u4eec\u53ea\u7528\u628a\u76f8\u540c\u7684\u8fb9\u5408\u5e76\uff0c\u4e8b\u5b9e\u4e0a\u5c31\u662f\u8fde\u8fb9 \n$$\n(V_{i,x-1},V_{j,y},w_{i,j}\\max\\{0,\\min\\{a_{i,x},a_{j,y+1}\\}-\\max\\{a_{i,x-1},a_{j,y}\\}\\})\n$$\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=2e5+10;\nconst int mod=1e9+7;\n#define int long long\nconst int inf=1e18;\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n\treturn x*f;\n}\nconst int N=60;\nint beg[maxn],nex[maxn],to[maxn],w[maxn],e=1;\ninline void add(int x,int y,int z){\n\t++e;nex[e]=beg[x];beg[x]=e;to[e]=y;w[e]=z;\n\t++e;nex[e]=beg[y];beg[y]=e;to[e]=x;w[e]=0;\n}\nint n,m,id[N][N],S,T,cnt,a[N][N],c[N][N];\nint dep[maxn];queue<int>q;\ninline int bfs(){\n\tfor(int i=1;i<=cnt;i++)dep[i]=0;\n\tdep[S]=1;q.push(S);\n\twhile(!q.empty()){\n\t\tint x=q.front();q.pop();\n\t\tfor(int i=beg[x];i;i=nex[i]){\n\t\t\tint t=to[i];\n\t\t\tif(w[i]&&!dep[t]){\n\t\t\t\tdep[t]=dep[x]+1;\n\t\t\t\tq.push(t);\n\t\t\t}\n\t\t}\n\t}return dep[T];\n}\ninline int dfs(int x,int lim){\n\tif(x==T||!lim)return lim;\n\tint res=0;\n\tfor(int i=beg[x];i&&lim;i=nex[i]){\n\t\tint t=to[i];\n\t\tif(dep[t]==dep[x]+1&&w[i]){\n\t\t\tint f=dfs(t,min(lim,w[i]));\n\t\t\tif(!f){dep[t]=-1;continue;}\n\t\t\tres+=f,lim-=f;\n\t\t\tw[i]-=f,w[i^1]+=f;\n\t\t}\n\t}return res;\n}\nsigned main(){\n\tn=read(),m=read();\n\tS=1,T=cnt=2;\n\tfor(int i=1;i<=n;i++){\n\t\tid[i][0]=S,id[i][m]=T;\n\t\tfor(int j=1;j<m;j++)id[i][j]=++cnt;\n\t\tfor(int j=1;j<=m;j++){\n\t\t\ta[i][j]=read(),c[i][j]=read();\n\t\t\tadd(id[i][j-1],id[i][j],c[i][j]);\n\t\t}a[i][m+1]=inf;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=i+1;j<=n;j++){\n\t\t\tint W=read();\n\t\t\tfor(int x=1;x<=m;x++)\n\t\t\t\tfor(int y=1;y<=m;y++){\n\t\t\t\t\tadd(id[i][x-1],id[j][y],max(0ll,min(a[i][x],a[j][y+1])-max(a[i][x-1],a[j][y]))*W);\n\t\t\t\t\tadd(id[j][x-1],id[i][y],max(0ll,min(a[j][x],a[i][y+1])-max(a[j][x-1],a[i][y]))*W);\n\t\t\t\t}\n\t\t}\n\tint mxflw=0;\n\twhile(bfs())mxflw+=dfs(S,inf);\n\tprintf(\"%lld\\n\",mxflw);\t\t\t\n\treturn 0;\n}\n```\n\n\u6df1\u6df1\u5730\u611f\u5230\u81ea\u5df1\u7684\u5f31\u5c0f\u3002\n",
        "postTime": 1670090660,
        "uid": 140876,
        "name": "syzf2222",
        "ccfLevel": 9,
        "title": "ARC129E  Yet Another Minimization"
    }
]
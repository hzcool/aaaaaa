[
    {
        "content": "\u8f83\u7b80\u5355\u7684\u6811\u5f62 DP \u9898\uff0c~~\u611f\u89c9\u4e0d\u5982\u5efa\u9020\u519b\u8425~~\u3002\n\n\u9996\u5148\u6ce8\u610f\u5230\u6211\u4eec\u9700\u8981\u8def\u5f84\u5728\u9876\u70b9\u4e0a\u65e0\u4ea4\uff0c\u8fd9\u610f\u5473\u7740\u6bcf\u4e2a\u70b9\u6700\u591a\u88ab\u4e00\u6761\u94fe\u8986\u76d6\u5230\u3002\n\n\u6211\u4eec\u5bfb\u627e\u4e00\u79cd\u8ba1\u6570\u65b9\u5f0f\uff1a\u5bf9\u4e8e\u6811\u4e0a\u6ee1\u8db3\u7956\u5148-\u540e\u4ee3\u5173\u7cfb\u7684\u94fe\uff0c\u6211\u4eec\u5c06\u540e\u4ee3\u770b\u4f5c\u8d77\u70b9\uff0c\u7956\u5148\u770b\u4f5c\u7ec8\u70b9\u3002\u800c\u4e0d\u6ee1\u8db3\u7956\u5148-\u540e\u4ee3\u5173\u7cfb\u7684\u94fe\u5373\u4e3a\u4e24\u6761\u7ec8\u70b9\u4e3a LCA \u7684\u7956\u5148-\u540e\u4ee3\u94fe\u5408\u5e76\u8d77\u6765\u3002\u6211\u4eec\u5c06\u8fd9\u6837\u7684\u94fe\u79f0\u4e4b\u4e3a\u5408\u5e76\u94fe\u3002\n\n\u8003\u8651\u6811\u5f62 dp\u3002\u6211\u4eec\u8bbe $f_{u,i,j}(j\\in \\{0/1/2/3\\})$ \u8868\u793a\u5728 $u$ \u7684\u5b50\u6811\u5185\uff0c\u9009\u51fa\u4e86 $i$ \u6761\u94fe\uff0c$j$ \u7684\u542b\u4e49\u5982\u4e0b\u65f6\u7684\u65b9\u6848\u6570\uff1a\n\n$ \\begin{cases}\nu \\space \\text{\u672a\u88ab\u94fe\u8986\u76d6} \\ (j = 0) \\\\\nu \\space \\text{\u4f5c\u4e3a\u4e00\u6761\u65b0\u94fe\u7684\u8d77\u70b9} \\ (j=1) \\\\\nu \\space \\text{\u76ee\u524d\u5904\u5728\u4e00\u6761\u7956\u5148}-\\text{\u540e\u4ee3\u94fe\u4e0a}\\ (j=2) \\\\\nu \\space \\text{\u5904\u5728\u4e00\u6761\u5408\u5e76\u94fe\u4e0a} \\ (j=3)\n\\end{cases}$\n\n\u8f6c\u79fb\u65f6\uff0c\u6211\u4eec\u76f8\u5f53\u4e8e\u5728\u5f53\u524d\u7684 $u$ \u4e4b\u4e0b\u518d\u6302\u4e86\u4e00\u68f5 $v$ \u7684\u5b50\u6811\uff0c\u679a\u4e3e\u5f53\u524d $u$ \u5b50\u6811\u548c $v$ \u5b50\u6811\u7684 $j$ \u72b6\u6001\uff0c\u8003\u8651\u5408\u5e76\u8d77\u6765\u7684\u8d21\u732e\u3002\n\n\u8f6c\u79fb\u7684\u8fc7\u7a0b\u662f\u8f83\u4e3a\u7e41\u7410\u7684\uff0c\u5728\u6b64\u7ed9\u51fa\u5199\u8f6c\u79fb\u5f0f\u65f6\u7684\u601d\u8def\uff1a\n\n\u5bf9\u4e8e $j_v=0/3$ \u7684\u60c5\u51b5\uff0c\u8fd9\u68f5\u5b50\u6811\u63a5\u4e0a\u53bb\u5bf9 $j_u$ \u7684\u5f53\u524d\u72b6\u6001\u4e0d\u4f1a\u6709\u4efb\u4f55\u5f71\u54cd\u3002\n\n\u5bf9\u4e8e $j_v=1$ \u7684\u60c5\u51b5\uff0c$j_u$ \u53ef\u4ee5\u4e3a $0$ \u6216 $2$\uff0c\u524d\u8005\u8868\u793a\u4ece\u4e00\u4e2a\u70b9 $v$ \u53d8\u4e3a\u94fe $v-u$\uff0c\u540e\u8005\u8868\u793a $u$ \u5b50\u6811\u5185\u4e00\u6761\u94fe\u548c $v$ \u5408\u5e76\u3002\n\n\u5bf9\u4e8e $j_v=2$ \u7684\u60c5\u51b5\uff1a\n\n- $j_u=0$\n\n\u5219 $v$ \u8fd9\u6761\u94fe\u53ef\u4ee5\u9009\u62e9\u4ee5 $v$ \u4e3a\u7ec8\u70b9\uff0c\u4e5f\u53ef\u4ee5\u9009\u62e9\u7ee7\u7eed\u5ef6\u4f38\u5230 $u$\uff0c\u5bf9\u5e94\u7684\u65b0\u7684 $j_u$ \u5206\u522b\u4e3a $0$ \u548c $2$\u3002\n\n- $j_u=1/3$\n\n\u53ea\u80fd\u4ee5 $v$ \u4e3a\u7ec8\u70b9\u3002\n\n- $j_u=2$\n\n\u5219 $v$ \u8fd9\u6761\u94fe\u53ef\u4ee5\u9009\u62e9\u4ee5 $v$ \u4e3a\u7ec8\u70b9\uff0c\u4e5f\u53ef\u4ee5\u9009\u62e9\u4e0e $u$ \u6240\u5728\u94fe\u5408\u5e76\u3002\n\n\u4f9d\u7167\u4e0a\u9762\u7684\u8fc7\u7a0b\u5199\u51fa\u5bf9\u5e94\u7684\u8f6c\u79fb\u5373\u53ef\uff0c\u6700\u7ec8\u7b54\u6848\u5373\u4e3a $f_{1,k,0}+f_{1,k,2}+f_{1,k,3}$\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(nk^2)$\u3002\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1000000007;\ninline int read(){\n    int x=0,f=1; char c=getchar();\n    while(c<'0'||c>'9'){ if(c=='-') f=-1; c=getchar(); }\n    while(c>='0'&&c<='9') x=x*10+c-'0',c=getchar();\n    return x*f;\n}\nint n,m,f[1001][51][4],tf[51][4],ans;\n// 0,1,2,3 : \u65e0 / \u5411\u4e0a\u8d77\u70b9 / \u5411\u4e0a\u975e\u8d77\u70b9 / \u5b50\u6811\u6709\u5408\u5e76\nstruct Edge{ int to,nxt; }e[2001]; int head[1001],tot;\ninline void add(int u,int v){ e[++tot]={v,head[u]}; head[u]=tot; }\ninline void dfs(int u,int fa){\n    f[u][0][0]=f[u][1][1]=1;\n    for(int i=head[u];i;i=e[i].nxt){\n        int v=e[i].to;\n        if(v==fa) continue;\n        dfs(v,u);\n        for(int i=0;i<=m;i++)\n            for(int j=0;j<4;j++)\n                tf[i][j]=f[u][i][j],f[u][i][j]=0;\n        for(int i=0;i<=m;i++)\n            for(int j=0;j<=m;j++){\n            \tif(i+j<=m)\n                (f[u][i+j][0]+=1ll*tf[i][0]*f[v][j][3]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][1]+=1ll*tf[i][1]*f[v][j][3]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][2]+=1ll*tf[i][2]*f[v][j][3]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][3]+=1ll*tf[i][3]*f[v][j][3]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][0]+=1ll*tf[i][0]*f[v][j][2]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][2]+=1ll*tf[i][0]*f[v][j][2]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][1]+=1ll*tf[i][1]*f[v][j][2]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][2]+=1ll*tf[i][2]*f[v][j][2]%mod)%=mod;\n                if(i && j && i+j-1<=m)\n\t\t\t\t(f[u][i+j-1][3]+=1ll*tf[i][2]*f[v][j][2]%mod)%=mod;\n\t\t\t\tif(i+j<=m)\n                (f[u][i+j][3]+=1ll*tf[i][3]*f[v][j][2]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][2]+=1ll*tf[i][0]*f[v][j][1]%mod)%=mod;\n                if(i && j && i+j-1<=m)\n                (f[u][i+j-1][3]+=1ll*tf[i][2]*f[v][j][1]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][0]+=1ll*tf[i][0]*f[v][j][0]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][1]+=1ll*tf[i][1]*f[v][j][0]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][2]+=1ll*tf[i][2]*f[v][j][0]%mod)%=mod;\n                if(i+j<=m)\n                (f[u][i+j][3]+=1ll*tf[i][3]*f[v][j][0]%mod)%=mod;\n            }\n    }\n}\nint main(){\n    n=read(),m=read();\n    for(int i=1;i<n;i++){\n        int u=read(),v=read();\n        add(u,v); add(v,u);\n    }\n    dfs(1,-1);\n    ans=((f[1][m][0]+f[1][m][2])%mod+f[1][m][3])%mod;\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1677857007,
        "uid": 236862,
        "name": "DitaMirika",
        "ccfLevel": 7,
        "title": "AT_TDPC_EEL"
    }
]
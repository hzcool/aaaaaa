[
    {
        "content": "# Ex\n\n\u6ce8\u610f\u5230\u5982\u679c\u6ca1\u6709\u7b2c\u4e00\u6b21\u5728\u4e00\u4e2a\u7684\u70b9\u7684\u6027\u8d28\uff0c\u90a3\u4e48\u5176\u6982\u7387\u53ef\u4ee5\u6bd4\u8f83\u8f7b\u6613\u7684\u7b97\u51fa\u6765\u3002\n\n\u8003\u8651\u4e00\u4e2a\u5b50\u95ee\u9898\uff0c$l(x, y, a, b, c)$ \u8868\u793a\u4ece $a,b,c$ \u51fa\u53d1\u8d70 $x$ \u6b65\u540e\u5168\u90e8\u5230\u8fbe $y$ \u70b9\u7684\u65b9\u6848\u6570\u3002\n\n\u6ce8\u610f\u5230\u5982\u679c\u786e\u5b9a\u4e86\u6b65\u6570\u548c\u8d77\u70b9\u7ec8\u70b9\u90a3\u4e48\u5f80\u5de6\u8d70\u548c\u5f80\u53f3\u8d70\u7684\u6b65\u6570\u662f\u786e\u5b9a\u7684\u3002\n\n\u6240\u4ee5\n$$\nl(x,y,a,b,c)=\\frac{{{x} \\choose {\\frac{x+y-a}{2}}} {{x} \\choose {\\frac{x+y-b}{2}}} {{x} \\choose {\\frac{x+y-c}{2}}}}{2^{3x}}\n$$\n$$\np(i,a,b,c)=\\frac{1}{(\\frac{i-a}{2})!(\\frac{i-b}{2})!(\\frac{i-c}{2})!}\n$$\n$$\nq(i,a,b,c)=\\frac{1}{(\\frac{i+a}{2})!(\\frac{i+b}{2})!(\\frac{i+c}{2})!}\n$$\n$$\nl(x,y,a,b,c)=\\frac{(x!)^3p(x+y,a,b,c)q(x-y,a,b,c)}{2^{3x}}\n$$\n\n\u90a3\u4e48\u5982\u679c\u4ece $a,b,c$ \u8d77\u59cb\u7136\u540e\u8d70 $x$ \u6b65\u5230\u4e00\u4e2a\u70b9\u7684\u6982\u7387\u5c31\u4e3a \n\n$$\nt(x, a, b,c) = \\sum_{y}{l(x,y,a,b,c)}\n=\n\\frac{(x!)^3}{2^{3x}}\\sum_{m+n=2x}{p(m,a,b,c)q(n,a,b,c)}\n$$\n\n\u6240\u4ee5\u76f4\u63a5\u5377\u79ef\u5c31\u53ef\u4ee5\u6c42\u51fa\u4efb\u610f\u4e00\u4e2a $a,b,c$ \u7684\u5e8f\u5217\u7684 $t$ \u4e86\u3002\n\n\u5b9e\u9645\u4e0a $n$ \u53ef\u4ee5\u4e3a\u8d1f\uff0c\u8981\u8003\u8651\u4e00\u4e9b\u8fb9\u754c\u3002\n\n$n$ \u7684\u8303\u56f4\u4e3a $[\\max{(a,b,c)},2x+\\min({a,b,c})]$\u3002\n\n\u4f46\u4e3a\u4e86\u65b9\u4fbf\u4f60\u53ef\u4ee5\u76f4\u63a5\u5bf9 $a,b,c$ \u90fd\u9664\u4e8c\u4e4b\u540e\u51cf\u53bb $\\max{(a,b,c)}$\uff0c\u7136\u540e\u7b97\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a $x$ \u7684\u5e8f\u5217\u5377\u79ef\uff0c\u8fd9\u5176\u5b9e\u5c31\u76f8\u5f53\u4e8e\u4f60\u5728\u5bf9\u539f\u5e8f\u5217\u504f\u79fb $\\max{(a,b,c)}$ \u540e\u679a\u4e3e $\\frac{i}{2}$ \u5728\u8ba1\u7b97\u3002\n\n\u8bb0 $f(x)$ \u8868\u793a $T=x$ \u65f6\u7684\u7b54\u6848\uff0c\u8003\u8651\u5bb9\u65a5\u3002\n\n\u6709 $f(x)=t(x,A,B,C)-\\sum_{i=1}^{t-1}{f(i)t(x-i,0,0,0)}$\u3002\n\n\u540e\u9762\u90a3\u6bb5\u662f\u53bb\u6389\u4e2d\u95f4\u6709\u591a\u6b21\u76f8\u9047\u7684\u65b9\u6848\uff0c\u56e0\u4e3a\u6bcf\u679a\u4e3e\u7684\u4e00\u4e2a $i$ \u6240\u53bb\u6389\u7684\u65b9\u6848\u4e00\u5b9a\u5728 $i$ \u624d\u9047\u89c1\u7b2c\u4e00\u6b21\uff0c\u4e00\u5b9a\u548c\u524d\u9762\u7684\u4e0d\u91cd\uff0c\u4e14\u540e\u9762\u4e5f\u4e0d\u91cd\u590d\uff0c\u6240\u4ee5\u8fd9\u6837\u4e00\u5b9a\u4e0d\u91cd\u4e0d\u6f0f\u3002\n\n\u8fd9\u6837\u5f62\u5f0f\u7684\u5f0f\u5b50\u4e00\u5b9a\u53ef\u4ee5\u4f18\u5316\u3002\n\n\u8bbe $F(x)$ \u4e3a $f(x)$ \u7684\u751f\u6210\u51fd\u6570\uff0c$G(x)$ \u4e3a $t(x,A,B,C)$ \u7684\u751f\u6210\u51fd\u6570\uff0c$H(x)$ \u4e3a $t(x,0,0,0)$ \u7684\u751f\u6210\u51fd\u6570\u3002\n\n\u6709\n\n$$\nF(x)=\\sum_{i=0}{\n\tx^i\n\t(\n\t\tt(x,A,B,C)\n\t\t-\n\t\t\\sum_{j=0}^{i-1}{\n\t\t\tf(j)\n\t\t\tt(x-i,0,0,0)\n\t\t} \n\t)\n}\n=\nG(x)\n-\nF(x)(H(x)-t(0, 0, 0, 0))\n\n$$\n\n\u6839\u636e\u5b9a\u4e49 $t(0,0,0,0)=1$\uff0c \u6240\u4ee5\n\n$$\nF(x)H(x)=G(x) \\rightarrow F(x) = \\frac{G(x)}{H(x)}\n$$\n\n\u6c42\u9006\u4e4b\u540e\u518d\u4e58\u6cd5\u5c31\u884c\u3002\n\n\u6700\u7ec8\u7b54\u6848\u4e3a $f(T)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nusing ll = long long;\nconst ll MOD = 998244353;\nconst ll G = 3;\nconst ll GINV = 332748118;\n\nll qpow(ll a, ll b) {\n\tll ret = 1;\n\tfor (; b; b >>= 1) {\n\t\tif (b & 1) ret = ret * a % MOD;\n\t\ta = a * a % MOD;\n\t}\n\treturn ret;\n}\n\n\nnamespace Poly {\n\tvector<int> rev;\n\tvoid init_NTT(int len, int cnt) {\n\t\trev.resize(len);\n\t\tfor (int i = 0; i < len; i ++) rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << (cnt - 1));\n\t} \n\n\tvoid NTT(int len, vector<ll> &a, int op) {\n\t\tfor (int i = 0; i < len; i ++) if (i < rev[i]) swap(a[i], a[rev[i]]);\n\t\tfor (int t = 1; t < len; t <<= 1) {\n\t\t\tll h = qpow(op ? G : GINV,  (MOD - 1) / (t * 2));\n\t\t\tfor (int i = 0; i < len; i += 2 * t) {\n\t\t\t\tll w = 1;\n\t\t\t\tfor (int j = i; j < i + t; j ++, w = w * h % MOD) {\n\t\t\t\t\tll x = a[j], y = w * a[j + t] % MOD;\n\t\t\t\t\ta[j] = (x + y) % MOD, a[j + t] = (x - y + MOD) % MOD;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tvector<ll> polyMul(vector<ll> a, vector<ll> b) {\n\t\tint n = a.size(), m = b.size();\n\t\tint len = 1, cnt = 0;\n\t\twhile (len < n + m - 1) len *= 2, ++ cnt;\n\t\tif ((int) rev.size() != len) init_NTT(len, cnt);\n\t\ta.resize(len), b.resize(len);\n\t\tNTT(len, a, 1), NTT(len, b, 1);\n\t\tvector<ll> c(len);\n\t\tfor (int i = 0; i < len; i ++) c[i] = 1ll * a[i] * b[i] % MOD;\n\t\tNTT(len, c, 0);\n\t\tll inv = qpow(len, MOD - 2);\n\t\tc.resize(n + m - 1);\n\t\tfor (int i = 0; i < n + m - 1; i ++) c[i] = inv * c[i] % MOD;\n\t\treturn c;\n\t}\n\n\tvector<ll> polyInv(vector<ll> a) {\n\t\tint n = a.size();\n\t\tvector<ll> b = { qpow(a[0], MOD - 2) };\n\t\tint len = 1;\n\t\twhile (len < n) {\n\t\t\tlen *= 2;\n\t\t\tvector<ll> b_square = polyMul(b, b);\n\t\t\tvector<ll> tmp = polyMul(a, b_square);\n\t\t\tb.resize(len);\n\t\t\tfor (int i = 0; i < len; i ++) b[i] = (b[i] * 2 % MOD - tmp[i] + MOD) % MOD;\n\t\t}\n\t\treturn b;\n\t}\n}\n\nconst int N = 2e5;\nint a, b, c, t;\nll fac[N + 10], inv[N + 10];\n\nvector<ll> calc_g() {\n\ta /= 2, b /= 2, c /= 2;\n\tint mx = max({ a, b, c });\n\ta = mx - a, b = mx - b, c = mx - c;\n\tvector<ll> p(t + 1), q(t + 1);\n\tfor (int i = max({ a, b, c }); i <= t; i ++) {\n\t\tint x = (i - a);\n\t\tint y = (i - b);\n\t\tint z = (i - c);\n\t\tp[i] = inv[x] * inv[y] % MOD * inv[z] % MOD;\t\n\t}\n\tfor (int i = 0; i <= t; i ++) {\n\t\tint x = (i + a);\n\t\tint y = (i + b);\n\t\tint z = (i + c);\n\t\tq[i] = inv[x] * inv[y] % MOD * inv[z] % MOD;\t\n\t}\n\tvector<ll> res = Poly::polyMul(p, q);\n\tvector<ll> g(t + 1);\n\tfor (int i = 0; i <= t; i ++) g[i] = res[i] * qpow(fac[i], 3) % MOD * qpow(qpow(2, 3 * i), MOD - 2) % MOD;\n\treturn g;\n}\n\nvector<ll> calc_h() {\n\tvector<ll> f(t + 1);\n\tfor (int i = 0; i <= t; i ++) {\n\t\tf[i] = inv[i] * inv[i] % MOD * inv[i] % MOD;\t\n\t}\n\tvector<ll> res = Poly::polyMul(f, f);\n\tvector<ll> h(t + 1);\n\tfor (int i = 0; i <= t; i ++) h[i] = res[i] * qpow(fac[i], 3) % MOD * qpow(qpow(2, 3 * i), MOD - 2) % MOD;\n\treturn h;\t\n}\n\nvoid init() {\n\tfac[0] = 1;\n\tfor (int i = 1; i <= N; i ++) fac[i] = fac[i - 1] * i % MOD;\n\tinv[N] = qpow(fac[N], MOD - 2);\n\tfor (int i = N; i; i --) inv[i - 1] = inv[i] * i % MOD;\n}\n\nint main() {\n\tinit();\n\tcin >> a >> b >> c >> t;\n\tvector<ll> res = Poly::polyMul(calc_g(), Poly::polyInv(calc_h()));\n\tcout << res[t];\n\treturn 0;\n}\n```",
        "postTime": 1677507024,
        "uid": 139066,
        "name": "luanmenglei",
        "ccfLevel": 7,
        "title": "[ABC289Ex] Trio \u9898\u89e3"
    },
    {
        "content": "\u5148\u6c42\u65b9\u6848\u6570\uff0c\u6700\u540e\u4e58\u4e0a $8^{-T}$\u3002\n\n\u5b9a\u4e49 $f(i)$ \u8868\u793a $T=i$ \u65f6\u7684\u7b54\u6848\u3002\n\n\u5b9a\u4e49 $g(i)$ \u8868\u793a\u4ece $A,B,C$ \u51fa\u53d1\u7ecf\u8fc7 $i$ \u4e2a\u65f6\u523b\uff0c\u5728\u540c\u4e00\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u65b9\u6848\u6570\u3002\n\n\u5b9a\u4e49 $h(i)$ \u8868\u793a\u4ece $0,0,0$ \u51fa\u53d1\u7ecf\u8fc7 $i$ \u4e2a\u65f6\u523b\uff0c\u5728\u540c\u4e00\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u65b9\u6848\u6570\u3002\n\n\u540c\u65f6\uff0c\u8bb0 $F,G,H$ \u5206\u522b\u4e3a\u8fd9\u4e09\u4e2a\u7684 OGF\u3002\n\n\u90a3\u4e48\u679a\u4e3e\u7b2c\u4e00\u6b21\u78b0\u9762\u7684\u65f6\u523b\uff0c\u53ef\u5f97\uff1a\n\n$$\n\\begin{aligned}\nf(i)&=g(i)-\\sum_{j=0}^{i-1}f(j)h(i-j)\\\\\n\\Rightarrow F(x)&=G(x)-(F(x)H(x)-F(x))\\\\\n\\Rightarrow F(x)&=\\dfrac{G(x)}{H(x)}\n\\end{aligned}\n$$\n\n\u56e0\u800c\u53ea\u9700\u8981\u6c42\u51fa $G,H$ \u5373\u53ef\u3002\n\n\u7531\u4e8e $G,H$ \u7684\u5b9a\u4e49\u53ea\u6709\u8d77\u70b9\u4e0d\u540c\uff0c\u53ea\u8981\u80fd\u6c42\u51fa $G$\uff0c\u4ee4 $A=B=C=0$ \u4e00\u6a21\u4e00\u6837\u505a\u4e00\u904d\u5373\u53ef\u5f97\u5230 $H$\u3002\n\n\u8fd9\u91cc\u628a\u4e09\u5143\u7ec4 $(A,B,C)$ \u4e2d\u6700\u5c0f\u7684\u4e00\u4e2a\u5e73\u79fb\u81f3 $0$ \u5904\uff0c\u4e14\u8ba4\u4e3a $0=A\\le B\\le C$\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\ng(i)=\\sum_p\\binom{i}{\\frac{p-A+i}{2}}\\binom{i}{\\frac{p-B+i}{2}}\\binom{i}{\\frac{p-C+i}{2}}\n$$\n\n\u8fd9\u91cc\uff0c\u5f53 $p$ \u4e0e $i$ \u7684\u5947\u5076\u6027\u4e0d\u540c\u65f6\u65e0\u8d21\u732e\u3002\n\n\u4e8c\u9879\u5f0f\u4e2d\u7684\u5206\u5f0f\u770b\u7740\u5f88\u96be\u53d7\uff0c\u628a\u5b83\u4eec\u641e\u6389\uff0c\u6ce8\u610f\u5230 $A,B,C$ \u5747\u4e3a\u5076\u6570\uff0c**\u4e0d\u59a8\u628a\u5b83\u4eec\u5168\u90e8\u9664\u4ee5\u4e8c**\u3002\n\n- $i$ \u4e3a\u5076\u6570\n\n$$\n\\begin{aligned}\ng(2i)&=\\sum_p\\binom{2i}{p+i-A}\\binom{2i}{p+i-B}\\binom{2i}{p+i-C}\\\\\n&=[(2i)!]^3\\sum_p\\dfrac{1}{(p+i-A)!(p+i-B)!(p+i-C)!}\\cdot \\dfrac{1}{(i-p+A)!(i-p+B)!(i-p+C)!}\n\\end{aligned}\n$$\n\n\u4ee4\uff1a\n\n$$\n\\begin{aligned}\nP(x)&=\\sum_i\\dfrac{x^i}{(i-A)!(i-B)!(i-C)!}\\\\\nQ(x)&=\\sum_i\\dfrac{x^i}{(i+A)!(i+B)!(i+C)!}\n\\end{aligned}\n$$\n\n\u90a3\u4e48 $g(2i)=[(2i)!]^3[x^{2i}]P(x)Q(x)$\n\n- $i$ \u4e3a\u5947\n\n\u6cbf\u7528\u4e0a\u9762 $P,Q$ \u7684\u5b9a\u4e49\uff0c\u7c7b\u4f3c\u7684\u5206\u6790\u53ef\u5f97\u4ecd\u7136\u6709 $g(2i+1)=[(2i+1)!]^3[x^{2i+1}]P(x)Q(x)$\n\n\u56e0\u6b64 $g(i)=(i!)^3[x^i]P(x)Q(x)$\u3002\n\n\u540c\u65f6\u7531\u4e8e $A=0$\uff0c$Q$ \u6ca1\u6709\u8d1f\u6307\u6570\u9879\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u5e73\u79fb\u591a\u9879\u5f0f\u3002\n\n\u5377\u79ef\u65f6\u9879\u6570\u4fdd\u7559\u81f3 $T$ \u5373\u53ef\u3002\n\n```cpp\ninline int Cube(int x){ return 1ll*x*x%mod*x%mod; }\nint main(){\n\tscanf(\"%d%d%d%d\",&A,&B,&C,&T);\n\tif (A>B) swap(A,B);\n\tif (A>C) swap(A,C);\n\tif (B>C) swap(B,C);\n\tB=(B-A)/2,C=(C-A)/2,A=0; Inv[0]=fac[0]=1;\n\tfor (int i=1; i<=C+T; i++) Inv[i]=fastpow(fac[i]=1ll*fac[i-1]*i%mod,mod-2);\n\tfor (int i=C; i<=C+T; i++) P[i]=1ll*Inv[i-A]*Inv[i-B]%mod*Inv[i-C]%mod;\n\tfor (int i=0; i<=C+T; i++) Q[i]=1ll*Inv[i+A]*Inv[i+B]%mod*Inv[i+C]%mod;\n\tMultiply(P,Q,C+T+1);\n\tfor (int i=0; i<=T; i++) F[i]=1ll*P[i]*Cube(fac[i])%mod;\n    \n\tmemset(P,0,sizeof(P));\n\tmemset(Q,0,sizeof(Q));\n\tA=B=C=0;\n\tfor (int i=C; i<=C+T; i++) P[i]=1ll*Inv[i-A]*Inv[i-B]%mod*Inv[i-C]%mod;\n\tfor (int i=0; i<=C+T; i++) Q[i]=1ll*Inv[i+A]*Inv[i+B]%mod*Inv[i+C]%mod;\n\tMultiply(P,Q,C+T+1);\n\tfor (int i=0; i<=T; i++) G[i]=1ll*P[i]*Cube(fac[i])%mod;\n\n\tInverse(G,T+1);\n\tMultiply(F,G,T+1);\n\tprintf(\"%lld\\n\",1ll*fastpow(fastpow(8,T),mod-2)*F[T]%mod);\n}\n```",
        "postTime": 1682600355,
        "uid": 44599,
        "name": "wishapig",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 ABC289Ex Trio"
    }
]
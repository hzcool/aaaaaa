[
    {
        "content": "### \u9898\u76ee\u5927\u610f  \n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_abc193_e)  \n\u591a\u7ec4\u6570\u636e\u3002\u4e00\u4e2a\u4eba\u5750\u516c\u4ea4\u4ece $A$ \u7ad9\u5750\u5230 $B$ \u7ad9\uff0c\u516c\u4ea4\u8f66\u5148\u7528 $x$ \u79d2\u5230 $B$ \u7ad9\uff0c\u7136\u540e\u5728 $B$ \u7ad9\u505c $y$ \u79d2\uff0c\u518d\u7528 $x$ \u79d2\u5230 $A$ \u7ad9\uff0c\u518d\u5728 $A$ \u7ad9\u505c $y$ \u79d2\uff0c\u5982\u6b64\u5faa\u73af\u5f80\u590d\u3002\u800c\u8fd9\u4e2a\u4eba\u5148\u7761\u7720 $p$ \u79d2\uff0c\u518d\u9192\u6765 $q$ \u79d2\uff0c\u5982\u6b64\u5faa\u73af\u5f80\u590d\u3002\u6c42\u8fd9\u4e2a\u4eba\u6700\u65e9\u4f55\u65f6\u80fd\u5728 $B$ \u7ad9\u4e0b\u8f66\uff0c\u82e5\u6c38\u8fdc\u4e0d\u80fd\uff0c\u8f93\u51fa $infinity$\u3002\n### \u9898\u76ee\u5206\u6790  \n\u4ee4\u516c\u4ea4\u8f66\u5f80\u8fd4\u4e24\u5730 $a$ \u6b21\uff0c\u6b64\u4eba\u5df2\u5faa\u73af\u8fc7\u7a0b $b$ \u6b21\uff0c\u516c\u4ea4\u8f66\u505c\u5728 $B$ \u5730 $m$ \u79d2\uff0c\u6b64\u4eba\u9192\u6765 $n$ \u79d2\u4e0b\u8f66\uff0c\u53ef\u5f97\u7b49\u5f0f\uff1a  \n$2a(x+y)+x+m=b(p+q)+p+n$  \n\u7ecf\u6574\u7406\u5f97\uff1a  \n$2a(x+y)+(-b)(p+q)=(p+n)-(x+m)$  \n\u4e8e\u662f\u6211\u4eec\u60f3\u5230**\u6269\u6b27**\u3002  \n\u5148\u89e3\u65b9\u7a0b $2a(x+y)+(-b)(p+q)=\\gcd(2(x+y),p+q)$  \n\u4ee4 $i=x+m,j=p+n$  \n\u679a\u4e3e $i,j$\uff0c\u6c42\u51fa $a$ \u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\uff0c\u4ee3\u5165\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u6c42\u89e3\uff0c\u53d6\u6700\u5c0f\u503c\u8f93\u51fa\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(yq+\\log(\\max(2(x+y),p+q))$\u3002  \n### AC\u4ee3\u7801  \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nbool flag;\nlong long t,x,y,p,q,d,a,b,minn=0x7fffffffffffffff;\nlong long ans;\nvoid Exgcd(long long a,long long b,long long &x,long long &y)\n{\n\tif(!b)\n\t{\n\t\td=a,x=1,y=0;\n\t\treturn;\n\t}\n\tExgcd(b,a%b,x,y);\n\tlong long tx=x;\n\tx=y;\n\ty=tx-a/b*y;\n}\nint main()\n{\n\tcin>>t;\n\tfor(int t1=1;t1<=t;t1++)\n\t{\n\t\tcin>>x>>y>>p>>q;\n\t\tminn=0x7fffffffffffffff;\n\t\tflag=0;\n\t\tExgcd(2*(x+y),p+q,a,b);\n\t\tfor(long long i=x;i<x+y;i++)\n\t\t{\n\t\t\tfor(long long j=p;j<p+q;j++)\n\t\t\t{\n\t\t\t\tif((j-i)%d!=0)continue;\n\t\t\t\tflag=1;\n\t\t\t\tlong long k=(j-i)/d;\n\t\t\t\tlong long aa=a*k;\n\t\t\t\taa=(aa%((p+q)/d)+((p+q)/d))%((p+q)/d);\n\t\t\t\tminn=min(minn,aa*2*(x+y)+i);\n\t\t\t}\n\t\t}\n\t\tif(!flag)cout<<\"infinity\";\n\t\telse cout<<minn;\n\t\tcout<<'\\n';\n\t}\n\treturn 0;\n}\n```  \n## \u522b\u614c\uff0c\u8fd8\u6709\u4f18\u5316  \n\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e $j-i$,\u7b97\u51fa\u6700\u5c0f\u7684 $i$ \u4ee3\u5165\u6c42\u6700\u5c0f\u503c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(y+q+\\log(\\max(2*(x+y),p+q))$\u3002  \n\u4ee3\u7801\uff1a  \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nbool flag;\nlong long t,x,p,d,a,b,minn=0x7fffffffffffffff;\nint y,q;\nlong long ans;\nvoid Exgcd(long long a,long long b,long long &x,long long &y)\n{\n\tif(!b)\n\t{\n\t\td=a,x=1,y=0;\n\t\treturn;\n\t}\n\tExgcd(b,a%b,x,y);\n\tlong long tx=x;\n\tx=y;\n\ty=tx-a/b*y;\n}\nint main()\n{\n\tcin>>t;\n\tfor(int t1=1;t1<=t;t1++)\n\t{\n\t\tcin>>x>>y>>p>>q;\n\t\tminn=0x7fffffffffffffff;\n\t\tflag=0;\n\t\tExgcd(2*(x+y),p+q,a,b);\n\t\tfor(long long i=p-(x+y-1);i<=p+q-1-x;i++)\n\t\t{\n\t\t\tif(i%d!=0)continue;\n\t\t\tflag=1;\n\t\t\tlong long k=i/d;\n\t\t\tlong long aa=a*k;\n\t\t\taa=(aa%((p+q)/d)+((p+q)/d))%((p+q)/d);\n\t\t\tif(i>=p-x)minn=min(minn,aa*2*(x+y)+x);\n\t\t\telse minn=min(minn,aa*2*(x+y)+x+(p-x-i));\n\t\t}\n\t\tif(!flag)cout<<\"infinity\";\n\t\telse cout<<minn;\n\t\tcout<<'\\n';\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1670386497,
        "uid": 567729,
        "name": "dyj133446",
        "ccfLevel": 7,
        "title": "ABC193E"
    }
]
[
    {
        "content": "[Blog](https://autumnkite.github.io/atcoder-cfoo15H-sol/)\u98df\u7528\u6548\u679c\u66f4\u4f73\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://code-festival-2015-okinawa-open.contest.atcoder.jp/tasks/code_festival_2015_okinawa_h)\n\n## \u9898\u610f\n\n\u7ed9\u5b9a $n$ \u4e2a\u533a\u95f4 $(l_r,r_i]$\uff08\u6ce8\u610f\u539f\u9898\u4e2d\u867d\u7136\u5199\u7740 $[l_i,r_i]$\uff0c\u4f46\u901a\u8fc7\u8f6c\u5316\u540e\u76f8\u5f53\u4e8e $(l_i,r_i]$\uff09\uff0c\u6bcf\u4e2a\u533a\u95f4\u6709\u5b58\u5728\u548c\u4e0d\u5b58\u5728\u4e24\u79cd\u72b6\u6001\u3002\u6c42\u6240\u6709 $2^n$ \u79cd\u65b9\u6848\u4e2d\uff0c**\u672c\u8d28\u4e0d\u540c**\u7684\u65b9\u6848\u7684\u6570\u91cf $\\bmod (10^9+7)$ \u7684\u503c\u3002\n\n\u8bb0\u4e00\u4e2a\u65b9\u6848\u7684**\u70b9\u96c6\u5408**\u4e3a\u6570\u8f74\u4e0a\u81f3\u5c11\u88ab\u4e00\u4e2a\u533a\u95f4\u8986\u76d6\u7684\u6574\u6570\u7ec4\u6210\u7684\u96c6\u5408\uff0c\u5219\u4e24\u4e2a\u65b9\u6848**\u672c\u8d28\u4e0d\u540c**\u5f53\u4e14\u4ec5\u5f53\u8fd9\u4e24\u4e2a\u65b9\u6848\u7684**\u70b9\u96c6\u5408**\u4e0d\u540c\u3002\n\n$n\\le 2000,0\\le l_i< r_i\\le 10^9$\n\n## \u9898\u89e3\n\n\u4e3a\u65b9\u4fbf\u5904\u7406\uff0c\u6211\u4eec\u628a $l_i$ \u52a0 $1$ \u4f7f\u5f97\u533a\u95f4\u53d8\u4e3a\u95ed\u533a\u95f4\u3002\n\n\u663e\u7136\uff0c$l_i,r_i$ \u53ef\u4ee5\u79bb\u6563\uff0c\u6240\u4ee5\u5750\u6807\u53d8\u4e3a $O(n)$ \u7ea7\u522b\u3002\n\n\u7136\u540e\u8003\u8651\u4e00\u4e2a DP\uff0c$dp_{i,0/1}$ \u8868\u793a\u8986\u76d6\u524d $i$ \u4e2a\u70b9\uff0c\u4e14\u7b2c $i$ \u4e2a\u70b9\u5fc5\u987b\u8986\u76d6/\u4e0d\u8986\u76d6\u7684\u672c\u8d28\u4e0d\u540c\u7684\u65b9\u6848\u6570\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u5199\u51fa\u4e00\u4e2a $O(n^2)$ \u7684 DP\uff0c\u65b9\u7a0b\u5982\u4e0b\uff1a$$dp_{i,j}=\\begin{cases} dp_{i-1,0}+dp_{i-1,1} & \\text{ if } j=0 \\\\ \\sum\\limits_{cov(k,i)=1} dp_{k-1,0} & \\text{ if } j=1 \\end{cases}$$\n\n\u5176\u4e2d $cov(k,i)=0/1$ \u8868\u793a\u662f\u5426\u5b58\u5728\u4e00\u79cd\u533a\u95f4\u8986\u76d6\u65b9\u6848\u4f7f\u5f97\u521a\u597d\u8986\u76d6 $[k,i]$\u3002\n\n$cov(i,j)$ \u53ef\u4ee5\u7528\u5982\u4e0b\u65b9\u5f0f\u5904\u7406\uff1a\n\n\u8bb0 $p_i$\uff08\u4e00\u4e2a vector\uff09 \u8868\u793a\u6240\u6709\u53f3\u7aef\u70b9\u4e3a $i$ \u7684\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u3002\n\n\u679a\u4e3e $i$\uff08\u88ab\u8986\u76d6\u90e8\u5206\u7684\u5de6\u7aef\u70b9\uff09\uff0c\u9996\u5148\u679a\u4e3e\u6240\u6709\u5de6\u7aef\u70b9\u4e3a $i$ \u7684\u533a\u95f4 $[i,r_j]$\uff0c\u4f7f\u5f97 $cov(i,r_j)=1$\u3002\n\n\u7136\u540e\u679a\u4e3e\u6240\u6709\u53f3\u7aef\u70b9 $j$\uff0c\u518d\u679a\u4e3e\u6240\u6709\u53f3\u7aef\u70b9\u4e3a $j$ \u7684\u533a\u95f4\uff08\u5373 $[p_{j,k},j]$ \uff09\uff0c\u82e5 $p_{j,k}> i$ \u4e14\u5b58\u5728\u4e00\u4e2a $x\\in [p_{j,k},j]$ \u6ee1\u8db3 $cov(i,x)=1$\uff0c\u5219 $cov(i,j)=1$\u3002\n\n\u81f3\u4e8e\u5982\u4f55\u5224\u65ad\u201c\u5b58\u5728\u4e00\u4e2a $x\\in [p_{j,k},j]$ \u6ee1\u8db3 $cov(i,x)=1$\u201d\uff0c\u53ef\u4ee5\u5728\u679a\u4e3e\u53f3\u7aef\u70b9\u6c42 $cov(i,j)$ \u7684\u540c\u65f6\u7528\u524d\u7f00\u548c\u8fdb\u884c\u5224\u65ad\uff0c\u5177\u4f53\u5b9e\u73b0\u89c1\u4ee3\u7801\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <vector>\n#define P 1000000007\nint n, m, pos[4005], sum[4005], dp0[4005], dp1[4005];\nbool cov[4005][4005];\nstd :: vector<int> p[4005];\nstruct node{\n\tint l, r;\n}a[2005];\nvoid add(int &x, int y){\n\t(x += y) >= P ? x -= P : 0;\n}\nint main(){\n\tscanf(\"%d\", &n);\n\tfor (register int i = 1; i <= n; ++i)\n\t\tscanf(\"%d%d\", &a[i].l, &a[i].r), pos[++m] = a[i].l, pos[++m] = a[i].r;\n\tstd :: sort(pos + 1, pos + 1 + m);\n\tm = std :: unique(pos + 1, pos + 1 + m) - pos - 1;\n\tfor (register int i = 1; i <= n; ++i){\n\t\ta[i].l = std :: lower_bound(pos + 1, pos + 1 + m, a[i].l) - pos + 1;\n\t\ta[i].r = std :: lower_bound(pos + 1, pos + 1 + m, a[i].r) - pos;\n\t\tp[a[i].r].push_back(a[i].l);\n\t}\n\t// \u4ee5\u4e0a\u5206\u522b\u4e3a\uff1a\u8f6c\u4e3a\u95ed\u533a\u95f4\u3001\u79bb\u6563\u3001\u5904\u7406 p\n\tfor (register int i = 1; i <= m; ++i){\n\t\tsum[i] = 0;\n\t\tfor (register int j = 1; j <= n; ++j)\n\t\t\tif (a[j].l == i) cov[i][a[j].r] = 1;\n\t\tfor (register int j = i; j <= m; ++j){\n\t\t\tfor (register int k = 0; k < p[j].size(); ++k)\n\t\t\t\tif (p[j][k] > i && sum[j] > sum[p[j][k] - 1]){ cov[i][j] = 1; break; } // \u6839\u636e\u524d\u7f00\u548c\u5224\u65ad\n\t\t\tsum[j + 1] = sum[j] + cov[i][j]; // \u540c\u65f6\u5904\u7406\u524d\u7f00\u548c\n\t\t}\n\t}\n\t// \u4ee5\u4e0a\u4e3a\u5904\u7406 cov\n\tdp0[0] = 1;\n\tfor (register int i = 1; i <= m; ++i){\n\t\tadd(dp0[i], dp0[i - 1]), add(dp0[i], dp1[i - 1]);\n\t\tfor (register int j = 1; j <= i; ++j)\n\t\t\tif (cov[j][i]) add(dp1[i], dp0[j - 1]);\n\t}\n\t// \u4ee5\u4e0a\u4e3a dp\n\tadd(dp0[m], dp1[m]), printf(\"%d\\n\", dp0[m]);\n}\n```\n",
        "postTime": 1551620498,
        "uid": 20561,
        "name": "AutumnKite",
        "ccfLevel": 10,
        "title": "\u300cAT1730\u300d\u300cCODE FESTIVAL 2015 OKINAWA OPEN\u300dHappy 2015"
    }
]
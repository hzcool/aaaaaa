[
    {
        "content": "\u7b80\u5355\u9898\u3002\u4e3a\u4ec0\u4e48\u6211\u5929\u5929\u505a\u7b80\u5355\u9898\u554a/ll\n\n---\n\n\u8003\u8651 $k=0$ \u7684\u65f6\u5019\uff0c\u8fde\u4e58\u7ecf\u5178\u7ec4\u5408\u610f\u4e49\uff0c\u76f8\u5f53\u4e8e\u7ed9\u6bcf\u6bb5\u4e2d\u95f4\u518d\u585e\u4e00\u4e2a\u70b9\uff0c\u7136\u540e\u6bcf\u6bb5\u4e2d\u95f4\u9009\u4e00\u4e2a\u70b9\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u7ec4\u5408\u6570\u3002\u5728 $k>0$ \u7684\u65f6\u5019\uff0c\u6bcf\u4e00\u6bb5\u662f\u72ec\u7acb\u7684\uff0c\u4e8e\u662f\u628a\u6bcf\u4e00\u6bb5\u7684\u591a\u9879\u5f0f\u5199\u51fa\u6765\u7136\u540e\u5206\u6cbb\u4e58\u5c31\u597d\u3002\n\n\u5177\u4f53\u6765\u8bf4\u5bf9\u4e8e $k=0$ \u65f6\u7b54\u6848\u4e3a $\\dbinom{n+m-1}{m+m-1}$\u3002\n\n\u5bf9\u4e8e\u4e24\u8fb9\u7684\u6bb5\u6765\u8bf4\uff0c\u53d6 $i$ \u4e2a\u7684\u8d21\u732e\u4e3a $\\dbinom{len+i-1}{i+i}$\u3002\n\n\u5bf9\u4e8e\u4e2d\u95f4\u7684\u6bb5\u6765\u8bf4\uff0c\u53d6 $i$ \u4e2a\u7684\u8d21\u732e\u4e3a $\\dbinom{len+i}{i+i+1}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log ^2 n)$\u3002\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e6;\nconst int maxn=1e6+10;\nconst int mod=998244353;\nconst int G=3;\nconst int iG=(mod+1)/3;\ninline int ksm(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1)res=1ll*res*x%mod;\n\t\tx=1ll*x*x%mod;y>>=1;\n\t}return res;\n}\n#define inf 1e9\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n\treturn x*f;\n}\nint fac[maxn],inv[maxn],ifc[maxn];\nint n,m,k,A[maxn];\ninline int com(int x,int y){\n\tif(x<0||y<0||x<y)return 0;\n\treturn 1ll*fac[x]*ifc[y]%mod*ifc[x-y]%mod;\n}\n#define vi vector<int>\nvi tr[maxn<<2];int Tr[maxn],a[maxn],b[maxn];\ninline void ntt(int *f,int len,int flg){\n\tfor(int i=0;i<len;i++)\n\t\tif(i<Tr[i])swap(f[i],f[Tr[i]]);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tint l=i/2,w=ksm(flg?G:iG,(mod-1)/i);\n\t\tfor(int j=0;j<len;j+=i){\n\t\t\tint wi=1;\n\t\t\tfor(int p=j;p<j+l;p++){\n\t\t\t\tint t=1ll*f[p+l]*wi%mod;\n\t\t\t\tf[p+l]=(f[p]-t+mod)%mod;\n\t\t\t\tf[p]=(f[p]+t)%mod;\n\t\t\t\twi=1ll*wi*w%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(!flg){\n\t\tint iv=ksm(len,mod-2);\n\t\tfor(int i=0;i<len;i++)\n\t\t\tf[i]=1ll*f[i]*iv%mod;\n\t}\n}\ninline void build(int h,int l,int r){\n\tif(l==r){\n\t\ttr[h].resize(A[l+1]-A[l]);\n\t\tfor(int i=0;i<A[l+1]-A[l];i++)\n\t\t\ttr[h][i]=com(A[l+1]-A[l]+i-(!l||l==k),i+i+1-(!l||l==k));\n\t\treturn;\n\t}int mid=(l+r)>>1;\n\tbuild(h<<1,l,mid),build(h<<1|1,mid+1,r);\n\tint len=1,Len=A[r+1]-A[l];tr[h].resize(Len);\n\twhile(len<Len+Len)len<<=1;\n\tfor(int i=1;i<len;i++)\n\t\tTr[i]=(Tr[i>>1]>>1)|((i&1)?len>>1:0);\n\tfor(int i=0;i<len;i++)a[i]=b[i]=0;\n\tfor(int i=0;i<tr[h<<1].size();i++)a[i]=tr[h<<1][i];\n\tfor(int i=0;i<tr[h<<1|1].size();i++)b[i]=tr[h<<1|1][i];\n\tntt(a,len,1),ntt(b,len,1);\n\tfor(int i=0;i<len;i++)a[i]=1ll*a[i]*b[i]%mod;\n\tntt(a,len,0);\n\tfor(int i=0;i<Len;i++)tr[h][i]=a[i];\n}\nint main(){\n\tfac[0]=inv[1]=ifc[0]=1;\n\tfor(int i=1;i<=N;i++)\n\t\tfac[i]=1ll*fac[i-1]*i%mod;\n\tfor(int i=2;i<=N;i++)\n\t\tinv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\n\tfor(int i=1;i<=N;i++)\n\t\tifc[i]=1ll*ifc[i-1]*inv[i]%mod;\n\tn=read(),m=read(),k=read();m-=k;\n\tfor(int i=1;i<=k;i++)A[i]=read();\n\tif(k==0)return printf(\"%d\\n\",1ll*fac[m]*com(n+m-1,m+m-1)%mod)&0;\n\tA[k+1]=n+1;build(1,0,k);\n\tprintf(\"%d\\n\",1ll*tr[1][m]*fac[m]%mod);\n\treturn 0;\n}\n```\n\n\u6df1\u6df1\u5730\u611f\u5230\u81ea\u5df1\u7684\u5f31\u5c0f\u3002",
        "postTime": 1677678515,
        "uid": 140876,
        "name": "syzf2222",
        "ccfLevel": 9,
        "title": "ABC225H Social Distance 2"
    }
]
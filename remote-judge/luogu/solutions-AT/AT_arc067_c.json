[
    {
        "content": "\u975e\u5e38\u4e00\u773c\u7684dp\u9898,\u4e0d\u77e5\u9053\u5f53\u521d\u4e3a\u5565\u6bcf\u770b\u51fa\u6765  \n\n\u8bbe$f[i][j]$\u8868\u793a\u76ee\u524d\u5df2\u7ecf\u5206\u5230\u4e86\u4eba\u6570\u4e3a$i$\u7684\u7ec4,\u7528\u4e86$j$\u4e2a\u4eba\u7684\u65b9\u6848\u6570\u662f\u591a\u5c11  \n\u4e0d\u96be\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b  \n$$\n\\begin{aligned}\nf[i][j]&=f[i-1][j]+\\sum^{D}_{k=C} f[i-1][j-ki]\\times C^{n-(j-ki)}_{ki}\\times\\ g[i][k] \\\\\n\\end{aligned}\n$$  \n\u5176\u4e2d$g[i][k]$\u662f\u4e00\u4e2a\u7cfb\u6570,\u8868\u793a\u6709$ik$\u4e2a\u4eba,$i$\u4e2a\u4eba\u4e3a\u4e00\u7ec4,\u5206\u6210$k$\u7ec4\u7684\u65b9\u6848\u6570\u6709\u591a\u5c11  \n\u800c$g[i][k]$\u4e5f\u975e\u5e38\u597d\u8ba1\u7b97,\u5176\u5b9e\u4f9d\u6b21\u4ece\u603b\u4eba\u6570\u4e2d\u9009\u51fa$i$\u4e2a\u4eba\u7684\u65b9\u6848\u6570,\u5373$\\sum C^{ik-it}_{i}$  \n\u4f46\u662f\u7531\u4e8e\u5148\u9009\u540e\u9009\u90fd\u5c5e\u4e8e\u540c\u4e00\u79cd\u65b9\u6848,\u56e0\u6b64\u6700\u540e\u8fd8\u8981\u518d\u9664\u4e00\u4e2a$k!$  \n\u521d\u59cb\u5316\u4e3a$f[A-1][0]=1$,$ans=f[B][N]$  \n\u56e0\u4e3a\u679a\u4e3e$k$\u7684\u8fc7\u7a0b\u662f\u8c03\u548c\u7ea7\u6570,\u56e0\u6b64\u590d\u6742\u5ea6\u4e3a$O(n^2logn)$\n\n\n _Code_ \n------------\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define ri register int\n#define ll long long\nil ll read(){\n    bool f=true;ll x=0;\n    register char ch=getchar();\n    while(ch<'0'||ch>'9') {if(ch=='-') f=false;ch=getchar();}\n    while(ch>='0'&&ch<='9') x=(x<<3)+(x<<1)+(ch^48),ch=getchar();\n    if(f) return x;\n    return ~(--x);\n}\nil void write(const ll &x){if(x>9) write(x/10);putchar(x%10+'0');}\nil void print(const ll &x) {x<0?putchar('-'),write(~(x-1)):write(x);putchar('\\n');}\nil int max(const int &a,const int &b){return a>b?a:b;}\nil int min(const int &a,const int &b){return a<b?a:b;}\n/*\n*/\nconst ll mod=1e9+7;\nconst int MAXN=1e3+7;\nil ll ksm(ll d,ll tim){\n    ll rest=1;\n    while(tim){\n        if(tim&1) rest=rest*d%mod;\n        d=d*d%mod;\n        tim>>=1;\n    }\n    return rest;\n}\nll jc[MAXN],inv[MAXN];\nvoid init(int n=1e3){\n    jc[0]=1;\n    for(ri i=1;i<=n;++i)\n        jc[i]=i*jc[i-1]%mod;\n    inv[n]=ksm(jc[n],mod-2);\n    for(ri i=n-1;~i;--i)\n        inv[i]=(i+1)*inv[i+1]%mod;\n}\nil ll C(ll x,ll y){\n    if(x<y) return 0;\n    return jc[x]*inv[y]%mod*inv[x-y]%mod;\n}\nll f[MAXN][MAXN],g[MAXN][MAXN],n,a,b,c,d;\nint main(){\n    init();\n    n=read(),a=read(),b=read(),c=read(),d=read();\n    for(ri i=1;i<=n;++i){\n        for(ri j=1;j*i<=n;++j){\n            g[i][j]=1;\n            for(ri k=i*j;k;k-=i) g[i][j]=g[i][j]*C(k,i)%mod;\n            g[i][j]=g[i][j]*inv[j]%mod;\n        }\n    }\n    f[a-1][0]=1;\n    for(ri i=a;i<=b;++i){\n        for(ri j=0;j<=n;++j){\n            f[i][j]=f[i-1][j];\n            for(ri k=c;k*i<=j&&k<=d;++k){\n                f[i][j]=(f[i][j]+f[i-1][j-k*i]*C(n-(j-k*i),k*i)%mod*g[i][k]%mod)%mod;\n            }\n        }\n    }\n    print(f[b][n]);\n    return 0;\n}\n```\n",
        "postTime": 1614065129,
        "uid": 206998,
        "name": "Krimson",
        "ccfLevel": 0,
        "title": "ARC067C"
    },
    {
        "content": "\u633a\u597d\u7684\u8ba1\u6570\u9898\uff0c\u4f46\u662f\u6709\u4e00\u6b65\u8fd8\u662f\u9700\u8981\u5b66\u957f\u6765\u6559\u6211\u4e00\u4e0b qwq\u3002\n\n\u633a\u663e\u7136\u7684\uff0c\u6211\u4eec\u8bbe $f_{i,j}$ \u8868\u793a\u524d $i$ \u4e2a\u4eba\u7684\u7ec4\u5df2\u7ecf\u7528\u4e86 $j$ \u4e2a\u4eba\u3002\n\n\u5c31\u662f $i$ \u662f\u4ece $[a,b]$ \u679a\u4e3e\uff0c\u7136\u540e\u6211\u4eec\u8003\u8651\u8f6c\u79fb\u3002\n\n\u4e00\u79cd\u7b80\u5355\u7684\u60f3\u6cd5\u5c31\u662f\u679a\u4e3e\u5f53\u524d\u8fd9\u7ec4\u6709\u591a\u5c11\u4e2a $k$ \u5728 $[c,d]$ \u7684 $k$\u3002\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u5982\u4f55\u5728\u5269\u4e0b\u7684\u6570\u91cc\u9762\u6311\u51fa\u6765\u4e00\u4e9b\u6570\uff0c\u4f7f\u5f97\u4ed6\u4eec\u53d8\u6210\u7b26\u5408\u6761\u4ef6\u7684\u7ec4\u6570\u3002\n\n\u95ee\u9898\u8f6c\u5316\u4e3a\u7ed9\u5b9a\u82e5\u5e72\u4e0d\u540c\u7684\u7403\uff0c\u628a\u4ed6\u4eec\u88c5\u8fdb\u540c\u6837\u7684\u76d2\u5b50\u91cc\u9762\uff0c\u7136\u540e\u6c42\u65b9\u6848\u6570\uff0c\u6bcf\u4e2a\u76d2\u5b50\u88c5\u7684\u5fc5\u987b\u4e00\u6837\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u7403\u5148\u91cd\u6392\u4e00\u4e0b\uff0c\u7136\u540e\u5bf9\u4e8e\u7ec4\u5185\u7684\u4e0d\u80fd\u91cd\u6392\u5c31\u9664\u4ee5 $(\\dfrac{n}{m}!)^m$\uff0c\u6bcf\u4e2a\u7ec4\u90fd\u672c\u8d28\u76f8\u540c\uff0c\u4e0d\u80fd\u91cd\u6392\u4e8e\u662f\u518d\u9664\u4ee5 $m!$ \uff0c\u7136\u540e\u9009\u62e9\u662f\u4ece\u539f\u5e8f\u5217\u91cc\u9762\u9009\u62e9 $n$ \u4e2a\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u6837\u590d\u6742\u5ea6\u597d\u50cf\u6709\u70b9\u4e0d\u592a\u5bf9\uff0c\u4f46\u662f\u8fdb\u4e00\u6b65\u4f18\u5316\u7684\u8bdd\u8fd9\u4e2a $k$ \u7684\u4e0a\u754c\u662f\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u8c03\u548c\u7ea7\u6570\u7684\u4e1c\u897f\uff0c\u4e8b\u5b9e\u4e0a\u5b83\u662f $O(n^2 \\log^2 n)$\uff0c\u8fd8\u6709\u4e00\u4e2a $\\log$ \u662f\u5185\u90e8\u7684\u5feb\u901f\u5e42\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long \nusing namespace std;\nconst int INF=1005;\nconst int INFN=1e6+5;\nconst int Mod=1e9+7;\nint fav[INFN],ifav[INFN],f[INF][INF],a,b,c,d,n;\n\nint ksm(int x,int y) {\n\tint ba=x%Mod,ans=1;\n\twhile (y) {\n\t\tif (y&1) ans=(ans*ba)%Mod;\n\t\tba=(ba*ba)%Mod;y>>=1;\n\t}\n\treturn ans;\n}\nint C(int x,int y) {\n\tif (x-y<0) return 0;\n\treturn fav[x]*ifav[y]%Mod*ifav[x-y]%Mod;\n}\nvoid init() {\n\tint N=1e5;fav[0]=1;\n\tfor (int i=1;i<=N;i++) fav[i]=fav[i-1]*i%Mod;\n\tifav[N]=ksm(fav[N],Mod-2);\n\tfor (int i=N-1;~i;i--) ifav[i]=ifav[i+1]*(i+1)%Mod;\n\treturn ;\n}\nint solve(int x,int y,int z) {\n\tint sum=fav[y*z];\n\tsum*=ksm(ksm(fav[y],z),Mod-2);sum%=Mod;\n\tsum*=ksm(fav[z],Mod-2);sum%=Mod;\n\t// for (int i=1;i<=z;i++)\t\n\t// \tsum*=ifav[y],sum%=Mod;\n\t// for (int i=1;i<=z;i++)\n\t// \tsum*=C(x,y),x-=y,sum%=Mod;\n\t// if (x<0) return 0;\n\treturn C(x,y*z)%Mod*sum%Mod;\n}\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tinit();\n\tcin>>n>>a>>b>>c>>d;\n\tf[a-1][0]=1;\n\tfor (int i=a;i<=b;i++) {\n\t\tfor (int j=0;j<=n;j++) {\n\t\t\tfor (int k=c;k<=min(d,(j)/i);k++) {\n\t\t\t\tf[i][j]+=f[i-1][j-k*i]*solve(n-(j-k*i),i,k)%Mod,f[i][j]%=Mod;\n\t\t\t}\n\t\t\tf[i][j]+=f[i-1][j];\n\t\t\tf[i][j]%=Mod;\n\t\t\t// cout<<i<<\" \"<<j<<\" \"<<f[i][j]<<\" ??\\n\";\n\t\t}\n\t}\n\tcout<<f[b][n]<<\"\\n\";\n\treturn 0;\n}\n```\n",
        "postTime": 1667465820,
        "uid": 208653,
        "name": "_edge_",
        "ccfLevel": 0,
        "title": "AT_arc067_c"
    },
    {
        "content": "### Preface  \n\u597d\u9898\u597d\u9898\u3002  \n### Problem  \n\n\u6709 $N$ \u4e2a\u4eba\uff0c\u7f16\u53f7\u4f9d\u6b21\u662f $1,2,\\cdots ,N$, \u73b0\u5728\u8981\u5c06\u4ed6\u4eec\u5206\u6210\u82e5\u5e72\u7ec4\uff0c\u6ee1\u8db3\uff1a\n\n- \u6bcf\u4e00\u7ec4\u7684\u4eba\u6570\u5747\u5728 $[A,B]$ \u4e4b\u95f4\u3002\n\n- \u8bb0$F_i$\u4e3a\u5f53\u524d\u5206\u7ec4\u65b9\u6848\u4e2d\u4eba\u6570\u4e3a$i$\u7684\u7ec4\u7684\u6570\u91cf\uff0c\u5219 $F_i$ \u5e94\u6ee1\u8db3 $F_i=0$ \u6216   $C\\leq F_i\\leq D$.\n\n\u5176\u4e2d $A,B,C,D$ \u5747\u4e3a\u7ed9\u5b9a\u503c\u3002\n\n\u6c42\u672c\u8d28\u4e0d\u540c\u7684\u5206\u7ec4\u65b9\u6848\u6570\u5bf9 $10^9+7$ \u53d6\u6a21\u540e\u7684\u7ed3\u679c\u3002\u4e24\u79cd\u65b9\u6848\u662f\u672c\u8d28\u4e0d\u540c\u7684\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728\u4e24\u4e2a\u4eba\u4f7f\u5f97\u5728\u7b2c\u4e00\u79cd\u65b9\u6848\u4e2d\u4ed6\u4eec\u5728\u540c\u4e00\u7ec4\uff0c\u800c\u5728\u7b2c\u4e8c\u79cd\u65b9\u6848\u4e2d\u4e0d\u662f\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leq N\\leq 10^3,1\\leq A\\leq B\\leq N,1\\leq C\\leq D\\leq N$  \n### Solution  \n\u6570\u636e\u8303\u56f4\u652f\u6301 $O(n^2)$\uff0c\u540c\u65f6\u53d1\u73b0\u8fd9\u4e2a\u95ee\u9898\u5f88\u6709\u89c4\u5f8b\u53ef\u4ee5\u8fdb\u884c dp\u3002   \n\u4e8e\u662f\u6211\u4eec\u76f4\u63a5\u8bbe dp \u72b6\u6001\u4e3a $dp_{x,y}$\uff0c\u8868\u793a\u9009\u5230\u4eba\u6570\u4e3a $x$ \u7684\u7ec4\u4e14\u8fd8\u5269 $y$ \u4e2a\u4e92\u4e0d\u76f8\u540c\u7684\u4eba\u5f85\u5206\u914d\u3002  \n\u5f97\u51fa\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a  \n$$dp_{x,y}=\\sum _{i=c}^{i\\leq d}(\\prod _{j=1}^{j\\leq i}C^x_{y-x*(j-1)})dp_{x+1,y-xi}\u00d7\\frac{1}{i!}$$  \n\u6700\u540e\u4e58\u4ee5 $\\frac{1}{i!}$ \u662f\u56e0\u4e3a\u786e\u5b9a\u6bcf\u7ec4\u4e2d\u5143\u7d20\u540e\u540c\u6837\u7684\u7ec4\u7684\u7ec4\u5408\u4f1a\u6709 $i!$ \u4e2a\u3002  \n\n\u5176\u4e2d $j$ \u7684\u8fde\u4e58\u53ef\u4ee5\u88ab\u4f18\u5316\u3002  \n\u7136\u540e\u8fd9\u4e2a\u67ff\u5b50\u7684\u590d\u6742\u5ea6\u5c31\u5927\u6982\u53d8\u6210\u4e86\uff1a  \n$$O(n^2\\sum_{i=a}^{i\\leq b}\\frac{n}{i})$$  \n\u6839\u636e\u8c03\u548c\u7ea7\u6570\uff0c\u590d\u6742\u5ea6\u5927\u81f4\u4e3a\uff1a  $O(n^2\\log n)$  \n\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\ncode\uff1a  \n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int N=1010;\nconst ll mod=1e9+7;\nll n,a,b,c,d;ll x,y;\nll dp[N][N];ll f[N];ll inv[N];bool vis[N][N];\nvoid exgcd(ll a,ll b){\n  \tif(!b){x=1,y=0;return;}\n  \texgcd(b,a%b);ll t=x;\n  \tx=y,y=t-a/b*y;\n}\nll C(int x,int y){\n\tif(x==y||y==0)return 1;\n\treturn (f[x]*inv[y]%mod*inv[x-y]%mod)%mod;\n}\nll dfs(int x,int y){\n\t//printf(\"%d %d\\n\",x,y);\n\tif(y==0&&x==b+1)return 1;\n\tif(x==b+1)return 0;\n\tif(vis[x][y])return dp[x][y];\n\tvis[x][y]=true;dp[x][y]+=dfs(x+1,y);ll tmp=1;\n\tfor(int i=1;i<=d;i++){\n\t\tif(x*i>y)break;\n\t\ttmp*=C(y-x*(i-1),x);tmp%=mod;\n\t\tif(i>=c){\n\t\t\tdp[x][y]+=((dfs(x+1,y-x*i)*tmp%mod)*inv[i])%mod;\n\t\t\tdp[x][y]%=mod;\n\t\t}\n\t}return dp[x][y];\n}\nint main(){\n\tscanf(\"%lld%lld%lld%lld%lld\",&n,&a,&b,&c,&d);\n\tf[0]=1;\n\tfor(int i=1;i<=n;i++){\n\t\tf[i]=f[i-1]*i;f[i]%=mod;\n\t\texgcd(f[i],mod);\n\t\tinv[i]=(x%mod+mod)%mod;\n\t}\n\tprintf(\"%lld\",dfs(a,n));\n\treturn 0;\n}\n```\n",
        "postTime": 1660135441,
        "uid": 213173,
        "name": "\u5c0f\u6728\u866b",
        "ccfLevel": 4,
        "title": "\u3010Atcoder\u601d\u7ef4\u8bad\u7ec3\u3011[ARC067C] Grouping"
    }
]
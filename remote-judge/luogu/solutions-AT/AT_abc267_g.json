[
    {
        "content": "\u5148\u7ed9\u6570\u5217\u4ece\u5c0f\u5230\u5927\u6392\u4e2a\u5e8f\u3002\n\n\u63a5\u4e0b\u6765\u8bbe $f_{i,j}$ \u8868\u793a\u524d $i$ \u4e2a\u6570\u7684\u6392\u5217\u5f62\u6210 $j$ \u4e2a\u4e0a\u5761\u7684\u65b9\u6848\u6570\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u8f6c\u79fb\uff0c\u5206\u4e3a\u63d2\u5165\u7b2c $i$ \u4e2a\u6570\u540e\u589e\u52a0\u4e0a\u5761\u548c\u4e0d\u589e\u52a0\u4e0a\u5761\u4e24\u79cd\u60c5\u51b5\u3002\n\n\u5bf9\u4e8e\u4e0d\u589e\u52a0\u7684\u60c5\u51b5\uff0c\u6709\u4e09\u79cd\u53ef\u80fd\uff1a\n\n- \u7b2c $i$ \u4e2a\u6570\u63d2\u5165\u5728\u4e86\u6570\u5217\u7684\u6700\u524d\u7aef\uff0c\u6709 $1$ \u79cd\u65b9\u6848\u3002\n- \u7b2c $i$ \u4e2a\u6570\u63d2\u5165\u5728\u4e86\u4e00\u4e2a\u4e0a\u5761\u7684\u4e2d\u95f4\uff0c\u56e0\u4e3a\u4e0a\u5761\u4e2d\u8f83\u5c0f\u7684\u90a3\u4e2a\u6570\u5b57\u5fc5\u5b9a\u5c0f\u4e8e\u7b2c $i$ \u4e2a\u6570\uff0c\u5f62\u6210\u4e00\u4e2a\u4e0a\u5761\uff0c\u8f83\u5927\u7684\u90a3\u4e2a\u6570\u5b57\u5fc5\u5b9a\u5c0f\u4e8e\u7b49\u4e8e\u7b2c $i$ \u4e2a\u6570\uff0c\u4e0d\u5f62\u6210\u4e0a\u5761\uff0c\u800c\u6211\u4eec\u62c6\u6563\u4e86\u4e00\u4e2a\u4e0a\u5761\uff0c\u6545\u6ca1\u6709\u589e\u52a0\uff0c\u6709 $j$ \u79cd\u65b9\u6848\u3002\n- \u7b2c $i$ \u4e2a\u6570\u63d2\u5165\u5728\u4e86\u6570\u503c\u76f8\u540c\u7684\u6570\u540e\u9762\uff0c\u8fd9\u4e2a\u8bb0\u4e3a $same_i$\uff0c\u6709 $same_i$ \u79cd\u65b9\u6848\u3002\n\n\u5bf9\u4e8e\u589e\u52a0\u7684\u60c5\u51b5\uff0c\u5c31\u662f\u51cf\u53bb\u8fd9\u4e09\u79cd\u60c5\u51b5\u4e86\uff0c\u4e0d\u8fc7\u589e\u52a0\u4e86\uff0c\u5c31\u8bf4\u660e\u539f\u6765\u53ea\u6709 $j-1$ \u4e2a\u4e0a\u5761\uff0c\u8fd9\u91cc\u548c\u4e0a\u9762\u4e0d\u592a\u4e00\u6837\u3002\n\n\u6574\u7406\u5f0f\u5b50\uff0c\u5f97\uff1a\n\n$$ \nf_{i,j} = f_{i-1,j-1} \\times (i - j - same_i) + f_{i-1,j} \\times (1 + j + same_i)\n$$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5 $O(n^2)$ \u6c42\u5f97\u4e86,\u53ef\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\u3002\n\n\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nlong long n, k, a[5005], f[5005], same[5005], sum;\nint main() {\n    cin >> n >> k;\n    for (int i = 1; i <= n; i++) {\n        cin >> a[i];\n    }\n    sort(a + 1, a + n + 1);\n    for (int i = 1; i <= n; i++) {\n        if (a[i] == a[i - 1])\n            same[i] = same[i - 1] + 1;\n    }\n    f[0] = 1;\n    for (int i = 1; i <= n; i++) {\n        for (int j = i - same[i]; j >= 1; j--) {\n            f[j] = f[j - 1] * (i - j - same[i]) % 998244353 + f[j] * (1 + j + same[i]) % 998244353;\n            f[j] %= 998244353;\n        }\n        f[0] = f[0] * (1 + same[i]) % 998244353;\n    }\n    cout << f[k] << endl;\n}\n```\n\n# After Increasing K Times\n\n\u8fc7\u4e86\u4e00\u6bb5\u65f6\u95f4\u91cd\u65b0\u770b\u4e86\u4e00\u4e0b\u8fd9\u9053\u9898\uff0c\u53d1\u73b0\u6709\u51e0\u4e2a\u4f18\u5316\uff0c\u4e5f\u987a\u4fbf\u4ecb\u7ecd\u4e00\u4e0b\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u53d1\u73b0 $n$ \u5f88\u5927\uff0c\u4f46\u662f\u6570\u503c\u533a\u95f4\u5f88\u5c0f\uff0c\u6240\u4ee5\u8003\u8651\u4f7f\u7528\u6876\u6392\u5e8f\uff0c\u56e0\u4e3a\u6570\u5b57\u5728 $[1,n]$,\u6240\u4ee5\u6392\u5e8f\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\n\n\u7136\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u679a\u4e3e\u533a\u95f4\u53ef\u4ee5\u7f29\u5c0f\uff0c\u56e0\u4e3a\u6211\u4eec\u5e76\u4e0d\u662f\u5168\u90fd\u9700\u8981\uff0c\u7b80\u5355\u7528\u4e00\u4e2a\u56fe\u8868\u793a\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8atzkj69.png)\n\n\u5de6\u8fb9\u662f\u6211\u4eec\u9700\u8981\u7684\u503c\uff0c\u53f3\u8fb9\u662f\u4e0d\u9700\u8981\u7684\u3002\n\n\u90a3\u4e48\uff0c\u6709\u7528\u7684\u72b6\u6001\u7684\u533a\u95f4\u8fb9\u754c\u5f88\u597d\u63a8\u7b97\uff0c\u662f $[k+n-i+1,k]$\uff0c\u8fd9\u4e2a\u4f18\u5316\u53ef\u4ee5\u51cf\u5c11\u63a5\u8fd1\u4e00\u534a\u7684\u65f6\u95f4\u3002\n\n\u4ee5\u4e0a\u4f18\u5316\u8ba9\u4ee3\u7801\u5927\u5927\u63d0\u901f\uff0c\u83b7\u5f97\u4e86\u6d1b\u8c37\u6700\u4f18\u89e3\uff0c\u5728 AtCoder \u6392\u540d\u7b2c\u4e8c\uff08\u622a\u81f32022.11.23\uff09\u3002\n\n\u7b2c\u4e00\u540d\u672c\u4eba\u4e27\u5fc3\u75c5\u72c2\u5361\u5e38\u4e5f\u5361\u4e0d\u8fc7\uff0c\u5feb\u4e86 4ms\uff0c\u4f46\u662f\u672c\u4ee3\u7801\u5f88\u77ed\uff0c\u6700\u5feb\u4ee3\u7801\u4f7f\u7528\u4e86 IDFT\u3002\n\n```cpp\n#include <stdio.h>\ninline int read() {\n    char c = getchar();\n    int sum = 0;\n    while (c < '0' || c > '9') c = getchar();\n    do {\n        sum = (sum << 3) + (sum << 1) + c - '0';\n        c = getchar();\n    } while (c >= '0' && c <= '9');\n    return sum ;\n}\nint n, k,s[5005],b[5005],t=1;\nlong long f[5005];\nint main() {\n    n=read(),k=read();\n    for (int i = 1; i <= n; i++)b[read()]++;\n    for(int i=1;i<=n&&t<=n;i++)\n    {\n    \tif(b[i])b[i]--,t++;\n    \twhile(b[i])b[i]--,s[t] = s[t - 1] + 1,t++;\n\t} \n    f[0] = 1;\n    for (int i = 1; i <= n; i++) {\n\t\tint r=(k>i-s[i])?(i-s[i]):k,l=(k-n+i-1>1)?(k-n+i-1):1;\n        for (int j = r; j >= l; j--) {\n            f[j] = f[j] * (j + s[i] + 1) + f[j - 1] * (i - j - s[i]) ;\n            f[j] %= 998244353;\n        }\n        f[0] = f[0] * (s[i] + 1) % 998244353;\n    }\n    printf(\"%lld\\n\",f[k]);\n    return 0;\n}\n```",
        "postTime": 1668324007,
        "uid": 501947,
        "name": "DengDuck",
        "ccfLevel": 6,
        "title": "ABC267G Increasing K Times \u9898\u89e3"
    },
    {
        "content": "\u521a\u5b66\u5b8c\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u65b0\u9898\u505a\u4e0d\u52a8\u4e86\u56de\u6765\u8865\u8ba1\u6570dp\uff0c\u7ed3\u679c\u53d1\u73b0\u8fd9\u9898\u4e0d\u662f\u4e8c\u9879\u5f0f\u53cd\u6f14\u677f\u5b50\u9898\u5417\uff1f\n\n\u5148\u5c06 $a$ \u6392\u5e8f\uff0c\u8003\u8651\u5c06 $a$ \u4e2d\u5143\u7d20\u5347\u5e8f\u63d2\u5165\u6392\u5217\u4e2d\uff0c\u7684\u8bbe $dp_{i,j}$ \u4e3a\u63d2\u5165\u4e86 $i$ \u4e2a\u6570\u540e\u81f3\u5c11\u6709 $j$ \u4e2a\u6ee1\u8db3 $a_{p_i}<a_{p_{i+1}}$ \u7684\u6392\u5217\u7684\u65b9\u6848\u6570\uff08\u5148\u4e0d\u8003\u8651\u5176\u4ed6\u5143\u7d20\uff09\u3002\u8bbe\u5f53\u524d\u5143\u7d20\u4e3a $i$\uff0c\u6709 $x$ \u4e2a\u5143\u7d20\u4e25\u683c\u5c0f\u4e8e $a_i$\uff0c\u5219\u8f6c\u79fb\u65b9\u7a0b\u5219\u4e3a $dp_{i,j}=dp_{i,j-1}+(x-j+1)\\times dp_{i-1,j-1}$\u3002\n\n\u56e0\u4e3a\u521a\u521a\u6ca1\u6709\u8003\u8651\u6ca1\u6709\u88ab\u9009\u4e2d\u7684\u5176\u4ed6\u5143\u7d20\uff0c\u6240\u4ee5\u4e3a\u4e86\u8003\u8651\u8fdb\u53bb\u5176\u4ed6\u5143\u7d20\uff0c\u73b0\u5728\u8bbe $f(i)=(n-i)!\\times f_{n,i}$\u3002\n\n\u8bbe $g(i)$ \u4e3a\u6ee1\u8db3 $(\\sum\\limits^{n-1}_{j=1} [a_{p_j}<a_{p_{j+1}}])=i$ \u7684\u6392\u5217\u7684\u65b9\u6848\u6570\uff0c\u663e\u7136 $f(i)=\\sum\\limits^n_{j=i}\\binom{j}{i}g(i)$\uff0c\u7531\u4e8c\u9879\u5f0f\u53cd\u6f14\u53ef\u77e5 $g(i)=\\sum\\limits^{n}_{j=i}(-1)^{j-i}\\binom{j}{i}f(i)$\u3002\u7b54\u6848\u5373\u4e3a $g(k)$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(n^2)$\u3002\n\n\u7a0b\u5e8f\u53ea\u7ed9\u51fa\u4e3b\u4f53\u90e8\u5206\uff0c\u4e3b\u8981\u662f\u524d\u9762\u4e00\u90e8\u5206\u7684\u6a21\u677f\u6709\u4e00\u4e9b\u5f71\u54cd\u89c2\u611f\uff0c\u800c\u4e14\u7ed9\u51fa\u4e3b\u4f53\u5df2\u7ecf\u80fd\u591f\u8f85\u52a9\u7406\u89e3\u3002\n\n```cpp\n//Linkwish's code\nconst int N=5005,jqh=998244353;\nint n,m;\nint a[N];\nint f[N][N];\ninline int qpow(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1)res=x*res%jqh;\n\t\tx=x*x%jqh;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\nint p[N],inv[N];\ninline void init(){\n\tp[0]=1;\n\tfor(int i=1;i<=n;i++)p[i]=p[i-1]*i%jqh;\n\tinv[n]=qpow(p[n],jqh-2);\n\tfor(int i=n-1;~i;i--)inv[i]=inv[i+1]*(i+1)%jqh;\n}\ninline int c(int x,int y){\n\treturn p[x]*inv[y]%jqh*inv[x-y]%jqh;\n}\nsigned main(){\n\tread(n),read(m);\n\tinit();\n\tfor(int i=1;i<=n;i++)read(a[i]);\n\tsort(a+1,a+1+n);\n\tint now=0;\n\tfor(int i=1;i<=n;i++){\n\t\twhile(a[now+1]<a[i])now++;\n\t\tf[i][0]=1;\n\t\tfor(int j=1;j<=now;j++)\n\t\t\tf[i][j]=(f[i-1][j]+f[i-1][j-1]*(now-j+1)%jqh)%jqh;\n\t}\n\tfor(int i=0;i<=n;i++)f[n][i]=f[n][i]*p[n-i]%jqh;\n\tint ans=0;\n\tfor(int i=m;i<=n;i++){\n\t\tif((i-m)&1)ans=(ans-c(i,m)*f[n][i]%jqh+jqh)%jqh;\n\t\telse ans=(ans+c(i,m)*f[n][i]%jqh)%jqh;\n\t}\n\twriteln(ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1670299843,
        "uid": 408180,
        "name": "LinkWish",
        "ccfLevel": 7,
        "title": "ABC267G\u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_abc267_g)\n\n## \u601d\u8def\n\n\u5f88\u50bb\u903c\u7684 $\\rm G$\uff0c\u5f53\u65f6\u6211\u4e0d\u4f1a\uff0c\u8865\u9898\u7684\u65f6\u5019\u79d2\u4e86\u3002\n\n\u8f6c\u6362\u9898\u610f\u4e3a\u5c06\u5e8f\u5217 $a$ \u91cd\u6392\uff0c\u4e0d\u59a8\u8bbe $b$ \u4e3a\u91cd\u6392\u540e\u7684 $a$ \u5e8f\u5217\uff0c\u73b0\u5728\u5c06 $b$ \u5212\u5206\u6210\u82e5\u5e72\u4e0d\u4e0a\u5347\u8fde\u7eed\u6bb5\uff0c\u6c42\u6bb5\u6570\u6070\u597d\u4e3a $k+1$ \u7684\u65b9\u6848\u6570\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u6b64\u65f6\u5e8f\u5217 $a$ \u7684\u987a\u5e8f\u6ca1\u6709\u4efb\u4f55\u7528\uff0c\u6211\u4eec\u76f4\u63a5 $\\rm sort$ \u4e00\u4e0b\uff0c\u53d8\u6210\u4ece\u5c0f\u5f80\u5927\u52a0\u6570\u3002\n\n\u6b64\u65f6\u6211\u4eec\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n+ $a_i$ \u52a0\u5230\u4e86\u67d0\u4e00\u6bb5\u6bb5\u5934\u7684\u5de6\u8fb9\uff0c\u6b64\u65f6\u6bb5\u6570\u4e0d\u4f1a\u589e\u52a0\u3002\n\n+ $a_i$ \u52a0\u5230\u4e86\u67d0\u4e00\u6bb5\u4e2d\u95f4\uff0c\u6b64\u65f6\u4f1a\u65b0\u589e\u4e00\u6bb5\u3002\n\n\u6ce8\u610f\u4f1a\u51fa\u73b0 $a_i$ \u6709\u76f8\u540c\u7684\u60c5\u51b5\uff0c\u6b64\u65f6 $a_i$ \u52a0\u5230\u524d\u9762\u4e0e $a_i$ \u76f8\u540c\u7684\u90a3\u4e9b\u6bb5\u6bb5\u5934\u53f3\u8fb9\u6bb5\u6570\u4e5f\u4e0d\u4f1a\u589e\u52a0\uff0c\u7a0d\u5fae\u641e\u4e00\u641e\u5c31\u597d\u4e86\u3002\n\n\u7136\u540e\u5c31\u7ed3\u675f\u4e86\uff0c\u975e\u5e38\u7b80\u5355\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(nk)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n//A tree without skin will surely die.\n//A man without face is invincible.\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nint const N=5e3+10;\nint const mod=998244353;\nint a[N],f[N][N],vis[N];\nsigned main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(0),cout.tie(0);\n\tint n,k;cin>>n>>k;++k;\n\tfor (int i=1;i<=n;++i) cin>>a[i];\n\tsort(a+1,a+n+1);f[0][0]=1;\n\tfor (int i=1;i<=n;++i){\n\t\tfor (int j=0;j<=min(i,k);++j)\n\t\t\tf[i][j]+=f[i-1][j]*(j+vis[a[i]])%mod,f[i][j]%=mod;\n\t\tfor (int j=1;j<=min(i,k);++j)\n\t\t\tf[i][j]+=f[i-1][j-1]*(i-(j-1)-vis[a[i]])%mod,f[i][j]%=mod;\n\t\t++vis[a[i]];\n\t}\n\tcout<<f[n][k]<<'\\n';\n\treturn 0;\n}\n```",
        "postTime": 1674876660,
        "uid": 253608,
        "name": "Tx_Lcy",
        "ccfLevel": 7,
        "title": "[ABC267G] Increasing K Times"
    },
    {
        "content": "# ABC267G \u9898\u89e3\n\n## \u601d\u8def\u5206\u6790\n\n\u8003\u8651\u8f6c\u5316\u539f\u64cd\u4f5c\u6210\uff1a\u5728\u4e00\u4e2a\u7a7a\u5e8f\u5217\u4e2d\u987a\u6b21\u63d2\u5165 $a_1\\sim a_n$\uff0c\u6ce8\u610f\u5230 $a_1\\sim a_n$ \u7684\u987a\u5e8f\u4e0d\u5f71\u54cd\u7b54\u6848\uff0c\u6545\u8bbe $a_1\\sim a_n$ **\u5355\u8c03\u4e0d\u964d**\n\n\u6b64\u65f6\u8bbe $dp_{i,j}$ \u8868\u793a\u63d2\u5165 $a_1\\sim a_i$\uff0c\u5176\u4e2d\u6709 $j$ \u5bf9 $a_{k-1}<a_k$ \u7684\u65b9\u6848\u6570\uff0c\u8bb0 $cnt_k$ \u8868\u793a $a_1\\sim a_i$ \u4e2d\u6709\u51e0\u4e2a\u4e2a\u503c\u4e3a $k$ \u7684\u6570\n\n\u8003\u8651\u63d2\u5165 $a_{i+1}$ \u7684\u65f6\u5019\uff0c\u4ec0\u4e48\u65f6\u5019\u4e0d\u6539\u53d8 $a_{k-1}<a_k$ \u7684\u6570\u5bf9\u7684\u6570\u91cf\n\n1. \u63d2\u5165\u4e86\u4e00\u4e2a\u503c\u4e0e $a_{i+1}$ \u76f8\u540c\u7684\u6570\u7684\u540e\u9762\uff0c\u6709 $cnt_{a_{i+1}}$ \u79cd\u60c5\u51b5\n2. \u63d2\u5165\u4e86\u4e00\u5bf9 $a_{k-1}<a_k$ \u7684\u4e2d\u95f4\uff0c\u53d8\u6210 $a_{k-1}<a_i\\ge a_k$\uff0c\u663e\u7136\u589e\u52a0\u4e00\u5bf9\u51cf\u5c11\u4e00\u5bf9\uff0c\u4e0d\u6539\u53d8\u603b\u6570\uff0c\u6709 $j$ \u79cd\u60c5\u51b5\n3. \u63d2\u5165\u6700\u524d\u9762\uff0c\u6709 $1$ \u79cd\u60c5\u51b5\n\n\u5171\u6709 $cnt_{a_{i+1}}+k+1$ \u79cd\u60c5\u51b5\n\n\u6ce8\u610f\u5230\u63d2\u5165 $a_{i+1}$ \u603b\u5171\u6709 $i+1$  \u79cd\u60c5\u51b5\uff0c\u76f8\u51cf\u53ef\u5f97\uff1a\u63d2\u5165 $a_{i+1}$ \u540e\u589e\u52a0\u4e00\u5bf9 $a_{k-1}<a_k$ \u7684\u65b9\u6848\u6570\u6709 $i-cnt_{a_{i+1}}-k$ \u79cd\n\n\u56e0\u6b64\u76f4\u63a5\u5237\u8868\u8f6c\u79fb\u5373\u53ef\uff0c\u8fb9\u754c\u6761\u4ef6 $dp_{0,0}=1$\n\n\u53ef\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u6389\u7b2c\u4e00\u7ef4\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\Theta(n)$\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(nk)$\n\n## \u4ee3\u7801\u5448\u73b0\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int MAXN=5005,MOD=998244353;\nint a[MAXN],dp[MAXN][MAXN],cnt[MAXN];\nsigned main() {\n\tint n,k;\n\tscanf(\"%lld%lld\",&n,&k);\n\tfor(int i=1;i<=n;++i) scanf(\"%lld\",&a[i]);\n\tsort(a+1,a+n+1);\n\tdp[0][0]=1;\n\tfor(int i=0;i<n;++i) {\n\t\tint cur=i&1,nxt=cur^1;\n\t\tmemset(dp[nxt],0,sizeof(dp[nxt]));\n\t\tfor(int j=0;j<=k;++j) {\n\t\t\tdp[nxt][j]=(dp[nxt][j]+dp[cur][j]*(j+cnt[a[i+1]]+1)%MOD)%MOD;\n\t\t\tdp[nxt][j+1]=(dp[nxt][j+1]+dp[cur][j]*(i-j-cnt[a[i+1]])%MOD)%MOD;\n\t\t}\n\t\t++cnt[a[i+1]];\n\t}\n\tprintf(\"%lld\\n\",dp[n&1][k]);\n\treturn 0;\n}\n```",
        "postTime": 1669282558,
        "uid": 539618,
        "name": "DaiRuiChen007",
        "ccfLevel": 6,
        "title": "ABC267G \u9898\u89e3"
    },
    {
        "content": "\u4e00\u4e2a\u51e0\u4e4e\u4e0d\u9700\u8981\u601d\u8003\u7684\u505a\u6cd5\uff0c\u5c31\u662f\u5355\u7eaf\u7684\u6309\u7167\u9898\u610f\u786c\u505a\u3002\n\n\u6309\u7167\u5957\u8def\uff0c\u6211\u4eec\u4ece\u5c0f\u5230\u5927\u653e\u6570\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u79f0\u4e00\u4e2a $b_i<b_{i+1}$ \u4e3a\u5c71\u5cf0\u3002\u5148\u8003\u8651\u6240\u6709\u6570\u90fd\u4e0d\u540c\u7684\u60c5\u51b5\u4e0b\uff0c$dp_{i,j}$ \u8868\u793a\u653e\u4e86\u524d $i$ \u4e2a\u6570\uff0c\u5f53\u524d\u6709 $j$ \u4e2a\u5c71\u5cf0\u7684\u65b9\u6848\u6570\u3002\u6211\u4eec\u53d1\u73b0\u8fd9\u6837\u975e\u5e38\u597d\u8f6c\u79fb\u3002\u6211\u4eec\u8003\u8651\u5f53\u524d\u7528 $dp_{i-1,j}$ \u8f6c\u79fb\uff0c\u90a3\u4e48\u8f6c\u79fb\u7684\u65f6\u5019\uff0c\u4f60\u6709 $j+1$ \u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u8ba9\u5c71\u5cf0\u4e0d\u53d8\uff08\u63d2\u7b2c\u4e00\u4e2a\u6216\u8005\u67d0\u4e00\u4e2a\u5c71\u5cf0\u4e2d\u95f4\uff09\uff0c$i-j-1$ \u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u8ba9\u5c71\u5cf0 $+1$\u3002\u76f4\u63a5 $n^2 \\ \\ \\ dp $ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7136\u540e\u8003\u8651\u63a8\u5e7f\u5230\u6709\u91cd\u590d\u6570\u7684\u60c5\u51b5\uff0c\u8bbe $dp_{i,j}$ \u8868\u793a\u524d $i$ \u79cd\u6570\u6709 $j$ \u4e2a\u5c71\u5cf0\u7684\u65b9\u6848\u6570\u3002\u4f60\u8003\u8651\u8f6c\u79fb\u7684\u65f6\u5019\u679a\u4e3e\u4e00\u4e2a $t$\uff0c\u8868\u793a $i$ \u8fd9\u79cd\u6570\u4f1a\u4f7f\u5f97\u6570\u5217\u589e\u52a0 $t$ \u4e2a\u5c71\u5cf0\uff0c\u8003\u8651\u5230 $\\sum t=n$\uff0c\u56e0\u6b64\u5982\u679c\u53ef\u4ee5 $O(1)$ \u8f6c\u79fb\u8fd8\u662f\u4e0d\u4f1a\u51fa\u95ee\u9898\u3002\u5b9e\u9645\u4e0a\u8f6c\u79fb\u5c31\u662f $dp_{i-1,j}\\to dp_{i,j+t}*y$\uff0c$y$ \u8868\u793a\u8f6c\u79fb\u7cfb\u6570\uff0c\u6211\u4eec\u53ea\u8003\u8651\u6c42\u8f6c\u79fb\u7cfb\u6570\u5373\u53ef\u3002\n\n\u518d\u5b9a\u4e49 $num_i$ \u8868\u793a\u7b2c $i$ \u79cd\u6570\u7684\u4e2a\u6570\uff0c$sum_i$ \u8868\u793a\u524d $i$ \u79cd\u6570\u7684\u4e2a\u6570\u548c\u3002\u4f60\u8003\u8651\u8fd9\u4e2a\u8f6c\u79fb\u7cfb\u6570\u5c31\u662f\u5fc5\u987b\u9009\u62e9 $t$ \u4e2a\u53ef\u4ee5\u4f7f\u5f97\u5c71\u5cf0 $+1$ \u7684\u4f4d\u7f6e\uff0c$num_i-t$ \u4e2a\u53ef\u4ee5\u4f7f\u5f97\u5c71\u5cf0\u4e0d\u53d8\u7684\u4f4d\u7f6e\u53bb\u63d2\u5165\u3002\n\n\u9996\u5148\u628a\u6240\u6709 $i$ \u7684\u6570\u90fd\u770b\u505a\u76f8\u540c\u7684\uff0c\u7b54\u6848\u6700\u540e\u4e58\u4ee5\u4e00\u4e2a $(num_i)!$ \u5373\u53ef\u3002\u89c2\u5bdf\u518d\u53d1\u73b0\uff0c\u4f60\u5728\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u7684\u540e\u9762\u5982\u679c\u63d2\u5165\u4e86 $k$ \u4e2a\u6570\uff08$k>1$)\uff0c\u7b49\u4ef7\u4e8e\u53ea\u63d2\u5165 $1$ \u4e2a\u3002\u90a3\u4e48\u4f60\u53ef\u4ee5\u628a\u5f53\u524d\u72b6\u6001\uff08$dp_{i-1,?}$ \u7684\u72b6\u6001\uff09\u4e2d\u7684**\u6bcf\u4e00\u4e2a\u7a7a\u4f4d\u5916\u52a0\u7b2c\u4e00\u4e2a\u524d\u9762**\u90fd\u770b\u505a\u4e00\u4e2a\u76d2\u5b50\u3002\u4e8e\u662f\u8fd9\u4e2a\u8f6c\u79fb\u7cfb\u6570\u5c31\u8f6c\u5316\u6210\u4e86\u4f60\u9700\u8981\u628a $num_i$ \u4e2a\u76f8\u540c\u7684\u7403\u653e\u5165 $sum_{i-1}+1$ \u4e2a\u4e0d\u540c\u7684\u76d2\u5b50\uff0c\u8fd9\u5176\u4e2d\u6709 $sum_{i-1}-j$ \u4e2a\u7279\u6b8a\u76d2\u5b50\uff0c\u4f60\u5fc5\u987b\u4fdd\u8bc1\u653e\u5b8c\u7403\u540e**\u6070\u597d** $t$ \u4e2a\u7279\u6b8a\u76d2\u5b50\u975e\u7a7a\u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u76f4\u63a5\u5217\u51fa\u5f0f\u5b50\uff0c\u7279\u6b8a\u76d2\u5b50\u6070\u597d $t$ \u4e2a\u6211\u4eec\u8003\u8651\u76f4\u63a5\u94a6\u5b9a\uff0c\u65b9\u6848\u6570\u662f $\\binom{num_{i-1}-j}{t}$\uff0c\u7136\u540e\u6211\u4eec\u8003\u8651\u679a\u4e3e\u6709 $q$ \u4e2a**\u975e\u7a7a\u975e\u7279\u6b8a\u76d2\u5b50**\uff0c\u7136\u540e\u518d\u653e\u7403\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u5c31\u662f $\\sum_{q}\\binom{j+1}{q}\\binom{num_{i}-1}{t+q-1}$\uff0c\u8fd9\u5f0f\u5b50\u7684\u610f\u4e49\u5c31\u662f\uff0c\u524d\u8005\u662f\u9009 $q$ \u4e2a\u76d2\u5b50\u7684\u65b9\u6848\u6570\uff0c\u540e\u8005\u5c31\u662f\u653e\u7403\u95ee\u9898\u7684\u65b9\u6848\u6570\u3002\n\n\u7136\u540e\u53d1\u73b0\u540e\u9762\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u8303\u5fb7\u8499\u5fb7\u5377\u79ef\u4e00\u4e0b\uff0c\u5c31\u505a\u5b8c\u4e86\u3002\u8f6c\u79fb\u7cfb\u6570\u5c31\u662f $(num_i!)\\binom{sum_{i-1}-j}{t}\\binom{num_i+j}{t+j}$\u3002\n\n\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n\u4e0d\u600e\u4e48\u597d\u770b\u7684\u4ee3\u7801\uff1a\n\n```cpp\nsigned main()\n{\n\tint T=1;\n\tpre();\n\twhile(T--)\n\t{\n\t\trdn;rdk;upn rd(a[i]);sort(a+1,a+n+1);\n\t\tdp[0][0]=1;\n\t\tint tot=1;\n\t\tup(i,2,n)\n\t\t{\n\t\t\tif(a[i]!=a[i-1])\n\t\t\t{\n\t\t\t\tc[++m]=tot;tot=0;\n\t\t\t}\n\t\t\ttot++;\n\t\t}\n\t\tc[++m]=tot;\n\t\tint sm=0;\n\t\tup(i,1,m)\n\t\t{\n\t\t\t//\u524di\u6bb5\n\t\t\tup(j,0,n)\n\t\t\t{\n\t\t\t\tif(!dp[i-1][j])continue;\n\t\t\t\tint w1=j+1;\n\t\t\t\tint w2=sm-j;\n\t\t\t\tup(t,0,min(c[i],w2))\n\t\t\t\t{\n\t\t\t\t\tint w3=c[i]-t;\n\t\t\t\t\tint res=0;\n\t\t\t\t\tint q=C(w2,t);\n\t\t\t\t\tint rw=min(w3,w1);\n\t\t\t\t\tres+=C(w1+c[i]-1,w1+t-1);res+=mod;res%=mod;\n\t\t\t\t\tAdd(dp[i][j+t],res*fac[c[i]]%mod*dp[i-1][j]%mod*q%mod);\n\t\t\t\t}\n\t\t\t}\n\t\t\tsm+=c[i];\n\t\t}\n\t\tcout<<dp[m][k];\n\t}\n}\n```",
        "postTime": 1667181718,
        "uid": 121275,
        "name": "Silviac",
        "ccfLevel": 0,
        "title": "\u8fd9\u662f\u4e00\u4e2a\u6807\u9898"
    }
]
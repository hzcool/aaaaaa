[
    {
        "content": "\u600e\u4e48 arc F \u5929\u5929\u591a\u9879\u5f0f\u2026\u2026\u4e0d\u54cd\u4e38\u8fa3\uff01\n\n\u9996\u5148\u8003\u8651\u4e0d\u4e0b\u964d\u8fd9\u4e2a\u6761\u4ef6\uff0c\u6211\u4eec\u505a\u4e00\u4e2a\u5f88 trivial \u7684\u53d8\u6362\uff1a\u4ee4 $a_i=a_i+i-1$\uff0c\u8fd9\u6837\u4e0d\u4e0b\u964d\u5373\u53ef\u8f6c\u5316\u4e3a\u4e25\u683c\u4e0a\u5347\u3002\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\uff0c\u6c42\u6709\u591a\u5c11\u79cd\u5728 $[0,n+m-1]$ \u4e2d\u9009 $n$ \u4e2a\u6570\u7684\u65b9\u6848\u4f7f\u5176\u548c $\\bmod p=i$\u3002\n\n\u4ee4 $M=n+m-1$\uff0c\u90a3\u4e48\u6211\u4eec\u5148\u5199\u51fa\u8fd9\u4e2a\u751f\u6210\u51fd\u6570\uff1a\u4ee4 $F(x,y)=\\prod\\limits_{i=0}^{M-1}(1+x^iy)\\bmod(x^p-1)$\uff0c\u90a3\u4e48\u663e\u7136\u6709 $ans_i=[x^iy^n]F(x,y)$\u3002\u5148\u8003\u8651\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\uff1a$p\\mid M$\uff0c\u90a3\u4e48\u7531\u4e8e $x$ \u8fd9\u4e00\u7ef4\u6307\u6570\u7684\u52a0\u6cd5\u662f\u5728\u6a21\u610f\u4e49\u4e0b\u8fdb\u884c\u7684\uff0c\u6545\u6709 $F(x,y)=(\\prod\\limits_{i=0}^{p-1}(1+x^iy))^{M/p}\\bmod(x^p-1)$\u3002\n\n\u8003\u8651\u4ee3\u5165\u5355\u4f4d\u6839\uff0c\u8bb0 $G(v)=[y^n](\\prod\\limits_{i=0}^{p-1}(1+y\u00b7v^i))^{M/p}$\uff0c\u90a3\u4e48\u6211\u4eec\u8003\u8651\u4ee4 $v=\\omega_p^0,\\omega_p^1,\\omega_p^2,\\cdots,\\omega_p^{p-1}$\u3002\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a $\\omega_n^k$\uff0c\u6839\u636e\u6590\u8700\u5b9a\u7406\uff0c\u4ee4 $d=\\gcd(k,p)$\uff0c\u6709 $G(\\omega_p^k)=[y^n](\\prod\\limits_{i=0}^{p/d-1}(1+\\omega_{p/d}^ix))^{dM/p}$\uff0c\u800c\u8003\u8651 $\\prod\\limits_{i=0}^{n-1}(1+\\omega_n^ix)$ \u7684\u503c\u662f\u4ec0\u4e48\u4e1c\u897f\uff0c\u7531\u4e8e $-\\omega_n^0,-\\omega_n^1,\\cdots,-\\omega_n^{n-1}$ \u662f $(-x)^n=1$ \u7684 $n$ \u4e2a\u6839\uff0c\u6545 $\\prod(x+\\omega_n^k)=(1-(-x)^n)\u00b7(-1)^n$\uff0c\u4e24\u8fb9\u540c\u65f6\u9664\u4ee5 $\\prod\\limits_{i=0}^{n-1}\\omega_n^i$ \u4e5f\u5c31\u662f $(-1)^n$ \u53ef\u4ee5\u5f97\u5230 $\\prod(1+\\omega_n^kx)=(1-(-x)^n)$\u3002\u8fd9\u6837\u6211\u4eec\u5f97\u5230 $G(\\omega_p^k)=[y^n](1-(-x)^{p/d})^{dM/p}$\uff0c\u4f7f\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u7b97\u51fa\u5373\u53ef\u3002\n\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u5f97\u51fa\u4e86 $G(\\omega_p^0)\\sim G(\\omega_p^{p-1})$\uff0c\u6211\u4eec\u8981\u53cd\u8fc7\u6765\u6c42 $G(0)\\sim G(p-1)$\uff0c\u8fd9\u663e\u7136\u662f\u4e00\u4e2a IDFT \u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 $G(i)=\\dfrac{1}{p}\\sum\\limits_{j=0}^{p-1}G(\\omega_p^j)\\omega_p^{-ij}$\u3002\u76f4\u63a5\u505a\u9700\u8981\u5bf9\u6c42\u51fa $\\omega_p^{-ij}$\uff0c\u4e0d\u8fc7\u6211\u4eec\u53d1\u73b0\u6240\u6709 $\\gcd(p,k)$ \u76f8\u540c\u7684 $k$ \u7684 $G(\\omega_p^k)$ \u76f8\u540c\uff0c\u56e0\u6b64\u6211\u4eec\u679a\u4e3e\u8fd9\u4e2a $\\gcd=d$\uff0c\u6709 $G(i)=\\dfrac{1}{p}\\sum\\limits_{d\\mid p}G(\\omega_p^d)\\sum\\limits_{j=0}^{p-1}[\\gcd(j,p)=d]\\omega^{-ij}$\u3002\u8003\u8651\u5982\u4f55\u7b97\u540e\u8005\uff0c\u5373 $H(d,i)=\\sum\\limits_{j=0}^{p-1}[\\gcd(j,p)=d]\\omega^{-ij}$\uff0c\u6709\n$$\n\\begin{aligned}\nH(d,i)&=\\sum\\limits_{j=0}^{p-1}[\\gcd(j,p)=d]\\omega^{-ij}\\\\\n&=\\sum\\limits_{j=0}^{p/d-1}[\\gcd(j,p/d)=1]\\omega^{-idj}\\\\\n&=\\sum\\limits_{t\\mid\\frac{p}{d}}\\mu(t)\\sum\\limits_{j=0}^{p/dt-1}\\omega^{-idtj}\\\\\n&=\\sum\\limits_{t\\mid\\frac{p}{d}}\\mu(t)[p\\mid idt]\u00b7\\dfrac{p}{dt}\n\\end{aligned}\n$$\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u8fd8\u539f\u51fa $G(0)\\sim G(p-1)$\u3002\u8fdb\u800c\u89e3\u51b3\u4e86 $p\\mid M$ \u7684\u60c5\u51b5\u3002\u63a5\u4e0b\u6765\u8003\u8651 $p\\nmid M$\uff0c\u5176\u5b9e\u633a trivial\uff0c\u5bf9\u4e8e\u540e $O(p)$ \u4e2a\u5143\u7d20\u66b4\u529b $p^3$ \u80cc\u5305\uff0c\u7136\u540e\u5bf9\u524d\u9762 $\\lfloor\\dfrac{M}{p}\\rfloor\u00b7p$ \u4e2a\u5143\u7d20\u8dd1\u524d\u9762\u7684\u505a\u6cd5\u5373\u53ef\u3002",
        "postTime": 1671607082,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "arc145F"
    },
    {
        "content": "\u663e\u7136\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5355\u8c03\u9012\u589e\u5e8f\u5217\u3002\u7136\u540e\u4ee5\u751f\u6210\u51fd\u6570\u5217\u51fa\u7b54\u6848: $ans_k=[x^ny^k]\\prod\\limits_{i=0}^m (1+xy^i)$ \uff0c\u5176\u4e2d\u7b2c\u4e8c\u7ef4\u662f\u4ee5 $p$ \u4e3a\u6a21\u6570\u7684\u5faa\u73af\u5377\u79ef\u3002\n\n\u8fd9\u4e2a\u79ef\u5f0f\u7684\u6700\u540e $O(p)$ \u9879\u62ce\u51fa\u6765\uff0c\u4f7f\u524d\u9762\u90fd\u662f\u6574\u5757\uff0c\u5f62\u6210\u4e00\u4e2a $\\prod\\limits_{i=0}^{p-1}(1+xy^i)^m$ \u7684\u5f62\u52bf\uff0c\u6700\u540e\u518d $O(p^3)$ \u80cc\u5305\u3002\n\n\u4e0d\u96be\u60f3\u5230\u5bf9\u7b2c\u4e8c\u7ef4\u8fdb\u884c DFT\uff0c\u6211\u4eec\u60f3\u8ba1\u7b97\u4e00\u4e2a\u591a\u9879\u5f0f $F_i(x)=\\prod\\limits_{j=0}^{p-1}(1+xw_p^{ij})^m$ \uff0c\u6211\u4eec\u53ea\u9700\u4fdd\u7559\u540e $p$ \u9879\uff0c\u6700\u540e\u518d IDFT \u56de\u53bb\uff0c\u6709 $G_i(x)=\\frac{1}{p}\\sum F_j(x)w_p^{-ij}$ \u3002\n\n\u4f46\u662f $p$ \u4e0d\u4e00\u5b9a\u662f $2^k$ \u7684\u5f62\u5f0f\uff0c\u6ca1\u6cd5\u76f4\u63a5\u4ee3\u8fdb\u53bb\u7b97\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u4e00\u6b65\u7b80\u5316\u3002\n\n\u53d1\u73b0 $F_i(x)$ \u53ea\u4e0e $g=\\gcd(i,p)$ \u76f8\u5173\u3002$F_i(x)=\\prod\\limits_{j=0}^{\\frac{p}{g}-1}(1+xw_{\\frac{p}{g}}^{j})^{mg}=(1-(-x)^{\\frac{p}{g}})^{mg}$ \u3002\u4e8e\u662f\u5c31\u5b8c\u6210\u4e86 $F$ \u7684\u5316\u7b80\u3002\n\n\u6211\u4eec\u4ee4 $H_g(x)=(1-(-x)^{\\frac{p}{g}})^{mg}$ \u3002\u73b0\u5728\u8003\u8651 $G_i(x)=\\frac{1}{p}\\sum H_j(x)\\sum [\\gcd(p,k)=j]w_p^{-ik}$ \u3002\n\n\u770b\u5230 gcd \uff0c\u65bd\u52a0\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u5219 $G_i(x)=\\frac{1}{p}\\sum\\limits_{j|p} H_j(x)\\sum\\limits_{k=0}^{\\frac{p}{j}-1} [gcd(\\frac{p}{j},k)=1]w_p^{-ijk}=\\frac{1}{p}\\sum\\limits_{j|p} H_j(x)\\sum\\limits_{d|\\frac{p}{j}}\\mu(d)\\sum\\limits_{k=0}^{\\frac{p}{jd}-1}w_p^{-ijkd}$ \u3002\n\n\u9006\u7528\u5355\u4f4d\u6839\u53cd\u6f14\uff0c\u5f97\u5230 $G_i(x)=\\frac{1}{p}\\sum\\limits_{j|p} H_j(x)\\sum\\limits_{d|\\frac{p}{j}}\\mu(d)\\frac{p}{jd}[\\frac{p}{jd}|i]=\\frac{1}{p}\\sum\\limits_{j|p} H_j(x)\\sum\\limits_{d|\\frac{p}{j}}\\mu(d)\\frac{p}{jd}[p|ijd]$ \u3002\n\n\u7531\u6b64\u7ec8\u4e8e\u628a\u5355\u4f4d\u6839\u5e72\u6ca1\u4e86\uff0c\u6211\u4eec\u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002\u590d\u6742\u5ea6\u662f $O(m+n+pd(p)^3+p^3)$ \u3002\n",
        "postTime": 1679366501,
        "uid": 319444,
        "name": "Coward2008",
        "ccfLevel": 0,
        "title": "ARC145F Modulo Sum of Increasing Sequences"
    }
]
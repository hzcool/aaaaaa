[
    {
        "content": "\u9650\u5236\u6761\u4ef6\u5f88\u591a\uff0c\u4f46\u89c2\u5bdf\u4e0d\u51fa\u4ec0\u4e48\u6027\u8d28\uff0c\u4e0d\u5982\u76f4\u63a5\u786c\u4e0a\u3002\n\n\u5bf9\u7b2c $t$ \u4e2a\u4f4d\u7f6e\u4e0a\u586b\u7684\u6570\u8bbe\u51fa\u751f\u6210\u51fd\u6570\uff1a\n\n$$\n\\begin{aligned}\nF_t(x) &=\\sum\\limits_{i \\geq 0} \\min(t,i) x^i\\\\\n&=t(\\dfrac{x}{1-x}-\\dfrac{x-x^{t+1}}{1-x})+x \\dfrac{d}{dx} (\\dfrac{x-x^{t+1}}{1-x})\\\\\n&=\\dfrac{tx^{t+1}}{1-x}+x \\dfrac{1-(t+1)x^t+tx^{t+1}}{(1-x)^2}\\\\\n&=\\dfrac{x-x^{t+1}}{(1-x)^2}\\\\\n\\end{aligned}\n$$\n\n\u4e8e\u662f\u7b54\u6848\u4e3a\uff1a\n\n$$\n\\begin{aligned}\nAns &=[x^m] \\prod\\limits_{t=1}^n \\dfrac{x-x^{t+1}}{(1-x)^2}\\\\\n&=[x^m] \\dfrac{x^n}{(1-x)^{2n}} \\prod\\limits_{t=1}^n (1-x^t)\\\\\n&=[x^{m-n}] (1-x)^{-2n} \\prod\\limits_{t=1}^n (1-x^t)\\\\\n\\end{aligned}\n$$\n\n\u7531\u4e8e $m-n \\leq n$\uff0c\u6545\uff1a\n\n$$\\prod\\limits_{t=1}^n (1-x^t) \\equiv \\prod\\limits_{t \\geq 1} (1-x^t) \\pmod{x^{m-n+1}}$$\n\n\u7531\u4e94\u8fb9\u5f62\u6570\u5b9a\u7406\uff1a\n\n$$\n\\begin{aligned}\nAns &=[x^{m-n}] \\sum\\limits_{i \\geq 0} \\dbinom{2n-1+i}{2n-1} \\sum\\limits_{k \\geq 0} (-1)^k x^{k(3k \\pm 1)/2}\\\\\n&=\\sum\\limits_{k \\geq 0} (-1)^k \\dbinom{2n-1+m-n-(k(3k \\pm 1)/2)}{2n-1}\\\\\n\\end{aligned}\n$$\n\n\u6a21\u6570\u8f83\u5c0f\uff0c\u7528\u5362\u5361\u65af\u5b9a\u7406\u8ba1\u7b97\u7ec4\u5408\u6570\u3002\u6ce8\u610f\u5230\u679a\u4e3e\u7684\u9879\u6570\u53ea\u6709 $O(\\sqrt n)$ \u9879\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\bmod+\\sqrt n\\ \\log_{\\bmod} n)$\u3002\n\n#### Code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=2e5+5,mod=2e5+3;\nint ksm(int a,int x){\n\tint tot=1;\n\twhile(x){\n\t\tif(x & 1ll) tot=1ll*tot*a%mod;\n\t\ta=1ll*a*a%mod;\n\t\tx>>=1ll;\n\t}\n\treturn tot;\n}\nint mul[N],inv[N];\nvoid init(int lim){\n\tmul[0]=inv[0]=1;\n\tfor(int i=1;i<=lim;i++) mul[i]=1ll*mul[i-1]*i%mod;\n\tinv[lim]=ksm(mul[lim],mod-2);\n\tfor(int i=lim-1;i>=1;i--) inv[i]=1ll*inv[i+1]*(i+1)%mod;\n}\nint C(long long m,long long n){\n\tif(!m) return 1;\n\tint tot=C(m/mod,n/mod);\n\tm%=mod,n%=mod;\n\tif(m<0 || n<0 || m<n) return 0;\n\treturn 1ll*mul[m]*inv[n]%mod*inv[m-n]%mod*tot%mod;\n}\nint ID(int x){\n\treturn (x & 1ll)?(mod-1):(1);\n}\nlong long n,m;\nint ans;\n\nint main(){\n\tinit(mod-1);\n\tcin>>n>>m;\n\tfor(long long i=0;;i++){\n\t\tfor(int f=-1;f<=1;f+=2){\n\t\t\tlong long val=i*(3*i+f)/2;\n\t\t\tif(val>m-n) return cout<<ans,0;\n\t\t\tans=(ans+1ll*C(2*n-1+m-n-val,m-n-val)*ID(i)%mod)%mod;\n\t\t\tif(!i) break;\n\t\t}\n\t}\n}\n```",
        "postTime": 1670081535,
        "uid": 225645,
        "name": "\u82f9\u679c\u84dd17",
        "ccfLevel": 8,
        "title": "AT_abc279_h [ABC279Ex] Sum of Prod of Min \u9898\u89e3"
    },
    {
        "content": "\u7269\u7406\u5b66\u8003\u65f6\u5019\u63a8\u7684\u3002\u573a\u4e0a\u8bb0\u9519\u6a21\u6570\uff0c\u4ee5\u4e3a\u662f $998244353$ \u7136\u540e\u60f3\u4e86\u534a\u5929\u7ec4\u5408\u6570\u600e\u4e48\u7b97\uff09\n\n\u7b80\u5355\u9898\u3002\n\n\u9996\u5148\u5e8f\u5217\u95ee\u9898\u8003\u8651\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u751f\u6210\u51fd\u6570\u7136\u540e\u4e58\u8d77\u6765\u3002\u4f4d\u7f6e $k$ \u7684\u751f\u6210\u51fd\u6570\u663e\u7136\u662f\n$$\\sum_{i=1}\\min(i,k)x^i$$\n\u90a3\u4e48\u89c2\u5bdf\u4e00\u4e0b\u5c1d\u8bd5\u641e\u5c01\u95ed\u5f62\u5f0f\u3002\u5b83\u524d $k$ \u9879\u548c $\\dfrac x{(1-x)^2}$ \u662f\u4e00\u6837\u7684\uff0c\u540e\u8fb9\u5168\u662f $k$\u3002\u6211\u7684\u63a8\u6cd5\u662f\u5927\u51cf\u5c0f\uff0c\u5373\uff1a\n$$\n\\begin{aligned}\n&\\sum_{i=1}\\min(i,k)x^i\\\\\n=&\\sum_{i=1}ix^i-\\sum_{i=0}ix^{i+k}\\\\\n=&\\frac x{(1-x)^2}-x^k\\frac x{(1-x)^2}\\\\\n=&x\\frac {1-x^k}{(1-x)^2}\n\\end{aligned}\n$$\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f\n$$\n\\begin{aligned}\n&[x^m]\\prod_{i=1}^nx\\frac{1-x^i}{(1-x)^2}\\\\\n=&[x^{m-n}]\\prod_{i=1}^n\\frac{1-x^i}{(1-x)^2}\\\\\n=&[x^{m-n}]\\frac 1{(1-x)^{2n}}\\prod_{i=1}^n(1-x^i)\n\\end{aligned}\n$$\n\u524d\u8fb9\u8fd9\u4e2a\u4e1c\u897f\u7684\u7b2c $k$ \u9879\u663e\u7136\u662f $\\dbinom{2n-1+k}k$\u3002\u5173\u4e8e\u540e\u8fb9\u8fd9\u4e2a\u4e1c\u897f\uff0c\u4e00\u770b\u957f\u7684\u5c31\u5f88\u50cf\u4e94\u8fb9\u5f62\u6570\u3002\u7531\u4e8e $m-n\\le n$\uff0c\u90a3\u4e48 $[x^{m-n}]\\prod_{i=1}^n(1-x^i)=[x^{m-n}]\\prod_{i=1}(1-x^i)=[x^{m-n}]1+\\sum_{i=1}(-1)^ix^{\\frac{i(3i\\pm 1)}2}$\u3002\u53ea\u6709 $O(\\sqrt n)$ \u4e2a\u53d6\u503c\uff0clucas \u7206\u7b97\u5373\u53ef\u3002\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <cstring>\n#define int long long\nusing namespace std;\nconst int mod=200003;\nint n,m,ans,jc[200010],inv[200010];\nint binom(int n,int m){\n    if(m<0||n<m)return 0;\n    return 1ll*jc[n]*inv[m]%mod*inv[n-m]%mod;\n}\nint C(int n,int m){\n    if(!m)return 1;\n    return 1ll*binom(n%mod,m%mod)*C(n/mod,m/mod)%mod;\n}\nsigned main(){\n    scanf(\"%lld%lld\",&n,&m);jc[0]=inv[0]=inv[1]=1;\n    for(int i=1;i<mod;i++)jc[i]=1ll*jc[i-1]*i%mod;\n    for(int i=2;i<mod;i++)inv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\n    for(int i=1;i<mod;i++)inv[i]=1ll*inv[i-1]*inv[i]%mod;\n    for(int i=0;;i++){\n        int ret=i*(3*i-1)>>1;\n        if(ret>m-n)break;\n        ans=(ans+1ll*((i&1)?mod-1:1)*C(m+n-ret-1,m-n-ret))%mod;\n        ret=i*(3*i+1)>>1;\n        if(!i)continue;\n        if(ret>m-n)break;\n        ans=(ans+1ll*((i&1)?mod-1:1)*C(m+n-ret-1,m-n-ret))%mod;\n    }\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1678193240,
        "uid": 663705,
        "name": "worldvanquisher",
        "ccfLevel": 0,
        "title": "ABC279H \u9898\u89e3"
    },
    {
        "content": "\u7b80\u5355\u751f\u6210\u51fd\u6570\u7ec3\u4e60\u9898\u3002\n\n\u76f4\u63a5\u5199\u51fa\u751f\u6210\u51fd\u6570\u5f62\u5f0f\uff1a\n\n$$\n[x^m]\\prod_{i=1}^n(\\sum_{j=0}^{+\\infty}jx^j-\\sum_{j=i}^{+\\infty}(j-i)x^j)\n$$\n\n\uff08\u4e3a\u4e86\u65b9\u4fbf\u5316\u7b80\uff0c\u6211\u4eec\u91c7\u7528\u76f8\u51cf\u7684\u5f62\u5f0f\u3002)\n\n\u6ce8\u610f\u5230\uff1a\n\n$$\n\\frac{1}{(1-x)^2}=\\sum_{i=0}^{+\\infty}(i+1)x^i\n$$\n\n\u6240\u4ee5\u539f\u5f0f\u5316\u7b80\u4e3a\uff1a\n\n$$\n[x^m]\\prod_{i=1}^n\\frac{(1-x^i)x}{(1-x)^2}\n$$\n\n\u5148\u628a\u5206\u6bcd\u548c\u5206\u5b50\u4e2d\u7684 $x$ \u63d0\u51fa\u6765\uff0c\u67ff\u5b50\u53d8\u6210\uff1a\n\n$$\n[x^{m-n}]\\frac{1}{(1-x)^{2n}}\\prod_{i=1}^{n}(1-x^i)\n$$\n\n\u8fd9\u65f6\u9700\u8981\u6ce8\u610f\u9898\u76ee\u4e2d\u4e00\u4e2a\u5947\u602a\u7684\u9650\u5236\uff1a$m\\le 2n$\u3002\u4e5f\u5c31\u662f $m-n\\le n$\u3002\n\n\u6240\u4ee5\u4e0d\u59a8\u5c06\u540e\u9762\u7684\u8fde\u4e58\u6539\u5199\u4e3a $\\prod_{i=1}^{+\\infty}(1-x^i)$\u3002\n\n\u4e5f\u5c31\u662f\u8457\u540d\u7684\u4e94\u8fb9\u5f62\u6570\u5b9a\u7406\uff1a\n\n$$\n\\prod_{i=1}^{+\\infty}(1-x^i)=1+\\sum_{i=1}^{+\\infty}(-1)^ix^{\\frac{i(3i\\pm1)}{2}}\n$$\n\n\u4e8e\u662f\u73b0\u5728\u53d8\u6210\u4e86\u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u5377\u79ef\u5f62\u5f0f\u3002\u7531\u4e8e $\\frac{1}{(1-x)^{2n}}=\\sum_{i=0}^{+\\infty}\\binom{i+2n-1}{2n-1}x^i$\uff0c\n\u6240\u4ee5\u539f\u5f0f\u5c31\u53d8\u6210\u4e86\u4e00\u4e9b\u7ec4\u5408\u6570\u76f8\u52a0\u3002\n\n\u6839\u636e\u4e94\u8fb9\u5f62\u6570\u5b9a\u7406\uff0c\u975e $0$ \u7684\u9879\u53ea\u6709 $O(\\sqrt n)$ \u4e2a\uff0c\u6240\u4ee5\u53ea\u9700\u8ba1\u7b97 $O(\\sqrt n)$ \u4e2a\u7ec4\u5408\u6570\u3002\n\n\u4f46\u662f\u8fd8\u5269\u6700\u540e\u4e00\u6b65\u3002\u56e0\u4e3a $n,m$ \u975e\u5e38\u5927\uff0c\u4e0d\u597d\u76f4\u63a5\u8ba1\u7b97\u7ec4\u5408\u6570\u3002\n\n\u4e0d\u8fc7\u9898\u76ee\u5df2\u7ecf\u63d0\u793a\u8fc7\u4e86\u8981\u6ce8\u610f\u6a21\u6570\u7684\u7279\u6b8a\u6027\uff0c\u6240\u4ee5\u52a0\u4e0a\u4e00\u4e2a Lucas \u5b9a\u7406\u5c31\u884c\u4e86\u3002\n",
        "postTime": 1670037863,
        "uid": 127747,
        "name": "\u51b0\u96fe",
        "ccfLevel": 7,
        "title": "ABC279Ex"
    }
]
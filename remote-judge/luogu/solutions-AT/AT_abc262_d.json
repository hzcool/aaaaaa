[
    {
        "content": "# [[ABC262D] I Hate Non-integer Number](https://www.luogu.com.cn/problem/AT_abc262_d) Solution\n\n[TOC]\n\n## [\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u6233\u6b64\u8fdb\u5165](http://blog.tsawke.com?t=ABC262D)\n\n## \u9898\u9762\n\n\u5df2\u77e5\u4e00\u4e2a\u957f\u5ea6\u4e3a $N$ \u7684\u6570\u5217 $a_1,a_2,\\cdots a_N$\uff0c\u4ece\u6570\u5217\u4e2d\u9009\u51fa\u81f3\u5c11\u4e00\u4e2a\u6570\uff0c\u4f7f\u9009\u51fa\u7684\u6570\u5e73\u5747\u6570\u4e3a\u6574\u6570\uff0c\u6c42\u6709\u591a\u5c11\u79cd\u8fd9\u6837\u7684\u65b9\u6848\u3002\n\n## Solution\n\n\u7ecf\u5178DP\uff0c\u8003\u8651\u8bbe\u72b6\u6001 $ dp(i, j, p, k) $\uff0c\u8868\u793a\u8003\u8651\u524d $ i $ \u4e2a\u6570\u91cc\u9009 $ j $ \u4e2a\u7684\u548c\u6a21 $ p $ \u4f59 $ k $\u3002\n\n\u8f6c\u79fb\u663e\u7136\uff0c\u5373\uff1a\n$$\ndp(i, j, p, k) \\rightarrow dp(i + 1, j, p, k)\n$$\n\n$$\ndp(i, j, p, k) \\rightarrow dp(i + 1, j + 1, p, (k + a_{i + 1}) \\bmod{p})\n$$\n\n\u6700\u7ec8\u7b54\u6848\u5373\u4e3a $ \\sum_{i = 1}^n dp(N, i, i, 0) $\u3002\n\n\u7136\u540e\u9700\u8981\u6ce8\u610f\u8f6c\u79fb\u8fc7\u7a0b\u4e2d\u5b58\u5728 $ j = 0 $\uff0c\u4f46\u7b54\u6848\u4e0d\u53ef\u4ee5 $ j = 0 $\uff0c\u539f\u56e0\u663e\u7136\u3002\n\n\u521d\u59cb\u503c\u5373\u4e3a $ dp(1, 0, i, 0) = 1, dp(1, 1, i, a_1 \\bmod{i}) = 1 $\u3002\n\n\u53d1\u73b0\u7a7a\u95f4\u65e0\u6cd5\u652f\u6301\uff0c\u6545\u53ef\u4ee5\u5c06 $ i $ \u7ef4\u6eda\u52a8\u6389\u3002\n\n## Code\n\n```cpp\n#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\n\n#define PI M_PI\n#define E M_E\n#define npt nullptr\n#define SON i->to\n#define OPNEW void* operator new(size_t)\n#define ROPNEW(arr) void* Edge::operator new(size_t){static Edge* P = arr; return P++;}\n\nusing namespace std;\n\nmt19937 rnd(random_device{}());\nint rndd(int l, int r){return rnd() % (r - l + 1) + l;}\nbool rnddd(int x){return rndd(1, 100) <= x;}\n\ntypedef unsigned int uint;\ntypedef unsigned long long unll;\ntypedef long long ll;\ntypedef long double ld;\n\n#define MOD (998244353ll)\n\ntemplate < typename T = int >\ninline T read(void);\n\nint N;\nll a[110];\nll dp[2][110][110][110];\nll ans(0);\n\nint main(){\n    N = read();\n    for(int i = 1; i <= N; ++i)a[i] = read();\n    for(int i = 1; i <= N; ++i)dp[1][0][i][0] = 1, dp[1][1][i][a[1] % i] = 1;\n    for(int i = 1; i < N; ++i){\n        for(int j = 0; j <= 100; ++j)for(int p = 0; p <= 100; ++p)for(int k = 0; k <= 100; ++k)dp[!(i & 1)][j][p][k] = 0;\n        for(int j = 0; j <= i; ++j)\n            for(int p = 1; p <= N; ++p)\n                for(int k = 0; k < p; ++k)\n                    (dp[!(i & 1)][j][p][k] += dp[i & 1][j][p][k]) %= MOD,\n                    (dp[!(i & 1)][j + 1][p][(k + a[i + 1]) % p] += dp[i & 1][j][p][k]) %= MOD;\n    }\n    for(int i = 1; i <= N; ++i)(ans += dp[N & 1][i][i][0]) %= MOD;\n    printf(\"%lld\\n\", ans);\n    fprintf(stderr, \"Time: %.6lf\\n\", (double)clock() / CLOCKS_PER_SEC);\n    return 0;\n}\n\ntemplate < typename T >\ninline T read(void){\n    T ret(0);\n    int flag(1);\n    char c = getchar();\n    while(c != '-' && !isdigit(c))c = getchar();\n    if(c == '-')flag = -1, c = getchar();\n    while(isdigit(c)){\n        ret *= 10;\n        ret += int(c - '0');\n        c = getchar();\n    }\n    ret *= flag;\n    return ret;\n}\n```\n\n## UPD\n\nupdate-2023_01_07 \u521d\u7a3f",
        "postTime": 1673082977,
        "uid": 362938,
        "name": "Tsawke",
        "ccfLevel": 6,
        "title": "[ABC262D] I Hate Non-integer Number \u9898\u89e3"
    },
    {
        "content": "# [abc262](https://atcoder.jp/contests/abc262/tasks/abc262_d) Solution\n~~\u8003\u573a\u4e0a\u60f3\u5230\u601d\u8def\u5199\u6302\u7684\u83dc\u9e21\u3010\u6c57\u989c\u3011~~\n## \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $N$ \u5e8f\u5217 $A$\uff0c\u4ece\u4e2d\u9009\u82e5\u5e72\u4e2a\u6570\uff0c\u6709\u51e0\u79cd\u9009\u6cd5\u4f7f\u5f97\u9009\u51fa\u7684\u6570\u5e73\u5747\u6570\u662f\u6574\u6570\uff1f\n\n\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\uff0c$1\\leq N\\leq 100,\\ A_i\\leq10^9$\u3002\n## \u6734\u7d20\u89e3\u6cd5\n\u66b4\u529b\u679a\u4e3e\u6bcf\u4e2a\u6570\u9009\u8fd8\u662f\u4e0d\u9009\uff0c\u590d\u6742\u5ea6 $\\Theta(2^N)$\uff0c\u663e\u7136\u65e0\u6cd5\u901a\u8fc7\u3002\n## \u9898\u76ee\u5206\u6790\u4ee5\u53ca\u6b63\u89e3\n\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u6240\u6709\u7684\u9009\u6570\u4e2a\u6570 $i$\u3002\n\n+ \u5f53 $i=1$ \u65f6\uff0c\u6709 $N$ \u79cd\u65b9\u6cd5\u3002\n+ \u5f53 $i=2$ \u65f6\uff0c\u9009\u51fa\u7684\u6570\u4e00\u5b9a\u662f $2$ \u7684\u500d\u6570\u3002\n+ \u5f53 $i=3$ \u65f6\uff0c\u9009\u51fa\u7684\u6570\u4e00\u5b9a\u662f $3$ \u7684\u500d\u6570\u3002\n+ \u2026\u2026\u2026\u2026\n+ \u5f53 $i=N$ \u65f6\uff0c\u9009\u51fa\u7684\u6570\u4e00\u5b9a\u662f $N$ \u7684\u500d\u6570\u3002\n\n\u4e8e\u662f\u4e4e\uff0c\u6211\u4eec\u8003\u8651 dp\u3002\n\n$f[i][j][k][l]$\uff1a\u4ece\u524d $j$ \u4e2a\u6570\u4e2d\u9009\u62e9 $k$ \u4e2a\uff0c\u603b\u548c $\\bmod\\ i$ \u4f59 $l$\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c$100^4$ \u7a7a\u95f4\u4f1a\u7206\u70b8\uff01\u800c\u4e14\u6211\u4eec\u53d1\u73b0\uff0c$f[i][][][]$ \u548c $f[i+1][][][]$ \u586b\u5199\u65e0\u5173\uff01\u4e8e\u662f\u6211\u4eec\u8986\u76d6\u5f0f\u586b\u5199\uff0c\u628a $[i]$ \u7ef4\u5ea6\u7701\u7565\uff0c\u5927\u4e0d\u4e86\u6bcf\u4e00\u6b21\u6e05\u7a7a\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c**\u7528\u5df2\u77e5\u7684 $f$ \u53bb\u66f4\u65b0\u672a\u77e5\u7684 $f$\uff0c\u8981\u66f4\u8f7b\u677e\u3002**~~\u4f5c\u8005\u592a\u84bb\u4e86\uff0c\u5fd8\u8bb0\u662f push \u8fd8\u662f pull \u4e86\u3002~~\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u679a\u4e3e $j,k,l$\uff0c\n+ \u5982\u679c $j$ \u53f7\u4e0d\u9009\uff0c\u7528 $f[j][k][l]$ \u66f4\u65b0 $f[j+1][k][l]$\u3002\n+ \u5982\u679c $j$ \u53f7\u9009\uff0c\u7528 $f[j][k][l]$ \u66f4\u65b0 $f[j+1][k+1][(l+a_j)\\bmod i]$\n\n\u6700\u540e\u7edf\u8ba1\u7b54\u6848\uff1a\n\n\u56e0\u4e3a $i$ \u662f\u9009\u6570\u4e2a\u6570\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u7684 $i$ \u5faa\u73af\uff0c\u7b54\u6848\u663e\u7136\u662f $f[N][i][0]$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(N^4)$\uff0c\u5b9e\u9645\u8ba1\u7b97\u91cf $\\approx \\frac{N^4}{4}$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n## Talk is cheap,show my code.\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define ld long double\n#define rep(i,l,r) for(register ll i=(l);i<=(r);i++)\n#define PLL pair<ll,ll>\n#define PLD pair<ld,ld>\n#define FI first\n#define SC second\n#define MP make_pair\nusing namespace std;\nconst ll INF=9223372036854775807;\nconst ld ERR=1e-12;\nvoid File(){\n\tfreopen(\".in\",\"r\",stdin);\n\tfreopen(\".out\",\"w\",stdout);\n}\nvoid IOS(){\n\tios::sync_with_stdio(false);\n\tcin.tie(0),cout.tie(0);\n}//\u7f3a\u7701\u6e90\nconst ll N=109,MOD=998244353;\nll n,a[N],f[N][N][N],ans;\nint main(){\n\tIOS();\n\tcin>>n;\n\trep(i,1,n)cin>>a[i];\n\trep(i,1,n){\n\t\tmemset(f,0,sizeof(f));\n\t\tf[1][0][0]=1;\n\t\trep(j,1,n)rep(k,0,i)rep(l,0,i-1){\n\t\t\tf[j+1][k][l]+=f[j][k][l];\n\t\t\tf[j+1][k][l]%=MOD;\n\t\t\tif(k!=i)f[j+1][k+1][(l+a[j])%i]+=f[j][k][l],f[j+1][k+1][(l+a[j])%i]%=MOD;\n\t\t}\n\t\tans=(ans+f[n+1][i][0])%MOD;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1669685575,
        "uid": 555345,
        "name": "xionglangqi",
        "ccfLevel": 0,
        "title": "abc262d \u9898\u89e3"
    }
]
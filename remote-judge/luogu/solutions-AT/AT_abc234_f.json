[
    {
        "content": "## \u601d\u8def\n\n\u8003\u8651 $dp_{i,j}$ \u8868\u793a\u770b\u4e86\u524d $i$ \u4e2a\u5b57\u6bcd\uff0c\u76ee\u524d\u603b\u5171\u9009\u51fa\u957f\u5ea6\u4e3a $j$ \u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u8f6c\u79fb\uff0c\u679a\u4e3e\u7b2c $i$ \u4e2a\u5b57\u6bcd\u9009 $k$ \u4e2a\uff0c\u5219 $dp_{i,j+k}+=dp_{i-1,j}\\times\\binom{j+k}{k}$\uff0c\u610f\u4e49\u5c31\u662f\u4ece\u603b\u5171\u7684 $j+k$ \u4e2a\u4f4d\u7f6e\u4e2d\u9009\u62e9 $k$ \u4e2a\u653e\u7f6e\u7b2c $i$ \u53f7\u5b57\u6bcd\uff0c\u5269\u4f59\u6309\u539f\u6765\u987a\u5e8f\u6446\u653e $dp_{i-1,j}$ \u7684\u72b6\u6001\u3002\n\n\u90a3\u4e48\u603b\u590d\u6742\u5ea6\u5c31\u662f $O(26|S|^2)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u65b9\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa\u7ec4\u5408\u6570\uff0c\u7136\u540e\u8ba1\u7b97\u539f\u4e32\u6bcf\u4e2a\u5b57\u6bcd\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u8fdb\u884c\u4e0a\u8ff0 $dp$ \u5373\u53ef\uff0c\u6ce8\u610f\u53ca\u65f6\u53d6\u6a21\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int mod=998244353;\nconst int maxn=1000000;\nint fact[maxn+5];\nint inv[maxn+5];\nint power(int a,int b){\n\tint now=a,ans=1;\n\twhile(b){\n\t\tif(b%2==1){\n\t\t\tans*=now;\n\t\t\tans%=mod;\n\t\t}\n\t\tnow*=now;\n\t\tnow%=mod;\n\t\tb/=2; \n\t}\n\treturn ans;\n}\nvoid init(){\n\tfact[0]=1;\n\tfor(int i=1;i<=maxn;i++){\n\t\tfact[i]=fact[i-1]*i;\n\t\tfact[i]%=mod;\n\t}\n\tinv[maxn]=power(fact[maxn],mod-2);\n\tfor(int i=maxn-1;i>=0;i--){\n\t\tinv[i]=inv[i+1]*(i+1);\n\t\tinv[i]%=mod;\n\t}\n}\nint C(int i,int j){\n\tif(i<j){\n\t\treturn 0;\n\t}\n\treturn ((fact[i]*inv[j])%mod*inv[i-j])%mod;\n}\nint C2(int i,int j){\n\tif(i<j){\n\t\treturn 0;\n\t}\n\treturn ((inv[i]*fact[j])%mod*fact[i-j])%mod;\n}\nint dp[5005][28];\nsigned main(){\n\t//freopen(\"\",\"r\",stdin);\n\t//freopen(\"\",\"w\",stdout);\n\tinit();\n\tstring s;\n\tcin>>s;\n\tint a[27];\n\tfor(int i=0;i<=26;i++){\n\t\ta[i]=0;\n\t}\n\tfor(int i=0;i<s.size();i++){\n\t\ta[s[i]-'a'+1]++;\n\t} \n\tdp[0][0]=1;\n\tfor(int i=1;i<=26;i++){\n\t\tfor(int j=0;j<=s.size();j++){\n\t\t\tfor(int k=0;k<=a[i]&&k<=j;k++){\n\t\t\t\tdp[j][i]+=((dp[j-k][i-1]*C(j,k))%mod);\n\t\t\t\tdp[j][i]%=mod;\n\t\t\t}\n\t\t}\n\t}\n\tint sum=0;\n\tfor(int i=1;i<=s.size();i++){\n\t\tsum+=(dp[i][26]%mod);\n\t\tsum%=mod;\n\t}\n\tcout<<sum;\n\treturn 0;\n}\n```",
        "postTime": 1668054736,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "ABC234F \u9898\u89e3"
    },
    {
        "content": "\u6628\u5929\u6df1\u591c\u4ece $\\texttt {FFT}$ \u5b66\u5230\u751f\u6210\u51fd\u6570\uff0c\u4eca\u5929\u6df1\u591c\u521a\u597d\u78b0\u5230\u53ef\u4ee5\u7528 $\\texttt {EGF + NTT}$ \u505a\u51fa\u6765\u7684\u9898\uff0c\u6fc0\u52a8\u7684\u773c\u6cea\u5c04\u4e86\u51fa\u6765\uff0c\u5199\u7bc7\u9898\u89e3\u3002\n\n### \u9898\u76ee\u5206\u6790\uff1a\n\n$\\texttt {\u505a\u6cd5\uff1a\u751f\u6210\u51fd\u6570 + NTT}$\n\n\u539f\u5e8f\u5217\u957f\u5ea6\u4e3a $n$\uff0c\u4e00\u4e2a\u5b57\u6bcd\u5728\u5e8f\u5217\u4e2d\u51fa\u73b0\u4e86 $m$ \u6b21\uff0c\u5219\u8fd9\u4e2a\u5b57\u6bcd\u7684\u751f\u6210\u51fd\u6570\u4e3a\n\n$$g(x)=1+x+ \\frac {1}{2} x^{2} + \\cdots + \\frac {1}{(m-1)!}x^{m-1}+ \\frac {1}{m!}x^{m}$$\n\n\u5219\u6240\u6709\u7684\u65b9\u6848\u5c31\u662f $26$ \u4e2a\u5b57\u6bcd\u7684\u751f\u6210\u51fd\u6570 $g(x)$ \u8fde\u4e58\uff0c\u8bb0\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684\u7b2c $x$ \u6b21\u9879\u4e3a $f(x)$\uff0c\u56e0\u4e3a\u9898\u76ee\u8ba9\u6c42\u7684\u662f\u5b50\u5e8f\u5217\u7684\u6392\u5217\u65b9\u6848\uff0c\u6240\u4ee5\u5c31\u662f\u5bf9\u5e94\u7684\u65b9\u6848\u7684\u957f\u5ea6\u518d\u4e58\u4e0a\u4e00\u4e2a\u5bf9\u5e94\u957f\u5ea6\u7684\u9636\u4e58\uff0c\u8868\u8fbe\u51fa\u6765\u5c31\u662f\n\n$$\\sum \\limits_{i=1}^n i! \\times f(i)$$\n\n\u663e\u7136 $26$ \u4e2a\u5b57\u6bcd\u7684\u7684\u751f\u6210\u51fd\u6570\u8fde\u4e58\u64cd\u4f5c\u53ef\u4ee5\u76f4\u63a5 $\\texttt {NTT}$\uff0c\u8fd9\u4e2a\u81ea\u589e\u7684\u611f\u89c9\u5e94\u8be5\u53ef\u4ee5\u518d\u5206\u6cbb\u4e00\u4e0b\uff0c\u4f46\u6211\u4e0d\u597d\u8bf4\u5b83\u5728\u8fd9\u4e2a\u6570\u636e\u8303\u56f4\u4e0b\u8dd1\u5f97\u8fc7\u786c\u4e58\u7684 $\\texttt {NTT}$\u3002\n\n### Code.\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int p=998244353,G=3,Gi=332748118,N=5e4+10,M=5000;\ninline ll ksm(ll a,ll b) {ll res=1; while(b) {if(b&1ll) res=(res*a)%p; a=(a*a)%p; b>>=1ll;} return res;}\nint r[N],cnt[30],lim,l; string s; ll fin[N],ifin[N],sum; vector<ll> pl,tmp,yl;\nvoid ntt(vector<ll> &A,int op)\n{\n\tfor(int i=0;i<lim;i++) if(i < r[i]) swap(A[i],A[r[i]]);\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tll wn=ksm(~op ? G : Gi,(p-1)/(mid<<1));\n\t\tfor(int R=mid<<1,j=0;j<lim;j+=R)\n\t\t{\n\t\t\tll w=1;\n\t\t\tfor(int k=0;k<mid;k++,w=(w*wn)%p)\n\t\t\t{\n\t\t\t\tint x=A[j+k],y=w*A[j+mid+k]%p;\n\t\t\t\tA[j+k]=(x+y)%p; A[j+mid+k]=(x-y+p)%p;\n\t\t\t}\n\t\t}\n\t}\n}\nvoid NTT()\n{\n\tint kl=pl.size()+tmp.size()-1;\n\tlim=1; l=0; while(lim < kl) lim<<=1,l++; ll inv=ksm(lim,p-2);\n\tfor(int i=0;i<lim;i++) r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tpl.resize(lim); tmp.resize(lim);\n\tntt(pl,1); ntt(tmp,1); for(int i=0;i<lim;i++) pl[i]=(pl[i]*tmp[i])%p; ntt(pl,-1);\n\tfor(int i=0;i<=kl;i++) pl[i]=(pl[i]*inv)%p; pl.resize(kl);\n}\nint main()\n{\n\tcin>>s; \n\tyl.resize(M+1); fin[0]=1; for(int i=1;i<=M;i++) fin[i]=(fin[i-1]*i)%p;\n\tifin[M]=ksm(fin[M],p-2); for(int i=M;i>=1;i--) ifin[i-1]=(ifin[i]*i)%p;\n\tfor(int i=0;i<=M;i++) yl[i]=ifin[i];\n\tfor(auto it : s) cnt[it-'a']++; pl=yl; pl.resize(cnt[0]+1);\n\tfor(int i=1;i<26;i++)\n\t{\n\t\tif(! cnt[i]) continue ; \n\t\ttmp.resize(M+1); tmp=yl; tmp.resize(cnt[i]+1);\n\t\tNTT();\n\t}\n\tfor(int i=1;i<(int)pl.size();i++) sum=(sum+pl[i]*fin[i]%p)%p;\n\tprintf(\"%lld\",sum);\n\treturn 0;\n}\n```",
        "postTime": 1670085392,
        "uid": 230865,
        "name": "EastPorridge",
        "ccfLevel": 0,
        "title": "[ABC234F] Reordering \u9898\u89e3"
    }
]
[
    {
        "content": "## $\\text{Statement}$\n\n\u7ed9\u5b9a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a$\uff0c\u4ee5\u53ca\u4e00\u4e2a\u6574\u6570 $k$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a $1\\le x \\le k$\uff0c\u6c42\u51fa\u5982\u4e0b\u5f0f\u5b50\u7684\u503c\uff1a\n$$\\sum_{l=1}^{n-1}\\sum_{r=l+1}^n \\left(a_l + a_r\\right)^ x$$\n\n\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n$2\\le n \\le 2\\times 10^5,\\ 1 \\le k \\le 300, \\ 1\\le a_i \\le 10^8$\u3002\n\n## $\\text{Solution}$\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\n$$\\sum_{l=1}^{n}\\sum_{r=1}^n \\left(a_l + a_r\\right)^x = 2\\sum_{l=1}^{n-1}\\sum_{r=l+1}^n \\left(a_l + a_r\\right)^x  +\\sum_{l=1}^{n}\\left(a_l + a_l\\right)^x $$\n\n\u4e8e\u662f\u53ef\u4ee5\u8ba1\u7b97\n$$\\sum_{l=1}^{n}\\sum_{r=1}^n \\left(a_l + a_r\\right)^x$$\n\u51cf\u53bb\n$$\\sum_{l=1}^{n}\\left(a_l + a_l\\right)^x$$\n\u540e\u9664\u4e8c\u5c31\u662f\u7b54\u6848\u3002\n\n\u6839\u636e\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u53ef\u4ee5\u5f97\u5230\n$$\\begin{aligned} \n\n&\\sum_{l=1}^{n}\\sum_{r=1}^n \\left(a_l + a_r\\right)^x \n\\\\ = \\ & \\sum_{l=1}^{n}\\sum_{r=1}^n\\sum_{i=0}^x \\binom{x}{i} a_l^i a_r^{x-i}\n\\\\ = \\ & \\sum_{i=0}^x \\sum_{l=1}^{n}\\sum_{r=1}^n\\frac{a_l^i}{i!} x!\\frac{a_r^{x-i}}{(x - i)!}\n\\\\ = \\ & \\sum_{i=0}^x x!\\left(\\sum_{l=1}^{n}\\frac{a_l^i}{i!}\\right) \\left(\\sum_{r=1}^n\\frac{a_r^{x-i}}{(x - i)!}\\right)\n\n\\end{aligned}$$\n\n\u7531\u4e8e $x$ \u7684\u8303\u56f4\u5c0f\uff0c\u53ef\u4ee5\u652f\u6301 $O(k^2)$ \u7684\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e $x$ \u548c $i$ \u5408\u5e76\u7b54\u6848\u3002\n\n\u5bf9\u6bcf\u4e2a $1\\le m\\le k$ \u9884\u5904\u7406 \n$$\\sum_{l=1}^{n}\\frac{a_l^m}{m!}$$ \n\u5373\u53ef\u505a\u5230 $O(k^2)$ \u5408\u5e76\u7b54\u6848\u3002\u5408\u5e76\u7b54\u6848\u4e5f\u53ef\u5e94\u7528\u5377\u79ef\uff0c\u4f46\u590d\u6742\u5ea6\u74f6\u9888\u4e0d\u5728\u8fd9\u91cc\u3002\n\n\u6734\u7d20\u5408\u5e76\u7684\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nk + k^2)$\u3002\n\n$\\text{code : }$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntemplate <typename T> void get(T & x) {\n\tx = 0; char ch = getchar(); bool f = false; while (ch < '0' or ch > '9') f = f or ch == '-', ch = getchar();\n\twhile ('0' <= ch and ch <= '9') x = (x << 1) + (x << 3) + ch - '0', ch = getchar(); f && (x = -x); \n} template <typename T, typename ... Args> void get(T & a, Args & ... b) { get(a); get(b...); }\n#define rep(i,s,t) for (register int i = (s), i##_ = (t) + 1; i < i##_; ++ i)\nconst int N = 4e5 + 10;\nint n, k, sum[305], a[N], v[305];\n\nsigned main() {\n\tget(n, k); rep(i,1,n) get(a[i]);\n    init_fac(305);\n    v[0] = n;\n    rep(j,1,n) {\n        int t1 = 1, t2 = 1;\n        rep(i,1,k) {\n            t1 = mul(t1, a[j]), t2 = mul(t2, 2 * a[j]);\n            v[i] = add(v[i], mul(t1, ifc[i]));\n            sum[i] = add(sum[i], t2);\n        }\n    }\n    rep(x,1,k) {\n        int ans = 0;\n        rep(i,0,x) ans = add(ans, mul(v[i], v[x - i]));\n        ans = mul(ans, fac[x]);\n        ans = sub(ans, sum[x]);\n        cout << mul(ans, inv2) << '\\n';\n    }\n}\n```",
        "postTime": 1670738769,
        "uid": 631791,
        "name": "joke3579",
        "ccfLevel": 0,
        "title": "ARC106D \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\uff0c\n\n$$\n\\sum_{l = 1}^{n - 1}\\sum_{r = l + 1}^{n}(a_l + a_r)^x = \\frac{\\sum\\limits_{l = 1}^{n}\\sum\\limits_{r = 1}^{n}(a_l + a_r)^x - \\sum\\limits_{i = 1}^{n}(2a_i)^x}{2}\n$$\n\n\u7136\u540e\u5bf9\u4e8e $\\sum\\limits_{i = 1}^{n}\\sum\\limits_{j = 1}^{n}(a_l + a_r)^x$\uff0c\u53ef\u4ee5\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u3002\n\n$$\n\\begin{aligned}\n\\sum\\limits_{l = 1}^{n}\\sum\\limits_{r = 1}^{n}(a_l + a_r)^x &= \\sum_{l = 1}^{n}\\sum_{r = 1}^{n}\\sum_{i + j = x}\\binom{x}{i}a_l^i a_r^j \\\\\n&= \\sum_{i + j = x}\\binom{x}{i}\\left(\\sum_{l = 1}^{n}a_l^i\\right)\\left(\\sum_{r = 1}^{n}a_r^j\\right) \\\\\n\\end{aligned}\n$$\n\n\u66b4\u529b\u9884\u5904\u7406 $b_x = \\sum\\limits_{i = 1}^{n}a_i^x$\uff0c\u5373\u53ef\u5feb\u901f\u7b97\u51fa\u6240\u6709\u7b54\u6848\u3002",
        "postTime": 1677655250,
        "uid": 76156,
        "name": "henrytb",
        "ccfLevel": 8,
        "title": "ARC106D \u9898\u89e3"
    }
]
[
    {
        "content": "## [ABC245D] Polynomial division\n\n\u5c31\u662f\u4e00\u4e2a~~\u5927\u6a21\u62df~~\u5c0f\u6a21\u62df\u3002\u3002\u3002\n\n### \u524d\u7f6e\u829d\u58eb\uff1a\u6574\u5f0f\u5927\u9664\u6cd5\n\n\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u5c0f\u5b66\u5b66\u8fc7\u7684\u7ad6\u5f0f\u9664\u6cd5 ~~\uff08\u867d\u7136\u4f5c\u8005\u4e5f\u8fd8\u662f\u5728\u8bfb xxs\uff09~~\uff0c\u53ea\u662f\u52a0\u4e86\u5b57\u6bcd\u3002\n\n\u4f8b\uff1a$(x^3+5x^2+6x+8) \\div (x+4)$\n\nStep $0$\uff1a \u628a\u88ab\u9664\u5f0f\u548c\u9664\u5f0f[\u964d\u5e42\u6392\u5217](https://baike.baidu.com/item/%E9%99%8D%E5%B9%82%E5%BC%8F/18881128?fr=aladdin)\uff0c\u8fd9\u91cc\u5df2\u7ecf\u6392\u597d\u3002\n\nStep $1$\uff1a \u5217\u7ad6\u5f0f\uff0c\u771f\u7684\u53ea\u662f\u5217\u7ad6\u5f0f\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rws42ex5.png)\n\nStep $2$\uff1a \u9664\u5f0f\u4e3a\u4e24\u9879\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b21\u53d6\u88ab\u9664\u5f0f\u524d\u4e24\u9879\uff0c$(x^3+5x^2) \\div (x+4) = (x^2+4x^2)\\cdots(x^2)$\uff0c\u5546 $x^2$\uff0c\u4f59 $x^2$\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t5tkt4yo.png)\n\nStep $3$\uff1a \u5c06 $6x$ \u843d\u4e0b\u6765\u3002\u53d6\u88ab\u9664\u5f0f\u4e8c\u3001\u4e09\u9879\uff0c$(x^2+6x) \\div (x+4) = (x)\\cdots(2x)$\uff0c\u5546 $x$\uff0c\u4f59 $2x$\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/u0monyhz.png)\n\nStep $4$\uff1a \u5c06 $8$ \u843d\u4e0b\u6765\u3002\u53d6\u88ab\u9664\u5f0f\u6700\u540e\u4e24\u9879\uff0c$(2x+8) \\div (x+4) = (2)\\cdots(0)$\uff0c\u5546 $2$\uff0c\u4f59 $0$\u3002\u9664\u5c3d\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/614k28ca.png)\n\n\u597d\u4e86\uff0c\u5173\u4e8e\u5927\u9664\u6cd5\u7684\u8bb2\u89e3\u5c31\u5230\u8fd9\u91cc\uff0c\u63a5\u4e0b\u6765\u5f00\u59cb\u770b\u9898\u3002\n\n+ \u7ed9\u5b9a\u56e0\u5f0f\u548c\u79ef\u5f0f\uff0c\u6c42\u53e6\u4e00\u4e2a\u56e0\u5f0f\u3002\n\n\u5c0f\u5b66\u5b66\u8fc7\uff0c\u5f53 $ab=c$ \u65f6\uff0c$b=\\frac{c}{a}$\u3002\u6240\u4ee5\uff0c\u7b54\u6848\u5c31\u662f $\\frac{C(x)}{A(x)}$\u3002\u7136\u540e\u5c31\u662f\u5927\u9664\u6cd5\u3002\n\nCode:\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n,m,a[205],b[205],c[205];\nint main() \n{\n  cin>>n>>m;\n  for(int i=0;i<=n;i++)\n    cin>>a[i];\n  for(int i=0;i<=n+m;i++)\n    cin>>c[i];\n  for(int i=m;i>=0;i--) \n  {\n    b[i]=c[i+n]/a[n];\n    for(int j=0;j<=n;j++)\n      c[i+j]-=b[i]*a[j];\n  }\n  for(int i=0;i<=m;i++)\n    cout<<b[i]<<\" \";\n  cout<<\"\\n\";\n  return 0;\n}\n```\n![](https://cdn.luogu.com.cn/upload/image_hosting/6jga7wef.png)\n\n\u770b\u5728\u8fd9\u4e2a\u8fd0\u52bf\u7684\u4efd\u4e0a\uff0c\u7ba1\u7406\u5927\u5927\u7ed9\u4e2a\u8fc7\u5427\u3002",
        "postTime": 1679039291,
        "uid": 701302,
        "name": "BLuemoon_",
        "ccfLevel": 3,
        "title": "ABC245D"
    },
    {
        "content": "\u8fd9\u9053\u9898\u5c31\u662f\u4e00\u4e2a\u5c0f\u6a21\u62df\uff0c\u4f46\u6709\u5f88\u591a\u7ec6\u8282\u9700\u8981\u6ce8\u610f\uff0c\u6211\u8c03\u4e86\u6574\u6574 1 \u4e2a\u534a\u5c0f\u65f6\uff08\u6216\u8bb8\u662f\u6211\u592a\u84bb\u4e86\u7f62\uff09\r\n\r\n## \u9898\u610f\u7b80\u8ff0\r\n\r\n\u4f9d\u9898\u610f\uff0c\u6709\u4e09\u591a\u9879\u5f0f\uff1a\r\n\r\n$$\r\nA(x)=A_Nx^N+A_{N-1}x^{N-1}+\\cdots\\ +A_1x+A_0 \\\\\r\nB(x)=B_Mx^M+B_{M-1}x^{M-1}+\\cdots\\ +B_1x+B_0 \\\\\r\nC(x)=A(x)B(x)=C_{N+M}x^{N+M}+C_{N+M-1}x^{N+M-1}+\\cdots\\ +C_1x+C_0\r\n$$\r\n\r\n\u5df2\u77e5 $A(x)$\uff0c$C(x)$\uff0c\u6c42 $B(x)$\r\n\r\n## \u601d\u8def\u7b80\u8ff0\r\n\r\n\u5373\u6a21\u62df\u591a\u9879\u5f0f\u7684\u9664\u6cd5\u7684\u7ad6\u5f0f\uff0c\u5982\u56fe\uff08\u4ee5\u4f8b\u4e00\u4e3a\u4f8b\uff09\uff1a\r\n![example](https://cdn.luogu.com.cn/upload/image_hosting/tziuhlpy.png)\r\n\r\n\u901a\u8fc7\u89c2\u5bdf\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u9053\u9898\u7684\u591a\u9879\u5f0f\u9664\u6cd5\u662f\u7531\u4ee5\u4e0b\u6b65\u9aa4\u7ec4\u6210\u7684\uff1a\r\n\r\n1. \u628a\u88ab\u9664\u5f0f\uff08$C(x)$\uff09\u3001\u9664\u5f0f\uff08$A(x)$\uff09\u6309 $x$ \u964d\u5e42\u6392\u5217\uff1b\r\n2. \u7528\u5f53\u524d\u88ab\u9664\u5f0f\u7684\u7b2c\u4e00\u9879\u9664\u4ee5\u9664\u5f0f\u7b2c\u4e00\u9879\uff0c\u5f97\u5230\u5546\u5f0f\u7684\u7b2c $n$ \u9879\uff1b\r\n3. \u7528\u5546\u5f0f\u7b2c $n$ \u9879\u4e58\u4ee5\u9664\u5f0f\uff0c\u50cf\u666e\u901a\u7ad6\u5f0f\u4e58\u6cd5\u4e00\u6837\u5bf9\u9f50\uff0c\u5e76\u76f8\u51cf\uff1b\r\n4. \u628a\u51cf\u5f97\u7684\u5dee\u5f53\u4f5c\u65b0\u7684\u88ab\u9664\u5f0f\uff0c\u518d\u56de\u5230\u7b2c 1 \u6b65\uff0c\u76f4\u5230\u4f59\u5f0f\u4e3a\u96f6\u3002\r\n\r\n\u770b\u4e0d\u61c2\u7684\u53ef\u4ee5\u501f\u52a9\u56fe\u7247\u7406\u89e3\u3002\r\n\r\n## \u91cd\u70b9\u6ce8\u610f\r\n\r\n**\u4e00\u5b9a**\u8981\u6309**\u964d\u5e42**\u6392\u5217\uff08\u6211\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a\u5361\u4e86 1.5 \u4e2a\u5c0f\u65f6\uff09\r\n\r\n## ACode\r\n```cpp\r\n#include <cstdio>\r\n#include <vector>\r\n\r\nusing namespace std;\r\n\r\nint a[210], c[210]; /* A(x) \u4e0e C(x) \u7684\u7cfb\u6570 */\r\nvector<int> b;\r\n\r\nint main()\r\n{\r\n\tint n, m;\r\n\r\n\tscanf(\"%d %d\", &n, &m);\r\n\r\n\tfor (int i = 0, x; i <= n; ++i)\r\n\t\tscanf(\"%d\", &x), a[i] = x;\r\n\tfor (int i = 0, x; i <= n + m; ++i)\r\n\t\tscanf(\"%d\", &x), c[i] = x;\r\n\t\r\n\tfor (int i = 0; i <= n / 2.0 - 0.5; ++i) /* \u7ffb\u8f6c\u6570\u7ec4a\uff0cc\u3002\u56e0\u4e3a\u8f93\u5165\u662f\u5347\u5e42\u6392\u5217\u7684\uff0c\u8981\u6362\u6210\u964d\u5e42 */\r\n\t\tswap(a[i], a[n - i]);\r\n\tfor (int i = 0; i <= (n + m) / 2.0 - 0.5; ++i)\r\n\t\tswap(c[i], c[n + m - i]);\r\n\t\r\n\tfor (int top = 0; top <= n + m; ++top) /* \u4e3b\u4f53\u90e8\u5206\uff0c\u524d\u6587\u6709\u8bb2\uff0c\u4e0d\u505a\u89e3\u91ca */\r\n\t{\r\n\t\tint tmp = c[top] / a[0];\r\n\t\tb.push_back(tmp);\r\n\t\tfor (int j = 0; j <= n && j + top <= n + m; ++j)\r\n\t\t\tc[j + top] -= a[j] * tmp;\r\n\t}\r\n\twhile (!b.empty() && b.size() > m + 1) /* \u9632\u6b62\u540e\u63a5\u96f6\uff08\u5f62\u5982100 -1 0\uff09 */\r\n\t\tb.pop_back();\r\n\tfor (vector<int>::reverse_iterator i = b.rbegin(); i != b.rend(); ++i) /* \u7ffb\u8f6c\u8f93\u51fa\uff08\u8f93\u5165\u662f\u5347\u5e42\u6392\u5217\uff0c\u800c\u5f53\u524d\u662f\u964d\u5e42\u6392\u5217\uff09 */\r\n\t\tprintf(\"%d \", *i);\r\n\treturn 0;\r\n}\r\n```",
        "postTime": 1668183364,
        "uid": 474969,
        "name": "caiyuyang",
        "ccfLevel": 4,
        "title": "AT_abc245_d\u9898\u89e3"
    },
    {
        "content": "\u9898\u610f\uff1a\u6709\u4e09\u4e2a\u591a\u9879\u5f0f $ A,B,C $\uff0c\u6ee1\u8db3 $ A \\times B=C $\uff0c\u73b0\u5728\u7ed9\u5b9a $ A,C $\uff0c\u6c42 $ B $\u3002\n\n\u56e0\u4e3a\u672c\u9898\u6570\u636e\u8303\u56f4\u5f88\u5c0f\u6240\u4ee5\u5b9e\u9645\u4e0a $ \\mathcal{O}(n^2) $ \u65f6\u95f4\u590d\u6742\u5ea6\u7684\u9ad8\u7cbe\u5ea6\u9664\u6cd5\u53ef\u4ee5\u901a\u8fc7\uff0c\u4f46\u6211\u4e0d\u4f1a\u5199\u9ad8\u7cbe\u5ea6\u9664\u6cd5\uff0c\u4e8e\u662f\u5957\u4e0a\u4e86\u591a\u9879\u5f0f\u9664\u6cd5\u677f\u5b50\u3002\n\n\u591a\u9879\u5f0f\u9664\u6cd5\u53ef\u4ee5\u5728 $ \\mathcal{O}(n\\log{n}) $ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u51fa\u4e24\u4e2a\u591a\u9879\u5f0f\u76f8\u9664\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u53c2\u8003 [\u591a\u9879\u5f0f\u9664\u6cd5](https://www.luogu.com.cn/problem/P4512)\u3002\n\n\u5957\u4e0a\u591a\u9879\u5f0f\u9664\u6cd5\u677f\u5b50\u4e4b\u540e\u6ce8\u610f\u8d1f\u6570\u548c\u7cfb\u6570\u4e2d\u51fa\u73b0\u96f6\u7684\u60c5\u51b5\u7279\u6b8a\u5224\u65ad\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $ \\mathcal{O}(n\\log{n}) $\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define LL long long\nLL in() \n{\n\tchar ch; LL x = 0, f = 1;\n\twhile(!isdigit(ch = getchar()))(ch == '-') && (f = -f);\n\tfor(x = ch ^ 48; isdigit(ch = getchar()); x = (x << 1) + (x << 3) + (ch ^ 48));\n\treturn x * f;\n}\nconst int maxn = 4e5 + 10;\nconst long long mod = 998244353;\nint len, r[maxn];\nusing std::vector;\nLL ksm(LL x, LL y) \n{\n\tLL re = 1LL;\n\twhile(y) \n\t{\n\t\tif(y & 1) \n\t\tre = re * x % mod;\n\t\tx = x * x % mod;\n\t\ty >>= 1;\n\t}\n\treturn re;\n}\nvoid FNTT(vector<int> &A, int flag) \n{\n\tA.resize(len);\n\tfor(int i = 0; i < len; i++) \n\tif(i < r[i]) \n\tstd::swap(A[i], A[r[i]]);\n\tfor(int l = 1; l < len; l <<= 1) \n\t{\n\t\tint w0 = ksm(3, (mod - 1) / (l << 1));\n\t\tfor(int i = 0; i < len; i += (l << 1)) \n\t\t{\n\t\t\tint w = 1, a0 = i, a1 = i + l;\n\t\t\tfor(int k = 0; k < l; k++, a0++, a1++, w = 1LL * w * w0 % mod) {\n\t\t\t\tint tmp = 1LL * A[a1] * w % mod;\n\t\t\t\tA[a1] = ((A[a0] - tmp) % mod + mod) % mod;\n\t\t\t\tA[a0] = (A[a0] + tmp)  % mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(!(~flag)) \n\t{\n\t\tstd::reverse(A.begin() + 1, A.end());\n\t\tint inv = ksm(len, mod - 2);\n\t\tfor(int i = 0; i < len; i++) A[i] = 1LL * A[i] * inv % mod;\n\t}\n}\nvector<int> operator - (const vector<int> &A, const vector<int> &B)\n{\n\tvector<int> ans;\n\tfor(int i = 0; i < (int)std::min(A.size(), B.size()); i++) ans.push_back(A[i] - B[i]);\n\tif(A.size() < B.size()) for(int i = A.size(); i < (int)B.size(); i++) ans.push_back(-B[i]);\n\tif(A.size() > B.size()) for(int i = B.size(); i < (int)A.size(); i++) ans.push_back(A[i]);\n\treturn ans;\n}\nvector<int> operator * (vector<int> A, vector<int> B) \n{\n\tint tot = A.size() + B.size() - 1;\n\tfor(len = 1; len <= tot; len <<= 1);\n\tfor(int i = 0; i < len; i++) \n\tr[i] = (r[i >> 1] >> 1) | ((i & 1) * (len >> 1));\n\tFNTT(A, 1), FNTT(B, 1);\n\tvector<int> ans;\n\tfor(int i = 0; i < len; i++) ans.push_back(1LL * A[i] * B[i] % mod);\n\tFNTT(ans, -1);\n\tans.resize(tot);\n\treturn ans;\n}\nvector<int> inv(const vector<int> &A) \n{\n\tif(A.size() == 1) \n\t{\n\t\tvector<int> ans;\n\t\tans.push_back(ksm(A[0], mod - 2));\n\t\treturn ans;\n\t}\n\tint n = A.size(), _ = (n + 1) >> 1;\n\tvector<int> ans, B = A;\n\tB.resize(_);\n\tans.push_back(2);\n\tB = inv(B);\n\tans = B * (ans - A * B);\n\tans.resize(n);\n\treturn ans;\n}\nvector<int> rev(const vector<int> &A) \n{\n\tvector<int> B = A;\n\tstd::reverse(B.begin(), B.end());\n\treturn B;\n}\nvoid work(vector<int> f, vector<int> g) \n{\n\tint n = f.size() - 1, m = g.size() - 1;\n\tvector<int> ff = rev(f), gg = rev(g), s, y;\n\tff.resize(n - m + 1), gg.resize(n - m + 1);\n\ts = ff * inv(gg);\n\ts.resize(n - m + 1);\n\ts = rev(s);\n\tvector<int> v = g * s;\n\tv.resize(m), f.resize(m), y.resize(m);\n\tfor(int i = 0; i < m; i++) \n\ty[i] = ((f[i] - v[i]) % mod + mod) % mod;\n\tfor(int i = 0; i < n - m + 1; i++) \n    if(s[i]>=0&&s[i]<=9.9e8)\n\tprintf(\"%d \", s[i]);\n    else if(s[i]<0)\n    printf(\"%d \", s[i]+mod);\n    else\n    printf(\"%d \", s[i]-mod);\n}\nint main() \n{\n\tint n = in(), m = in();\n    m=n+m;\n\tvector<int> a, b;\n\tfor(int i = 0; i <= n; i++) \n\ta.push_back(in());\n\tfor(int i = 0; i <= m; i++) \n\tb.push_back(in());\n    swap(a,b);\n\twork(a, b);\n}\n```\n",
        "postTime": 1666361852,
        "uid": 714821,
        "name": "loser_seele",
        "ccfLevel": 4,
        "title": "ABC245D\u9898\u89e3"
    }
]
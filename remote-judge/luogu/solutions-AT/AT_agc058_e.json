[
    {
        "content": "\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4ee5\u4e0b\u4e0b\u6807\u53ca\u503c\u57df\u5747\u4e3a $[0,n)$\n\n\u5148\u8003\u8651\u5bf9\u4e8e\u4e00\u4e2a $x$ \u5982\u4f55\u6c42 $f(x)$\uff0c\u6bcf\u4e00\u6b21\u6211\u4eec\u90fd\u5e0c\u671b\u5c3d\u53ef\u80fd\u5730\u628a $x$ \u4e2d\u6700\u5c0f\u7684\u90a3\u4e2a\u63d0\u5230\u524d\u9762\uff0c\u4e8e\u662f\u6709\u4ee5\u4e0b\u7b97\u6cd5\uff1a\n\n1. \u8bb0 $inv$ \u4e3a $x$ \u7684\u9006\u5e8f\u5bf9\u6570\uff0c$s=\\frac {inv}2$\uff0c\u7b54\u6848\u5e8f\u5217\u521d\u59cb\u4e3a\u7a7a\n\n2. \u8fdb\u884c\u4ee5\u4e0b\u64cd\u4f5c $n$ \u6b21\uff08\u79f0\u5176\u4e3a\u64cd\u4f5c 1\uff09\uff1a\u627e\u5230 $\\min\\{x_0,\\dots,x_{\\lfloor s\\rfloor}\\}$\uff0c\u8bb0\u5176\u4e0b\u6807\u4e3a $i$\uff0c\u7ed9 $s$ \u51cf\u53bb $i$\uff0c\u628a $x_i$ \u52a0\u5165\u7b54\u6848\u5e8f\u5217\uff0c\u5e76\u5c06\u5176\u4ece $x$ \u4e2d\u5220\u9664\n\n\u6700\u7ec8\u5f97\u5230\u7684\u7b54\u6848\u5e8f\u5217\u5373\u4e3a $f(x)$ \u7684\u7ed3\u679c\n\n\u8bb0 $k$ \u4e3a\u7b2c\u4e00\u6b21\u51fa\u73b0 $A_{k}>A_{k+1}$ \u7684\u5730\u65b9\uff0c\u82e5\u4e0d\u5b58\u5728\u5219 $A$ \u663e\u7136\u4e00\u5b9a\u5408\u6cd5\n\n\u4e0d\u96be\u53d1\u73b0\u7ecf\u8fc7 $k$ \u6b21\u64cd\u4f5c 1 \u4e4b\u540e\u7684 $x$ \u5e8f\u5217\u548c $s$ \u4e00\u5b9a\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a\n\n1. $x_0=A_k$\uff0c$x_{\\lfloor s\\rfloor+1}=A_{k+1}$\n\n2. $x_0=\\min\\{x_0,\\dots,x_{\\lfloor s\\rfloor}\\}$\n\n3. \u5c06 $A_k,A_{k+1}$ \u4ece $x$ \u5e8f\u5217\u4e2d\u53bb\u6389\u540e\u5269\u4e0b\u7684 $x$ \u5e8f\u5217\u4e00\u5b9a\u662f $A_{k+2},A_{k+3},\\dots,A_{n}$\n\n\u90a3\u4e48\u7ecf\u8fc7 $f$ \u53d8\u5316\u4e4b\u540e\u53d8\u6210 $A$ \u7684\u5e8f\u5217 $B$ \u4e00\u5b9a\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u64cd\u4f5c\u5f97\u5230\uff1a\n\n1. \u521d\u59cb\u4ee4 $B=A$\n\n2. \u4ece\u5927\u5230\u5c0f\u904d\u5386 $k+1,k-1,k-2,\\dots,1$\uff0c\u6bcf\u6b21\u53ef\u4ee5\u628a $B_i$ \u5411\u540e\u79fb $j$ \u4e2a\u4f4d\u7f6e\uff0c\u5176\u4e2d $j$ \u8981\u6ee1\u8db3 $\\forall x\\in[1,j]$ \u6709 $B_i<B_{i+x}$\uff0c\u82e5\u6b64\u65f6 $i=k+1$ \u5219\u8fd8\u8981\u6ee1\u8db3 $\\forall x\\in[1,j]$\uff0c$A_k<B_{i+x}$\n\n\u8bb0\u6bcf\u4e2a $B_i$ \u5411\u540e\u79fb\u7684\u8ddd\u79bb\u4e3a $c_i$\uff0c\u73b0\u5728\u7684\u76ee\u6807\u5373\u4e3a\u786e\u5b9a $c_i$\n\n\u4e0d\u59a8\u8003\u8651 $\\Delta=s-p$\uff0c\u5176\u4e2d $s,p$ \u4e3a $k+1$ \u6b21\u64cd\u4f5c 1 \u4e4b\u540e\u7684 $s$ \u548c $A_k$ \u6240\u5728 $x$ \u5e8f\u5217\u4e2d\u7684\u4f4d\u7f6e\uff0c\u6211\u4eec\u5e0c\u671b $\\Delta=0\\lor \\Delta=\\frac 12$\n\n\u8003\u8651 $c_i$ \u589e\u52a0 $1$ \u5bf9 $\\Delta$ \u7684\u5f71\u54cd\uff1a\n\n1. \u82e5 $i\\not=k+1$\uff0c\u5219 $c_i$ \u589e\u52a0 $1$ \u4f1a\u5bfc\u81f4\u539f\u6765\u5e8f\u5217\u4e2d\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\u589e\u52a0 $1$\uff0c\u5728\u7b2c $i$ \u6b21\u64cd\u4f5c 1 \u4e2d $s$ \u591a\u51cf\u5c11 $1$\uff0c\u603b\u5171\u4f1a\u5bfc\u81f4 $\\Delta$ \u51cf\u5c11 $\\frac 12$\n\n2. \u82e5 $i=k+1$\uff0c\u5219 $c_i$ \u589e\u52a0 $1$ \u4f1a\u5bfc\u81f4\u539f\u6765\u5e8f\u5217\u4e2d\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\u589e\u52a0 $1$\uff0c\u540c\u65f6 $p$ \u589e\u52a0 $1$\uff0c\u603b\u5171\u4f1a\u5bfc\u81f4 $\\Delta$ \u51cf\u5c11 $\\frac 12$\n\n\u7efc\u4e0a\uff0c\u6bcf\u4e2a $c_i$ \u589e\u52a0 $1$ \u90fd\u4f1a\u5bfc\u81f4 $\\Delta$ \u51cf\u5c11 $\\frac 12$\n\n\u5f53 $\\sum c_i$ \u4e3a $0$ \u65f6\u663e\u7136 $\\Delta=\\frac{inv}2$\uff0c\u6211\u4eec\u53ea\u9700\u8981\u68c0\u9a8c $\\sum c_i=inv-1$ \u548c $\\sum c_i=inv$ \u65f6\u662f\u5426\u5b58\u5728\u4e00\u7ec4\u5408\u6cd5\u7684 $c$ \u5373\u53ef\n\n\u786e\u5b9a $\\sum c_i$ \u4e4b\u540e\uff0c\u53ef\u4ee5\u786e\u5b9a\u539f\u6765\u5e8f\u5217\u4e2d\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\uff0c\u8003\u8651\u5bf9\u4e8e $A_1,A_2,\\dots,A_{k-1},A_{k+1}$ \u4e2d\u7684\u6bcf\u4e2a\u6570\u4ece\u5c0f\u5230\u5927\u8d2a\u5fc3\u5730\u786e\u5b9a $c_i$ \u7684\u5927\u5c0f\uff08\u5373 $c_i$ \u53d6\u5230\u80fd\u4fdd\u8bc1\u5408\u6cd5\u7684\u6700\u5927\u503c\uff09\uff0c\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e00\u5b9a\u662f\u6700\u4f18\u7684\n\n\u5728\u786e\u5b9a $c_i$ \u7684\u540c\u65f6\u5224\u65ad\u662f\u5426\u6ee1\u8db3\u6700\u5f00\u59cb\u7684\u7b97\u6cd5\u4e2d\u7684\u6761\u4ef6\u5373\u53ef\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n\\log n)$\uff0c\u74f6\u9888\u5728\u6c42\u9006\u5e8f\u5bf9\u6570\u91cf\n\ncode:\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define MAXN 300010\nusing namespace std;\nint tst,n,a[MAXN],pos[MAXN];\nstruct BIT{\n\tint t[MAXN];\n\tint lowbit(int x){return x&(-x);}\n\tvoid update(int x,int y){for(;x<=n;x+=lowbit(x))t[x]+=y;}\n\tint query(int x){int ret=0;for(;x;x-=lowbit(x))ret+=t[x];return ret;}\n\tvoid clear(){for(int i=1;i<=n;i++)t[i]=0;}\n}T;\nbool check(int inv,int sum){//cerr<<\"check:\"<<inv<<' '<<sum<<endl;\n\tint s=(inv+sum)/2,k=0;\n\tfor(int i=1;i<n;i++)\n\t\tif(a[i]>a[i+1]){k=i;break;}\n\tif(!k)return true;int r=n+1;\n\tfor(int i=1;i<a[k];i++){\n\t\tif(pos[i]==k+1){\n\t\t\tfor(int j=k+2;j<=n;j++)if(a[j]<a[k])r=min(r,j);\n\t\t\tint now=min(sum,r-k-2);\n\t\t\tsum-=now;r=min(r,k+1+now);\n\t\t}else if(pos[i]<k){\n\t\t\tif(r<=n&&r-pos[i]<=s)return false;\n\t\t\tint now=min(sum,r-pos[i]-1);\n\t\t\tsum-=now;s-=now;\n\t\t}else r=min(r,pos[i]);\n\t}return sum==0;\n}\nsigned main(){\n\tscanf(\"%lld\",&tst);\n\twhile(tst--){\n\t\tscanf(\"%lld\",&n);\n\t\tfor(int i=1;i<=n;i++)scanf(\"%lld\",&a[i]),pos[a[i]]=i;\n\t\tT.clear();int inv=0;\n\t\tfor(int i=n;i;i--)inv+=T.query(a[i]),T.update(a[i],1);\n\t\tif(check(inv,inv)||check(inv,inv-1))puts(\"Yes\");\n\t\telse puts(\"No\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1668266385,
        "uid": 65681,
        "name": "UltiMadow",
        "ccfLevel": 7,
        "title": "[\u9898\u89e3] AGC058E"
    }
]
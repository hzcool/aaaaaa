[
    {
        "content": "[\u6211\u7684\u535a\u5ba2](https://www.cnblogs.com/Memory-of-winter/p/10398167.html)\n\n**\u9898\u76ee\u5927\u610f\uff1a**\u7ed9\u4f60$n,k(n\\leqslant10^9,k\\leqslant10^3)$\uff0c\u6c42$f_n$\u3002$f$\u6570\u7ec4\u6ee1\u8db3$f_1=f_2=\\cdots=f_k=1$\uff0c$f_n=\\sum\\limits_{i=n-k}^{n-1}f_i$\n\n**\u9898\u89e3\uff1a**\u7ebf\u6027\u9f50\u6b21\u9012\u63a8\uff1a\n$$\\left[\\begin{matrix}f_1&f_2&\\cdots&f_k\\end{matrix}\\right]\\left[\\begin{matrix}0&0&0&\\cdots&0&1\\\\1&0&0&\\cdots&0&1\\\\0&1&0&\\cdots&0&1\\\\0&0&1&\\cdots&0&1\\\\\\vdots&\\vdots&\\ddots&\\ddots&\\vdots&\\vdots\\\\0&0&0&\\cdots&1&1\\end{matrix}\\right]=\\left[\\begin{matrix}f_2&f_3&\\cdots&f_{k+1}\\end{matrix}\\right]$$\n\u7279\u5f81\u591a\u9879\u5f0f$G_k(x)$\u4e3a\uff1a\n$$\\begin{aligned}G_k(x)&=|\\lambda I-A|\\\\&=\\left|\\left[\\begin{matrix}\\lambda&0&0&\\cdots&0&-1\\\\-1&\\lambda&0&\\cdots&0&-1\\\\0&-1&\\lambda&\\cdots&0&-1\\\\0&0&-1&\\cdots&0&-1\\\\\\vdots&\\vdots&\\ddots&\\ddots&\\vdots&\\vdots\\\\0&0&0&\\cdots&-1&\\lambda-1\\end{matrix}\\right]\\right|\\end{aligned}$$\n\u53ef\u4ee5\u5bf9\u7b2c\u4e00\u884c\u5c55\u5f00\n$$\\begin{aligned}G_k(x)&=(-1)^{1+1}\\lambda G_{k-1}(x)+(-1)(-1)^{k-1}(-1)^{k+1}\\\\&=\\lambda G_{k-1}(x)-1\\\\&=\\lambda^k-\\lambda^{k-1}-\\lambda^{k-2}-\\cdots-1\\end{aligned}$$\n\u53d1\u73b0\u6a21\u6570\u662f$10^9+7$\uff0c\u4f46\u662f$k$\u53ea\u6709$10^3$\uff0c\u6240\u4ee5\u76f4\u63a5$O(k^2)$\u5377\u79ef\u548c\u53d6\u6a21\uff0c\u603b\u590d\u6742\u5ea6$O(k^2\\log_2n)$\n\n\n\n**C++ Code\uff1a**\n\n```cpp\n#include <algorithm>\n#include <cstdio>\n#include <cstring>\n#define maxn 2010\nconst int mod = 1e9 + 7;\n\n#define mul(x, y) static_cast<long long> (x) * (y) % mod\ninline void reduce(int &x) { x += x >> 31 & mod; }\n\nint n, K;\nint f[maxn], g[maxn];\n\nvoid PW(int n) {\n\tif (n == 0) { f[0] = 1; return ; }\n\tPW(n >> 1);\n\tstd::memset(g, 0, K << 3);\n\tfor (int i = 0; i < K; ++i)\n\t\tfor (int j = 0; j < K; ++j)\n\t\t\treduce(g[i + j + (n & 1)] += mul(f[i], f[j]) - mod);\n\tfor (int i = K + K - 1 + (n & 1); i >= K; --i) {\n\t\tfor (int j = 1; j <= K; ++j) reduce(g[i - j] += g[i] - mod);\n\t}\n\tstd::memcpy(f, g, K << 2);\n}\n\nint main() {\n\tscanf(\"%d%d\", &K, &n);\n\tPW(n - 1);\n\tint ans = 0;\n\tfor (int i = 0; i < K; ++i) reduce(ans += f[i] - mod);\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1550498264,
        "uid": 22072,
        "name": "Memory_of_winter",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT697 \u3010\u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u3011"
    }
]
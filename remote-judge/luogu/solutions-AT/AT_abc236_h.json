[
    {
        "content": "\u8fd9\u662f\u4e00\u4e2a\u7206\u6807\u505a\u6cd5\u3002\n\n\u76f4\u63a5\u8ba1\u6570\u5f88\u96be\u8003\u8651\u5230 $A_i$ \u4e92\u4e0d\u76f8\u540c\u7684\u9650\u5236\uff0c\u8003\u8651\u5bb9\u65a5\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u5bb9\u65a5\u6a21\u578b\uff0c\u5373\u96c6\u5408\u5212\u5206\u5bb9\u65a5\u3002\n\n\u8003\u8651\u5c06\u539f\u5e8f\u5217\u5212\u5206\u6210\u82e5\u5e72\u96c6\u5408\uff0c\u6bcf\u4e2a\u96c6\u5408\u5185\u7684\u6570\u5f3a\u5236\u76f8\u7b49\uff0c\u7136\u540e\u4e00\u4e2a\u96c6\u5408\u5185\u7684\u5bb9\u65a5\u7cfb\u6570\u5c31\u662f $(-1)^{|S|-1}(|S|-1)!$\uff0c\u8bc1\u660e\u53ef\u4ee5\u8003\u8651\u679a\u4e3e\u5706\u6392\u5217\uff0c\u7136\u540e\u7528\u4e0b\u65af\u7279\u6797\u6570\u76f8\u5173\u7ed3\u8bba\u5c31\u5f97\u8bc1\u4e86\u3002\n\n\u7136\u540e\u5c31\u662f\u8981\u8ba1\u7b97\u5bf9\u4e8e\u53ef\u80fd\u7684\u96c6\u5408\u4e2a\u6570\uff0c\u5176\u5e26\u4e0a\u5bb9\u65a5\u7cfb\u6570\u7684\u65b9\u6848\u6570\u4e4b\u548c\u3002\n\n\u4e0d\u59a8\u8bbe\u4e00\u4e2a\u96c6\u5408\u7684\u96c6\u5408\u5e42\u7ea7\u6570\u662f $F$\uff0c\u90a3\u4e48\u5c31\u662f\u8981\u6c42 $\\exp F$\u3002\n\n$F$ \u7684\u8ba1\u7b97\u663e\u7136\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e2a\u96c6\u5408\uff0c\u7136\u540e\u6c42\u51fa $\\text{lcm}$\u3002\n\n\u53ef\u4ee5\u7528\u9664\u6cd5\u89c4\u907f\u7206 long long \u7684\u95ee\u9898\u3002\n\n\u590d\u6742\u5ea6\u662f $O(n^22^n+2^n\\log V)$ \u7684\u3002",
        "postTime": 1677545923,
        "uid": 127747,
        "name": "\u51b0\u96fe",
        "ccfLevel": 7,
        "title": "ABC236Ex"
    },
    {
        "content": "\u8003\u8651\u5efa\u51fa $n$ \u70b9\u7684\u56fe\uff0c\u82e5 $a_i=a_j$ \u5219\u8fde\u65e0\u5411\u8fb9 $(i,j)$\u3002\u90a3\u4e48\u4e92\u4e0d\u76f8\u540c\u76f8\u5f53\u4e8e\u56fe\u4e2d\u4e00\u6761\u8fb9\u90fd\u4e0d\u80fd\u8fde\u3002\u8bbe $C(E)\\subseteq 2^V$ \u4e3a\u8fde\u4e0a\u8fb9\u96c6 $E$ \u540e\u7684\u8fde\u901a\u5757\u96c6\u5408\uff0c$F(P)$ \u8868\u793a\u8fde\u901a\u5757\u5f62\u6001\u4e3a $P$ \u65f6\u7684\u7b54\u6848\uff08$P\\subseteq 2^V$\uff09\uff0c\u5219\u7b54\u6848\u4e3a\n\n$$\n\\sum_{E}(-1)^{|E|}F(C(E))=\\sum_{P}F(P)\\sum_{C(E)=P}(-1)^{|E|}\n$$\n\n\u4e0d\u96be\u53d1\u73b0\u91cd\u70b9\u5728\u8ba1\u7b97\u540e\u9762\u90a3\u4e00\u9879\u3002\u663e\u7136\u5404\u4e2a\u8fde\u901a\u5757\u72ec\u7acb\uff0c\u53ea\u9700\u8981\u5bf9\u6bcf\u4e2a\u8fde\u901a\u5757 $S\\in P$\uff0c\u6c42\u51fa\u6240\u6709\u4f7f $S$ \u4ee5\u5185\u70b9\u96c6\u8054\u901a\u7684\u8fb9\u96c6 $E$ \u7684 $(-1)^{|E|}$ \u4e4b\u548c\u3002\u8bbe $f_k$ \u8868\u793a $k$ \u4e2a\u70b9\u7684\u65b9\u6848\u6570\uff0c\u53d1\u73b0\u6ca1\u6709\u8054\u901a\u9650\u5236\u7684\u65f6\u5019\u7b54\u6848\u662f $[k=1]$\uff0c\u5373 $(\\exp f)_k=[k=1]$\uff0c\u53d6 $\\ln$ \u5f97\u5230 $f_k=(-1)^{k-1}(k-1)!$\uff0c\u56e0\u6b64\n\n$$\nANS=\\sum_{P}F(P)\\prod_{S\\in P}(-1)^{|S|-1}(|S|-1)!$$\n\n>\u5177\u4f53\u6765\u8bf4\uff0c\u8003\u8651\u600e\u4e48\u7b97 $f$\uff1a\u8f83\u597d\u7406\u89e3\u7684\u65b9\u5f0f\u662f\u91c7\u7528\u5bb9\u65a5\uff0c\u7528\u968f\u610f\u8fde\u7684\u8d21\u732e\u548c\u51cf\u53bb\u4e0d\u8fde\u901a\u7684\u8d21\u732e\u548c\u3002\u4e0d\u8fde\u901a\u65f6\u7ef4\u62a4 $1$ \u6240\u5728\u8fde\u901a\u5757\uff0c\u6709\n>$$\nf_i=-\\sum_{j=1}^{i-1}\\binom{i-1}{j-1}f_j[i-j=1]=-(i-1)f_{i-1}\n$$\n>\u518d\u7ed3\u5408 $f_1=1$\uff0c\u81ea\u7136\u6709 $f_k=(k-1)!(-1)^{k-1}$\u3002\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u53d1\u73b0\u4e0a\u8ff0\u8fc7\u7a0b\u5c31\u662f\u505a\u4e86\u4e00\u6b21 $\\ln$\u3002\n\n\u672c\u9898\u4e2d $F(P)=\\prod_{S\\in P}\\lfloor\\frac{M}{\\text{lcm}(S)}\\rfloor$ \u5bb9\u6613\u8ba1\u7b97\uff0c\u5176\u4e2d $\\text{lcm}(S)$ \u8868\u793a $S$ \u4ee5\u5185\u6240\u6709\u5143\u7d20\u7684 $\\text{lcm}$\u3002\u5b50\u96c6\u5377\u79ef\u4f18\u5316 exp \u5373\u53ef\u505a\u5230 $O((n^2+\\log M)2^n)$\u3002\n\n\u5077\u61d2\u5199\u7684 $O(3^n+2^n\\log M)$ \u4ee3\u7801\uff1a[Link](https://atcoder.jp/contests/abc236/submissions/39927152)",
        "postTime": 1679400517,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "ABC236Ex"
    },
    {
        "content": "\u611f\u89c9\u603b\u7b97\u7565\u61c2\u4e00\u70b9\u5bb9\u65a5\u4e86\u2026\u2026\n\n\u6625\u8d5b\u524d\u795e\u4ed9\u66fe\u7ecf\u6559\u8fc7\u6211\u600e\u4e48\u731c\u5bb9\u65a5\u7cfb\u6570\uff0c\u5f53\u65f6\u5e94\u8be5\u662f\u80e1\u4e86\u4e00\u4e2a\u751f\u6210\u51fd\u6570\u7684\u8bc1\u660e\u3002\u505a\u4e86 GDKOI D1T3 \u4ee5\u540e\u6765\u7a0d\u5fae\u5199\u4e00\u5199\u600e\u4e48\u987a\u7406\u6210\u7ae0\u7684\u63a8\u51fa\u6765\u8fd9\u4e2a\u7cfb\u6570\u3002\n\n\u9996\u5148\u6211\u4eec\u5c06\u6240\u6709\u7684\u6570\u4e92\u4e0d\u76f8\u540c\u8fd9\u4e00\u6761\u4ef6\u770b\u6210 $m=\\frac{n(n-1)}{2}$ \u4e2a\u65e0\u5e8f\u70b9\u5bf9 $(x_i,y_i)$\uff0c\u6bcf\u4e00\u4e2a\u70b9\u5bf9\u4ee3\u8868\u4e00\u4e2a\u9650\u5236\uff0c\u5373 $A_{x_i}\\neq A_{y_i}$\u3002\u663e\u7136\u6ee1\u8db3\u6240\u6709\u7684\u9650\u5236\u7684\u65b9\u6848\u6570\u5373\u4e3a\u7b54\u6848\u3002\n\n\u5bb9\u65a5\uff0c\u4ee4 $f(S)$ \u4e3a\u94a6\u5b9a\u96c6\u5408 $S$ \u5185\u7684\u9650\u5236\u5168\u90e8**\u4e0d\u6ee1\u8db3**\u7684\u65b9\u6848\u6570\uff08\u8fd9\u6837\u4e00\u6765\u96c6\u5408\u5c31\u88ab\u5206\u6210\u4e86\u4e00\u4e9b\u90e8\u5206\uff0c\u90e8\u5206\u4e0e\u90e8\u5206\u95f4\u65e0\u5173\uff0c\u800c\u6bcf\u4e2a\u90e8\u5206\u5185\u90e8\u9700\u5168\u90e8\u76f8\u7b49\uff09\uff0c\u5219\u7b54\u6848\u4e3a $\\sum_{S}(-1)^{|S|}f(S)$\u3002\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a $O(2^m)$ \u7684\u66b4\u529b\u3002\n\n\u8003\u8651\u4f18\u5316\u8fd9\u4e2a\u5bb9\u65a5\u3002\u6ce8\u610f\u5230\u5982\u679c\u5c06 $(x_i,y_i)$ \u770b\u4f5c\u4e00\u6761\u8fb9\uff0c$f(S)$ \u5176\u5b9e\u53ea\u4e0e $S$ \u5c06\u6240\u6709\u70b9\u5212\u5206\u6210\u600e\u6837\u7684\u51e0\u4e2a\u8fde\u901a\u5757\u6709\u5173\u3002\u6211\u4eec\u4e0d\u59a8\u6765\u770b\u4e00\u770b\u5bf9\u4e8e\u67d0\u79cd\u96c6\u5408\u5212\u5206\uff0c\u5176\u5bf9\u4e8e\u5bb9\u65a5\u8fc7\u7a0b\u7684\u8d21\u732e\uff08\u5c31\u662f\u5728\u5bb9\u65a5\u4e2d\u88ab\u7b97\u5230\u7684\u5bb9\u65a5\u7cfb\u6570\u4e4b\u548c\uff09\u662f\u591a\u5c11\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u5bf9\u4e8e\u70b9\u7684\u5168\u96c6 $U$ \u7684\u4e00\u79cd\u5212\u5206 $U=\\{s_1,s_2,\u2026,s_k\\}$ \u4e2d\u7684\u4e00\u4e2a\u5c0f\u96c6\u5408 $s_i$ \u800c\u8a00\uff0c\u5176\u8d21\u732e\u4e3a\uff1a**\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6070\u597d\u5305\u542b $s_i$ \u5185\u6240\u6709\u70b9\u7684\u8fde\u901a\u5b50\u56fe\uff0c\u8bbe\u5176\u5305\u542b $e$ \u6761\u8fb9\uff0c\u5b9a\u4e49\u5176\u6743\u503c\u4e3a $(-1)^e$**\u3002$s_i$ \u7684\u8d21\u732e\u5c31\u662f\u8fd9\u4e9b\u5b50\u56fe\u7684\u6743\u503c\u4e4b\u548c\uff08\u7531\u4f20\u7edf\u5bb9\u65a5\u7684\u5f0f\u5b50\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\uff09\uff0c\u800c\u5212\u5206\u7684\u8d21\u732e\u5219\u4e3a $s_1,s_2,\u2026,s_k$ \u7684\u8d21\u732e\u4e4b\u79ef\uff08\u5c0f\u96c6\u5408\u95f4\u76f8\u4e92\u72ec\u7acb\uff09\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5173\u952e\u7684\u95ee\u9898\u8fd8\u662f\u5728\u4e8e\u4e00\u4e2a\u96c6\u5408 $s_i$ \u7684\u8d21\u732e\u662f\u4ec0\u4e48\u3002\u4e00\u4e2a\u5f88\u5173\u952e\u7684\u4e8b\u60c5\uff0c\u662f\u9898\u76ee\u4e2d\u6240\u7ed9\u51fa\u7684\u5176\u5b9e\u662f\u4e00\u4e2a\u5b8c\u5168\u56fe\uff0c\u56e0\u6b64\u70b9\u96c6 $s_i$ \u7684\u8d21\u732e\u53ea\u4e0e $|s_i|$ \u6709\u5173\uff08\u5927\u5c0f\u76f8\u540c\u5219\u540c\u6784\uff09\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651 dp \u6765\u8ba1\u7b97\u7cfb\u6570\u3002\u4ee4 $coef_i$ \u8868\u793a\u5927\u5c0f\u4e3a $i$ \u7684\u96c6\u5408\u7684\u8d21\u732e\u3002\u8fde\u901a\u5b50\u56fe\u8fd9\u4e2a\u9650\u5236\u5f88\u68d8\u624b\uff0c\u8003\u8651\u6b63\u96be\u5219\u53cd\uff0c\u5148\u7b97\u6240\u6709\u5b50\u56fe\u7684\u6743\u503c\u4e4b\u548c\u3002\u8fd9\u662f\u4e00\u4e2a\u5f88\u7ecf\u5178\u7684\u4e8c\u9879\u5f0f\u5b9a\u7406\u7684\u5f62\u5f0f\uff0c\u5176\u7b54\u6848\u4e3a $[i=1]$\u3002\u63a5\u7740\u7b97\u4e0d\u8fde\u901a\u7684\u60c5\u51b5\uff0c\u679a\u4e3e\u6700\u540e\u4e00\u4e2a\u70b9\u6240\u5728\u96c6\u5408\u7684\u5927\u5c0f\uff0c\u6709\u7b54\u6848\u4e3a $\\sum_{j=1}^{i-1}\\binom{i-1}{j-1}coef_j[i-j=1]=(i-1)coef_{i-1}$\u3002\u7528\u603b\u60c5\u51b5\u6570\u51cf\u53bb\u4e0d\u5408\u6cd5\u6570\u91cf\uff0c\u5c31\u6709 $coef_i=[i=1]-(i-1)coef_{i-1},coef_1=1$\u3002\u663e\u7136\u53ef\u4ee5\u5f97\u5230 $coef_{i}=(-1)^{i-1}(i-1)!$\u3002\u8fd9\u4e5f\u5c31\u662f\u4e00\u4e9b\u9898\u89e3\u4e2d\u6240\u63d0\u5230\u7684\u5bb9\u65a5\u7cfb\u6570\u3002\n\n\u56de\u5230\u9898\u76ee\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5bf9\u6bcf\u4e00\u4e2a\u96c6\u5408\u5212\u5206\u7b97\u51fa\u5bf9\u5e94\u7684\u5bb9\u65a5\u7cfb\u6570\u4e0e\u65b9\u6848\u6570\u5e76\u6c42\u548c\u3002\u5bf9\u4e8e\u8fd9\u79cd\u5212\u5206\u7684\u5f62\u5f0f\uff0c\u5f88\u5bb9\u6613\u60f3\u5230 dp\uff0c\u4e8e\u662f\u540e\u9762\u7684\u90e8\u5206\u90fd\u662f\u4e00\u4e9b\u5e73\u51e1\u7684\u6280\u5de7\u3002\u65e0\u8bba\u662f\u66b4\u529b dp \u8fd8\u662f\u4f7f\u7528\u96c6\u5408\u5e42\u7ea7\u6570\u6280\u5de7\u90fd\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u7bc7\u9898\u89e3\u82b1\u8d39\u4e86\u5f88\u957f\u7684\u65f6\u95f4\u4f5c\u4e86\u5f88\u591a\u6709\u4e9b\u7b28\u91cd\u7684\u63a8\u5bfc\uff0c\u6700\u540e\u5f97\u5230\u4e86\u4e00\u4e2a\u7b80\u5355\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5 \u770b\u51fa\u6765/\u731c\u51fa\u6765 \u7684\u7ed3\u8bba\u3002\u4f46\u662f\u4e0d\u8981\u5c0f\u77a7\u8fd9\u6837\u7684\u63a8\u5bfc\uff0c\u5f53\u9898\u76ee\u4e0d\u5177\u6709\u5b8c\u5168\u56fe\u8fd9\u6837\u7684\u6027\u8d28\u65f6\uff0c\u53ea\u9700\u5c06\u6211\u4eec\u7684\u5bb9\u65a5\u7cfb\u6570 dp \u4ece\u5173\u4e8e\u96c6\u5408\u5927\u5c0f\u6539\u6210\u96c6\u5408\u672c\u8eab\uff0c\u4f9d\u65e7\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u3002\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 GDKOI2023 D1T3\u3002",
        "postTime": 1678969877,
        "uid": 314991,
        "name": "zhouyuhang",
        "ccfLevel": 7,
        "title": "\u521d\u6b65\u7406\u89e3\u5bb9\u65a5"
    },
    {
        "content": "~~\u518d\u6b21\u611f\u8c22 Daniel_lele \u6307\u5bfc~~ \u8fd9\u91cc\u662f\u4e00\u79cd\u5927\u529b\u5bb9\u65a5\u7684\u89e3\u6cd5\u3002\n\n\u8003\u8651 dp\u3002\u8bbe $dp_S$ \u4e3a\u96c6\u5408 $S$ \u4e2d\u7684\u7b54\u6848\uff0c\u5219\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$dp_{S\\cup d_i}=\\left\\lfloor\\dfrac m{d_i}\\right\\rfloor dp_S$$\n\n\u7136\u800c\u8fd9\u4e2a\u5f0f\u5b50\u662f\u9519\u7684\uff0c\u56e0\u4e3a\u4f1a\u7b97\u8fdb $a_i$ \u4e0e $S$ \u4e2d\u4efb\u610f\u4e00\u4e2a\u5143\u7d20\u76f8\u540c\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u8981\u51cf\u53bb\u3002\u90a3\u4e48\u5c31\u53d8\u6210\u4e86\u8fd9\u6837\uff1a\n\n$$dp_{S\\cup d_i}=\\left\\lfloor\\dfrac m{d_i}\\right\\rfloor dp_S-\\sum_{d_j\\in S,i\\not=j}\\left\\lfloor\\dfrac m{\\text{lcm}(d_i,d_j)}\\right\\rfloor dp_{S/d_i,d_j}$$\n\n\u5199\u51fa\u6765\u8fd9\u73a9\u610f\u5c31\u53ef\u4ee5\u8fc7\u6837\u4f8b $1,3$ \u4e86\uff0c\u4f46\u4ea4\u4e0a\u53bb\u540e\u60e8\u4e0d\u5fcd\u7779\u3002\u4e3a\u5565\u5462\uff1f\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/relqdm4z.png)\n\n\u90a3\u4e48\u8fd8\u8981\u5957\u4e00\u5c42\u5bb9\u65a5\u628a\u8fd9\u4e2a\u52a0\u56de\u6765\u3002\u521a\u5f00\u59cb\u6211\u7b97\u7684\u5bb9\u65a5\u7cfb\u6570\u662f $|T|$\uff0c\u56e0\u4e3a\u6bcf\u6b21\u5bb9\u65a5\u7684\u6700\u540e\u4e00\u4f4d\u90fd\u4f1a\u88ab\u524d\u9762\u52a0\u4e0a $|T|$\uff0c\u6240\u4ee5\u8981\u6d88\u6389\u3002\u4f46\u4ea4\u4e0a\u53bb\u4e5f\u83b7\u5f97\u4e86\u5f88\u4f18\u79c0\u7684\u6210\u7ee9\u2026\u2026\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/61tp2opv.png)\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5f53 $|S|-|T|>1$ \u65f6\uff0c\u7531\u4e8e\u5269\u4e0b\u51e0\u4e2a\u5143\u7d20\u90fd\u662f\u5408\u6cd5\u89e3\uff0c\u4e5f\u5c31\u662f\u6ee1\u8db3\u4e0d\u76f8\u7b49\u5173\u7cfb\uff0c\u5bfc\u81f4\u9519\u89e3\u4e0d\u4f1a\u88ab\u8ba1\u7b97\u3002\u6240\u4ee5\u4f1a\u5bf9\u8fd9\u79cd\u60c5\u51b5\u4ea7\u751f\u8d21\u732e\u7684\u53ea\u6709 $|S|-|T|\\le1$ \u7684\u60c5\u51b5\u3002\u8bbe $f(|S|)$ \u4e3a\u96c6\u5408 $S$ \u5bf9\u5e94\u7684\u5bb9\u65a5\u7cfb\u6570\uff0c\u5219\u6ee1\u8db3\u9012\u63a8\u5173\u7cfb $f(1)=-1,f(n)=-f(n-1)\\times\\binom n{n-1}=-nf(n-1)$\uff0c\u5373 $f(n)=(-1)^nn!$\u3002\n\n\u90a3\u4e48\u7cfb\u6570\u6709\u4e86\u5c31\u53ef\u4ee5\u5f00\u59cb\u5927\u529b\u5bb9\u65a5\u4e86\u3002\u4e0d\u8fc7\u51c9\u5fc3\u51fa\u9898\u4eba\u5361\u4e86 $O(3^nn\\log m)$ \u7b97\u6cd5\uff0c\u8981\u518d\u9884\u5904\u7406\u4e00\u5c42 $\\text{lcm}$\uff0c\u590d\u6742\u5ea6\u4e3a $O(3^n+2^n\\log m)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n# AC \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int mod = 998244353;\n\ninline \nll gcd(ll a, ll b) {\n\treturn b ? gcd(b, a % b) : a;\n}\n\ninline \nll lcm(ll a, ll b) {\n\treturn a / gcd(a, b) * b;\n}\n\nint n, x, c[1 << 16];\n\nll m, a[16], f[17], l[1 << 16], dp[1 << 16];\n\nint main() {\n\tscanf(\"%d%lld\", &n, &m), *dp = *l = *f = 1;\n\tfor (int i = 0; i < n; i++) scanf(\"%lld\", &a[i]);\n\tfor (int i = 1; i <= n; i++) f[i] = f[i - 1] * i % mod;\n\tfor (int s = 1, k, i; s < 1 << n; s++) {\n\t\ti = __lg(s & -s), k = s & -s ^ s, c[s] = c[k] + 1;\n\t\tdp[s] = (dp[s] + dp[k] * (m / a[i] % mod) % mod) % mod;\n\t\tl[s] = !l[k] || a[i] / gcd(a[i], l[k]) > m / l[k] ? 0 : lcm(a[i], l[k]);\n\t\tfor (int t = k; t; t = t - 1 & k) {\n\t\t\tif (!l[t | 1 << i]) continue;\n\t\t\tif (c[t] & 1) dp[s] = (dp[s] - dp[k ^ t] * (m / l[t | 1 << i] % mod) % mod * f[c[t]] % mod + mod) % mod;\n\t\t\telse dp[s] = (dp[s] + dp[k ^ t] * (m / l[t | 1 << i] % mod) % mod * f[c[t]] % mod) % mod;\n\t\t}\n\t}\n\tprintf(\"%lld\", dp[(1 << n) - 1]);\n}\n```\n\nzxx \u597d\u95ea\uff0c\u62dc\u8c22 zxx\uff01",
        "postTime": 1672908869,
        "uid": 406941,
        "name": "Register_int",
        "ccfLevel": 6,
        "title": "ABC236H \u9898\u89e3"
    },
    {
        "content": "> [[ABC 236Ex] Distinct Multiples](https://atcoder.jp/contests/abc236/tasks/abc236_h) *600\n>\n> \u7ed9\u5b9a\u4e24\u4e2a\u6b63\u6574\u6570 $N,M$ \u548c\u4e00\u4e2a\u6b63\u6574\u6570\u5e8f\u5217 $D$\uff0c\u8be2\u95ee\u6ee1\u8db3\u6761\u4ef6\u7684\u5e8f\u5217 $A$ \u7684\u4e2a\u6570\uff1a\n>\n> 1. $1\\leq A_i\\leq M(1\\leq i\\leq N)$\n> 2. $A_i\\neq A_j(1\\leq i<j\\leq N)$\n> 3. $D_i|A_i$\n>\n> - $2\\leq N\\leq 16,1\\leq M\\leq 10^{18},1\\leq D_i\\leq M$\n\n\u663e\u7136\u8981\u5bb9\u65a5\uff0c\u8865\u96c6\u7684\u6761\u4ef6\u5c31\u662f\u94a6\u5b9a\u67d0\u4e9b\u6570\u5b57\u90fd\u76f8\u7b49\u3002\u8fd9\u4e2a\u4e1c\u897f\u4e0d\u597d\u505a\uff0c\u4e0d\u59a8\u628a\u8fd9\u4e2a\u4e1c\u897f\u653e\u5728\u56fe\u4e0a\u8003\u8651\u3002\n\n\u5bf9\u4e8e\u4e24\u4e2a\u6570 $i,j$\uff0c\u5982\u679c $a_i=a_j$\uff0c\u90a3\u4e48\u5728 $(i,j)$ \u4e4b\u95f4\u5efa\u8fb9\u3002\u90a3\u4e48\u6bcf\u4e00\u4e2a\u8fb9\u96c6 $S\\in E$\uff0c\u8bbe $f(S)$ \u8868\u793a\u5df2\u7ecf\u94a6\u5b9a\u4e86\u4e00\u5b9a\u9009\u62e9 $S$ \u4e2d\u7684\u8fb9\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u56fe\u7684\u603b\u6570\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f\uff1a\n$$\n\\sum_{S\\in E} (-1)^{|S|}f(S)\n$$\n\u6ce8\u610f $S$ \u53ef\u4ee5\u4e3a\u7a7a\u3002\n\n\u4f46\u662f\u8fb9\u6570\u662f $O(n^2)$ \u7684\uff0c\u8fd8\u662f\u5f97\u8003\u8651\u653e\u5728\u70b9\u4e0a\u3002\u6ce8\u610f\u5230\u4e00\u4e2a\u8fde\u901a\u5757\u7684\u5f88\u591a\u79cd\u8054\u901a\u65b9\u5f0f\u5b9e\u9645\u4e0a\u6700\u540e\u7684\u503c\u662f\u76f8\u540c\u7684\u3002\n\n\u8bbe $dp_{S}$ \u8868\u793a\u70b9\u96c6\u4e3a $S$ \u7684\u5305\u542b\u7684\u6240\u6709\u8fb9 $E$ \u7684 $\\sum_{E\\in S} (-1)^{|E|}f(E)$\uff0c\u90a3\u4e48\u5c31\u662f\u8981\u6c42 $dp_{\\{1,\\cdots ,n\\}}$\u3002\u8003\u8651\u901a\u8fc7\u627e\u7279\u6b8a\u70b9\u8ba1\u6570\u3002\u4e0d\u59a8\u5c31\u679a\u4e3e\u5b50\u96c6\u4e2d $u$ \u6240\u5728\u7684\u8054\u901a\u5757\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u8fde\u901a\u5757\uff0c\u4ef7\u503c\u5df2\u7ecf\u786e\u5b9a\u4e86\uff0c\u5047\u8bbe\u662f $g(T)$\uff0c\u90a3\u4e48\u8fd8\u9700\u8981\u7684\u5c31\u662f\u5bb9\u65a5\u7cfb\u6570\u7684\u548c\uff0c\u5047\u8bbe\u662f $h(|T|)$\uff0c\u90a3\u4e48\u81ea\u7136\u6709\u8f6c\u79fb\uff1a\n$$\ndp_S=\\sum_{T\\in S,u\\in T} g(T)h(|T|)dp_{S-T}\\\\\ndp_{0}=1\\\\\n$$\n $g(T)$ \u663e\u7136\u4e3a $\\frac{M}{\\operatorname{lcm_{u\\in T}}d_u}$\uff0c$h(i)$ \u4ecd\u7136\u8003\u8651\u7279\u6b8a\u70b9\u8ba1\u6570\u3002\n\n\u9996\u5148 $h(1)=1$\u3002\u5fc5\u987b\u8054\u901a\u8fd9\u4e2a\u6027\u8d28\u4e0d\u597d\u505a\uff0c\u5982\u679c\u4e0d\u8981\u6c42\u8054\u901a\u7684\u8bdd\uff0c\u90a3\u4e48\u5bb9\u65a5\u7cfb\u6570\u603b\u548c\u4e00\u5b9a\u662f 0\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u63a8\u4e00\u4e0b\u7ec4\u5408\u6570\u5f97\u5230\u3002\u90a3\u4e48\u8003\u8651\u6c42\u4e0d\u8054\u901a\u7684\u5bb9\u65a5\u7cfb\u6570\u603b\u548c\u3002\n\n\u5bf9\u4e8e $h(i)$\uff0c\u5047\u8bbe $u$ \u6240\u5728\u7684\u8fde\u901a\u5757\u5927\u5c0f\u4e3a $j$\uff0c\u5047\u8bbe $j\\leq n-2$\uff0c\u4e5f\u5c31\u662f\u5269\u4e0b\u7684\u90e8\u5206\u7684\u70b9\u6570 $\\geq 2$\uff0c\u56e0\u4e3a\u5269\u4e0b\u7684\u90e8\u5206\u7684\u70b9\u4e0d\u8981\u6c42\u8054\u901a\u6216\u8005\u4e0d\u8fde\u901a\uff0c\u6240\u4ee5\u5bb9\u65a5\u7cfb\u6570\u603b\u548c\u4e3a 0\uff0c\u6240\u4ee5\u4e58\u8d77\u6765\u4ecd\u7136\u662f 0\uff0c\u6240\u4ee5\u53ef\u4ee5\u5ffd\u7565\u8fd9\u4e2a\u90e8\u5206\u3002\n\n\u90a3\u4e48\u5c31\u662f\u8981\u8003\u8651\u5f53 $j=n-1$ \u65f6\u7684\u5bb9\u65a5\u7cfb\u6570\u603b\u548c\uff0c\u90a3\u4e48\u679a\u4e3e\u5b64\u7acb\u70b9\uff0c\u5269\u4e0b\u7684\u662f\u4e00\u4e2a\u5b50\u95ee\u9898\uff0c\u4e5f\u5c31\u662f $h(i)=-(n-1)h_{i-1}$\u3002\u90a3\u4e48 $h(i)=(-1)^{i-1}(i-1)!$\u3002\n\n\u90a3\u4e48\u8fd9\u4e2a\u9898\u76ee\u5c31\u505a\u5b8c\u4e86\uff0c\u603b\u7684\u590d\u6742\u5ea6\u5728\u4e8e\u6700\u540e\u7684\u679a\u4e3e\u5b50\u96c6\u7684 $O(3^n)$\u3002",
        "postTime": 1666748969,
        "uid": 295534,
        "name": "kzos",
        "ccfLevel": 0,
        "title": "[ABC 236Ex] Distinct Multiples"
    }
]
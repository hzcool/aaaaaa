[
    {
        "content": "### \u9898\u610f\n\u7ed9\u51fa\u4e00\u4e2a $n$ \u4e2a\u70b9\u7684\u65e0\u5411\u56fe\uff0c\u70b9\u4ece $0$ \u5230 $n-1$ \u7f16\u53f7\u3002\u7ed9\u51fa $q$ \u7ec4\u8be2\u95ee\u6765\u52a0\u8fb9\uff0c\u6bcf\u6b21\u8be2\u95ee\u6709 $A_i,B_i,C_i$ \u4e09\u4e2a\u53c2\u6570\uff0c\u7136\u540e\u4f1a\u52a0\u5165\u5f62\u5982 $(A_i,B_i,C_i),(B_i,A_i+1,C_i+1),(A_i+1,B_i+1,C_i+2),(B_i+1,A_i+2,C_i+3),(A_i+2,B_i+2,C_i+4)\\cdot\\cdot\\cdot$ \u7684\u65e0\u9650\u6761\u65e0\u5411\u8fb9\uff0c\u8fd9\u91cc\u7684\u52a0\u6cd5\u662f\u5728\u6a21 $n$ \u610f\u4e49\u4e0b\u7684\u3002\u6c42\u51fa $q$ \u7ec4\u8be2\u95ee\u540e\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u8fb9\u6743\u548c\u3002($2\\le n\\le2\\times10^6,1\\le q\\le2\\times10^6,1\\le C_i\\le10^9$)\n\n### \u9898\u89e3\n\u8fd9\u9898\u9700\u8981\u753b\u5f88\u591a\u56fe\u3002\u9996\u5148\u6211\u4eec\u6765\u753b\u4e00\u4e0b\u6309\u7167\u9898\u76ee\u63cf\u8ff0\uff0c\u4e00\u7ec4\u8be2\u95ee $A,B,C$ \u4f1a\u52a0\u5165\u7684\u8fb9\uff08\u540e\u9762\u7684\u7701\u7565\uff09\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/un7xwzm2.png)\n\n\u800c\u6ce8\u610f\u5230\uff0c\u5982\u679c $(A+1,B,C+1)$ \u8fd9\u6761\u8fb9\u88ab\u52a0\u5165\u7684\u8bdd\uff0c$(A,B,C)$ \u4e5f\u4e00\u5b9a\u88ab\u8003\u8651\u8fc7\u4e86\uff0c\u4e0d\u7ba1\u52a0\u4e0a\u6ca1\u6709\uff0c$A,B$ \u4e00\u5b9a\u662f\u8fde\u901a\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a $(A+1,B,C+1)$ \u6539\u4e3a $(A+1,A,C+1)$ \u800c\u4e0d\u5f71\u54cd\u7ed3\u679c\uff0c\u5373\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/goikki83.png)\n\n\u7c7b\u4f3c\u5730\uff0c\u8003\u8651 $(A+1,B+1,C+2)$ \u65f6\uff0c$A+1,A,B$ \u4e00\u5b9a\u8fde\u901a\u4e86\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a $(A+1,B+1,C+2)$ \u6539\u4e3a $(B,B+1,C+2)$\uff0c\u5373\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dzv5atza.png)\n\n\u4e00\u76f4\u8fd9\u4e48\u6539\u4e0b\u53bb\uff0c\u6211\u4eec\u4f1a\u5f97\u5230\u8fd9\u6837\u4e00\u5f20\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rjalsv1b.png)\n\n\u6ce8\u610f\u5230\u8fd9\u5f20\u56fe\u7684\u7279\u70b9\u662f\uff1a$A,B$ \u4e4b\u95f4\u6709\u4e00\u6761\u6743\u503c\u4e3a $C$ \u7684\u8fb9\uff0c$A+i,A+i+1$ \u4e4b\u95f4\u6709\u4e00\u6761\u6743\u503c\u4e3a $C+1+2i$ \u7684\u8fb9\uff0c$B+i,B+i+1$ \u4e4b\u95f4\u6709\u4e00\u6761\u6743\u503c\u4e3a $C+2+2i$ \u7684\u8fb9\u3002\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u4e0b\u6587\u628a $A,B$ \u4e4b\u95f4\u7684\u8fb9\u53eb\u505a\u7ea2\u8fb9\uff0c\u5269\u4e0b\u7684\u8fb9\u53eb\u505a\u7eff\u8fb9\u3002\u5219\u52a0\u5165\u6240\u6709\u7684\u8be2\u95ee\u4e4b\u540e\uff0c\u539f\u56fe\u5e94\u8be5\u957f\u8fd9\u6837\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/i8qfojx4.png)\n\n\u5176\u4e2d\u52a0\u7c97\u7684\u7eff\u8fb9\u8868\u793a\u6709\u65e0\u9650\u6761\u8fb9\u3002\u5f53\u7136\uff0c\u56e0\u4e3a\u662f\u6700\u5c0f\u751f\u6210\u6811\uff0c\u5176\u5b9e\u6bcf\u4e24\u4e2a\u70b9\u4e4b\u95f4\u53ea\u6709\u4e00\u6761\u8fb9\u662f\u6709\u7528\u7684\uff0c\u4e5f\u5c31\u662f\u6743\u503c\u6700\u5c0f\u7684\u90a3\u6761\u3002\u6240\u4ee5\u6211\u4eec\u63a5\u4e0b\u6765\u7684\u4efb\u52a1\u5c31\u53d8\u4e3a\u4e86\u627e\u5230\u4e24\u70b9\u4e4b\u95f4\u8fb9\u6743\u503c\u7684\u6700\u5c0f\u503c\u3002\n\n\u53d1\u73b0\u7eff\u8fb9\u5176\u5b9e\u90fd\u662f\u7531\u4e00\u4e2a\u70b9 $S$ \u51fa\u53d1\uff0c\u4ee5 $x$ \u4e3a\u521d\u59cb\u6743\u503c\uff0c\u6bcf\u8fde\u63a5\u4e00\u7ec4\u70b9\u7ed9\u6743\u503c\u52a0 $2$ \u5f97\u5230\u7684\uff0c\u5f62\u5f0f\u5316\u8bb2\uff0c$S+i,S+i+1$ \u4e4b\u95f4\u7684\u6743\u503c\u4e3a $x+2i$\u3002\u6839\u636e\u8fd9\u4e2a\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u9012\u63a8\u8ba1\u7b97\u3002\u6211\u4eec\u8bbe $c_i$ \u8868\u793a\u8fde\u63a5 $i$ \u548c $i+1$ \u7684\u8fb9\u4e2d\u7684\u6700\u5c0f\u6743\u503c\uff0c\u521d\u59cb\u65f6\u5747\u4e3a\u65e0\u7a77\u5927\u3002\u5bf9\u4e8e\u6bcf\u7ec4 $(S,x)$\uff0c\u6211\u4eec\u66f4\u65b0\u4e00\u4e0b $c_S=\\min(c_S,x)$\u3002\u63a5\u7740\u8003\u8651\u8fde\u4e0b\u53bb\u7684\u8fb9\uff0c\u5219\u6709 $c_{i+1}=\\min(c_{i+1},c_{i}+2)(0\\le i<n)$\uff0c\u8fd9\u91cc\u7684\u52a0\u6cd5\u4f9d\u7136\u662f\u6a21 $n$ \u610f\u4e49\u4e0b\u3002\u6ce8\u610f\u8d21\u732e\u662f\u4e00\u4e2a\u73af\uff0c\u6240\u4ee5\u8fd9\u4e2a\u73a9\u610f\u8981\u66f4\u65b0\u4e24\u904d\u3002\u6700\u7ec8\u6211\u4eec\u5f97\u5230\u4e86 $n+q$ \u6761\u8fb9\uff0c\u76f4\u63a5\u7528 $\\rm kruskal$ \u8dd1\u6700\u77ed\u8def\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}((n+q)\\log (n+q))$\u3002\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nconst int N = 2e5 + 10; int cst[N], f[N], tp, tot;\nstruct edge\n{ \n    int u, v, w; \n    edge(int u = 0, int v = 0, int w = 0) : u(u), v(v), w(w) { }\n}E[N << 1]; long long ans;\nint getf(int x) { return x == f[x] ? x : f[x] = getf(f[x]); }\nint main()\n{\n    memset(cst, 0x7f, sizeof (cst)); int n, q; scanf(\"%d%d\", &n, &q); \n    for (int i = 1, A, B, C; i <= q; ++i) \n    {\n        scanf(\"%d%d%d\", &A, &B, &C); E[++tp] = edge(A, B, C);\n        cst[A] = std::min(cst[A], C + 1); cst[B] = std::min(cst[B], C + 2);\n    }\n    for (int i = 0; i < n; ++i) cst[(i + 1) % n] = std::min(cst[(i + 1) % n], cst[i] + 2);\n    for (int i = 0; i < n; ++i) cst[(i + 1) % n] = std::min(cst[(i + 1) % n], cst[i] + 2);\n    for (int i = 0; i < n; ++i) E[++tp] = edge(i, (i + 1) % n, cst[i]), f[i] = i;\n    std::sort(E + 1, E + tp + 1, [&](const edge& e1, const edge& e2) { return e1.w < e2.w; });\n    for (int i = 1, tx, ty; i <= tp; ++i)\n    {\n        tx = getf(E[i].u), ty = getf(E[i].v);\n        if (tx != ty) ans += E[i].w, f[tx] = ty, ++tot;\n        if (tot == n - 1) break;\n    }\n    printf(\"%lld\\n\", ans); return 0;\n}\n```",
        "postTime": 1635342119,
        "uid": 137603,
        "name": "zhiyangfan",
        "ccfLevel": 9,
        "title": "AT2134 Zigzag MST\u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9053\u9898\u662f\u65e0\u7a77\u6761\u8fb9\uff0c\u66b4\u529b Kruskal \u80af\u5b9a\u4e0d\u884c\u3002\n\n\u5982\u679c\u628a\u6bcf\u4e24\u70b9\u4e4b\u95f4\u7684\u8fb9\u90fd\u53d6\u4e2a min \u503c\uff0c$\\mathcal O(n^2)$ \u4e5f\u662f\u4e0d\u884c\u7684\u3002\u5982\u679c\u6211\u4eec\u80fd\u628a\u4e00\u4e9b\u6ca1\u7528\u7528\u7684\u8fb9\u53bb\u6389\u6216\u8005\u662f\u628a\u4e00\u4e9b\u8fb9\u6539\u4e00\u4e0b\u4e24\u7aef\u7684\u70b9\uff0c\u90a3\u4e48\u590d\u6742\u5ea6\u5c31\u964d\u4f4e\u4e86\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5f00\u59cb\u8003\u8651\u6539\u8fb9\u3002\u6839\u636e Kruskal\uff0c\u5982\u679c $x$ \u548c $y$ \u5df2\u7ecf\u8054\u901a\uff0c\u90a3\u4e48\u73b0\u5728\u6709\u4e00\u6761\u8fb9 $x$ \u548c $z$\uff0c\u53ef\u4ee5\u6539\u6210 $y$ \u548c $z$\u3002\n\n\u56e0\u4e3a $a_i$ \u548c $b_i$ \u5728 $a_i$ \u548c $b_i+1$ \u524d\u9762\u5df2\u7ecf\u51fa\u73b0\u8fc7\u4e86\uff0c\u6240\u4ee5 $a_i$ \u548c $b_i$ \u5df2\u8054\u901a\uff0c\u90a3\u4e48 $a_i$ \u548c $b_i+1$ \u5c31\u53ef\u4ee5\u6539\u6210 $b_i$ \u548c $b_i+1$ \u4e86\uff01\u6240\u4ee5\u8fd9\u53d8\u6210\u4e86\u4e00\u6761\u94fe\uff08$a_i$ \u548c $b_i$ \u8fd9\u6761\u8fb9\u9664\u5916\uff09\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u7528\u4e00\u4e2a\u524d\u7f00\u548c\u6765\u505a\uff08\u60f3\u4e00\u60f3\uff0c\u4e3a\u4ec0\u4e48\uff09\uff0c\u7136\u540e\u8dd1 Kru \u5c31\u53ef\u4ee5\u4e86\uff01\u590d\u6742\u5ea6\u662f $\\mathcal O(n+q)$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct apple\n{\n\tint x,y,z;\n\tapple(int x=0,int y=0,int z=0):x(x),y(y),z(z){}\n\tbool operator<(const apple &other)const\n\t{\n\t\treturn z<other.z;\n\t}\n}e[1000005];\nint h[400005],fa[200005];\nint findfather(int x){return x==fa[x]?x:fa[x]=findfather(fa[x]);}\nint main()\n{\n\tmemset(h,127,sizeof(h));\n\tint n,q,m=0;\n\tcin>>n>>q;\n\tfor(int i=0;i<n;i++)fa[i]=i;\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tint a,b,c;\n\t\tscanf(\"%d%d%d\",&a,&b,&c);\n\t\te[++m]=apple(a,b,c);\n\t\th[a+1]=min(h[a+1],c+1);\n\t\th[b+1]=min(h[b+1],c+2);\n\t}\n\tfor(int i=1;i<(n<<1);i++)h[i]=min(h[i],h[i-1]+2);\n\tfor(int i=1;i<(n<<1);i++)\n\t{\n\t\tint l1=i%n,l2=(i-1)%n;\n\t\te[++m]=apple(l1,l2,h[i]);\n\t}\n\tsort(e+1,e+m+1);\n\tlong long ans=0;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint x=e[i].x,y=e[i].y,z=e[i].z;\n\t\tint l1=findfather(x),l2=findfather(y);\n\t\tif(l1!=l2)\n\t\t{\n\t\t\tans+=z;\n\t\t\tfa[l1]=l2;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1595403722,
        "uid": 107484,
        "name": "wmy_goes_to_thu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 AT2134 \u3010Zigzag MST\u3011"
    },
    {
        "content": "## \u9898\u610f\n\n\u5bf9\u4e00\u5f20 n \u4e2a\u70b9\u7684\u7a7a\u56fe G \u505a Q \u6b21\u52a0\u8fb9\u64cd\u4f5c\uff0c\u6bcf\u6b21\u7ed9\u5b9a Ai, Bi, Ci\uff0c\u7136\u540e\u6309\u7167\u4ee5\u4e0b\u89c4\u5219\u6309\u987a\u5e8f\u8fde 10233 \u6761\u8fb9\uff1a(Ai, Bi, Ci),(Bi, Ai + 1, Ci + 1),(Ai + 1, Bi + 1, Ci + 2)\u2026\u2026 \u4ee5\u6b64\u7c7b\u63a8\uff0c\u70b9\u7684\u7f16\u53f7\u5747\u4e3a mod n \u610f\u4e49\u4e0b\u7684\uff0c\u6c42\u56fe G \u7684\u6700\u5c0f\u751f\u6210\u6811\uff1b\n\n## \u5b9e\u73b0\n\n\u4e4d\u4e00\u770b\u8fd8\u662f\u6709\u70b9\u8499\u853d\u7684\uff0c\u753b\u56fe\u540e\u53d1\u73b0\uff0c\u4e00\u6b21Q\u6700\u591a\u52a0\u5165N\u6761\u8fb9\uff0c\u4f46\u662f\uff0c$O(NQ)$\u4f9d\u65e7\u4e0d\u53ef\u505a\u5440\uff1b\n\n\u819c\u62dc\u5927\u795e\u2026\u2026\n\n\u65b9\u6cd5\u662f\u8fd9\u6837\u6ef4\uff1a\n\n\u8003\u8651\u4e00\u6b21Q\uff1a$(a,b,c)$\u753b\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/24175.png)\n\n\u5e76\u6ca1\u6709\u4ec0\u4e48\u6536\u83b7\u2026\u2026\n\n\u4f46\u662f\uff01\u5f53\u6211\u4eec\u628aA1\u548cB1\u8fde\u8d77\u6765\uff0c**\u6839\u636eK\u6c0f\u6cd5\u7684\u987a\u5e8f\uff0c\u6211\u4eec\u4f1a\u5148\u8003\u8651A1B1\u7684\u8fb9\uff0c\u518d\u8003\u8651A2B1\u7684\u8fb9\uff0c\u6240\u4ee5\u6b64\u65f6\uff0cA1B1\u4e00\u5b9a\u5728\u540c\u4e00\u4e2a\u8054\u901a\u5757\u5185\uff0c\u8fd9\u6837\uff0cA2B1\u7684\u8fb9\uff0c\u7a76\u7adf\u8fde\u5728B1\u4e0a\u8fd8\u662f\u8fde\u5728A1\u4e0a\u5c31\u65e0\u6240\u8c13\u4e86**\uff1b\n\n\uff01\uff01\uff01\u6211\u4eec\u5c31\u53ef\u4ee5\u91cd\u65b0\u5efa\u8fb9\n\n![](https://cdn.luogu.com.cn/upload/pic/24177.png)\n\n\uff08\u770b\u6a2a\u5411\u8fb9\uff09\n\n\u540c\u65f6\uff0c\u6bcf\u4e00\u4e2a\u76f8\u90bb\u7684\u8fb9\uff0c\u90fd\u662f\u6307\u5411i+1\uff0c\u6743\u503c\u90fd\u662f\u4e0a\u4e00\u4e2a+2\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u4e00\u4e2a\u6570\u7ec4\u8bb0\u5f55\u4e0b\u6765\uff0c\u6700\u540e\u4e00\u6b21\u9012\u63a8\uff0c\u6c42\u51fa\u73af\u4e0a\u6240\u6709\u8fb9\u7684\u6700\u5c0f\u503c\uff1b\n\n```\n\tfor (ri i = 1, a, b, c; i <= q; ++i) {\n        in(a), in(b), in(c);\n        add(a, b, c);\n        d[a] = min(d[a], c + 1);\n        d[b] = min(d[b], c + 2);\n    }\n    for (ri i = 0; i < n; ++i) {\n        d[i] = min(d[i], d[(i - 1 + n) % n] + 2);\n    }\n    for (ri i = 0; i < n; ++i) {\n        d[i] = min(d[i], d[(i - 1 + n) % n] + 2);\n    }\n```\n\n\u52a0\u8fb9\u7684\u9012\u63a8\uff1b**\u4e00\u5b9a\u6700\u540e\u8981\u5faa\u73af\u4e24\u904d\uff0c\u9632\u6b62\u66f4\u65b0\u4e0d\u53ca\u65f6**\uff1b\n\n## \u4ee3\u7801\n\n```\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<map>\n#include<set>\n#include<list>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<deque>\nusing namespace std;\n#define ll long long\n#define inf 0x3f3f3f3f\n#define ri register int\n#define il inline\n#define fi first\n#define se second\n#define mp make_pair\n#define pi pair<int,int>\n#define mem0(x) memset((x),0,sizeof (x))\n#define mem1(x) memset((x),0x3f,sizeof (x))\n#define pb push_back\n#define gc getchar\ntemplate<class T>void in(T &x)\n{\n    x = 0; bool f = 0; char c = gc();\n    while (c < '0' || c > '9') {if (c == '-') f = 1; c = gc();}\n    while ('0' <= c && c <= '9') {x = (x << 3) + (x << 1) + (c ^ 48); c = gc();}\n    if (f) x = -x;\n}\n#undef gc\n#define N 200010\n#define M N<<3\n#define int ll\nstruct Edge {\n    int u, v, w, nx;\n    Edge() {}\n    Edge(int uu, int vv, int ww, int nxt) {\n        u = uu, v = vv, w = ww, nx = nxt;\n    }\n    friend bool operator<(const Edge& a, const Edge& b) {\n        return a.w < b.w;\n    }\n} edge[M];\nint cnt, head[M];\nil void add(int u, int v, int w) {\n    edge[++cnt] = Edge(u, v, w, head[u]);\n    head[u] = cnt;\n}\nint f[N];\nint find(int x) {\n    return x == f[x] ? x : f[x] = find(f[x]);\n}\nbool cmpy(int x, int y) {\n    int fx = find(x), fy = find(y);\n    if (fx == fy) return 0;\n    if (fy > fx) f[fy] = fx;\n    else f[fx] = fy;\n    return 1;\n}\nint n, q;\nint d[N];\nsigned main() {\n    in(n), in(q);\n    mem1(d);\n    for (ri i = 1, a, b, c; i <= q; ++i) {\n        in(a), in(b), in(c);\n        add(a, b, c);\n        d[a] = min(d[a], c + 1);\n        d[b] = min(d[b], c + 2);\n    }\n    for (ri i = 0; i < n; ++i) {\n        d[i] = min(d[i], d[(i - 1 + n) % n] + 2);\n    }\n    for (ri i = 0; i < n; ++i) {\n        d[i] = min(d[i], d[(i - 1 + n) % n] + 2);\n    }\n    for (ri i = 0; i <= n; ++i) {\n        add(i, (i + 1) % n, d[i]);\n    }\n    sort(edge + 1, edge + 1 + cnt);\n    for (ri i = 1; i < n; ++i) f[i] = i;\n    int lt = n, ans = 0;\n    for (ri i = 1; i <= cnt && lt > 1; ++i) {\n        if (cmpy(edge[i].u, edge[i].v)) {\n            ans += edge[i].w;\n            --lt;\n        }\n    }\n    printf(\"%lld\", ans);\n    return 0;\n}\n```",
        "postTime": 1531917876,
        "uid": 58302,
        "name": "i207M",
        "ccfLevel": 0,
        "title": "\u597d\u9898-\u91cd\u65b0\u5b9a\u4e49\u751f\u6210\u6811-Zigzag MST-\u89e3\u9898\u62a5\u544a"
    },
    {
        "content": "\u4e00\u79cd\u53ef\u80fd\u7406\u89e3\u8d77\u6765\u6bd4\u8f83\u81ea\u7136\u7684\u505a\u6cd5\u3002\n\n## \u9898\u610f\n\n\u4e00\u5f20\u6709 $N$ \u4e2a\u70b9\u7684\u56fe\uff0c\u6709 $Q$ \u6b21\u5efa\u8fb9\u3002\u6bcf\u6b21\u7ed9\u5b9a\u4e09\u4e2a\u6570 $(A_i,B_i,C_i)$ \u8868\u793a\u5728 $A_i$\u548c$B_i$ \u4e4b\u95f4\u5efa\u4e00\u6761\u6743\u503c\u4e3a$C_i$\u7684\u65e0\u5411\u8fb9\u3002\u4e4b\u540e\u5728 $(A_i+1,B_i,C_i+1),(A_i+1,B_i+1,C_i+2),(A_i+2,B_i+1,C_i+3)...$ \u540c\u6837\u5efa\u8fb9\u3002\u5373\u6bcf\u6b21\u5efa\u8fb9 $(A_i+k,B_i+k,C_i+2k),(A_i+k+1,B_i+k,C_i+2k+1)$ \u5176\u4e2d $0\\le k \\le \\infty$\u3002\u6c42\u8fd9\u4e2a\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\n\n$2\\le N \\le 200000$ $1 \\le Q \\le 200000$\n\n## \u9898\u76ee\u5206\u6790\n\n\u6700\u5c0f\u751f\u6210\u6811\uff0c\u8f93\u5165\u53c8\u548c\u8fb9\u5bc6\u4e0d\u53ef\u5206\uff0c\u5f88\u5bb9\u6613\u60f3\u5230 Kruscal\u3002 \u4f46\u662f\u95ee\u9898\u662f\uff0c\u65e0\u9650\u6761\u8fb9\uff0c\u76f4\u63a5\u8dd1\u80af\u5b9a\u4e0d\u73b0\u5b9e\uff0c\u80af\u5b9a\u9700\u8981\u5bfb\u627e\u66f4\u4f18\u79c0\u7684\u65b9\u6cd5\u3002\n\n#### \u6027\u8d281\uff1a\u603b\u8fb9\u6570\n\n\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u6a21\u62df\u4e00\u4e0b\u4e00\u6761\u8fb9\u7684\u60c5\u51b5\uff0c\u8fd9\u91cc\u4ee5 $n=4,A=0,B=2,C=1$ \u4e3a\u4f8b\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pw4vs0df.png)\n\n \n\u4f1a\u53d1\u73b0\u8fd9\u65f6\u5019\u7b2c\u4e94\u6761\u8fb9\u548c\u7b2c\u4e00\u6761\u8fb9\u662f\u91cd\u53e0\u7684\uff0c\u90a3\u4e48\uff0c\u7b2c\u516d\u6761\u8fb9\u548c\u7b2c\u4e8c\u6761\u8fb9\u4e5f\u4f1a\u662f\u91cd\u53e0\u7684\u3002\n\n\u8bc1\u660e\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u56e0\u4e3a\u662f\u5728\u6a21 $n$ \u610f\u4e49\u4e0b\u7684\uff0c\u6709 $A+n\\equiv A \\mod n$ \u6240\u4ee5**\u81f3\u591a**\u5230\u7b2c $2n$ \u6761\u8fb9\uff0c\u5c31\u4f1a\u548c\u4e4b\u524d\u7684\u8fb9\u91cd\u5408\u4e86\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5e76\u4e0d\u662f\u65e0\u9650\u6761\u8fb9\uff0c\u6bcf\u6b21\u5efa\u8fb9\u6700\u591a\u53ea\u4f1a\u5efa $2n$ \u6761\u3002\n\n\u8fd9\u91cc\u8fd8\u4f1a\u53d1\u73b0\u4e00\u4e2a\u5c0f\u6027\u8d28\uff0c\u5c31\u662f\u4e00\u6761\u8fb9\u901a\u8fc7\u64cd\u4f5c\uff0c\u4e00\u5b9a\u80fd\u591f\u628a\u56fe\u4e0a\u6240\u6709\u7684\u70b9\u90fd\u8fde\u901a\uff0c\u56e0\u4e3a\u6bcf\u6b21+1\uff0c\u6240\u4ee5\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u4e2a\u70b9\u90fd\u8986\u76d6\u5230\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u6709\u4e00\u4e2a\u66b4\u529b\u7684\u601d\u8def\uff0c\u5c31\u662f\u628a\u8fd9\u4e9b\u8fb9\u5efa\u51fa\u6765\uff0c\u7136\u540e\u8dd1\u6700\u5c0f\u751f\u6210\u6811\u3002~~AT\u6ca1\u6709\u66b4\u529b\u5206\u4f60\u60f3\u4ec0\u4e48\u5462~~\n\n#### \u6027\u8d282\uff1a\u589e\u52a0\u7684\u8fb9\u6743\n\n\u65e2\u7136\u4e0d\u80fd\u76f4\u63a5\u8dd1\u6700\u5c0f\u751f\u6210\u6811\uff0c\u601d\u8003\u5982\u4f55\u4f18\u5316\u3002\n\n\u601d\u8003\u6211\u4eec\u5e73\u65f6\u8dd1 Kruscal \u7684\u8fc7\u7a0b\u3002\u6211\u4eec\u6bcf\u6b21\u9009\u62e9\u8fb9\u6743\u6700\u77ed\u7684\u8fb9\uff0c\u5224\u65ad\u5176\u662f\u5426\u5df2\u7ecf\u5728\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\uff0c\u5982\u679c\u4e0d\u5728\u5219\u9009\u62e9\u8fd9\u6761\u8fb9\uff0c\u5426\u5219\u5ffd\u7565\u3002\n\n\u6211\u4eec\u628a\u201c\u6bcf\u4e00\u6b21\u8fb9\u6743+1\u201d\u7684\u9650\u5236\u5e94\u7528\u5230\u8fd9\u91cc\uff0c\u53ef\u4ee5\u8fd9\u6837\u64cd\u4f5c\uff1a\n\n\u9996\u5148\u628a\u6240\u6709\u6240\u6709 $(A_i,B_i,C_i)$ \u4ee5 $C$ \u4e3a\u6807\u51c6\uff0c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u3002\u6bcf\u6b21\u53ea\u4f7f\u7528\u524d\u51e0\u4e2a\u8fb9\uff0c\u4fdd\u8bc1\u524d\u51e0\u4e2a\u8fb9\u7684 $C$ \u503c\u4e00\u5b9a\u76f8\u7b49\uff0c\u5bf9\u4e8e\u8fd9\u4e9b\u8fb9\u7ecf\u8fdb\u884c\u548c Kruscal \u4e00\u6837\u7684\u64cd\u4f5c\u3002\u4f7f\u7528\u5b8c\u4e4b\u540e\u5bf9 $A,B,C$ \u8fdb\u884c\u76f8\u5e94\u7684\u589e\u52a0\uff0c\u5982\u6b64\u64cd\u4f5c\uff0c\u76f4\u5230\u9009\u62e9\u4e86 $n-1$ \u4e2a\u5c31\u7ed3\u675f\u4e86\u3002\n\n\u53ef\u80fd\u6ca1\u6709\u592a\u7406\u89e3\uff0c\u6211\u4eec\u66f4\u5f62\u8c61\u7684\u8bb2\n\n\u5982\u679c\u6211\u4eec\u4e09\u6761\u8fb9\u7684\u6743\u503c\u5206\u522b\u662f$C_1=4,C_2=4,C_3=7$\uff0c\u4e0d\u7ba1\u4ed6\u4eec\u8fde\u63a5\u4e86\u4ec0\u4e48\uff0c\u6211\u4eec\u4e00\u5b9a\u4f1a\u5148\u5224\u65ad$C_1,C_2$\u7740\u4e24\u6761\u8fb9\uff0c\u63a5\u7740\uff0c\u8fd9\u4e24\u4e2a\u8fb9\u4f1a\u589e\u52a01\uff0c\u53d8\u6210$C_1=5,C_2=5,C_3=7$\uff0c\u90a3\u4e48\u4ec0\u4e48\u65f6\u5019\u5224\u65ad$C_3$\uff1f\u5230$C_1=C_2=C_3$\u7684\u65f6\u5019\u5c31\u4f1a\u5f00\u59cb\u5224\u65ad$C_3$\u3002\n\n\u518d\u7ed3\u5408\u6211\u4eec\u63d0\u5230\u7684\u6027\u8d28\uff0c\u56e0\u4e3a\u6bcf\u6761\u8fb9\u6700\u591a\u4f1a\u88ab\u64cd\u4f5c $2n$ \u6b21\uff0c\u56e0\u6b64\u6211\u4eec\u5bf9\u4e8e\u6bcf\u6761\u8fb9\u5224\u65ad\u4e5f\u4e0d\u4f1a\u8d85\u8fc7 $2n$ \u6b21\u3002\u8fd9\u6837\u6211\u4eec\u662f\u4e0d\u662f\u5c31\u5f97\u5230\u4e86 $O(m\\log m+2n)$ \u7684\u7b97\u6cd5\u4e86\uff1f\u5e76\u4e0d\u662f\u3002\u7531\u4e8e\u53ef\u80fd\u6709\u5f88\u591a\u6761\u8fb9\u7684\u8fb9\u6743\u90fd\u662f\u4e00\u6837\u7684\uff08\u5c24\u5176\u662f\u5728\u6bcf\u6b21\u6700\u5c0f\u7684\u8fb9\u6743\u8fd8\u4f1a\u589e\u52a0\u7684\u60c5\u51b5\u4e0b\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u6700\u52a3\u7684\u60c5\u51b5\u53ef\u80fd\u6240\u6709 $m$ \u6761\u8fb9\u90fd\u626b\u4e00\u6b21\uff0c\u518d\u90fd\u589e\u52a0\uff0c\u518d\u90fd\u626b\u4e00\u6b21\u3002\u56e0\u6b64\u590d\u6742\u5ea6\u662f$O(2mn)$\u3002\n\n#### \u6027\u8d28\u4e09\uff1a\u91cd\u590d\u7684\u8fb9\n\n\u3010NOTE\uff1a\u4ee5\u4e0b\u7684\u8ba1\u7b97\u90fd\u662f\u5728\u6a21 $n$ \u610f\u4e49\u4e0b\u7684\u3011\n\n\u867d\u7136\u590d\u6742\u5ea6\u4e0d\u5c3d\u4eba\u610f\uff0c\u4f46\u662f\u6211\u4eec\u8fd8\u662f\u53ef\u4ee5\u5728\u8fd9\u4e2a\u57fa\u7840\u4e0a\u7ee7\u7eed\u63a2\u7d22\u3002\u6211\u4eec\u628a\u76ee\u5149\u96c6\u4e2d\u5230\u6bcf\u6761\u8fb9\u8fde\u63a5\u7684\u70b9\u7684\u53d8\u5316 $(x,y)\\to (x+1,y) \\to (x+1,y+1)$\u4e0a\u9762\u3002\n\n\u5728\u4e0a\u9762\u7684\u5224\u65ad\u4e0b\uff0c\u6211\u4eec\u6700\u4e0d\u60f3\u770b\u5230\u7684\u60c5\u51b5\u5c31\u662f\u5f88\u591a\u8fb9\u8fde\u63a5\u7684\u4e24\u4e2a\u70b9\u5df2\u7ecf\u76f8\u4e92\u8fde\u901a\u4e86\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a\u201c\u5dee\u8fb9\u201d\u3002\u6211\u4eec\u5f88\u60f3\u628a\u8fd9\u79cd\u201c\u5dee\u8fb9\u201d\u90fd\u7ed9\u6254\u6389\u3002\u4f46\u662f\u76f4\u63a5\u6254\u6389\u4f1a\u5bfc\u81f4\u5b83\u540e\u9762\u6f14\u53d8\u51fa\u6765\u8fb9\u65e0\u6cd5\u88ab\u7edf\u8ba1\uff0c\u800c\u6f14\u53d8\u51fa\u6765\u7684\u8fb9\u53ef\u80fd\u4e0d\u662f\u201c\u5dee\u8fb9\u201d\u3002\n\n\u6211\u4eec\u4ed4\u7ec6\u60f3\u4e00\u4e0b\uff0c\u6709\u6ca1\u201c\u5dee\u8fb9\u201d\u6f14\u53d8\u51fa\u6765\u7684\u8fd8\u662f\u201c\u5dee\u8fb9\u201d\u7684\u60c5\u51b5\uff1f\n\n\u5b9e\u9645\u4e0a\u662f\u6709\u7684\u3002\n\n\u6211\u4eec\u5047\u8bbe\u73b0\u5728\u6709\u4e00\u4e2a\u8fde\u63a5 $(x,y)$ \u4e14\u8fb9\u6743\u4e3a $k$ \u7684\u8fb9\u3002\u76ee\u524d\u53d1\u73b0 $(x,y)$ \u5df2\u7ecf\u8fde\u901a\u4e86\u3002\u901a\u8fc7 $x\\to a \\to b \\to y$ \u8fd9\u6837\u4e00\u6761\u8fb9\u8054\u901a\u7684\u3002\u8fd9\u8bf4\u660e\u4e86\uff0c\u4e00\u5b9a\u6709\u8fd9\u6837\u51e0\u6761\u8fb9\u6743\u4e0d\u5927\u4e8e $k$ \u7684\u8fb9\u5206\u522b\u8fde\u63a5\u4e86 $(x,a),(a,b),(b,y)$\u3002\u90a3\u4e48\u6211\u4eec\u89c2\u5bdf $(x+1,y+1)$\uff0c\u662f\u4e0d\u662f\u540c\u6837\u4e00\u5b9a\u4f1a\u6709\u51e0\u6761\u8fb9\u6743\u4e0d\u5927\u4e8e $k+2$ \u7684\u8fb9\u5df2\u7ecf\u628a $(x+1,a+1),(a+1,b+1),(b+1,y+1)$ \u8fde\u63a5\u4e86\uff0c\u5373 $x+1\\to a+1 \\to b+1 \\to y+1$\u5df2\u7ecf\u88ab\u8fde\u63a5\u3002\n\n\u8fd9\u91cc\u611f\u6027\u7406\u89e3\u5c31\u662f\uff0c\u4f60\u6bd4\u4eba\u5bb6\u6162\u4e00\u6b65\uff0c\u4f60\u524d\u8fdb\u4e00\u6b65\uff0c\u522b\u4eba\u524d\u8fdb\u4e00\u6b65\uff0c\u4f60\u8fd8\u662f\u6bd4\u4eba\u5bb6\u6162\u4e00\u6b65\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u201c\u5dee\u8fb9\u201d\uff0c\u4ed6\u540e\u9762 $(x+p,y+p)$ \u90fd\u662f\u201c\u5dee\u8fb9\u201d\u3002\n\n#### \u5c0f\u7b56\u7565\uff1a\u62c6\u8fb9\n\n\u90a3\u4e48 $(x,y) \\to (x+1,y)$ \u8fd9\u6b21\u53d8\u5316\u5462\uff1f\u6211\u4eec\u65e0\u6cd5\u5224\u65ad $(x+1,y)$ \u662f\u5426\u4e5f\u662f\u5dee\u7684\u3002\n\n\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u60f3\u8981 $x,y$ \u540c\u65f6\u589e\u52a0\u3002\u90a3\u4e48\u6211\u4eec\u5e72\u8106\u5427\u8fd9\u4e24\u79cd\u5206\u5f00\u6765\uff01\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u5bf9\u4e8e $(A_i,B_i,C_i)$ \u76f4\u63a5\u53d8\u6210 $(A_i,B_i,C_i),(A_i+1,B_i,C_i+1)$\uff0c\u5e76\u4e14\u4f7f\u5176\u53d8\u5316\u89c4\u5f8b\u53d8\u4e3a\u6bcf\u6b21 $A,B$\u540c\u65f6 $+1$ \uff0c$C +2$\u3002\u4ee3\u7801\u5b9e\u73b0\u5c31\u662f\uff1a\n\n\n```cpp\nfor(int i=1;i<=m;i++){\n    int u,v,w;\n    scanf(\"%lld%lld%lld\",&u,&v,&w);\n    alled[++toted]=(edge){u,v,w};\n    alled[++toted]=(edge){(u+1)%n,v,w+1};\n} \n```\n\n\n\u8fd9\u6837\u7684\u597d\u5904\u662f\u4ec0\u4e48\uff1f\u6211\u4eec\u867d\u7136\u8981\u770b $2m$ \u4e2a\u8fb9\uff0c\u4f46\u662f\u4e00\u65e6\u4e00\u4e2a\u8fb9\u6709\u4e00\u6b21\u53d8\u5dee\u4e86\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7acb\u523b\u628a\u5b83\u6254\u6389\uff0c\u6240\u4ee5\u6700\u540e\u6700\u591a\u662f\u770b $4m$ \u6b21\u3002\n\n\u8fd9\u91cc\u5b9e\u73b0\u7684\u65b9\u6cd5\u5c31\u5f88\u591a\u4e86\uff0c\u6211\u4e2a\u4eba\u7528\u7684\u662f\u94fe\u7ef4\u62a4\u3002\n\n\u5224\u65ad\u7a7a\n\n```cpp\n//ST=start,ED=end\nif(nex[ST]==ED){\n     pushfront(now);\n     now++;\n}\n```\n\n\u52a0\u5165\u65b0\u7684\u53ef\u7528\u8fb9\uff0c\u56e0\u4e3a$C+2$\u6240\u4ee5\u53ef\u80fd\u6709\u6bd4\u73b0\u5728\u8fb9\u6743\u8fd8\u5c0f\u7684\u8fb9\uff0c\u4e0d\u8fc7\u4e0d\u7528\u614c\uff0c\u6700\u591a\u4e5f\u5c31\u5c0f1\uff0c\u6240\u4ee5\u653e\u5230\u94fe\u9996\u5c31\u597d\u4e86\n\n```cpp\nwhile(now<=toted&&alled[now].w<alled[nex[ST]].w){\n    pushfront(now);\n    now++;\n}\nwhile(now<=toted&&alled[now].w==alled[pre[ED]].w){\n    pushback(now);\n    now++;\n}\n```\n\n\u7136\u540e\u5c31\u662f\u6b63\u5e38\u7684 Kruscal \u64cd\u4f5c\u3002\u5982\u679c\u5b83\u662f\u5dee\u7684\uff0c\u5c31\u628a\u5b83\u5f39\u51fa\u53bb\u3002\u5426\u5219\u66f4\u65b0\u5176\u6570\u636e\uff0c\u5e76\u4e14\u628a\u5b83\u8c03\u5230\u94fe\u5c3e\u3002\n\n```cpp\nint tmp=nex[ST];\nint u=alled[tmp].from,v=alled[tmp].to,w=alled[tmp].w;\nif(find(u)==find(v)){\n    popx(tmp);\n} else {\n    fa[find(u)]=find(v);\n    ans+=w;\n    conn++;\n    alled[tmp].from+=1,alled[tmp].to+=1,alled[tmp].w+=2;\n    alled[tmp].from%=n,alled[tmp].to%=n;\n    popx(tmp);\n    pushback(tmp);\n}\n```\n\u6700\u540e\u8f93\u51fa ans \u5c31\u662f\u7b54\u6848\n",
        "postTime": 1671799750,
        "uid": 381432,
        "name": "Jryno1",
        "ccfLevel": 5,
        "title": "AT_codefestival_2016_final_g\u9898\u89e3"
    },
    {
        "content": "\u597d\u5999\u554a\uff0c\u964d\u5927\u667a\u3002\n\n$1$\u3001\u76f4\u63a5\u66b4\u529b\n\n\u6211\u4f1a\u66b4\u529b\u5efa\u8fb9\uff0c\u6bcf\u6b21\u64cd\u4f5c\u53ea\u9700\u8981\u66b4\u529b\u5efa\u51fa $O(\\infty)$ \u6761\u8fb9\u5373\u53ef\u3002\n\n\u7136\u540e\u5bf9\u8fd9 $O(q\\infty)$ \u6761\u8fb9\u6309\u8fb9\u6743\u5347\u5e8f\u6392\u5e8f\uff0c\u6700\u540e\u8dd1\u4e00\u904d Kruskal \u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(q\\infty \\log q\\infty)$\n\n$2$\u3001\u4f18\u5316\u4e00\u70b9\u70b9\u7684\u66b4\u529b\n\n\u53d1\u73b0\u6bcf\u6b21\u64cd\u4f5c\u53ea\u9700\u8981\u5efa $O(n)$ \u6761\u8fb9\u5c31\u80fd\u5f97\u51fa\u4e00\u68f5\u6700\u5c0f\u751f\u6210\u6811\uff0c\u6240\u4ee5\u6211\u4eec\u603b\u5171\u53ea\u9700\u8981\u5bf9\u8fd9 $O(qn)$ \u6761\u8fb9\u8dd1\u6700\u5c0f\u751f\u6210\u6811\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(qn\\log qn)$\n\n$3$\u3001\u4f18\u5316\u4ebf\u70b9\u70b9\u7684\u66b4\u529b\n\n\u53d1\u73b0\u4e00\u5f00\u59cb\u8fde\u4e24\u6761\u8fb9 $a_i$ \u548c $a_i+1$ \u5c31\u4f1a\u8fde\u901a\uff0c\u8fde\u4e09\u6761\u8fb9 $b_i$ \u548c $b_i+1$ \u5c31\u4f1a\u8fde\u901a\uff0c\u7b2c\u4e00\u6761\u8fb9 $a_i$ \u548c $b_i$ \u8fde\u901a\uff0c\u90a3\u4e48\u4e4b\u540e $a_i+1$ \u548c $b_i$ \u8fde\u7b49\u4ef7\u4e8e $a_i+1$ \u548c $a_i$ \u8fde\uff0c\u800c\u4e14 $a_i+j$ \u548c $a_i+j+1$ \u8fde\u901a\u4e0e $a_i+j-1$ \u548c $a_i+j$ \u8fde\u901a\u6240\u82b1\u8d39\u7684\u4ee3\u4ef7\u6b63\u597d\u5dee $2$\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u5fc5\u4e00\u6b21\u6027\u5efa\u51fa $O(n)$ \u6761\u8fb9\uff0c\u800c\u662f\u53ea\u8fde $a_i$ \u548c $b_i$\uff0c\u5e76\u628a\u5f00\u5934\u8bb0\u4e0b\u6765\uff0c\u6700\u540e\u6574\u4f53\u9012\u63a8\u4e00\u904d\u76f8\u90bb\u4e24\u4e2a\u70b9\u8fb9\u6743\u6700\u5c0f\u503c\u5e76\u8fde\u8fb9\u5373\u53ef\uff0c\u8fd9\u6837\u6211\u4eec\u53ea\u9700\u8981\u5efa $O(n+q)$ \u6761\u8fb9\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n+q\\log (n+q))$\u3002",
        "postTime": 1646296090,
        "uid": 80614,
        "name": "ZCPB",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT2134"
    },
    {
        "content": "## $Description$\n\n\u5bf9\u4e00\u5f20$n$\u4e2a\u70b9\u7684\u56fe\u505a$Q$\u6b21\u52a0\u8fb9\u64cd\u4f5c,\u6bcf\u6b21\u7ed9\u5b9a$A_i,B_i,C_i,$\u7136\u540e\u6309\u987a\u5e8f\u8fde\u8fb9$(A_i,B_i,C_i),(B_i,A_i+1,C_i+1),(A_i+1,B_i+1,C_i+2)$\u7b49\u7b49\uff0c\u6c42\u7ed9\u5b9a\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811$.(A_i,B_i,C_i$\u7b49\u70b9\u7f16\u53f7\u5747\u4e3a\u5bf9$n$\u53d6\u6a21\u7684\u610f\u4e49\u4e0b$)$\u7ed9\u5b9a\u521d\u59cb\u7684$n,q,A_i,B_i,C_i;$\n\n$(N,Q\\leqslant 200000,0\\leqslant A_i,B_i<N,1\\leqslant C_i\\leqslant 10^9)$\n\n## $Solution$\n\n\u7ecf\u8fc7\u7b80\u5355\u601d\u8003\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e\u4e00\u6b21\u52a0\u8fb9\u64cd\u4f5c\uff0c\u6700\u591a\u52a0\u5165$2\\times n$\u6761\u8fb9\uff0c\u56e0\u4e3a\u7b2c$2\\times n+1$\u6761\u8fb9\u4e3a$((A_i+n)\\%n,((B_i+n)\\%n,d+2\\times n)$\u5373$(A_i,B_i,d+2\\times n),$\u7531\u4e8e\u6c42\u6700\u5c0f\u751f\u6210\u6811\uff0c\u5f80\u540e\u7684\u8fb9\u52a0\u5165\u5c31\u6ca1\u6709\u610f\u4e49\u4e86\u3002\n\n\u6240\u4ee5\u603b\u8fb9\u6570\u4e3a$N\\times Q$,\u7136\u800c\u8fd9\u4e2a\u590d\u6742\u5ea6\u4f9d\u7136\u65e0\u6cd5\u63a5\u53d7\n\n\u5bf9\u4e8e\u4e00\u6b21\u8fde\u8fb9,\u5047\u8bbe\u8fde$(A_i,B_i,C_i),$\u90a3\u4e48\u7b2c\u4e8c\u6761\u8fb9\u5c31\u8981\u8fde$(B_i,A_i+1,C_i+1),$\u7531\u4e8e\u6b64\u65f6$A_i$\u548c$B_i$\u5df2\u7ecf\u8054\u901a$(B_i,A_i+1,C_i+1)$\u5176\u5b9e\u7b49\u4ef7\u4e8e$(A_i,A_i+1,C_i+1)$\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u6bcf\u6b21\u8fde\u8fb9\u64cd\u4f5c\u5c31\u76f8\u5f53\u4e8e\u8fde$(A_i,B_i,C_i)$\n\n$((A_i+d-1)\\%n+1,(A_i+d)\\%n+1,C_i+2\\times d+1)$\n\n$((B_i+d-1)\\%n+1,(B_i+d)\\%n+1,C_i+2\\times d+2)(0\\leqslant d<n)$\n\n\u867d\u7136\u8fd9\u5e76\u6ca1\u6709\u6539\u53d8\u6bcf\u6b21\u52a0\u8fb9$O(n)$\u7684\u590d\u6742\u5ea6\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0$(A_i+1,A_i+2)$\u7684\u8fb9\u6743\u7b49\u4e8e$(A_i,A_i+1)$\u7684\u8fb9\u6743$+2$\n\n\u4e8e\u662f\u6211\u4eec\u8bbe\u4e00\u4e2a\u6570\u7ec4$g,$\u4f7f\u5f97$g[i]$\u8868\u793a$(i,i\\%n+1)$\u8fd9\u6761\u8fb9\u7684\u6700\u5c0f\u8fb9\u6743$($\u5f00\u59cb\u65f6\u8bbe\u4e3a$inf),$\u63a5\u7740\u5bf9\u4e8e\u4e00\u6b21\u8fde\u8fb9\u6211\u4eec\u8fde\u4e0a$(A_i,B_i,C_i),$\u518d\u5c06\n```cpp\ng[u]=min(g[u],d+1);g[v]=min(g[v],d+2);\n```\n\n\u7136\u540e\u6211\u4eec\u53ea\u9700\u8981\u518d\u7528$g[i]$\u66f4\u65b0$g[i\\%n+1]$\u5373\u53ef\uff0c\u7531\u4e8e\u66f4\u65b0\u7684\u8282\u70b9\u987a\u5e8f\u5448\u73af\u5f62\uff0c\u6240\u4ee5\u9700\u8981\u66f4\u65b0\u4e24\u904d\n\n```cpp\ng[i%n+1]=min(g[i%n+1],g[i]+2);\n```\n\n\u6700\u540e\u518d\u8fde\u4e0a$(i,i\\%n+1,g[i])$\u5c31\u53ef\u4ee5\u5c06\u5c06\u8fb9\u6570\u964d\u4f4e\u5230$O(n)$\u7ea7\u522b\uff0c\u7136\u540e\u76f4\u63a5\u8dd1$Kruskal$\u5373\u53ef\n\n## $Code$\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define inf 0x3f3f3f3f\n#define re register\n#define N 301200\n#define pii pair<int,int>\n#define mp make_pair\n#define fi first\n#define se second\n#define mod 1000000007\nusing namespace std;\nstruct edge{\n    int u,v,d;\n}e[N<<1];\ninline int read(){\n    int x=0,w=0;char ch=getchar();\n    while (!isdigit(ch))w|=ch=='-',ch=getchar();\n    while (isdigit(ch))x=(x<<1)+(x<<3)+ch-'0',ch=getchar();\n    return w?-x:x;\n}\nint f[N],g[N],ans,n,Q,cnt;\ninline bool cmp(edge a,edge b){\n    return a.d<b.d;\n}\nint find(int k){return f[k]==k?k:f[k]=find(f[k]);}\nvoid Kr(){\n    sort(e+1,e+1+cnt,cmp);\n    for (int i=1,t=0;i<=cnt;++i){\n        int x=find(e[i].u),y=find(e[i].v);\n        if (x==y)continue;\n        f[x]=y;\n        ++t;ans+=e[i].d;\n        if (t==n-1)break;\n    }\n}\nsigned main(){\n    n=read(),Q=read();\n    memset(g,0x3f,sizeof(g));\n    while (Q--){\n        int u=read()+1,v=read()+1,d=read();\n        e[++cnt]=(edge){u,v,d};\n        g[u]=min(g[u],d+1);g[v]=min(g[v],d+2);\n    }\n    for (int i=1;i<=n;++i)\n        g[i%n+1]=min(g[i%n+1],g[i]+2),f[i]=i;\n    for (int i=1;i<=n;++i)\n        g[i%n+1]=min(g[i%n+1],g[i]+2);\n    for (int i=1;i<=n;++i)e[++cnt]=(edge){i,i%n+1,g[i]};\n    Kr();\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1569134374,
        "uid": 54260,
        "name": "tcchyc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT2134 \u3010Zigzag MST\u3011"
    }
]
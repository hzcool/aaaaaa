[
    {
        "content": "\u52a8\u52a8\u8111\u5b50\u5c31\u80fd\u77e5\u9053\u6839\u672c\u4e0d\u53ef\u80fd\u65e0\u89e3\u3002\n\n\u8003\u8651\u5199\u4e00\u4e2a\u975e\u5e38\u66b4\u529b\u7684\u505a\u6cd5\uff1a\u4ece $1$ \u5f00\u59cb\u904d\u5386\u8fd9\u68f5\u6811\uff0c\u540c\u65f6\u8bb0\u4e00\u4e0b\u5f53\u524d\u5b50\u6811\u6709\u6ca1\u6709\u88ab\u7ffb\u8f6c\u3002\u7edf\u8ba1\u7b54\u6848\u76f4\u63a5\u770b\u5f53\u524d\u8282\u70b9\u8981\u4e0d\u8981\u7ffb\u8f6c\u5373\u53ef\u3002\n\n\u53c2\u8003\u5b9e\u73b0\uff08`c[x]` \u8868\u793a\u7b2c $x$ \u4e2a\u70b9\u7684\u989c\u8272\uff09\uff1a\n\n```cpp\nvoid D(int x, bool r) {\n  ans += c[x] != r;\n  for (int i : e[x]) {\n    D(i, r ^ (c[x] != r));\n  }\n}\n```\n\n\u4e0d\u96be\u53d1\u73b0 `r ^ (c[x] != r)` \u5c31\u76f8\u5f53\u4e8e `c[x]`\u3002\u6240\u4ee5\u8fd9\u4efd\u4ee3\u7801\u672c\u8d28\u4e0a\u662f\u5728\u7edf\u8ba1\u6709\u591a\u5c11\u4e2a\u8282\u70b9\u7684\u989c\u8272\u4e0d\u7b49\u4e8e\u7236\u8282\u70b9\u7684\u989c\u8272\u3002\n\n\u6bcf\u4e2a\u88ab\u67d3\u6210\u9ed1\u8272\u7684\u8282\u70b9\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5373\u4e3a\u5b83\u6709\u591a\u5c11\u4e2a\u767d\u8272\u7684\u513f\u5b50\u8282\u70b9\u548c\u591a\u5c11\u4e2a\u767d\u8272\u7684\u7236\u4eb2\u8282\u70b9\u3002\u76f4\u63a5\u7ef4\u62a4\u4e00\u4e0b\u5373\u53ef\u3002\n\n```cpp\n#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nconst int kN = 2e5 + 1;\n\nint n, q, c, f[kN], s[kN];\nbool v[kN];\n\nint main() {\n  ios_base::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n  cin >> n >> q;\n  for (int i = 2; i <= n; ++i) {\n    cin >> f[i];\n    ++s[f[i]]; // \u6709\u591a\u5c11\u4e2a\u513f\u5b50\u7684\u989c\u8272\u662f\u767d\u8272\n  }\n  for (int l; q--; ) {\n    cin >> l;\n    vector<int> ql(l);\n    for (int &i : ql) {\n      cin >> i;\n      --s[f[i]];\n      v[i] = 1;\n    }\n    c = 0;\n    for (int i : ql) {\n      c += s[i] + !v[f[i]]; // \u6bcf\u4e2a\u9ed1\u8272\u8282\u70b9\u7684\u8d21\u732e\uff1a\u5bf9\u513f\u5b50\u7684\u548c\u5bf9\u7236\u4eb2\u7684\n    }\n    cout << c << '\\n';\n    for (int i : ql) { // \u8fd8\u539f\n      v[i] = 0;\n      ++s[f[i]];\n    }\n  }\n  return 0;\n}\n```\n",
        "postTime": 1670646750,
        "uid": 376161,
        "name": "wsfxk",
        "ccfLevel": 6,
        "title": "[ARC148C] Lights Out on Tree \u9898\u89e3"
    },
    {
        "content": "\u6709\u751f\u4e4b\u5e74\uff0c\u4f60\u8c37\u7ec8\u4e8e\u722c\u5230\u65b0\u9898\u4e86\uff08\uff08\uff08\n\n---\n\n**\u9898\u610f\uff1a**\n\n\u7ed9\u4f60\u4e00\u9897\u6709\u6839\u6811\uff0c\u6bcf\u4e2a\u8282\u70b9\u662f\u9ed1\u8272\u6216\u767d\u8272\uff0c\u521d\u59cb\u5168\u4e3a\u767d\u8272\u3002\n\n\u6bcf\u6b21\u8be2\u95ee\u7ed9\u51fa\u4e00\u4e2a\u70b9\u96c6 $S$\uff0c\u628a\u70b9\u96c6\u4e2d\u7684\u70b9\u5168\u90e8\u67d3\u6210\u9ed1\u8272\uff0c\u95ee\u81f3\u5c11\u9700\u8981\u7ffb\u8f6c\u591a\u5c11\u4e2a\u8282\u70b9\u4f7f\u6574\u68f5\u6811\u5168\u4e3a\u767d\u70b9\uff0c\u65e0\u89e3\u8f93\u51fa `-1`\u3002\n\n\u7ffb\u8f6c\u7684\u5b9a\u4e49\u4e3a\uff1a\u5c06\u8282\u70b9 $u$ \u53ca\u5176\u5b50\u6811\u4e2d\u6240\u6709\u8282\u70b9\u989c\u8272\u7ffb\u8f6c\u3002\n\n**\u8f93\u5165\uff1a**\n\n\u7b2c\u4e00\u884c $N$\uff0c$Q$ \u8868\u793a\u8282\u70b9\u6570\u548c\u8be2\u95ee\u6b21\u6570\uff1b\n\n\u7b2c\u4e8c\u884c $N-1$ \u4e2a\u6574\u6570 $P_i$ \u8868\u793a\u8282\u70b9 $i$ \u7684\u7236\u8282\u70b9\uff1b\n\n\u4e4b\u540e $Q$ \u884c\uff0c\u6bcf\u884c\u7b2c\u4e00\u4e2a\u6574\u6570 $M_i$ \u8868\u793a\u70b9\u96c6 $S$ \u5927\u5c0f\uff0c\u4f59\u4e0b $M_i$ \u4e2a\u6574\u6570 $v_{i,j}$ \u8868\u793a\u70b9\u96c6 $S$\u3002\n\n---\n\n**\u9898\u89e3\uff1a**\n\n\u975e\u5e38\u663e\u7136\u7684\u6027\u8d28\u662f\uff1a\n\n- \u5bf9\u4e00\u4e2a\u8282\u70b9\u64cd\u4f5c\u4e00\u6b21\u4ee5\u4e0a\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff1b\n\n- \u64cd\u4f5c\u7684\u987a\u5e8f\u6ca1\u6709\u5f71\u54cd\uff1b\n\n- \u4e00\u5b9a\u6709\u89e3\u5e76\u53ea\u6709\u4e00\u79cd\u53ef\u884c\u65b9\u6848\uff1b\n\n\u597d\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u6bcf\u4e2a\u8282\u70b9\u64cd\u4f5c\u6216\u4e0d\u64cd\u4f5c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(2^n)$\u3002\n\n\u8fd9\u662f\u66b4\u529b\u7684\u89e3\u6cd5\uff0c\u6211\u4eec\u8003\u8651\u6b63\u89e3\uff1a\n\n\u9996\u5148\u9884\u5904\u7406\u6bcf\u4e2a\u9876\u70b9\u7684\u513f\u5b50\u8282\u70b9\u6570 $t$\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u6b21\u8be2\u95ee\uff0c$ans=m_i+\\sum_{j=1}^{m_i} t_{v_{j}}$\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u66f4\u6539\u7236\u8282\u70b9\u662f\u4f1a\u66f4\u6539\u5b50\u8282\u70b9\u7684\u72b6\u6001\uff0c\u5982\u679c\u5b50\u8282\u70b9\u4e5f\u9700\u8981\u66f4\u6539\uff0c\u5c31\u51cf\u53bb\u5b83\u7684\u8d21\u732e\u3002\n\n```cpp\nint main() {\n    scanf(\"%d %d\", &n, &q);\n    for (int i = 2; i <= n; i++) {\n        scanf(\"%d\", &p[i]), t[p[i]]++;\n    }\n    for (int i = 1; i <= q; i++) {\n        scanf(\"%d\", &m), ans = m;\n        for (int j = 1; j <= m; j++) {\n            scanf(\"%d\", &v[j]), t[p[v[j]]] -= 2;\n        }\n        for (int j = 1; j <= m; j++) {\n            ans += t[v[j]];\n        }\n        for (int j = 1; j <= m; j++) {\n            t[p[v[j]]] += 2;\n        }\n        printf(\"%d\\n\", ans);\n    }\n}\n```",
        "postTime": 1666276945,
        "uid": 581312,
        "name": "zerc",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 ARC148C Lights Out on Tree"
    }
]
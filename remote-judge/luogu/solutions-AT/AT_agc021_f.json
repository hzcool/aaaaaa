[
    {
        "content": "\u4e3b\u8981\u7531\u4e8e\u4e0d\u559c(~~\u4e0d\u61c2~~)\u7ec4\u5408\u610f\u4e49\uff0c\u5bf9\u6700\u540e\u7684\u7cfb\u6570\u505a\u4e00\u70b9\u8bf4\u660e\uff0c\u987a\u5e26\u6e05\u6670\u5730\u8868\u8ff0\u4e00\u4e0bdp\u601d\u8def\n\n\u9996\u5148\u6ce8\u610f\u5230\u884c\u548c\u5217\u7684\u5dee\u5f02\u6027\uff0c\u884c\u53ea\u8981\u6c42\u8bb0\u5f55\u6700\u5c0f\u7684\u5217\u6807\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u6b64\u89c6\u4f5c\u4e00\u79cd\u9636\u6bb5\u3002\u66f4\u5177\u4f53\u7684\u6211\u4eec\u4e00\u5217\u4e00\u5217\u7684\u586b\uff0c\u6bcf\u4e00\u6b21\u5728\u7b2c $i$ \u5217\u786e\u5b9a\u5bf9\u4e8e $[1,n]\\times[1,i]$ \u8fd9\u4e2a\u5217\u524d\u7f00\u77e9\u9635\u76f8\u5bf9\u4e8e $[1,n]\\times[1,i-1]$ \u7684\u975e $0$ \u884c\u96c6\u5408\u7684\u53d8\u5316\uff0c\u8bbe\u6b64\u53d8\u5316\u4e3a $S\\to T$ \u5219 $\\forall x \\in T / S,A_x\\leftarrow i$\u3002\n\n\u8bbe $f_{i,j}$ \u8868\u793a $[1,n]\\times[1,i]$ \u5373\u524d$i$\u5217\u4e2d\u975e $0$ \u884c\u96c6\u5408\u5927\u5c0f\u4e3a $j$ \u7684\u65b9\u6848\u6570\uff0c\u5047\u8bbe\u6bcf\u4e00\u8f6e\u589e\u52a0 $\\Delta j$ \u4e2a,\u90a3\u4e48\u8fd9\u4e00\u6b65\u6211\u4eec\u9700\u8981\u9009\u51fa**\u8fd9 $\\Delta j$ \u4e2a\u65b0\u589e\u7684\u6570\u5177\u4f53\u5bf9\u4e8e\u73b0\u5728\u5df2\u7ecf\u6709\u7684 $j+\\Delta j$ \u4e2a\u6570\u4ed6\u4eec\u662f\u8c01(\u8fd9\u4e00\u6b65\u786e\u5b9a\u4e86 $A_x,x\\in T/S ,|T/S|=\\Delta j$ )\uff0c\u9644\u52a0\u4e0a\u6700\u503c\u9009\u53d6\u7684\u76f8\u5bf9\u4e8e\u5df2\u7ecf\u6709\u7684 $j+\\Delta j$ \u4e2a\u6570\u662f\u8c01(\u8fd9\u4e00\u6b65\u786e\u5b9a\u4e86 $B_i,C_i$)**\n\n(\u521a\u521a\u4e0a\u65b9\u63cf\u8ff0\u7684 [\u4ed6\u4eec\u662f\u8c01] \u5176\u5b9e\u90fd\u662f\u5728\u523b\u753b\u76f8\u5bf9\u5927\u5c0f\u5173\u7cfb\u786e\u5b9a\uff0c\u6bcf\u4e00\u6b65\u90fd\u786e\u5b9a\u540e\u7b54\u6848\u53d6\u51fa\u65f6\u4e58\u4e0a\u7684\u7ec4\u5408\u6570\u8868\u793a\u9009\u51fa\u6700\u7ec8\u786e\u5207\u7684\u503c\u5c31\u53ef\u4ee5\u53cd\u63a8\u56de\u53bb\u6bcf\u4e00\u6b65\u7684\u786e\u5207\u9009\u53d6\u4e86)\n\n- $\\Delta j=0$\n\t- \u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u9009\u51fa\u6700\u503c\u5373\u53ef\uff0c\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u4e00\u4e2a\u76f8\u540c\u7684\u6570\u6216\u4e24\u4e2a\u4e0d\u540c\u6570\n    \uff0c\u65b9\u6848\u6570\u4e3a$1+j+\\binom{j}{2}$\n- $\\Delta j\\neq 0$\n\n  - \u6700\u503c\u8d21\u732e\u5747\u6765\u81ea\u8fd9 $\\Delta j$ \u4e2a\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u9009\u51fa\u8fd9$\\Delta j$\u4e2a\u6570\u662f\u8c01\u5c31\u53ef\u4ee5\u4e86\uff0c\u65b9\u6848\u6570\u4e3a$\\binom{\\Delta j+j}{\\Delta j}$\n  - \u6700\u503c\u8d21\u732e\u6709\u4e00\u4e2a\u6765\u81ea $\\Delta j$ \u4e2a\u6570\uff0c\u6ce8\u610f\u5230\u8fd9\u4e2a\u65b9\u6848\u4e0e\u9009\u51fa $\\Delta j+1$ \u4e2a\u6570\u6784\u6210\u53cc\u5c04\uff0c\u533a\u5206\u4e00\u4e0b\u6700\u5927\u6700\u5c0f\u503c\u6709\u4e00\u4e2a$2$\u7684\u8d21\u732e\uff0c\u65b9\u6848\u6570\u4e3a$2\\binom{\\Delta j+j}{\\Delta j+1}$\n  - \u6700\u503c\u8d21\u732e\u5747\u4e0d\u6765\u81ea\u8fd9 $\\Delta j$ \u4e2a\u6570\uff0c\u7c7b\u4f3c\u7684\u6709\u65b9\u6848\u6570\u4e3a $\\binom{\\Delta j+j}{\\Delta j+2}$\n\n\t\u6c42\u4e00\u4e0b\u548c\u5373\u4e3a $\\binom{\\Delta j+j+2}{\\Delta j+2}$,\u4e5f\u5c31\u662f\u5927\u591a\u6570\u4eba\u7528\u7ec4\u5408\u610f\u4e49\u89e3\u91ca\u7684\u7cfb\u6570\n\n\u6700\u540e\u5199\u4e00\u4e0b\u5f0f\u5b50\n\n$$\nf_{i+1,j}\\leftarrow f_{i,j}(\\binom{j}{2}+j+1)\n$$\n\n$$\nf_{i+1,j+\\Delta j}\\leftarrow f_{i,j}\\binom{\\Delta j+j+2}{\\Delta j+2}\n$$\n\n\u7b54\u6848\u4e3a$\\displaystyle \\sum\\limits_{i=0}^{n}\\binom{n}{i}f_{m,i}$\n\n\u8fd8\u662f\u5199\u4e00\u4e0b\uff0c~~\u6015\u4e0d\u8fc7~~,\u7b80\u5316\u4e00\u4e0b\u5f0f\u5b50\u540e\u5316\u7b80\u5f97\n\n$$\n\\begin{aligned}\nf_{i,j}&=(1+j+\\binom{j}{2})f_{i-1}{j}+\\sum_{k=0}^{j-1}\\binom{j+2}{k}f_{i-1}k\n\\\\&=(1+j+\\binom{j}{2})f_{i-1}{j}+(j+2)!\\sum_{k=0}^{j-1}\\frac{f_{i-1,k}}{k!}\\frac{1}{((j-1)-k+3)!}\n\\end{aligned}\n$$\n\n\u4ee4$\\displaystyle F^{[i]}(x)=\\sum_{j=0}^n \\frac{f_{i-1,j}}{j!}x^j,G^{[i]}(x)=\\sum_{j=0}^n \\frac{1}{(j+3)!}x^j$\n\n\u5219\n\n$$\n\\begin{aligned}\nf_{i,j}=(1+j+\\binom{j}{2})f_{i-1}{j}+(j+2)![x^{j-1}](F^{[i]}(x)\\cdot G^{[i]}(x))\n\\end{aligned}\n$$\n\nNTT \u5373\u53ef\u505a\u5230 $\\mathcal O(nm\\log n)$\n\n```cpp\nint main(void){\n\tint i,j,now=0;poly a,b,c;scanf(\"%d%d\",&n,&m),a.resize(n),b.resize(n);\n\tfor(*jc=i=1;i<=n+5;++i)jc[i]=1ll*jc[i-1]*i%mod;inv[n+5]=qpow(jc[n+5],mod-2);\n\tfor(i=n+4;~i;--i)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n\tfor(*f[0]=*f[1]=i=1;i<=m;++i){\n\t\tfor(now^=1,j=0;j<n;++j)a[j]=1ll*f[now^1][j]*inv[j]%mod,b[j]=inv[j+3];c=a*b;\n\t\tfor(j=1;j<=n;++j)f[now][j]=((1ll*j*j+j+2ll)/2ll*f[now^1][j]+1ll*jc[j+2]*c[j-1])%mod;\n\t}\n\tfor(i=0;i<=n;++i)ans=(ans+1ll*C(n,i)*f[now][i])%mod;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1627097684,
        "uid": 40629,
        "name": "zzw4257",
        "ccfLevel": 0,
        "title": "AT3872 [AGC021F] Trinity \u9898\u89e3"
    },
    {
        "content": "\u5206\u4eab\u4e00\u4e2a $O(n + m^3)$ \u4e14\u4e0d\u4f7f\u7528 ntt \u7684\u505a\u6cd5\u3002\n\n---\n\n\u9996\u5148\u76f4\u63a5\u5199\u51fa\u6734\u7d20\u7684 dp \u5f0f\u5b50\uff0c\u8f6c\u79fb\u7684\u8be6\u7ec6\u610f\u4e49\u53ef\u4ee5\u53c2\u8003\u5176\u4ed6\u9898\u89e3\uff1a\n$$\ndp_{m, n} = (1 + \\binom{n + 1}{2})dp_{m - 1, n} + \\sum_{i < n} \\binom{n + 2}{i}dp_{m - 1, i}\n$$\n\n\u6700\u540e\u7b54\u6848\u4e3a $\\sum_{i = 0}^{n}\\binom{n}{i}dp_{m, i}$\u3002\n\n\u81ea\u7136\u8003\u8651\u5199\u6210 EGF\uff1a\u8bb0 $F_m(x) = \\sum_{n\\geq 0}\\frac{dp_{m, n}}{n!}x^n$\u3002\n\n\u90a3\u4e48\u8f6c\u79fb\u5f0f\u53ef\u4ee5\u6539\u5199\u6210\u5982\u4e0b\u7684\u5fae\u5206\u65b9\u7a0b\uff1a\n\n$$\nF_m = e^xF_{m - 1} + (2e^x - x - 2)F_{m - 1}' + (e^x - x - 1)F_{m - 1}''\n$$\n\n\u4e4b\u540e\u53ef\u4ee5\u8003\u8651\u5c06 $F_m$ \u5199\u6210 $\\sum_{i = 1}^{m}\\sum_{j = 1}^m f_{m, i, j}x^ie^{jx}$ \u7684\u5f62\u5f0f\uff0c\u8fd9\u6837\u8f6c\u79fb\u7684\u4ee3\u4ef7\u5c31\u964d\u5230\u4e86 $O(m^2)$\u3002\n\n\u6700\u7ec8 $O(m^3)$ \u5f97\u5230 $F_m$ \u540e\u53ea\u9700\u8981\u8003\u8651\u6bcf\u4e00\u9879\u7684\u8d21\u732e\u5373\u53ef $O(m^2)$ \u7b97\u51fa\u7b54\u6848\u3002\n\n---\n\n```cpp\n#include <bits/stdc++.h>\n\ntypedef long long ll;\n\nconst int M = 200;\nconst int N = 8000;\nconst int P = 998244353;\n\ninline int norm(int x) {if (x >= P) x -= P; return x;}\ninline int reduce(int x) {if (x < 0) x += P; return x;}\ninline void add(int &x, int y) {if ((x += y) >= P) x -= P;}\ninline void sub(int &x, int y) {if ((x -= y) < 0) x += P;}\nint mpow(int b, int p) {\n\tint r = 1;\n\tfor (; p; p >>= 1, b = (ll)b * b % P)\n\t\tif (p & 1) r = (ll)r * b % P;\n\treturn r;\n}\n\nint fct[N + 5], ifct[N + 5];\nint binom(int n, int m) {\n\tif (n < m || m < 0) return 0;\n\telse return (ll)fct[n] * ifct[m] % P * ifct[n - m] % P;\n}\nvoid init() {\n\tfct[0] = 1;\n\tfor (int i = 1; i <= N; i++) fct[i] = (ll)fct[i - 1] * i % P;\n\tifct[N] = mpow(fct[N], P - 2);\n\tfor (int i = N; i >= 1; i--) ifct[i - 1] = (ll)ifct[i] * i % P;\n}\n\nint n, m;\nint main() {\n\tinit(), scanf(\"%d%d\", &n, &m);\n/*\n\tstatic int f[N + 5]; f[0] = 1;\n\tfor (int i = 1; i <= m; i++) {\n\t\tstatic int g[N + 5];\n\t\tfor (int i = 0; i <= n; i++)\n\t\t\tg[i] = f[i], f[i] = reduce(0 - (ll)f[i] * i % P);\n\t\tfor (int i = 0; i <= n; i++) for (int j = i; j <= n; j++)\n\t\t\tf[j] = (f[j] + (ll)binom(j + 2, i) * g[i]) % P;\n\t}\n\tint ans = 0;\n\tfor (int i = 0; i <= n; i++)\n\t\tans = (ans + (ll)ifct[n - i] * f[i]) % P;\n\tprintf(\"%lld\\n\", (ll)ans * fct[n] % P);\n*/\n\n// F_{m} = e^xF_{m - 1} + (2e^x - x - 2)F_{m - 1}' + (e^x - x - 1)F_{m - 1}''\n// ans = n![x^n]F_{m}e^x\n\n\tstatic int f[M + 5][M + 5]; f[0][0] = 1; // \\sum f_{i, j}x^{i}e^{jx}\n\tfor (int k = 1; k <= m; k++) {\n\t\tstatic int g[M + 5][M + 5];\n\t\tfor (int i = 0; i < k; i++) for (int j = 0; j < k; j++)\n\t\t\tg[i][j] = f[i][j], f[i][j] = 0;\n\t\t\n\t\tint del = 0;\n\t\tfor (int i = 0; i < k; i++) for (int j = 0; j < k; j++) {\n\t\t\tadd(f[i][j + 1], g[i][j]);\n\n\t\t\tif (i) {\n\t\t\t\tdel = (ll)i * g[i][j] % P;\n\t\t\t\tadd(f[i - 1][j + 1], norm(del << 1));\n\t\t\t\tsub(f[i - 1][j], norm(del << 1));\n\t\t\t\tsub(f[i][j], del);\n\n\t\t\t\tdel = 2ll * i * j * g[i][j] % P;\n\t\t\t\tadd(f[i - 1][j + 1], del);\n\t\t\t\tsub(f[i - 1][j], del);\n\t\t\t\tsub(f[i][j], del);\n\n\t\t\t\tif (i > 1) {\n\t\t\t\t\tdel = (ll)i * (i - 1) * g[i][j] % P;\n\t\t\t\t\tadd(f[i - 2][j + 1], del);\n\t\t\t\t\tsub(f[i - 2][j], del);\n\t\t\t\t\tsub(f[i - 1][j], del);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdel = (ll)j * g[i][j] % P;\n\t\t\tadd(f[i][j + 1], norm(del << 1));\n\t\t\tsub(f[i][j], norm(del << 1));\n\t\t\tsub(f[i + 1][j], del);\n\n\t\t\tdel = (ll)j * j * g[i][j] % P;\n\t\t\tadd(f[i][j + 1], del);\n\t\t\tsub(f[i][j], del);\n\t\t\tsub(f[i + 1][j], del);\n\t\t}\n\t}\n\n\tint ans = 0;\n\tfor (int i = 0; i <= m && i <= n; i++) for (int j = 0; j <= m; j++)\n\t\tans = (ans + (ll)ifct[n - i] * mpow(j + 1, n - i) % P * f[i][j]) % P;\n\tprintf(\"%lld\\n\", (ll)ans * fct[n] % P);\n}\n```",
        "postTime": 1626087873,
        "uid": 41120,
        "name": "Tiw_Air_OAO",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT3872 [AGC021F] Trinity"
    },
    {
        "content": "[Atcoder \u9898\u9762\u4f20\u9001\u95e8](https://atcoder.jp/contests/agc021/tasks/agc021_f) & [\u6d1b\u8c37\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT3872)\n\n\u9996\u5148\u6211\u4eec\u8003\u8651\u8bbe $dp_{i,j}$ \u8868\u793a\u5bf9\u4e8e\u4e00\u4e2a $i\\times j$ \u7684\u7f51\u683c\uff0c\u5176**\u6bcf\u884c\u90fd\u81f3\u5c11\u6709\u4e00\u4e2a\u9ed1\u683c**\u7684\u5408\u6cd5\u7684\u4e09\u5143\u7ec4 $(A,B,C)$ \u7684\u4e2a\u6570\uff0c\u90a3\u4e48\u5bf9\u4e8e\u539f\u6765\u7684 $n\\times m$ \u7684\u7f51\u683c\uff0c\u5982\u679c\u5176\u5b58\u5728\u9ed1\u683c\u7684\u884c\u7684\u96c6\u5408\u4e0d\u540c\uff0c\u90a3\u4e48\u4e09\u5143\u7ec4 $(A,B,C)$ \u80af\u5b9a\u4e0d\u540c\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u6709\u591a\u5c11\u884c\u5b58\u5728\u9ed1\u683c\u6765\u8ba1\u7b97\u7b54\u6848\uff0c\u5373 $ans=\\sum\\limits_{i=0}^n\\dbinom{n}{i}dp_{i,m}$\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u6c42\u51fa $dp_{i,j}$ \u5373\u53ef\u6c42\u51fa\u7b54\u6848\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u600e\u6837\u6c42\u51fa $dp_{i,j}$\uff0c\u9996\u5148\u8fb9\u754c\u6761\u4ef6\u80af\u5b9a\u662f $dp_{i,1}=1$\uff0c\u56e0\u4e3a\u5fc5\u987b\u6bcf\u683c\u90fd\u67d3\u9ed1\u3002\u63a5\u4e0b\u6765\u8003\u8651\u8f6c\u79fb\uff0c\u8f6c\u79fb $dp_{i,j}$ \u65f6\uff0c\u6211\u4eec\u5c31\u679a\u4e3e\u8fd9\u4e2a $i\\times j$ \u7684\u77e9\u9635**\u524d $j-1$ \u5217\u7ec4\u6210\u7684\u5b50\u77e9\u9635\u4e2d\uff0c\u6709\u591a\u5c11\u884c\u5b58\u5728\u9ed1\u683c**\uff0c\u6211\u4eec\u8bb0\u8fd9\u4e2a\u6570\u4e3a $k$\uff0c\u90a3\u4e48\u53ef\u4ee5\u8fd9\u6837\u4ece $dp_{k,j-1}$ \u8f6c\u79fb\u5230 $dp_{i,j}$\uff1a\n\n- \u5982\u679c $k=i$\uff0c\u7531\u4e8e\u8fd9\u4e2a\u60c5\u51b5\u6bd4\u8f83\u7279\u6b8a\uff0c\u6545\u6211\u4eec\u5355\u72ec\u5c06\u5176\u62ce\u51fa\u6765\u3002\u7531\u4e8e\u524d $j-1$ \u5217\u7ec4\u6210\u7684\u5b50\u77e9\u9635\u4e2d\u6bcf\u884c\u90fd\u5b58\u5728\u9ed1\u683c\uff0c\u6545\u6bcf\u884c\u7684 $A_i$ \u90fd\u662f\u4e0d\u4e3a $0$ \u7684\uff0c\u52a0\u5165\u7b2c $j$ \u5217\u540e $A$ \u5e8f\u5217\u80af\u5b9a\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8003\u8651 $B,C$ \u5e8f\u5217\u7684\u53d8\u5316\u5373\u53ef\u3002\u663e\u7136\u6240\u6709\u6ee1\u8db3 $x\\le y$ \u53ef\u80fd\u7684\u4e8c\u5143\u7ec4 $(x,y)$ \u53ca $(i+1,0)$\uff08\u8fd9\u4e00\u5217\u6ca1\u6709\u9ed1\u683c\u7684\u60c5\u51b5\uff09\u90fd\u53ef\u4ee5\u6210\u4e3a\u5408\u6cd5\u7684 $(B_j,C_j)$\uff0c\u603b\u4e2a\u6570\u4e3a $1+j+\\dbinom{j}{2}$\uff0c\u56e0\u6b64\u6211\u4eec\u6709 $dp_{i,j}\\leftarrow dp_{i,j-1}(1+j+\\dbinom{j}{2})$\n- \u5982\u679c $k\\lt i$\uff0c\u90a3\u4e48\u663e\u7136\u4f1a\u51fa\u73b0\u4e00\u4e9b\u672c\u6765\u6ca1\u6709\u9ed1\u683c\u7684\u884c\u51fa\u73b0\u4e86\u9ed1\u683c\uff0c\u5bf9\u4e8e\u8fd9\u4e9b\u884c\u800c\u8a00\uff0c\u5176 $A$ \u503c\u80af\u5b9a\u5c31\u662f $j$\uff0c\u800c\u90a3\u4e9b\u672c\u6765\u5c31\u5b58\u5728\u9ed1\u683c\u7684\u884c\u7684 $A$ \u503c\u80af\u5b9a\u4e0d\u4f1a\u53d8\uff0c\u56e0\u6b64\u6211\u4eec\u8fd8\u662f\u4e0d\u7528\u8003\u8651 $A$ \u503c\u7684\u53d8\u5316\uff0c\u8003\u8651\u54ea\u4e9b\u884c\u65b0\u51fa\u73b0\u4e86\u9ed1\u683c\u53ca \u53ef\u80fd\u7684 $B_j,C_j$ \u5373\u53ef\uff0c\u4e00\u4e2a\u975e\u5e38 naive \u7684\u60f3\u6cd5\u662f\u76f4\u63a5\u7528\u7ec4\u5408\u6570\u8ba1\u7b97\u65b0\u51fa\u73b0\u9ed1\u683c\u7684\u884c\u53ef\u80fd\u7684\u60c5\u51b5\uff0c\u5373 $dp_{i,j}\\leftarrow dp_{k,j-1}\\dbinom{i}{i-k}$\uff0c\u4f46\u662f\u8fd9\u663e\u7136\u662f\u9519\u8bef\u7684\uff0c\u56e0\u4e3a\u5b83\u6ca1\u6709\u8003\u8651\u5230 $B,C$ \u7684\u53d8\u5316\uff0c\u6bd4\u65b9\u8bf4\u5bf9\u4e8e\u4e00\u4e2a $5\\times 2$ \u7684\u77e9\u9635\uff0c\u7b2c\u4e00\u5217 $1,3$ \u4e3a\u9ed1\u683c\uff0c\u7b2c\u4e8c\u5217 $2,4,5$ \u884c\u4e3a\u9ed1\u683c\u7684\u60c5\u51b5\uff0c\u4e0e\u7b2c\u4e00\u5217 $1,3$ \u4e3a\u9ed1\u683c\uff0c\u7b2c\u4e8c\u5217 $1,2,4,5$ \u884c\u4e3a\u9ed1\u683c\u7684\u60c5\u51b5\uff0c\u867d\u7136\u5bf9\u4e8e\u7b2c\u4e8c\u5217\u800c\u8a00\uff0c\u65b0\u591a\u51fa\u9ed1\u683c\u7684\u884c\u7684\u96c6\u5408\u662f\u76f8\u540c\u7684\uff0c\u4f46\u662f\u663e\u7136\u5728\u4e24\u79cd\u60c5\u51b5\u4e2d $B_2$ \u7684\u503c\u662f\u4e0d\u540c\u7684\uff0c\u56e0\u6b64\u5b83\u4eec\u4e5f\u5e94\u88ab\u89c6\u4e3a\u4e0d\u540c\u7684\u60c5\u51b5\u3002\u600e\u4e48\u89e3\u51b3\u5462\uff1f\u6211\u4eec\u8003\u8651\u6700\u4e0a\u65b9\u7684\u9ed1\u683c\u6b63\u4e0a\u65b9\u7684\u767d\u683c\uff0c\u5373 $B_j-1$\uff1b\u4ee5\u53ca\u6700\u4e0b\u65b9\u7684\u9ed1\u683c\u6b63\u4e0b\u65b9\u7684\u767d\u683c\uff0c\u5373 $C_j+1$\uff0c\u8fd9\u4e8c\u8005\u4e0e\u65b0\u591a\u51fa\u7684 $i-k$ \u884c\u4f1a\u5f62\u6210 $i-k+2$ \u4e2a\u6570 $p_1,p_2,\\cdots,p_{i-k+2}$\uff0c\u663e\u7136\u8fd9 $i-k+2$ \u4e2a\u6570\u90fd\u5728 $[0,i+1]$ \u4e2d\uff0c\u5b83\u4eec\u4e24\u4e24\u4e92\u4e0d\u76f8\u540c\uff0c\u4e14 $B_j-1$ \u80af\u5b9a\u662f\u8fd9 $i-k+2$ \u4e2d\u7684\u6700\u5c0f\u503c\uff0c$C_j+1$ \u80af\u5b9a\u662f\u8fd9 $i-k+2$ \u4e2d\u7684\u6700\u5927\u503c\u3002\u53c8\u5bf9\u4e8e\u4e24\u79cd\u7b2c $j$ \u5217\u7684\u67d3\u8272\u65b9\u6848\uff0c\u5b83\u4eec\u88ab\u89c6\u4f5c\u4e0d\u540c\u7684\u67d3\u8272\u65b9\u6848\u5f53\u4e14\u4ec5\u5f53\u8fd9 $i-k+2$ \u4e2a\u6570\u7ec4\u6210\u7684\u96c6\u5408 $\\{p_1,p_2,\\cdots,p_{i-k+2}\\}$ \u4e0d\u540c\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u7edf\u8ba1\u6709\u591a\u5c11\u4e2a\u5408\u6cd5\u7684\u96c6\u5408 $\\{p_1,p_2,\\cdots,p_{i-k+2}\\}$ \u5373\u53ef\uff0c\u8fd9\u4e2a\u65b9\u6848\u6570\u663e\u7136\u662f $\\dbinom{i+2}{i-k+2}$\uff0c\u56e0\u6b64\u6211\u4eec\u6709\u8f6c\u79fb $dp_{i,j}\\leftarrow dp_{k,j-1}\\dbinom{i+2}{i-k+2}$\n\n\u6545\u6211\u4eec\u6709 $dp_{i,j}=dp_{i,j-1}(1+j+\\dbinom{j}{2})+\\sum\\limits_{k=0}^{i-1}dp_{k,j-1}\\dbinom{i+2}{i-k+2}$\uff0c\u8fd9\u6837\u66b4\u529b\u8f6c\u79fb\u662f $\\mathcal O(n^2m)$ \u7684\uff0c\u65e0\u6cd5\u901a\u8fc7\uff0c\u4e0d\u8fc7\u6ce8\u610f\u5230\u540e\u9762\u4e00\u4e2a $\\sum$ \u53ef\u4ee5\u53d8\u5f62\u4e3a $\\sum\\limits_{k=0}^{i-1}dp_{k,j-1}\\dfrac{(i+2)!}{k!(i-k+2)!}=(i+2)!\\sum\\limits_{k=0}^{i-1}\\dfrac{dp_{k,j-1}}{k!}\\dfrac{1}{(i-k+2)!}$\uff0c\u8fd9\u663e\u7136\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u56e0\u6b64 NTT \u4f18\u5316\u5373\u53ef\uff0cTC \u5373\u53ef\u964d\u5230 $\\mathcal O(nm\\log n)$\u3002\n\n```cpp\nconst int MAXN=8000;\nconst int MAXM=200;\nconst int MAXP=1<<14;\nconst int MOD=998244353;\nconst int pr=3;\nconst int ipr=(MOD+1)/3;\nint qpow(int x,int e){\n\tint ret=1;\n\tfor(;e;e>>=1,x=1ll*x*x%MOD) if(e&1) ret=1ll*ret*x%MOD;\n\treturn ret;\n}\nint n,m,dp[MAXN+5][MAXM+5],ans=0;\nint fac[MAXN+5],ifac[MAXN+5];\nvoid init_fac(int n){\n\tfor(int i=(fac[0]=ifac[0]=ifac[1]=1)+1;i<=n;i++) ifac[i]=1ll*ifac[MOD%i]*(MOD-MOD/i)%MOD;\n\tfor(int i=1;i<=n;i++) fac[i]=1ll*fac[i-1]*i%MOD,ifac[i]=1ll*ifac[i-1]*ifac[i]%MOD;\n}\nint binom(int n,int k){return 1ll*fac[n]*ifac[k]%MOD*ifac[n-k]%MOD;}\nint rev[MAXP+5];\nvoid NTT(vector<int> &a,int len,int type){\n\tint lg=31-__builtin_clz(len);\n\tfor(int i=0;i<len;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(lg-1));\n\tfor(int i=0;i<len;i++) if(i<rev[i]) swap(a[i],a[rev[i]]);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tint W=qpow((type<0)?ipr:pr,(MOD-1)/i);\n\t\tfor(int j=0;j<len;j+=i){\n\t\t\tint w=1;\n\t\t\tfor(int k=0;k<(i>>1);k++,w=1ll*w*W%MOD){\n\t\t\t\tint X=a[j+k],Y=1ll*a[(i>>1)+j+k]*w%MOD;\n\t\t\t\ta[j+k]=(X+Y)%MOD;a[(i>>1)+j+k]=(X-Y+MOD)%MOD;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1){\n\t\tint iv=qpow(len,MOD-2);\n\t\tfor(int i=0;i<len;i++) a[i]=1ll*a[i]*iv%MOD;\n\t}\n}\nvector<int> conv(vector<int> a,vector<int> b){\n\tint LEN=1;while(LEN<a.size()+b.size()) LEN<<=1;\n\ta.resize(LEN,0);b.resize(LEN,0);NTT(a,LEN,1);NTT(b,LEN,1);\n\tfor(int i=0;i<LEN;i++) a[i]=1ll*a[i]*b[i]%MOD;\n\tNTT(a,LEN,-1);return a;\n}\nint main(){\n\tscanf(\"%d%d\",&n,&m);init_fac(n+2);\n\tfor(int i=0;i<=n;i++) dp[i][1]=1;\n\tfor(int j=2;j<=m;j++){\n\t\tvector<int> a(n+1),b(n+1);\n\t\tfor(int i=1;i<=n;i++) a[i]=ifac[i+2];\n\t\tfor(int i=0;i<=n;i++) b[i]=1ll*ifac[i]*dp[i][j-1]%MOD;\n\t\ta=conv(a,b);\n\t\tfor(int i=0;i<=n;i++){\n\t\t\tdp[i][j]=1ll*(1+i+binom(i,2))*dp[i][j-1]%MOD;\n\t\t\tdp[i][j]=(dp[i][j]+1ll*fac[i+2]*a[i])%MOD;\n\t\t}\n\t} for(int i=0;i<=n;i++) ans=(ans+1ll*binom(n,i)*dp[i][m])%MOD;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1620204282,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 AT3872 [AGC021F] Trinity"
    },
    {
        "content": "\u6807\u7b7e: DP, FFT.\n\n\u4ee4 $f[i][j]$ \u4e3a\u5f3a\u5236**\u6bcf\u884c**\u90fd\u6709\u9ed1\u683c\u5b50\u7684 $i$ \u884c $j$ \u5217\u77e9\u9635\u7684\u65b9\u6848\u6570, \u90a3\u4e48\u7b54\u6848\u4e3a $\\sum_{i=1}^n{n\\choose i}f[i][m]$. \n\n\u8003\u8651\u65b0\u589e\u4e00\u5217,  \u5982\u4f55\u8f6c\u79fb\u5230 $f[i + k][j + 1]$. \u8fd9\u91cc\u9700\u8981\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba:\n\n- \u82e5 $k = 0$, \u90a3\u4e48\u76f8\u5f53\u4e8e\u5728\u7b2c $j + 1$ \u5217\u9009 $0, 1, 2$ \u4e2a\u7aef\u70b9, \u6240\u4ee5\u8d21\u732e\u7cfb\u6570\u4e3a $1 + i + {i\\choose 2}$ \n- \u82e5 $k>0$, \u90a3\u4e48\u5728\u63d2\u5165\u65b0\u589e\u7684 $k$ \u884c\u540e\uff0c$b_{j+1}$ \u53ef\u80fd\u662f\u8fd9 $k$ \u4e2a\u4e2d\u7684\u6700\u5c0f\u503c, \u4e5f\u53ef\u80fd\u662f\u539f\u6709\u7684\u67d0\u4e00\u884c, $c_{j+1}$ \u540c\u7406, \u8fd9\u4e2a\u4f3c\u4e4e\u4e0d\u662f\u5f88\u597d\u5904\u7406. \u4f46 $b_{j+1}$ \u4e0d\u540c\u7b49\u4ef7\u4e8e $b_{j+1}-1$ \u4e0d\u540c, \u6240\u4ee5\u6211\u4eec\u6c42 $b_{j+1}-1,c_{j+1}+1$ \u4e0d\u540c\u7684\u65b9\u6848\u5c31\u597d\u4e86. \u7531\u4e8e $b_{j+1}-1,c_{j+1}+1$ \u5fc5\u5b9a\u662f\u767d\u8272, \u6545\u4e0d\u4f1a\u548c\u65b0\u589e\u7684 $k$ \u884c\u91cd\u5408. \u8d21\u732e\u7cfb\u6570\u4e3a $i+k+2\\choose k+2$ , \u5176\u610f\u4e49\u662f\u5728 $i+k+2$ \u5217\u4e2d(\u6ce8\u610f $b_{j+1}-1,c_{j+1}+1$ \u7684\u53d6\u503c\u8303\u56f4) \u53d6\u51fa\u4e92\u4e0d\u76f8\u540c\u7684 $k+2$ \u5217, \u5176\u4e2d\u7b2c $1$ \u5217\u548c\u7b2c $k+2$ \u5217(\u6700\u540e\u4e00\u5217)\u5206\u522b\u89c6\u4e3a $b_{j+1}-1,c_{j+1}+1$ , \u4e2d\u95f4 $k$ \u5217\u4e3a\u65b0\u589e\u7684 $k$ \u5217.\n\n\u7efc\u4e0a, $f[i][j]=(1+i+{i\\choose 2})f[i][j-1]+\\sum_{k<i}{i+2\\choose k}f[k][j-1]$ , \u8f6c\u79fb\u5f0f\u53f3\u8fb9\u7684\u5de6\u534a\u90e8\u5206\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97, \u53f3\u534a\u90e8\u5206\u663e\u7136\u662f\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f, \u53ef\u4ee5\u5229\u7528 FFT \u4f18\u5316.\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(nm\\log n)$.\n\n```cpp\n#include <bits/stdc++.h>\n#define mod 998244353\nusing namespace std;\n\nint read();\nint M(int x) { return x >= mod ? x - mod : x; }\nint fsp(int bs, int p) {\n    int rt = 1;\n    while (p) {\n        if (p & 1) rt = 1ll * rt * bs % mod;\n        bs = 1ll * bs * bs % mod, p >>= 1;\n    }\n    return rt;\n}\nint C2(int x) { return x * (x - 1) / 2; }\nint fac[10004], caf[10004];\nint C(int x, int y) { return 1ll * fac[x] * caf[y] % mod * caf[x - y] % mod; }\nvoid init() {\n    int lim = 10000;\n    fac[0] = 1;\n    for (int i = 1; i <= lim; ++i) fac[i] = 1ll * fac[i - 1] * i % mod;\n    caf[lim] = fsp(fac[lim], mod - 2);\n    for (int i = lim; i >= 1; --i) caf[i - 1] = 1ll * caf[i] * i % mod;\n}\n\nint rtt[20004], O[20004], ny;\nvoid getrtt(int w, int len) {\n    for (int i = 1; i < len; ++i) rtt[i] = rtt[i >> 1] >> 1 | ((i & 1) << w);\n    for (int l = 2; l <= len; l <<= 1) O[l] = fsp(3, (mod - 1) / l);\n    ny = fsp(len, mod - 2);\n}\n\nstruct Poly {\n    int x[20004];\n    int &operator[](int p) { return x[p]; }\n    void ntt(int len) {\n        for (int i = 1; i < len; ++i)\n            if (rtt[i] > i) swap(x[rtt[i]], x[i]);\n        for (int l = 2; l <= len; l <<= 1) {\n            for (int i = 0, m = l >> 1; i < len; i += l) {\n                for (int j = i, tO = 1, t; j < i + m; ++j) {\n                    t = 1ll * tO * x[j + m] % mod, tO = 1ll * tO * O[l] % mod;\n                    x[j + m] = M(x[j] - t + mod), x[j] = M(x[j] + t);\n                }\n            }\n        }\n    }\n    void idft(int len) {\n        ntt(len), reverse(x + 1, x + len);\n        for (int i = 0; i < len; ++i) x[i] = 1ll * x[i] * ny % mod;\n    }\n} f, g, tf;\n\nint n, m;\nint main() {\n    n = read(), m = read();\n    init();\n    int w = 1, len = 2;\n    while (len < 2 * n + 1) len <<= 1, ++w;\n    for (int i = 1; i <= n; ++i) g[i] = caf[i + 2];\n    getrtt(w - 1, len), g.ntt(len);\n    tf[0] = f[0] = 1;\n    for (int i = 1; i <= m; ++i) {\n        f.ntt(len);\n        for (int j = 0; j < len; ++j) f[j] = 1ll * f[j] * g[j] % mod;\n        f.idft(len);\n        for (int j = 0; j <= n; ++j) {\n            tf[j] = M(1ll * f[j] * fac[j + 2] % mod +\n                      1ll * tf[j] * (1 + j + C2(j)) % mod);\n            f[j] = 1ll * tf[j] * caf[j] % mod;\n        }\n        for (int j = n + 1; j < len; ++j) f[j] = 0;\n    }\n    int res = 0;\n    for (int i = 0; i <= n; ++i) res = M(res + 1ll * C(n, i) * tf[i] % mod);\n    printf(\"%d\\n\", res);\n    return 0;\n}\n\nint read() {\n    int x = 0, f = 1;\n    char c = getchar();\n    while (c < '0' || c > '9') f = (c == '-') ? -1 : f, c = getchar();\n    while (c >= '0' && c <= '9') x = x * 10 + c - '0', c = getchar();\n    return x * f;\n}\n```\n\n",
        "postTime": 1581949500,
        "uid": 51237,
        "name": "Kinandra",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT3872 \u3010[AGC021F] Trinity\u3011"
    },
    {
        "content": "\u89c2\u5bdf\u9898\u610f\uff0c\u80af\u5b9a\u662f\u4ece $A$ \u5165\u624b\u3002\u53d1\u73b0\uff0c$A$ \u7684\u4f5c\u7528\u5176\u5b9e\u5c31\u662f\u9650\u5236\u6bcf\u4e00\u884c\u5f3a\u5236\u9009 $A_i$ \u7684\u4f4d\u7f6e\uff0c\u4e14\u53ef\u4ee5\u9009 $A_i$ \u5f80\u540e\u7684\u4f4d\u7f6e\u3002\u90a3\u4e48\u6211\u4eec\u4ece\u5de6\u5f80\u53f3\u8003\u8651\uff0c\u6bcf\u6b21\u786e\u5b9a\u82e5\u5e72\u4e2a $A_i$ \u653e\u8fd9\u4e00\u5217\u3002\u8fd9\u65f6\u5019\u6839\u636e\u653e\u7684\u4f4d\u7f6e\u4e0e\u4e4b\u524d\u786e\u5b9a\u7684\u884c\u7684\u6570\u91cf\uff0c\u662f\u53ef\u4ee5\u8ba1\u7b97\u51fa\u5f53\u524d\u8fd9\u4e00\u5217\u653e\u7684\u6700\u5927\u503c\u4e0e\u6700\u5c0f\u503c\u7684\u65b9\u6848\u6570\u7684\u3002\n\n\u5047\u5982\u6211\u4eec\u5f53\u524d\u5728\u7b2c $k$ \u5217\uff0c\u8fd9\u4e00\u5217\u4e4b\u524d\u5df2\u7ecf\u786e\u5b9a\u4e86 $i$ \u884c\u3002\n\n\u90a3\u4e48\u5982\u679c\u8fd9\u4e00\u5217\u4e0d\u653e\uff0c\u90a3\u4e48\u8fd9 $i$ \u884c\u53ef\u4ee5\u968f\u4fbf\u9009\uff0c\u65b9\u6848\u6570\u4e3a $\\binom{i+1}{2} + 1$\uff08\u8fd8\u6709\u4e00\u4e2a\u4e0d\u9009\u7684\u65b9\u6848\u6570\uff09\u3002\n\n\u5982\u679c\u8fd9\u4e00\u5217\u653e\uff0c\u679a\u4e3e\u653e\u4e86 $j$ \u884c\uff0c\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u76f8\u5f53\u4e8e\u6709\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff1a\u6709 $i$ \u4e2a\u767d\u7403\u4e0e $j$ \u4e2a\u9ed1\u7403\u968f\u673a\u6392\u5217\uff0c\u5e76\u4e14\u8981\u5728\u6700\u5de6\u8fb9\u7684\u9ed1\u7403\u5f80\u5de6\u9009 $0/1$ \u4e2a\u767d\u7403\u67d3\u6210\u9ed1\u8272\uff0c\u5c06\u6700\u53f3\u8fb9\u7684\u9ed1\u7403\u5f80\u53f3\u9009 $0/1$ \u4e2a\u767d\u7403\u67d3\u79f0\u9ed1\u8272\uff0c\u6c42\u65b9\u6848\u6570\u3002\u6211\u4eec\u5728\u5de6\u53f3\u518d\u52a0\u4e00\u4e2a\u767d\u7403\uff0c\u5c31\u53d8\u6210\u6070\u597d\u67d3\u4e00\u4e2a\u4e86\uff0c\u8fd9\u76f8\u5f53\u4e8e\u5c06 $i$ \u4e2a\u767d\u7403\u4e2d\u63d2\u5165 $j + 2$ \u4e2a\u9ed1\u7403\uff0c\u65b9\u6848\u6570\u4e3a $\\binom{i + j + 2}{j + 2}$\u3002\uff08\u7528\u7ec8\u6b62\u72b6\u6001\u63a8\u8d77\u59cb\u72b6\u6001\uff09\n\n\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5 DP \u4e86\uff0c\u8bbe $f_{i, k}$ \u8868\u793a $k$ \u5217\u786e\u5b9a $i$ \u884c\u7684\u65b9\u6848\u6570\uff0c\u8f6c\u79fb\u5f0f\u5b50 $f_{i, k} \\times \\binom{i + j + 2}{j + 2} \\to f_{i + j, k + 1}$\uff0c\u53ef\u4ee5\u62c6\u6210\u5377\u79ef\u5f62\u5f0f\u4f18\u5316\uff0c\u590d\u6742\u5ea6 $O(nm \\log n)$\u3002\n\n```cpp\nint f[MAXN][MAXN];\nint main() {\n    scanf(\"%d%d\", &n, &m);\n    init(10000);\n    f[0][0] = 1;\n    for (int i = 1; i <= m; i++) {\n        Polynomial a(n), b(n);\n        for (int j = 0; j <= n; j++) {\n            a[j] = 1ll * f[i - 1][j] * inv[j] % P;\n            b[j] = (j != 0) * inv[j + 2];\n        }\n        a = a * b;\n        for (int j = 0; j <= n; j++) {\n            f[i][j] = 1ll * a[j] * fac[j + 2] % P;\n            f[i][j] = (f[i][j] + 1ll * f[i - 1][j] * (1ll * j * (j + 1) / 2 % P + 1)) % P;\n        }\n    }\n    int ans = 0;\n    for (int i = 0; i <= n; i++) {\n        ans = (ans + 1ll * C(n, i) * f[m][i]) % P;\n    }\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```",
        "postTime": 1684843629,
        "uid": 279652,
        "name": "APJifengc",
        "ccfLevel": 9,
        "title": "\u300c\u89e3\u9898\u62a5\u544a\u300dAGC021F Trinity"
    },
    {
        "content": "## Tag\n\n\u52a8\u6001\u89c4\u5212\uff0cNTT\u3002\n\n## Preface\n\n~~\u88ab\u8feb\u8425\u4e1a\u3002~~\n\n## Description\n\n\u5728\u4e00\u4e2a $n\\times m$ \u7684\u9ed1\u767d\u683c\u4e2d\uff0c\u8bbe\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217 $A$\uff0c\u957f\u5ea6\u4e3a $m$ \u7684\u6570\u5217 $B$ \u548c $C$\uff0c\u5206\u522b\u8868\u793a\u4e00\u4e0b\u89c4\u5219\uff1a\n\n* $A_i$ \u8868\u793a\u7b2c $i$ \u884c\u7b2c\u4e00\u4e2a\u51fa\u73b0\u7684\u9ed1\u683c\u5b50\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u6ca1\u6709\u9ed1\u683c\u5b50\u5219\u4e3a $m+1$\u3002\n* $B_i$ \u8868\u793a\u7b2c $i$ \u5217\u7b2c\u4e00\u4e2a\u51fa\u73b0\u7684\u9ed1\u683c\u5b50\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u6ca1\u6709\u9ed1\u683c\u5b50\u5219\u4e3a $n+1$\u3002\n* $C_i$ \u8868\u793a\u7b2c $i$ \u5217\u6700\u540e\u4e00\u4e2a\u51fa\u73b0\u9ed1\u683c\u5b50\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u6ca1\u6709\u9ed1\u683c\u5b50\u5219\u4e3a $0$\u3002\n\n\u6c42\u6700\u540e\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684 $(A,B,C)$ \u4e09\u5143\u7ec4\u3002\n\n$\\texttt{data range:} n\\leq 8\\times 10^3,m\\leq 200$\u3002\n\n## Solution\n\n\u4e0d\u96be\u60f3\u5230\uff0c\u5982\u679c\u6211\u4eec\u9650\u5b9a\u53ea\u6709 $k$ \u884c\u6709\u9ed1\u8272\u683c\u5b50\u51fa\u73b0\uff0c\u663e\u7136\u8fd9 $k$ \u884c\u5728\u4efb\u610f\u4f4d\u7f6e\u90fd\u53ef\u4ee5\uff0c\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5bf9\u4e8e\u6700\u540e\u7684\u65b9\u6848\u6570\u6211\u4eec\u53ea\u7528\u4e58\u4e0a\u4e00\u4e2a\u7ec4\u5408\u6570\u5c31\u53ef\u4ee5\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u73b0\u5728\u53ea\u8003\u8651\u6709 $k$ \u884c\u6709\u9ed1\u683c\u5b50\u7684\u60c5\u51b5\u3002\n\n\u663e\u7136\u53ef\u4ee5\u8bbe\u8ba1 dp \u6765\u8ba1\u6570\u8fd9\u4e2a\u8fc7\u7a0b\u3002\u6211\u4eec\u8bbe $f_{i,j}$ \u8868\u793a\u6709 $i$ \u884c\uff0c\u8003\u8651\u5230\u7b2c $j$ \u5217\u7684\u60c5\u51b5\u6570\u3002\n\n\u4e00\u4e2a\u6bd4\u8f83\u663e\u7136\u7684\u8f6c\u79fb\u5c31\u662f\uff1a\n$$\nf_{i,j} \\xrightarrow{1+i+\\binom{i}{2}} f_{i,j+1}\n$$\n\u8868\u793a\u7684\u662f\uff0c\u8981\u4e48\u4e0d\u53d6\uff0c\u8981\u4e48\u53d6\u4e00\u4e2a\uff0c\u8981\u4e48\u53d6\u4e24\u4e2a\uff0c\u7531\u4e8e\u6211\u4eec\u8ba1\u6570\u7684\u662f $(A,B,C)$ \u7684\u60c5\u51b5\u6570\uff0c\u6240\u4ee5\u4e0d\u7528\u8003\u8651\u4e2d\u95f4\u662f\u4ec0\u4e48\u60c5\u51b5\u3002\n\n\u4f46\u662f\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u9700\u8981\u597d\u597d\u601d\u8003\u4e00\u4e0b\u600e\u4e48\u4ece\u67d0\u4e00\u884c\u8f6c\u79fb\u8fc7\u6765\u3002\n\n\u6211\u4eec\u8ba8\u8bba\uff0c\u5982\u4f55\u4ece $f_{k,j}\\to f_{i,j+1}$\uff0c\u5176\u4e2d $k < i$\u3002\n\n\u6211\u4eec\u9700\u8981\u6ce8\u610f\uff0c\u6211\u4eec\u4e0d\u662f\u5f80\u67d0\u4e00\u884c\u540e\u9762\u52a0\u67d0\u4e2a\u6570\uff0c\u800c\u662f\u4ece\u4e2d\u95f4\u63d2\u5165\u82e5\u5e72\u7684\u6570\uff0c\u7531\u4e8e\u6211\u4eec\u662f\u6839\u636e\u5c42\u9012\u63a8\u7684\uff0c\u6240\u4ee5\u6b64\u65f6\u63d2\u5165\u7684 $A$ \u7684\u503c\u5e94\u8be5\u4e3a $j+1$\uff0c\u7136\u540e\u6211\u4eec\u9700\u8981\u679a\u4e3e\u8981\u4ece\u591a\u5c11\u884c\u9012\u63a8\u8fc7\u6765\u7684\u3002\n\n\u6211\u4eec\u63a5\u4e0b\u6765\u9700\u8981\u8003\u8651\u7684\u662f $B$ \u548c $C$ \u7684\u60c5\u51b5\uff0c\u8fd9\u91cc\u7684\u8003\u8651\u4e5f\u5c06\u662f\u8fd9\u4e2a\u9898\u552f\u4e00\u7684\u96be\u70b9\u6240\u5728\u3002\n\n\u770b\u8d77\u6765\u8fd9\u91cc\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u4e00\u4e2a\u7ec4\u5408\u6570\u7684\u679a\u4e3e\uff0c\u5c31\u662f\uff1a\n$$\nf_{k,j-1} \\xrightarrow{\\binom{i}{k}}f_{i,j}\n$$\n\u8fd9\u6837\u662f\u4f1a\u6570\u6f0f\u7684\uff0c\u56e0\u4e3a\u6b64\u65f6\u6211\u4eec\u53ea\u8003\u8651\u4e86\u63d2\u5165\u7684\u60c5\u51b5\uff0c\u4f46\u662f\u6211\u4eec\u538b\u6839\u5c31\u6ca1\u6709\u8003\u8651\u5230\u5982\u679c\u8bf4\u6211\u4eec\u63d2\u5165\u7684\u8fd9\u4e00\u884c\u4e0e\u4e4b\u524d\u7684\u67d0\u4e00\u5217\u91cd\u5408\u4e86\u5c31\u4f1a\u5f88\u5c34\u5c2c\uff0c\u4e0b\u9762\u8bbe\u9ed1\u8272\u4e3a $1$\uff0c\u767d\u8272\u4e3a $0$\u3002\n\n```\n10\n01\n01\n10\n01\n```\n\n\u8fd9\u6837\u662f\u6211\u4eec\u63d2\u5165\u7684\u4e00\u79cd\u60c5\u51b5\uff0c\u95ee\u9898\u6765\u4e86\u3002\n\n```\n11\n01\n01\n10\n01\n```\n\n\u8fd9\u79cd\u60c5\u51b5\u662f\u548c\u4e0a\u9762\u7684\u60c5\u51b5\u5728\u6211\u4eec\u7684\u7ec4\u5408\u6570\u4e2d\u662f\u540c\u4e00\u79cd\u60c5\u51b5\uff0c\u4f46\u662f\u53c8\u4e0d\u540c\u7684\u8868\u73b0\uff0c\u6240\u4ee5\u6211\u4eec\u80af\u5b9a\u4e0d\u80fd\u5355\u7eaf\u7684\u53ea\u9009\u51fa $k$ \u4e2a\u6765\u8fdb\u884c\u63d2\u5165\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u8003\u8651\u539f\u6709\u7684\u9ed1\u8272\u7684\u60c5\u51b5\u3002\n\n\u6240\u4ee5\u6211\u4eec\u9700\u8981\u8003\u8651 $B_i$ \u4e0a\u9762\u7684\u767d\u8272\u683c\u5b50\u7684\u4f4d\u7f6e\u4ee5\u53ca $C_i$ \u4e0b\u9762\u7684\u767d\u8272\u683c\u5b50\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5b50\u7684\u8bdd\u5c31\u4e0d\u4f1a\u6570\u6f0f\u4e86\uff0c\u56e0\u4e3a\u4e00\u5b9a\u4f1a\u5b58\u5728\u8fd9\u4e24\u4e2a\u4f4d\u7f6e\uff0c\u6240\u4ee5\u7528\u6765\u8f6c\u79fb\u7684\u7ec4\u5408\u6570\u5c31\u662f $\\dbinom{i+2}{i-k+2}$\uff0c\u4e5f\u5c31\u662f\u591a\u53d6\u4e86\u4e24\u4e2a\u3002\n\n\u7136\u540e\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u6700\u7ec8\u7684\u5f0f\u5b50\uff1a\n$$\nf_{i,j} = (1+i+\\dbinom{i}{2})f_{i,j-1}+\\sum_{k<i} \\dbinom{i+2}{i-k+2}f_{k,j}\n$$\n\u72b6\u6001\u6570 $O(nm)$\uff0c\u8f6c\u79fb $O(n)$\uff0c\u6211\u4eec\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2m)$\uff0c\u663e\u7136\u8fc7\u4e0d\u53bb\uff0c\u4f46\u662f\u8003\u8651\u5230\u540e\u9762\u662f\u4e2a\u7ec4\u5408\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u5f88\u5bb9\u6613\u5c31\u80fd\u60f3\u51fa\u7528 NTT \u4f18\u5316\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u505a\u5230\u4e86\u65f6\u95f4\u590d\u6742\u5ea6 $O(nm\\lg n)$ \u548c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(nm)$\u3002\n\n## Code\n\n```cpp\nconst int N = 8e3 + 10;\nconst int M = 2e2 + 10;\nconst int mod = 998244353, g = 3;;\nusing poly = vector<int>;\nusing ll = long long;\n\ninline void chk(int &x) {x -= mod; x += x >> 31 & mod;}\ninline int mll(int x, int y) {return (ll) x * y % mod;}\ninline int add(int x, int y) {chk(x += y); return x ;}\ninline int del(int x, int y) {return add(x, mod - y);}\n\ninline int ksm(int x, int y) {\n    int ret = 1;\n    for(; y; y >>= 1, x = mll(x, x))\n        if(y & 1) ret = mll(ret, x);\n    return ret;\n}\n\nostream &operator << (ostream &ou, const poly F) {\n    FOR(i, 0, F.size() - 1) ou << F[i] << ' ';\n    return ou;\n}\n\n\nint fc[N + M], fv[N + M], inv[N + M]; \ninline void pref(const int lim) {\n    fc[0] = 1;\n    FOR(i, 1, lim) fc[i] = mll(fc[i - 1], i);\n    fv[lim] = ksm(fc[lim], mod - 2);\n    ROF(i, lim, 1) fv[i - 1] = mll(fv[i], i);\n    FOR(i, 1, lim) inv[i] = mll(fv[i], fc[i - 1]);\n    return ;\n}\n\nint C(int n, int m) {\n    if(n < m) return 0;\n    return mll(fc[n], mll(fv[m], fv[n - m]));\n}\n\nint rev[N << 2];\ninline int getrev(const int n) {\n    int len = 1, tim = -1;\n    while(len < n) len <<= 1, tim++;\n    FOR(i, 0, len - 1) rev[i] = rev[i >> 1] >> 1 | ((i & 1) << tim);\n    return len;\n}\n\nvoid DFT(poly &F, int n) {\n    F.resize(n);\n    FOR(i, 0, n - 1) if(i < rev[i]) swap(F[i], F[rev[i]]);\n    for(int i = 1; i < n; i <<= 1) {\n        int gn = ksm(g, (mod - 1) / (i << 1));\n        for(int j = 0, g0 = 1, x, y; j < n; j += (i << 1), g0 = 1)\n        for(int k = 0; k < i; k++, g0 = mll(gn, g0)) {\n            x = F[j + k], y = mll(F[i + j + k], g0);\n            F[j + k] = add(x, y);\n            F[i + j + k] = del(x, y);\n        }\n    }\n}\nvoid IDFT(poly &F, int n) {\n    DFT(F, n), reverse(F.begin() + 1, F.end());\n    int iv = ksm(n, mod - 2);\n    FOR(i, 0, n - 1) F[i] = mll(F[i], iv);\n}\n\npoly operator * (poly A, poly B) {\n    int n = A.size() + B.size() - 1, len = getrev(n);\n    DFT(A, len), DFT(B, len);\n    FOR(i, 0, len - 1) A[i] = mll(A[i], B[i]);\n    return IDFT(A, len), A.resize(n), A;\n}\n\nint dp[2][N];\n\ninline void solve() {\n    int n, m;\n    cin >> n >> m;\n    pref(n + m);\n    FOR(i, 0, n) dp[1][i] = 1;\n    FOR(j, 2, m) {\n        int op = j & 1;\n        poly F(n + 1), G(n + 1);\n        FOR(i, 1, n) F[i] = fv[i + 2];\n//        dbg(F);\n        FOR(i, 0, n) G[i] = mll(dp[op ^ 1][i], fv[i]);\n//        dbg(G);\n        F = F * G;\n//        dbg(F);\n        FOR(i, 0, n) {\n            dp[op][i] = mll(add(1 + i, C(i, 2)), dp[op ^ 1][i]);\n            chk(dp[op][i] += mll(fc[i + 2], F[i]));\n        }\n    }\n    int ans = 0;\n    FOR(i, 0, n) chk(ans += mll(C(n, i), dp[m & 1][i]));\n    cout << ans << '\\n';\n    return ;\n}\n```\n\n",
        "postTime": 1641995514,
        "uid": 366935,
        "name": "KAMIYA_KINA",
        "ccfLevel": 7,
        "title": "AT3872 [AGC021F] Trinity \u9898\u89e3"
    },
    {
        "content": "~~\u81ea\u5df1\u641e\u51fa\u4e86\u4e00\u4e2a AGC F\uff0c\u771f\u4e0d\u5bb9\u6613~~\n\n~~\u867d\u7136\u6bd4\u8f83\u6c34~~\n\n\u8003\u8651 $\\max A_i$\u3002\u82e5\u4e3a $M+1$\uff0c\u5219\u5b58\u5728\u4e00\u4e9b\u884c\u662f\u7a7a\u7684\u3002\u53ef\u4ee5\u679a\u4e3e\u8fd9\u4e9b\u884c\uff0c\u8fd9\u4e00\u90e8\u5206\u6bd4\u8f83\u597d\u5904\u7406\u8fc7\u4f1a\u518d\u8bf4\u3002\n\n\u82e5\u4e0d\u4e3a $M+1$\uff0c\u5219\u679a\u4e3e $v=n-\\max A_i+1$\uff0c\u90a3\u5c31\u662f\u8bf4\u4ece\u53f3\u6570\u524d $v-1$ \u5217\u53ef\u4ee5\u4efb\u610f\u53d6\uff0c\u7b2c $v$ \u5217\u6709\u4e00\u4e9b\u9ed1\u683c\uff0c\u8bbe\u5b83\u4eec\u6240\u5728\u884c $x_{1\\cdots k}$\uff0c\u90a3\u4e48\u7b2c $v$ \u5217\u4ee5\u540e\u7684\u5217\u4e0d\u53ef\u4ee5\u6709\u9ed1\u683c\u5728 $x_{1\\cdots k}$ \u884c\u4e0a\u3002\u90a3\u4e48\u6211\u4eec\u5904\u7406\u7b2c $v$ \u5217\u4ee5\u540e\u7684\u5217\u65f6\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u628a\u8fd9 $k$ \u884c\u5220\u6389\uff0c\u8fd9\u662f\u7b49\u4ef7\u7684\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u8003\u8651 DP\uff0c\u4ee4 $f(m,n)$ \u8868\u793a $n$ \u884c $m$ \u5217\u8981\u6c42\u6bcf\u884c\u90fd\u975e\u7a7a\u7684\u65b9\u6848\u6570\uff0c\u5219\n\n$$ f(m,n)=\\sum_{v=1}^m \\left(\\frac{n(n+1)}{2}+1\\right)^{v-1} \\sum_{k=1}^n \\binom{n+2}{k+2} f(m-v,n-k) $$\n\n\uff08\u7b54\u6848\u4e3a $\\sum_{k=0}^n \\binom{n}{k}f(m,k)$\uff09\n\n\u5176\u4e2d $k$ \u662f\u7b2c $v$ \u5217\u7684\u9ed1\u683c\u6570\uff0c$\\binom{n+2}{k+2}$ \u662f\u9009\u51fa\u7b2c $v$ \u5217\u7684\u9ed1\u683c\u5e76\u786e\u5b9a $B_v,C_v$ \u7684\u65b9\u6848\u6570\uff0c\u5b83\u7684\u7b97\u6cd5\u5c31\u662f\u5bf9\u4e8e $B_v,C_v$ \u5c06\u5b83\u4eec\u4e5f\u770b\u505a\u7279\u6b8a\u7684\u9ed1\u683c\uff0c\u4f46\u7531\u4e8e\u5b83\u4eec\u53ef\u4ee5\u4e0e\u9009\u51fa\u7684\u9ed1\u683c\u91cd\u5408\u6240\u4ee5\u5c06 $B_v$ \u51cf 1\uff0c$C_v$ \u52a0 1\uff0c\u90a3\u4e48\u5c31\u662f $n+2$ \u4e2a\u91cc\u9009 $k+2$ \u4e2a\u3002\n\n\u4ee4 $F(m,n)=\\sum_{k=1}^n \\binom{n+2}{k+2}f(m,k)$\uff0c\u5bf9\u4e8e\u76f8\u540c\u7684 $m$ \u5b83\u53ef\u4ee5\u7531\u4e00\u904d\u5377\u79ef\u5f97\u51fa\u3002\u5bf9\u4e8e\u9012\u63a8\u5f0f $f(m,n)=\\sum_{v=1}^m (\\frac{n(n+1)}{2}+1)^{v-1} F(m-v,n)$\uff0c\u53ef\u4ee5\u5316\u4e3a\n\n$$f(m,n)=(\\frac{n(n+1)}{2}+1)^{m-1}\\sum_{v=1}^m \\frac{F(m-v,n)}{(\\frac{n(n+1)}{2}+1)^v}$$\n\n\u8fd9\u91cc\u5c31\u53ef\u4ee5\u5bf9\u4e8e\u76f8\u540c\u7684 $n$ \u7528\u524d\u7f00\u548c\u4f18\u5316\uff0c\u6240\u4ee5\u6700\u540e\u7684\u603b\u590d\u6742\u5ea6\u4e3a $O(mn\\log n)$\u3002",
        "postTime": 1623830304,
        "uid": 62308,
        "name": "Mr_Wu",
        "ccfLevel": 10,
        "title": "[AGC021F] Trinity"
    },
    {
        "content": "\u611f\u89c9\u9898\u89e3\u7684 $f_{i,j}$ \u7684\u5b9a\u4e49\u548c\u8f6c\u79fb\u90fd\u4e0d\u662f\u7279\u522b\u6e05\u695a\uff1f\u5bfc\u81f4\u6211\u5f00\u59cb\u90fd\u6ca1\u8bfb\u61c2\u3002\u3002\u3002~~\u8981\u4e0d\u5c31\u662f\u6211\u7406\u89e3\u9519\u4e86~~\n\n\u6211\u4eec\u6309\u5217\u8fdb\u884c DP\uff0c$f_{j,i}$ \u8868\u793a\u5f53\u524d DP \u5230\u7b2c $j$ \u5217\uff0c\u524d $j$ \u5217\u9009\u51fa\u7684\u9ed1\u683c\u5b50\u5728\u884c\u4e0a\u7684\u5e76\u96c6\u5927\u5c0f\u4e3a $i$ \u7684\u4e09\u5143\u7ec4\u65b9\u6848\u3002\n\n\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u8bbe\uff1f\u56e0\u4e3a\u884c\u5bf9\u7b54\u6848\u4e09\u5143\u7ec4\u7684\u8d21\u732e\u53ea\u6709\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u6709\u5f71\u54cd\uff0c\u6211\u4eec\u65b0\u589e\u4e00\u5217\uff0c\u524d\u9762\u5217\u5bf9\u5f53\u524d\u7684\u5f71\u54cd\u663e\u7136\u53ea\u8ddf\u5e76\u96c6\u7684\u5927\u5c0f\u6709\u5173\u3002\n\n\u8f6c\u79fb\u8003\u8651\u65b0\u589e\u4e00\u5217\u591a\u51fa\u4e86\u51e0\u884c\uff0c\u679a\u4e3e\u65b0\u589e\u4e86 $k$ \u884c\u3002\n\n- \u82e5 $k=0$\uff0c\u5373\u6ca1\u6709\u65b0\u589e\u884c\uff0c\u90a3\u4e48\u65b0\u589e\u7684\u9ed1\u8272\u90fd\u5728\u5e76\u96c6\u5185\uff0c\u518d\u8003\u8651\u5f53\u524d\u5217\u6700\u4e0b\u548c\u6700\u4e0a\u7684\u9ed1\u8272\uff1a\n\n  - \u5982\u679c\u76f4\u63a5\u6ca1\u6709\uff0c\u6709 1 \u7684\u8d21\u732e\u3002\n  \n  - \u5982\u679c\u6700\u4e0a\u7684\u4f4d\u7f6e\u4e0e\u6700\u4e0b\u7684\u4f4d\u7f6e\u76f8\u540c\uff0c\u90a3\u4e48\u53ea\u6709\u4e00\u4e2a\u9ed1\u8272\u683c\u5b50\uff0c\u51fa\u73b0\u5728 $i$ \u884c\u4e2d\u4efb\u610f\u4e00\u884c\u90fd\u884c\uff0c\u8d21\u732e\u4e3a $i$\u3002\n  \n  - \u5982\u679c\u4e0d\u540c\uff0c\u4ece $i$ \u884c\u4e2d\u9009\u4e24\u884c\uff0c\u4e0a\u9762\u4f5c\u4e3a\u6700\u4e0a\u7684\u9ed1\u8272\uff0c\u4e0b\u9762\u4f5c\u4e3a\u6700\u4e0b\u7684\u9ed1\u8272\uff0c\u8d21\u732e\u4e3a $\\tbinom{i}{2}$\n  \n- \u82e5 $k>0$\uff0c\u5373\u65b0\u589e\u4e86 $k$ \u884c\uff0c\u7531\u4e8e\u6211\u4eec\u8f6c\u79fb\u7684\u5e76\u96c6\u5927\u5c0f\u800c\u4e0d\u77e5\u9053\u5e76\u96c6\u7684\u5177\u4f53\u4f4d\u7f6e\u3002\n\n  \u53ef\u80fd\u6709\u65b0\u589e\u884c\u88ab\u5939\u5728\u5e76\u96c6\u4e2d\u95f4\uff0c\u5e76\u96c6\u5185\u5982\u679c\u9009\u4e86\u4e5f\u53ef\u80fd\u9020\u6210\u8d21\u732e\uff0c\u6709\u70b9\u8fa3\u624b\u3002\n  \n  (\u4ee5\u4e0b 2\u884c \u8bf7\u8bfb\u4f5c \u4e24\u884c \u3002\u3002\u3002)\n  \n  \u4f46\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u7684\u662f\uff1a\u5f53\u524d\u5217\u6700\u4e0b\u7684\u9ed1\u8272\u4e0b\u9762\u4e00\u5b9a\u6709\u4e00\u884c\u767d\u8272(\u770b\u4f5c\u6709\u7b2c 0 \u884c)\uff0c\u5f53\u524d\u5217\u6700\u4e0a\u7684\u4e0a\u9762\u4e00\u5b9a\u4e5f\u6709\u4e00\u884c\u767d\u8272(\u770b\u4f5c\u6709\u7b2c $n+1$ \u884c)\uff0c\u8003\u8651\u52a0 2 \u884c\u767d\u8272\u4e0e\u9ed1\u8272\u884c\u653e\u5728\u4e00\u8d77\u6765\u8003\u8651\u8d21\u732e\u3002\n  \n  \u603b\u5171 $i+k+2$ \u884c\uff0c\u5176\u4e2d\u9009\u51fa $k+2$ \u884c\u4f5c\u4e3a 2 \u884c\u767d\u8272\u548c $k$ \u884c\u65b0\u589e\u7684\u9ed1\u8272\uff0c\u5176\u4e2d\u6700\u4e0b\u7684\u548c\u6700\u4e0a\u7684\u4e3a\u767d\u8272\uff0c\u8d21\u732e\u5c31\u662f $\\tbinom{i+k+2}{k+2}$\u3002\n  \n  \u6ce8\u610f\u8fd9\u91cc\u4e0d\u7ba1\u662f\u767d\u8272\u8fd8\u662f\u65b0\u589e\u7684\u9ed1\u8272\u90fd\u53ef\u80fd\u88ab\u5939\u5728\u5e76\u96c6\u4e2d\u95f4\uff0c\u4e5f\u6709\u53ef\u80fd\u90e8\u5206\u5728\u5e76\u96c6\u5916\u9762\uff0c~~\u53cd\u6b63\u6211\u89c9\u5f97\u8fd9\u6837\u7406\u89e3\u5c31\u6ca1\u95ee\u9898\u4e86~~\u3002\n  \n\u7136\u540e\u5c31\u662f\u603b\u8f6c\u79fb\u5f0f\uff0c\u548c\u5176\u4ed6\u9898\u89e3\u4e00\u6837\uff1a\n\n$f_{j,i}=(1+i+\\tbinom{i}{2})f_{j-1,i}+\\sum_{k<i}\\tbinom{i+2}{i-k+2}f_{j-1,k}$\n\n\u524d\u9762\u53ea\u8ddf $i,j$ \u6709\u5173\uff0c\u53ef\u4ee5 $O(1)$ \u8f6c\u79fb\uff0c\u540e\u9762\u62c6\u5f00\u540e\u4e3a $(i+2)!\\sum_{k<i}\\dfrac{f_{j-1,k}}{k!}\\dfrac{1}{(i-k+2)!}$ \u548c\u5f0f\u90e8\u5206\u7528 NTT \u5377\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u7531\u4e8e\u6211\u4eec\u6700\u540e\u5f97\u5230\u7684\u662f\u5e76\u96c6\u5927\u5c0f\uff0c\u8fd8\u5f97\u4ece $n$ \u884c\u91cc\u9762\u9009\u51fa\u5e76\u96c6\uff0c\u6545\u7b54\u6848\u4e3a\uff1a\n\n$ans=\\sum_i\\tbinom{n}{i}f_{m,i}$\n\n\u590d\u6742\u5ea6\u74f6\u9888\u5728\u6bcf\u6b21\u8f6c\u79fb\u7684 NTT\uff0c\u590d\u6742\u5ea6 $O(m\\cdot n\\log{n})$\u3002\n\n\u4ee3\u7801\u8fd8\u662f\u5e16\u4e0a\u5427\uff1a\n\n```cpp\n\tlen=Get((n+1)<<1);\n\tfor(F[0][0]=j=1;j<=m;j++)\n\t{\n\t\tfor(i=0;i<=n;i++)\n\t\t{\n\t\t\ttpf[i]=Ml(F[j-1][i],inv[i]);\n\t\t\ttpg[i]=i?inv[i+2]:0;\n\t\t}\n\t\tfor(;i<len;i++)tpf[i]=tpg[i]=0;\n\t\tNTT(tpf,len,1);NTT(tpg,len,1);\n\t\tfor(i=0;i<len;i++)Mul(tpf[i],tpg[i]);\n\t\tNTT(tpf,len,-1);\n\t\tfor(i=0;i<=n;i++)\n\t\t{\n\t\t\tF[j][i]=Ml(tpf[i],fac[i+2]);\n\t\t\tAdd(F[j][i],Ml(Md(i+1+((LL)i*(i-1)>>1)),F[j-1][i]));\n\t\t}\n\t}\n\tfor(i=0;i<=n;i++)\n\t{\n\t\tAdd(ans,Ml(C(n,i),F[m][i]));\n\t}\n```",
        "postTime": 1627112870,
        "uid": 158948,
        "name": "\u7ea6\u745f\u592b\u7528\u8111\u73a9",
        "ccfLevel": 0,
        "title": "AT3872 [AGC021F] Trinity"
    }
]
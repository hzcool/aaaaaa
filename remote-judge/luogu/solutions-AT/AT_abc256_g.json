[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_abc256_g)\n\n## \u601d\u8def\n\n\u5148\u8003\u8651\u4e00\u4e2a\u66b4\u529b $\\rm DP$\uff0c\u8bbe $f_{i,j,0/1,0/1}$ \u8868\u793a\u524d $i$ \u6761\u8fb9\uff0c\u6bcf\u6761\u8fb9\u4e0a\u6709 $j$ \u4e2a\u767d\u70b9\uff0c\u7b2c\u4e00\u6761\u8fb9\u7684\u6700\u5de6\u8fb9\u7684\u9876\u70b9\u7684\u989c\u8272\u662f $0/1$\uff0c\u7b2c $i$ \u6761\u8fb9\u7684\u6700\u53f3\u8fb9\u7684\u9876\u70b9\u7684\u989c\u8272\u662f $0/1$\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u4e0b\u6587\u4e2d\u63d0\u5230\u7684 $d$ \u5747\u4e3a\u8f93\u5165\u7684 $d$ \u52a0\u4e0a $1$ \u4e4b\u540e\u7684\u7ed3\u679c\u3002\n\n\u7b80\u5355\u5730\u5199\u4e00\u4e2a\u8f6c\u79fb\uff0c\u4ee5 $f_{i,j,0,0}$ \u4e3a\u4f8b\uff1a\n\n$$f_{i,j,0,0}=f_{i-1,j,0,1} \\times \\binom{d-2}{j-1}+f_{i-1,j,0,0} \\times \\binom{d-2}{j-2}$$\n\n\u6700\u540e\u7684\u5408\u5e76\u7b54\u6848\u662f\u7b80\u5355\u7684\uff0c\u679a\u4e3e\u6700\u540e\u4e00\u6761\u8fb9\u4e24\u4e2a\u7aef\u70b9\u7684\u72b6\u6001\u5373\u53ef\u3002\n\n\u5176\u4f59\u72b6\u6001\u7684\u8f6c\u79fb\u7c7b\u4f3c\uff0c\u4e0d\u518d\u8d58\u8ff0\uff0c\u4e0d\u96be\u53d1\u73b0\u7b2c\u4e8c\u7ef4\u548c\u7b2c\u4e09\u7ef4\u90fd\u662f\u4e0d\u53d8\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u7b2c\u4e8c\u7ef4\u548c\u7b2c\u4e09\u7ef4\uff0c\u7136\u540e\u628a\u72b6\u6001\u7b80\u5316\u5230 $f_{i,0/1}$\uff0c\u8868\u793a\u524d $i$ \u6761\u8fb9\uff0c\u7b2c $i$ \u6761\u8fb9\u7684\u6700\u53f3\u8fb9\u7684\u9876\u70b9\u7684\u989c\u8272\u662f $0/1$\u3002\n\n\u73b0\u5728\u7684\u8f6c\u79fb\u5982\u4e0b\uff1a\n\n$$f_{i,0}=f_{i-1,1} \\times \\binom{d-2}{j-1}+f_{i-1,0} \\times \\binom{d-2}{j-2}$$\n\n\u53d1\u73b0\u4e24\u4e2a\u7ec4\u5408\u6570\u662f\u4e0d\u53d8\u7684\uff0c\u4e0d\u59a8\u5206\u522b\u8bbe\u4e3a $A$ \u548c $B$\uff0c\u5219 $f_{i,0}=f_{i-1,1} \\times A+f_{i-1,0} \\times B$\u3002\n\n\u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u4e0d\u59a8\u8bbe $f_{i,1}$ \u7684\u4e24\u4e2a\u7ec4\u5408\u6570\u4e3a $C$ \u548c $D$\uff0c\u5219 $f_{i,1}=f_{i-1,1} \\times C+f_{i-1,0} \\times D$\u3002\n\n\u5f88\u5bb9\u6613\u628a\u5b83\u5199\u6210\u77e9\u9635\u7684\u5f62\u5f0f\uff1a\n\n$$\n\\begin{bmatrix}\nA & B \\\\\nC & D\n\\end{bmatrix}\n\n\\times\n\n\\begin{bmatrix}\n\nf_{i-1,1} \\\\\n\nf_{i-1,0}\n\n\\end{bmatrix}\n\n=\n\n\\begin{bmatrix}\n\nf_{i,1} \\\\\n\nf_{i,0}\n\n\\end{bmatrix}\n$$\n\n\u7136\u540e\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u597d\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(d \\log n)$\n\n## \u4ee3\u7801\n\n[Link](https://atcoder.jp/contests/abc256/submissions/39787125)",
        "postTime": 1679042649,
        "uid": 253608,
        "name": "Tx_Lcy",
        "ccfLevel": 7,
        "title": "[ABC256G] Black and White Stones"
    },
    {
        "content": "\u786e\u5b9e\u662f\u4e0d\u9519\u7684\u597d\u9898\uff0c\u81f3\u5c11\u80fd\u628a\u6211\u8fd9\u79cd\u5f31\u667a\u7ed9\u533a\u5206\u6389\u3002\n\n\u6ce8\u610f\u5230 $D$ \u4e0d\u5927\uff0c$N$ \u5de8\u5927\u3002\u90a3\u4f60\u8003\u8651\u679a\u4e3e\u6bcf\u4e00\u6761\u8fb9\u6709\u51e0\u4e2a\u767d\u77f3\u5b50\u3002\u4e0d\u59a8\u8bbe\u679a\u4e3e\u5230\u4e86 $d$ \u4e2a\u3002\n\n\u7136\u540e\u662f\u6700\u5999\u7684\uff1a\u8003\u8651\u4e00\u4e2a dp\u3002\u4e5f\u5c31\u662f\u8bf4 $dp_{{i},{c_1},{c_2}}$ \u8868\u793a\u7b2c\u4e00\u4e2a\u70b9\uff08\u5c31\u662f\u6700\u5f00\u59cb\u90a3\u89d2\uff09\u7684\u989c\u8272 $c_1$ \u5f00\u59cb\uff0c\u5230\u4e86\u7b2c $i$ \u6761\u8fb9\uff0c\u8fd9\u6761\u8fb9\u6700\u540e\u4e00\u4e2a\u70b9\uff08\u4e5f\u5c31\u662f\u8fd9\u6761\u8fb9\u7684\u89d2\u4e0a\uff09\u7684\u989c\u8272\u4e3a $c_2$\u3002\u663e\u7136\u7ed5\u4e00\u5708\u56de\u6765\u521a\u597d\u90a3\u4e2a\u89d2\u91cd\u5408\u4e86\uff0c\u56e0\u6b64\u8fd9\u4fe9\u73a9\u610f\u513f\u989c\u8272\u5f97\u4e00\u6837\uff0c\u7b54\u6848\u5c31\u662f $dp_{n,0,0}+dp_{n,1,1}$\u3002\n\n\u8003\u8651\u5982\u4f55\u8f6c\u79fb\u3002\u4f60\u53d1\u73b0\u672c\u8d28\u4e0a\u53ea\u8ddf\u4f60\u5728\u8fd9\u6761\u8fb9\u5269\u51e0\u4e2a\u4f4d\u7f6e\u80fd\u586b\uff08\u5b9e\u9645\u4e0a\u4e00\u5b9a\u662f $D-1$\uff09\uff0c\u4ee5\u53ca\u8fd8\u9700\u8981\u51e0\u4e2a\u767d\u77f3\u5b50\u6709\u5173\u3002\u8fd9\u65f6\u679a\u4e3e $d$ \u7684\u597d\u5904\u5c31\u51fa\u6765\u4e86\uff1a\u4f60\u53ef\u4ee5\u76f4\u63a5\u786e\u5b9a\u4ece $dp_{i,c_1,c_2}\\to dp_{i,c_1,c_2'}$ \u7684\u8fc7\u7a0b\u4e2d\u8fd8\u6709\u51e0\u4e2a\u767d\u77f3\u5b50\u9700\u8981\u586b\uff08\u5b9e\u9645\u4e0a\u5c31\u662f $d-[c_2=0]-[c_2'=0]$\uff09\u3002\u8fd9\u6837\u4e00\u6765\u7cfb\u6570\u5c31\u662f\u4ece $D-1$ \u91cc\u9009 $d-[c_2=0]-[c_2'=0]$ \u4e2a\u3002\u7136\u540e\u4f60\u53d1\u73b0\u5b83\u662f\u4e00\u4e2a\u6807\u51c6\u7684\u77e9\u9635\u52a0\u901f\u5f62\u5f0f\u3002\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u590d\u6742\u5ea6 $O(D\\log N)$\u3002\u8fd8\u662f\u5f88\u597d\u5199\u7684\u3002",
        "postTime": 1666272892,
        "uid": 314991,
        "name": "zhouyuhang",
        "ccfLevel": 7,
        "title": "\u8bda\u7136\u662f\u4e0d\u9519\u7684\u597d\u9898"
    }
]
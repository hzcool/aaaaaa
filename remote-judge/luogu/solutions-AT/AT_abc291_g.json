[
    {
        "content": "## [ABC291G OR Sum](https://atcoder.jp/contests/abc291/tasks/abc291_g)\n\n\u9898\u610f\uff1a\u6709\u4e24\u4e2a\u957f\u5ea6\u4e3a $N$ \u7684\u5e8f\u5217 $A,B$\uff0c\u53ef\u4ee5\u7ed9 $A$ \u5e8f\u5217\u5411\u5de6\u5faa\u73af\u79fb\u52a8\u82e5\u5e72\u4f4d\uff0c\u6c42 $\\sum (A_i|B_i)$ \u7684\u6700\u5927\u503c\u3002$N\\le 5\\times 10^5$ \u800c $0\\le A_i,B_i\\le 31$\u3002\n\n\u9898\u89e3\uff1a\u53d1\u73b0 `or` \u64cd\u4f5c\u6709\u70b9\u70b9\u56f0\u96be\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u628a\u4e24\u4e2a\u5e8f\u5217\u53d6\u53cd\uff0c\u7136\u540e\u6c42 `and` \u7684\u6700\u5c0f\u503c\u3002\n\n\u5c1d\u8bd5\u5f62\u5f0f\u5316\u679a\u4e3e\u6bcf\u4e2a\u79fb\u52a8\u6570\u91cf\u7684\u8fc7\u7a0b\uff0c\u6bd4\u5982\u679a\u4e3e\u4e00\u4e2a\u79fb\u4f4d $j$\uff0c\u518d\u679a\u4e3e\u4e00\u4e2a $i$ \u8ba1\u7b97\u7b54\u6848\u3002\n\n\u8fd9\u79cd\u4f4d\u6570\u7279\u522b\u5c11\u7684\u9898\uff0c\u5c31\u5148\u679a\u4e3e\u4e8c\u8fdb\u5236\u4f4d $k$\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4f4d\u5206\u522b\u5904\u7406\u3002\u8bbe $a,b$ \u5206\u522b\u4e3a\u5e8f\u5217 $A,B$ \u7684\u7b2c $k$ \u4f4d\u53d6\u53cd\u3002\n\n\u7136\u540e\u5c31\u662f\u4e24\u4e2a `0/1` \u5e8f\u5217\u5408\u5e76\u64cd\u4f5c\uff0c\u6211\u4eec\u9700\u8981\u6c42\u51fa\u4e00\u4e2a\u7b54\u6848\u6570\u7ec4 $c$\uff0c$c_j=\\sum a_i\\times b_{(i+j)\\% n}$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u628a $b$ \u590d\u5236\u4e00\u904d\uff0c\u53bb\u6389\u53d6\u6a21 $n$\uff0c\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u6c42 $c_j=\\sum a_i\\times b_{i+j}$\u3002\n\n\u8fd9\u4e2a\u5f62\u5f0f\u8fd8\u4e0d\u662f\u6211\u4eec\u719f\u6089\u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u5e94\u8be5\u719f\u6089\u7684\u5f62\u5f0f\u662f $c_{i+j}=\\sum a_i\\times b_j$\u3002\n\n\u600e\u4e48\u529e\u5462\uff1f\u62ff $k$ \u66ff\u6362 $(i+j)$\uff0c\u95ee\u9898\u5c31\u53d8\u6210\u4e86 $c_{k-i}=\\sum a_i\\times b_k$\u3002\n\n\u5de6\u8fb9\u5f0f\u5b50 $i$ \u7b26\u53f7\u8d1f\u7684\u4e0d\u597d\u770b\uff0c\u95ee\u9898\u5c31\u53d8\u6210\u4e86 $c_{k+i}=\\sum a_{-i}\\times b_k$\u3002\n\n\u53f3\u8fb9\u4e0b\u6807\u4e3a\u8d1f\u6570\u7684\u5f88\u4e0d\u597d\u770b\uff0c\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u5b58\u50a8 $a$ \u6570\u7ec4\uff0c\u6240\u4ee5\u628a $a$ \u6570\u7ec4\u53cd\u8f6c\u5f97\u5230 $a'$ \u4e86\uff0c\u5c31\u662f\u539f\u6765\u7684\u5b58\u50a8 $a_{-i}$ \u7684\u6570\u7ec4\u53f3\u79fb $n-1$ \u4f4d\u3002\n\n\u4ee4 $p=n-1-i$\uff0c\u539f\u5f0f= $c_{k+p}=\\sum a'_{p}\\times b_k$\u3002\u7531\u4e0a\u53ef\u77e5\uff0c\u591a\u9879\u5f0f\u5b9e\u9645\u7684\u503c\u53ea\u6709 $[n-1,2n-2]$ \u7684\u8fd9 $n$ \u4f4d\u624d\u6709\u6548\u3002\n\n\u53d1\u73b0\u5c31\u662f\u591a\u9879\u5f0f\u7684\u5f62\u5f0f\uff0c\u76f4\u63a5\u5377\u79ef\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#include<atcoder/all>\nusing namespace std;\ntypedef int I;\nI main(){I n;\n\tscanf(\"%d\",&n);\n\tvector<I>a(n),b(n),c(n),d(n<<1),e,f(n);\n\tfor(I i=0;i<n;++i)scanf(\"%d\",&a[i]);\n\tfor(I i=0;i<n;++i)scanf(\"%d\",&b[i]);\n\tfor(I k=0;k<5;++k){\n\t\tfor(I i=0;i<n;++i)d[i]=(~b[i]>>k)&1,d[i+n]=d[i],c[n-1-i]=(~a[i]>>k)&1;\n\t\te=atcoder::convolution(c,d);\n\t\tfor(I i=0;i<n;++i)f[i]+=(n-e[i+n-1])<<k;}\n\tprintf(\"%d\\n\",*max_element(f.begin(),f.end()));\n\treturn 0;\n}\n```\n\n## ",
        "postTime": 1677672879,
        "uid": 121995,
        "name": "SmallTualatin",
        "ccfLevel": 0,
        "title": "ABC291G \u9898\u89e3"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u51fa\u4e24\u4e2a\u957f $N$ \u7684\u6570\u5217 $A,B$\uff0c\u73b0\u5728\u53ef\u4ee5\u5bf9 $A$ \u505a\u4efb\u610f\u6b21\u5faa\u73af\u79fb\u4f4d\uff0c\u6c42 $\\displaystyle\\sum_{i=0}^{N-1}\\ (A_i|B_i)$ \u7684\u6700\u5927\u503c\u3002\n\n\u9996\u5148\u5c06 $A$ \u8fdb\u884c\u4e00\u4e2a\u590d\u5236\u7136\u540e\u63a5\u5728 $A$ \u540e\u9762\uff0c\u7136\u540e\u7b54\u6848\u5373\u4e3a $\\displaystyle\\max_{k=0}^{N-1}\\{\\sum_{i=0}^{N-1}\\ (A_{i+k}|B_i)\\}$\uff0c\u4e4b\u540e\u5c06 $A$ \u53cd\u5e8f\uff0c\u4e8e\u662f\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\u3002\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u5377\u79ef\u91cc\u6709\u6216\u8fd0\u7b97\uff0c\u4e8e\u662f\u8003\u8651\u62c6\u4f4d\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4f4d $a_i,b_i$\uff0c\u6709 $a_i|b_i=a_i+b_i-a_ib_i$\uff0c\u7136\u540e\u628a\u8d21\u732e\u7d2f\u52a0\u5373\u53ef\u3002\n\nCode:\n\n```cpp\nint n,f[ntt_siz+5],g[ntt_siz+5],a[500005],b[500005],ans[500005];\nint main()\n{\n\tn=rd();int s=0;\n\tfor(int i=1;i<=n;++i)s+=(a[i]=rd());\n\tfor(int i=1;i<=n;++i)s+=(b[i]=rd());\n\tint l=1;while((1<<l)<n+n)++l;\n\tinit(1<<l);\n\tfor(int c=0;c<5;++c)\n\t{\n\t\tclr(f,1<<l);clr(g,1<<l);\n\t\tfor(int i=0;i<n;++i)f[i]=f[i+n]=((a[n-i]>>c)&1),g[i]=((b[i+1]>>c)&1);\n\t\tmul(f,g,1<<l);//\u5377\u79ef\n\t\tfor(int i=0;i<n;++i)ans[i]+=f[i+n-1]<<c;\n\t}\n\tint aa=-1;\n\tfor(int i=0;i<n;++i)tomax(aa,s-ans[i]);\n\tprt(aa);\n\tret 0;\n}\n```",
        "postTime": 1677453946,
        "uid": 224991,
        "name": "Presentation_Emitter",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT_abc291_g \u3010OR Sum\u3011"
    },
    {
        "content": "no convolution/oh\n\n\u8003\u8651\u5c06 $b_i$ \u500d\u957f\uff0c\u7136\u540e\u7136\u540e\u5c06 $a_i$ \u653e\u5728\u4e0b\u9762\uff0c\u4e00\u5f00\u59cb $a_0$ \u5bf9\u51c6 $b_0$\uff0c\u6700\u540e $a_0$ \u5bf9\u51c6 $b_{n-1}$\uff0c\u6211\u4eec\u4ee4 $a_0$ \u5bf9\u51c6 $b_d$ \u7684\u65f6\u523b\u4e3a\u65f6\u523b $d$\u3002\n\n\u8003\u8651\u5c06 $a_i\\mid b_i$ \u7684\u8d21\u732e\u653e\u5230 $b_i$ \u4e0a\u6765\u8ba1\u7b97\uff0c\u4e0d\u5931\u4e00\u822c\u6027\u5730\uff0c\u8003\u8651 $b_j(0\\le j<n)$ \u4f1a\u5bf9\u4ec0\u4e48\u65f6\u523b\u9020\u6210\u4ec0\u4e48\u8d21\u732e\uff0c\u8003\u8651\u62c6\u4f4d\uff0c\u73b0\u5728\u8003\u8651\u7b2c $k$ \u4f4d\u7684\u8d21\u732e\uff0c\u663e\u7136\uff0c\u4f1a\u4e0e $b_j$ \u8fdb\u884c\u6216\u8fd0\u7b97\u7684\u53ea\u6709 $a_j(d=0),a_{j-1}(d=1),\\dots,a_0(d=j)$\uff0c\u5176\u4e2d\u6709\u4e14\u4ec5\u6709 $a,b$ \u7b2c $k$ \u4f4d\u90fd\u662f $0$ \u7684\u60c5\u51b5\u4e0d\u9020\u6210\u8d21\u732e\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u8003\u8651\u8ba1\u7b97\u6216\u4e3a $0$ \u7684\u60c5\u51b5\uff0c\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u5377\u79ef\u5f62\u5f0f\uff0c\u4e8e\u662f FFT \u4f18\u5316\u5373\u53ef\uff0c\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#include <atcoder/all>\nusing namespace std;\nusing namespace atcoder;\nconst int N = 500000;\nint max(int a, int b) {\n\treturn a > b ? a : b;\n}\nint main() {\n\tint n;\n\tscanf(\"%d\", &n);\n\tvector < int > a(n), b(n), c(n), d(2 * n), e(n), f;\n\tfor (int i = 0; i < n; i++) {\n\t\tscanf(\"%d\", &a[i]);\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tscanf(\"%d\", &b[i]);\n\t}\n\tfor (int j = 0; j < 5; j++) {\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\td[i] = ((a[i] >> j) & 1) ^ 1;\n\t\t\td[n + i] = d[i];\n\t\t\te[n - i - 1] = ((b[i] >> j) & 1) ^ 1;\n\t\t}\n\t\tf = convolution(d, e);\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tc[i] += (n - f[n + i - 1]) << j;\n\t\t}\n\t}\n\tint ans = 0;\n\tfor (int i = 0; i < n; i++) {\n\t\tans = max(ans, c[i]);\n\t}\n\tprintf(\"%d\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1677504605,
        "uid": 448887,
        "name": "cancan123456",
        "ccfLevel": 0,
        "title": "ABC291G \u9898\u89e3"
    }
]
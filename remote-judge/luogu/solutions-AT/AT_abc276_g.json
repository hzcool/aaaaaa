[
    {
        "content": "**\u4f20\u9001\u95e8\uff1a** [G - Count Sequences](https://atcoder.jp/contests/abc276/tasks/abc276_g)\n\n--------------------------\n\n**\u9898\u76ee\u5927\u610f\uff1a**\n\u6c42\u957f\u5ea6\u4e3a $n$ \u7684\u6574\u6570\u5e8f\u5217 $a_i$ \u7684\u4e2a\u6570\uff0c\u6ee1\u8db3\uff1a\n\n- $0 \\le a_1 \\le a_2 \\le \\dots \\le a_n \\le m$.\n- $\\forall 1 \\le i < n,a_i \\not \\equiv a_{i+1} \\pmod{3}$.\n\n--------------------------\n\n\u751f\u6210\u51fd\u6570\u5165\u95e8\u9898\uff0c\u5b8c\u5168\u4e0d\u9700\u8981\u8003\u8651\u7ec4\u5408\u610f\u4e49\u3002\n\n\u9996\u5148\u6709\u4e00\u4e2a\u5f88\u660e\u663e\u7684 $O(nm^2)$ dp\uff0c\u8bb0 $f_{i,j}$ \u4e3a\u8003\u8651\u5e8f\u5217\u524d $i$ \u4e2a\u6570\uff0c\u4e14 $a_i=j$ \u65f6\u7684\u5e8f\u5217\u4e2a\u6570\uff0c\u6709\u8f6c\u79fb\uff1a\n\n$$\nf_{i,j} =\n\\begin{cases}\n1 &i=1\\\\\n\\sum_{ 0 \\le k \\le j, k \\not \\equiv j } f_{i-1,k} &i > 1\n\\end{cases}\n$$\n\n\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u4f18\u5316\u5230 $O(nm)$\uff0c\u4f46\u5f88\u660e\u663e\u4e0d\u591f\uff0c\u8003\u8651\u8bbeOGF $F_i(x) = \\sum_{j \\ge 0} f_{i,j}x^j$\uff0c\u4e0a\u9762\u7684\u8f6c\u79fb\u5f0f\u5c31\u53d8\u6210\u4e86\uff1a\n\n$$\nF_i(x) =\n\\begin{cases}\n\\dfrac{1}{1-x} &i=1\\\\\n\\dfrac{x^2+x}{1-x^3} F_{i-1}(x) &i > 1\n\\end{cases}\n$$\n\n\u5f88\u660e\u663e\u53ef\u4ee5\u5f97\u5230 $F_i(x)$ \u7684\u5c01\u95ed\u5f62\u5f0f\uff1a\n\n$$\nF_i(x) = \\dfrac{(x^2+x)^{i-1}}{(1-x)(1-x^3)^{i-1}}\n$$\n\n\u6700\u540e\u7684\u7b54\u6848\u662f $\\sum_{i=0}^m f_{n,i}$\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f\uff1a\n\n$$\n\\begin{aligned}\n&\\sum_{i=0}^m[x^i] F_n(x) \\\\\n= &[x^m]\\dfrac{1}{1-x}F_{n}(x)\\\\\n= &[x^m] \\dfrac{(x^2+x)^{n-1}}{(1-x)^2(1-x^3)^{n-1}}\\\\\n= &[x^m] \\dfrac{x^{n-1}(x+1)^{n-1}}{(1-x)^2(1-x^3)^{n-1}}\\\\\n= &[x^{m-n+1}] \\dfrac{(x+1)^{n-1}}{(1-x)^2} \\cdot \\dfrac{1}{(1-x^3)^{n-1}}\\\\\n\\end{aligned}\n$$\n\n\u5176\u4e2d $\\dfrac{(x+1)^{n-1}}{(1-x)^2}$ \u5c31\u662f $(x+1)^{n-1}$ \u7684\u4e8c\u9636\u524d\u7f00\u548c\uff0c\u800c $(x+1)^{n-1},\\dfrac{1}{(1-x^3)^{n-1}}$ \u5747\u4e3a\u7ecf\u5178\u7684\u5173\u4e8e\u7ec4\u5408\u6570\u7684\u751f\u6210\u51fd\u6570\uff1a\n\n$$\n\\begin{aligned}\n(x+1)^{n-1} &= \\sum_{i \\ge 0} \\binom{n-1}{i}x^i\\\\\n\\dfrac{1}{(1-x^3)^{n-1}} &= \\sum_{i \\ge 0} \\binom{i+n-2}{n-2}(x^3)^i\n\\end{aligned}\n$$\n\n$\\dfrac{(x+1)^{n-1}}{(1-x)^2},\\dfrac{1}{(1-x^3)^{n-1}}$ \u7684\u524d $m-n+1$ \u9879\u5747\u53ef\u5728\u7ebf\u6027\u65f6\u95f4\u5185\u7b97\u51fa\uff0c\u540c\u6837\u53ef\u5728\u7ebf\u6027\u65f6\u95f4\u5185\u7b97\u51fa\u4e8c\u8005\u5377\u79ef\u7684\u7b2c $m-n+1$ \u9879\uff0c\u603b\u590d\u6742\u5ea6\u7ebf\u6027\u3002\n\n~~\u611f\u89c9\u8fd9\u4e2a\u5f0f\u5b50\u627e\u4e0d\u51fa\u4ec0\u4e48\u7ec4\u5408\u610f\u4e49\u3002~~\n\n\u9898\u5916\u8bdd\uff1a\u4f7f\u7528\u7ebf\u6027\u9012\u63a8\u53ef\u4ee5\u505a\u5230 $O(n \\log n \\log m)$\uff0c$n$ \u5f00\u5230 $10^5$ \u7ea7\u522b\uff0c\u6b64\u65f6 $m$ \u53ef\u4ee5\u5f00\u5230 $10^{18}$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <bits/stdc++.h>\n#define lowbit(x) (x & -x)\n#define pb push_back\n#define mp make_pair\nusing namespace std;\n\ntypedef long long ll;\nconst int V = 1e7+5;\nconst int Mod = 998244353;\n\nint n, m, ans;\nll fac[V], finv[V], F[V];\n\ninline int qpow(int a, int b) {\n    ll base = a, ans = 1;\n    while (b) {\n        if (b & 1) ans = ans * base % Mod;\n        base = base * base % Mod;\n        b >>= 1;\n    }\n    return ans;\n}\n\ninline void Add(int &a, int b) { a += b; if (a >= Mod) a -= Mod; }\ninline ll C(int n, int m) {\n    if (m > n) return 0;\n    return fac[n] * finv[m] % Mod * finv[n - m] % Mod;\n}\n\nint main() {\n    fac[0] = 1;\n    for (int i = 1; i < V; i++) fac[i] = fac[i - 1] * i % Mod;\n    finv[V - 1] = qpow(fac[V - 1], Mod - 2);\n    for (int i = V - 1; i; i--) finv[i - 1] = finv[i] * i % Mod;\n\n    scanf(\"%d%d\", &n, &m);\n    \n    F[0] = 1;\n    for (int i = 1; i <= m - n + 1; i++) F[i] = (F[i - 1] + C(n - 1, i)) % Mod;\n    for (int i = 1; i <= m - n + 1; i++) F[i] = (F[i - 1] + F[i]) % Mod;\n    for (int i = 0; i <= m - n + 1; i += 3) Add(ans, C(i / 3 + n - 2, n - 2) * F[m - n + 1 - i] % Mod);\n\n    printf(\"%d\", ans);\n    return 0;\n}\n```",
        "postTime": 1667701163,
        "uid": 261935,
        "name": "Unique_Hanpi",
        "ccfLevel": 0,
        "title": "ABC276G \u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_abc276_g)\n# \u601d\u8def\n\u5148\u5bf9\u539f\u6570\u7ec4 ${a}$ \u8fdb\u884c\u5dee\u5206\uff0c\u5f97\u5230\u6570\u7ec4 ${b}$\u3002\u7531\u4e8e\uff1a\n$$\\forall i\\in[2,N],a_i\\not\\equiv a_{i-1}\\pmod{3}$$\n\u6545\uff1a\n$$\\forall i\\in[2,N],b_i\\not\\equiv0\\pmod{3}$$\n\u6240\u4ee5\u53ef\u4ee5\u5148\u5bf9\u6240\u6709\u7684 $b_i$ \u5bf9 $3$ \u53d6\u6a21\uff0c\u6b64\u65f6 $\\forall i\\in[2,N],b_i\\in\\begin{Bmatrix}1,2\\end{Bmatrix}$ \u4e14 $b_1\\in\\begin{Bmatrix}0,1,2\\end{Bmatrix}$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e $b_1\\bmod 3$ \u7684\u503c\u3002\u56e0\u4e3a $a_N\\le M$\uff0c\u6240\u4ee5 $\\sum b\\le M$\u3002\u4e0b\u9762\u4ee5 $a_1\\equiv0\\pmod{3}$ \u4e3a\u4f8b\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e $b_i$ \u4e2d\u6709\u51e0\u4e2a $1$\uff0c\u81ea\u7136\u5c31\u77e5\u9053\u5176\u4e2d\u6709\u51e0\u4e2a $2$\u3002\u4e0d\u59a8\u8bbe\u73b0\u5728\u6709 $k$ \u4e2a $2$\uff0c\u5bb9\u6613\u77e5\u9053\uff0c\u6b64\u65f6 $\\sum b=N+k-1$\u3002\u8003\u8651\u6b64\u65f6\u5c06 $3$ \u63d2\u5165\uff0c\u5bb9\u6613\u77e5\u9053\u6700\u591a\u53ef\u63d2\u5165 $cnt=\\left\\lfloor\\dfrac{M-k-N+1}{3}\\right\\rfloor$ \u4e2a $3$\u3002\u53c8\u56e0\u4e3a\u4e00\u5171\u6709 $n-1$ \u4e2a\u7a7a\uff0c\u4e14\u4e00\u4e2a\u7a7a\u4e2d\u53ef\u4ee5\u63d2\u5165\u591a\u4e2a $3$\uff0c\u6240\u4ee5\u603b\u53ef\u80fd\u6570\u4e3a $\\sum\\limits_{k=0}^{n-1}C_{n-1}^{k}\\sum\\limits_{j=0}^{cnt} C_{n+j}^{j}$\u3002\n# \u4ee3\u7801\n\u663e\u7136\uff0c\u7b2c\u4e8c\u90e8\u5206\u5f88\u5bb9\u6613\u505a\u524d\u7f00\u548c\uff0c\u590d\u6742\u5ea6\u53ef\u4ee5\u4f18\u5316\u5230 $O(n)$\u3002\n## AC Code\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int mod=998244353,N=2e7+5;\nint n,m,fac[N],inv[N],s[N],res;\nint qpow(int x,int n){//\u5feb\u901f\u5e42\n\tint res=1;\n\twhile(n){\n\t\tif(n&1) res=res*x%mod;\n\t\tx=x*x%mod,n>>=1;\n\t}return res;\n}\nint C(int n,int m){//\u7ec4\u5408\u6570\n\tif(n>m) return 0;\n\telse if(!n) return 1;\n\treturn fac[m]*inv[m-n]%mod*inv[n]%mod;\n}\nvoid prep(){//\u9884\u5904\u7406\u9636\u4e58\u3001\u9636\u4e58\u7684\u6570\u8bba\u5012\u6570\u3001\u4ee5\u53ca\u524d\u7f00\u548c\n\tfac[0]=inv[0]=s[0]=1;\n\tfor(int i=1;i<N;i++) inv[i]=qpow(fac[i]=fac[i-1]*i%mod,mod-2);\n\tfor(int i=1;i<m;i++) s[i]=(s[i-1]+C(n-1,i+n-1))%mod;\n}\nsigned main(){\n\tscanf(\"%lld%lld\",&n,&m),prep();\n\tfor(int i=0;i<=2;i++)//a1\u7684\u4e09\u79cd\u60c5\u51b5\u90fd\u8981\u8ba1\u7b97\n\t\tfor(int j=0;j<n&&j+n-1+i<=m;j++)\n\t\t\tres=(res+C(j,n-1)*s[(m-j-n+1-i)/3]%mod)%mod;//\u6309\u7167\u601d\u8def\u6a21\u62df\u5373\u53ef\n\tprintf(\"%lld\",res);//\u8f93\u51fa\u7b54\u6848\n\treturn 0;\n}\n```\n\u5b8c\u7ed3\u6492\u82b1\uff01",
        "postTime": 1681572052,
        "uid": 696106,
        "name": "Leowang2009",
        "ccfLevel": 0,
        "title": "[ABC276G] Count Sequences \u9898\u89e3"
    },
    {
        "content": "\u611f\u89c9\u6bd4\u8f83\u6709\u610f\u601d\u548c\u5de7\u5999\u7684\u4e00\u9053\u9898\u3002\u5b66\u4e60\u81ea [\u5b98\u65b9\u9898\u89e3](https://atcoder.jp/contests/abc276/editorial/5182)\u3002\n\n&nbsp;\n\n\u9996\u5148\uff0c\u5c06 $A$ \u5dee\u5206\u5f97\u5230 $B = (a_1, a_2-a_1, a_3-a_2,\\cdots, a_N-a_{N-1})$\u3002$A$ \u4e0e $B$ \u6784\u6210\u53cc\u5c04\uff0c\u6545\u5bf9\u5408\u6cd5\u7684 $B$ \u8ba1\u6570\uff0c\u5373\u53ef\u77e5\u5408\u6cd5\u7684 $A$ \u7684\u6570\u76ee\u3002\n\n\u56e0\u4e3a $A$ \u5355\u8c03\u4e0d\u964d\u4e14\u76f8\u90bb\u4e24\u9879\u5bf9 $3$ \u4e0d\u540c\u4f59\uff0c\u6240\u4ee5 $B$ \u4e3a\u975e\u8d1f\u6574\u6570\u6570\u5217\uff0c\u4e14\u4ece\u7b2c $2$ \u9879\u5f00\u59cb\u6a21 $3$ \u4f59 $1$ \u6216\u4f59 $2$\u3002\u53c8\u56e0\u4e3a $a_N \\le M$\uff0c\u6240\u4ee5 $\\sum b \\le M$\u3002\n\n\u95ee\u9898\u5373\u8f6c\u5316\u4e3a\u6c42\u4ece\u7b2c\u4e8c\u9879\u5f00\u59cb\u6bcf\u9879\u6a21 $3$ \u4f59 $1$ \u6216\u4f59 $2$\uff0c\u4e14\u548c\u4e0d\u8d85\u8fc7 $M$ \u7684\u975e\u8d1f\u6574\u6570\u6570\u5217\u7684\u6570\u76ee\u3002\n\n\u5c06 $B$ \u7684\u6bcf\u4e00\u9879\u5199\u6210\u5e26\u4f59\u9664\u6cd5\u7684\u5f62\u5f0f\uff1a$b_i = 3k_i + r_i$\uff0c\u8fd9\u91cc $1 \\le i \\le N,\\ k_i \\in \\mathbb N,\\ r_i \\in \\{0, 1, 2\\}$\u3002\u5e76\u8bb0 $K = (k_1, k_2, \\cdots, k_N),\\ R = (r_1, r_2, \\cdots, r_N)$\u3002\n\n\u8003\u5bdf\u4e00\u4e2a\u7279\u5b9a\u7684 $R$\uff0c\u5219\u5408\u6cd5\u7684 $K$ \u7684\u6570\u76ee\uff0c\u5373\u4e3a\u6ee1\u8db3\u957f\u5ea6\u4e3a $N$ \u4e14\u548c\u4e0d\u8d85\u8fc7 $\\left\\lfloor\\frac{M - \\sum r}{3}\\right\\rfloor$ \u7684\u975e\u8d1f\u6574\u6570\u6570\u5217\u7684\u6570\u76ee\u3002\u6c42\u6ee1\u8db3\u957f\u5ea6\u4e3a $N$ \u4e14\u548c\u7b49\u4e8e $S$ \u7684\u975e\u8d1f\u6574\u6570\u6570\u5217\u6570\u76ee\u662f\u7ecf\u5178\u95ee\u9898\uff0c\u7531\u9694\u677f\u6cd5\u53ef\u77e5\u7b54\u6848\u662f $\\binom{S + N - 1}{N - 1}$\u3002\u5bf9\u5176\u505a\u524d\u7f00\u548c\uff0c\u5373\u5f97\u6ee1\u8db3\u957f\u5ea6\u4e3a $N$ \u4e14\u548c\u4e0d\u8d85\u8fc7\u4e00\u7ed9\u5b9a\u503c\u7684\u975e\u8d1f\u6574\u6570\u6570\u5217\u6570\u76ee\u3002\n\n\u7531\u4e0a\u9762\u53ef\u77e5\uff0c$R$ \u5bf9 $K$ \u7684\u5f71\u54cd\u53ea\u6765\u6e90\u4e8e $\\sum r$\u3002\u679a\u4e3e $r_1$\uff0c\u679a\u4e3e $r_2 \\sim r_N$ \u4e2d\u53d6\u503c\u4e3a $1$ \u7684\u4e2a\u6570 $c$\uff0c\u5bb9\u6613\u6c42\u51fa\u5177\u4f53\u6392\u5217\u7684\u65b9\u6848\u6570 $\\binom{N - 1}{c}$\uff0c\u540c\u65f6\u5bb9\u6613\u6c42\u51fa $\\sum r = r_1 + 2N - c - 2$\uff0c\u4ece\u800c\u5f97\u5230\u5bf9\u5e94\u5408\u6cd5 $K$ \u7684\u6570\u76ee\u3002\u7531\u6b64\u53ef\u4ee5\u6c42\u51fa\u7b54\u6848\u3002\n\n&nbsp;\n\n[AT \u63d0\u4ea4\u8bb0\u5f55](https://atcoder.jp/contests/abc276/submissions/36275343)",
        "postTime": 1667701538,
        "uid": 118109,
        "name": "whhsteven",
        "ccfLevel": 7,
        "title": "AT_ABC276G \u9898\u89e3"
    },
    {
        "content": "## problem\n\u6c42\u6709\u591a\u5c11\u4e2a\u5355\u8c03\u9012\u589e\u7684\u6574\u6570\u6570\u5217\uff0c\u4f7f\u5f97\u76f8\u90bb\u4e24\u9879\u5bf9\u4e09\u53d6\u6a21\u7684\u4f59\u6570\u4e0d\u76f8\u540c\u3002\u503c\u57df\u4e3a $[0,m]$\uff0c\u957f\u5ea6\u4e3a $n$\u3002$n,m\\leq 10^7$\u3002\n\n## solution\n\u8003\u8651\u5dee\u5206\u6570\u7ec4 $b_i=a_i-a_{i-1}$\uff0c\u5c06\u95ee\u9898\u8f6c\u6362\u6210\uff1a\n- $b_1\\geq 0$.\n- $b_i>0\\quad(i>1)$.\n- $\\sum b_i\\leq M$.\n\n\u8003\u8651\u5c06 $b_i$ \u8868\u793a\u4e3a $3y_i+x_i$ \u4e4b\u5f62\u5f0f\uff0c\u5176\u4e2d $x_i<3$\uff0c\u663e\u7136 $x_i,y_i$ \u662f\u72ec\u7acb\u7684\uff0c\u53ea\u8981\u6ee1\u8db3\u548c\u7684\u9650\u5236\u5c31\u597d\u3002\u5177\u4f53\u5730\uff0c\u9650\u5236\u4e3a\n\n$$\\sum y_i\\leq \\left\\lfloor\\frac{M-\\sum x_i}{3}\\right\\rfloor.$$\n\n\u73b0\u5728\u5c06\u95ee\u9898\u8f6c\u5316\u6210\uff1a\n1. \u5982\u4f55\u6c42 $\\sum y_i\\leq T$ \u7684\u65b9\u6848\u6570\uff1f\n2. \u5982\u4f55\u6c42 $\\sum x_i\\leq T$ \u7684\u65b9\u6848\u6570\uff1f\n\n### task 1\n\u5728\u6240\u6709 $y_i$ \u52a0\u4e00\u540e\uff0c\u53d8\u6210\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff1a\n\n- \u5df2\u77e5 $\\sum y_i$ \u4e14 $y_i\\geq 1$\uff0c\u6c42\u6709\u591a\u5c11\u79cd\u5206\u914d\u7684\u65b9\u6848\uff1f\n\n\u663e\u7136\u8fd9\u662f\u9694\u677f\u6cd5\uff0c\u90a3\u4e48 $\\sum y_i=T$ \u7684\u65b9\u6848\u6570\u4e3a $\\binom{T+n-1}{n-1}$\uff0c\u505a\u4e2a\u524d\u7f00\u548c\u9884\u5904\u7406\u5373\u53ef\u3002\n\n### task 2\n\u89c2\u5bdf\u5230\u9664\u4e86 $x_1$ \u5916\u6bcf\u4e2a $x_i$ \u7684\u53d6\u503c\u90fd\u662f $1$ \u6216 $2$\uff0c\u90a3\u4e48\u6211\u76f4\u63a5\u679a\u4e3e\u6709\u591a\u5c11\u4e2a $1$ \u5373\u53ef\u3002\u5bf9\u4e8e $x_1$ \u5b83\u4e5f\u53ea\u6709\u4e09\u79cd\u53d6\u503c\u3002\n\n\u590d\u6742\u5ea6\u7ebf\u6027\u3002\n## code\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\ntypedef long long LL;\nconst int P=998244353;\nconst int N=2e7;\nint n,m;\nLL qpow(LL a,LL b,int p=P){LL r=1;for(a%=P;b;b>>=1,a=a*a%p) if(b&1) r=r*a%p; return r;}\nLL fac[N+10],ifac[N+10],s[N+10],ans;\nLL C(int n,int m){return fac[n]*ifac[m]%P*ifac[n-m]%P;}\nint main(){\n\tfor(int i=fac[0]=ifac[0]=1;i<=N;i++) fac[i]=fac[i-1]*i%P;\n\tifac[N]=qpow(fac[N],P-2);\n\tfor(int i=N-1;i>=1;i--) ifac[i]=ifac[i+1]*(i+1)%P;\n\tscanf(\"%d%d\",&n,&m);\n\ts[0]=1;\n\tfor(int i=1;i<=m;i++) s[i]=(s[i-1]+C(n+i-1,n-1))%P;//,printf(\"s[%d]=%lld\\n\",i,C(n+i-1,n-1));\n\tfor(int x0=0;x0<=2;x0++){\n\t\tfor(int i=0;m>=n+i-1+x0&&n-1>=i;i++){\n\t\t\t//sum x_i=2i+n-1-i+x0=n+i-1+x0\n\t\t\t//numbers of x_i=C(n-1,i)\n\t\t\t//sum y_i<=(m-sum x_i)/3\n\t\t\tint sumx=n+i-1+x0;\n\t\t\tans=(ans+C(n-1,i)*s[(m-sumx)/3])%P;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n\n```\n\n## review\n$\\sum y_i\\leq T$ \u7684\u65b9\u6848\u6570\u4e3a $\\binom{T+n}{n}$\u3002\u56e0\u4e3a\u6211\u4eec\u6709 $\\sum_{0\\leq i\\leq n}\\binom{i+m}{m}=\\binom{n+m+1}{m+1}$\u3002\uff08\u53c2\u8003 [ABC154F](https://www.cnblogs.com/caijianhong/p/solution-ABC154F.html) \u7684\u9898\u89e3\uff09",
        "postTime": 1668265771,
        "uid": 509229,
        "name": "yukimianyan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 ABC276G\u3010Count Sequences\u3011"
    },
    {
        "content": "[ABC276G](https://atcoder.jp/contests/abc276/tasks/abc276_g)\n$\\text{Difficulty : 2278}$\u3002\n\n\u4ee5\u6b64\u6765\u6d45\u6d45\u7eaa\u5ff5\u4e0b\u6211\u7b2c\u4e00\u9053\u8d5b\u65f6\u60f3\u51fa\u6765\u7684 G\u3002\n\n\u7ed9\u5b9a $n,m$\uff0c\u6c42\u6709\u591a\u5c11\u5e8f\u5217\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u3002\u5bf9\u5927\u8d28\u6570\u53d6\u6a21\u3002\n\n- $0 \\le a_1 \\le a_2 \\le \\cdots \\le a_n \\le m$\n- $a_i$ \u4e0e $a_{i+1}$ \u5bf9 $3$ \u53d6\u4f59\u7684\u4f59\u6570\u4e0d\u540c\u3002\n\n------------\n\n$n$ \u4e2a\u6570\u4e4b\u95f4\u5f62\u6210\u4e86 $n-1$ \u4e2a\u7a7a\u5f53\u3002\u76f8\u90bb\u6570\u5b57\u95f4\u76f8\u5dee\u5bf9 $3$ \u53d6\u4f59\u7684\u4f59\u6570\u4e3a $1$ \u6216 $2$\u3002\u53ef\u4ee5\u679a\u4e3e $1$ \u7684\u6b21\u6570 $k$\u3002$k$ \u4e2a $1$ \u5206\u914d\u5230 $n-1$ \u4e2a\u7a7a\u5f53\u7684\u65b9\u6848\u6570\u4e3a $\\dbinom{n-1}{k}$\u3002\n\n\u5047\u8bbe $a_1 \\equiv 0 \\pmod{3}$\u3002\n\n\u90a3\u4e48\u8fd8\u5269\u4e0b $cnt = \\left\\lfloor\\dfrac{m-2n+k+2}{3}\\right\\rfloor$ \u4e2a\u957f\u5ea6\u4e3a $3$ \u7684\u6bb5\uff0c\u8003\u8651\u628a\u8fd9 $cnt$ \u6bb5\u63d2\u5165\u5230 $n+1$ \u4e2a\u7a7a\u5f53\u4e2d\uff08\u52a0\u4e0a $a_1$ \u4e4b\u524d\u7684\u548c $a_n$ \u4e4b\u540e\u7684\uff09\uff0c\u6839\u636e\u9694\u677f\u6cd5\u53ef\u5f97\u65b9\u6cd5\u6570\u4e3a $\\dbinom{n+cnt}{n}$\u3002\n\n\u7efc\u4e0a\uff1a\n\n$$ans = \\sum\\limits_{k=0}^{n-1}\\dbinom{n-1}{k}\\dbinom{n+cnt}{n}$$\n\n\u7136\u540e\u518d\u5bf9 $a_1 \\equiv 1 \\pmod{3}$ \u548c $a_1 \\equiv 2 \\pmod{3}$ \u7684\u60c5\u51b5\u518d\u505a\u4e00\u6b21\u5c31\u884c\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn = 2e7 + 5;\nconst int N = 2e7 + 5;\nconst int mod = 998244353;\nlong long n,m,fac[maxn],inv[maxn],ans; \ninline int read()\n{\n\tint x = 0,f = 1;char ch = getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch<='9'&&ch>='0'){x=(x<<1)+(x<<3)+ch-'0';ch=getchar();}\n\treturn f * x;\n}\nlong long qpow(long long a,long long b){long long ans=1;while(b){if(b&1)ans=ans*a%mod;a=a*a%mod;b>>=1;}return ans;}\ninline long long calc(int n,int m){return fac[n] * inv[m] % mod * inv[n - m] % mod;}\nvoid prefix()\n{\n\tfac[0] = 1;\n\tfor(int i = 1;i <= N;i++)\n\t\tfac[i] = fac[i - 1] * i % mod;\n\tinv[N] = qpow(fac[N],mod - 2);\n\tfor(int i = N - 1;i >= 0;i--)\n\t\tinv[i] = inv[i + 1] * (i + 1) % mod; \n}\nint main()\n{\n\tlong long ans = 0;\n\tprefix();\n\tcin >> n >> m;\n\tfor(int k = 0;k < n;k++)\n\t{\n\t\tlong long cnt = (m - 2 * n + k + 2) / 3;\n\t\tif(m - 2 * n + k + 2 >= 0)\n\t\t\tans = (ans + calc(cnt + n,n) * calc(n - 1,k) % mod) % mod; \n\t}\n\tm--;\n\tfor(int k = 0;k < n;k++)\n\t{\n\t\tlong long cnt = (m - 2 * n + k + 2) / 3;\n\t\tif(m - 2 * n + k + 2 >= 0)\n\t\t\tans = (ans + calc(cnt + n,n) * calc(n - 1,k) % mod) % mod; \n\t}\n\tm--;\n\tfor(int k = 0;k < n;k++)\n\t{\n\t\tlong long cnt = (m - 2 * n + k + 2) / 3;\n\t\tif(m - 2 * n + k + 2 >= 0)\n\t\t\tans = (ans + calc(cnt + n,n) * calc(n - 1,k) % mod) % mod; \n\t}\n\tcout << ans % mod; \n\treturn 0 ;\n}\n/*\nNOIP 2022 RP++\n*/\n```",
        "postTime": 1668040278,
        "uid": 302636,
        "name": "zhaoyp",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT_abc276_g\u3010[ABC276G] Count Sequences\u3011"
    },
    {
        "content": "\u6c42\u957f\u5ea6\u4e3a $n$ \u7684\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\u7684\u5e8f\u5217 $A$ \u7684\u4e2a\u6570\uff1a\n\n- $a_1\\leq a_2\\leq a_3......\\leq a_n\\leq M$\n\n- $\\forall 1\\leq i <n,a_i \\not \\equiv a_{i+1}(\\bmod\\ 3)$\n\n\u6211\u4eec\u73b0\u5728\u5bf9 $A$ \u5e8f\u5217\u4f5c\u5dee\u5206\u3002\u5f97\u5230 $B$ \u5e8f\u5217\u3002\u6211\u4eec\u770b\u770b $B$ \u8fd9\u4e2a\u5e8f\u5217\u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\uff1a\n\n- $b_i \\geq 0 $\n\n- $\\forall i>1, \\ b_i \\bmod3 \\not=0$\n\n- $\\sum b_i\\leq M$\n\n\u6240\u4ee5\u6211\u4eec\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684 $B$ \u5e8f\u5217\u7684\u4e2a\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4ee4 $x_i=b_i \\bmod 3,y_i=\\lfloor \\frac{b_i}{3} \\rfloor$ \u3002\u5982\u679c\u6211\u4eec\u77e5\u9053\u4e86\u5e8f\u5217 $X$ \u662f\u600e\u6837\u7684\u3002\u90a3\u4e48\u5bf9\u5e94\u7684\u5e8f\u5217 $Y$ \u7684\u4e2a\u6570\u5c31\u7b49\u4ef7\u4e8e\u975e\u8d1f\u6574\u6570\u5e8f\u5217\uff0c\u5e76\u4e14\u6ee1\u8db3 $\\sum y_i\\le \\lfloor \\frac{M-\\sum x_i}{3} \\rfloor$ \u7684\u4e2a\u6570\u3002\u8fd9\u4e2a\u4e1c\u897f\u4f3c\u4e4e\u5f88\u597d\u7b97\u3002\u76f8\u5f53\u4e8e\u662f\u6709 $n$ \u4e2a\u76d2\u5b50\uff0c\u4e00\u5171\u8981\u653e $T\\le \\lfloor \\frac{M-\\sum x_i}{3} \\rfloor$ \u4e2a\u6570\uff0c\u95ee\u4f60\u603b\u65b9\u6848\u6570\uff0c\u5176\u5b9e\u5c31\u662f $\\binom{n+T-1}{n-1}$\u3002\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053 $C=\\sum x_i$ \u7684 $X$ \u5e8f\u5217\u6709\u591a\u5c11\u4e2a\u5c31\u884c\u4e86\u3002\u56e0\u4e3a $x_i$ \u7684\u53d6\u503c\u53ea\u6709 $1,2$ \u6240\u4ee5\u6211\u4eec\u679a\u4e3e $2$ \u6709\u51e0\u4e2a\uff0c\u8fd9\u4e2a\u4e1c\u897f\u5c31\u80fd\u968f\u4fbf\u7b97\u4e86\uff0c\u603b\u5f0f\u5b50\u5e94\u8be5\u662f\uff1a\n\n$$\\sum_{i=0}^{M-n} \\binom{n}{i}\\sum_{T=0}^{\\lfloor \\frac{M-n-i}{3} \\rfloor}\\binom{n+T-1}{n-1}$$\n\n\u4f46\u662f\u6211\u4eec\u8fd8\u6ca1\u8003\u8651 $\\ b_1 \\bmod3=0$ \u7684\u60c5\u51b5\uff0c\u5c06\u5e8f\u5217\u957f\u5ea6\u51cf\u4e00\u518d\u505a\u4e00\u904d\u5c31\u884c\u4e86\u3002",
        "postTime": 1667703521,
        "uid": 295543,
        "name": "beauty_son_whm",
        "ccfLevel": 6,
        "title": "\u9898\u89e3abc276 G"
    },
    {
        "content": "### \u9898\u610f\n\n\u8981\u6c42\u6784\u9020\u4e00\u4e2a\u503c\u57df\u5728 $[0,m]$ \u5185\uff0c\u6709 $n$ \u9879\u7684\u5355\u8c03\u4e0d\u964d\u5e8f\u5217\uff0c\u8981\u6c42\u76f8\u90bb\u4e24\u9879\u7684\u6570\u9664\u4ee5\u4e09\u4e0d\u540c\u4f59\u3002\n\n### \u601d\u8def\n\n\u9996\u5148\u8003\u8651\u5982\u4f55\u4f7f\u5e8f\u5217\u5355\u8c03\u4e0d\u964d\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u6c42\u5b83\u7684\u81ea\u7136\u6570\u5dee\u5206\u5e8f\u5217\u7684\u65b9\u6848\u5373\u53ef\u3002\n\n\u8003\u8651\u5982\u4f55\u6ee1\u8db3\u76f8\u90bb\u4e24\u9879\u4e0d\u540c\u4f59\u3002\n\n\u5373\u9664\u9996\u9879\u5916\uff0c\u6bcf\u4e00\u9879\u7684\u503c\u5fc5\u987b $\\equiv 1\\pmod 3$ \u6216 $\\equiv 2\\pmod 3$\u3002\n\n\u6240\u4ee5\u8003\u8651\u679a\u4e3e $\\equiv 1\\pmod 3$ \u7684\u4e2a\u6570\u3002\n\n\u679a\u4e3e\u65f6\uff0c\u7531\u4e8e\u8fd8\u53ef\u4ee5\u7ed9\u67d0\u51e0\u9879\u52a0 $3$\u3002\n\n\u6240\u4ee5\u8fd9\u65b9\u9762\u7684\u65b9\u6848\u6570\u4e5f\u9700\u8981\u52a0\u4e0a\u3002\n\n\u7b54\u6848\u5373\u4e3a\u3002\n\n$$\\sum_{i=1}^{i\\le n,n\\times2-i\\le m}C_{n}^{i}\\times \\sum_{j=1}^{\\lfloor\\frac{m-x+i}{3}\\rfloor}C^{n-1}_{n+j-1}$$\n\n\u540e\u9762\u8fd9\u4e00\u5806\u4e5f\u5c31\u662f $3$ \u7684\u65b9\u6848\u6570\uff0c\u4f7f\u7528\u9694\u677f\u6cd5\u8ba1\u7b97\uff0c\u53ef\u4ee5\u8003\u8651\u9884\u5904\u7406\u3002\n\n\u524d\u9762\u7684\u4e5f\u5c31\u662f\u679a\u4e3e $1$ \u7684\u65b9\u6848\u6570\uff0c\u6ce8\u610f\u52a0\u8d77\u6765\u4e0d\u8981\u8d85\u8fc7 $m$\u3002\n\n\u4f46\u662f\u4e0a\u8ff0\u5f0f\u5b50\u5ffd\u7565\u4e86\u9996\u9879\u53ef\u4ee5\u4e3a $0$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u5728\u7b97\u51fa $n-1$ \u7684\u65b9\u6848\u5373\u53ef\uff0c\u5373\u6307\u5b9a\u7b2c\u4e00\u4e2a\u521d\u59cb\u4e3a $0$\u3002\n\n### Code\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nconst int N = 20000010;\nconst int mod = 998244353;\n\nint n, m, inv[N], sum[N];\n\ninline int read()\n{\n    int asd = 0 , qwe = 1; char zxc;\n    while(!isdigit(zxc = getchar())) if(zxc == '-') qwe = -1;\n    while(isdigit(zxc)) asd = asd * 10 + zxc - '0' , zxc = getchar();\n    return asd * qwe;\n}\n\ninline int power(int x , int y)\n{\n    int res = 1;\n    while(y)\n    {\n        if(y & 1) res = res * x % mod;\n        x = x * x % mod, y /= 2;\n    }\n    return res;\n}\n\ninline int C(int x , int y)\n{\n    return inv[x] * power(inv[x - y], mod - 2) % mod * power(inv[y], mod - 2) % mod;\n}\n\ninline int solve(int x)\n{\n    int ans = 0;\n    for (int i = 0; i <= x; i++)\n    {\n        int op1 = i, op2 = x - i;\n        if (op2 * 2 + op1 > m) continue;\n        int op3 = (m - op2 * 2 - op1) / 3;\n        ans = (ans + C(x , op1) * sum[op3] % mod) % mod;\n    }\n    return ans;\n}\n\nsigned main()\n{\n    n = read(), m = read(), inv[0] = sum[0] = 1;\n    for (int i = 1; i <= 2 * max(n, m); i++)\n        inv[i] = inv[i - 1] * i % mod;\n    for (int i = 1; i <= m / 3; i++)\n        sum[i] = (sum[i - 1] + C(n + i - 1 , n - 1)) % mod;\n    cout << (solve(n) + solve(n - 1)) % mod << endl;\n    return 0;\n}\n```",
        "postTime": 1668151863,
        "uid": 320933,
        "name": "Mfeitveer",
        "ccfLevel": 0,
        "title": "AT_abc276_g [ABC276G] Count Sequences \u9898\u89e3"
    },
    {
        "content": "\u7ed9\u5b9a $n,m$ \u6c42\u6ee1\u8db3\u6761\u4ef6\u7684\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\u4e2a\u6570\uff1a\n\n- $0\\le a_1\\le a_2\\le\\dots\\le a_n\\le m$ \n- $\\forall 1\\le i\\lt n ,a_{i+1}\\mod 3\\ne a_i\\mod 3$ \n\n\u8bb0 $d_i=a_{i+1}-a_i$ \n\n\u6613\u5f97 $\\forall 1\\le i<n,d_i\\ne 3k$ \n\n$d_i$ \u9664\u4ee5 3 \u4f59\u6570\u662f 1 \u6216 2\n\n\u679a\u4e3e\u5934\u5c3e\u4f59\u6570\uff080/1/2\uff09\uff0c\u4e2d\u95f4\u6709\u591a\u5c11\u4e2a 2\n\n\u53ef\u4ee5\u76f4\u63a5\u7ec4\u5408\u6570\u7b97\n\n```c++\n#include <bits/stdc++.h>\n#define pb push_back\n#define mp make_pair\n#define sz(a) ((int)a.size())\n#define re return\n#define all(a) a.begin(),a.end()\n#define int long long\n#define rept(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,a) rept(i,0,a)\n#define vi vector<int>\n#define pii pair<int,int>\n#define F first\n#define S second\n#define elif else if\nusing namespace std;\nconst int MOD=998244353,INF=1000000000000000000;\ntemplate<typename T>inline void Mx(T &a,T b){a=max(a,b);}\ntemplate<typename T>inline void Mi(T &a,T b){a=min(a,b);}\ninline int ad(int &a,int b,int c=MOD){re a=(a+b)%c;}\ntemplate<typename T>inline T read(){T a;cin>>a;re a;}\ninline bool is_digit(int msk,int d){re (msk>>d)&1;}\nconst int dx[4]={-1,1,0,0},dy[4]={0,0,-1,1};\nvoid FILEIO(string s){\n\tfreopen((s+\".in\").c_str(),\"r\",stdin);\n\tfreopen((s+\".out\").c_str(),\"w\",stdout);\n}\nint fc[20000007],iv[20000007];\ninline int qp(int a,int b){\n\tint c=1;\n\twhile(b){\n\t\tif(b&1)(c*=a)%=MOD;\n\t\t(a*=a)%=MOD;b>>=1;\n\t}\n\tre c;\n}\ninline int inv(int x){\n\tre qp(x,MOD-2);\n}\ninline void init(){\n\tfc[0]=iv[0]=1;\n\trept(i,1,20000005){\n\t\tfc[i]=fc[i-1]*i%MOD;\n\t\tiv[i]=inv(fc[i]);\n\t}\n}\ninline int C(int x,int y){\n\tre fc[x]*iv[y]%MOD*iv[x-y]%MOD;\n}\ninline int calc(int n,int m){\n\tint ans=0;\n\trep(l,3)rep(r,3){\n\t\trep(num,n){\n\t\t\tint ned=l+r+n-1+num;\n\t\t\tif(ned>m||(m-ned)%3)continue;\n\t\t\tned=(m-ned)/3;\n\t\t\t(ans+=C(n-1,num)*C(ned+n,n)%MOD)%=MOD;\n\t\t}\n\t}\n\tre ans;\n}\nvoid run(){\n\tinit();\n\tint n,m;\n\tcin>>n>>m;\n\tcout<<calc(n,m)<<\"\\n\";\n}\nsigned main()\n{\n//\tios::sync_with_stdio(0);\n//\tcin.tie(0);cout.tie(0);\n//\tfor(int tc=read<int>();tc;tc--)\n\t\trun();\n\tre 0;\n}\n\n\n```",
        "postTime": 1668084657,
        "uid": 483879,
        "name": "hyman00",
        "ccfLevel": 0,
        "title": "AT_abc276_g \u9898\u89e3"
    }
]
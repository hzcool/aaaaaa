[
    {
        "content": "\u8bbe $S = \\sum s_i$\uff0c\u8bb0\u5b9e\u6570 $x$ \u7684\u5c0f\u6570\u90e8\u5206\u4e3a $\\{x\\}$\u3002\n\n\u6211\u4eec\u5728\u7b97 $f$ \u65f6\u8981\u8ba1\u6570\u4e09\u4e2a\u4e0d\u5b9a\u7684\u5143\uff0c\u8fd9\u4e0d\u592a\u597d\u523b\u753b\uff0c\u5148\u6307\u5b9a\u4e00\u4e2a\u5143\u3002\n\n\u8bbe $g(k)$ \u8868\u793a\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u4e09\u5143\u7ec4 $(a,b,c)$ \u7684\u4e2a\u6570\uff1a\n- $c = k,a,b\\in[0,c)$\u3002\n- $a\\times s_i + b$ \u6a21 $c$ \u5bf9 $i$ \u5355\u8c03\u9012\u589e\u3002\n\n\u53ef\u4ee5\u77e5\u9053 $g$ \u5c31\u662f $f$ \u7684\u5dee\u5206\uff0c\u5373 $f(r) = \\sum_{k = 1}^r g(k)$\u3002\n\n\u80fd\u591f\u8bc1\u660e\u6781\u9650 $\\lim\\limits_{k\\to \\infty} \\dfrac{g(k)}{k^2}$ \u5b58\u5728\uff0c\u5e76\u8bbe\u5b83\u4e3a $c$\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u5e94\u7528 [O'Stolz \u5b9a\u7406](https://blog.csdn.net/jingye333/article/details/108857909)\u5373\u53ef\u8bf4\u660e\n\n$$\\lim_{r\\to \\infty} \\frac{f(r)}{r^3} = \\lim_{r\\to \\infty} \\frac{f(r) - f(r - 1)}{r^3 - (r - 1)^3} = \\lim_{r\\to \\infty} \\frac{g(r)}{3r^2 + o(r^2)} = \\frac{1}{3}c$$\n\n\u63a5\u4e0b\u6765\u53ea\u9700\u8981\u8ba1\u7b97 $c$\u3002$c$ \u7684\u5b58\u5728\u6027\u5c06\u5728\u6700\u540e\u7ed9\u51fa\uff0c\u56e0\u4e3a\u6211\u4eec\u5fc5\u987b\u8981\u5148\u8868\u793a\u51fa $c$\uff0c\u968f\u540e\u624d\u80fd\u6309\u8fd9\u4e2a\u7b49\u4ef7\u63cf\u8ff0\u8bc1\u660e\u6536\u655b\u6027\u3002\n\n\u6027\u8d28\u8868\u660e $y_i = a\\times s_i + b\\text{ mod } k$ \u5173\u4e8e $i$ \u9012\u589e\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u5c06 $y_i$ \u9664\u4ee5 $k$\uff0c$y_i / k$ \u7684\u5c0f\u6570\u90e8\u5206\u4e5f\u5173\u4e8e $i$ \u9012\u589e\uff0c\u8fd9\u4e5f\u5c31\u662f $\\left\\{(a/k) s_i + (b/k)\\right\\}$ \u5173\u4e8e $i$ \u9012\u589e\u3002\u7531\u4e8e $\\dfrac{a}{k},\\dfrac{b}{k}\\in [0, 1)$\uff0c\u6211\u4eec\u4e0d\u59a8\u8003\u8651\u4e00\u4e2a $\\mathbb R^2$ \u7684\u5b50\u7a7a\u95f4 $D$\uff0c\u5b9a\u4e49\u4e3a\n\n$$D = \\{(\\alpha, \\beta) \\in [0, 1]^2\\mid \\forall i, \\  \\alpha s_i + \\beta < \\alpha s_{i + 1} + \\beta\\}$$\n\n\u8fd9\u6837\u53c8\u53ef\u4ee5\u5b9a\u4e49 $g(k)$ \u4e3a $D$ \u7684\u4e00\u4e2a\u5b50\u7a7a\u95f4\u7684\u5927\u5c0f\uff0c\u4e5f\u5c31\u662f $g(k) = \\left\\lvert\\left\\{(a, b) \\in \\mathbb Z^2 \\mid 0\\le a, b < k, \\ (a / k, b / k)\\in D \\right\\}\\right\\rvert$\u3002\u7531\u4e8e $D$ \u662f\u4e00\u4e2a\u6709\u754c\u95ed\u96c6\uff0c\u5b83\u7684\u5927\u5c0f\u662f\u6536\u655b\u7684\u3002\u6211\u4eec\u5728\u6700\u540e\u8fd8\u5c06\u8bc1\u660e $c$ \u6536\u655b\u4e8e $D$ \u7684\u5927\u5c0f\u3002\u8fd9\u91cc\u5148\u8003\u8651\u5982\u4f55\u8ba1\u7b97 $c$\uff0c\u4e5f\u5c31\u662f $D$ \u7684\u5927\u5c0f\uff0c\u8bc1\u660e\u7559\u5728\u6700\u540e\u3002\n\n\u63a5\u4e0b\u6765\u4e0d\u8003\u8651 $\\left\\{\\alpha s_i + \\beta \\right\\}= \\left\\{\\alpha s_{i + 1} + \\beta\\right\\}$\uff0c\u56e0\u4e3a\u8fd9\u5bf9\u533a\u57df $D$ \u7684\u5927\u5c0f\u6ca1\u6709\u5f71\u54cd\u3002\n\n\u8003\u8651\u628a $[0, 1)$ \u9996\u5c3e\u76f8\u63a5\u7ec4\u6210\u4e00\u4e2a\u73af\uff0c\u5e76\u8ba9 $\\left\\{\\alpha s_i + \\beta \\right\\}$ \u4f5c\u4e3a\u8fd9\u73af\u4e0a\u4e00\u4e2a\u70b9\u3002\u6211\u4eec\u79f0 $0,1$ \u76f8\u63a5\u7684\u4f4d\u7f6e\u4e3a\u65ad\u70b9\u3002\u8003\u8651\u5728 $\\alpha, \\beta$ \u53d8\u5316\u8fc7\u7a0b\u4e2d\u8ba1\u7b97\u5408\u6cd5\u7684\u8303\u56f4\u3002   \n$\\beta$ \u53ea\u662f\u5e73\u79fb\uff0c\u6682\u4e14\u4e0d\u7ba1\uff0c\u5148\u8003\u8651\u5728 $\\alpha$ \u53d8\u5316\u7684\u8fc7\u7a0b\u4e2d $\\left\\{\\alpha s_i\\right\\}$ \u8fd9\u4e9b\u70b9\u7684\u60c5\u51b5\u3002\u6211\u4eec\u8bbe $f_i(\\alpha)$ \u4e3a\u70b9 $\\left\\{\\alpha s_i\\right\\}$ \u5230\u70b9 $\\left\\{\\alpha s_{i + 1}\\right\\}$ \u987a\u65f6\u9488\u65b9\u5411\u7684\u8ddd\u79bb\uff0c\u4e5f\u5c31\u662f $f_i(\\alpha) = \\left\\{\\alpha (s_{i + 1} - s_i)\\right\\}$\uff08\u5b9a\u4e49 $s_{n + 1} = s_1$\uff09\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e00\u4e2a $\\alpha$ \u5b58\u5728 $\\beta$ \u4f7f\u5f97\u6ee1\u8db3\u6761\u4ef6\u5f53\u4e14\u4ec5\u5f53 $\\sum_{i = 1}^n f_i(\\alpha) = 1$\uff0c\u4e5f\u5c31\u662f\u8fd9 $n$ \u4e2a\u4f4d\u7f6e\u987a\u65f6\u9488\u6392\u5217\u3002\n\n\u7136\u540e\u8003\u8651\u8ba1\u7b97 $\\beta$ \u7684\u8303\u56f4\u3002\u8fd9\u5176\u5b9e\u5c31\u662f\u628a\u8fd9 $n$ \u4e2a\u987a\u65f6\u9488\u6392\u5217\u7684\u4f4d\u7f6e\u4e0d\u65ad\u65cb\u8f6c\uff0c\u4f7f\u5f97\u65ad\u70b9\u5728 $s_1, s_n$ \u4e4b\u95f4\u3002\u8fd9\u6761\u4ef6\u7b49\u4ef7\u4e8e $\\left\\{\\alpha s_1 + \\beta \\right\\} < \\left\\{\\alpha s_n + \\beta \\right\\}$\u3002\u56e0\u6b64\u53ef\u4ee5\u77e5\u9053\uff0c\u786e\u5b9a $\\alpha$ \u540e\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684 $\\beta$ \u6240\u7ec4\u6210\u7684\u533a\u95f4\u7684\u957f\u5ea6\u4e3a $\\left\\{(s_1 - s_n)\\alpha \\right\\}$\u3002\u8fd9\u662f\u597d\u7b97\u7684\u3002   \n\u5f53\u65ad\u70b9\u5728\u4e24\u4e2a\u70b9\u4e4b\u95f4\u79fb\u52a8\u65f6\uff0c\u8ba1\u7b97 $\\beta$ \u7684\u53d6\u503c\u96c6\u5408\u5927\u5c0f\u662f\u7b80\u5355\u7684\u3002$\\beta$ \u6240\u7ec4\u6210\u7684\u533a\u95f4\u7684\u957f\u5ea6\u662f\u4ee5 $\\alpha$ \u4e3a\u81ea\u53d8\u91cf\uff0c$(s_1 - s_n)$ \u4e3a\u659c\u7387\u7684\u4e00\u6b21\u51fd\u6570\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u5b83\u505a\u4e00\u6b21\u79ef\u5206\u5373\u53ef\u3002   \n\u8003\u8651\u5230\u65ad\u70b9\u7684\u79fb\u52a8\u4f1a\u8de8\u8d8a\u70b9\uff0c\u9700\u8981\u5c06\u6700\u7ec8\u9700\u8981\u505a\u79ef\u5206\u7684\u51fd\u6570\u89c6\u4e3a\u5206\u6bb5\u4e00\u6b21\u51fd\u6570\uff0c\u8003\u8651\u5982\u4f55\u8ba1\u7b97\u5206\u6bb5\u70b9\u3002\u5bf9\u4e00\u4e2a $i$\uff0c\u4f4d\u7f6e $\\alpha$ \u56e0\u4e3a\u5b83\u800c\u6210\u4e3a\u5206\u6bb5\u70b9\u5f53\u4e14\u4ec5\u5f53 $\\exists k, \\ \\alpha = \\dfrac{k}{|s_{i + 1} - s_i|}$\uff0c\u5b9e\u9645\u610f\u4e49\u5c31\u662f\u8fd9\u4e2a\u70b9\u5bf9\u5e94\u7684\u503c $\\pm 1$\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u603b\u5171\u6709 $O(\\sum_{i} |s_{i + 1} - s_i|)\\le O(\\sum_{i} s_{i + 1} + s_i) = O(S)$ \u4e2a\u5206\u6bb5\u70b9\u3002\n\n\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u6240\u6709\u5206\u6bb5\u70b9\u5e76\u6392\u5e8f\uff0c\u76f8\u90bb\u4e24\u4e2a\u70b9\u95f4\u7684\u79ef\u5206\u503c\u662f\u597d\u6c42\u7684\uff0c\u56e0\u6b64\u76f4\u63a5\u5199\u53ef\u4ee5\u505a\u5230 $O(S\\log S)$ \u7684\u590d\u6742\u5ea6\u3002\n\n[Submission](https://atcoder.jp/contests/arc126/submissions/40045917).\n\n\u6700\u540e\u6211\u4eec\u8981\u8bc1\u660e $c$ \u6536\u655b\u4e8e\u533a\u57df $D$ \u7684\u9762\u79ef\u3002\n\n\u5bf9\u533a\u57df $D\\subset \\mathbb R^2$\uff0c\u8bb0 $\\lambda(D)$ \u4e3a $D$ \u7684[\u52d2\u8d1d\u683c\u6d4b\u5ea6](https://blog.csdn.net/my_brother/article/details/108228740)\uff0c\u5373 $D$ \u7684\u201c\u9762\u79ef\u201d\uff1b$D^{\\circ}$ \u4e3a $D$ \u7684\u5185\u90e8\uff08interior\uff09\uff0c$\\overline D$ \u4e3a $D$ \u7684\u95ed\u5305\uff08closure\uff09\u3002\u5e76\u5b9a\u4e49\u5173\u4e8e $D$ \u7684\u6307\u793a\u51fd\u6570 $I_D$\uff0c$I_D(x) = 1$ \u5f53\u4e14\u4ec5\u5f53 $x\\in D$\u3002\n\n\u6211\u4eec\u5c06\u8bc1\u660e\u7684\u662f\u4ee5\u4e0b\u7ed3\u8bba\uff1a\n> \u8bbe $D\\subset \\mathbb R^2$ \u662f\u6709\u754c\u96c6\uff0c\u4e14\u5176\u8fb9\u754c\u7684\u6d4b\u5ea6\u4e3a $0$\uff0c\u5373 $\\lambda(D^{\\circ}) = \\lambda(\\overline D)$\u3002\u4ee4 $g(k)$ \u4e3a\u6ee1\u8db3 $(a/k, b/k)\\in D$ \u7684\u6574\u6570\u5bf9 $(a, b)$ \u7684\u6570\u91cf\u3002\u6709\n> \n> $$\\lim_{k\\to\\infty} \\frac{g(k)}{k^2} = \\lambda(D)$$\n\n\u63a5\u4e0b\u6765\u5b9a\u4e49\u4e09\u4e2a\u7cbe\u5ea6\u4e3a $k$ \u7684\u6307\u793a\u96c6\u5408 $A_k, A_k^{\\circ}, \\overline{A}_k$\u3002\u5f62\u5f0f\u5316\u5730\uff0c\u6709\n- $A_k = \\left\\{(a, b)\\mid ka\\in \\mathbb Z, kb\\in \\mathbb Z, (a, b) \\in D\\right\\}$   \n    \u4e5f\u5c31\u662f\u4e0a\u9762\u7684\u6761\u4ef6\uff0c\u4f46\u662f\u5012\u8fc7\u6765\u7edf\u8ba1 $(a/k, b/k)$\u3002\u5bb9\u6613\u77e5\u9053 $g(k) = |A_k|$\u3002\n- $A_k^{\\circ} = \\left\\{(a, b)\\mid ka\\in \\mathbb Z, kb\\in \\mathbb Z, [a, a + \\frac{1}{k})\\times [b, b + \\frac{1}{k}) \\in D^{\\circ}\\right\\}$   \n    \u653e\u5728\u4e8c\u7ef4\u5e73\u9762\u4e0a\uff0c$(a, b)$ \u5728\u96c6\u5408\u5185\u5f53\u4e14\u4ec5\u5f53\u5176\u5de6\u4e0a\u89d2\u4e00\u4e2a\u957f\u5bbd\u4e3a $\\frac{1}{k}$ \u7684\u7a7a\u95f4\u5747\u88ab\u5305\u542b\u5728 $D$ \u7684\u5185\u90e8\u4e2d\u3002\n- $\\overline{A}_k = \\left\\{(a, b)\\mid ka\\in \\mathbb Z, kb\\in \\mathbb Z, [a, a + \\frac{1}{k})\\times [b, b + \\frac{1}{k}) \\cap \\overline D\\neq \\varnothing\\right\\}$   \n    \u653e\u5728\u4e8c\u7ef4\u5e73\u9762\u4e0a\uff0c$(a, b)$ \u5728\u96c6\u5408\u5185\u5f53\u4e14\u4ec5\u5f53\u5176\u5de6\u4e0a\u89d2\u4e00\u4e2a\u957f\u5bbd\u4e3a $\\frac{1}{k}$ \u7684\u7a7a\u95f4\u548c $D$ \u7684\u95ed\u5305\u6709\u4ea4\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u7684\u662f\uff0c$A_k^{\\circ} \\subset A_k \\subset \\overline{A}_k$\u3002\n\n\u5728 $A_k^{\\circ}$ \u548c $\\overline{A}_k$ \u7684\u5b9a\u4e49\u4e2d\uff0c\u6211\u4eec\u628a\u4e00\u4e2a\u70b9\u770b\u505a\u4e86\u4e00\u4e2a\u957f\u5bbd\u4e3a $\\frac{1}{k}$ \u7684\u7a7a\u95f4\u3002\u56e0\u6b64\uff0c$A_k^{\\circ}$ \u548c $\\overline{A}_k$ \u5b9e\u9645\u4e0a\u63cf\u8ff0\u7684\u662f $\\mathbb R^2$ \u7684\u4e00\u4e2a\u5b50\u7a7a\u95f4\uff0c\u6211\u4eec\u4e5f\u9700\u8981\u518d\u5b9a\u4e49\u4e24\u4e2a\u5173\u4e8e $A_k^{\\circ}$ \u548c $\\overline{A}_k$ \u7684\u3001\u6307\u793a\u5176\u6240\u5bf9\u5e94\u533a\u57df\u7684\u6307\u793a\u51fd\u6570\u3002\u6211\u4eec\u5b9a\u4e49 $P_k^{\\circ}$ \u548c $\\overline{P}_k$ \u5206\u522b\u4e3a $A_k^{\\circ}$ \u548c $\\overline{A}_k$ \u7684\u7c7b\u6307\u793a\u51fd\u6570\uff0c\u5f62\u5f0f\u5316\u5730\u6709\n\n- $P_k^{\\circ}(x) = 1$ \u5f53\u4e14\u4ec5\u5f53 $x \\in \\bigcup_{(a, b) \\in A_k^{\\circ}} [a, a + \\frac 1k] \\times [b, b + \\frac 1k]$\u3002\n- $\\overline{P}_k(x) = 1$ \u5f53\u4e14\u4ec5\u5f53 $x \\in \\bigcup_{(a, b) \\in \\overline{A}_k} [a, a + \\frac 1k] \\times [b, b + \\frac 1k]$\u3002\n\n\u7531\u4e8e $A_k^{\\circ},\\overline{A}_k$ \u4e2d\u6bcf\u4e2a\u5143\u7d20\u5b9e\u9645\u4e0a\u5bf9\u5e94\u4e86\u4e00\u4e2a\u5927\u5c0f\u4e3a $\\dfrac{1}{k^2}$ \u7684\u7a7a\u95f4\uff0c\u4ee5\u4e0b\u7684\u7ed3\u8bba\u662f\u4e0d\u8a00\u800c\u55bb\u7684\uff1a\n$$\\int_{D^{\\circ}} P_k^{\\circ}(p) \\text dp = \\frac{|A_k^{\\circ}|}{k^2} \\qquad \\int_{\\overline{D}} \\overline{P}_k(p) \\text dp = \\frac{|\\overline{A}_k|}{k^2}$$\n\n\u6700\u540e\u7684\u4e00\u5757\u62fc\u56fe\u9700\u8981\u5b58\u5728\u6781\u9650\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u7cbe\u5ea6 $k\\to \\infty$\uff0c\u4e00\u4e2a\u4e8c\u7ef4\u70b9 $(a, b)$ \u6240\u5bf9\u5e94\u7684\u7a7a\u95f4\u8d8b\u5411\u4e8e $0$\u3002\u8fd9\u4e5f\u8868\u660e\uff0c\u5728 $k\\to \\infty$ \u7684\u8fc7\u7a0b\u4e2d\uff0c\u7c7b\u6307\u793a\u51fd\u6570\u5c06\u8d8b\u8fd1\u4e8e\u6307\u793a\u51fd\u6570\u3002\u8fd9\u4e5f\u6307\u51fa\u4e86\u4ee5\u4e0b\u7684\u7ed3\u8bba\uff1a\n$$\\lim_{k\\to \\infty} P_k^{\\circ}(x) = I_{D^{\\circ}}(x)\\qquad \\lim_{k\\to \\infty} \\overline{P}_k(x) = I_{\\overline{D}}(x)$$\n\n\u7531\u4e8e\u6307\u793a\u51fd\u6570\u7684\u6027\u8d28\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u627e\u5230\u5b83\u7684\u63a7\u5236\u51fd\u6570\u3002\u56e0\u6b64\u6839\u636e\u52d2\u8d1d\u683c\u63a7\u5236\u6536\u655b\u5b9a\u7406\u5f97\u5230\n\n$$\\lim_{k\\to \\infty} \\frac{|A_k^{\\circ}|}{k^2} = \\lim_{k\\to \\infty} \\int_{R^2} P_k^{\\circ}(p) \\text dp =  \\int_{R^2} \\lim_{k\\to \\infty}P_k^{\\circ}(p) \\text dp = \\int_{R^2} I_{D^{\\circ}}(p) \\text dp = \\lambda(D^{\\circ})$$\n\n\u540c\u7406\u53ef\u77e5\n\n$$\\lim_{k\\to \\infty} \\frac{|\\overline{A}_k|}{k^2} = \\lambda(\\overline{D})$$\n\n\u7531 $A_k^{\\circ} \\subset A_k \\subset \\overline{A}_k$ \u4e0e $\\lambda(D^{\\circ}) =  \\lambda(\\overline{D})$\uff0c\u5e76\u6839\u636e\u5939\u903c\u5b9a\u7406\u53ef\u77e5\n\n$$\\lambda(D) = \\lim_{k\\to \\infty} \\frac{|A_k|}{k^2} = \\lim_{k\\to \\infty} \\frac{g(k)}{k^2}$$\n\n\u8fd9\u4e5f\u5c31\u5b8c\u6210\u4e86\u8bc1\u660e\u3002",
        "postTime": 1679801995,
        "uid": 631791,
        "name": "joke3579",
        "ccfLevel": 0,
        "title": "ARC126F \u9898\u89e3"
    },
    {
        "content": "\u76ee\u524d\u4e3a\u6b62\u5728 ARC \u505a\u5230\u8fc7\u7684\u6700\u9707\u64bc\u7684\u6570\u5b66\u9898\u3002\n\n\u6211\u4eec\u5148\u628a $f(K)$ \u6539\u5199\u4e00\u4e0b\uff0c\u8bbe $g(K)$ \u8868\u793a\u5f53 $c=K$ \u65f6\u5408\u6cd5\u7684 $(a, b)$ \u4e8c\u5143\u7ec4\u6570\uff0c\u90a3\u4e48\u5c31\u6709\uff1a\n\n$$\nf(K) = \\sum_{i=0}^K g(i)\n$$\n\n\u90a3\u4e48\u6839\u636e [O'Stolz \u5b9a\u7406](https://baike.baidu.com/item/O%27Stolz%E5%AE%9A%E7%90%86/10421698) \u6211\u4eec\u8981\u6c42\u7684\u5f0f\u5b50\u4e3a\uff1a\n\n$$\n\\lim_{K \\to \\infty} \\frac{f(K)}{K^3} = \\lim_{K \\to \\infty} \\frac{g(K)}{3K^2} = \\frac{1}{3}\\lim_{K \\to \\infty} \\frac{g(K)}{K^2}\n$$\n\n> **O'Stolz \u5b9a\u7406**\uff1a\n> \u7b80\u5355\u6765\u8bf4\u5c31\u662f\u6d1b\u5fc5\u8fbe\u6cd5\u5219\u7684\u79bb\u6563\u7248\u672c\uff0c\u53ef\u4ee5\u7528\u4e8e\u6c42\u6570\u5217\u6781\u9650\u3002\n> \u5047\u5982\u6709\u6570\u5217 $\\{a_n\\}, \\{b_n\\}$ \u6ee1\u8db3\uff1a\n> 1. $\\{b_n\\}$ \u4e25\u683c\u5355\u8c03\u9012\u589e\uff1b\n> 2. $\\lim_{n \\to \\infty} b_n = +\\infty$\uff1b\n>\n> \u90a3\u4e48\u6709\uff1a\n>\n> $$\\lim_{n\\to \\infty} \\frac{a_n}{b_n} = \\lim_{n \\to \\infty} \\frac{a_{n + 1} - a_n}{b_{n + 1} - b_n}$$\n\n\u90a3\u4e48\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa $\\lim_{K \\to \\infty}\\frac{g(K)}{K^2}$ \u5373\u53ef\u3002\n\n\u6211\u4eec\u4e0d\u59a8\u628a\u95ee\u9898\u8f6c\u6362\u4e00\u4e0b\uff1a\n\n$$aX_i + b \\bmod K \\to \\frac{a}{K}X_i + \\frac{b}{K} \\bmod 1$$\n\n\u800c\u7531\u4e8e $K \\to \\infty$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u4e3a $\\frac{a}{K}, \\frac{b}{K}$ \u53d6\u904d $[0, 1]$ \u5185\u7684\u6240\u6709\u5b9e\u6570\u3002\n\n\u90a3\u4e48\u5047\u5982\u8bbe $\\alpha = \\frac{a}{K}, \\beta = \\frac{b}{K}$\uff0c\u5e76\u4e14\u5c06\u6240\u6709\u5408\u6cd5\u7684 $(\\alpha, \\beta)$ \u770b\u505a\u4e00\u4e2a\u4e8c\u7ef4\u5e73\u9762\u4e0a\u7684\u4e00\u4e2a\u5927\u5c0f\u4e3a $\\frac{1}{K^2}$ \u7684\u533a\u57df\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u6c42\u7684 $\\frac{g(K)}{K^2}$ \u5c31\u662f\u6c42\u8fd9\u4e2a\u4e8c\u7ef4\u5e73\u9762\u7684\u9762\u79ef\u3002\u5f53 $K \\to \\infty$ \u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u6bcf\u4e00\u4e2a $\\frac{1}{K^2}$ \u7684\u9762\u79ef\u8fd1\u4f3c\u7684\u770b\u505a\u4e00\u4e2a\u70b9\uff0c\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u76f8\u5f53\u4e8e\u5c31\u662f\u6c42\u8fd9\u4e2a\u4e8c\u7ef4\u5e73\u9762\u4e0a\u7684\u79ef\u5206\u4e86\u3002\u5b9e\u9645\u4e0a\uff0c\u53ef\u4ee5\u8bc1\u660e\u4e24\u8005\u7684\u6781\u9650\u662f\u76f8\u7b49\u7684\uff0c\u8be6\u89c1 joke3579 \u7684\u9898\u89e3\u3002\n\n![image](https://img.atcoder.jp/arc126/315c80a05e5ddacb508411c1d2b99051.png)\n\n\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u5c31\u628a $\\alpha, \\beta$ \u770b\u505a\u662f $[0, 1]$ \u4e0a\u7684\u5b9e\u6570\u6765\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u6211\u4eec\u8bbe $\\{x\\}$ \u4e3a $x$ \u7684\u5c0f\u6570\u90e8\u5206\uff0c\u5373 $x \\bmod 1 = x - \\lfloor x\\rfloor$\u3002\n\n\u5bf9\u4e8e $\\bmod 1$ \u7684\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u653e\u5230\u4e00\u4e2a\u73af\u4e0a\u6765\u8003\u8651\uff0c\u7136\u540e\u5c06\u6bcf\u4e2a\u6570\u770b\u505a\u73af\u4e0a\u7684\u70b9\u3002\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\uff0c$\\beta$ \u7684\u4f5c\u7528\u5c31\u662f\u5c06\u6574\u4e2a\u73af\u65cb\u8f6c\u4e86\u82e5\u5e72\u4f4d\u7f6e\u3002\u5047\u5982\u6b64\u65f6 $\\{\\alpha X_i\\}$ \u4ece\u67d0\u4e00\u4f4d\u7f6e\u5f00\u59cb\u662f\u6709\u5e8f\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u65cb\u8f6c\u4f7f\u5f97\u4ed6\u4eec\u4ece $0$ \u5f00\u59cb\u662f\u6709\u5e8f\u7684\u3002\u8fd9\u76f8\u5f53\u4e8e\u5c06 $0$ \u7684\u4f4d\u7f6e\u65cb\u8f6c\u5230 $\\{\\alpha X_1\\}$ \u4e0e $\\{\\alpha X_n\\}$ \u4e4b\u95f4\uff0c\u90a3\u4e48\u5bf9\u4e8e\u67d0\u4e00\u4e2a\u56fa\u5b9a\u7684 $\\alpha$\uff0c\u5408\u6cd5\u7684 $\\beta$ \u7684\u79ef\u5206\u4e3a $\\{\\alpha(X_1-X_n)\\}$\u3002\n\n![image](https://img.atcoder.jp/arc126/23c0b3ac0b68a80f8989034e3fbeba80.png)\n\n\u90a3\u4e48\u6211\u4eec\u5982\u4f55\u786e\u5b9a\u5bf9\u4e8e\u54ea\u4e9b $\\alpha$ \u6765\u8bf4\uff0c$\\{\\alpha X_i\\}$ \u4ece\u67d0\u4e00\u4f4d\u7f6e\u5f00\u59cb\u662f\u6709\u5e8f\u7684\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8ddd\u79bb\u4e4b\u548c\u6765\u523b\u753b\u8fd9\u4ef6\u4e8b\u60c5\u3002\u8bbe $d_k(\\alpha) = \\{\\alpha(X_{k \\bmod n + 1} - X_k)\\}$\uff0c\u90a3\u4e48\u6709\u5e8f\u5f53\u4e14\u4ec5\u5f53 $D(\\alpha)=\\sum_{k=1}^n d_k(\\alpha) = 1$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651 $D(\\alpha)$ \u5728\u54ea\u91cc\u53d6\u5230 $1$\uff0c\u5bf9\u8fd9\u4e9b $\\alpha$ \u8ba1\u7b97\u4e0a\u8ff0\u7684 $\\beta$ \u7684\u79ef\u5206\u5373\u53ef\u3002\n\n\u540c\u65f6\uff0c\u6211\u4eec\u6ce8\u610f\u5230\u659c\u7387 $\\sum_{i=1}^n (X_{k \\bmod n + 1} - X_k) = 0$\uff0c\u4e5f\u5c31\u662f\u8bf4 $D(\\alpha)$ \u7684\u56fe\u50cf\u4e3a\u82e5\u5e72\u6761\u6a2a\u7740\u7684\u76f4\u7ebf\u7ec4\u6210\u7684\uff0c\u90a3\u4e48\u5982\u679c\u6211\u4eec\u627e\u51fa\u6240\u6709 $y=1$ \u7684\u76f4\u7ebf\u7684\u533a\u57df\uff0c\u5bf9\u8fd9\u4e9b\u533a\u57df\u8fdb\u884c\u79ef\u5206\uff0c\u5c31\u80fd\u8ba1\u7b97\u51fa\u7b54\u6848\u4e86\u3002\n\n\u6211\u4eec\u5148\u8003\u8651\u4e00\u4e2a\u5355\u72ec\u7684\u51fd\u6570 $f(x) = \\{kx\\}$ \u957f\u4ec0\u4e48\u6837\u5b50\u3002\u53d1\u73b0\u8fd9\u5c31\u662f\u4e00\u4e2a\u4e00\u6b21\u51fd\u6570\uff0c\u5e76\u5728\u6709\u9650\u4e2a\u4f4d\u7f6e\u8fdb\u884c\u4e86 $\\pm 1$ \u7684\u503c\u7684\u53d8\u5316\u3002\n\n![image](https://img.atcoder.jp/arc126/b7369e3f682fd14f8e522665b9153bc8.png)\n\n\u800c\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u6837\u7684\u53d8\u5316\u7684\u4f4d\u7f6e\u7684\u6570\u91cf\u662f $O(\\sum X_i)$ \u7684\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u66b4\u529b\u7ef4\u62a4\u51fa\u6240\u6709\u8fd9\u6837\u7684\u70b9\uff0c\u8fd9\u6837\u5c31\u80fd\u7ef4\u62a4\u51fa $D(\\alpha)$ \u7684\u56fe\u50cf\u4e86\u3002\u627e\u5230\u56fe\u50cf\u4e4b\u540e\uff0c\u5bf9\u6bcf\u4e00\u6bb5 $y=1$ \u7684\u4f4d\u7f6e\u6c42 $\\int_{l}^r \\{\\alpha(X_1 - X_n)\\}$\u3002\u8fd9\u4e2a\u79ef\u5206\u540c\u6837\u53ef\u4ee5\u4ece\u95f4\u65ad\u70b9\u65ad\u5f00\uff0c\u6c42\u82e5\u5e72\u4e2a\u4e00\u6b21\u51fd\u6570\u7684\u79ef\u5206\u5373\u53ef\u3002\n\n\u4ee3\u7801\u8d3a\u7684\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 1005, P = 998244353;\nint qpow(int a, int b) {\n    int ans = 1;\n    while (b) {\n        if (b & 1) ans = 1ll * ans * a % P;\n        a = 1ll * a * a % P;\n        b >>= 1;\n    }\n    return ans;\n}\nint n, x[MAXN];\nstruct Fraction {\n    int a, b;\n    Fraction(int x = 0, int y = 1) : a(x), b(y) {\n        int g = __gcd(a, b);\n        a /= g, b /= g;\n    }\n    bool operator<(const Fraction &x) const {\n        return 1ll * a * x.b < 1ll * b * x.a;\n    }\n    bool operator<=(const Fraction &x) const {\n        return !(x < *this);\n    }\n    operator int() {\n        return 1ll * a * qpow(b, P - 2) % P;\n    }\n};\nmap<Fraction, int> mp;\nint integral(int k, int b, int l, int r) {\n    k = (k % P + P) % P;\n    b = (b % P + P) % P;\n    return (\n        (P + 1ll) / 2 * k % P * r % P * r % P + 1ll * b * r % P - \n        (P + 1ll) / 2 * k % P * l % P * l % P - 1ll * b * l % P + 2 * P\n    ) % P;\n}\nint main() {\n    scanf(\"%d\", &n);\n    for (int i = 1; i <= n; i++) {\n        scanf(\"%d\", &x[i]);\n    }\n    x[n + 1] = x[1];\n    for (int i = 1; i <= n; i++) {\n        if (x[i] < x[i + 1]) {\n            for (int j = 1; j < x[i + 1] - x[i]; j++) {\n                mp[{j, x[i + 1] - x[i]}]--;\n            }\n        } else {\n            for (int j = 0; j < x[i] - x[i + 1]; j++) {\n                mp[{j, x[i] - x[i + 1]}]++;\n            }\n        }\n    }\n    mp[{0, 1}], mp[{1, 1}];\n    int y = 0, b = 0;\n    int ans = 0;\n    vector<pair<Fraction, int>> v;\n    for (auto p : mp) {\n        v.push_back(p);\n    }\n    for (int i = 0; i + 1 < v.size(); i++) {\n        y += v[i].second;\n        while (Fraction(b + 1, abs(x[1] - x[n])) <= v[i].first) b++;\n        if (y == 1) {\n            ans = (ans + integral(x[1] - x[n], x[1] > x[n] ? -b : b + 1, v[i].first, v[i + 1].first)) % P;\n        }\n    }\n    ans = 1ll * ans * qpow(3, P - 2) % P;\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```",
        "postTime": 1684844350,
        "uid": 279652,
        "name": "APJifengc",
        "ccfLevel": 9,
        "title": "\u300c\u89e3\u9898\u62a5\u544a\u300dARC126F Affine Sort"
    }
]
[
    {
        "content": "\u672c\u9898\u9700\u8981\u4f7f\u7528**\u5b57\u5178\u6811**\u3002\n\n\u5148\u5c06\u6240\u6709\u7684\u5b57\u7b26\u4e32\u5b58\u8fdb\u5b57\u5178\u6811\uff0c\u7528 $t_{p,x}$ \u8868\u793a\u8fde\u5728\u7f16\u53f7\u4e3a $p$ \u7684\u7ed3\u70b9\u4e0b\u65b9\u7684\u5b57\u7b26 $x$\uff08\u8fd9\u91cc\u7684 $x$ \u5e76\u4e0d\u662f\u6307\u5c0f\u5199\u5b57\u6bcd $\\texttt{x}$\uff0c\u800c\u662f\u4e00\u4e2a\u5b57\u7b26\u578b\u53d8\u91cf\uff09\u3002\u6bcf\u6b21\u63d2\u5165\u53ea\u7528\u4e0d\u65ad\u5f80\u4e0b\u201c\u7ffb\u201d\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u5b57\u7b26\u4e32\uff0c\u5ffd\u7565\u5b57\u5178\u6811\u91cc\u5b83\u201c\u72ec\u6709\u7684\u201d\u7ed3\u70b9\uff0c\u7136\u540e\u770b\u770b\u6700\u6df1\u53ef\u4ee5\u5339\u914d\u5230\u591a\u6df1\u2014\u2014\u8fd9\u4e2a\u6df1\u5ea6\u5373\u4e3a\u8fd9\u4e2a\u5b57\u7b26\u4e32\u7684\u7b54\u6848\u3002\n\n\u653e\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint t[500001][26],w,r[500001];\nvoid insert(string s){\n  int p=0;\n  for(char i:s){\n    int x=i-97;\n    if(!t[p][x])t[p][x]=++w;\n    else r[t[p][x]]++; // \u7edf\u8ba1\u7ecf\u8fc7\u6bcf\u4e2a\u7ed3\u70b9\u7684\u5b57\u7b26\u4e32\u662f\u5426\u5927\u4e8e\u4e00\u4e2a\uff0c\u5982\u679c\u591a\u4e8e\u4e00\u4e2a\u90a3\u4e48 r[t[p][x]] \u5e94\u8be5\u662f\u5927\u4e8e 0 \u7684\n    p=t[p][x]; // \u524d\u5f80\u4e0b\u4e00\u4e2a\u7ed3\u70b9\uff0c\u201c\u5f80\u4e0b\u7ffb\u201d\n  }\n}\nint find(string s){\n  int p=0,c=0;\n  for(char i:s){\n    int x=i-97;\n    if(r[t[p][x]])c++; // \u5982\u679c\u4e0d\u6b62\u4e00\u4e2a\uff0c\u5c31\u7ee7\u7eed\u641c\u4e0b\u53bb\n    else break; // \u5426\u5219\u9000\u51fa\n    p=t[p][x];\n  }\n  return c;\n}\nmain(){\n  ios::sync_with_stdio(false);\n  int n,m=0; cin>>n;\n  vector<string> a(n);\n  for(auto &i:a)cin>>i,insert(i);\n  for(auto i:a)cout<<find(i)<<endl;\n  return 0;\n}\n```",
        "postTime": 1675169961,
        "uid": 556366,
        "name": "zyc212303",
        "ccfLevel": 5,
        "title": "[ABC287E] Karuta \u9898\u89e3"
    },
    {
        "content": "\u7b80\u5355\u9898\uff0c\u76f4\u63a5\u5b57\u5178\u6811\u8d70\u8d77\u3002\n\n\u6211\u4eec\u5c06\u5b57\u7b26\u4e32\u63d2\u5165\u5b57\u5178\u6811\uff0c\u7136\u540e\uff0c\u76f4\u63a5\u67e5\u627e\u6700\u5927\u524d\u7f00\u5373\u53ef\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u5f53\u524d\u4f4d\u7f6e\u7684\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5982\u679c\u5176\u5305\u542b\u7684\u5b57\u7b26\u4e32\u6570\u91cf\u4e3a $1$\uff0c\u90a3\u4e48\u5c31\u53ea\u6709\u5b83\u672c\u8eab\u4e86\uff0c\u5426\u5219\uff0c\u5c31\u662f\u8fd8\u6709\u522b\u7684\u5b57\u7b26\u4e32\u53ef\u4ee5\u8ddf\u5176\u5339\u914d\uff0c\u4e0b\u4e00\u4f4d\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n```cpp\n#include <bits/stdc++.h>\n#define LL long long\nusing namespace std;\nconst LL N = 5e5 + 5;\nstruct node {\n    LL son[26], sz;\n};\nvector<node> t;\nLL n, cnt = 1;\nstring s[N];\nvoid ins(string s) {\n    LL x = 1;\n    t[x].sz++;\n    for (auto i : s) {\n        if (t[x].son[i - 'a'] == 0)\n            t[x].son[i - 'a'] = ++cnt, t.push_back({ 0, 0 });\n        x = t[x].son[i - 'a'];\n        t[x].sz++;\n    }\n}\nLL find(string s) {\n    LL x = 1, cnt = 0;\n    for (auto i : s) {\n        LL son = t[x].son[i - 'a'];\n        if (t[son].sz > 1)\n            x = son, cnt++;\n        else\n            break;\n    }\n    return cnt;\n}\nint main() {\n    scanf(\"%lld\", &n);\n    t.push_back({ 0, 0 }), t.push_back({ 0, 0 });\n    for (int i = 1; i <= n; i++) {\n        cin >> s[i];\n        ins(s[i]);\n    }\n    for (int i = 1; i <= n; i++) {\n        printf(\"%lld\\n\", find(s[i]));\n    }\n}\n```",
        "postTime": 1683375868,
        "uid": 501947,
        "name": "DengDuck",
        "ccfLevel": 6,
        "title": "[ABC287E] Karuta \u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_abc287_e)\n\n## $\\mathtt{Solution}$\n\n\u6839\u636e\u6570\u636e\u8303\u56f4\u548c\u9898\u76ee\uff0c\u4e0d\u96be\u60f3\u5230\u662f\u7528\u54c8\u5e0c\u6765\u622a\u53d6\u5b50\u4e32\uff0c\u5b9a\u4e49\u54c8\u5e0c\u6570\u7ec4\u4e3a $h$\uff0c\u57fa\u5e95\u4e3a $E$\u3002\n\n\u5982\u679c\u6211\u4eec\u60f3\u622a\u53d6 $l,l+1\\dots r$ \u7684\u5b57\u7b26\uff0c\u90a3\u4e48\u622a\u53d6\u51fa\u6765\u7684\u5b50\u4e32\u7684\u54c8\u5e0c\u503c\u4e3a $h[r] - h[l - 1] \\times E^{r - l + 1}$\uff0c\u628a\u6bcf\u4e2a\u524d\u7f00\u7edf\u8ba1\u51fa\u6765\u540e\u7528 map \u7edf\u8ba1\u7b54\u6848\u3002\n\n\u4f46\u662f\u6ce8\u610f\uff0c\u6bcf\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u53ef\u80fd\u5f88\u957f\uff0c\u4e5f\u53ef\u80fd\u5f88\u77ed\uff0c\u6545\u7528 vector \u6765\u5b58\u54c8\u5e0c\u7684\u503c\u3002\n\n\u5177\u4f53\u7ec6\u5219\u89c1\u4ee3\u7801\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int unsigned long long\nusing namespace std;\nconst int MAXN = 5e5 + 5, E = 1023643;//E\u4e3a\u57fa\u5e95\uff0c\u5982\u679c\u51fa\u73b0bug\u53ef\u4ee5\u6539\u6210E=10\nint n, k;\nstring s[MAXN];\nvector<int> h[MAXN];\nmap<int, int>mp;\nvoid calc(string ch, int x){\n\th[x].push_back(0);\n\tint res = 0, len = ch.length();\n\tfor(int i = 1;i <= len;i ++){\n\t\tres *= E;\n\t\tres += ch[i - 1] - 'a' + 1;//\u54c8\u5e0c\u6570\u7ec4\u521d\u59cb\u5316\n\t\th[x].push_back(res);\n\t}\n}\nint fpow(int a, int b){//\u5feb\u901f\u5e42\n\tint res = 1;\n\twhile(b){\n\t\tif(b & 1)res = res * a;\n\t\ta = a * a;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\nint Hash(int x, int l, int r){\n\treturn h[x][r] - h[x][l - 1] * fpow(E, r - l + 1);//\u622a\u53d6\u5b50\u4e32\uff0c\u8981\u7528\u5feb\u901f\u5e42\u662f\u56e0\u4e3a\u9700\u8981\u8865\u4f4d\n}\nsigned main(){\n\tscanf(\"%lld\", &n);\n\tfor(int i = 1;i <= n;i ++){\n\t\tcin>>s[i];\n\t\tcalc(s[i], i);\n\t\tint len = s[i].length();\n\t\tfor(int j = 1;j <= len;j ++)mp[Hash(i, 1, j)] ++;//\u5c06\u6bcf\u4e00\u4e2a\u622a\u53d6\u597d\u7684\u5b50\u4e32\u653e\u8fdbmap\u91cc\u9762\n\t}\n\tfor(int i = 1;i <= n;i ++){\n\t\tint cnt = 0, len = s[i].length();\n\t\tfor(int j = 1;j <= len;j ++){\n\t\t\tif(mp[Hash(i, 1, j)] > 1)cnt = j;//\u5927\u4e8e1\u662f\u56e0\u4e3a\u81ea\u5df1\u4e0d\u7b97\n\t\t\telse break;//\u5fc5\u987b\u8fde\u7eed\u7684\u76f8\u7b49\u624d\u7b97\uff0c\u6240\u4ee5\u8fd9\u91ccbreak\n\t\t}\n\t\tprintf(\"%lld\\n\", cnt);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1675517063,
        "uid": 668869,
        "name": "Fire_flame",
        "ccfLevel": 5,
        "title": "ABC287E\u9898\u89e3"
    },
    {
        "content": "\u5927\u4f53\u601d\u8def\u662f\u5bf9\u4e8e\u6bcf\u4e2a\u4e32\uff0c\u6c42\u51fa\u6bcf\u4e2a\u524d\u7f00\u6c42\u51fa\u54c8\u5e0c\u503c\u5e76\u5b58\u50a8\u4e0b\u6765\uff0c\u663e\u7136\u54c8\u5e0c\u503c\u7684\u6570\u91cf\u662f $O(\\sum|S_i|)$ \u7684\uff0c\u53ef\u4ee5\u66b4\u529b\u6c42\u5f97\u5e76\u5b58\u50a8\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u4e32\u6c42\u89e3\u7b54\u6848\u7684\u65f6\u5019\uff0c\u8003\u8651\u679a\u4e3e\u524d\u7f00\u5e76\u67e5\u8be2\u5176\u54c8\u5e0c\u503c\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u7531\u4e8e\u8fd9\u4e2a\u524d\u7f00\u5728\u9884\u5904\u7406\u7684\u65f6\u5019\u88ab\u52a0\u5165\u4e86\u4e00\u6b21\u54c8\u5e0c\u8868\uff0c\u6240\u4ee5\u5982\u679c\u5f53\u524d\u54c8\u5e0c\u503c\u51fa\u73b0\u6b21\u6570\u591a\u4e8e\u4e24\u6b21\u7684\u8bdd\u5c31\u8bf4\u660e\u5f53\u524d\u524d\u7f00\u5728\u5176\u5b83\u4e32\u91cc\u51fa\u73b0\u8fc7\uff0c\u90a3\u4e48\u8fd9\u4e2a\u524d\u7f00\u957f\u5ea6\u5c31\u662f\u53ef\u4ee5\u53bb\u66f4\u65b0\u7b54\u6848\u7684\uff0c\u663e\u7136\u8fd9\u90e8\u5206\u590d\u6742\u5ea6\u4e5f\u662f $O(\\sum|S_i|)$ \u7684\u3002\n\n\u6211\u56fe\u65b9\u4fbf\u76f4\u63a5\u628a\u6240\u6709\u7684\u54c8\u5e0c\u503c\u6392\u5e8f\u4e86\uff0c\u6240\u4ee5\u4f1a\u5e26\u4e2a $\\log$\uff0c\u5176\u5b9e\u662f\u53ef\u4ee5\u4f18\u5316\u6389\u7684\u3002\n\n```cpp\n#include<bits/stdc++.h>\n//#define feyn\n#define int long long\n#define ptt pair<int,int>\n#define mp make_pair\nusing namespace std;\nconst int A=1e9+7;\nconst int B=1e9+9;\nconst int P=1e7;\nconst int N=500010;\ninline void read(int &wh){\n    wh=0;int f=1;char w=getchar();\n    while(w<'0'||w>'9'){if(w=='-')f=-1;w=getchar();}\n    while(w<='9'&&w>='0'){wh=wh*10+w-'0';w=getchar();}\n    wh*=f;return;\n}\n\nmt19937 rnd(123);\nint m,n,dataa[26];\nstring w[N];\n\nptt a[N];\n\nsigned main(){\n\t\n\t#ifdef feyn\n\tfreopen(\"in.txt\",\"r\",stdin);\n\t#endif\n\t\n\tread(m);int cnt=0;\n\tfor(int i=0;i<26;i++){\n\t\tdataa[i]=rnd()%P;\n\t\tif(dataa[i]<0)dataa[i]*=-1;\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tcin>>w[i];n=w[i].size();\n\t\tint aa=0,bb=0;\n\t\tfor(int j=0;j<n;j++){\n\t\t\taa=(aa*P+dataa[w[i][j]-'a'])%A;\n\t\t\tbb=(bb*P+dataa[w[i][j]-'a'])%B;\n\t\t\ta[++cnt]=mp(aa,bb);\n\t\t}\n\t}\n\tsort(a+1,a+cnt+1);\n\tfor(int i=1;i<=m;i++){\n\t\tint ans=0,aa=0,bb=0;n=w[i].size();\n\t\tfor(int j=0;j<n;j++){\n\t\t\taa=(aa*P+dataa[w[i][j]-'a'])%A;\n\t\t\tbb=(bb*P+dataa[w[i][j]-'a'])%B;\n\t\t\tint pl=lower_bound(a+1,a+cnt+1,mp(aa,bb))-a;\n\t\t\tif(a[pl+1]==mp(aa,bb))ans=j+1;\n\t\t}\n\t\tprintf(\"%lld\\n\",ans); \n\t}\n\t\n\treturn 0;\n}\n```",
        "postTime": 1675496520,
        "uid": 302383,
        "name": "Feyn",
        "ccfLevel": 0,
        "title": "AT_abc287_e"
    },
    {
        "content": "### Solution\n\u5b57\u5178\u6811\u6a21\u677f\u9898\u3002\n\n\u9996\u5148\u5c06 $n$ \u4e2a\u5b57\u7b26\u4e32\u63d2\u5165\u5b57\u5178\u6811\uff0c\u518d\u4f9d\u6b21\u5bf9\u6bcf\u4e2a\u5b57\u7b26\u4e32\u5339\u914d\u3002\n\n\u5bf9\u4e8e\u5b57\u7b26\u4e32 $s$ \u7684\u5339\u914d\uff0c\u505a\u6cd5\u663e\u7136\u662f\u987a\u7740 $s$ \u4e2d\u5b57\u7b26\u7684\u987a\u5e8f\u4f9d\u6b21\u5f80\u4e0b\u627e\uff0c\u82e5\u6ca1\u6709\u5b50\u8282\u70b9\u5c31\u8fd4\u56de\u3002\n\n\u4f46\u7531\u4e8e\u6211\u4eec\u5f00\u59cb\u65f6\u5df2\u7ecf\u5c06\u6240\u6709\u5b57\u7b26\u4e32\u90fd\u63d2\u5165\u4e86\u5b57\u5178\u6811\uff0c\u5176\u4e2d\u4e5f\u5305\u62ec $s$\uff0c\u6240\u4ee5\u4e00\u5b9a\u80fd\u5339\u914d\u5230\u5e95\u3002\n\n\u89e3\u51b3\u529e\u6cd5\u662f\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5b57\u5178\u6811\u4e2d\u7684\u8282\u70b9 $x$\uff0c\u7ef4\u62a4\u4e00\u4e2a\u503c $cnt_x$\uff0c\u8868\u793a\u7ecf\u8fc7 $x$ \u7684\u5b57\u7b26\u4e32\u6570\u91cf\uff0c\u5219\u539f\u672c\u7684\u201c\u975e\u7a7a\u201d\u6761\u4ef6\u5c31\u53d8\u4e3a\u4e86 $cnt_x$ \u7684\u503c\u5927\u4e8e $1$\u3002\n\n\u7136\u540e\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n### \u4ee3\u7801\n\u5b57\u5178\u6811\u7801\u98ce\u6709\u70b9\u5947\u602a\uff0c\u52ff\u55b7\u3002\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector> \nusing namespace std;\nconst int maxn=5e5+5;\nstruct node\n{\n\tint son[30];\n}trie[maxn];\nstring s[maxn];\nint cnt[maxn*30],tot,n;//cnt\u5e94\u8be5\u5f00\u5230\u5b57\u5178\u6811\u8282\u70b9\u603b\u6570\u5927\u5c0f\nvoid insert(string s){\n\tint x=0;\n\tfor(int i=0;i<s.size();i++){\n\t\tint y=s[i]-'a'+1;\n\t\tif(!trie[x].son[y]) trie[x].son[y]=++tot;\n\t\tx=trie[x].son[y];\n\t\tcnt[x]++;//\u7ef4\u62a4cnt\n\t}\n}\nint query(string s){\n\tint x=0;\n\tfor(int i=0;i<s.size();i++){\n\t\tint y=s[i]-'a'+1;\n\t\tif(cnt[trie[x].son[y]]<=1) return i;//x\u5173\u4e8ey\u7684\u5b50\u8282\u70b9\u7684cnt<=1\uff0c\u6240\u4ee5\u53ea\u80fd\u5339\u914d\u5230s[i-1]\uff0c\u4f46string\u4e0b\u6807\u4ece0\u5f00\u59cb\uff0c\u6240\u4ee5\u7b54\u6848\u662fi-1+1=i\u3002\n\t\tx=trie[x].son[y];\n\t}\n\treturn s.size();\n}\nint main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\tcout.tie(0);\n\tcin>>n;\n\tfor(int i=1;i<=n;i++){\n\t\tcin>>s[i];\n\t\tinsert(s[i]);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tcout<<query(s[i])<<'\\n'; \n\treturn 0;\n}\n```",
        "postTime": 1677559164,
        "uid": 534296,
        "name": "aCssen",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 ABC287E"
    },
    {
        "content": "\u8981\u5339\u914d\u591a\u4e2a\u5b57\u7b26\u4e32\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\uff0c\u8fd9\u662f\u5b57\u5178\u6811\uff08trie \u6811\uff09\u7684\u7ecf\u5178\u5e94\u7528\u3002\u5728\u672c\u9898\u4e2d\uff0c\u53ea\u9700\u8981\u4e00\u6b21\u628a\u6240\u6709\u5b57\u7b26\u4e32\u52a0\u5165\u4e00\u68f5\u5b57\u5178\u6811\uff0c\u968f\u540e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f9d\u6b21\u68c0\u67e5\u4e0d\u5305\u542b\u5b83\u81ea\u8eab\u7684\u6700\u5927\u6df1\u5ea6\u5e76\u8f93\u51fa\u5373\u53ef\u3002\n\n\u5b57\u5178\u6811\u53ef\u4ee5\u5b66\u4e60 [\u8fd9\u7bc7\u535a\u5ba2](https://blog.csdn.net/zgdlxs/article/details/122648103)\uff0c\u5e76\u4ee5\u672c\u9898\u4f5c\u4e3a\u6a21\u677f\u662f\u975e\u5e38\u5408\u9002\u7684\u3002\n\n\u65f6\u95f4\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\u5747\u4e3a\u7ebf\u6027\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,cnt=1,cntt[500005],c[500005][26];\nstring s[500005];\nvoid insert(string s){\n\tint pos=1;cntt[pos]++;\n\tfor(int i=0;i<s.length();i++){\n\t\tif(!c[pos][s[i]-'a']) pos=c[pos][s[i]-'a']=++cnt;\n\t\telse pos=c[pos][s[i]-'a'];\n\t\tcntt[pos]++;\n\t}\n}\nsigned main(){\n\tcin>>n;\n\tfor(int i=1;i<=n;i++) cin>>s[i];\n\tfor(int i=1;i<=n;i++) insert(s[i]);\n\tfor(int i=1;i<=n;i++){\n\t\tint pos=1,ans=0;\n\t\tfor(int j=0;j<s[i].length();j++){\n\t\t\tpos=c[pos][s[i][j]-'a'];\n\t\t\tif(cntt[pos]>=2) ans=max(ans,j+1);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n```",
        "postTime": 1675562800,
        "uid": 527598,
        "name": "FReQuenter",
        "ccfLevel": 0,
        "title": "[ABC287E] Karuta \u9898\u89e3"
    },
    {
        "content": "\u8003\u8651\u5efa\u7acb\u4e00\u68f5 Trie \u6811\u3002\n\n\u5c06\u6240\u6709\u7684\u5b57\u7b26\u4e32\u63d2\u5165\u5230\u8fd9\u4e2a\u6811\u91cc\u3002\n\n\u7136\u540e\u5728\u63d2\u5165\u7684\u65f6\u5019\u6bcf\u4e00\u4e2a\u5730\u65b9\u90fd\u8bb0\u5f55\u4e00\u4e2a $cnt_i$ \u8868\u793a\u6709\u591a\u5c11\u4e2a\u5b57\u7b26\u4e32\u5b58\u5728\u8fd9\u4e2a\u524d\u7f00\u3002\n\n\u8be2\u95ee\u7684\u65f6\u5019\u53ef\u4ee5\u4e00\u76f4\u6cbf\u7740\u8fd9\u4e2a\u5b57\u7b26\u4e32\u8d70\uff0c\u7136\u540e\u5982\u679c\u8fd9\u4e2a\u5b57\u7b26\u4e32\u8d70\u5b8c\u4e86\u90a3\u4e48 $\\text{LCP}$ \u5c31\u662f\u8fd9\u4e2a\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u5982\u679c\u8d70\u5230\u4e00\u4e2a\u5730\u65b9\u7684\u65f6\u5019 $cnt_i=1$ \u8bf4\u660e\u6ca1\u6709\u522b\u7684\u5b57\u7b26\u4e32\u6709\u8fd9\u4e2a\u524d\u7f00\uff0c\u7b54\u6848\u5c31\u662f\u5f53\u524d\u8d70\u7684\u5b57\u7b26\u7684\u6570\u91cf $-1$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sum |s|)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int N = 1e6 + 10;\nstruct _2772eat5135_\n{\n  int next[26];\n} z[N];\nint cnt[N], c;\nstring s[N];\n\nvoid insert(const char *s)\n{\n  int p = 0;\n  for (int i = 0; s[i]; i ++)\n  {\n    int j = s[i] - 'a';\n    if (!z[p].next[j])\n      z[p].next[j] = ++ c;\n    p = z[p].next[j];\n    cnt[p] ++;\n  }\n}\n\nint query(const char *s)\n{\n  int p = 0, ans = 0;\n  for (int i = 0; s[i]; i ++)\n  {\n    int j = s[i] - 'a';\n    p = z[p].next[j];\n    if (cnt[p] == 1)\n      return ans;\n    ans ++;\n  }\n  return ans;\n}\n\nsigned main()\n{\n  int n;\n  cin >> n;\n  for (int i = 1; i <= n; i ++)\n  {\n    cin >> s[i];\n    insert(s[i].c_str());\n  }\n  for (int i = 1; i <= n; i ++)\n    cout << query(s[i].c_str()) << '\\n';\n  return 0;\n}\n\n```\n\n",
        "postTime": 1675474992,
        "uid": 378467,
        "name": "willem248",
        "ccfLevel": 5,
        "title": "AT_abc287_e"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a $N$ \u4e2a\u4ec5\u542b\u5c0f\u5199\u5b57\u6bcd\u7684\u5b57\u7b26\u4e32 $S_1,S_2,\\cdots,S_N$\u3002\u5b9a\u4e49 $\\operatorname{LCP}(x,y)$ \u4e3a\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u6700\u5927\u6574\u6570 $n$\uff0c\u5176\u4e2d $x,y$ \u90fd\u4e3a\u5b57\u7b26\u4e32\uff1a\n\n+ $|x|,|y| \\ge n$\u3002\n+ \u5bf9\u4e8e\u6bcf\u4e2a\u6574\u6570 $i\\,(1 \\le i \\le n)$\uff0c$x_i=y_i$\u3002\n\n\u73b0\u5728\u4f60\u9700\u8981\u5bf9\u4e8e\u6bcf\u4e2a\u6574\u6570 $i \\,(1 \\le i \\le N)$\uff0c\u6c42\u51fa $\\max\\limits_{i\\neq j}\\operatorname{LCP}(S_i,S_j)$\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1 \\le N \\le 5\\times 10^5$\uff0c\u6240\u6709 $S_i$ \u957f\u5ea6\u4e4b\u548c\u4e0d\u8d85\u8fc7 $5 \\times 10^5$\u3002\n\n------------\n\n### \u89e3\u6cd5\u5206\u6790\n\n\u8d5b\u65f6\u6ca1\u53d1\u73b0\u6709\u6392\u5e8f\u89e3\u6cd5\uff0c\u4e8e\u662f\u5c31\u65e0\u8111\u7801\u4e86\u4e2a\u54c8\u5e0c\u3002\n\n\u8bb0\u5f55\u8fd9 $N$ \u4e2a\u5b57\u7b26\u4e32\u7684\u6240\u6709\u524d\u7f00\u5b50\u4e32\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u4e3a\u4e86\u540e\u9762\u5904\u7406\u65b9\u4fbf\u53ef\u4ee5\u628a\u7a7a\u4e32\u4e5f\u7b97\u4e0a\u3002\u6bd4\u5982\u5f53 $S=\\{\\texttt{abc},\\texttt{abb},\\texttt{aac}\\}$ \u65f6\uff0c\u7a7a\u4e32\u548c $\\texttt{a}$ \u51fa\u73b0\u4e86 $3$ \u6b21\uff0c$\\texttt{ab}$ \u51fa\u73b0\u4e86 $2$ \u6b21\uff0c$\\texttt{aa},\\texttt{abc},\\texttt{abb},\\texttt{aac}$ \u51fa\u73b0\u4e86 $1$ \u6b21\u3002\u8fd9\u91cc\u76f4\u63a5\u628a\u8fd9\u4e48\u591a\u5b57\u7b26\u4e32\u5b58\u8fdb map \u663e\u7136\u4e0d\u73b0\u5b9e\uff0c\u6240\u4ee5\u9700\u8981\u5b58\u54c8\u5e0c\u503c\uff0c\u8fd9\u6837\u8fd9\u4e00\u90e8\u5206\u4e0d\u8003\u8651 map \u5b58\u50a8\u7684\u65f6\u95f4\u7684\u8bdd\u5c31\u662f $O(\\sum |S_i|)$\u3002\n\n\u63a5\u4e0b\u6765\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$\uff0c\u4ee4 $x=\\max\\limits_{i\\neq j}\\operatorname{LCP}(S_i,S_j)$\uff0c\u5219 $x$ \u5c31\u662f\u6ee1\u8db3\u201c$S_i$ \u4e2d\u957f\u5ea6\u4e3a $y$ \u7684\u524d\u7f00\u5b50\u4e32\u5728\u4e4b\u524d\u8bb0\u5f55\u7684\u5b57\u7b26\u4e32\u4e2d\u603b\u5171\u51fa\u73b0\u4e86\u81f3\u5c11\u4e24\u6b21\u201d\u7684\u6761\u4ef6\u7684\u6700\u5927 $y$\uff0c\u5176\u4e2d $y\\,(0 \\le y \\le |S_i|)$ \u4e3a\u4e00\u4e2a\u6574\u6570\uff0c\u957f\u5ea6\u4e3a $0$ \u7684\u662f\u7a7a\u4e32\u3002\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u662f\u4e24\u6b21\u800c\u4e0d\u662f\u4e00\u6b21\uff1a\u6709\u4e00\u6b21\u662f $S_i$ \u91cc\u7684\uff0c\u4e0d\u7b97\u3002\u8fd9\u91cc\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\uff0c\u4e0d\u8fc7\u7531\u4e8e\u663e\u7136 $x$ \u548c\u5bf9\u5e94\u5b50\u4e32\u51fa\u73b0\u6b21\u6570\u6ee1\u8db3\u5355\u8c03\u6027\uff0c\u6240\u4ee5 $x$ \u8fd8\u53ef\u4ee5\u901a\u8fc7\u4e8c\u5206\u5f97\u5230\u3002\u7528\u4e86\u4e8c\u5206\u4e4b\u540e\uff0c\u8fd9\u6574\u4e2a\u8fc7\u7a0b\u4f9d\u7136\u53ef\u4ee5\u901a\u8fc7\u54c8\u5e0c\u505a\u5230\u4e0d\u8003\u8651 map \u65f6\u6bcf\u6b21 $O(\\log |S_i|)$\uff0c\u5e26\u4e0a map \u52a0\u8d77\u6765\u4e5f\u4e0d\u4f1a\u8d85\u65f6\u3002\u6700\u540e\u8f93\u51fa\u5b83\u5373\u53ef\u3002\n\n~~\u5173\u4e8e\u6211\u4e3a\u4ec0\u4e48\u8d5b\u65f6\u4e0d\u76f4\u63a5\u679a\u4e3e\uff1a\u590d\u6742\u5ea6\u7b97\u9519\u4e86\u3002~~\n\n\u4e0d\u8fc7\u597d\u50cf\u5355\u6a21\u6570\u54c8\u5e0c\u88ab\u5361\u4e86\uff08\u4e0d\u8981\u95ee\u6211\u600e\u4e48\u77e5\u9053\u7684\uff09\uff0c\u6240\u4ee5\u6211\u7801\u4e86\u4e2a\u53cc\u5e95\u6570\u7684\u3002\u4e8b\u5b9e\u8bc1\u660e\u7edd\u5bf9\u4e0d\u8981\u5728 Atcoder \u6bd4\u8d5b\u4e2d\u5199\u54c8\u5e0c\u65f6\u7528\u5355\u6a21\u6570\u3002\n\n------------\n\n### \u4ee3\u7801\n\n\u4e8c\u5206\u7684\u3002\n\n```cpp\n#pragma GCC optimize(2)\n#include <bits/stdc++.h>\n#define ll long long\n#define pb push_back\n#define pii pair<int,int>\nusing namespace std;\nconst ll N=5e5+7,MOD=1e9+7;\nll n,len[N];\nchar inp[N];\nvector <ll> v1[N],v2[N];\nmap <ll,map<ll,ll> > mp;\nint main() {\n\tscanf(\"%lld\",&n);\n\tmp[0][0]=n;\n\tfor (ll i=1,h1,h2;i<=n;i++) {\n\t\tscanf(\"%s\",inp+1),v1[i].pb(0),v2[i].pb(0),len[i]=strlen(inp+1),h1=h2=0;\n\t\tfor (int j=1;j<=len[i];j++)\n\t\t\th1=(h1*131+inp[j])%MOD,h2=(h2*133+inp[j])%MOD,\n\t\t\tv1[i].pb(h1),v2[i].pb(h2),mp[h1][h2]++;\n\t}\n\tfor (ll i=1;i<=n;i++) {\n\t\tll l=0,r=len[i],mid,ans=0;\n\t\twhile (l<=r) {\n\t\t\tmid=l+r>>1;\n\t\t\tif (mp[v1[i][mid]][v2[i][mid]]>=2) ans=mid,l=mid+1;\n\t\t\telse r=mid-1;\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1675218500,
        "uid": 319803,
        "name": "CarroT1212",
        "ccfLevel": 6,
        "title": "ABC287E Sol"
    },
    {
        "content": "\u8003\u8651\u4e8c\u5206 LCP\uff0c\u663e\u7136 LCP \u662f\u6709\u5355\u8c03\u6027\u7684\u3002\n\n\u7136\u540e\u7ef4\u62a4\u4e00\u4e0b\u54c8\u5e0c\uff0c\u7528 `multiset` \u5224\u65ad\u5b58\u5728\u6027\uff0c\u5c31\u53ef\u4ee5\u505a\u5230\u4e24\u53ea $\\log$\u3002\n\nABC \u8fd8\u5361\u4e86 $10^9+7$ \u7684\u5355\u6a21\u54c8\u5e0c\uff0c\u6240\u4ee5\u8d5b\u65f6\u7528\u4e86\u53cc\u6a21\u3002\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <cstdlib>\n#include <string>\nusing namespace std;\n\n#define ll long long\n\nconst int N = 5e5 + 5, INF = 2e9, MOD = 1e9 + 7, MOD2 = 998244353;\n\ninline int read()\n{\n\tint op = 1, x = 0;\n\tchar ch = getchar();\n\twhile ((ch < '0' || ch > '9') && ch != '-') ch = getchar();\n\twhile (ch == '-')\n\t{\n\t\top = -op;\n\t\tch = getchar();\n\t}\n\twhile (ch >= '0' and ch <= '9')\n\t{\n\t\tx = (x << 1) + (x << 3) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn x * op;\n}\n\ninline void write(int x)\n{\n\tif (x < 0) putchar('-'), x = -x;\n\tif (x > 9) write(x / 10);\n\tputchar(x % 10 + '0');\n}\n\nint n, m, t, maxn = 0;\nstring s[N];\nmultiset<pair<long long, long long> > st;\nvector<pair<long long, long long> > hs[N];\n\nlong long qpow(long long a, long long b)\n{\n\tlong long res = 1, base = a;\n\twhile (b)\n\t{\n\t\tif (b & 1)\n\t\t{\n\t\t\tres = res * base;\n\t\t\tres %= MOD;\n\t\t}\n\t\tbase *= base;\n\t\tbase %= MOD;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\n\nlong long qpow2(long long a, long long b)\n{\n\tlong long res = 1, base = a;\n\twhile (b)\n\t{\n\t\tif (b & 1)\n\t\t{\n\t\t\tres = res * base;\n\t\t\tres %= MOD2;\n\t\t}\n\t\tbase *= base;\n\t\tbase %= MOD2;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\n\nint main()\n{\n\t// freopen(\"*.in\", \"r\", stdin);\n\t// freopen(\"*.out\", \"w\", stdout);\n\tios::sync_with_stdio(false), cin.tie(nullptr), cout.tie(nullptr);\n\tcin >> n;\n\tfor (int i = 1; i <= n; i++)\n\t{\n\t\tcin >> s[i];\n\t\tlong long ph = 0, ph2 = 0;\n\t\tfor (int j = 0; j < s[i].size(); j++)\n\t\t{\n\t\t\tph += s[i][j] * qpow(26, j * 1LL) % MOD;\n\t\t\tph %= MOD;\n\t\t\tph2 += s[i][j] * qpow2(26, j * 1LL) % MOD2;\n\t\t\tph2 %= MOD2;\n\t\t\ths[i].emplace_back(make_pair(ph, ph2));\n\t\t\tst.insert(make_pair(ph, ph2));\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; i++)\n\t{\n\t\tfor (auto j : hs[i])\n\t\t{\n\t\t\tst.erase(st.find(j));\n\t\t}\n\t\tmaxn = 0;\n\t\tint l = 1, r = s[i].size();\n\t\twhile (l <= r)\n\t\t{\n\t\t\tint mid = l + r >> 1;\n\t\t\tauto g = hs[i][mid - 1];\n\t\t\tif (st.find(g) != st.end())\n\t\t\t{\n\t\t\t\tmaxn = mid;\n\t\t\t\tl = mid + 1;\n\t\t\t}\n\t\t\telse r = mid - 1;\n\t\t}\n\t\tfor (auto j : hs[i])\n\t\t{\n\t\t\tst.insert(j);\n\t\t}\n\t\tcout << maxn << \"\\n\";\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1675606168,
        "uid": 332914,
        "name": "happybob",
        "ccfLevel": 6,
        "title": "[ABC287E] Karuta"
    },
    {
        "content": "\u672c\u9898\u53ef\u4ee5\u4f5c\u4e3a\u5b57\u5178\u6811\u7684\u677f\u5b50\u7ec3\u624b\u3002\n\n\u5728\u63d2\u5165\u5b57\u7b26\u4e32\u65f6\u8bb0\u5f55\u5b57\u5178\u6811\u4e0a\u6bcf\u4e2a\u8282\u70b9\u88ab\u7ecf\u8fc7\u7684\u6b21\u6570\uff0c\u67e5\u8be2\u7684\u65f6\u5019\u5982\u679c\u5b57\u7b26\u4e32\u5bf9\u5e94\u8def\u5f84\u4e0a\u7684\u70b9\u6b21\u6570 $\\ge 2$ \u5c31\u7528\u5f53\u524d\u70b9\u6df1\u5ea6\u66f4\u65b0\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sum |S_i|)$\u3002\n\n\u8bc4\u4ef7\uff1a\u597d\u5199\uff0c\u800c\u4e14\u5feb\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n, pos, t[500005][26], cnt[500005];\nvector<string> vec;\nchar str[500005];\n \nvoid insert(string str)\n{\n  int p = 0;\n  for (int i = 0; i < str.size(); i++)\n  {\n    int c = str[i] - 'a';\n    if (!t[p][c])\n      t[p][c] = ++pos;\n    p = t[p][c];\n    cnt[p]++; // \u8bb0\u5f55\u7ecf\u8fc7\u6b21\u6570\n  }\n}\n \nint find(string str)\n{\n  int p = 0, res = 0;\n  for (int i = 0; i < str.size(); i++)\n  {\n    int c = str[i] - 'a';\n    if (!t[p][c])\n      t[p][c] = ++pos;\n    p = t[p][c];\n    if (cnt[p] > 1)\n      res = i + 1; // \u76f4\u63a5\u66f4\u65b0\u7b54\u6848\n  }\n  return res;\n}\n \nint main()\n{\n  scanf(\"%d\", &n);\n  for (int i = 0; i < n; i++)\n  {\n    scanf(\"%s\", str);\n    insert(str);\n    vec.push_back(str);\n  }\n  for (int i = 0; i < n; i++)\n    printf(\"%d\\n\", find(vec[i]));\n  return 0;\n}\n```",
        "postTime": 1675578207,
        "uid": 533854,
        "name": "CodingShark",
        "ccfLevel": 5,
        "title": "ABC287E \u9898\u89e3"
    }
]
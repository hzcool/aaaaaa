[
    {
        "content": "\u8fd9\u9053\u9898\u76f8\u5f53\u4e8e [AT_dp_T](https://www.luogu.com.cn/problem/AT_dp_t) \u7684\u5f3a\u5316\u7248\uff0c\u5982\u679c\u6ca1\u505a\u8fc7\u7684\u8bdd\u53ef\u4ee5\u5148\u53bb\u770b\u4e00\u770b\u90a3\u9053\u9898\u3002\n\n\u9996\u5148\u6211\u4eec\u4e0d\u96be\u53ef\u4ee5\u5217\u51fa\u65b9\u7a0b $dp[i][j][a][b]$ \u8868\u793a\u5728\u6392\u5217 $A$ \u4e2d\u7b2c $i$ \u4e2a\u6570\u7684\u6392\u6392\u540d\u4ece\u5c0f\u5230\u5927\u4e3a $a$ \u4ee5\u53ca\u5728\u6392\u5217 $B$ \u4e2d\u7b2c $i$ \u4e2a\u6570\u7684\u6392\u540d\u4ece\u5c0f\u5230\u5927\u4e3a $b$ \u6b64\u65f6\u76f8\u4f3c\u5ea6\u4e3a $j$ \u7684\u65b9\u6848\u6570\u3002\n\n\u4e0d\u96be\u80fd\u60f3\u51fa\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$dp[i][j][a][b]=\\sum^{i-1}_{x=a}\\sum^{b-1}_{y=1} dp[i-1][j][x][y]+\\sum^{a-1}_{x=1}\\sum^{i-1}_{y=b} dp[i-1][j][x][y]$\n\n$dp[i][j][a][b]=\\sum^{a-1}_{x=1}\\sum^{b-1}_{y=1}dp[i-1][j-1][x][y]+\\sum^{i-1}_{x=a}\\sum^{i-1}_{y=a}dp[i-1][j-1][x][y]$\n\n\u4e8c\u7ef4\u524d\u7f00\u548c\u4f18\u5316\u5373\u53ef\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define repe(i,l,r) for(int (i)=l;(i)<=r;(i)++)\n#define rep(i,n) for(int (i)=1;(i)<=n;(i)++)\n#define FOR(i,r,l) for(int (i)=r;(i)>=l;(i)--)\n#define INF 0x3f3f3f\n#define pii pair<int,int>\n#define mpr make_pair\n#define pb push_back\n#define ALL(v) (v).begin(),(v).end()\n#define rsort(v) sort(ALL(v),greater<int>())\n#define lb(v,x) (int)(lower_bound(ALL(v),x)-v.begin())\n#define ub(v,x) (int)(upper_bound(ALL(v),x)-v.begin())\n#define uni(v) v.resize(unique(ALL(v))-v.begin())\nusing namespace std;\nint read(){int sum=0,f=1;char c;c=getchar();while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}while(c>='0'&&c<='9'){sum=(sum<<1)+(sum<<3)+(c-'0');c=getchar();}return sum*f;}\nvoid out(int x){if(x<0){x=-x;putchar('-');}if(x>=10)out(x/10);putchar(x%10+'0');}\ntemplate <typename T>void die(T s){cout<<s<<endl;exit(0);}\nint fast(int a,int b,int P){int res=1;if(P<=0){while(b){if(b&1)res=res*a;a=a*a;b>>=1;}}else{while(b){if(b&1)res=res*a%P;a=a*a%P;b>>=1;}}return res;}\ntemplate <typename T>void chkmax(T& a,T b){if(a<b)a=b;return;}\ntemplate <typename T>void chkmin(T& a,T b){if(a>b)a=b;return;}\nconst int N=105;\nint dp[N][N][N][N],n,m,P;\nint sum[N][N],ans;\nsigned main(){\n\tn=read(),m=read(),P=read();\n\tdp[1][0][1][1]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tfor(int j=0;j<i-1;j++){\n\t\t\tmemset(sum,0,sizeof(sum));\n\t\t\tfor(int a=1;a<i;a++){\n\t\t\t\tfor(int b=1;b<i;b++){\n\t\t\t\t\tsum[a][b]=(sum[a][b-1]+sum[a-1][b]-sum[a-1][b-1]+dp[i-1][j][a][b])%P;\n\t\t\t\t\tsum[a][b]=(sum[a][b]+P)%P;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int a=1;a<=i;a++){\n\t\t\t\tfor(int b=1;b<=i;b++){\n\t\t\t\t\tdp[i][j][a][b]=(dp[i][j][a][b]+sum[i-1][b-1]-sum[a-1][b-1]+sum[a-1][i-1]-sum[a-1][b-1])%P;\n\t\t\t\t\tdp[i][j][a][b]=(dp[i][j][a][b]+P)%P;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int a=1;a<=i;a++){\n\t\t\t\tfor(int b=1;b<=i;b++){\n\t\t\t\t\tdp[i][j+1][a][b]=(dp[i][j+1][a][b]+sum[a-1][b-1]+sum[i-1][i-1]-sum[a-1][i-1]-sum[i-1][b-1]+sum[a-1][b-1])%P;\n\t\t\t\t\tdp[i][j+1][a][b]=(dp[i][j+1][a][b]+P)%P;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\trep(i,n){\n\t\trep(j,n){\n\t\t\tans=(ans+dp[n][m][i][j])%P;\n\t\t}\n\t}\n\tout(ans);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1672894479,
        "uid": 454955,
        "name": "ktq_cpp",
        "ccfLevel": 7,
        "title": "AT_abc282_g \u9898\u89e3"
    }
]
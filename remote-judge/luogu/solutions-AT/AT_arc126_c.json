[
    {
        "content": "\u628a $k$ \u80fd\u591f\u628a\u6240\u6709\u7684 $A$ \u90fd\u6dfb\u5230 $\\max A$ \u7684\u60c5\u51b5\u7279\u5224\u6389\uff0c\u8fd9\u6837\u7b54\u6848\u53ea\u53ef\u80fd $\\leq \\max A$\uff0e\n\n\u5f00\u4e2a\u6876\uff0c\u7528\u524d\u7f00\u548c\u7ef4\u62a4\u503c\u57df\u4e0a\u7684 $A$ \u7684\u4e2a\u6570\uff0c$A$ \u7684\u548c\uff0c\u679a\u4e3e\u6bcf\u4e00\u4e2a\u53ef\u80fd\u7684\u7b54\u6848 $x$\uff0c\u7136\u540e\u679a\u4e3e $x$ \u7684\u500d\u6570\uff0c\u53ef\u4ee5\u5feb\u901f\u7edf\u8ba1\u6240\u9700\u7684\u6700\u5c0f\u4ee3\u4ef7\uff1a\u5047\u8bbe\u679a\u4e3e\u5230 $kx$\uff0c\u8981\u7edf\u8ba1 $((k-1)x,kx]$ \u533a\u95f4\u5185\u7684\u82b1\u8d39\uff0c\u5c31\u662f $kx\\cdot cnt-sum$\uff0e\n\n\u590d\u6742\u5ea6\u662f\u8c03\u548c\u7ea7\u6570\u7684\u3002\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define int long long\ntypedef long long ll;\ntemplate <typename T> T Max(T x, T y) { return x > y ? x : y; }\ntemplate <typename T> T Min(T x, T y) { return x < y ? x : y; }\ntemplate <typename T>\nT &read(T &r) {\n\tr = 0; bool w = 0; char ch = getchar();\n\twhile(ch < '0' || ch > '9') w = ch == '-' ? 1 : 0, ch = getchar();\n\twhile(ch >= '0' && ch <= '9') r = r * 10 + (ch ^ 48), ch = getchar();\n\treturn r = w ? -r : r;\n}\nconst int N = 600010;\nint n, mx, a[N], b[N];\nll s1[N], s2[N];\nll k;\nsigned main() {\n\tread(n); read(k);\n\tfor(int i = 1; i <= n; ++i) read(b[i]), ++a[b[i]], mx = Max(mx, b[i]);\n\tll sum = 0;\n\tfor(int i = 1; i <= 2 * mx; ++i) s1[i] = s1[i-1] + a[i], s2[i] = s2[i-1] + a[i] * i;\n\tfor(int i = 1; i <= n; ++i) sum += mx-b[i];\n\tif(sum <= k) {\n\t\tprintf(\"%lld\\n\", mx+(k-sum)/n);\n\t\treturn 0;\n\t}\n\tfor(int i = mx; i > 1; --i) {\n\t\tsum = 0;\n\t\tfor(int j = 1; (j-1) * i <= mx; ++j) {\n\t\t\tint ct = s1[j*i-1] - s1[(j-1)*i];\n\t\t\tsum += ct * j * i;\n\t\t\tsum -= s2[j*i-1] - s2[(j-1)*i];\n\t\t}\n\t\tif(sum <= k) {\n\t\t\tprintf(\"%d\\n\", i);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tputs(\"1\");\n\treturn 0;\n}\n```",
        "postTime": 1667613986,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u300c\u9898\u89e3\u300dARC126C Maximize GCD"
    },
    {
        "content": "\u9898\u76ee\u5927\u610f\u5c31\u4e0d\u518d\u9610\u8ff0\u4e86\u3002\n\n\u663e\u7136\uff0c\u5f53\u6211\u4eec\u7684 $ K $ \u8db3\u591f\u5927\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u6240\u6709 $ A_i $ \u90fd\u52a0\u5230 $ A_{\\max} $\u3002\u7136\u540e\u5982\u679c\u4ecd\u7136\u6ee1\u8db3 $ K\\geq N $\uff0c\u76f4\u63a5\u5c06\u6240\u6709\u7684\u6570\u4e00\u8d77\u52a0\u76f4\u5230 $ K<N $\u3002\n\n\u5982\u6837\u4f8b\u4e09\uff1a\n\n```\nSample Input 3\n5 12345\n1 2 3 4 5\n```\n\n\u5148\u7528 $ 10 $ \u6b21\u64cd\u4f5c\u5c06 $ A_i $ \u5168\u53d8\u6210 $ 5 $\u3002\u7136\u540e\u6574\u4f53\u6bcf\u6b21\u52a0 $ 1 $\u3002\u6700\u540e\u7b54\u6848\u5373\u4e3a\uff1a\n\n```\nSample Output 3\n2472\n```\n\n\u8003\u8651 $ K $ \u4e0d\u8db3\u4ee5\u4f7f\u5f97 $ A_i $ \u5168\u90e8\u76f8\u7b49\u7684\u60c5\u5f62\u3002\u4f46\u7b54\u6848\u4e0d\u5177\u6709\u5355\u8c03\u6027\uff0c\u4e0d\u53ef\u4e8c\u5206\u3002\u89c2\u5bdf\u5230 $ A_i \\leq 3 \\times 10^{5} $\uff0c\u90a3\u4e48\u663e\u7136\u6ee1\u8db3 $ \\gcd(A_1,A_2,\\cdots,A_N)\\leq 3 \\times 10^5 $\u3002\u8003\u8651\u66b4\u529b\u679a\u4e3e\u7b54\u6848\uff0c\u5e76\u5728\u76f8\u5bf9\u8f83\u4f4e\u7684\u590d\u6742\u5ea6\u4e0b\u5224\u65ad\u662f\u5426\u53ef\u884c\u3002\n\n\u63a5\u4e0b\u6765\u662f\u5982\u4f55\u5224\u65ad\u3002\u6211\u4eec\u5047\u8bbe\u73b0\u5728\u9700\u8981\u5224\u65ad $ x=\\gcd(A_1,A_2,\\cdots,A_N) $ \u65f6\u662f\u5426\u6ee1\u8db3\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\u5c0f\u4e8e\u7b49\u4e8e $ K $\u3002\n\n\u5bf9\u4e8e\u5176\u4e2d\u4e00\u4e2a $ A_i $\uff0c\u53d8\u4e3a $ x $ \u7684\u500d\u6570\u9700\u8981 $ x-(A_i \\bmod x) $ \u6b21\u64cd\u4f5c\u3002\u90a3\u4e48\u603b\u64cd\u4f5c\u6b21\u6570\u662f\uff1a\n\n$$ \\sum\\limits_{i=1}^n x-(A_i \\bmod x) $$\n\n$$ nx-\\sum\\limits_{i=1}^n (A_i \\bmod x) $$\n\n\u628a $ A_i $ \u4e22\u5230\u6876\u91cc\uff08\u8fd9\u91cc $ W $ \u662f\u503c\u57df\uff09\uff1a\n\n$$ nx-\\sum\\limits_{k=1}^{W} (k \\bmod x)t_k $$\n\n$ nx $ \u7684\u503c\u663e\u7136\u53ef\u4ee5 $ O(1) $ \u6c42\u5f97\uff0c\u8003\u8651\u5982\u4f55\u6c42\u540e\u534a\u90e8\u5206\u3002\n\n\u89c2\u5bdf\u5230 $ t_k $ \u7684\u7cfb\u6570 $ (k \\bmod x) $ \u5177\u6709\u5468\u671f\u6027\uff0c\u5982\u4e0b\u56fe\uff1a\n\n![](https://s1.imagehub.cc/images/2022/10/25/183e37391bd84f29d.md.png)\n\n\n\u4f46\u8fd9\u6837\u6709\u70b9\u96be\u4ee5\u8ba1\u7b97\uff0c\u8bd5\u7740\u628a\u4e0a\u56fe\u5ef6\u957f\u4e00\u4e0b\uff0c\u5982\u4e0b\uff1a\n\n![](https://s1.imagehub.cc/images/2022/10/25/2c0aa3446da8b2ec9.md.png)\n\n\u663e\u7136\u7eff\u8272\u7684\u533a\u57df\u662f\u4e00\u4e2a\u5e73\u884c\u56db\u8fb9\u5f62\uff08\u753b\u7684\u6709\u70b9\u4e0d\u6807\u51c6\uff0c\u53ef\u4ee5\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff09\u3002\n\n\n\u5148\u9884\u5904\u7406\u51fa\uff1a\n\n$$ c(m)=\\sum\\limits_{i=1}^mi\\times t_i $$\n\n$$ F(m)=\\sum\\limits_{i=1}^m t_i $$\n\n\u4e0e\u57c3\u7b5b\u7c7b\u4f3c\uff0c\u679a\u4e3e $ x $ \u7684\u500d\u6570 $ kx $\u3002\u5728\u533a\u95f4 $ (kx-x,kx] $ \u4e2d\u7684\u8d21\u732e\u5373\u4e3a\n\n$$ c(kx)-c(kx-x)-(k-1)\\times (F(kx)-F(kx-x)) $$\n\n\u5f53\u7136\uff0c\u5982\u679c $ (W \\bmod x) \\neq 0 $\uff0c\u6700\u540e\u4e00\u6bb5\u7684\u8d21\u732e\u7279\u6b8a\u5904\u7406\u4e00\u4e0b\u5373\u53ef\u3002\u4e0e\u4e0a\u5f0f\u7c7b\u4f3c\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $ \\Theta(W \\log \\log W) $\u3002\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define int ll\ntypedef long long ll;\nusing namespace std;\nconst int N=1000005;\nint n,maxx;\nint a[N],t[N],c[N],S[N];\nll k,delta,ans;\nsigned main()\n{\n\tscanf(\"%lld %lld\",&n,&k);\n\tfor(int i=1;i<=n;i++) \n\t\tscanf(\"%lld\",a+i),maxx=max(a[i],maxx),++t[a[i]],++S[a[i]];\n\tfor(int i=1;i<=n;i++) delta+=maxx-a[i];\n\tif(k>=delta) return printf(\"%lld\\n\",1ll*maxx+(k-delta)/(1ll*n)),0;\n\tfor(int i=1;i<=maxx;i++) c[i]=c[i-1]+S[i]*i,t[i]+=t[i-1];\n\tfor(int i=maxx;i>=1;i--)\n\t{\n\t\tans=i*n;\n\t\tfor(int j=i;j<=maxx;j+=i) ans-=(c[j]-c[j-i]-(j/i-1)*i*(t[j]-t[j-i]));\n\t\tif(maxx%i!=0) ans-=(c[maxx]-c[maxx/i*i]-(maxx/i)*i*(t[maxx]-t[maxx/i*i]));\n\t\tif(ans<=k) return printf(\"%lld\\n\",i),0;\n\t}\n}\n```\n\n\n\n\n\n",
        "postTime": 1666656294,
        "uid": 432127,
        "name": "Avocadooo",
        "ccfLevel": 0,
        "title": "ARC126C-\u9898\u89e3"
    }
]
[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT5341)\n\n**\u524d\u7f6e\u829d\u58eb**\n\n\u9006\u5143\uff0c\u4e0d\u4f1a\u7684\u5148\u53bb\u505a\u4e00\u4e0b [\u8fd9\u9898](https://www.luogu.com.cn/problem/P3811)\u3002\n\n\u7ec4\u5408\u6570\uff0c\u8fd9\u4e2a\u5e94\u8be5\u90fd\u77e5\u9053\u5427\u3002\u6bd5\u7adf\u5f88\u5e38\u89c1\u3002\n\n**\u601d\u8def**\n\n\u663e\u7136\uff0c\u4ece $n$ \u79cd\u82b1\u91cc\u9762\u9009\u82e5\u5e72\u652f\u7684\u65b9\u6848\u6570\u603b\u6570\u4e3a $C^1_n+C^2_n+\\dots+C^n_n$\u3002\u4f17\u6240\u5468\u77e5\uff0c\u8fd9\u4e2a\u6570\u5c31\u662f $2^n-C^0_n=2^n-1$\u3002\n\n**\u8bc1\u660e**\n\n\u4f17\u6240\u5468\u77e5\uff0c$C^n_m=C^{n-1}_{m-1}+C^n_{m-1}(0<n<m)$\uff0c\u90a3\u4e48\uff0c\n\n$C^0_m+C^1_m+\\dots+C^{m-1}_m+C^m_m$\n\n$=C^0_m+C^0_{m-1}+C^1_{m-1}+C^1_{m-1}+C^2_{m-1}+\\dots+C^{m-2}_{m-1}+C^{m-1}_{m-1}+C^m_m$\n\n\u53c8 $\\because C^0_m=C^0_{m-1}$\uff0c$C^m_m=C^{m-1}_{m-1}$\uff0c$\\therefore \\sum_{i=0}^mC^i_m=2\\sum_{i=0}^{m-1}C^i_{m-1}$\u3002\n\n\u7136\u540e\u628a $C^1_1=1$ \u4ee3\u5165\u5373\u53ef\u8bc1\u660e\u3002\n\n\u518d\u628a\u9009 $a$ \u548c \u9009 $b$ \u7684\u51cf\u53bb\u5c31\u884c\u4e86\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u7b54\u6848\u4e3a $2^n-C^a_n-C^b_n-1$\u3002\n\n\u4e0d\u8fc7\uff0c\u8fd8\u8981\u6ce8\u610f\u9006\u5143\u7684\u5904\u7406\u3002\u53ef\u4ee5\u5229\u7528 $inv_i=i^{mod-2}$ \u6765\u8ba1\u7b97\u9006\u5143\uff0c\u4e5f\u53ef\u4ee5\u9884\u5904\u7406\u4e00\u4e0b\u9636\u4e58\u7684\u9006\u5143\uff0c\u4e0d\u8fc7 $O(n)$ \u9884\u5904\u7406\u5927\u6982\u7387\u4f1a TLE\u3002\n\n**CODE**\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long//\u4e0d\u5f00 long long \u89c1\u7956\u5b97\n//\u867d\u8bf4\u5982\u6b64\uff0c\u4f46\u662f\u4e0d\u5f00\u597d\u50cf\u786e\u5b9e\u95ee\u9898\u4e0d\u5927\uff0c\u53ea\u8981\u6ce8\u610f\u4e00\u4e0b\u7ec6\u8282\u5c31\u884c\n#define mod 1000000007\ninline int read(int x=0,bool f=1){\n\tchar c=getchar();\n\twhile(c>'9'||c<'0'){if(c=='-')f=0;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<3)+(x<<1)+c-'0';c=getchar();}\n\treturn f?x:-x;\n}//\u5feb\u8bfb\nint Pow(int x,int y){\n\tint res=1;\n\tfor(;y;y>>=1,x=x*x%mod)\n\t\tif(y&1)\n\t\t\tres=res*x%mod;\n\treturn res;\n}//\u5feb\u901f\u5e42\nint C(int x,int y){\n\tint ans=1;\n\tfor(int i=x-y+1;i<=x;i++)\n\t\tans=ans*i%mod;\n\tfor(int i=2;i<=y;i++)\n\t\tans=ans*Pow(i,mod-2)%mod;\n\treturn ans;\n}\nint n,a,b; \nsigned main(){\n\tn=read(),a=read(),b=read();\n\tprintf(\"%lld\\n\",(mod+mod+Pow(2,n)-C(n,a)-C(n,b)-1)%mod);\n   \t//\u8fd9\u91cc\u52a0 2 \u4e2a mod \u662f\u56e0\u4e3a C++ \u4e2d\u8d1f\u6570\u53d6\u6a21\u8fd8\u662f\u8d1f\u6570\n\treturn 0;\n}\n```\n\u5b8c\u7ed3\u6492\u82b1 $QAQ$\u3002",
        "postTime": 1648019081,
        "uid": 324666,
        "name": "diqiuyi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3AT5341"
    },
    {
        "content": "#### \u9898\u76ee\u5206\u6790\n\n\u8fd9\u9053\u9898\u5df2\u7ecf\u6709\u4e86\u7ebf\u6027\u6c42\u9006\u5143\u3001\u6768\u8f89\u4e09\u89d2\u7b49\u505a\u6cd5\uff0c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u6bd4\u8f83\u597d\u60f3\u7684\u505a\u6cd5\u3002\n\n\u9996\u5148\u6ce8\u610f\u5230\u7b54\u6848\u5373\u4e3a $2^n-C_n^a-C_n^b$\u3002\n- \u5bf9\u4e8e $2^n$ \u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5feb\u901f\u5e42\u5728 $O(\\log_2 n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u89e3\u3002\n- \u5bf9\u4e8e\u7ec4\u5408\u6570\uff0c\u65e0\u8bba\u662f\u4f7f\u7528\u5b9a\u4e49\u5f0f\u76f4\u63a5\u6c42\u8fd8\u662f\u4f7f\u7528\u9012\u63a8\u5f0f\u9012\u63a8\u90fd\u65e0\u6cd5\u5728\u89c4\u5b9a\u65f6\u95f4\u5185\u6c42\u89e3\uff0c\u4f46\u662f\u6ce8\u610f\u5230 $a$ \u548c $b$ \u7684\u8303\u56f4\u8f83\u5c0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u5c06\u7ec4\u5408\u6570\u8f6c\u5316\u4e3a\u6392\u5217\u6570\u6c42\u89e3\u3002\n\n$$\n\nC_n^a=a!\\cdot A_n^a=a!\\cdot\\frac{n!}{(n-a)!}=a!\\cdot\\prod_{i=n-a+1}^{n}i\n\n\n$$\n\n\u6574\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5728 $O(a)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u89e3\uff0c\u6240\u4ee5\u6574\u4e2a\u95ee\u9898\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5373\u4e3a $O(a)$\u3002\n\n#### \u4ee3\u7801\u5b9e\u73b0\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define FL(xx, yy, zz) memset(xx, yy, (zz))\n#define DEBUG() cout << \"\u00bfWhat Happened?\" << endl\n#define DG(x) cout << \"Debug : \" << #x << \" = \" << x << endl\n#define Efor(xx, yy) for(int xx = Head[yy]; xx; xx = Next[xx])\n#define Lfor(xx, yy, zz, xyz, ...) for(int xx = yy, ##__VA_ARGS__; xx <= zz; xx += xyz)\n#define Rfor(xx, yy, zz, xyz, ...) for(int xx = yy, ##__VA_ARGS__; xx >= zz; xx -= xyz)\nusing namespace std;\nconst int kN = 1e6 + 16, INF = ~0u >> 1, Mod = 1e9 + 7;\nint n, a, b;\nint F_Pow(int a, int b, int p) {\n\tint ans = 1;\n\twhile (b) {\n\t\tif (b & 1) ans = ans * a % p;\n\t\ta = a * a % p;\n\t\tb >>= 1;\n\t}\n\treturn ans;\n}\nint Fac(int x, int p) {\n\tint ans = 1;\n\tfor (int i = 1; i <= x; ++i) ans = ans * i % p;\n\treturn ans;\n}\nint Inv(int x, int p) {\n\treturn F_Pow(x, p - 2, p);\n}\nint C(int n, int m, int p) {\n\tif (n < m) return 0;\n\tint ans = 1;\n\tLfor (i, n - m + 1, n, 1) ans = ans * i % p;\n\treturn ans * Inv(Fac(m, p), p) % p;\n}\nsigned main() {\n#ifdef FIO\n    freopen(\"I:/Code/Data/In.in\", \"r\", stdin);\n    freopen(\"I:/Code/Data/Out.out\", \"w\", stdout);\n#endif\n\tcin >> n >> a >> b;\n\tcout << (F_Pow(2, n, Mod) - 1 - C(n, a, Mod) - C(n, b, Mod) + Mod + Mod + Mod) % Mod;\n\n}\n```\n",
        "postTime": 1642337273,
        "uid": 308107,
        "name": "Xu__",
        "ccfLevel": 6,
        "title": "AT5341 [ABC156D] Bouquet \u9898\u89e3"
    },
    {
        "content": "**\u524d\u7f6e\u77e5\u8bc6\uff1a\u4e8c\u9879\u5f0f\u5b9a\u7406\u53ca\u5176\u53d8\u5f62**\n\n\u4e8c\u9879\u5f0f\u5b9a\u7406\u5982\u4e0b\uff1a\n\n$$(x+y)^n=\\sum_{i=0}^n\\binom n ix^{n-i}y^{i}$$\n\n\u4ee4 $x=y=1$ \uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u516c\u5f0f\uff1a\n\n$$2^n=\\sum_{i=0}^n\\binom n i$$\n\n----------\n\n\u9898\u76ee\u5927\u610f\uff1a\u6c42\n\n$$\\left(\\sum_{i=1}^n\\binom n i-\\binom n a - \\binom n b \\right)\\bmod 10^9+7$$\n\n\u9996\u5148\u5904\u7406\u7b2c\u4e00\u90e8\u5206\uff1a\n\n$$\n\\begin{aligned}\n\\sum_{i=1}^n\\binom n i&=\\sum_{i=0}^n \\binom n i - \\binom n 0\\\\\n&=2^n-1\n\\end{aligned}$$\n\n\u7528\u5feb\u901f\u5e42\u6c42\u89e3\u3002\n\n\u7136\u540e\u770b $\\binom n a$ \u548c $\\binom n b$\uff0c\u4ee5 $\\binom n a$ \u4e3a\u4f8b\uff1a\n\n$$\n\\begin{aligned}\n\\binom n a &= \\frac{n!}{a! \\cdot (n-a)!}\\\\\n&= \\frac{1}{a!}\\prod_{i=n-a+1}^ni\n\\end{aligned}\n$$\n\n\u56e0\u4e3a $a \\le 2 \\times 10^5$\uff0c\u6240\u4ee5 $\\frac{1}{a!}$ \u53ef\u4ee5\u7ebf\u6027\u6c42\uff0c\u540e\u9762\u7684\u90e8\u5206\u53ef\u4ee5\u66b4\u529b\u7b97\u3002\n\n**\u5728\u5199\u4ee3\u7801\u65f6\u9700\u8981\u6ce8\u610f\uff0cC++ \u4e2d\u8d1f\u6570\u53d6\u6a21\u53ef\u80fd\u5f97\u5230\u7684\u7b54\u6848\u53ef\u80fd\u4e3a\u8d1f\u6570\uff0c\u5982 $-1 \\;\\bmod\\; 2$ \u8fd0\u884c\u7684\u7ed3\u679c\u4e3a $-1$\u3002**\n\n\u6240\u4ee5\u4f5c\u51cf\u6cd5\u8fd0\u7b97\u65f6\uff0c\u8bf7\u5728\u53d6\u6a21\u524d\u52a0\u4e0a $10^9+7$\uff0c\u4f7f\u5176\u53d8\u6210\u975e\u8d1f\u6570\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#define MOD 1000000007\ntypedef long long ll;\n\nll n, a, b, ans, inv[200010];\n\nll qpow(ll x, ll y){\t\t\t\t// \u5feb\u901f\u5e42 \n\tll t = 1;\n\twhile(y){\n\t\tif(y & 1) t = t * x % MOD;\n\t\tx = x * x % MOD;\n\t\ty >>= 1;\n\t}\n\treturn t;\n}\n\nll solve(ll a, ll b){\n\tll t = 1;\n\t// \u4ee5\u4e0b\u90e8\u5206\u5373\u4e3a a! / (a - b)!\uff0c\u9700\u8981\u8fd0\u884c b \u6b21\uff0c\u8003\u8651 b \u5f88\u5c0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u66b4\u529b\u7b97 \n\tfor(ll i = a; i >= a - b + 1; i--)\n\t\tt = t * i % MOD;\n\treturn t * inv[b] % MOD;\n}\n\nint main(){\n\n\tscanf(\"%lld%lld%lld\", &n, &a, &b);\n\tinv[1] = 1;\n\tfor(ll i = 2; i <= 200000; i++)\t\t\t// \u9006\u5143\u9884\u5904\u7406 \n\t\tinv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;\n\tfor(ll i = 2; i <= 200000; i++)\t\t\t// \u9012\u63a8\u53d8\u6210\u9636\u4e58\u7684\u9006\u5143 \n\t\tinv[i] = inv[i - 1] * inv[i] % MOD;\n\t\t\n\tans = (qpow(2, n) - 1 + MOD) % MOD; \n\tans = (ans - solve(n, a) + MOD) % MOD;\n\tans = (ans - solve(n, b) + MOD) % MOD;\n\tprintf(\"%lld\\n\", ans); \n\n\treturn 0;\n}\n```",
        "postTime": 1582432067,
        "uid": 87573,
        "name": "HoshizoraZ",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT5341 \u3010[ABC156D] Bouquet\u3011"
    },
    {
        "content": "## \u601d\u8def\uff1a\n\n\u9898\u76ee\u8ba9\u6211\u4eec\u6c42 $\\sum^{n}_{i=1}\\binom{n}{i}$ \u51cf\u53bb $\\binom{n}{a}$ \u548c $\\binom{n}{b}$ \u7684\u548c\u3002\n\n------------\n\n\u82e5\u65e0\u7279\u6b8a\u6ce8\u660e\uff0c\u4ee5\u4e0b $a,b$ \u4e0e\u9898\u76ee\u4e2d\u7684 $a,b$ \u65e0\u5173\u3002\n\n\u7531 $\\sum^{n}_{i=1}\\binom{n}{i}=2^n-1$\uff0c\n\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u8f6c\u5316\u4e3a $2^n-1-\\binom{n}{a}-\\binom{n}{b}$\u3002\n\n\u5173\u4e8e\u7ec4\u5408\u6570\uff1a\u6ce8\u610f\u4e00\u4e0b**\u4e0d\u8981**\u4e60\u60ef\u6027\u5730\u9884\u5904\u7406\u9006\u5143\uff0c\u5728 $\\binom{a}{b}$ \u91cc\u76f4\u63a5\u7b97\u5373\u53ef\uff08$n\\leq10^9$\uff09\u3002\u5728\u4e00\u4e9b $n\\leq10^6$ \u7684\u9898\u76ee\u91cc\u5efa\u8bae\u63d0\u524d\u9884\u5904\u7406\u9006\u5143\u3002\n\n\u603b\u4f53\u590d\u6742\u5ea6 $\\operatorname{O}(\\max\\{a,b\\})$ \uff08$a,b$ \u4e3a\u9898\u76ee\u4e2d\u7684 $a,b$\uff0c\u590d\u6742\u5ea6\u6765\u81ea\u6c42\u7ec4\u5408\u6570\uff0c$\\log n$ \u7684\u5feb\u901f\u5e42\u6bd4 $\\operatorname{O}(\\max\\{a,b\\})$ \u5c0f\uff0c\u5ffd\u7565\u4e0d\u8ba1\uff09\u3002\n\n## \u4ee3\u7801\uff1a\n\n```cpp\n#define int long long\n#define mod 1000000007\ninline int qpow(int a,int n){\n\t//\u5feb\u901f\u5e42\n\tint ans=1;\n\twhile(n){\n\t\tif(n&1) ans*=a,n--,ans%=mod;\n\t\tn>>=1;\n\t\ta*=a,a%=mod;\n\t}\n\treturn ans;\n}\ninline int myC(int n,int m){\n\t//\u7ec4\u5408\u6570\uff0c\u8be6\u7ec6\u8bc1\u660e\u53ef\u4ee5\u4e0a\u7f51\u641c\u7d22\n\tint ans=1;\n\tfor(int i=n-m+1;i<=n;i++) ans=ans*i%mod;\n\tfor(int i=2;i<=m;i++) ans=ans*qpow(i,mod-2)%mod;\n\treturn ans;\n}\nsigned main(){\n\tint n,a,b;\n\tcin>>n>>a>>b;\n\tcout<<(mod*2+qpow(2,n)-myC(n,a)-myC(n,b)-1)%mod;\n\treturn 0;\n}\n```",
        "postTime": 1663236367,
        "uid": 527598,
        "name": "FReQuenter",
        "ccfLevel": 0,
        "title": "AT5341 [ABC156D] Bouquet \u9898\u89e3"
    },
    {
        "content": "## \u9898\u76ee\u63cf\u8ff0\n\n\u6c42\u4ece $n$ \u4ef6\u7269\u54c1\u4e2d\u9009\u82e5\u5e72\u4ef6\uff08\u81f3\u5c11\u4e3a $1$\uff09\uff0c\u4e14\u4e0d\u80fd\u9009 $a$ \u6216 $b$ \u4ef6\u7684\u65b9\u6848\u6570\uff0c\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\n\n## \u9898\u89e3\n\n~~\u8fd9\u9898\u9876\u591a\u662f\u4e2a\u9ec4\u9898~~\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u9898\u610f\u8f6c\u5316\u4e3a\u4e0b\u9762\u8fd9\u4e2a\u5f0f\u5b50\n\n$$\\sum_{i=1}^n\\mathrm{C}_n^i-\\mathrm{C}_n^a-\\mathrm{C}^n_b$$\n\n\u53ea\u8981\u63a5\u89e6\u8fc7\u7ec4\u5408\u6052\u7b49\u5f0f\u5c31\u80fd\u8fdb\u884c\u5316\u7b80\n\n$$2^n-1-\\mathrm{C}_n^a-\\mathrm{C}^n_b$$\n\n\u7136\u540e\u7528\u5feb\u901f\u5e42\u548c\u9006\u5143\u8ba1\u7b97\u7ec4\u5408\u6570\u548c\u4e58\u65b9\u5373\u53ef\u3002\n\n### Code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst ll p=1e9+7;\nll n,a,b;\nll quickpow(ll a,ll b)\n{\n\tll res=1;\n\twhile(b)\n\t{\n\t\tif(b&1)\n\t\t\tres=res*a%p;\n\t\tb>>=1;\n\t\ta=a*a%p;\n\t}\n\treturn res;\n}\nll c(ll n,ll m)\n{\n\tll x=1,y=1;\n\tfor(ll i=n-m+1,j=1;i<=n,j<=m;i++,j++)\n\t\tx=x*i%p,y=y*j%p;\n\treturn x*quickpow(y,p-2)%p;\n}\nint main()\n{\n\tscanf(\"%lld%lld%lld\",&n,&a,&b);\n\tprintf(\"%lld\\n\",((quickpow(2,n)-1-c(n,a)-c(n,b))%p+p)%p);\n\treturn 0;\n}\n```",
        "postTime": 1661403385,
        "uid": 379058,
        "name": "Ginger_he",
        "ccfLevel": 0,
        "title": "AT5341\u9898\u89e3"
    },
    {
        "content": "[AT5341 [ABC156D] Bouquet](https://www.luogu.com.cn/problem/AT5341)\n\n~~\u4e00\u773c\u79d2\u6740~~\u9898\u3002\n\n\u8fd9\u9053\u9898\u4e3b\u8981\u8fd8\u662f\u770b\u6587\u5316\u8bfe\u8fdb\u5ea6\u3002\n\n\u6570\u5b66\u5b66\u8fc7\u7ec4\u5408\u6570\u5c31\u77e5\u9053\u8fd9\u4e2a\u5f0f\u5b50\u7684\u610f\u4e49\u3002\n\n![\u56fe\u7247](https://cdn.luogu.com.cn/upload/image_hosting/jz6m86ha.png)\n\n\u4e24\u6570\u540c\u65f6\u53d6\u4e00\u662f\u521d\u5b66\u6392\u5217\u7ec4\u5408\u65f6\u5e38\u89c1\u7684\u505a\u6cd5\uff0c\u8fd9\u6837\u6240\u6709\u4e0e $x$ \u548c $y$ \u7684\u5b57\u6bcd\u90fd\u6ca1\u4e86\uff0c\u6362\u6210 $1$ \u540e\u5c31\u662f\u9898\u76ee\u7ed9\u51fa\u7684\u5f0f\u5b50\u3002\n\n\u5e38\u89c1\u7684\u8fd8\u6709\u53d6 $-1$ \u548c $1$ \u4e4b\u7c7b\u7684\u64cd\u4f5c\u3002\u7eaf\u5c5e\u7ecf\u9a8c\u95ee\u9898\u3002\n\n\u4f46\u9898\u76ee\u8981\u51cf\u53bb\u4e24\u4e2a\u5176\u4e2d\u7684\u6570\u3002\n\n![\u56fe\u72472](https://cdn.luogu.com.cn/upload/image_hosting/7iaj2sw9.png)\n\n\u7528\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u53ea\u8981\u628a\u5206\u5b50\u548c\u5206\u6bcd\u90fd\u5206\u522b\u6c42\u597d\uff0c\u518d\u7528\u4e00\u4e0b\u4e58\u6cd5\u9006\u5143\u5c31\u884c\u4e86\u3002\n\n---\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define ull unsigned long long\n#define For(i,a,b) for(int i=a;i<=b;i++)\n#define Rep(i,a,b) for(int i=a;i>=b;i--)\n#define f(a) ((a)*(a))\n#define p(x) printf(\"%lld \",(x))\n#define fp(x) printf(\"%.10Lf \",(x))\n#define P() puts(\"\")\n#define lowbit(x) ((x)&(-(x)))\nusing namespace std;\ninline int read()\n{\n\tchar c=getchar();int x=0;bool f=0;\n\twhile(!isdigit(c))f^=!(c^45),c=getchar();\n\twhile(isdigit(c))x=(x<<1)+(x<<3)+(c^48),c=getchar();\n\tif(f)x=-x;return x;\n}\ninline char cread()\n{\n\tchar c=getchar();\n\twhile(!isalpha(c)) c=getchar();\n\treturn c;\n}\n\ninline void write(int re)\n{\n\tif (re>9) write(re/10);\n\tputchar(re%10+'0');\n}\nconst int maxn=100010;\nconst int maxm=17;\nconst int mod=1e9+7;\nint n,a,b;\nint sum1,sum2,sum3,ans;\ninline int qpow(int a,int b)\n{\n\tint x=a,y=b,res=1;\n\twhile(b)\n\t{\n\t\tif(b&1) \n\t\t\tres=x*res%mod;\n\t\tx=x*x%mod;\n\t\tb>>=1;\n\t}\n\treturn res%mod;\n}\ninline void exgcd(int &x,int &y,int a,int b)\n{\n\tif(b==0)\n\t{\n\t\tx=1;y=0;\n\t\treturn ;\n\t}\n\texgcd(x,y,b,a%b);\n\tint t=x;x=y;\n\ty=t-(a/b)*x;\n\t\n}\ninline int C(int n,int m)\n{\n\tint res1=1,res2=1;\n\tRep(i,n,n-m+1)\n\t\tres1=res1*i%mod;//p(res1);P();\n\tFor(i,1,m)\n\t\tres2=res2*i%mod;//p(res2);P();\n\tint a=res2,b=mod,x=0,y=0;\n\texgcd(x,y,a,b);//p(x);P();\n\tx=((x%mod)+mod)%mod;\n\treturn res1*x%mod;\n}\nsigned main()\n{\n\t//freopen(\"flower.in\",\"r\",stdin);\n\t//freopen(\"flower.out\",\"w\",stdout);\n\tn=read();a=read();b=read();\n\tsum1=qpow(2,n);\n\tsum2=C(n,a);//p(sum2);P();\n\tsum3=C(n,b);//p(sum3);P();\n\tans=(sum1-1-sum2+mod+mod)%mod;\n\tans=(ans-sum3+mod)%mod;\n\tp(ans);\n}\n\n\n```\n\n---\n\n\u611f\u8c22\u7ba1\u7406\u5458\u7684\u5ba1\u6838\u3002\n",
        "postTime": 1652507654,
        "uid": 194642,
        "name": "xiaozeyu",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 AT5341 [ABC156D] Bouquet"
    },
    {
        "content": "## Content\n\u6709\u4e00\u4e2a\u4eba\u6709 $n$ \u79cd\u4e0d\u540c\u7684\u8bdd\u53ef\u4f9b\u9009\u62e9\uff0cTA \u53ef\u4ee5\u9009\u62e9\u81f3\u5c11\u4e00\u79cd\u82b1\u505a\u82b1\u675f\uff0c\u4f46\u662f TA \u4e0d\u559c\u6b22\u82b1\u7684\u79cd\u6570\u4e3a $a$ \u6216\u8005 $b$ \u7684\u82b1\u675f\u3002\u6c42\u9009\u82b1\u7684\u65b9\u6848\u6570\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n**\u6570\u636e\u8303\u56f4\uff1a$2\\leqslant n\\leqslant 10^9$\uff0c$1\\leqslant a<b\\leqslant\\min\\{n,2\\times 10^5\\}$\u3002**\n## Solution\n\u7b80\u5355\u7684\u6570\u6570\u9898\u3002\n\n\u6211\u4eec\u5148\u629b\u5f00\u300eTA \u4e0d\u559c\u6b22\u82b1\u7684\u79cd\u6570\u4e3a $a$ \u6216\u8005 $b$ \u7684\u82b1\u675f\u300f\u8fd9\u4e2a\u6761\u4ef6\u4e0d\u7ba1\uff0c\u5148\u6765\u770b\u5982\u679c\u662f\u4ece $n$ \u79cd\u82b1\u4e2d\u9009\u81f3\u5c11\u4e00\u79cd\u82b1\u4f5c\u4e3a\u82b1\u675f\u7684\u65b9\u6848\u6570\u3002\u5f88\u663e\u7136\uff0c\u6bcf\u79cd\u82b1\u90fd\u6709\u300e\u9009\u300f\u6216\u8005\u300e\u4e0d\u9009\u300f\u8fd9\u4e24\u79cd\u72b6\u6001\uff0c\u90a3\u4e48\u5c31\u4e00\u5171\u6709 $2^n$ \u79cd\u65b9\u6848\u3002\u4f46\u662f\u53c8\u4e0d\u80fd\u5168\u90e8\u90fd\u4e0d\u9009\uff0c\u4e8e\u662f\u6700\u7ec8\u65b9\u6848\u603b\u6570\u4e3a $2^n-1$\u3002\n\n\u6211\u4eec\u518d\u6765\u770b\u770b\u4e0d\u9009\u79cd\u6570\u4e3a $a$ \u6216\u8005 $b$ \u7684\u65b9\u6848\u603b\u6570\u3002\u6839\u636e\u7ec4\u5408\u6570\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u5feb\u6c42\u51fa**\u9009\u82b1\u7684\u79cd\u6570\u4e3a $a$ \u7684\u65b9\u6848**\u603b\u6570\u4e3a $C_n^a$\uff0c**\u9009\u82b1\u7684\u79cd\u6570\u4e3a $b$ \u7684\u65b9\u6848**\u603b\u6570\u4e3a $C_n^b$\uff0c\u53c8\u56e0\u4e3a\u9898\u76ee\u4fdd\u8bc1 $a\\neq b$\uff0c\u56e0\u6b64**\u9009\u82b1\u7684\u79cd\u6570\u4e3a $a$ \u6216\u8005 $b$ \u7684\u65b9\u6848**\u603b\u6570\u4e3a $C_n^a+C_n^b$\u3002\n\n\u90a3\u4e48\uff0c\u6700\u7ec8\u7684\u7b54\u6848\u5c31\u547c\u4e4b\u6b32\u51fa\u4e86\uff0c\u4e3a $2^n-1-C_n^a-C_n^b$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8be5\u5982\u4f55\u6c42\u51fa\u7b54\u6848\u5462\uff1f\n\n\u9996\u5148\uff0c$2^n$ \u8fd9\u4e2a\u90e8\u5206\u975e\u5e38\u597d\u529e\uff0c\u76f4\u63a5\u4e0a\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u518d\u7136\u540e\u5c31\u662f\u7ec4\u5408\u6570\u4e86\u3002\u6211\u4eec\u4e0d\u59a8\u5148\u770b\u5230**\u8d39\u9a6c\u5c0f\u5b9a\u7406**\u548c**\u4e58\u6cd5\u9006\u5143**\u7684\u5b9a\u4e49\u3002\n\n- \u8d39\u9a6c\u5c0f\u5b9a\u7406\uff1a\u5982\u679c $p$ \u662f\u8d28\u6570\uff0c\u5219\u5bf9\u4e8e\u4efb\u610f\u6574\u6570 $a$\uff0c\u90fd\u6709 $a^p\\equiv a\\pmod p$\uff0c\u6216\u8005 $a^{p-1}\\equiv 1\\pmod p$\u3002\n- \u4e58\u6cd5\u9006\u5143\uff1a\u5982\u679c $b,p$ \u4e92\u8d28\uff0c\u4e14 $b\\mid a$\uff0c\u5219\u6211\u4eec\u5b58\u5728\u4e00\u4e2a\u6574\u6570 $x$\uff0c\u4f7f\u5f97 $\\dfrac ab\\equiv a\\cdot x\\pmod p$\u3002\n\n\u6709\u4e86\u8fd9\u4e24\u4e2a\u4e1c\u897f\uff0c\u6211\u4eec\u53ef\u4ee5\u63a8\u5bfc\u51fa $a\\times a^{p-2}\\equiv 1\\pmod p$\uff0c\u4ece\u800c\u5728\u8ba1\u7b97\u7ec4\u5408\u6570\u7684\u65f6\u5019\u5c31\u4e0d\u7528\u9664\u4e00\u4e2a\u6570 $x$\uff0c\u76f4\u63a5\u4e58\u4e0a $x^{p-2}$ \u5373\u53ef\u8fbe\u5230\u76f8\u540c\u7684\u6548\u679c\u3002\n\n\u56de\u5230\u6c42\u7ec4\u5408\u6570\uff0c\u7531\u4e8e $C_n^m=\\dfrac{n!}{m!((n-m)!}=\\dfrac{\\prod\\limits_{i=n-m+1}^ni}{m!}$\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5206\u4e24\u90e8\u5206\u66b4\u529b\u53bb\u7b97\u51fa\u5206\u5b50 $a$ \u548c\u5206\u6bcd $b$\uff0c\u7ec4\u5408\u6570\u5c31\u662f $a\\times b^{mod-2}$\u3002\n\n\u8fd9\u9053\u9898\u76ee\u5c31\u7b97\u505a\u5b8c\u4e86\u3002\n## Code\n```cpp\nconst int N = 2e5 + 7, mod = 1e9 + 7;\n\nii ksm(int a, int b) {\n\tint res = 1;\n\tfor(; b; b >>= 1, a = 1ll * a * a % mod) if(b % 2) res = 1ll * res * a % mod;\n\treturn res;\n}\nii C(int n, int m) {\n\tif(n < m || n < 0 || m < 0) return 0;\n\tint res1 = 1, res2 = 1;\n\tR(int, i, n, n - m + 1) res1 = 1ll * res1 * i % mod;\n\tR(int, i, m, 1) res2 = 1ll * res2 * i % mod;\n\treturn 1ll * res1 * ksm(res2, mod - 2) % mod;\n}\n\nint main() {\n\tint n = Rint, a = Rint, b = Rint, ans = ksm(2, n) % mod;\n\tans = (((ans - C(n, a) + mod) % mod -  C(n, b) + mod) % mod - 1 + mod) % mod;\n\treturn println(ans), 0;\n}\n```",
        "postTime": 1626192586,
        "uid": 112917,
        "name": "Eason_AC",
        "ccfLevel": 6,
        "title": "AT5341 [ABC156D] Bouquet"
    },
    {
        "content": "# Bouquet\n\n\u9898\u76ee\u5927\u610f:\u7ed9\u5b9a\u6574\u6570$n$\u3001$a$\u548c$b$\uff0c\u6c42$C^0_n+C^1_n+C^2_n+......+C^n_n-C^a_n-C^b_n-1$\u3002\n\n\u8fd9\u9053\u9898\u5df2\u7ecf\u6709\u4e86\u516c\u5f0f\u5c31\u53ef\u4ee5\u505a\u4e86\u3002**\u4f46\u662f\uff0c\u4f60\u6709\u770b\u6570\u636e\u8303\u56f4\u5417\uff1f\u4f60\u5982\u679c\u76f4\u63a5\u7528\u9664\u6cd5\u4f60\u4e0d\u6015TLE\u5417\uff1f\u6240\u4ee5\uff0c\u6211\u4eec\u6765\u7814\u7a76\u4e00\u4e0b\u4e58\u6cd5\u9006\u5143\u548c\u8d39\u9a6c\u5c0f\u5b9a\u7406\u3002**\n\n\u5982\u679c\u4f60\u4e0d\u61c2\u540c\u4f59\u662f\u4ec0\u4e48\uff0c\u8bf7\u767e\u5ea6\u4e00\u4e0b\u3002\n\n**\u8d39\u9a6c\u5c0f\u5b9a\u7406**:\u82e5$p$\u662f\u8d28\u6570\uff0c\u5219\u5bf9\u4e8e\u4efb\u610f\u6574\u6570$a$\uff0c\u6709$a^p \\equiv a(\\bmod p)$(\u6458\u81ea**\u7b97\u6cd5\u7ade\u8d5b\u8fdb\u9636\u6307\u5357**)\n\n**\u4e58\u6cd5\u9006\u5143**:\n\n\u82e5\u6574\u6570$b$\u3001$m$\u4e92\u8d28\uff0c\u5e76\u4e14$b \\mid a$\uff0c\u5219\u5b58\u5728\u4e00\u4e2a\u6574\u6570$x$\uff0c\u4f7f\u5f97$a \\div b \\equiv a \\times x(\\bmod m)$\u3002\u79f0$x$\u4e3a$b$\u7684\u6a21$m$\u4e58\u6cd5\u9006\u5143\uff0c\u8bb0\u4e3a$b^{-1}(\\bmod m)$(\u6458\u81ea**\u7b97\u6cd5\u7ade\u8d5b\u8fdb\u9636\u6307\u5357**)\n\n\u7ed3\u5408**\u8d39\u9a6c\u5c0f\u5b9a\u7406**\u548c**\u4e58\u6cd5\u9006\u5143**\uff0c\u53ef\u4ee5\u63a8\u5bfc\u51fa:$\\begin{aligned}b^{p-1} & \\equiv 1 \\\\ b \\times b^{p-2} & \\equiv 1 \\end{aligned}$  \n\n\u56e0\u6b64\uff0c\u6709\u4e86**\u8d39\u9a6c\u5c0f\u5b9a\u7406**\u548c**\u4e58\u6cd5\u9006\u5143**\uff0c\u5c31\u53ef\u4ee5\u5728\u6c42\u7ec4\u5408\u6570\u7684\u65f6\u5019\u628a\u9664\u6cd5\u8f6c\u6362\u6210\u4e58\u6cd5\u4e86\u3002\n\n\u63a5\u4e0b\u6765\u770b\u770b\u5b9e\u73b0:\n\n### Code:\n\n```cpp\n#include <bits/stdc++.h>\n#define REP(i, a, b) for (long long i = a; i <= b; ++i)\n#define PER(i, a, b) for (long long i = a; i >= b; --i)\n#define lyj 1000000007\n#define ll long long\nusing namespace std;\n\nll n, a, b;\n\ninline ll read(){\n\tll s = 0, w = 1;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch > '9'){\n\t\tif (ch == '-') w *= -1;\n\t\tch = getchar();\n\t}\n\twhile (ch >= '0' && ch <= '9'){\n\t\ts = s * 10 + ch - '0';\n\t\tch = getchar();\n\t}\n\treturn s * w;\n}\n\ninline ll ksm(ll c, ll d){\t\t\t\t\t\t\t\t\t\t\t\t\t\t//\u5feb\u901f\u5e42 \n\tll sum = 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//\u521d\u59cb\u8d4b\u503c\u4e3a1 \n\tfor (; d; d >>= 1, c = c * c % lyj)\t\t\t\t\t\t\t\t\t\t\t//d\u4e0d\u4e3a0\u5219\u9664\u4ee52 \n\t\tif (d & 1) sum = sum * c % lyj;\t\t\t\t\t\t\t\t\t\t\t//d\u4e3a\u5947\u6570\u7684\u7279\u5224\n\treturn sum;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//\u8fd4\u56de\u7b54\u6848 \n}\n\ninline ll xcj(ll n, ll m){\t\t\t\t\t\t\t\t\t\t\t\t\t\t//\u6c42\u7ec4\u5408\u6570 \n\tll a1 = 1, a2 = 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//\u521d\u59cb\u8d4b\u503c\u4e3a1 \n\tPER(i, n, n - m + 1) a1 = a1 * i % lyj;\t\t\t\t\t\t\t\t\t\t//\u6c42\u7ea6\u5206\u540e\u7684n! \n\tREP(i, 2, m) a2 = a2 * i % lyj;\t\t\t\t\t\t\t\t\t\t\t\t//\u6c42\u7ea6\u5206\u540e\u7684m!(n - m)!\n\treturn a1 * ksm(a2, lyj - 2) % lyj;\t\t\t\t\t\t\t\t\t\t\t//\u8d39\u9a6c\u5c0f\u5b9a\u7406 \n}\n\nint main(){\n\tn = read(), a = read(), b = read();\n\tprintf(\"%lld\\n\", (ksm(2, n) - 1 - xcj(n, a) - xcj(n, b) + lyj + lyj) % lyj);//\u6c42\u6ca1\u6709\u9650\u5236\u4e0b\u7684\u65b9\u6848\u6570\u51cf\u53bb\u9898\u76ee\u7684\u9650\u5236\u6761\u4ef6 \n\treturn 0;\n}\n```\n\n",
        "postTime": 1582440889,
        "uid": 124527,
        "name": "leoair",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT5341 \u3010[ABC156D] Bouquet\u3011"
    },
    {
        "content": "\u6ce8\u610f\u5230\u672c\u9898 $n \\leq 10^9$\uff0c\u76f4\u63a5\u6c42\u548c\u7ec4\u5408\u6570\u80af\u5b9a\u4f1a\u70b8\uff0c\u6240\u4ee5\u4e0d\u59a8\u8003\u8651\u6362\u4e00\u79cd\u601d\u8def\uff0c\u6211\u4eec\u4e0d\u59a8\u76f4\u63a5\u6c42\u51fa\u6240\u6709\u82b1\u7684\u642d\u914d\u65b9\u6848\u603b\u548c\uff0c\u518d\u51cf\u53bb\u4e0d\u5408\u6cd5\u7684\u4e24\u79cd\u5373\u53ef\u3002\u8fd9\u5e76\u4e0d\u96be\u529e\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u65b9\u6848\u5c31\u7b49\u4e8e\u8fd9\u4e00\u4e2a\u5f0f\u5b50\u3002\n$$\\sum_{i=0}^{n} C_{n}^{i} = 2^{n}$$\n\u6211\u4eec\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c31\u53ef\u4ee5\u5f97\u8bc1\u8fd9\u4e2a\u5f0f\u5b50\u3002\u63a5\u7740\uff0c\u6211\u4eec\u8003\u8651\u51cf\u53bb\u4e0d\u5408\u6cd5\u7684\u90a3\u4e24\u4e2a\u5373\u53ef\u3002\u6ce8\u610f\u5230 $b \\leq 2\\times 10^5$\u3002\u76f4\u63a5\u66b4\u529b\u7b97\u5373\u53ef\u3002\n\n## Code\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define mid ((l+r)>>1)\n#define F(i,a,b) for(int i=(a); i<=(b); ++i)\n#define R(i,a,b) for(int i=(a); i>=(b); --i)\nusing namespace std;\nconst int Mod=1e9+7;\nconst int Maxn=2e6+5;\ninline int read();\nint gcd(int a,int b);\nint fac[Maxn];\nint ksm(int a,int b,int mod);\nvoid init();\nint inv(int a,int mod);\nint C(int n,int m);//C_n ^ m\nint a[Maxn],n,m,k,q,mod,x=1,y=1,sum,ans;\nsigned main() {\n\tinit();\n\tcin>>n>>k>>q;\n\tint n1=n;\n\tans=ksm(2,n,Mod)%Mod;\n\tans%=Mod;\n\t//cout<<ans<<endl;\n\t//cout<<fac[q]<<endl;\n\tfor(int i=1; i<=k; i++) {\n\t\tx*=n1;\n\t\tn1-=1;\n\t\tx%=Mod;\n\t}\n\tn1=n;\n\tfor(int i=1; i<=q; i++) {\n\t\ty*=n1;\n\t\tn1-=1;\n\t\ty%=Mod;\n\t}\n\t//cout<<x<<\" \"<<y<<endl;\n//\tcout<<inv(fac[k],Mod)%Mod<< \" \"<<fac[q]<<endl;\n\tans=(ans-(x*(inv(fac[k],Mod)%Mod))+Mod)%Mod;\n\tans=(ans-(y*(inv(fac[q],Mod)%Mod))%Mod+Mod)%Mod;\n\tcout<<(ans+Mod)%Mod-1;\n\treturn 0;\n}\nvoid init() {\n\tfac[0]=1;\n\tfor(int i=1; i<=Maxn; i++) {\n\t\tfac[i]=fac[i-1]*i;\n\t\tfac[i]%=Mod;\n\t}\n\treturn;\n}\nlong long read() {\n\tlong long t=0,f=0;\n\tchar v=getchar();\n\twhile(!isdigit(v))f|=(v=='-'),v=getchar();\n\twhile(isdigit(v))t=(t<<3)+(t<<1)+v-48,v=getchar();\n\treturn f?-t:t;\n}\ninline int inv(int a,int mod) {\n\treturn ksm(a,mod-2,mod);\n}\nint gcd(int a,int b) {\n\tif(a<b) swap(a,b);\n\tif(b==0) return a;\n\telse return gcd(b,a%b);\n}\ninline int C(int n,int m) {\n\treturn (fac[n]*inv(fac[m],Mod)%Mod*inv(fac[n-m],Mod)%Mod)%Mod;\n}\ninline int ksm(int a,int b,int mod) {\n\tint z=1;\n\twhile(b) {\n\t\tif(b&1) z=z*a%mod;\n\t\ta=a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn z%mod;\n}\n/*\n\n*/\n\n\n```\n",
        "postTime": 1679668060,
        "uid": 754856,
        "name": "_zexal_",
        "ccfLevel": 3,
        "title": "Abc156D\u9898\u89e3"
    }
]
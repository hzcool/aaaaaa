[
    {
        "content": "\u9996\u5148\uff0c\u6bcf\u79cd\u989c\u8272\u4e92\u4e0d\u5e72\u6270\uff0c\u56e0\u6b64\u8003\u8651\u5bf9\u6bcf\u79cd\u989c\u8272\u7edf\u8ba1\u7b54\u6848\u3002\n\n\u6709\u4e24\u79cd\u89e3\u6cd5\uff1a\n\n- \u679a\u4e3e\u8d77\u59cb\u683c\u5b50 $(x,y)$ \u548c\u7ed3\u5c3e\u683c\u5b50 $(z,w)$\uff0c\u7531\u7ec4\u5408\u6570\u6613\u77e5\u5171\u6709 $\\binom{z-x+w-y}{z-x}$ \u79cd\u8def\u5f84\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O(k^2)$\uff0c\u5176\u4e2d $k$ \u4e3a\u8fd9\u79cd\u989c\u8272\u683c\u5b50\u6570\u91cf\u3002\n- \u52a8\u6001\u89c4\u5212\u7edf\u8ba1\u8fd9\u79cd\u989c\u8272\u7684\u683c\u5b50\u5230\u6bcf\u4e2a\u683c\u5b50\u7684\u8def\u5f84\u6570\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O(n^2)$\u3002\n\n\u8fdb\u884c\u6839\u53f7\u5206\u6cbb\u3002\u5f53 $k\\le n$ \u65f6\uff0c\u7b2c\u4e00\u79cd\u89e3\u6cd5\u603b\u590d\u6742\u5ea6\u4e0d\u8d85\u8fc7 $\\mathcal O(n^3)$\uff1b\u5f53 $k > n$ \u65f6\uff0c\u6b64\u7c7b\u60c5\u51b5\u4e0d\u8d85\u8fc7 $n$ \u6b21\uff0c\u7b2c\u4e8c\u79cd\u89e3\u6cd5\u603b\u590d\u6742\u5ea6\u4e0d\u8d85\u8fc7 $\\mathcal O(n^3)$\u3002\n\n```cpp\n// Problem: AT_abc259_h [ABC259Ex] Yet Another Path Counting\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/AT_abc259_h\n// Memory Limit: 1024 MB\n// Time Limit: 2000 ms\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n//By: OIer rui_er\n#include <bits/stdc++.h>\n#define rep(x,y,z) for(ll x=(y);x<=(z);x++)\n#define per(x,y,z) for(ll x=(y);x>=(z);x--)\n#define debug(format...) fprintf(stderr, format)\n#define fileIO(s) do{freopen(s\".in\",\"r\",stdin);freopen(s\".out\",\"w\",stdout);}while(false)\nusing namespace std;\ntypedef long long ll;\nconst ll N = 405, mod = 998244353;\n\nll n, a[N][N], dp[N][N], fac[N*2], ifac[N*2], ans;\nvector<tuple<ll, ll> > pos[N*N];\ntemplate<typename T> void chkmin(T& x, T y) {if(x > y) x = y;}\ntemplate<typename T> void chkmax(T& x, T y) {if(x < y) x = y;}\nvoid initC(ll x) {\n\tfac[0] = fac[1] = ifac[0] = ifac[1] = 1;\n\trep(i, 2, x) {\n\t\tfac[i] = fac[i-1] * i % mod;\n\t\tifac[i] = (mod - mod / i) * ifac[mod%i] % mod;\n\t}\n\trep(i, 2, x) ifac[i] = ifac[i-1] * ifac[i] % mod;\n}\nll C(ll x, ll y) {\n\tif(x < 0 || y < 0 || x < y) return 0;\n\treturn fac[x] * ifac[y] % mod * ifac[x-y] % mod;\n}\n\nint main() {\n\tinitC(N*2-1);\n\tscanf(\"%lld\", &n);\n\trep(i, 1, n) {\n\t\trep(j, 1, n) {\n\t\t\tscanf(\"%lld\", &a[i][j]);\n\t\t\tpos[a[i][j]].emplace_back(i, j);\n\t\t}\n\t}\n\trep(c, 1, n*n) {\n\t\tif(!pos[c].empty()) {\n\t\t\tif((ll)pos[c].size() <= n) {\n\t\t\t\tll sz = pos[c].size();\n\t\t\t\trep(i, 0, sz-1) {\n\t\t\t\t\trep(j, 0, sz-1) {\n\t\t\t\t\t\tll x = get<0>(pos[c][j]) + get<1>(pos[c][j]) - get<0>(pos[c][i]) - get<1>(pos[c][i]);\n\t\t\t\t\t\tll y = get<0>(pos[c][j]) - get<0>(pos[c][i]);\n\t\t\t\t\t\tans += C(x, y);\n\t\t\t\t\t\tans %= mod;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\trep(i, 1, n) {\n\t\t\t\t\trep(j, 1, n) {\n\t\t\t\t\t\tdp[i][j] = (a[i][j] == c);\n\t\t\t\t\t\tdp[i][j] += dp[i-1][j]; dp[i][j] %= mod;\n\t\t\t\t\t\tdp[i][j] += dp[i][j-1]; dp[i][j] %= mod;\n\t\t\t\t\t\tif(a[i][j] == c) {\n\t\t\t\t\t\t\tans += dp[i][j];\n\t\t\t\t\t\t\tans %= mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1667721106,
        "uid": 122461,
        "name": "rui_er",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 [ABC259Ex] Yet Another Path Counting"
    },
    {
        "content": "UPD\uff1a\u66f4\u6b63\u65f6\u95f4\u590d\u6742\u5ea6\u8ba1\u7b97\u9519\u8bef\u3002\n\n[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.llingy.ml/posts/3648470459/)\n\n\n\u8fd8\u662f\u4e0d\u591f\u719f\u7ec3\u3002\n\n## \u9898\u610f\u7b80\u8ff0\n\n\u4e00\u4e2a $n\\times n$ \u7684\u7f51\u683c\u56fe\uff0c\u6bcf\u4e2a\u683c\u5b50\u4e0a\u6709\u989c\u8272\uff0c\u6c42\u6ee1\u8db3\u8d77\u70b9\u548c\u7ec8\u70b9\u989c\u8272\u5747\u76f8\u540c\u4e14\u53ea\u5411\u4e0b\u548c\u5411\u53f3\u8d70\u7684\u8def\u5f84\u6761\u6570\u3002\u53ef\u4ee5\u8d70 $0$ \u6b65\u3002$n\\le 400$\u3002\n\n## \u89e3\u6cd5\n\n* \u8bbe\u8d77\u70b9\u4e3a $(x,y)$ \u7ec8\u70b9\u4e3a $(z,w)$\uff0c\u5219\u4ece $(x,y)$ \u5230 $(z,w)$ \u4ec5\u5411\u4e0b\u548c\u5411\u53f3\u8d70\u7684\u8def\u5f84\u6761\u6570\u4e3a $\\dbinom{x-z+y-w}{x-z}$\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4ece\u8d77\u70b9\u5230\u7ec8\u70b9\u603b\u5171\u8981\u8d70 $(x-z+y-w)$ \u6b65\uff0c\u800c\u5176\u4e2d\u6709 $(x-z)$ \u6b65\u662f\u5411\u4e0b\u8d70\u7684\uff0c\u8fd9 $(x-z)$ \u6b65\u53ef\u4ee5\u5728\u4efb\u610f\u65f6\u523b\u8d70\uff0c\u6240\u4ee5\u76f8\u5f53\u4e8e\u5728 $(x-z+y-w)$ \u6b65\u4e2d\u9009\u51fa $(x-z)$ \u6b65\u7684\u65b9\u6848\u6570\u3002\n* \u989c\u8272\u4e4b\u95f4\u662f\u72ec\u7acb\u7684\uff0c\u53ef\u4ee5\u5206\u5f00\u8003\u8651\u3002\n* \u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272\uff0c\u679a\u4e3e\u8d77\u70b9\u548c\u7ec8\u70b9\uff0c\u5bb9\u6613\u6839\u636e\u4e0a\u5f0f\u8ba1\u7b97\u7b54\u6848\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4)$\u3002\n* \u4e0d\u8fc7\u6211\u4eec\u5ffd\u7565\u4e86\u4e00\u79cd\u6700\u6734\u7d20\u7684\u89e3\u9898\u601d\u8def\u3002\u8bb0 $f_{i,j}$ \u4e3a\u4ee5 $(i,j)$ \u7ed3\u5c3e\u7684\u5408\u6cd5\u8def\u5f84\u6761\u6570\uff0c\u8f6c\u79fb\u4e3a $f_{i,j}=f_{i,j}+f_{i,j-1}+f_{i-1,j}$\u3002\u5bf9\u4e8e\u6240\u6709\u989c\u8272\u4e3a\u5f53\u524d\u679a\u4e3e\u7684\u989c\u8272\u7684\u4f4d\u7f6e $(i,j)$\uff0c\u521d\u503c\u4e3a $1$\uff0c\u5426\u5219\u4e3a $0$\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u989c\u8272\u90fd\u8981\u505a\u4e00\u904d\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4)$\u3002\n* \u5bf9\u4e8e\u8fd9\u79cd\u5206\u989c\u8272\u5904\u7406\u7684\u95ee\u9898\uff0c\u5f88\u7ecf\u5178\u7684\u89e3\u51b3\u65b9\u5f0f\u662f\u5bf9\u989c\u8272\u51fa\u73b0\u6b21\u6570\u8fdb\u884c\u6839\u53f7\u5206\u6cbb\u3002\u8bb0\u9608\u503c\u4e3a $B$\uff0c\u5219\u6700\u591a\u6709 $\\dfrac {n^2}{B}$ \u79cd\u989c\u8272\u51fa\u73b0\u6b21\u6570\u8d85\u8fc7 $B$ \u6b21\uff0c\u5bf9\u8fd9\u90e8\u5206\u505a DP\uff0c\u800c\u5bf9\u51fa\u73b0\u6b21\u6570\u5c0f\u4e8e $B$ \u6b21\u4f7f\u7528\u7ec4\u5408\u6570\u8ba1\u7b97\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(nB^2+\\dfrac{n^4}{B})$\uff0c\u5f53 $B=n$ \u65f6\u53d6\u5230\u6700\u4f18\uff0c\u4e3a $O(n^3)$\u3002\n\n## Code\n```cpp\nconstexpr int N=405;using ll=long long;constexpr ll mod=998244353;\ninline ll qpow(ll a,ll b)\n{\n    ll ret=1;a%=mod;\n    while(b)\n    {\n        if(b&1) ret=ret*a%mod;\n        a=a*a%mod;\n        b>>=1;\n    }\n    return ret;\n}\nint a[N][N];ll f[N][N];\nstruct dat{int x,y;};\nvector<dat>id[N*N];\nll fac[N<<1],ifac[N<<1];\ninline ll abs(ll x){return x<0?-x:x;}\ninline ll binom(ll n,ll m){return (m<0||n<m)?0:fac[n]*ifac[n-m]%mod*ifac[m]%mod;}\ninline ll calc(ll x,ll y,ll z,ll w){return binom(z-x+w-y,z-x);}\ninline void init(const int n)\n{\n    fac[0]=ifac[0]=1;\n    for(int i=1;i<=n;i++) fac[i]=fac[i-1]*i%mod;\n    ifac[n]=qpow(fac[n],mod-2);\n    for(int i=n-1;i>0;i--) ifac[i]=ifac[i+1]*(i+1)%mod;\n}\ninline void work()\n{\n    ios::sync_with_stdio(false);cin.tie(nullptr);cout.tie(nullptr);\n    int n;cin>>n;init(n*2);\n    for(int i=1;i<=n;i++) for(int j=1;j<=n;j++) cin>>a[i][j],id[a[i][j]].emplace_back((dat){i,j});\n    ll ans=0;\n    for(int i=1;i<=n*n;i++)\n    {\n        if(!id[i].size()) continue;\n        int sz=int(id[i].size());\n        if(sz<=n) for(int j=0;j<sz;j++) for(int k=0;k<sz;k++) ans=(ans+calc(id[i][j].x,id[i][j].y,id[i][k].x,id[i][k].y))%mod;\n        else\n        {\n            memset(f,0,sizeof(f));\n            for(const dat&j:id[i]) f[j.x][j.y]=1;\n            for(int j=1;j<=n;j++) for(int k=1;k<=n;k++) f[j][k]=(f[j][k]+f[j-1][k]+f[j][k-1])%mod;\n            for(int j=1;j<=n;j++) for(int k=1;k<=n;k++) if(a[j][k]==i) ans=(ans+f[j][k])%mod;\n        }\n    }\n    cout<<ans<<endl;\n}\n```",
        "postTime": 1676293924,
        "uid": 416928,
        "name": "llingy",
        "ccfLevel": 7,
        "title": "ABC 259 Ex \u9898\u89e3"
    },
    {
        "content": "## Solution\n\n\u6839\u53f7\u5206\u6cbb\u3002\n\n\u7b2c\u4e00\u79cd\u505a\u6cd5\uff0c\u4e5f\u662f\u6700\u81ea\u7136\u7684\uff0c\u679a\u4e3e\u4e24\u4e24\u989c\u8272\u76f8\u540c\u7684\u6570\u3002\u5047\u8bbe\u70b9 $(a,b)$ \u8981\u8d70\u5230\u70b9 $(c,d)$\uff0c\u65b9\u6848\u6570\u662f $C_{c+d-a-b}^{c-a}$\u3002\n\n\u7b2c\u4e8c\u79cd\u505a\u6cd5\uff0c\u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272\u5206\u5f00\u8003\u8651\u3002\u6211\u4eec\u8bbe $dp_{a,b}$ \u662f\u4ece\u67d0\u4e2a\u94a6\u5b9a\u989c\u8272\u8d70\u5230\u683c\u5b50 ${a,b}$ \u7684\u65b9\u6848\u6570\u3002\u663e\u7136\u6709 $dp_{a,b}=dp_{a,b-1}+dp_{b,a-1}+[col_{a,b}=tag]$\u3002\n\n\u8fd9\u4e24\u79cd\u505a\u6cd5\u90fd\u662f $O(n^4)$ \u7684\u3002\n\n\u4f46\u662f\u4f60\u7ec6\u54c1\uff0c\u5982\u679c\u540c\u79cd\u989c\u8272\u7684\u6570\u5f88\u5c11\uff0c\u90a3\u4e48\u7b2c\u4e00\u79cd\u505a\u6cd5\u5f88\u5feb\u3002\n\n\u5982\u679c\u989c\u8272\u79cd\u7c7b\u5f88\u5c11\uff0c\u4e5f\u5c31\u662f\u540c\u79cd\u989c\u8272\u7684\u6570\u5f88\u591a\uff0c\u90a3\u4e48\u7b2c\u4e8c\u79cd\u505a\u6cd5\u5f88\u5feb\u3002\n\n\u8fd9\u79cd\u6839\u636e\u6570\u636e\u5927\u5c0f\u786e\u5b9a\u590d\u6742\u5ea6\u7684\uff0c\u800c\u4e14\u6b63\u597d\u5b58\u5728\u5404\u6709\u6240\u957f\u7684\u4e24\u79cd\u505a\u6cd5\uff0c\u8003\u8651\u4f7f\u7528\u6839\u53f7\u5206\u6cbb\u3002\n\n\u5047\u8bbe\u4e00\u4e2a\u9608\u503c $B$\u3002\u90a3\u4e48 $\\ge B$ \u7684\u6570\u7528\u7b2c\u4e8c\u79cd\u505a\u6cd5\u3002\u6700\u591a\u6709 $\\frac{n^2}{B}$ \u79cd\u8fd9\u6837\u7684\u989c\u8272\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u4e3a $O(\\frac{n^4}{B})$\u3002\n\n$< B$ \u7684\u6570\u7528\u7b2c\u4e00\u79cd\u65b9\u6cd5\u3002\u5047\u8bbe\u6bcf\u79cd\u989c\u8272\u7684\u4e2a\u6570\u662f $x_i$\uff0c\u90a3\u4e48\u4f60\u8981\u5728 $\\sum x_i$ \u4e00\u5b9a\u7684\u65f6\u5019\u6700\u5927\u5316 $\\sum x_i^2$ \u6765\u4f30\u7b97\u6700\u5dee\u590d\u6742\u5ea6\u3002\n\n\u7531\u4e8e $(a+b)^2 \\ge a^2+b^2$\uff0c\u90a3\u4e48\u5e94\u5f53\u6bcf\u4e2a\u6570\u90fd\u53d6\u5230\u6700\u5927\u503c\u3002\u4e5f\u5c31\u662f $x_i=B$\u3002\u8fd9\u6837\u6700\u591a\u6709 $\\frac{n^2}{B} \\times B^2=n^2B$ \u7684\u8ba1\u7b97\u6b21\u6570\u3002\n\n\u603b\u590d\u6742\u5ea6\u662f $O(n^2B+\\frac{n^4}{B})$\u3002\u5f53 $B=n$ \u65f6\u53d6\u6700\u5c0f\u503c  $O(n^3)$\u3002\n\n\u4ee3\u7801\u975e\u5e38\u7b80\u5355\u3002",
        "postTime": 1682086532,
        "uid": 120947,
        "name": "Purslane",
        "ccfLevel": 7,
        "title": "AT_abc259_h \u9898\u89e3"
    },
    {
        "content": "\u6ce8\u610f\u5230\u6bcf\u79cd\u989c\u8272\u4e4b\u95f4\u662f\u4e92\u76f8\u72ec\u7acb\u7684\uff0c\u8003\u8651\u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272\u5206\u522b\u7edf\u8ba1\u7b54\u6848\u3002\n\n\u8bbe\u8fd9\u79cd\u989c\u8272\u7684\u65b9\u683c\u5171\u6709 $k$ \u4e2a\uff0c\u663e\u7136\u53ef\u4ee5\u679a\u4e3e\u8def\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9 $(a,b)$\uff0c$(c,d)$\uff0c\u518d\u4e58\u4e0a $C_{b-a+d-c}^{b-a}$\uff0c\u7edf\u8ba1\u5230\u7b54\u6848\u4e2d\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(k^2)$\u3002\n\n\u6211\u4eec\u8fd8\u53ef\u4ee5\u8bbe $f_{i,j}$ \u8868\u793a\u4ece\u8fd9\u79cd\u989c\u8272\u7684\u683c\u5b50\u8d70\u5230 $(i,j)$ \u7684\u65b9\u6848\u6570\uff0c\u8f6c\u79fb\u5f0f\u663e\u7136\uff0c\u5373 $f_{i,j}=f_{i-1,j}+f_{i,j-1}+[a_{i,j}=c]$\u3002\u7b54\u6848\u5373\u4e3a $\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n f_{i,j}[a_{i,j}=c]$\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n^2)$\u3002\n\n\u9047\u5230\u8fd9\u79cd\u6709\u591a\u79cd\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u540c\u7684\u66b4\u529b\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u60f3\u5230\u6839\u53f7\u5206\u6cbb\u3002\u8bbe\u8fd9\u4e2a\u9608\u503c\u4e3a $B$\uff0c\u5219\u5f53\u8fd9\u79cd\u989c\u8272\u7684\u65b9\u683c\u6570 $\\le B$ \u65f6\uff0c\u6267\u884c\u7b2c\u4e00\u79cd\u7b97\u6cd5\uff0c\u6b64\u65f6\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u8d85\u8fc7 $O(n^2B)$\uff0c\u5f53\u65b9\u683c\u6570\u5927\u4e8e $B$ \u65f6\uff0c\u6267\u884c\u7b2c\u4e8c\u79cd\u7b97\u6cd5\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u8d85\u8fc7 $O(\\dfrac{n^4}{B})$\u3002\n\n$n^2B=\\dfrac{n^4}{B}$\uff0c\u89e3\u5f97 $B=n$\uff0c\u6b64\u65f6\u65f6\u95f4\u590d\u6742\u5ea6\u6700\u4f18\uff0c\u4e3a $\\Theta(n^3)$\u3002\n\nCode:\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <vector>\nusing namespace std ;\nconst int mod = 998244353 ;\nint n , a[410][410] , c[810][810] , f[410][410] , ans ;\ntypedef pair <int , int> P ;\n#define mp make_pair\n#define fi first\n#define se second\nvector <P> v[410 * 410] ;\nint main () {\n\tscanf (\"%d\" , &n) ;\n\tfor (int i = 0 ; i <= 2 * n ; i++) c[i][0] = 1 ;\n\tfor (int i = 1 ; i <= 2 * n ; i++)\n\t\tfor (int j = 1 ; j <= i ; j++)\n\t\t\tc[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % mod ;\n\tfor (int i = 1 ; i <= n ; i++)\n\t\tfor (int j = 1 ; j <= n ; j++)\n\t\t\tscanf (\"%d\" , &a[i][j]) , v[a[i][j]].push_back (mp (i , j))  ;\n\tfor (int i = 1 ; i <= n * n ; i++) {\n\t\tint len = v[i].size () ;\n\t\tif (!len) continue ;\n\t\tif (len < n) {\n\t\t\tfor (int j = 0 ; j < len ; j++)\n\t\t\t\tfor (int k = 0 ; k < len ; k++) {\n\t\t\t\t\tint x = v[i][j].fi , y = v[i][j].se , xx = v[i][k].fi , yy = v[i][k].se ;\n\t\t\t\t\tif (x <= xx && y <= yy) ans = (ans + c[xx - x + yy - y][xx - x]) % mod ;\n\t\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int j = 1 ; j <= n ; j++)\n\t\t\t\tfor (int k = 1 ; k <= n ; k++) {\n\t\t\t\t\tf[j][k] = (f[j][k - 1] + f[j - 1][k] + (a[j][k] == i)) % mod ;\n\t\t\t\t\tif (a[j][k] == i) ans = (ans + f[j][k]) % mod ;\n\t\t\t\t}\n\t\t}\n\t}\n\tprintf (\"%d\\n\" , ans) ;\n\treturn 0 ;\n} \n```",
        "postTime": 1667781848,
        "uid": 122641,
        "name": "GIFBMP",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 ABC259Ex\u3010Yet Another Path Counting\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/dd-d/p/16823698.html)\n## Sol  \n\u8003\u8651\u4e24\u79cd\u66b4\u529b\u3002  \n\n- \u76f4\u63a5\u679a\u4e3e\u540c\u7c7b\u70b9\uff0c\u7ec4\u5408\u6570\u8ba1\u7b97\u4e24\u70b9\u4e4b\u95f4\u7684\u8def\u5f84\u6570\u3002\u5355\u6b21\u64cd\u4f5c\u65f6\u95f4\u590d\u6742\u5ea6 $O(B^2)$\u3002\u5176\u4e2d $B$ \u8868\u793a\u8fd9\u7c7b\u70b9\u7684\u4e2a\u6570\u3002\n- \u66b4\u529b dp\uff0c\u8bb0 $dp_{i,j}$ \u8868\u793a\u5230 $(i,j)$ \u7684\u65b9\u6848\u6570\uff0c\u82e5\u8d70\u5230\u540c\u7c7b\u70b9\u90a3\u4e48\u52a0\u4e0a\u65b9\u6848\u6570\uff0c\u5355\u6b21\u64cd\u4f5c\u590d\u6742\u5ea6 $O(n^2)$\u3002  \n\n\u7136\u540e\u8003\u8651\u6839\u53f7\u5206\u6cbb\uff0c\u5f53 $B \\leq n$ \u65f6\uff0c\u505a\u7b2c\u4e00\u79cd\u64cd\u4f5c\uff0c\u5355\u6b21\u590d\u6742\u5ea6 $O(n^2)$\uff0c\u4e0d\u4f1a\u8d85\u8fc7 $n$ \u6b21\uff0c\u603b\u590d\u6742\u5ea6 $O(n^3)$\u3002\u5f53 $B>n$ \u65f6\uff0c\u6700\u591a\u505a $n$ \u6b21\uff0c\u5355\u6b21\u590d\u6742\u5ea6 $O(n^2)$\uff0c\u603b\u590d\u6742\u5ea6 $O(n^3)$\u3002  \n\u7efc\u4e0a\uff0c\u603b\u590d\u6742\u5ea6 $O(n^3)$\u3002  \n## Code  \n```cpp\n//LYC_music yyds!\n#include<bits/stdc++.h>\n#define IOS ios::sync_with_stdio(0)\n#define lowbit(x) (x&(-x))\n#define int long long\nusing namespace std;\ninline char gc()\n{\n\tstatic char buf[1000000],*p1=buf,*p2=buf;\n\treturn p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++;\n}\nint read()\n{\n\tint pos=1,num=0;\n\tchar ch=getchar();\n\twhile (!isdigit(ch))\n\t{\n\t\tif (ch=='-') pos=-1;\n\t\tch=getchar();\n\t}\n\twhile (isdigit(ch))\n\t{\n\t\tnum=num*10+(int)(ch-'0');\n\t\tch=getchar();\n\t}\n\treturn pos*num;\n}\nvoid write(int x)\n{\n\tif (x<0)\n\t{\n\t\tputchar('-');\n\t\twrite(-x);\n\t\treturn;\n\t}\n\tif (x>=10) write(x/10);\n\tputchar(x%10+'0');\n}\nvoid writesp(int x)\n{\n\twrite(x);\n\tputchar(' ');\n}\nvoid writeln(int x)\n{\n\twrite(x);\n\tputchar('\\n');\n}\nconst int N=1e3+10,mod=998244353;\nint n,C[N][N],ans,f[N][N],Map[N][N];\nvector<pair<int,int> > G[N*N];\nvoid work1(vector<pair<int,int> > g)\n{\n\tfor (int i=0;i<(int)g.size();i++)\n\t\tfor (int j=i;j<(int)g.size();j++)\n\t\t{\n\t\t\tint x=g[i].first-g[j].first,y=g[i].second-g[j].second;\n\t\t\tif (x<0) x=-x,y=-y;\n\t\t\telse if (!x&&y<0) y=-y;\n\t\t\tif (y<0) continue;\t\n\t\t\tans=(ans+C[x+y][x])%mod;\n\t\t}\n}\nvoid work2(vector<pair<int,int> > g)\n{\n\tmemset(Map,0,sizeof(Map));\n\tfor (auto x:g)\n\t\tMap[x.first][x.second]=1;\n\tfor (int i=1;i<=n;i++)\n\t\tfor (int j=1;j<=n;j++)\n\t\t{\n\t\t\tf[i][j]=(f[i-1][j]+f[i][j-1])%mod;\n\t\t\tif (Map[i][j]) (f[i][j]+=1)%=mod,ans=(ans+f[i][j])%mod;\n\t\t}\n}\nsigned main()\n{\n\tn=read();\n\tfor (int i=0;i<=2*n;i++)\n\t{\n\t\tC[i][0]=1;\n\t\tfor (int j=1;j<=i;j++)\n\t\t\tC[i][j]=(C[i-1][j]+C[i-1][j-1])%mod;\n\t}\n\tfor (int i=1;i<=n;i++)\n\t\tfor (int j=1;j<=n;j++)\n\t\t{\n\t\t\tint x=read();\n\t\t\tG[x].emplace_back(i,j);\n\t\t}\n\tfor (int i=1;i<=n*n;i++)\n\t{\n\t\tif (G[i].empty()) continue;\n\t\tif (G[i].size()<=n) work1(G[i]);\n\t\telse work2(G[i]);\n\t}\n\twriteln(ans);\n}\n\n\n\n\n\n```",
        "postTime": 1666654791,
        "uid": 167999,
        "name": "dd_d",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011ABC259Ex Yet Another Path Counting"
    },
    {
        "content": "\u679a\u4e3e\u79cd\u7c7b\uff0c\u7136\u540e\u518d\u505a\u3002\n\n\u8003\u8651\u66b4\u529b\u4e00\uff1a\u76f4\u63a5 dp\u3002\u5c06\u8fd9\u4e00\u79cd\u7c7b\u6240\u6709\u70b9\u7684 dp \u503c\u8bbe\u4e3a $1$\uff0c\u7136\u540e $dp_{i,j}\\gets dp_{i,j}+dp_{i-1,j}+dp_{i,j-1}$\u3002\u7b54\u6848\u5c31\u662f\u540c\u79cd\u7c7b\u6240\u6709\u70b9\u7684 dp \u503c\u4e4b\u548c\u3002\n\n\u8003\u8651\u66b4\u529b\u4e8c\uff1a\u76f4\u63a5\u7ec4\u5408\u6570\u3002$(a,b)\\to (c,d)$ \u7684\u65b9\u6848\u6570\u5373 $\\binom {c+d-a-b}{c-a}$\u3002\u9884\u5904\u7406\u7ec4\u5408\u6570\uff0c\u679a\u4e3e\u8fd9\u4e00\u79cd\u7c7b\u70b9\u5bf9\u6240\u6709\u70b9\u5bf9\u3002\n\n\u8003\u8651\u5982\u4f55\u7ed3\u5408\uff0c\u5373\u8bbe\u7f6e\u9608\u503c $B$\uff0c\u82e5\u8fd9\u4e00\u79cd\u7c7b\u70b9\u6570\u91cf\u5927\u4e8e $B$\uff0c\u5219\u6267\u884c\u66b4\u529b\u4e00\uff1b\u5426\u5219\u6267\u884c\u66b4\u529b\u4e8c\u3002\u8ba1\u7b97\u590d\u6742\u5ea6\uff1a\u66b4\u529b\u4e00\u5355\u6b21\u590d\u6742\u5ea6\u4e3a $O(n^2)$\uff0c\u6700\u591a $\\frac{n^2}{B}$ \u6b21\uff0c\u5373\u4e3a $O(\\frac{n^4}{B})$\uff1b\u66b4\u529b\u4e8c\u5355\u6b21\u6267\u884c\u6b21\u6570\u4e3a $n_i^2$\uff0c\u603b\u7684\u5373\u4e3a $\\sum n_i^2\\le (\\max n_i)\\sum n_i=O(Bn^2)$\u3002\u603b\u590d\u6742\u5ea6\u5373 $O(\\frac{n^4}{B}+n^2B)$\u3002\u53d6 $B=n$ \u5373\u6709\u6700\u4f18\u590d\u6742\u5ea6 $O(n^3)$\u3002",
        "postTime": 1666271972,
        "uid": 314991,
        "name": "zhouyuhang",
        "ccfLevel": 7,
        "title": "\u66b4\u529b+\u66b4\u529b=\u6b63\u89e3"
    }
]
[
    {
        "content": "## \u9898\u76ee\u63cf\u8ff0\n\u7ed9\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6b63\u6574\u6570\u5e8f\u5217 $A$\uff0c\u518d\u7ed9\u51fa\u4e00\u4e2a\u6b63\u6574\u6570 $m$,\u4fdd\u8bc1 $1\\le n,m\\le 10^5$\u3002\u6c42 $\\forall i(1\\le i\\le m)$ \u5728\u5e8f\u5217 $A$ \u4e2d\u6709\u591a\u5c11\u6570\u548c\u5b83\u4e92\u8d28\u3002\n\n## \u9898\u76ee\u5206\u6790\n\u8bbe\u5f53\u524d\u6b63\u5728\u5904\u7406 $x$ \u7684\u60c5\u51b5\uff0c\u5219\u7b54\u6848\u4e3a\n$$\n\\sum_{i=1}^n[gcd(A_i, x)=1]=\\sum_{i=1}^n\\varepsilon[gcd(A_i, x)]\n$$\n\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u7ed3\u8bba\n$$\n\\mu*I=\\varepsilon\n$$\n\u53ef\u4ee5\u628a\u5f0f\u5b50\u53d8\u6210\n$$\n\\sum_{i=1}^n\\sum_{e|gcd(A_i, x)}\\mu(e)\n$$\n\u4ea4\u6362\u679a\u4e3e\u987a\u5e8f\n$$\n\\sum_{e|x}\\mu(e)\\sum_{i=1}^n[e|A_i]\n$$\n\u8bbe $Cnt(e)$ \u8868\u793a\u5728 $A$ \u4e2d\u6709\u591a\u5c11\u6570\u662f $e$ \u7684\u500d\u6570\uff0c\u4e0a\u5f0f\u53ef\u4ee5\u53d8\u6210\n$$\n\\sum_{e|x}\\mu(e)Cnt(e)\n$$\n\u8bbe\u503c\u57df\u4e3a $V$\uff0c$O(n\\sqrt{V})$ \u7684\u9884\u5904\u7406 $Cnt$\uff0c\u518d\u7528\u7ebf\u6027\u7b5b\u6c42\u51fa\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\uff0c\u7136\u540e $m\\sqrt{V}$ \u7684\u5904\u7406\u7b54\u6848\u5373\u53ef\u3002\n\n## \u4ee3\u7801\u5b9e\u73b0\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define FL(a, b, c) memset(a, b, c)\n#define RE() cout << \"What Happened?\" << endl\n#define TE() cerr << \"Time : \" << clock() << \"(ms)\" << endl\n#define DG(x) cout << \"Debug : \" << #x << \" = \" << x << endl\n#define IR(a, b, c, ...) for (int a(b), ##__VA_ARGS__; a <= c; ++a)\n#define OR(a, b, c, ...) for (int a(b), ##__VA_ARGS__; a >= c; --a)\n#define ER(a, b, c, ...) for (int a(head[b]), c(ver[a]), ##__VA_ARGS__; a; a = next[a], c = ver[a])\nusing namespace std;\nstruct FastIN {\n\ttemplate < class T > inline FastIN& operator >> (T& x) {\n\t\tx = 0; bool sd(false);\n\t\tchar ch(getchar());\n\t\twhile (!isdigit(ch) and (ch != '-')) ch = getchar();\n\t\tif (ch == '-') sd = true, ch = getchar();\n\t\twhile (ch >= '0' and ch <= '9') x = (x << 3) + (x << 1) + ch - '0', ch = getchar();\n\t\tif (sd == true) x = -x;\n\t\treturn *this;\n\t}\n} IN;\nconst int INF(~0u >> 1);\nusing PII = pair < int, int >;\ntemplate < class T > inline void CL(T& x_) { FL(x_, 0, sizeof x_); }\ntemplate < class T, class... Args > inline void CL(T &x_, Args& ...others) { FL(x_, 0, sizeof x_), CL(others...); }\n\nconst int kN(1e5 + 10);\nint N, M, Cnt[kN];\nbool Prime[kN]; int Mu[kN]; vector < int > List;\ninline void Ols(int lim) {\n\tMu[1] = Prime[1] = 1;\n\tIR(i, 2, lim) {\n\t\tif (!Prime[i]) List.push_back(i), Mu[i] = -1;\n\t\tIR(j, 0, (int) (List.size()) - 1 and i * List[j] <= lim) {\n\t\t\tPrime[i * List[j]] = true;\n\t\t\tif (!(i % List[j])) {\n\t\t\t\tMu[i * List[j]] = 0; break;\n\t\t\t} else Mu[i * List[j]] = Mu[i] * Mu[List[j]];\n\t\t}\n\t}\n}\n\nsigned main() {\n#ifdef FIO\n\tfreopen(\"I:/Code/Data/In.in\", \"r\", stdin);\n//\tfreopen(\"I:/Code/Data/Out.out\", \"w\", stdout);\n#endif\n\tIN >> N >> M;\n\tOls(kN - 1);\n\tIR(i, 1, N, x) {\n\t\tIN >> x; int lim(sqrt(x));\n\t\tIR(e, 1, lim) if (x % e == 0) {\n\t\t\t++Cnt[e];\n\t\t\tif (e != x / e) ++Cnt[x / e];\n\t\t}\n\t} IR(x, 1, M) {\n\t\tint lim(sqrt(x)), ans(0);\n\t\tIR(e, 1, lim) if (x % e == 0) {\n\t\t\tans += Mu[e] * Cnt[e];\n\t\t\tif (e != x / e) ans += Mu[x / e] * Cnt[x / e];\n\t\t}\n\t\tcout << ans << \"\\n\";\n\t}\n}\n```",
        "postTime": 1648899690,
        "uid": 308107,
        "name": "Xu__",
        "ccfLevel": 6,
        "title": "AT3898 Uncommon \u9898\u89e3"
    }
]
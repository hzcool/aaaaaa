[
    {
        "content": "\u8003\u5bdf\u53d6 $a_i\\equiv 1$\uff0c\u90a3\u4e48\u4f60\u4f1a\u5f97\u5230\u4e00\u4e32\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\uff0c\u8fd9\u542f\u53d1\u6211\u4eec\u7528\u7c7b\u4f3c\u4e8e\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u7684\u505a\u6cd5\u6765\u89e3\u51b3\u8fd9\u4e2a\u9898\u3002\n\n\u4eff\u7167\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u5199\u51fa\u9012\u63a8\u5f0f\uff0c\u53d1\u73b0\u6700\u5c0f\u503c\u597d\u50cf\u4e0d\u592a\u597d\u529e\uff0c\u90a3\u4e48\u6392\u5e8f\uff0c\u4e0d\u59a8\u8bbe $a_1\\le a_2\\le\\dots\\le a_n$\uff0c\u90a3\u4e48\u5199\u51fa\u9012\u63a8\u5f0f $S'(n,m)=a_nS'(n-1,m-1)+(n-1)S'(n-1,m)$\uff0c\u90a3\u8fdb\u4e00\u6b65\u5c31\u53ef\u4ee5\u77e5\u9053\u884c\u751f\u6210\u51fd\u6570\u662f $\\prod_i(a_ix+i-1)$\u3002\n\n\u7136\u540e\u4f60\u5149\u901f\u642c\u51fa\u4e00\u4e2a\u591a\u9879\u5f0f\u677f\u5b50\uff0c\u5206\u6cbb dft \u4e00\u4e0b\uff0c\u7136\u540e\u559c\u95fb\u4e50\u89c1\u7684 wa \u4e86\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\u56e0\u4e3a\u4f60 dft \u7684\u65f6\u5019\u5bf9 $998244353$ \u53d6\u6a21\u4e86\uff0c\u90a3\u4f60 gcd \u663e\u7136\u5931\u53bb\u4e86\u610f\u4e49\uff0c\u6211\u4eec\u7ee7\u7eed\u89c2\u5bdf\u6027\u8d28\u3002\n\n\u90a3\u4e48\u4e00\u4e2a\u663e\u7136\u7684\u6027\u8d28\u5c31\u662f\uff0c$fg$ \u7684\u7cfb\u6570\u7684\u6700\u5927\u516c\u56e0\u6570\u7b49\u4e8e $f$ \u7cfb\u6570\u6700\u5927\u516c\u56e0\u6570\u548c $g$ \u7cfb\u6570\u6700\u5927\u516c\u56e0\u6570\u7684\u4e58\u79ef\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\u9996\u5148\u663e\u7136\u53ef\u4ee5\u89c4\u7ea6\u6210\u5f53 $f$ \u7cfb\u6570\u6700\u5927\u516c\u56e0\u6570\u4e0e $g$ \u7cfb\u6570\u6700\u5927\u516c\u56e0\u6570\u90fd\u4e3a $1$ \u7684\u60c5\u5f62\uff0c\u7136\u540e\u4f60\u8003\u5bdf\u5047\u8bbe $p|fg$\uff0c\u90a3\u4f60\u8003\u8651 $\\bmod \\ p$ \u610f\u4e49\u4e0b\uff0c$f,g$ \u90fd\u4e0d\u662f $0$\uff0c\u4f46\u662f $fg$ \u5374\u662f $0$\uff0c\u8fd9\u53ef\u80fd\u5417\uff0c\u6240\u4ee5\u77db\u76fe\u4e86\u3002\n\n\u90a3\u4e48\u6839\u636e\u8fd9\u4e2a\u6027\u8d28\uff0c\u7b54\u6848\u5c31\u662f $\\prod_i\\gcd(a_i,i-1)$\uff0c\u8fd9\u6837\u5c31\u505a\u5b8c\u4e86\u3002\n\n```cpp\nconst int N=1e5+5;\nint n,a[N],ans=1;\nint gcd(int a,int b){return !b?a:gcd(b,a%b);}\nint main(){\n\tIO>>n;\n\trep(i,1,n)IO>>a[i];\n\tsort(a+1,a+n+1);\n\trep(i,1,n)ans=1ll*ans*gcd(a[i],i-1)%P;\n\tIO<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1667659473,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "\u4e00\u822c\u63d0"
    },
    {
        "content": "[$\\mathfrak{View\\space it\\space on\\space my\\space Blog}$](https://blog.seniorious.cc/2020/AT-4498/)\n\n## \u5206\u6790\n\n\u9996\u5148\u770b\u5230\u5206\u6210\u5706\u6392\u5217\u4e0d\u96be\u8054\u60f3\u5230\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\uff0c\u89c2\u5bdf\u5176\u9012\u63a8\u5f0f\uff1a$\\left[\\begin{matrix}i\\\\j\\end{matrix}\\right]=\\left[\\begin{matrix}i-1\\\\j-1\\end{matrix}\\right]+(i-1)\\times\\left[\\begin{matrix}i-1\\\\j\\end{matrix}\\right]$\n\n\u53d1\u73b0\u82e5\u6211\u4eec\u5c06\u65b0\u5efa\u4e00\u4e2a\u5706\u6392\u5217\u7684\u7cfb\u6570 $1$ \u6539\u4e3a\u6b64\u5706\u6392\u5217\u7684\u6700\u5c0f\u503c\u5373\u4e3a\u672c\u9898\u6240\u6c42\uff0c\u4e0d\u96be\u53d1\u73b0\u53ef\u4ee5\u5c06 $a$ \u6570\u7ec4\u5347\u5e8f\u6392\u5e8f\uff0c\u4e8e\u662f\u5b83\u7684\u7cfb\u6570\u5c31\u662f $a_i$\uff0c\u5373 $f_{i,j}=a_if_{i-1,j-1}+(i-1)f_{i-1,j}$\n\n\u4e8e\u662f\u4e0d\u96be\u5199\u51fa $f_{n,i}$ \u7684\u751f\u6210\u51fd\u6570\u5373\u4e3a $\\prod\\limits_{i=1}^n(a_ix+i-1)$\n\n\u5148\u7ed9\u4e2a\u7ed3\u8bba\uff1a\u82e5\u6709\u591a\u9879\u5f0f $P,Q$ \u548c\u51fd\u6570 $c(F)=\\gcd\\limits_{i}([x^i]F)$ \u5219 $c(PQ)=c(P)c(Q)$ \u4e8e\u662f\u7b54\u6848\u5373\u4e3a $\\prod\\limits_{i=1}^n\\gcd(a_i,i-1)$\n\n\u4e0b\u9762\u8003\u8651\u8bc1\u660e\u8fd9\u4e2a\u7ed3\u8bba\uff1a\n\n\u4e0d\u5931\u4e00\u822c\u6027\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8bc1\u660e $c(P)=c(Q)=1$ \u65f6 $c(PQ)=1$\uff0c\u6211\u4eec\u91c7\u7528\u5f52\u8c2c\u6cd5\u8bc1\u660e\uff0c\u8bbe $c(PQ)$ \u4e3a\u67d0\u8d28\u6570 $p$ \u7684\u500d\u6570\uff0c\u5219 $PQ$ \u7684\u6700\u9ad8\u9879\u4e3a $p$ \u7684\u500d\u6570\uff0c\u90a3\u4e48 $P,Q$ \u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u6700\u9ad8\u9879\u4e3a $p$ \u7684\u500d\u6570\uff0c\u8003\u8651\u5230 $p$ \u4e58\u4efb\u4f55\u6570\u90fd\u662f $p$ \u7684\u500d\u6570\uff0c\u6545 $P$ \u7684\u6700\u9ad8\u4f4d\u4e0d\u6539\u53d8 $PQ$ \u4e2d\u4efb\u4f55\u4e00\u9879\u662f\u5426\u6574\u9664 $p$ \u8bbe $P^\\prime$ \u4e3a $P$ \u53bb\u6389\u6700\u9ad8\u9879\u7684\u591a\u9879\u5f0f\uff0c\u4e8e\u662f\u6709 $p\\mid c(P^\\prime Q)$ \u2026\u2026 \u4ee5\u6b64\u7c7b\u63a8\uff0c\u4e0d\u65ad\u89c4\u7ea6\uff0c\u603b\u80fd\u89c4\u7ea6\u5230 $P,Q$ \u90fd\u53ea\u5269\u5e38\u6570\u9879\uff0c\u6b64\u65f6 $P,Q$ \u7684\u975e\u5e38\u6570\u9879\u5747\u4e3a $p$ \u7684\u500d\u6570\uff0c\u800c $c(P)=c(Q)=1$ \u6545\u4e8c\u8005\u5e38\u6570\u9879\u5747\u4e0d\u6574\u9664 $p$ \uff0c\u4f46\u8fd9\u4e0e $PQ$ \u7684\u5e38\u6570\u9879\u4e3a $p$ \u7684\u500d\u6570\u77db\u76fe\uff0c\u6545\u5f97\u8bc1\n\n## \u4ee3\u7801\n\n```cpp\nconstexpr int Mod = 998244353;\nconstexpr int N = 100005;\n\nint a[N];\nint n;\n\nint main() {\n  read(n);\n  int ans = 1;\n  for (int i = 1; i <= n; ++i) {\n    read(a[i]);\n  }\n  std::sort(a + 1, a + n + 1);\n  for (int i = 1; i <= n; ++i) {\n    ans = ans * 1ll * std::gcd(a[i], i - 1) % Mod;\n  }\n  write(ans), EL;\n  return 0;\n}\n```\n\n",
        "postTime": 1606923899,
        "uid": 25251,
        "name": "moongazer",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 AT4498 \u3010Cyclic GCDs\u3011"
    }
]
[
    {
        "content": "under \u9898\u89e3 [AT684](https://www.luogu.com.cn/problem/AT684)\n\n\u540c\u6b65\u53d1\u5e03\u4e8e[\u4e2a\u4eba\u535a\u5ba2](https://fa555.github.io/2020/\u67d0At\u7684dp\u573a/#D-\u30b5\u30a4\u30b3\u30ed)\n\n### problem\n\n\u5c06\u516d\u4e2a\u9762\u7684\u9ab0\u5b50\u63b7 $N \\ (1 \\le N \\le 100)$ \u6b21\uff0c\u6c42\u6bcf\u4e00\u6b21\u63b7\u5f97\u7684\u70b9\u6570\u7684\u4e58\u79ef\u662f $D \\ (1 \\le D \\le 10^{18})$ \u7684\u500d\u6570\u7684\u6982\u7387\u3002\n\n### solution\n\n\u8003\u8651\u9ab0\u5b50\u63b7\u51fa\u70b9\u6570\u7684\u4e58\u79ef\u7684\u8d28\u56e0\u5b50\u53ea\u53ef\u80fd\u6709 $2, 3, 5$\u3002\u8003\u8651\u76f4\u63a5\u4ece\u8fd9\u4e09\u4e2a\u56e0\u6570\u8fdb\u884c\u8f6c\u79fb\u3002\n\n\u8bbe $f_{i, a, b, c}$ \u8868\u793a\u7b2c $i$ \u6b21\u63b7\u9ab0\u5b50\u540e\u70b9\u6570\u7684\u4e58\u79ef\u4e2d\u56e0\u5b50 $2$ \u6709 $a$ \u4e2a\uff0c$3$ \u6709 $b$ \u4e2a\uff0c$5$ \u6709 $c$ \u4e2a\u7684\u53ef\u80fd\u6027\u3002\n\n\u76f4\u63a5\u679a\u4e3e\u6bcf\u6b21\u63b7\u9ab0\u5b50\u7684\u8fc7\u7a0b\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u8fb9\u754c\u6761\u4ef6 $f_{0, 0, 0, 0} = 1$\u3002\n\n\u7b54\u6848\u5373\u4e3a $f_{N, a, b, c}$\u3002\u603b\u590d\u6742\u5ea6 $O(Nabc)$\u3002\n\n### code\n\n\u5b9e\u73b0\u770b\u4e86\u770b\u9713\u8679\u56fd\u795e\u4ed9\u3059\u3044\u30d0\u30ab\u7684\uff08\u5c0f\u58f0\n\n\u8fd9\u4e2a dp \u6570\u7ec4\u751a\u81f3\u53ef\u4ee5\u6eda\u52a8\u6570\u7ec4\u538b\u6389\u4e00\u7ef4\uff0c\u4e0d\u8fc7\u8fd9\u91cc\u6ca1\u5199\u3002\n\n\u53d8\u91cf\u540d\u548c\u4e0a\u6587\u7565\u6709\u4e0d\u540c\u3002\u6570\u7ec4\u5927\u5c0f\u5947\u602a\u662f\u56e0\u4e3a\u662f\u538b\u7740\u4e0a\u754c\u5f00\u7684\u3002\n\n``` cpp\nconstexpr int s2[] = {0, 0, 1, 0, 2, 0, 1};\nconstexpr int s3[] = {0, 0, 0, 1, 0, 0, 1};\nconstexpr int s5[] = {0, 0, 0, 0, 0, 1, 0};\n\ndouble f[101][61][39][27];\n\ndouble dp(int N, long long D) {\n  int d2 = 0, d3 = 0, d5 = 0;\n  \n  while (D % 2 == 0)\n    D /= 2, ++d2;\n  while (D % 3 == 0)\n    D /= 3, ++d3;\n  while (D % 5 == 0)\n    D /= 5, ++d5;\n  if (D != 1) return 0;\n\n  f[0][0][0][0] = 1;\n  for (int i = 0; i < N; ++i)\n    for (int i2 = 0; i2 <= d2; ++i2)\n      for (int i3 = 0; i3 <= d3; ++i3)\n        for (int i5 = 0; i5 <= d5; ++i5)\n          for (int j = 1, t2, t3, t5; j <= 6; ++j) {\n            t2 = min(d2, i2 + s2[j]);\n            t3 = min(d3, i3 + s3[j]);\n            t5 = min(d5, i5 + s5[j]);\n            f[i + 1][t2][t3][t5] += f[i][i2][i3][i5] / 6;\n          }\n  return f[N][d2][d3][d5];\n}\n\n```",
        "postTime": 1584954244,
        "uid": 111890,
        "name": "fa_555",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT684 \u3010\u30b5\u30a4\u30b3\u30ed\u3011"
    }
]
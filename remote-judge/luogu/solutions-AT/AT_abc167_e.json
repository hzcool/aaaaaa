[
    {
        "content": "# [ABC167E] Colorful Blocks\n\n## \u9898\u610f\n\n\u7ed9\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\u67d3\u8272\uff0c\u6bcf\u4e2a\u5143\u7d20\u53ef\u4ee5\u67d3 $m$ \u79cd\u989c\u8272\uff0c\u8981\u6c42**\u6700\u591a**\u6709 $k$ \u5bf9\u76f8\u90bb\u7684\u5143\u7d20\u989c\u8272**\u76f8\u540c**\uff0c\u95ee\u65b9\u6848\u6570\u3002\n\n\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n## \u5206\u6790\n\n\u6211\u4eec\u5206\u522b\u5bf9**\u6070\u597d**\u6709 $i(0\\leq i \\leq k)$ \u5bf9\u76f8\u90bb\u7684\u5143\u7d20\u989c\u8272**\u76f8\u540c**\u65b9\u6848\u8fdb\u884c\u8ba8\u8bba\uff0c\u663e\u7136\uff0c\u6700\u540e\u6c42\u548c\u5c31\u53ef\u4ee5\u3002\n\n\u6211\u4eec\u628a\u76f8\u540c\u989c\u8272\u7684\u5143\u7d20\u7ed9\u770b\u505a\u4e00\u4e2a\u5143\u7d20\u3002\n\n\u90a3\u4e48\u6b64\u65f6\u5c31\u6709 $n-i$ \u4e2a\u5143\u7d20\u3002\n\n\u6240\u4ee5\uff0c\u7b2c\u4e00\u4e2a\u5143\u7d20\u6709 $m$ \u79cd\u9009\u6cd5\uff0c\u540e $n-i-1$ \u4e2a\u6570\u6709 $m-1$ \u79cd\u9009\u6cd5\uff0c\u6240\u4ee5\u7b54\u6848\u4e3a\uff1a\n\n$$ m\\times (m-1)^{n-i-1} $$\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\uff0c\u4e00\u5171\u6709 $n-1$ \u5bf9\u5143\u7d20\uff0c\u9009 $i$ \u5bf9\u76f8\u540c\u7684\uff0c\u6240\u4ee5\u65b9\u6848\u4e3a\uff1a\n\n$$ C_{n-1}^i $$\n\n\u6240\u4ee5\u6070\u597d\u6709 $i$ \u5bf9\u76f8\u90bb\u7684\u5143\u7d20\u989c\u8272\u76f8\u540c\u65b9\u6848\u6570\u4e3a\uff1a\n\n$$ m\\times (m-1)^{n-i-1} \\times C_{n-1}^i $$\n\n\u603b\u65b9\u6848\u6570\u4e3a\uff1a\n\n$$ \\sum_{i=0}^k m\\times (m-1)^{n-i-1} \\times C_{n-1}^i $$\n\n\u7528\u9884\u5904\u7406\u9636\u4e58\u7684\u65b9\u6cd5\u6c42\u7ec4\u5408\u6570\uff0c\u7f29\u51cf\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n## \u4ee3\u7801\n\n```\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\ninline int read(){\n    int x=0;bool f=0;char c=getchar();\n    while(c<'0'||'9'<c){if(c=='-')f=1;c=getchar();}\n    while('0'<=c&&c<='9'){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n    return f?-x:x;\n}\nconst int N=2e5+5,mod=998244353;\ninline int ksm(int a,int b){int t=1;for(;b;b>>=1,a=a*a%mod)if(b&1)t=t*a%mod;return t%mod;}\nint n,m,k,ans,inv[N],fac[N];\ninline int C(int n,int m){\n    return fac[n]*inv[m]%mod*inv[n-m]%mod;\n}\nsigned main(){\n    n=read();m=read();k=read();\n    fac[0]=inv[0]=1;\n    for(int i=1;i<=n;i++)//\u9884\u5904\u7406\n        fac[i]=fac[i-1]*i%mod;\n    inv[n]=ksm(fac[n],mod-2);\n    for(int i=n;i>=1;i--)\n        inv[i-1]=inv[i]*i%mod;\n    for(int i=0;i<=k;i++)\n        (ans+=m*ksm(m-1,n-1-i)%mod*C(n-1,i)%mod)%=mod;\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1677245372,
        "uid": 171868,
        "name": "sunzz3183",
        "ccfLevel": 4,
        "title": "[ABC167E] Colorful Blocks \u9898\u89e3"
    },
    {
        "content": "# [Colorful Blocks](https://www.luogu.com.cn/problem/AT_abc167_e)\n## \u9898\u610f\n\u9898\u9762\u6709\u70b9\u96fe\uff0c\u5e94\u4e3a\uff1a\u201c$k$ \u5bf9**\u76f8\u90bb**\u65b9\u683c\u989c\u8272**\u76f8\u540c**\u201d\uff0c\u800c\u4e0d\u662f\u201c$k$ \u5bf9\u76f8\u90bb\u989c\u8272\u7684\u65b9\u683c\u201d\u3002\n## \u601d\u8def\n\u8003\u8651**\u6070\u597d**\u6709 $i$ \u5bf9\u76f8\u90bb\u65b9\u683c\u989c\u8272\u76f8\u540c\u65f6\u7684\u65b9\u6848\u6570\uff0c\u6700\u540e\u7b54\u6848\u5c31\u662f\u6240\u6709\u60c5\u51b5\u4e4b\u548c\u3002\n\n\u8003\u8651\u6346\u7ed1\u6cd5\uff1a\u628a\u76f8\u90bb\u7684\u4e24\u4e2a\u989c\u8272\u76f8\u540c\u7684\u65b9\u683c\u6346\u7ed1\u6210\u4e00\u4e2a\u65b9\u683c\u6765\u770b\u3002\u6b64\u65f6\u53ea\u5269\u4e0b\u4e86 $n-i$ \u4e2a\u65b9\u683c\uff08\u56e0\u4e3a $2\\times i$ \u4e2a\u65b9\u683c\u88ab\u6346\u7ed1\u6210\u4e86 $i$ \u4e2a\uff09\u3002\n\n\u5728 $n-1$ \u5bf9\u65b9\u683c\u4e2d\u6311 $i$ \u5bf9\u67d3\u4e3a\u76f8\u540c\u989c\u8272\uff0c\u65b9\u6848\u6570\u4e3a $C_{n-1}^i$\u3002\n\n\u628a $n-i$ \u4e2a\u65b9\u683c\u67d3\u4e0a $m$ \u79cd\u989c\u8272\uff0c\u4e14\u76f8\u90bb\u4e24\u4e2a\u4e0d\u80fd\u76f8\u540c\uff08\u4e0d\u7136\u5c31\u80fd\u5408\u5e76\u4e86\uff09\u3002\u7b2c\u4e00\u4e2a\u65b9\u683c\u6709 $m$ \u79cd\u67d3\u6cd5\uff0c\u5269\u4e0b $n-i-1$ \u4e2a\u65b9\u683c\u90fd\u4e0d\u80fd\u548c\u4e0a\u4e00\u4e2a\u65b9\u683c\u989c\u8272\u76f8\u540c\uff0c\u5404\u6709 $m-1$ \u79cd\u67d3\u6cd5\u3002\u65b9\u6848\u6570\u4e3a $m\\times (m-1)^{n-i+1}$\u3002\n\n\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u60c5\u51b5\u4e3a $i$ \u65f6\u7684\u603b\u65b9\u6848\u6570\u4e3a $C_{n-1}^i\\times m\\times (m-1)^{n-i+1}$\u3002\n\n\u90a3\u4e48\u6700\u7ec8\u7b54\u6848\u5c31\u662f\uff1a\n$$\\sum_{i=0}^kC_{n-1}^i\\times m\\times (m-1)^{n-i+1}$$\n\n## \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nint n,m,k,mod=998244353,ans,fac[200005];\nint qpow(int x,int y)\n{\n\tint ret=1;\n\tfor(;y;y>>=1,x=x*x%mod)\n\t{\n\t\tif(y&1)\n\t\t\tret=ret*x%mod;\n\t}\n\treturn ret;\n}\nvoid init()//\u521d\u59cb\u5316\n{\n\tfac[0]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfac[i]=fac[i-1]*i%mod;\n\t}\n}\nint inv(int x)\n{\n\treturn qpow(fac[x],mod-2);//\u9006\u5143\n}\nint C(int x,int y)\n{\n\treturn fac[x]*inv(y)%mod*inv(x-y)%mod;//\u6c42\u7ec4\u5408\u6570\n}\nsigned main()\n{\n\tscanf(\"%lld%lld%lld\",&n,&m,&k);\n\tinit();\n\tfor(int i=0;i<=k;i++)\n\t{\n\t\tans=(ans+C(n-1,i)*m%mod*qpow(m-1,n-i-1)%mod)%mod;//\u7edf\u8ba1\u7b54\u6848\n\t}\n\tprintf(\"%lld\",ans);\n} \n```\n\u5e0c\u671b\u672c\u7bc7\u9898\u89e3\u80fd\u5e2e\u5230\u5927\u5bb6\uff01\uff01\uff01",
        "postTime": 1684593103,
        "uid": 631576,
        "name": "cyz2010",
        "ccfLevel": 0,
        "title": "ABC167E\u9898\u89e3"
    },
    {
        "content": "## \u80cc\u666f\n  \u8fd9\u9053\u9898\u5176\u5b9e\u548c [\u5c0f\u7403\u67d3\u8272](https://www.luogu.com.cn/problem/CF1081C) \u5f88\u76f8\u4f3c\uff0c\u76f8\u5f53\u4e8e\u5b83\u7684\u4e00\u4e2a\u53d8\u5f62\u3002\n\n## \u9898\u610f\n\n\u6709 $n$ \u4e2a\u5c0f\u7403\u6392\u6210\u4e00\u884c\uff0c\u6709 $m$ \u79cd\u989c\u8272\u53ef\u4ee5\u9009\u62e9\u7ed9\u6bcf\u4e2a\u5c0f\u7403\u6d82\u8272\uff0c\u8981\u8ba9\u8fd9\u4e9b\u5c0f\u7403\u6700\u591a\u6709 $k$ \u5bf9\u76f8\u90bb\u5c0f\u7403\u7684\u989c\u8272\u76f8\u540c\uff0c\u95ee\u6709\u591a\u5c11\u79cd\u6d82\u8272\u65b9\u6cd5\u3002\n\n\u7b54\u6848\u9700\u8981\u5bf9 $998244353$ \u53d6\u4f59\u3002\n\n## \u5206\u6790\n\n\u5b83\u7684\u601d\u8def\u53ef\u4ee5\u53c2\u7167\u4e0a\u9762\u90a3\u9053\u9898\u6765\u60f3\u3002\u9006\u5411\u601d\u8003\uff0c\u5148\u7b97\u51fa\u8981\u6c42\u6709 $i (0\\le i \\le k)$ \u4e2a\u5c0f\u7403\u76f8\u90bb\u7684\u65b9\u6848\u6570\uff0c\u6700\u540e\u76f8\u52a0\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$ \u5c0f\u7403\uff0c\u53ef\u4ee5\u7528\u7c7b\u4f3c\u51cf\u6cd5\u539f\u7406\uff0c\u5148\u7b97\u51fa\u6709 $i$ \u5bf9\u989c\u8272\u4e0d\u76f8\u540c\u7684\u60c5\u51b5\u6570\uff0c\u518d\u7528\u603b\u6570\u53bb\u51cf\u5f97\u5230\u7b54\u6848\u3002\n\n\u82e5\u8003\u8651\u4e0d\u76f8\u540c\u7684\u60c5\u51b5\uff0c\u5219\u53ef\u4ee5\u5148\u5c06\u6240\u6709\u989c\u8272\u76f8\u540c\u7684\u5c0f\u7403\u653e\u4e00\u8d77\u7ec4\u6210\u4e00\u4e2a\u6574\u4f53\uff0c\u663e\u7136\uff0c\u4f1a\u6709 $k+1$ \u4e2a\u6574\u4f53\uff0c\u90a3\u4e48\u5bf9\u8fd9 $k+1$ \u4e2a\u6574\u4f53\u67d3 $m$ \u79cd\u989c\u8272\uff0c\u7b2c\u4e00\u4e2a\u6709 $m$ \u79cd\u67d3\u8272\uff0c\u540e\u9762\u6bcf\u4e00\u4e2a\u90fd\u4e0d\u80fd\u67d3\u4e0a\u4e00\u4e2a\u67d3\u8fc7\u7684\u989c\u8272\uff0c\u6545\u603b\u65b9\u6848\u6570\u4e3a $m(m-1)^i$ \u79cd\u3002\n\n\u518d\u628a\u601d\u7ef4\u9000\u56de\u6765\uff0c\u6bcf\u79cd\u60c5\u51b5\u4f1a\u6709 $m(m-1)^{n-i-1}$ \u79cd\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u518d\u6c42\u6240\u6709\u6574\u4f53\u7ec4\u5408\u7684\u60c5\u51b5\u3002\u4e00\u5171 $n$ \u4e2a\u7403\uff0c\u6709 $n-1$ \u4e2a\u7a7a\u9699\uff0c\u5728\u8fd9\u4e9b\u7a7a\u9699\u4e2d\u4efb\u610f\u9009\u62e9 $i$ \u4e2a\u4e0d\u540c\u7684\u7a7a\u9699\uff0c\u4f7f\u5f97\u4e24\u8fb9\u7684\u989c\u8272\u4e0d\u540c\u7684\u65b9\u6848\u4e0d\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u7b54\u6848\u662f $\\mathrm C_{n-1}^{i}$ \u79cd\u3002\n\n\u7ecf\u8fc7\u63a8\u7406\uff0c\u53ef\u4ee5\u5f97\u5230\u7b2c $i$ \u79cd\u60c5\u51b5\u7684\u65b9\u6848\u6570\u4e3a\n\n$\\mathrm C_{n-1}^{i}m(m-1)^{n-i-1}$\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f\u6240\u6709\u65b9\u6848\u7684\u548c\u3002\n\n## Code\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int maxn=1e6+5;\nconst int mod=998244353;\nll qw(ll a,ll b)//\u5feb\u901f\u5e42 \n{\n\tll ans=1,t=a%mod;\n\twhile(b>0)\n\t{\n\t\tif(b&1) ans=ans*(t%mod)%mod;\n\t\tb/=2;\n\t\tt=t*(t%mod)%mod;\n\t}\n\treturn ans;\n}\nll fac[maxn],inv[maxn];\nvoid get_inv()//\u9884\u5904\u7406\u9006\u5143 \n{\n\tfac[0]=1;\n\tfor(int i=1;i<maxn;i++) \n\tfac[i]=fac[i-1]*i%mod;\n\tinv[maxn-1]=qw(fac[maxn-1],mod-2);\n\tfor(int i=maxn-2;i>=0;i--) \n\tinv[i]=inv[i+1]*(i+1)%mod;\n}\t\nll n,m,k,ans=0;\nll C(ll a,ll b)//\u7ec4\u5408\u6570 \n{\n\treturn (fac[a]*(inv[b]*inv[a-b]%mod))%mod;\n}\nint main()\n{\nget_inv();\n//\tfreopen(\"xxx.in\",\"r\",stdin);\n//\tfreopen(\"xxx.out\",\"w\",stdout);\ncin>>n>>m>>k;\nfor(int i=0;i<=k;i++)\n{\nans=ans+m*qw(m-1,n-1-i)%mod*C(n-1,n-i-1)%mod;//\u8ba1\u7b97 \nans%=mod;\n}\nprintf(\"%lld\\n\",ans);\n//c(k,n-1)*m*(m-1)^k\n}\n```\n\n\n\n\n\n",
        "postTime": 1684047591,
        "uid": 769811,
        "name": "fengyixuan2027",
        "ccfLevel": 0,
        "title": "[ABC167E] Colorful Blocks\u9898\u89e3"
    }
]
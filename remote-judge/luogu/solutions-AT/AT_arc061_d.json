[
    {
        "content": "**\u9898\u610f** \uff1a \u6709\u4e09\u5806\u724c\uff0c\u5206\u522b\u6709 $n_1,n_2,n_3$ \u5f20\u3002\u724c\u4e0a\u5199\u7740\u6570\u5b57 \n$1,2,3$ \u4e2d\u7684\u4e00\u4e2a\u3002\n\n\u5148\u4ece\u724c\u5806 $1$ \u4e2d\u62bd\u4e00\u5f20\uff0c\u63a5\u4e0b\u6765\uff0c\u724c\u4e0a\u5199\u7740\u51e0\u5c31\u4ece\u51e0\u53f7\u724c\u5806\u62bd\u53d6\u3002\n\n\u6c42\u5728\u6240\u6709\u53ef\u80fd\u7684 $3^{n_1+n_2+n_3}$ \u79cd\u65b9\u6848\u4e2d\uff0c\u5148\u628a\u724c\u5806 $1$ \u62bd\u7a7a\u7684\u65b9\u6848\u6570\u3002\n\n\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n$n_1,n_2,n_3\\leq 3\\times 10^5$ \uff0c\u65f6\u9650 $\\texttt{3s}$\u3002\n\n------------\n\n\u6761\u4ef6\u8ba1\u6570\u7684\u8def\u5b50\u65e0\u975e\u4e24\u6761\uff0c\u8981\u4e48\u5bfb\u627e\u66f4\u7b80\u6d01\u7684\u5145\u8981\u6761\u4ef6\uff0c\u8981\u4e48\u5bb9\u65a5\u3002\n\n\u9898\u76ee\u4e2d\u7684\u8fc7\u7a0b\u6bd4\u8f83\u7cbe\u5de7\uff0c\u8003\u8651\u5bfb\u627e\u5145\u8981\u6761\u4ef6\u3002\n\n\u628a\u62bd\u53d6\u51fa\u7684\u724c\u6392\u6210\u4e00\u4e2a\u5e8f\u5217\uff0c\u663e\u7136\uff0c\u6bcf\u79cd\u653e\u7f6e\u65b9\u5f0f\u90fd\u6070\u597d\u5bf9\u5e94\u4e00\u4e2a\u5e8f\u5217\u3002\uff08\u6784\u9020\u6620\u5c04\uff09\n\n\u4f46\u662f\uff0c\u7531\u4e8e\u53ef\u80fd\u62ff\u4e0d\u5b8c\u724c\uff0c\u6240\u4ee5\u4e00\u4e2a\u5e8f\u5217\u53ef\u80fd\u5bf9\u5e94\u5f88\u591a\u79cd\u65b9\u6848\uff0c\u5177\u4f53\u5730\uff0c\u4e00\u4e2a\u957f\u4e3a $m$ \u7684\u5e8f\u5217\u5bf9\u5e94 $3^{n_1+n_2+n_3-m}$ \u79cd\u65b9\u6848\u3002\uff08\u68c0\u67e5\u53cd\u6620\u5c04\uff09\n\n\u6211\u4eec\u601d\u8003\u5bf9\u8fd9\u4e2a\u5e8f\u5217\u7684\u7ea6\u675f\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u9664\u4e86\u7387\u5148\u5c06\u5806 $1$ \u62ff\u7a7a\u4e4b\u5916\uff0c\u6ca1\u6709\u4efb\u4f55\u7ea6\u675f\u3002\uff08\u68c0\u67e5\u5145\u8981\u6761\u4ef6\uff09\n\n\u4e8e\u662f\uff0c\u95ee\u9898\u5c31\u53d8\u6210\u4e86 \uff1a \u5bf9\u6bcf\u4e2a\u957f\u5ea6\uff0c\u6c42\u5148\u5c06\u5806 $1$ \u62ff\u7a7a\u7684\u5e8f\u5217\u4e2a\u6570\u3002\n\n\u663e\u7136\uff0c\u64cd\u4f5c\u5e8f\u5217\u4e2d\u4e00\u5b9a\u6070\u6709 $n_1$ \u4e2a $1$ \uff0c\u4e14\u6700\u540e\u4e00\u4e2a\u5fc5\u987b\u662f $1$\u3002\n\n\u679a\u4e3e\u62bd\u51fa\u7684\u975e $1$ \u724c\u4e2a\u6570 $k$ \uff0c\u65b9\u6848\u6570\u4e3a $\\dbinom{k+n_1-1}{k}\\sum\\limits_{i=0}^k[i\\leq n_2][k-i\\leq n_3]\\dbinom{k}{i}$\n\n\u89e3\u91ca\u4e00\u4e0b\uff0c$\\binom{k+n_1-1}{k}$ \u8868\u793a $n_1-1$ \u4e2a\u81ea\u7531\u7684 $1$ \u4e0e\u975e $1$ \u6df7\u5408\u7684\u65b9\u6848\u6570\uff0c\u540e\u9762\u7684\u6c42\u548c\u662f\u74dc\u5206\u975e $1$ \u724c\u7684\u65b9\u6848\u6570\u3002\n\n\u4f46\u7cdf\u7cd5\u7684\u662f\uff0c\u540e\u534a\u90e8\u5206\u662f\u4e00\u4e2a\u7ec4\u5408\u6570\u90e8\u5206\u548c\uff0c\u8fd9\u4f3c\u4e4e\u6ca1\u6709\u4ec0\u4e48\u5feb\u901f\u7684\u65b9\u6cd5\u5206\u522b\u6c42\u89e3\uff0c\u8003\u8651\u9012\u63a8\u3002\n\n$S(k)=\\sum\\limits_{i=0}^k[i\\leq n_2][k-i\\leq n_3]\\dbinom{k}{i}$\n\n$=\\sum\\limits_{k-n_3\\leq i\\leq n_2}\\dbinom{k}{i}$\n\n\u5c06\u7ec4\u5408\u6570\u88c2\u5f00 ;\n\n$=\\sum\\limits_{k-n_3\\leq i\\leq n_2}\\dbinom{k-1}{i}+\\dbinom{k-1}{i-1}$\n\n$=\\sum\\limits_{k-n_3\\leq i\\leq n_2}\\dbinom{k-1}{i}+\\sum\\limits_{k-n_3-1\\leq i\\leq n_2-1}\\dbinom{k-1}{i}$\n\n$=2S(k-1)-\\dbinom{k-1}{k-n_3-1}-\\dbinom{k-1}{n_2}$\n\n\u6ce8\u610f\u7ec4\u5408\u6570\u53ef\u80fd\u4e0d\u5408\u6cd5\uff0c\u6b64\u65f6\u503c\u4e3a $0$\u3002\n\n\u6c42\u51fa\u5404\u4e2a $S(k)$ \u4e4b\u540e\uff0c\u7b54\u6848\u5373\u4e3a\u4e0b\u5f0f \uff1a\n\n$$\\sum\\limits_{k=0}^{n_2+n_3}3^{n_1+n_2+n_3-k}\\dbinom{n_1-1+k}{k}S(k)$$\n\n\u4e0d\u770b\u9898\u89e3\u73a9\u51fa\u6765\u8fd8\u662f\u6709\u70b9\u5c0f\u6fc0\u52a8\u7684\u2026\u2026\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#define ll long long\n#define MaxN 900500\nusing namespace std;\nconst int mod=1000000007;\nll powM(ll a,int t=mod-2){\n  ll ret=1;\n  while(t){\n    if (t&1)ret=ret*a%mod;\n    a=a*a%mod;t>>=1;\n  }return ret;\n}\nll fac[MaxN],ifac[MaxN];\nll C(int n,int m){\n  if (m<0||n<m)return 0;\n  return fac[n]*ifac[m]%mod*ifac[n-m]%mod;\n}\nvoid Init(int n)\n{\n  fac[0]=1;\n  for (int i=1;i<=n;i++)\n    fac[i]=fac[i-1]*i%mod;\n  ifac[n]=powM(fac[n]);\n  for (int i=n;i;i--)\n    ifac[i-1]=ifac[i]*i%mod;\n}\nvoid preS(int n2,int n3,ll *S)\n{\n  S[0]=1;\n  for (int k=1;k<=n2+n3;k++)\n    S[k]=(2*S[k-1]-C(k-1,k-1-n3)-C(k-1,n2))%mod;\n    \n}\nint n1,n2,n3,N;\nll S[MaxN],pw3[MaxN];\nint main()\n{\n  scanf(\"%d%d%d\",&n1,&n2,&n3);\n  Init(N=n1+n2+n3);\n  preS(n2,n3,S);\n  ll ans=0,buf=powM(3,N-n1),sav=powM(3);\n  for (int k=0;k<=n2+n3;k++){\n    ans=(ans+buf*C(n1+k-1,k)%mod*S[k])%mod;\n    buf=buf*sav%mod;\n  }printf(\"%lld\",(ans+mod)%mod);\n  return 0;\n}\n```\n\n\n",
        "postTime": 1610407823,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 AT2070 \u3010[ARC061D] 3\u4eba\u3067\u30ab\u30fc\u30c9\u30b2\u30fc\u30e0 / Card Game for Three\u3011"
    },
    {
        "content": "\u8003\u8651\u8fdb\u884c\u8fd9\u6837\u4e00\u4e2a\u53cc\u5c04\uff1a\u6784\u9020\u4e00\u4e2a\u5e8f\u5217\uff0c\u5f53\u6e38\u620f\u8fd8\u5728\u8fdb\u884c\u65f6\uff0c\u6211\u4eec\u6bcf\u6b21\u5c06\u5f53\u6b21\u5904\u4e8e\u81ea\u5df1\u7684\u56de\u5408\u7684\u4eba\u5806\u9876\u7684\u5361\u724c\u653e\u5728\u5e8f\u5217\u6700\u540e\u3002\u5f53\u6e38\u620f\u7ed3\u675f\u540e\uff0c\u6211\u4eec\u6309\u7167 a b c \u7684\u987a\u5e8f\u4ece\u5806\u9876\u5230\u5806\u5e95\u5c06\u5361\u724c\u4f9d\u6b21\u653e\u5728\u5e8f\u5217\u6700\u540e\uff0c\u4e0d\u96be\u53d1\u73b0\u8fd9\u6837\u4e0e\u539f\u5e8f\u5217\u4e09\u5806\u5361\u724c\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u3002  \n\u5728\u8fd9\u4e2a\u65b0\u5e8f\u5217\uff08\u6211\u4eec\u79f0\u4e4b\u4e3a $p$\uff09\u4e2d\uff0ca \u7684\u80dc\u5229\u6761\u4ef6\u53d8\u6210\u4e00\u4e2a\u524d\u7f00\u51fa\u73b0 $n$ \u5f20 a\uff0cb \u7684\u80dc\u5229\u6761\u4ef6\u4e3a\u4e00\u4e2a\u524d\u7f00\u51fa\u73b0 $m+1$ \u5f20 b,c \u548c b \u540c\u7406\u3002\u591a\u4e2a\u80dc\u5229\u6761\u4ef6\u5728 $p$ \u4e2d\u540c\u65f6\u6ee1\u8db3\u65f6\u8c01\u524d\u7f00\u8d8a\u9760\u524d\u8c01\u8d62\u5f97\u771f\u6b63\u7684\u80dc\u5229\u3002\u8003\u8651\u5bf9\u8fd9\u4e2a\u5e8f\u5217\u8fdb\u884c\u8ba1\u6570\u3002  \n\u6211\u4eec\u9996\u5148\u679a\u4e3e a \u7b2c $n$ \u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u8bbe\u5176\u4e3a $i$\u3002\u90a3\u4e48\u5728 $p_1\\sim p_{i-1}$ \u4e2d\uff0c\u51fa\u73b0\u4e86 $n-1$ \u6b21 a\uff0c\u65b9\u6848\u6570 $\\binom{i-1}{n-1}$\u3002$p_{i+1}\\sim p_{n+m+k}$ \u53ef\u4ee5\u4efb\u610f\u653e\u6570\uff0c\u65b9\u6848\u6570 $3^{n+m+k-i}$\u3002\u8003\u8651\u5728 $p_1\\sim p_{i-1}$ \u6240\u5269\u4e0b\u7684 $i-n$ \u4e2a\u653e b \u548c c \u7684\u4f4d\u7f6e\u3002  \n\u8bbe\u7b2c\u653e $i$ \u4e2a b \u548c c \u4f7f\u5b83\u4eec\u4e0d\u4f1a\u63d0\u524d\u80dc\u5229\u7684\u65b9\u6848\u6570\u4e3a $f_i$\uff0c\u8003\u8651\u5bb9\u65a5\u3002\u6211\u4eec\u5148\u5728 $f_{i-1}$ \u7684\u57fa\u7840\u4e0a\u968f\u4fbf\u653e b \u6216 c\uff0c\u65b9\u6848\u6570 $2f_{i-1}$\u3002\u8003\u8651\u5728 $i$ \u4f4d\u975e\u6cd5\u60c5\u51b5\u5373\u4e3a\u5230\u7b2c $i$ \u4f4d\u6070\u597d\u653e\u4e86 $m+1$ \u4e2a b \u6216 $k+1$ \u4e2a c\uff0c\u800c\u8fd9\u4e24\u4e2a\u6761\u4ef6\u4e0d\u80fd\u540c\u65f6\u6ee1\u8db3\u3002\u4e8e\u662f\u6211\u4eec\u94a6\u5b9a\u7b2c $i$ \u4f4d\u653e b\uff0c\u524d\u9762 $i-1$ \u4f4d\u518d\u653e $m$ \u4e2a b \u5373\u53ef\u4e0d\u5408\u6cd5\uff0cc \u540c\u7406\u3002\u4e8e\u662f $f$ \u7684\u8f6c\u79fb\u5f0f $f_i=2f_{i-1}-\\binom{i-1}{m}-\\binom{i-1}{k}$\u3002  \n\u6709\u4e86 $f$\uff0ca \u7b2c $n$ \u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u4e3a $i$ \u7684\u7b54\u6848\u5373\u4e3a $3^{n+m+k-i}f_{i-n}\\binom{i-1}{n-1}$\uff0c\u6c42\u548c\u5373\u53ef\u3002  \n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+m+k)$\u3002\u4ee3\u7801\u4e2d\u7528\u7c7b\u4f3c\u6eda\u52a8\u53d8\u91cf\u7684\u65b9\u5f0f\u9012\u63a8 $f$\u3002  \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int maxn=1e6+5,mod=1e9+7;\nll fac[maxn],inv[maxn],ans,pw3[maxn];\nint n,m,k;\nll qpow(ll x,int y)\n{\n\tll w=1;\n\twhile(y)\n\t{\n\t\tif(y&1)w=w*x%mod;\n\t\tx=x*x%mod,y>>=1;\n\t}\n\treturn w;\n}\nll C(int x,int y)\n{\n\tif(y>x||y<0)return 0;\n\treturn fac[x]*inv[x-y]%mod*inv[y]%mod;\n}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&k),fac[0]=pw3[0]=1;\n\tfor(int i=1;i<maxn;i++)fac[i]=fac[i-1]*i%mod,pw3[i]=pw3[i-1]*3%mod;\n\tinv[maxn-1]=qpow(fac[maxn-1],mod-2);\n\tfor(int i=maxn-1;i;i--)inv[i-1]=inv[i]*i%mod;\n\tll sum=1;\n\tfor(int i=n;i<=n+m+k;i++)ans=(ans+C(i-1,n-1)*sum%mod*pw3[n+m+k-i])%mod,sum=(sum*2-C(i-n,m)-C(i-n,k)+mod*2)%mod;\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1659961672,
        "uid": 104324,
        "name": "abruce",
        "ccfLevel": 7,
        "title": "\u9898\u89e3--[ARC061D] 3\u4eba\u3067\u30ab\u30fc\u30c9\u30b2\u30fc\u30e0 / Card Game for Three"
    },
    {
        "content": "**\u9898\u610f\uff1a**\n\n\u7ed9\u5b9a $a,b,c$ \u8868\u793a A \u6709 $a$ \u5f20\u724c\u4f9d\u6b21\u6392\u5217\uff0cB \u6709 $b$ \u5f20\u724c\u4f9d\u6b21\u6392\u5217\uff0cC \u6709 $c$ \u5f20\u724c\u4f9d\u6b21\u6392\u5217\uff0c\u6bcf\u5f20\u724c\u53ef\u4ee5\u662f A\uff0cB\uff0cC \u4e2d\u4efb\u610f\u4e00\u79cd\u3002\n\nA \u5148\u64cd\u4f5c\uff0c\u62ff\u51fa\u7b2c\u4e00\u5f20\u724c\uff0c\u7136\u540e\u8ba9\u4e0a\u9762\u5199\u7684\u4eba\u91cd\u590d\u6b64\u6d41\u7a0b\uff0c\u8c01\u6700\u5148\u64cd\u4f5c\u5b8c\u8c01 win\n\n\u6c42\u65b9\u6848\u6570\u4f7f\u5f97 A win\n\n- $a,b,c\\le 3\\cdot 10^5$\u3002\n\n---\n\n$\\rm Sol:$\n\n\u9996\u5148\u8003\u8651\u8fd9\u6837\u7684\u4e00\u4ef6\u4e8b\uff0c\u5047\u8bbe A \u64cd\u4f5c\u5b8c\u540e\u4f9d\u6b21\u53d6\u51fa\u6765\u7684\u5b57\u7b26\u662f AABCAABC \u90a3\u4e48\u5176\u5b9e\u5b83\u56fa\u5b9a\u4e86\u4e00\u4e2a\u53d6\u724c\u987a\u5e8f\u3002\n\n\u540c\u65f6\u4efb\u610f\u4e00\u4e2a\u8fd9\u6837\u7684\u5e8f\u5217\u90fd\u53ef\u4ee5\u5bf9\u5e94\u4e00\u4e2a\u53d6\u724c\u987a\u5e8f\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0 B win \u7b49\u4ef7\u4e8e\u53d6\u51fa\u4e86 $b+1$ \u4e2a B\uff0c\u540c\u7406\u4e8e C\uff0c\u800c A win \u5219\u7b49\u4ef7\u4e8e\u53d6\u51fa\u4e86 $a$ \u4e2a A\n\n\u6240\u4ee5\u6211\u4eec\u679a\u4e3e\u5176\u957f\u5ea6\uff0c\u89c4\u5b9a\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\u4e3a A\uff0c\u90a3\u4e48\u5269\u4f59\u4f4d\u7f6e\u4e2d\u81f3\u591a\u586b\u5165 $b$ \u4e2a B\uff0c$c$ \u4e2a C\uff0c$a$ \u4e2a A\uff0c\u65b9\u4fbf\u8d77\u89c1\u6211\u4eec\u4ee4 $N=a-1+b+c$\uff0c\u7136\u540e\u4ee4 $a$ \u51cf $1$\n\n\u4e8e\u662f\u6240\u6c42\u4e3a\uff1a\n\n$$\\sum_{i=a}^{N} \\binom{i}{a}\\cdot 3^{N-i}\\sum_{j+k=i-a,j\\le b,k\\le c} \\binom{i-a}{j}$$\n\n\u540e\u9762\u7684\u6761\u4ef6 $k\\le c$ \u7b49\u4ef7\u4e8e $i-a-c\\le j\\le b$\n\n\u4e8e\u662f\u6240\u6c42\u4e3a\uff1a\n\n$$\\sum_{i=a}^{N} \\binom{i}{a}\\cdot 3^{N-i-1}\\sum_{\\max\\{0,i-a-c\\}\\le j\\le b} \\binom{i-a}{j}$$\n\n\u6211\u4eec\u53d1\u73b0\u540e\u9762\u51fa\u73b0\u4e86\u4e00\u4e2a\u4f17\u6240\u5468\u77e5\u96be\u4ee5\u5316\u7b80\u7684\u5f0f\u5b50\uff0c\u4e8e\u662f\u8003\u8651\u9012\u63a8\u3002\n\n\u6211\u4eec\u8bbe $x=i-a$\uff0c\u90a3\u4e48\u5982\u679c $i\\le c$ \u5219\u6240\u6c42\u4e3a $\\sum^b \\binom{i-a}{j}$\n\n- \u5982\u679c $i\\le c,b$\uff0c\u90a3\u4e48\u5176\u5b9e\u5c31\u662f $2^{i-a}$\n\n- \u5426\u5219 $b<i\\le c$\uff0c\u8fd9\u4e2a\u65f6\u5019\u8003\u8651\u76f8\u90bb\u4e24\u9879\u7684\u53d8\u6362\u91cf\u3002\n\n\u5373\u8003\u8651 $\\sum^b_j \\binom{x}{j}$ \u4e0e $\\sum_j^b \\binom{x+1}{j}$\uff0c\u524d\u8005\u8bbe\u4e3a $f$\uff0c\u540e\u8005\u8bbe\u4e3a $g$\uff0c\u90a3\u4e48\u6709 $\\sum \\binom{x+1}{j}=\\sum \\Big(\\binom{x}{j-1}+\\binom{x}{j}\\Big)$\n\n\u6240\u4ee5\u6211\u4eec\u5f97\u5230\uff1a$g=\\sum^b \\binom{x}{j}+\\sum^{b-1}\\binom{x}{j}=2f-\\binom{x}{b}$\n\n- \u82e5 $c<i\\le b$\uff0c\u8fd9\u4e2a\u65f6\u5019\u6709 $f=\\sum_{l}^x \\binom{x}{j},g=\\sum_{l+1}^{x+1} \\binom{x+1}{j}=\\sum_{l+1}^{x+1}\\Big(\\binom{x}{j}+\\binom{x}{j-1}\\Big)=2f+\\binom{x}{x+1}-\\binom{x}{l}$\n\n\u7136\u540e\u8003\u8651 $M<i$\n\n\u6b64\u65f6\u6709\uff1a$f=\\sum_{l}^b \\binom{x}{j},g=\\sum_{l+1}^b \\binom{x+1}{j},g=\\sum^b_{l+1} (\\binom{x}{j}+\\binom{x}{j-1})=2f-\\binom{x}{l}-\\binom{x}{b}$\n\n\u5982\u679c\u5728\u5904\u7406\u7ec4\u5408\u6570\u7684\u9012\u63a8\u7684\u65f6\u5019\u7279\u5224\u4e86\u8d1f\u6570\u7ec4\u5408\u6570\u4ee5\u53ca\u5927\u4e8e\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u76f4\u63a5\u4f7f\u7528\u6700\u540e\u4e00\u4e2a\u5f0f\u5b50\u9012\u63a8\u5c31\u53ef\u4ee5\u4e86\u3002\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ;\n#define Next( i, x ) for( register int i = head[x]; i; i = e[i].next )\n#define rep( i, s, t ) for( register int i = (s); i <= (t); ++ i )\n#define drep( i, s, t ) for( register int i = (t); i >= (s); -- i )\n#define re register\n#define int long long\nint gi() {\n\tchar cc = getchar() ; int cn = 0, flus = 1 ;\n\twhile( cc < '0' || cc > '9' ) {  if( cc == '-' ) flus = - flus ; cc = getchar() ; }\n\twhile( cc >= '0' && cc <= '9' )  cn = cn * 10 + cc - '0', cc = getchar() ;\n\treturn cn * flus ;\n}\nconst int N = 1e6 + 5 ; \nconst int P = 1e9 + 7 ; \nint a, b, c, n, m, Ans, fac[N], inv[N] ; \nint fpow( int x, int k ) {\n\tint ans = 1, base = x ;\n\twhile(k) {\n\t\tif( k & 1 ) ans = ans * base % P ; \n\t\tbase = base * base % P, k >>= 1 ; \n\t} return ans % P ; \n}\nint C( int x, int y ) {\n\tif( y > x || x < 0 || y < 0 ) return 0 ; \n\treturn fac[x] * inv[y] % P * inv[x - y] % P ; \n}\nsigned main()\n{\n\ta = gi(), b = gi(), c = gi() ; \n\tn = a + b + c, fac[0] = inv[0] = 1 ; \n\trep( i, 1, n ) fac[i] = fac[i - 1] * i % P, inv[i] = fpow( fac[i], P - 2 ) ;\n\tint f = 1, l = - c ; -- a ; \n\tfor( re int i = a; i < n; ++ i ) {\n\t\tint x = i - a ; \n\t\tif( l > b ) break ; \n\t\tAns = ( Ans + f * C( i, a ) % P * fpow( 3, n - i - 1 ) % P ) % P ;\n\t\tf = ( f * 2 + P - C( x, b ) + P - C( x, l ) ) % P, ++ l ; \n\t}\n\tprintf(\"%lld\\n\", Ans % P ) ;\n\treturn 0 ;\n}\n```",
        "postTime": 1592372523,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 AT2070 \u3010[ARC061D] 3\u4eba\u3067\u30ab\u30fc\u30c9\u30b2\u30fc\u30e0 / Card Game for Three\u3011"
    },
    {
        "content": "- \u60ed\u6127\uff0c\u60ed\u6127\u3002\n\n**[\u9898\u610f](https://www.luogu.com.cn/problem/AT2070)**\n- \u6709\u4e09\u5806\u724c\uff0c\u5148\u53d6\u7b2c\u4e00\u5806\u5806\u9876\u7684\u724c\uff0c\u63a5\u4e0b\u6765\u724c\u4e0a\u5199\u51e0\u5c31\u62bd\u7b2c\u51e0\u5806\u5806\u9876\u3002\n- \u95ee\u724c\u5806 $1$ \u5148\u88ab\u62bd\u7a7a\u7684\u65b9\u6848\u6570\u3002\n\n**\u5206\u6790**\n- \u8003\u8651\u4ec0\u4e48\u6837\u7684\u64cd\u4f5c\u5e8f\u5217\u53ef\u4ee5\u5bfc\u81f4 $1$ \u88ab\u7387\u5148\u62bd\u7a7a\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u5e8f\u5217\u5fc5\u987b\u6ee1\u8db3\uff1a\u6709 $n_1$ \u4e2a $1$\uff0c\u7ed3\u5c3e\u662f $1$\uff0c$2$ \u7684\u4e2a\u6570\u4e0d\u8d85\u8fc7 $n_2$\uff0c$3$ \u7684\u4e2a\u6570\u4e0d\u8d85\u8fc7 $n_3$\u3002\n- \u6bcf\u4e2a\u64cd\u4f5c\u5e8f\u5217\u53ef\u80fd\u5bf9\u5e94\u591a\u4e2a\u6392\u5806\uff0c\u5177\u4f53\u5730\uff0c\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u64cd\u4f5c\u5e8f\u5217\u5bf9\u5e94 $3^{n_1+n_2+n_3-n}$ \u4e2a\u724c\u5806\u3002\n- \u73b0\u5728\u6211\u4eec\u7684\u4efb\u52a1\u53d8\u6210\u4e86\u8003\u8651\u8ba1\u7b97\u5bf9\u4e8e\u6bcf\u4e2a $n$\uff0c\u957f\u5ea6\u4e3a $n$ \u7684\u5408\u6cd5\u64cd\u4f5c\u5e8f\u5217\u4e2a\u6570\uff0c\u4e0d\u8bba\u5982\u4f55\uff0c\u6211\u4eec\u90fd\u6709\u7b80\u5355\u7684 $O(n^2)$ \u505a\u6cd5\u662f\u663e\u7136\u7684\uff0c[\u4ee3\u7801](https://www.luogu.com.cn/paste/ngvcrxeg)\u3002\n- \u6211\u4eec\u8003\u8651\u628a\u95ee\u9898\u5177\u4f53\u5316\uff0c\u6211\u4eec\u9700\u8981\u6c42\u89e3\uff08\u7531\u4e8e\u7ed3\u5c3e\u662f $1$\uff0c\u6240\u4ee5\u6570\u76ee\u8981\u51cf\u4e00\uff09\uff1a\n$$f(n)=\\sum_{i=0}^{n_2}[n_1+i+n_3\\ge n]\\frac{(n-1)!}{(n_1-1)!i!(n-n_1-i)!}$$\n- ~~\u6211\u4eec\u53d1\u73b0\u8fd9\u53ef\u4ee5\u8868\u793a\u6210\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u76f4\u63a5 MTT~~\uff0c\u522b\u60f3\u4e86\u4f5c\u8005\u4e0d\u4f1a\u591a\u9879\u5f0f\uff0c\u4f60\u53d1\u73b0\uff1a\n$$f(n)=C(n-1,n_1-1)\\sum_{i=\\max(n-n_1-n_3,0)}^{n_2}C(n-n_1,i)$$\n- \u8bbe\uff1a\n$$g(n,m)=\\sum_{i=0}^mC(n,i)$$\n- \u7531\u4e8e $C(n,m)=C(n-1,m)+C(n-1,m-1)$\uff0c\u88c2\u9879\u53ef\u5f97\uff1a\n$$g(n,m)=\\sum_{i=0}^mC(n,i)=\\sum_{i=0}^{m-1}C(n-1,i)+\\sum_{i=0}^{m}C(n-1,i)=2\\sum_{i=0}^{m-1}C(n-1,i)+C(n-1,m)$$\n$$g(n,m)=2g(n-1,m-1)+C(n-1,m)$$\n- \u540c\u7406\uff1a\n$$g(n,m)=2g(n-1,m)-C(n-1,m)$$\n- \u5229\u7528\u8fd9\u4e24\u4e2a\u7b80\u5355\u7684\u9012\u63a8\u5173\u7cfb\uff0c\u6211\u4eec\u6700\u7ec8\u53ef\u4ee5\u7ebf\u6027\u6c42\u89e3 $f(n)$ \u7684\u6240\u6709\u53d6\u503c\u3002\n- \u5bf9\u4e8e\u4e00\u7c7b\u8f83\u4e3a\u590d\u6742\u7684\u8ba1\u6570\u95ee\u9898\uff0c\u4e5f\u8bb8\u53ef\u4ee5\u5c1d\u8bd5\u8fd9\u79cd\u601d\u8def\uff1a\u5373\u627e\u5230\u4e00\u7c7b\u6620\u5c04\uff0c\u5b83\u6bd4\u8f83\u597d\u8ba1\u6570\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7279\u5b9a\u7684\u6620\u5c04\u5bf9\u5e94\u7684\u7ec4\u5408\u5bf9\u8c61\uff0c\u4e5f\u6bd4\u8f83\u597d\u8ba1\u6570\uff0c\u5982\u6b64\u5c31\u6709\u53ef\u80fd\u5bf9\u590d\u6742\u7684\u95ee\u9898\u5316\u7e41\u4e3a\u7b80\uff0c[\u4ee3\u7801](https://www.luogu.com.cn/paste/8wpf05sw)\u3002",
        "postTime": 1664247567,
        "uid": 260884,
        "name": "WeLikeStudying",
        "ccfLevel": 0,
        "title": "[ARC061D] 3\u4eba\u3067\u30ab\u30fc\u30c9\u30b2\u30fc\u30e0 / Card Game for Three"
    },
    {
        "content": "orz qyc\n\n> \u5c0f A\uff0c\u5c0f B\uff0c\u5c0f C \u5728\u73a9\u6e38\u620f\u3002\u4ed6\u4eec\u6bcf\u4e2a\u4eba\u5206\u522b\u6709 $n,m,k$ \u5f20\u724c\uff0c\u6bcf\u5f20\u724c\u4e0a\u9762\u5199\u7740 $a,b,c$ \u4e09\u4e2a\u5b57\u6bcd\u4e2d\u7684\u5176\u4e2d\u4e00\u4e2a\uff0c\u6bcf\u4e2a\u56de\u5408\u6709\u4e00\u4e2a\u4eba\u51fa\u724c\uff0c\u5982\u679c\u51fa\u724c\u4e3a $a$ \u5219\u5c0f A \u4e0b\u4e00\u4e2a\u56de\u5408\u51fa\u724c\uff0c\u5982\u679c\u51fa\u724c\u4e3a $b$ \u5219\u5c0f B \u4e0b\u4e00\u4e2a\u56de\u5408\u51fa\u724c\uff0c\u5c0f C \u540c\u7406\u3002\u82e5\u8f6e\u5230\u67d0\u4f4d\u73a9\u5bb6\u51fa\u724c\u65f6\uff0c\u5176\u624b\u4e2d\u65e0\u724c\uff0c\u5219\u8be5\u4f4d\u73a9\u5bb6\u83b7\u80dc\u3002\n>\n> \u73b0\u5728\u5c0f A \u7b2c\u4e00\u4e2a\u51fa\u724c\uff0c\u5bf9\u6240\u6709 $3^{n+m+k}$ \u79cd\u624b\u724c\u62e5\u6709\u7684\u53ef\u80fd\u6027\u8ba1\u7b97\u5c0f A \u83b7\u80dc\u7684\u65b9\u6848\u6570\uff0c\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n\u5982\u679c\u6309\u7167\u6253\u51fa\u7684\u987a\u5e8f\u6392\u6210\u4e00\u4e2a\u957f\u5ea6\u4e3a $l$ \u7684\u5e8f\u5217\uff0c\u5c0f A \u83b7\u80dc\u5f53\u4e14\u4ec5\u5f53\uff1a$a$ \u6070\u597d\u51fa\u73b0\u4e86 $n$ \u6b21\u4e14\u5728\u6700\u540e\u4e00\u6b21\u51fa\u73b0\uff0c$b$ \u51fa\u73b0\u4e86\u4e0d\u591a\u4e8e $m$ \u6b21\uff0c$c$ \u51fa\u73b0\u4e86\u4e0d\u591a\u4e8e $k$ \u6b21\u3002\n\n\u800c\u8fd9\u4e2a\u957f\u5ea6\u4e3a $l$ \u7684\u5e8f\u5217\u5bf9\u5e94\u4e86 $3^{n+m+k-l}$ \u79cd\u624b\u724c\u62e5\u6709\u7684\u60c5\u51b5\u3002\n\n$n$ \u6b21\u662f\u4e00\u5b9a\u6253\u7684\uff0c\u679a\u4e3e $b,c$ \u51fa\u73b0\u7684\u6b21\u6570 $t$\uff0c\u7136\u540e\u679a\u4e3e $b$ \u51fa\u73b0\u7684\u6b21\u6570 $i$\uff1a\n$$\n\\sum_{t=0}^{m+k}\\binom{n+t-1}{n-1}3^{m+k-t}\\sum_{i=t-k}^{m}\\binom{t}{i}\n$$\n\u7b2c\u4e00\u4e2a\u7ec4\u5408\u6570\u662f\u9664\u4e86\u6700\u540e\u4e00\u4e2a\u662f $a$\uff0c\u786e\u5b9a $(n-1)$ \u4e2a $a$ \u7684\u4f4d\u7f6e\uff0c$3^{m+k-t}$ \u662f\u8ba1\u7b97\u7684\u5bf9\u5e94\u4e86\u591a\u5c11\u79cd\u624b\u724c\u62e5\u6709\u60c5\u51b5\uff0c\u6700\u540e\u4e00\u4e2a\u7ec4\u5408\u6570\u4e3a\u5728 $t$ \u4e2a $b,c$ \u90fd\u53ef\u4ee5\u586b\u7684\u7a7a\u4f4d\u6311\u51fa $i$ \u4e2a\u586b $b$\uff0c\u6ce8\u610f\u8fd9\u4e2a\u7ec4\u5408\u6570\u53ef\u80fd\u4f1a\u51fa\u73b0 $i<0$ \u6216 $i>t$ \u7684\u60c5\u51b5\uff0c\u7531\u4e8e\u662f\u8003\u8651\u5176\u5b9e\u9645\u7684\u7ec4\u5408\u610f\u4e49\uff0c\u6240\u4ee5\u5f53\u51fa\u73b0\u8fd9\u6837\u7684\u60c5\u51b5\u65f6\u89c6\u4e3a $0$\uff0e\n\n\u6700\u540e\u4e00\u4e2a\u5b9e\u9645\u4e0a\u662f\u7ec4\u5408\u6570\u4e00\u884c\u7684\u533a\u95f4\u548c\uff0c~~\u4f17\u6240\u5468\u77e5~~\u8fd9\u4e2a\u7684\u8ba1\u7b97\u662f\u56f0\u96be\u7684\uff0c\u7531\u4e8e\u8fd9\u4e2a\u533a\u95f4\u548c\u7684\u5f62\u5f0f\u6bd4\u8f83\u7279\u6b8a\uff0c\u8003\u8651\u9012\u63a8\u51fa\u8fd9\u4e2a\u4e1c\u897f\uff1a\n$$\n\\begin{aligned}\nS(t)=&\\sum_{i=t-k}^{m}\\binom{t}{i}\n\\\\\n=&\\sum_{i=t-k}^{m}\\binom{t-1}{i-1}+\\sum_{i=t-k}^{m}\\binom{t-1}{i}\n\\\\\n=&\\sum_{i=t-k-1}^{m-1}\\binom{t-1}{i}+\\sum_{i=t-k}^{m}\\binom{t-1}{i}\n\\\\\n=&\\ 2\\cdot\\sum_{i=t-k-1}^{m}\\binom{t-1}{i}-\\binom{t-1}{m}-\\binom{t-1}{t-k-1}\n\\\\\n=&\\ 2\\cdot S(t-1)-\\binom{t-1}{m}-\\binom{t-1}{t-k-1}\n\\end{aligned}\n$$\n\u81f3\u6b64\uff0c\u53ef\u4ee5\u5728 $\\mathcal{O}(n+\\log \\bmod)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u89e3\u51b3\u95ee\u9898\u3002\n\n [Code](https://atcoder.jp/contests/arc061/submissions/25189343)",
        "postTime": 1629543650,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u300c\u9898\u89e3\u300dARC 061 F Card Game for Three"
    },
    {
        "content": "\u6765\u8003\u8651\u4e00\u4ef6\u4e8b\u60c5\n\n\u628a\u6253\u724c\u7684\u987a\u5e8f\u4e32\u8d77\u6765\uff0c\u8fd9\u80af\u5b9a\u662f\u4e00\u6761\u957f\u5ea6\u4e3a $N+M+K$ \u7684\u94fe\u3002\n\n\u7136\u540e\u76f8\u5f53\u4e8e\u662f\u5728\u8fd9\u4e2a\u5e8f\u5217\u4e0a\u9762\u586b\u6570\u3002$A$ \u80dc\u5229\u7684\u6761\u4ef6\u5c31\u662f\u6709\u4e00\u4e2a\u524d\u7f00\u6709 $n$ \u4e2a $a$\uff0c\u4e14 $b,c$ \u7684\u6570\u91cf\u5206\u522b\u4e0d\u8d85\u8fc7 $m,k$\u3002\u5e76\u4e14\u5bb9\u6613\u53d1\u73b0\u4e00\u4e2a\u5e8f\u5217\u80af\u5b9a\u53ea\u5bf9\u5e94\u4e00\u79cd\u724c\u5e8f\u3002\n\n\u7b2c\u4e00\u4ef6\u4e8b\u80af\u5b9a\u662f\u679a\u4e3e\u8fd9\u4e2a\u524d\u7f00\u3002\u5148\u7528\u7ec4\u5408\u6570\u628a $a$ \u585e\u8fdb\u53bb\u3002\u5047\u8bbe\u524d\u7f00\u7684\u957f\u5ea6\u662f $i$\uff0c\u90a3\u4e48\u8fd8\u5269\u4e0b $i-n$ \u4e2a\u4f4d\u7f6e\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u4e8c\u7ef4\u80cc\u5305\u3002\u4f46\u662f\u76f4\u63a5\u8ba1\u7b97\u6709\u70b9\u513f\u6162\uff0c\u8003\u8651\u7ec4\u5408\u6570\u3002\n\n\u4f1a\u5bc4\u6389\u53ea\u53ef\u80fd\u662f\u5176\u4e2d\u4e00\u4e2a\u51fa\u73b0\u4e86\u81f3\u5c11 $m+1$ \u6216 $k+1$ \u6b21\u3002\n$$\\sum_{x=m+1}^{i-n}\\binom{i-n}{x}+\\sum_{x=k+1}^{i-n}\\binom{i-n}{x}$$\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f\uff1a\n$$\\sum_{i=n}^{n+m+k}\\binom{i}{n}(2^{i-n}-\\sum_{x=m+1}^{i-n}\\binom{i-n}{x}-\\sum_{x=k+1}^{i-n}\\binom{i-n}{x})3^{n+m+k-i}$$\n\u6211\u4eec\u8bbe $f[x]=\\sum_{i=m}^{x}\\binom{x}{i}$\u3002\n\n\u8003\u8651\u8fd9\u4e2a\u4e1c\u897f\uff1a\n$$f[x]=\\sum_{i=m}^{x}\\binom{x-1}{i}+\\binom{x-1}{i-1}$$\n$$f[x]=f[x-1]+f[x-1]+\\binom{x-1}{m-1}$$\n\u7136\u540e\u5c31 $O(n+m+k)$ \u4e86\u3002\u3002\u3002\n```cpp\n#include<cstdio>\ntypedef unsigned ui;\nconst ui M=1e6,mod=1e9+7;\nui A,B,C,F[M],G[M],pw2[M],pw3[M],fac[M],ifac[M];\ninline ui binom(const ui&n,const ui&m){\n\treturn 1ull*ifac[m]*ifac[n-m]%mod*fac[n]%mod;\n}\nsigned main(){\n\tui ans(0);scanf(\"%u%u%u\",&A,&B,&C);\n\tpw2[0]=1;pw3[0]=1;fac[0]=1;ifac[0]=1;\n\tpw2[1]=2;pw3[1]=3;fac[1]=1;ifac[1]=1;\n\tfor(ui i=2;i<=A+B+C;++i){\n\t\tpw2[i]=2ull*pw2[i-1]%mod;pw3[i]=3ull*pw3[i-1]%mod;ifac[i]=1ull*(mod-mod/i)*ifac[mod%i]%mod;\n\t}\n\tfor(ui i=2;i<=A+B+C;++i)fac[i]=1ull*fac[i-1]*i%mod,ifac[i]=1ull*ifac[i-1]*ifac[i]%mod;\n\tfor(ui i=B+1;i<=A+B+C;++i)F[i]=(2ull*F[i-1]+binom(i-1,B))%mod;\n\tfor(ui i=C+1;i<=A+B+C;++i)G[i]=(2ull*G[i-1]+binom(i-1,C))%mod;\n\tfor(ui i=A;i<=A+B+C;++i)ans=(ans+1ull*binom(i-1,A-1)*(pw2[i-A]+mod-F[i-A]+mod-G[i-A])%mod*pw3[A+B+C-i])%mod;\n\tprintf(\"%u\",ans);\n}\n```",
        "postTime": 1651113351,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u6570 AT2070\u9898\u89e3"
    },
    {
        "content": "\u4e00\u53e0\u7eb8\u724c\u662f\u4e00\u6bb5\u4ec5\u7531 $M, N, K$ \u7ec4\u6210\u7684\u5b57\u7b26\u4e32, \u7b2c $i$ \u4e2a\u5b57\u7b26\u4ee3\u8868\u7b2c $i$ \u4e2a\u56de\u5408\u6253\u51fa\u7684\u724c\u4e0a\u5199\u7684\u5b57\u7b26\u3002\n\n\u53d1\u73b0\u6bcf\u4e00\u79cd\u8ba9 $a$ \u80dc\u5229\u7684\u65b9\u6848\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u5fc5\u7136\u662f $A$\uff0c\u4e14\u5b57\u7b26\u4e32\u4e2d $A$ \u6709 $n$ \u4e2a\uff0c$B$ \u6709 $x(x<m)$ \u4e2a\uff0c$C$ \u6709 $y(y<k)$ \u4e2a\uff0c\u5b57\u7b26\u4e32\u4e2d\u957f\u5ea6\u4e3a\u662f $n+x+y$\u3002\n\n\u5bf9\u5e94\u7684\u5b57\u7b26\u4e32\u603b\u6570\u4e3a\uff1a\n\n$$\\binom{n+x+y-1}{n-1}\\binom{x+y}{x}3^{m+k-x-y}$$\n\n\u8868\u793a\u6700\u540e\u4e00\u4f4d\u5fc5\u987b\u9009 $A$\uff0c\u5176\u4ed6\u7684\u968f\u4fbf\u6392\uff0c\u7136\u540e $B$ \u5269\u4e0b\u7684 $m-x$ \u5f20\u724c\u548c $C$ \u5269\u4e0b\u7684 $k-y$ \u5f20\u724c\u968f\u4fbf\u9009\u3002\n\n\u4e0d\u59a8\u8bbe $x+y=t$\uff0c\u5219\u6709\uff1a\n\n$$\\begin{aligned} ans &= \\sum_{t=0}^{m+k}\\binom{n+t-1}{n-1}3^{m+k-t}\\sum_{x=t-k}^{m}\\binom{t}{x} \\end{aligned}$$\n\n\u8bbe $f[t] = \\sum_{x=t-k}^{m}\\binom{t}{x}$\uff0c\u5219\u6709\uff1a\n\n$$\\begin{aligned} f[t]&=\\sum_{x=t-k}^{m}\\binom{t}{x} \\\\&=\\sum_{x=t-k}^{m}(\\binom{t-1}{x}+\\binom{t-1}{x-1})\\\\\n&=\\sum_{x=t-k}^{m}\\binom{t-1}{x}+\\sum_{y=(t-1)-k}^{m-1}\\binom{t-1}{y}\\\\\\\\ &=\\sum_{x=(t-1)-k}^m\\binom{t-1}{x}-\\binom{t-1}{t-1-k}+\\sum_{y=(t-1)-k}^{m}\\binom{t-1}{y}-\\binom{t-1}{m}\\\\ &=2f[t-1]-\\binom{t-1}{t-1-k}-\\binom{t-1}{m} \\end{aligned}$$\n\n\u9012\u63a8\u540e\u6c42\u89e3\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define mod 1000000007\n#define ll long long\nll jc[1000010],ny[1000010],sm[1000010];\nll qpow(ll a,ll b){\n    if(b==0) return 1ll;\n    ll tmp=qpow(a,b/2);\n    ll res=tmp*tmp%mod;\n    if(b%2==1) res=res*a%mod;\n    return res;\n}\nvoid init(){\n    jc[0]=1; sm[0]=1;\n\tfor(int i=1;i<=1000000;++i){\n        jc[i]=i*jc[i-1]%mod;\n        sm[i]=3*sm[i-1]%mod;\n\t}\n\tny[1000000]=qpow(jc[1000000],mod-2);\n\tfor(int i=1000000-1;i>=0;--i)\n        ny[i]=ny[i+1]*(i+1)%mod;\n}\nll C(int n,int m){\n    if(m<0||n<m) return 0;\n    return jc[n]*ny[m]%mod*ny[n-m]%mod;\n}\nll f[1000010];\nint main(){\n    init();\n    int n,m,k;\n    scanf(\"%d%d%d\",&n,&m,&k);\n    f[0]=1;\n    for(int i=1;i<=m+k;++i){\n        f[i]=f[i-1]*2%mod;\n        f[i]=f[i]+mod-(C(i-1,i-1-k)+C(i-1,m))%mod;\n        f[i]%=mod;\n    }\n    ll ans=0;\n    for(int i=0;i<=m+k;++i){\n        ans+=C(n+i-1,n-1)*sm[m+k-i]%mod*f[i]%mod;\n        ans%=mod;\n    }\n    printf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1644628916,
        "uid": 482049,
        "name": "Alex_wcq",
        "ccfLevel": 0,
        "title": "AT2070 solution"
    },
    {
        "content": "[\u6d1b\u8c37\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT2070) & [Atcoder \u9898\u9762\u4f20\u9001\u95e8](https://atcoder.jp/contests/arc061/tasks/arc061_d)\n\n\u9996\u5148\u8003\u8651\u5408\u6cd5\u7684\u6392\u5217\u957f\u4ec0\u4e48\u6837\uff0c\u6211\u4eec\u8003\u8651\u5c06\u6bcf\u6b21\u64cd\u4f5c\u8005\u7684\u7f16\u53f7\u8bb0\u5f55\u4e0b\u6765\u5f62\u6210\u4e00\u4e2a\u5e8f\u5217\uff08\u7b2c\u4e00\u6b21 A \u64cd\u4f5c\u4e0d\u8ba1\u5165\u5e8f\u5217\uff09\uff0c\u90a3\u4e48\u663e\u7136\u8fd9\u4e2a\u5e8f\u5217\u4e2d\u5fc5\u987b\u6070\u597d\u542b\u6709 $n$ \u4e2a A\uff0c\u4e14\u6700\u540e\u4e00\u4e2a\u5fc5\u987b\u662f A\u3002\u90a3\u4e48\u663e\u7136\u4e00\u4e2a\u5408\u6cd5\u7684\u53d6\u5361\u7247\u65b9\u6848\u552f\u4e00\u5bf9\u5e94\u4e00\u4e2a\u64cd\u4f5c\u5e8f\u5217\uff0c\u800c\u4e00\u4e2a\u957f\u5ea6\u4e3a $l$ \u7684\u64cd\u4f5c\u5e8f\u5217\u6070\u597d\u5bf9\u5e94 $3^{n+m+k-l}$ \u4e2a\u5408\u6cd5\u7684\u53d6\u5361\u7247\u65b9\u6848\uff08\u8bc1\u660e\uff1f\u5c31\u6bcf\u6b21\u4e0b\u4e00\u8f6e\u6267\u884c\u64cd\u4f5c\u7684\u4eba\u662f\u8c01\u5c31\u5728\u5bf9\u5e94\u7684\u64cd\u4f5c\u8005\u6240\u53d6\u7684\u5361\u7247\u4e0a\u5199\u5565\uff0c\u90a3\u4e48\u663e\u7136\u5bf9\u4e8e\u957f\u5ea6\u4e3a $l$ \u7684\u64cd\u4f5c\u5e8f\u5217\u800c\u8a00\uff0c\u5728\u539f\u5361\u7247\u5806\u4e2d\u6070\u597d\u6709 $l$ \u5f20\u5361\u7247\u4e0a\u7684\u6570\u662f\u786e\u5b9a\u4e0b\u6765\u7684\uff0c\u53e6\u5916 $n+m+k-l$ \u5f20\u53ef\u4ee5 randomly \u4e71\u586b\uff0c\u65b9\u6848\u6570\u5c31\u662f $3^{n+m+k-l}$\uff09\n\n\u7136\u540e\u8003\u8651\u600e\u6837\u7edf\u8ba1\u65b9\u6848\uff0c\u6211\u4eec\u679a\u4e3e\u64cd\u4f5c\u5e8f\u5217\u4e2d BC \u51fa\u73b0\u6b21\u6570 $c$\uff0c\u90a3\u4e48\u64cd\u4f5c\u5e8f\u5217\u957f\u5ea6\u5373\u4e3a $c+n$\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a A \u7684\u4f4d\u7f6e\u5df2\u7ecf\u786e\u5b9a\u4e86\uff0c\u90a3\u4e48\u586b\u597d\u53e6\u5916 $n-1$ \u4e2a A \u7684\u65b9\u6848\u6570\u5373\u662f $\\dbinom{n+c-1}{n-1}$\uff0c\u5982\u679c\u6211\u4eec\u80fd\u6c42\u51fa\u586b\u597d B\u3001C \u7684\u65b9\u6848\u6570 $f_k$\uff0c\u5c31\u6709 $ans=\\sum\\limits_{c=0}^{m+k}\\dbinom{n+c-1}{n-1}f_c\u00b73^{m+k-c}$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u600e\u6837\u6c42 $f_c$\uff0c\u9996\u5148\u5217\u51fa\u67ff\u5b50\uff0c\u679a\u4e3e B \u7684\u4e2a\u6570\u7136\u540e\u7ec4\u5408\u6570\u7edf\u8ba1\u7b54\u6848\uff0c\u5373\n$$\nf_c=\\sum\\limits_{i}\\dbinom{c}{i}[i\\le m][c-i\\le k]\n$$\n\u4e0a\u5f0f\u4e5f\u53ef\u4ee5\u5199\u4f5c\n$$\nf_c=\\sum\\limits_{c-k\\le i\\le m}\\dbinom{c}{i}\n$$\n\u6211\u4eec\u77e5\u9053\u7ec4\u5408\u6570\u4e0b\u5e95\u6570\u6c42\u548c\u662f\u65e0\u6cd5\u76f4\u63a5\u6c42\u7684\uff0c\u4e0d\u8fc7\u6ce8\u610f\u5230\u7ec4\u5408\u6570\u6709\u4e2a\u9012\u63a8\u516c\u5f0f $\\dbinom{n}{k}=\\dbinom{n-1}{k}+\\dbinom{n-1}{k-1}$\uff0c\u56e0\u6b64\u8003\u8651\u4ece\u6570\u5217\u9012\u63a8\u7684\u89d2\u5ea6\u7406\u89e3\u8fd9\u9053\u9898\uff0c\u5373\uff1a\n$$\n\\begin{aligned}\nf_c&=\\sum\\limits_{c-k\\le i\\le m}\\dbinom{c}{i}\\\\\n&=\\sum\\limits_{c-k\\le i\\le m}\\dbinom{c-1}{i}+\\dbinom{c-1}{i-1}\\\\\n&=\\sum\\limits_{c-k\\le i\\le m}\\dbinom{c-1}{i}+\\sum\\limits_{c-k\\le i\\le m}\\dbinom{c-1}{i-1}\\\\\n&=\\sum\\limits_{c-k\\le i\\le m}\\dbinom{c-1}{i}+\\sum\\limits_{c-k-1\\le i\\le m-1}\\dbinom{c-1}{i}\\\\\n&=2\\sum\\limits_{c-1-k\\le i\\le m}\\dbinom{c-1}{i}-\\dbinom{c-1}{m}-\\dbinom{c-1}{c-k-1}\\\\\n&=2f_{c-1}-\\dbinom{c-1}{m}-\\dbinom{c-1}{c-k-1}\n\\end{aligned}\n$$\n\u9012\u63a8\u6c42\u4e00\u4e0b\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u7ebf\u6027\u3002\n\n```cpp\nconst int MAXN=9e5; \nconst int MOD=1e9+7;\nint n,m,k,fac[MAXN+5],ifac[MAXN+5],f[MAXN+5],pw3[MAXN+5];\nvoid init_fac(int n){\n\tfor(int i=(fac[0]=ifac[0]=ifac[1]=pw3[0]=1)+1;i<=n;i++) ifac[i]=1ll*ifac[MOD%i]*(MOD-MOD/i)%MOD;\n\tfor(int i=1;i<=n;i++) fac[i]=1ll*fac[i-1]*i%MOD,ifac[i]=1ll*ifac[i-1]*ifac[i]%MOD;\n\tfor(int i=1;i<=n;i++) pw3[i]=3ll*pw3[i-1]%MOD;\n}\nint binom(int x,int y){\n\tif(x<0||y<0||x<y) return 0;\n\treturn 1ll*fac[x]*ifac[y]%MOD*ifac[x-y]%MOD;\n}\nint main(){\n\tscanf(\"%d%d%d\",&n,&m,&k);init_fac(n+m+k);\n\tf[0]=1;for(int i=1;i<=m+k;i++)\n\t\tf[i]=(2ll*f[i-1]-binom(i-1,m)-binom(i-1,i-k-1)+MOD*2ll)%MOD;\n\tint ans=0;for(int i=0;i<=m+k;i++) ans=(ans+1ll*pw3[m+k-i]*binom(n-1+i,i)%MOD*f[i])%MOD;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1626012173,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 AT2070 [ARC061D] 3\u4eba\u3067\u30ab\u30fc\u30c9\u30b2\u30fc\u30e0 / Card Game for Three"
    },
    {
        "content": "\u5148\u8fdb\u884c\u4e00\u4e2a\u6a21\u578b\u8f6c\u6362\uff1a\u8981\u6c42\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u5b57\u7b26\u4e32\u6570\u91cf\uff1a\n\n* \u7531 `a`\u3001`b`\u3001`c` \u4e09\u79cd\u5b57\u7b26\u7ec4\u6210\u3002\n* \u5176\u4e2d\u6070\u597d\u6709 $n$ \u4e2a `a`\uff0c\u4e14\u4ee5 `a` \u7ed3\u5c3e\u3002\n* `b` \u4e0d\u8d85\u8fc7 $m$ \u5f20\uff0c`c` \u4e0d\u8d85\u8fc7 $k$ \u5f20\u3002\n\n\u601d\u8003\u8f6c\u6362\u7684\u8fc7\u7a0b\uff1a\u6bcf\u4e2a\u5b57\u7b26\u5bf9\u5e94\u62bd\u5230\u7684\u5361\u724c\u3002\u5176\u4e2d\u7b2c\u4e8c\u6761\u4fdd\u8bc1\u4e86 `a` \u4f1a\u80dc\u5229\uff0c\u7b2c\u4e09\u6761\u4fdd\u8bc1\u4e86\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d `b` \u6216 `c` \u4e0d\u4f1a\u51fa\u73b0\u5df2\u7ecf\u8d62\u4e86\u7684\u60c5\u51b5\u3002\n\n\u90a3\u4e48\u6709\uff1a\n$$\n\\text{ans}=\\sum_{t=0}^{m+k} (C_{t+n-1}^{n-1}\\times(\\sum_{x=t-k}^{m} C_{t}^{x})\\times 3^{m+k-t})\n$$\n\u8bbe\uff1a\n$$\nf(t)=\\sum_{x=t-k}^{m} C_{t}^{x}\n$$\n\u5219\uff1a\n$$\n\\begin{aligned}\nf(t)&=\\sum_{x=t-k}^{m} (C_{t-1}^{x}+C_{t-1}^{x-1}) \\\\\n&=(\\sum_{x=t-k}^{m}C_{t-1}^{x})+(\\sum_{x=t-k}^{m}C_{t-1}^{x-1}) \\\\\n&=(\\sum_{x=t-k}^{m}C_{t-1}^{x})+(\\sum_{x=t-k-1}^{m-1}C_{t-1}^{x}) \\\\\n&=(f(t-1)-C_{t-1}^{t-k-1})+(f(t-1)-C_{t-1}^{m}) \\\\\n&=2 \\times f(t-1)-C_{t-1}^{t-k-1}-C_{t-1}^{m}\n\\end{aligned}\n$$\n\u53d1\u73b0\u73b0\u5728\u53ef\u4ee5\u5728 $O(n \\log {10^9+7})$ \u7684\u590d\u6742\u5ea6\u9012\u63a8\u6c42\u51fa $f(t)$\u3002\u6211\u4eec\u628a $f(t)$ \u5e26\u5165\u539f\u5f0f\uff1a\n$$\n\\text{ans}=\\sum_{t=0}^{m+k} (C_{t+n-1}^{n-1}\\times f(t)\\times 3^{m+k-t})\n$$\n\n\u5f53\u7136\uff0c\u7528\u6765\u7b97\u7ec4\u5408\u6570\u7684\u9006\u5143\u4ee5\u53ca $3$ \u7684\u5e42\u6b21\u53ef\u4ee5\u7ebf\u6027\u9884\u5904\u7406\uff0c\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u4e3a\u7ebf\u6027\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define L(i, a, b) for(int i = a; i <= b; i++)\n#define R(i, a, b) for(int i = a; i >= b; i--)\nusing namespace std;\nconst int N = 3e5 + 10, mod = 1e9 + 7;\nint n, m, k, fac[N * 3], f[N * 2], ans;\nint qpow(int a, int b){\n\tint ans = 1;\n\twhile(b){\n\t\tif(b & 1) ans = 1ll * ans * a % mod;\n\t\ta = 1ll * a * a % mod, b >>= 1;\n\t}\n\treturn ans;\n}\nint inv(int x){return qpow(x, mod - 2);}\nint C(int n, int m){\n\tif(m < 0 || m > n) return 0;\n\treturn 1ll * fac[n] * inv(fac[m]) % mod * inv(fac[n - m]) % mod;\n}\nint main(){\n\tscanf(\"%d%d%d\", &n, &m, &k); fac[0] = f[0] = 1;\n\tL(i, 1, n + m + k) fac[i] = 1ll * fac[i - 1] * i % mod;\n\tL(i, 1, m + k) f[i] = (2ll * f[i - 1] - C(i - 1, i - k - 1) - C(i - 1, m) + mod * 2) % mod;\n\tL(i, 0, m + k) (ans += 1ll * C(i + n - 1, n - 1) * f[i] % mod * qpow(3, m + k - i) % mod) %= mod;\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1683293481,
        "uid": 341946,
        "name": "zac2010",
        "ccfLevel": 7,
        "title": "ARC061D \u9898\u89e3"
    },
    {
        "content": "\u5e94\u8be5\u662f\u6211\u7b2c\u4e00\u9053\u9ed1\u9898\u9898\u89e3\u5427\u3002\n\n\u4e3b\u8981\u770b\u9898\u89e3\u533a\u6ca1\u6709 $\\texttt{MTT}$ \u89e3\u6cd5\uff0c\u6765\u8865\u5145\u4e00\u4e2a\u3002\n\n## \u89e3\u6cd5\n\n\u8003\u8651\u5728\u7ed3\u675f\u7684\u65f6\u5019\uff0c\u4e5f\u5c31\u662f $A$ \u80dc\u5229\u65f6\uff0c$B$ \u548c $C$ \u5206\u522b\u8f6e\u5230\u4e86 $i,j$ \u6b21\u7684\u65b9\u6848\u6570\u3002\n\n\u9996\u5148\uff0c\u7b2c\u4e00\u8f6e\u662f $A$ \u5df2\u7ecf\u56fa\u5b9a\u4e86\uff0c\u6211\u4eec\u8003\u8651\u540e\u9762 $n-1+i+j$ \u8f6e\u662f $A,B,C$ \u4e2d\u4e00\u4e2a\u4eba\uff0c\u901a\u8fc7\u7b80\u5355\u7684\u7ec4\u5408\u6570\u5b66\u5373\u53ef\u5f97\u77e5\u65b9\u6848\u6570\u4e3a $\\frac{(n-1+i+j)!}{(n-1)!i!j!}$\u3002\n\n\u8003\u8651 $B,C$ \u540e\u9762\u7684\u724c\u968f\u4fbf\u9009\uff0c\u6545\u603b\u65b9\u6848\u6570\u4e3a $\\sum_{i=0}^m\\sum_{j=0}^k\\frac{(n-1+i+j)!}{(n-1)!i!j!}\\times3^{m-i}\\times3^{k-j}$\u3002\n\n\u8003\u8651\u5982\u4f55\u4f18\u5316\uff0c\u4ee4 $t=i+j$\u3002\n\n\u539f\u5f0f $=\\sum_{i=0}^m\\sum_{j=0}^k\\frac{(n-1+t)!}{(n-1)!i!j!}\\times3^{m+k-t}$\n\n$=\\sum_{t=0}^{m+k}(\\frac{(n-1+t)!}{(n-1)!}\\times3^{m+k-t}\\times\\sum_{i=\\max(0,t-k)}^{m}\\frac{1}{i!(t-i)!})$\n\n\u8003\u8651\u5982\u4f55\u6c42\u6700\u53f3\u8fb9\u7684\u5f0f\u5b50\uff0c\u6784\u9020\u51fd\u6570 $f(x)=\\sum_{i=0}^m\\frac{1}{i}$\uff0c$g(x)=\\sum_{i=0}^{k}\\frac{1}{i}$\uff0c\u4e0d\u96be\u53d1\u73b0\u5176\u5b9e\u5c31\u662f $f(x)$ \u4e0e $g(x)$ \u5377\u79ef $x^t$ \u7cfb\u6570\u3002\n\n\u53d1\u73b0~~\u53ef\u7231~~\u6bd2\u7624\u7684\u51fa\u9898\u4eba\u7684\u6a21\u6570\u662f $10^9+7$\uff0c\u4e8e\u662f\u9700\u8981\u4f7f\u7528 $\\texttt{MTT}$ \u624d\u53ef\u4ee5\uff0c\u65f6\u95f4\u9650\u5236\u6bd4\u8f83\u5bbd\u88d5\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5728 $\\Theta(n\\log n)$ \u590d\u6742\u5ea6\u89e3\u51b3\u672c\u9898\u3002\n\n## \u4ee3\u7801\n\n\u7ed9\u51fa\u4e3b\u51fd\u6570\u7247\u6bb5\u4ee3\u7801\uff0c\u4e5f\u5c31\u662f\u4e3b\u9898\u601d\u8def\u5566\u3002\u6ce8\u91ca\uff1a$F(i)=A(i)\\times B(i)$\u3002\n\n```cpp\nsigned main(){\n\tinit();\n\tint N,M,K;\n\tcin>>N>>M>>K;\n\tfor(int i=0;i<=M;i++) A[i]=Int(inv[i]);\n\tfor(int i=0;i<=K;i++) B[i]=Int(inv[i]);\n\tn=M+1;\n\tm=K+1;\n\tMTT();\n\tint ans=0;\n\tfor(int t=0;t<=M+K;t++){\n\t\tans=(ans+fac[N-1+t]*inv[N-1]%mod*f[t]%mod*qp(3,M+K-t)%mod)%mod;\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n```",
        "postTime": 1651678063,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "AT2070 \u9898\u89e3"
    },
    {
        "content": "## \u603b\u7ed3\uff1a\u7ec4\u5408\u6570\n\n\u8fd9$F$\u9898\u597d\u96be\u554a...\u53ea\u4f1a\u90e8\u5206\u5206\u505a\u6cd5\uff0c\u4e0b\u9762\u4e24\u4e2a\u65b9\u6cd5\u90fd\u662f\u90e8\u5206\u5206\u505a\u6cd5\u3002\u6ee1\u5206\u505a\u6cd5\u6211\u53bb\u770b\u770b...\u4f1a\u7684\u8bdd\u5c31\u8865\u4e00\u4e0b\n\n## \u90e8\u5206\u5206\u505a\u6cd5\n\n### \u65b9\u6cd51\uff1a\n\n\u9996\u5148$A$\u80fd\u8d62\u7684\u6761\u4ef6\u5f88\u660e\u663e\uff0c\u5047\u8bbe\u5728\u6240\u6709\u7684\u724c\u91cc\u9762\u53d6\u51fa$A$\u5f20$A$\u724c\uff0c$B$\u5f20$B$\u724c\uff0c$C$\u5f20$C$\u724c\uff0c\u90a3\u4e48$A$\u80fd\u8d62\u5f53\u4e14\u4ec5\u5f53$A=n,B<m,C<k$\n\n\u6240\u4ee5\u5047\u8bbe\u6211\u4eec\u5728\u62ff\u51fa\u4e86$n$\u5f20$A$\u724c\u7684\u60c5\u51b5\u4e0b\uff0c\u4e2d\u95f4\u7a7f\u63d2\u7740\u62ff\u4e86$B$\u5f20$B$\u724c\uff0c$C$\u5f20$C$\u724c\uff0c\u5219\u6709\n\n$$\\sum_{i=0}^{i<=m+k}C(n-1,i+n-1)*3^{m+k-i}*\\sum_{j=0}^{j<=m,j<=k}C(i,j)$$\n\n\u9996\u5148\u5728$i+n-1$\u5f20\u724c\u4e2d\u53d6$n-1$\u5f20$A$\u724c\u7684\u65b9\u6848\u4e3a$C(n-1,n+i-1)$\n\n\u6ce8\u610f\uff1a\u6700\u540e\u4e00\u5f20\u724c\u4e00\u5b9a\u9700\u8981\u662f$A$\uff0c\u6240\u4ee5\u5c31\u53ea\u80fd\u6709$n-1$\n\n\u800c\u4e14\u5269\u4e0b\u7684\u724c\u6570\u7684\u6392\u5217\u4e3a$3^{m+k-i}$\uff0c\u8981\u4e58\u4e0a\u53bb\n\n\u4ee5\u53ca\u5728$i+n-1$\u4e2d$B$\u548c$C$\u7684\u6392\u5217\u4e3a$C(i,j)$\uff0c\u4e5f\u8981\u4e58\u8d77\u6765\n\n\u6240\u4ee5\u5c31\u5f97\u5230\u4e86\u4e0a\u9762\u7684\u516c\u5f0f\n\n\u4f46\u662f\uff0c\u4e0a\u9762\u7684\u505a\u6cd5\u6211\u6253\u6302\u4e86...\u8fd9\u4e2a\u5f0f\u5b50\u662f\u5bf9\u7684\uff0c\u6211\u7b97\u540e\u9762\u90a3\u4e2a$\\sum_{j=0}^{j<=m,j<=k}C(i,j)$\u90a3\u91cc\u6211\u6ca1\u6709\u679a\u4e3e\u597d...\u67e5\u4e0d\u51fa\u6765\u554a...\n\n\u6211\u5728\u7406\u89e3\u4e86\u6ee1\u5206\u505a\u6cd5\u4e4b\u540e\u7ec8\u4e8e\u53d1\u73b0\u6211\u6302\u5728\u54ea\u91cc\u4e86...\n\n\u5728\u679a\u4e3e\u540e\u9762\u7684\u4e1c\u897f\u7684\u65f6\u5019\u6211\u6ca1\u6709\u5206\u7c7b\u8ba8\u8bba\u3002\u4f46\u662f\u6539\u5b8c\u540e\u8c8c\u4f3c\u8fd8\u5206\u5c11\u4e86\u4e00\u7c7b...\n\n$subtask_1$10\u4e2a\u70b9\u6211\u9519\u4e86$2$\u4e2a...\u7136\u540e$subtask_2$\u88ab\u6211\u5f3a\u884c\u6c34\u8fc7\u53bb$2$\u4e2a\u70b9..\n\n\u7528$C$\u724c\u6570\u91cf\u6765\u5206\u7c7b\uff1a\u5206\u4e3a$j<k$\uff0c$j<m$\uff0c$j<i$\uff08\u7b2c\u4e09\u7c7b\u6211\u6ca1\u5206...\u4e0d\u60f3\u53bb\u6539\u4e86...\uff09\n\n\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u60c5\u51b5\uff1a$x=\\sum_{j=0}^{j<k}C(i,j)$\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff1a$x=\\sum_{j=0}^{j<m}C(i,k)$\n\n~~\u5bf9\u4e8e\u7b2c\u4e09\u79cd\u60c5\u51b5\uff1a\u8bf7\u8bfb\u8005\u72ec\u7acb\u601d\u8003\uff08\u77e5\u9053\u6709\u7b2c\u4e09\u79cd\u60c5\u51b5\u662f\u56e0\u4e3a\u6211\u53bb\u770b\u4e86\u4e00\u4e0b\u6ee1\u5206\u7684\u505a\u6cd5...\uff09~~\n\n\n### \u65b9\u6cd52\uff1a\n\n\u6362\u4e00\u79cd\u60f3\u6cd5\uff0c\u5728\u524d$i$\u5f20\u5361\u7247\u4e2d\u62ff\u51fa$n$\u5f20$A$,$j$\u5f20$B$\uff0c$C$\u5f20$C$\n\n\u5219\u53ef\u4ee5\u63a8\u51fa\u4e00\u4e2a\u516c\u5f0f\n\n$$\\sum_{i=0}^{i<=n+m+k}\\frac{(i-1)!}{(n-1)!j!C!}3^{n+k+m-i}$$\n\n\u5982\u679c\u770b\u5f97\u61c2\u90a3\u4e2a\u65b9\u6cd5\u4e00\u7684\u8bdd\u8fd9\u4e2a\u516c\u5f0f\u5927\u6982\u4e5f\u662f\u770b\u5f97\u61c2\u7684\u5427...\n\n\u5c31\u662f$i-1$\u7684\u5168\u6392\u5217\u6570\u9664\u6389$n-1$\u7684\u5168\u6392\u5217\u6570\u548c$j$\u7684\u5168\u6392\u5217\u6570\u548c$C$\u7684\u5168\u6392\u5217\u6570\n\n\u8fd9\u4e2a\u662f\u5f88\u57fa\u7840\u7684\u4e00\u4e2a\u7ec4\u5408\u6570\u7684\u5e38\u8bc6\uff0c\u8fd9\u6837\u5b50\u5f97\u5230\u7684\u5c31\u662f\u6211\u4eec\u8981\u7684\u5f53\u524d\u60c5\u51b5\u7684\u65b9\u6848\u6570\uff0c\u8bb0\u4f4f\u4e5f\u8981\u628a\u5f53\u524d\u5269\u4e0b\u7684\u90a3\u4e9b\u7684\u65b9\u6848\u6570\u4e5f\u4e58\u4e0a\u53bb\uff0c\u5373$3^{n+m+k-i}$\n\n\u7136\u540e\u8fd9\u91cc\u7684\u9664\u6cd5\u662f$mod$ $m$\u610f\u4e49\u4e0b\u7684\uff0c\u6240\u4ee5\u8981\u6c42\u4e00\u4e0b\u9006\u5143\uff0c\u4ee3\u7801\u4e2d\u7684$fac[i]$\u5373\u4e3a$i!$\u7684\u503c\uff0c$ifac[i]$\u5373\u4e3a$i!$\u7684\u9006\u5143\n\n\u94bb\u7814\u4e86\u5f88\u4e45\u7684\u9898\u89e3\uff0c\u7ec8\u4e8e\u5dee\u4e0d\u591a\u641e\u61c2\u6ee1\u5206\u505a\u6cd5\u4e86...\n\n## \u6ee1\u5206\u505a\u6cd5\n\n\u65b9\u6cd5\u4e00\u786e\u5b9e\u662f\u5bf9\u7684\u3002\u8fd9\u4e2a\u6ee1\u5206\u505a\u6cd5\u5c31\u662f\u7528\u6765\u6539\u8fdb\u90a3\u91cc\u7684\n\n\u89c2\u5bdf\u8017\u65f6\uff0c\u8017\u65f6\u57fa\u672c\u90fd\u662f\u82b1\u8d39\u5728\u679a\u4e3e\u540e\u9762\u90a3\u4e00\u6bb5\uff0c\u6240\u4ee5\u8003\u8651\u4f18\u5316\u90a3\u4e00\u6bb5...\uff08\u8fd9\u4e2a\u505a\u6cd5\u5f88\u6e05\u5947...\u6b63\u5e38\u5199\u7ec4\u5408\u6570\u4e0d\u5e94\u8be5\u662f\u4f18\u5316\u90a3\u4e2a\u5f0f\u5b50\u5417...\uff09\n\n$$\\sum_{i=0}^{i<=m+k}C(n-1,i+n-1)*3^{m+k-i}*\\sum_{j=0}^{j<=m,j<=k}C(i,j)$$\n\n\u8fd8\u662f\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u6765\u4f18\u5316\u6389\u540e\u9762\u90a3\u4e2a$\\sum_{j=0}^{j<=m,j<=k}C(i,j)$\uff08\u5c31\u662f\u6211\u5199\u9519\u4e86\u8fd8\u67e5\u4e0d\u51fa\u6765\u7684\u90a3\u4e2a\u73a9\u610f...\u4e0d\uff01\u6211\u5199\u5230\u8fd9\u91cc\u7684\u65f6\u5019\u5ffd\u7136\u53d1\u73b0\u6211\u5728\u679a\u4e3e\u7684\u65f6\u5019\u6ca1\u6709\u5206\u7c7b\u8ba8\u8bba\uff01\uff09\n\n\u6211\u4eec\u628a\u540e\u9762\u90a3\u4e2a$\\sum$\u62c6\u6389\uff0c\u5206\u4e09\u90e8\u5206\u8ba8\u8bba\n\n\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u624b\u4e0a\u6709$x$\u5f20$C$\u724c\n\n\u5f53$x<k$\u65f6\uff0c\u968f\u4fbf\u53d6...\uff08C\u7684\u6570\u91cf\u90fd\u6bd4\u4f60\u8981\u53d6\u7684\u591a\u4e86\u6240\u4ee5\u80af\u5b9a\u4e0d\u4f1a\u8d85\u9650\uff09\u5373$\\sum_{i=0}^{x<k}C(x,i)$\n\n\u5f53$x<m$\u65f6\uff0c$C$\u7684\u6570\u91cf\u5728$i$\u4ee5\u5185\uff0c\u540c\u65f6\u4e0d\u80fd\u53d6\u8d85\u8fc7$k$\u4e2a\uff0c\u5373$\\sum_{i=0}^{i<m}C(x,i)$\n\n\u5f53$m<=x<m+k$\u65f6\uff0c$B,C$\u6570\u91cf\u5747\u4e0d\u8d85\u8fc7$i$\uff0c\u540c\u65f6$B$\u4e0d\u80fd\u53d6\u8d85\u8fc7$m$\u4e2a\uff0c$C$\u4e0d\u80fd\u53d6\u8d85\u8fc7$k$\u4e2a\uff0c\u5373$\\sum_{i-m+1}^{i<k}C(x,i)$\n\n\u7136\u540e\u600e\u4e48\u4f18\u5316\u5462\n\n\u5982\u679c\u4f60\u719f\u77e5\u6768\u8f89\u4e09\u89d2\u8fd9\u4e2a\u4e1c\u897f\u7684\u8bdd\uff0c\u5927\u6982\u5c31\u4f1a\u77e5\u9053\u600e\u4e48\u4f18\u5316\u4e86\n\n\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86$i-1$\u65f6$x$\u7684\u503c\uff0c\u90a3\u4e48\u5176\u5b9e\u53ef\u4ee5\u63a8\u51fa\u4e0b\u9762\u7684\u51e0\u4e2a\u5f0f\u5b50\uff1a\n\n\u60c5\u51b5$1$\uff1a$x=x*2$\n\n\u60c5\u51b5$2$\uff1a$x=x*2-C(i,k)$\n\n\u60c5\u51b5$3$\uff1a$x-x*2-C(i,k)-C(i,m)$\n\n\u8fd9\u4e2a\u633a\u5bb9\u6613\u63a8\u7684\u5427...\u5982\u679c\u90e8\u5206\u5206\u505a\u6cd5\u7684\u7b2c\u4e00\u79cd\u6709\u63a8\u51fa\u6765\u90a3\u4e48\u8fd9\u4e2a\u4f18\u5316\u4e5f\u5c31\u987a\u7406\u6210\u7ae0\u4e86\u7684\u6837\u5b50\uff08\u4f46\u662f\u6211\u63a8\u51fa\u6765\u4e86\u4e00\u534a...\uff09\n\n\u6570\u5b66\u9898\u771f\u7684\u8650\u54ed\u6211...\u8fd9\u9898\u6211\u7814\u7a76\u4e86$3$\u5929...\n\n\u4e0d\u8fc7\u786e\u5b9e\u662f\u4e00\u9053\u7ec4\u5408\u6570\u7684\u597d\u9898...\u505a\u5b8c\u540e\u89c9\u5f97\u5bf9\u7ec4\u5408\u6570\u8fd9\u73a9\u610f\u7684\u7406\u89e3\u66f4\u6df1\u4e86\u4e00\u4e9b...\n\n[\u4ee3\u7801\u8bf7\u6233\u6211\u7684\u535a\u5ba2QAQ](https://www.cnblogs.com/henry-1202/p/ARC061F.html)",
        "postTime": 1537623947,
        "uid": 36526,
        "name": "henry_y",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT2070 \u30103\u4eba\u3067\u30ab\u30fc\u30c9\u30b2\u30fc\u30e0 / Card Game for Three\u3011"
    }
]
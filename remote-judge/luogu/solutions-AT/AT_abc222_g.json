[
    {
        "content": "\u9996\u5148\u5f53 $x$ \u662f $4$ \u7684\u500d\u6570\u65f6\u663e\u7136\u65e0\u89e3,\u5e76\u4e14\u5982\u679c $x$ \u662f\u5076\u6570\u90a3\u4e48\u4ed6\u7684\u7b54\u6848\u4e0e $\\frac{x}{2}$ \u662f\u76f8\u540c\u7684\u3002\u90a3\u4e48\u95ee\u9898\u5373\u4e3a\u627e\u5230\u4e00\u4e2a\u6700\u5c0f\u7684 $n$\uff0c\u4f7f\u5f97 $x \\mid 111 \\dots 111$ \uff08$n$ \u4e2a $1$\uff09\u6210\u7acb\u3002\n\n\u4e00\u4e2a\u6bd4\u8f83\u7ecf\u5178\u7684[\u5957\u8def](https://www.luogu.com.cn/problem/P4884)\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06 $11111\\dots 111$ \u5199\u4e3a $\\frac{10^n -1}{9}$\uff0c\u90a3\u4e48\u539f\u9650\u5236\u5c31\u53d8\u6210\u4e86 $10^n \\equiv 1 (\\bmod 9x)$\u3002\n\n\u6709\u4e00\u4e2a\u7ed3\u8bba\u662f\u6709\u89e3\u5f53\u4e14\u4ec5\u5f53 $\\gcd(9x,10) = 1$\u3002\n\n\u8003\u8651\u7528\u53cd\u8bc1\u6cd5\u8fdb\u884c\u8bc1\u660e\u3002\n\n\u82e5 $\\gcd(10,9x)\\neq 1$\uff0c\u90a3\u4e48 $\\gcd(10^n ,9x) \\neq 1$\uff0c\u5373 $\\gcd(10^n \\bmod 9x ,9x) \\neq 1$ \u3002\u4f46\u662f\u6211\u4eec\u53c8\u77e5\u9053 $10^n \\equiv 1 (\\bmod 9x)$\uff0c\u8fd9\u8bf4\u660e $10^n \\bmod 9x =1$\uff0c\u7ed3\u5408\u4e0a\u5f0f\u6211\u4eec\u5f97\u51fa $\\gcd(1,9x) \\neq 1$\uff0c\u8fd9\u663e\u7136\u662f\u9519\u8bef\u7684\u3002\u7ed3\u8bba\u5f97\u8bc1\u3002\n\n\u7531\u6b27\u62c9\u5b9a\u7406\u6211\u4eec\u77e5\u9053\uff0c\u82e5 $\\gcd(x,y) = 1$\uff0c\u90a3\u4e48 $x^{\\phi(y)} \\equiv 1 (\\bmod y)$\u3002\u5957\u7528\u5230\u8fd9\u91cc\u5c31\u662f $10^{\\phi(9x)} \\equiv 1 (\\bmod 9x)$\u3002\n\n\u8fd9\u91cc\u53c8\u6709\u4e00\u4e2a\u7ed3\u8bba\uff0c\u82e5 $n$ \u662f\u6700\u5c0f\u7684\u7b54\u6848\u4f7f\u5f97 $10^n \\equiv 1 (\\bmod 9x)$ \u6210\u7acb\uff0c\u90a3\u4e48 $n \\mid \\phi(9x)$\u3002\n\n\u8fd8\u662f\u8003\u8651\u53cd\u8bc1\u6cd5\u3002\n\n\u82e5\u6700\u5c0f\u6b63\u6574\u6570\u89e3 $n \\nmid  \\phi(9x)$\uff0c\u8bb0 $n' = \\gcd(n,\\phi(9x))$\uff0c\u663e\u7136 $a \\times n + b \\times \\phi(9x) = n'$ \u8fd9\u4e00\u65b9\u7a0b\u6709\u6b63\u6574\u6570\u89e3\u3002\n\n\u90a3\u4e48 $10^{n'} = 10^{a \\times n + b \\times \\phi(9x)} = (10^{n})^a \\times (10^{\\phi(x)})^b$\u3002\u663e\u7136 $(10^{n})^a \\times (10^{\\phi(x)})^b \\equiv 1 (\\bmod 9x)$\uff0c\u6240\u4ee5 $n'$ \u4e5f\u662f\u4e00\u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684\u89e3\u3002\n\n\u7531\u4e8e $n \\nmid \\phi(9x)$\uff0c\u6240\u4ee5 $n' < n$\uff0c$n$ \u4e0d\u53ef\u80fd\u662f\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3002\u7ed3\u8bba\u5f97\u8bc1\u3002\n\n\u7531\u6b64\uff0c\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e $\\phi(9x)$ \u7684\u56e0\u6570\u5e76\u4e14\u66b4\u529b\u5224\u65ad\u5373\u53ef\u505a\u5230 $\\mathcal{O}(\\sqrt{n} \\log n )$\u3002\n\n\u4e8b\u5b9e\u4e0a\u5982\u679c\u4f60\u4f1a $\\text{BSGS}$ \u7684\u8bdd\u6839\u672c\u4e0d\u9700\u8981\u8fd9\u4e48\u591a\u7684\u5206\u6790\uff08\uff09\uff0c\u63a8\u51fa $10^n \\equiv 1 (\\bmod 9x)$ \u4e4b\u540e\u76f4\u63a5\u505a\u590d\u6742\u5ea6\u5c31\u662f\u5bf9\u7684\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define int long long\n#define vi vector<int>\n#define pb(x) push_back(x)\n#define pii pair<int,int>\n#define lowbit(x) x&-x\nusing namespace std;\nll ans;\nint n,m,T;\ninline int read(){\n\tint s=0,f=0;\n\tchar ch=getchar();\n\twhile(ch>'9'||ch<'0') f|=(ch=='-'),ch=getchar();\n\twhile(ch<='9'&&ch>='0') s=(s<<3)+(s<<1)+(ch^48),ch=getchar();\n\treturn f?-s:s;\n}\ninline int phi(int n){\n\tint res=n;\n\tfor(register int i=2;i*i<=n;++i){\n\t\tif(n%i) continue;\n\t\twhile(n%i==0) n/=i;\n\t\tres-=res/i;\n\t}\n\tif(n!=1) res-=res/n;\n\treturn res;\n}\ninline int qpow(int x,int y,int mod){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1) res=res*x%mod;\n\t\tx=x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\ninline int calc(int x){\n\tint y=phi(x),res=-1;\n\tfor(register int i=1;i*i<=y;++i){\n\t\tif(y%i) continue;\n\t\tif(qpow(10,i,x)==1) return i;\n\t\tif(qpow(10,y/i,x)==1) res=y/i;\n\t}\n\treturn res;\n}\nsigned main(){\n\tT=read();\n\twhile(T--){\n\t\tn=read();\n\t\tif(n%4==0){\n\t\t\tprintf(\"-1\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tif(!(n&1)) n/=2;\n\t\tn*=9;\n\t\tif(__gcd(n,10ll)!=1){\n\t\t\tprintf(\"-1\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tprintf(\"%lld\\n\",calc(n));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1681968037,
        "uid": 428089,
        "name": "HMZHMZHMZ",
        "ccfLevel": 7,
        "title": "ABC222G"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a $k$\uff0c\u6c42\u6700\u5c0f\u7684 $i$ \u6ee1\u8db3 $k\\mid 22......222$\uff08\u5171 $i$ \u4e2a $2$\uff09  \n\u9996\u5148\u5f53 $2|k$ \u7684\u65f6\u5019\u4ee4 $k\\gets \\dfrac{k}{2}$\uff0c  \n\u7136\u540e\u539f\u5f0f\u5316\u4e3a $k\\mid 11....1$\u3002  \n\u6211\u4eec\u6765\u63a8\u4e00\u63a8\u5f0f\u5b50\u3002\n\n$$\n\\begin{aligned}\nk&\\mid11.......11 \\\\\n9k&\\mid 99.......99 \\\\\n9k&\\mid 10^i-1\n\\end{aligned}\n$$\n\n\u76f8\u5f53\u4e8e\u6c42\u4e00\u4e2a $i$ \u6ee1\u8db3 $10^i\\equiv1(\\bmod\\ 9k)$  \n**Key Observation**\uff1a\u5f53 $\\gcd(10,9k)\\neq 1$  \u65f6\uff0c\u5fc5\u5b9a\u65e0\u89e3\u3002  \n\u8bc1\u660e\uff1a\n> \u53cd\u8bc1\u6cd5\u3002\u5f53 $\\gcd(10,9k)\\neq 1$ \u65f6  \n> $\\because \\gcd(10, 9k)\\neq1 \\therefore\\gcd(10^i,9k)\\neq1$  \n> $\\therefore\\gcd(10^i\\bmod9k,9k)\\neq1$  \n> $\\because 10^i=1\\bmod9k \\therefore\\gcd(10^i\\bmod9k,9k)=\\gcd(9k,1)=1$  \n> \u77db\u76fe\uff01\n\n\u5f53 $\\gcd(10,9k)=1$ \u65f6\uff0c\u4f7f\u7528 BSGS \u5373\u53ef\u3002",
        "postTime": 1668905540,
        "uid": 366338,
        "name": "fjy666",
        "ccfLevel": 0,
        "title": "\u300c\u8fd9\u4e4b\u540e\u5c31\u4e00\u4e2a\u4eba\u4e5f\u6ca1\u6709\u4e86\u5417\u300d"
    },
    {
        "content": "### Preface\n\n\u6211\u4eec\u7684\u4fe1\u606f\u6559\u7ec3\u4fe1\u8a93\u65e6\u65e6\u7684\u6253\u4e86\u4e00\u4e2a\u66b4\u529b\u4e0a\u53bb\uff0c\u544a\u8bc9\u6211\u4eec\u2014\u2014\u7edd\u5bf9\u4e0d\u4f1a T\uff01\n\n~~\u540e\u6765\u76f8\u4fe1\u5927\u5bb6\u4e5f\u77e5\u9053\u7ed3\u679c~~\n\n### Problem\n\n\u9898\u610f\uff1a\u6c42\u6700\u5c11\u7684 $n$ \u4f7f\u5f97 $n$ \u4e2a $2$ \u6784\u6210\u7684\u5341\u8fdb\u5236\u6570\u5b57\u662f $k$ \u7684\u500d\u6570\uff0c\u591a\u6d4b\uff0c$1 \\leq T \\leq 200, 1 \\leq k \\leq 10^8$\u3002\n\n### Solution\n\n$n$ \u4e2a $2$ \u6784\u6210\u7684\u5341\u8fdb\u5236\u6570\u5b57......\u6709\u70b9\u5947\u602a\uff0c\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\u7ed9\u5b83\u627e\u51fa\u4e00\u4e2a\u901a\u9879\uff08\u2014\u2014\u771f\u7684\u5417\uff1f\uff09\n\n\u8003\u8651 $n$ \u4e2a $9$ \u6784\u6210\u7684\u6570\u5b57\uff0c\u5b83\u662f $10^n - 1$\u3002\u90a3\u4e48 $n$ \u4e2a $2$ \u5c31\u662f $\\dfrac{2}{9}(10^n - 1)$\u3002\n\n\u4ee4 $k \\leftarrow 9\\times k$\uff0c\u90a3\u4e48\u5176\u5b9e\u5c31\u662f $k \\mid 2\\times(10^n - 1)$ \u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3002\n\n\u8fd9\u91cc\u628a $\\times 2$ \u53bb\u6389\uff1a\u5982\u679c $2 \\mid k$\uff0c\u90a3\u4e48\u518d\u4ee4 $k \\leftarrow \\frac{1}{2}\\times k$\uff0c\u8fd9\u4e00\u6b65\u6b63\u786e\u6027\u663e\u7136\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5728\u8f6c\u5316\u540e\u7684 $k$ \u4e0b\uff0c$10^n \\equiv 1 \\pmod k$\u3002\n\n\u9996\u5148\u5982\u679c $\\gcd(10, k) \\neq 1$\uff0c\u611f\u6027\u7406\u89e3\u8fd9\u4e2a\u5c31\u7edd\u5bf9\u4e0d\u4f1a\u6709 $\\bmod k$ \u540e $= 1$\uff0c\u628a\u8fd9\u4e2a\u7279\u5224\u6389\u3002\u63a5\u4e0b\u6765\u7684\u4e24\u4e2a\u505a\u6cd5\u90fd\u8981\u7528\u5230 $\\gcd(10, k) = 1$\u3002\n\n**\u505a\u6cd5 $1$\uff1a** \u89c2\u5bdf\u5230\u8fd9\u4e2a\u5b9e\u9645\u4e0a\u662f [Baby Step Giant Step](https://www.luogu.com.cn/problem/P3846) \u6a21\u677f\u9898\u3002\u4f46\u662f\u6211\u4e0d\u4f1a\uff0c\u6240\u4ee5\u679c\u65ad\u653e\u5f03\u3002\n\n**\u505a\u6cd5 $2$\uff1a** \u6211\u4eec\u6839\u636e [\u6b27\u62c9\u5b9a\u7406](https://zhuanlan.zhihu.com/p/131536831)\uff0c\u53ef\u77e5 $10^{\\varphi(k)} \\equiv 1 \\pmod k$ \u7136\u540e\u6700\u5c0f\u7684 $n$ \u80af\u5b9a $\\leq \\varphi(k)$\u3002\n\n> + \u5f15\u7406\uff1a\u6240\u6709\u8fd9\u4e2a\u65b9\u7a0b\u7684 $\\leq \\varphi(k)$ \u7684\u6700\u5c0f\u89e3 $n$ \u90fd\u6ee1\u8db3 $n \\mid \\varphi(k)$\u3002\n\n\u8bc1\u660e\uff1a\u5047\u8bbe $n \\nmid \\varphi(k)$\uff0c\u4ee4 $d = \\gcd(n, \\varphi(k))$\uff0c\u663e\u7136 $d \\lt n$\uff08$d$ \u4e0d\u53ef\u80fd $\\gt n$\uff0c\u4e14\u82e5 $d = n$\uff0c\u5219 $n \\mid \\varphi(k)$\uff09\u3002\u90a3\u4e48\u7531 [\u88f4\u8700\u5b9a\u7406](https://www.luogu.com.cn/problem/P4549)\uff0c\u663e\u7136\u5b58\u5728\u6574\u6570 $a, b$ \u4f7f\u5f97 $an + b\\varphi(k) = d$\u3002\n\n\u6240\u4ee5 $10^d \\equiv 10^{an+b\\varphi(k)} \\equiv (10^n)^a\\times (10^{\\varphi(k)})^b \\equiv 1\\times 1 \\equiv 1 \\pmod k$\u3002\n\n\u5bfc\u51fa\u77db\u76fe\uff0c\u6b64\u65f6 $d$ \u5e94\u4e3a\u6700\u5c0f\u89e3\uff08\u5e76\u4e14 $d \\mid \\varphi(k)$\uff09\u3002\n\n\u7136\u540e\u6211\u4eec\u76f4\u63a5\u66b4\u529b $\\mathcal O(\\sqrt{k})$ \u6c42\u51fa $\\varphi(k)$ \u5e76\u4e14\u679a\u4e3e\u5b83\u7684\u6240\u6709\u56e0\u5b50\u5feb\u901f\u5e42\u3002\u8fd9\u4e2a\u590d\u6742\u5ea6\u548c\u5e26 map \u7684 BSGS \u4e00\u6837\u3002\n\n[\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(T\\sqrt{k}\\log k)$\u3002](https://www.luogu.com.cn/record/90800149)",
        "postTime": 1666436353,
        "uid": 419487,
        "name": "irris",
        "ccfLevel": 7,
        "title": "ABC222 G Solution"
    }
]
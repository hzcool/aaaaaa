[
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/AT_utpc2011_8)\n\n\u673a\u7ffb\u591a\u5c11\u6709\u70b9\u751f\u8349\uff0c\u4e0d\u5982\u91cd\u65b0\u63cf\u8ff0\u4e00\u904d\u3002\u603b\u5171\u6709 $m$ \u4e2a\u76d2\u5b50\uff0c\u7ed9\u5b9a $n$ \u79cd $k$ \u4e2a\u5c0f\u7403\uff0c\u4f9d\u6b21\u653e\u5165\u76d2\u5b50\u4e2d\uff0c\u6c42\u6700\u5c0f\u7684\u82b1\u8d39\u3002\u82b1\u8d39\u5b9a\u4e49\u4e3a\u5bf9\u4e8e\u7b2c $i$ \u4e2a\u5c0f\u7403\uff1a\n\n- \u5982\u679c\u5df2\u7ecf\u6709\u76d2\u5b50\u653e\u6709\u8fd9\u79cd\u5c0f\u7403\uff0c\u5219\u4ee3\u4ef7\u4e3a $0$\u3002\n- \u5982\u679c\u6ca1\u6709\u76d2\u5b50\u6709\u8fd9\u79cd\u5c0f\u7403\uff0c\u5219\u82b1\u8d39 $w_{a_i}$ \u7684\u4ee3\u4ef7\u627e\u4e00\u4e2a\u76d2\u5b50\u653e\u4e0b\uff0c\u5982\u679c\u9009\u7684\u8fd9\u4e2a\u76d2\u5b50\u91cc\u6709\u7403\uff0c\u5219\u62ff\u51fa\u4e4b\u524d\u653e\u7684\u7403\u3002\n\n\u9996\u5148\u8fde\u7eed\u63d2\u5165\u540c\u4e00\u79cd\u5c0f\u7403\u7684\u60c5\u51b5\u662f\u5e73\u51e1\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u5728\u8bfb\u5165\u7684\u65f6\u5019\u628a\u8fde\u7eed\u989c\u8272\u6bb5\u7f29\u6210\u4e00\u4e2a\u3002\n\n\u8bb0\u540c\u4e00\u79cd\u5c0f\u7403\u5f53\u524d\u63d2\u5165\u65f6\u95f4\u4e3a $s$\uff0c\u4e0b\u4e00\u6b21\u63d2\u5165\u65f6\u95f4\u4e3a $t$\uff0c\u90a3\u4e48\u5b9e\u9645\u51b3\u7b56\u53ea\u6709\u4e24\u79cd\uff1a\n\n- \u65e0\u8bba\u5728 $[s,t)$ \u7684\u54ea\u4e2a\u65f6\u523b\u53d6\u51fa\u5c0f\u7403\uff0c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u90fd\u662f\u76f8\u540c\u7684\uff0c\u6240\u4ee5\u4e0d\u59a8\u94a6\u5b9a\u653e\u5165\u540e\u7acb\u5373\u53d6\u51fa\uff0c\u5373 $s$ \u653e\u5165\uff0c$s + 1$ \u62ff\u51fa\uff0c\u4ee3\u4ef7\u4e3a $w_{a_i}$\u3002\n- \u4e00\u76f4\u653e\u5728\u76d2\u5b50\u4e2d\u76f4\u5230\u4e0b\u4e00\u6b21\u63d2\u5165\uff0c\u8fd9\u6837\u4e0b\u4e00\u6b21\u63d2\u5165\u4ee3\u4ef7\u4e3a $0$\u3002\n\n\u9996\u5148\u6211\u4eec\u5047\u8bbe\u6bcf\u4e2a\u5c0f\u7403\u90fd\u7528\u7b2c\u4e00\u79cd\u51b3\u7b56\uff0c\u7136\u540e\u518d\u770b\u600e\u6837\u5c3d\u53ef\u80fd\u591a\u7684\u9009\u51b3\u7b56\u4e8c\u66ff\u4ee3\u51b3\u7b56\u4e00\u3002\n\n\u8003\u8651\u8d39\u7528\u6d41\u3002\u4ee5\u4e0b\u8bb0\u5f53\u524d\u4f4d\u7f6e\u4e3a $i$ \uff0c\u5bf9\u4e8e\u5728 $i$ \u7684\u8fd9\u79cd\u5c0f\u7403\uff0c\u4e0a\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u4e3a $pre_i$\uff0c\u6e90\u70b9\u4e3a $s$\uff0c\u6c47\u70b9\u4e3a $t$\u3002\n\n- \u5bf9\u4e8e\u7b2c\u4e00\u79cd\u51b3\u7b56\uff0c\u6211\u4eec\u8fde $i \\to i + 1$\uff0c\u8d39\u7528\u4e3a $0$\uff0c\u6d41\u91cf\u4e3a $\\text{INF}$ \u5373\u6ca1\u6709\u8282\u7701\u4ee3\u4ef7\uff0c\u653e\u5165 $i$ \u7684\u5c0f\u7403\u540e\u5728 $i + 1$ \u63a5\u7740\u62ff\u51fa\u3002\n- \u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u51b3\u7b56\uff0c\u6211\u4eec\u8fde $pre_i + 1 \\to i$ \u8868\u793a\u4e0a\u4e00\u6b21\u653e\u5165\u540e\u4e0d\u5728 $pre_i + 1$ \u62ff\u51fa\uff0c\u800c\u662f\u4e00\u76f4\u653e\u7f6e\u5230 $i$ \u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u8d39\u7528\u4e3a $- w_{a_i}$ \u8868\u793a\u80fd\u7701\u4e0b $w_{a_i}$\uff0c\u6d41\u91cf\u81ea\u7136\u4e3a $1$\u3002\n- \u6700\u540e\u8fde $s \\to 1$\uff0c$k \\to t$\u3002\u9650\u5b9a $s \\to 1$ \u7684\u6d41\u91cf\u4e3a $m-1$\u3002\n\n\u4e3a\u4ec0\u4e48\u8fd9\u6837\u9650\u5b9a\u6d41\u91cf\u5462\uff1f\u8003\u8651\u8fd9\u91cc\u6d41\u91cf\u7684\u542b\u4e49\u662f\u76d2\u5b50\u88ab\u4f7f\u7528\u7684\u72b6\u51b5\u3002\u56e0\u4e3a\u6211\u4eec\u8981\u4fdd\u8bc1\u59cb\u7ec8\u6709\u4e00\u4e2a\u76d2\u5b50\u53ef\u4ee5\u8ba9\u6211\u4eec\u8fdb\u884c\u51b3\u7b56\u4e00\u7684\u77ac\u95f4\u653e\u5165\u62ff\u51fa\uff0c\u6240\u4ee5\u6211\u4eec\u540c\u4e00\u65f6\u523b\u6700\u591a\u53ea\u80fd\u6709 $m - 1$ \u4e2a\u76d2\u5b50\u5b58\u7740\u4e4b\u524d\u7684\u5c0f\u7403\u3002\n\n\u5bf9\u4e8e\u4e0a\u9762\u4e00\u4e32\u7684\u5efa\u8fb9\uff0c\u5f53\u7136\u8fd8\u6709\u4e00\u5f20\u611f\u6027\u4e00\u4e9b\u7684\u56fe\u3002\n\n![7B36XFY_YGEJ5UZNWSF_V54.png](https://s2.loli.net/2023/03/16/K34Va5zgvSDGhjT.png)\n\n\u9ed1\u8272\u4ee3\u8868\u51b3\u7b56\u4e00\uff0c\u5f69\u8272\u4ee3\u8868\u53ef\u4ee5\u9009\u62e9\u7684\u51b3\u7b56\u4e8c\uff0c\u6211\u4eec\u5728\u4e00\u4e2a\u65f6\u523b\u4e0d\u80fd\u540c\u65f6\u5360\u7528\u8d85\u8fc7 $m-1$ \u4e2a\u76d2\u5b50\uff0c\u4f7f\u5f97\u4e0d\u80fd\u64cd\u4f5c\u51b3\u7b56\u4e00\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(K M (N + K))$\uff0c\u7531\u4e8e $M$ \u5f88\u5c0f\uff0c\u4e0a\u6765\u5c31\u5f88\u9650\u5236\u6d41\u91cf\uff0c\u6240\u4ee5\u8fdc\u8fdc\u8fbe\u4e0d\u5230\u8fd9\u4e2a\u4e0a\u754c\u3002\n\n\u8fd9\u4e2a\u9898\u4e5f\u7b97\u5f97\u4e0a\u662f\u4e0a\u53e4\u9898\u4e86\uff0c[\u5b98\u65b9\u9898\u89e3](https://www.utpc.jp/2011/slides/cache.pdf)\u7ed9\u7684\u5341\u5206\u7b80\u7565\u6a21\u7cca\uff0c\u518d\u52a0\u4e0a AtCoder \u4e0a\u8fd9\u4e2a\u9898\u7684\u8bc4\u6d4b\u8fd8\u5199\u7684\u6709\u70b9\u9505\uff0c\u6240\u4ee5\u6709\u5f88\u591a\u5947\u602a\u7684\u95ee\u9898\u3002\u9996\u5148\u662f\u6700\u540e\u8f93\u51fa\u7b54\u6848\u5fc5\u987b\u8981\u52a0\u4e00\u4e2a\u6362\u884c\uff0c\u4e0d\u7136\u4f1a\u5224\u5b9a\u6536\u4e0d\u5230\u7b54\u6848\u4e00\u76f4\u65f6\u95f4\u8d85\u9650\u3002\u8fd8\u6709\u5c31\u662f\u8981\u5f00 $\\text{int}$\uff0c\u7b14\u8005~~\u56e0\u4e3a\u4ee3\u7801\u4e11\u964b~~\u4e0d\u7528 $\\text{int}$ \u4e5f\u4f1a\u8d85\u65f6\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\ninline int read()\n{\n\tint s=0,w=1;\n\tchar c=getchar();\n\twhile(!isdigit(c)) {if(c=='-') w=-1; c=getchar();}\n\twhile(isdigit(c)) s=(s<<1)+(s<<3)+(c^48),c=getchar();\n\treturn s*w;\n}\n\nnamespace LgxTpre\n{\n\tstatic const int MAX=100010;\n\tstatic const int INF=2007070707;\n\tstatic const int mod=998244353;\n\t\n\tint m,n,k,x;\n\tint sum,con;\n\tint w[MAX],a[MAX],lst[MAX];\n\t\n\tstruct edge\n\t{\n\t\tint nex,to,val,flow;\n\t}e[MAX<<1];\n\tint head[MAX],cnt=1;\n\tinline void add(int x,int y,int val,int flow)\n\t{\n\t\te[++cnt].nex=head[x],head[x]=cnt,e[cnt].to=y,e[cnt].val=val,e[cnt].flow=flow;\n\t\te[++cnt].nex=head[y],head[y]=cnt,e[cnt].to=x,e[cnt].val=-val,e[cnt].flow=0;\n\t\treturn;\n\t}\n\t\n\tint s,t;\n\tint incf[MAX],dis[MAX],vis[MAX],pre[MAX]; \t\n\tint maxflow,mincost;\n\tqueue<int> q;\n\tinline bool spfa()\n\t{\n\t\tfor(int i=s;i<=t;++i) vis[i]=0,dis[i]=INF;\n\t\tq.push(s),vis[s]=1,dis[s]=0,incf[s]=INF;\n\t\twhile(!q.empty())\n\t\t{\n\t\t\tint now=q.front(); q.pop();\n\t\t\tvis[now]=0;\n\t\t\tfor(int i=head[now];i;i=e[i].nex)\n\t\t\t{\n\t\t\t\tint to=e[i].to;\n\t\t\t\tif(!e[i].flow) continue;\n\t\t\t\tif(dis[to]>dis[now]+e[i].val)\n\t\t\t\t{\n\t\t\t\t\tdis[to]=dis[now]+e[i].val;\n\t\t\t\t\tincf[to]=min(e[i].flow,incf[now]);\n\t\t\t\t\tpre[to]=i;\n\t\t\t\t\tif(!vis[to]) vis[to]=1,q.push(to);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn dis[t]!=INF;\n\t}\n\tinline void Augment()\n\t{\n\t\twhile(spfa())\n\t\t{\n\t\t\tint now=t;\n\t\t\tmaxflow+=incf[t];\n\t\t\tmincost+=incf[t]*dis[t];\n\t\t\twhile(now!=s)\n\t\t\t{\n\t\t\t\tint i=pre[now];\n\t\t\t\te[i].flow-=incf[t];\n\t\t\t\te[i^1].flow+=incf[t];\n\t\t\t\tnow=e[i^1].to;\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\n\tinline void lmy_forever()\n\t{\n\t\tm=read(),n=read(),k=read();\n\t\tfor(int i=1;i<=n;++i) w[i]=read();\n\t\tfor(int i=1;i<=k;++i) {x=read(); if(a[con]!=x) a[++con]=x;}\n\t\tk=con,s=0,t=k+1;\n\t\tfor(int i=1;i<=k;++i)\n\t\t{\n\t\t\tif(i!=k) add(i,i+1,0,INF);\n\t\t\tif(lst[a[i]]) add(lst[a[i]]+1,i,-w[a[i]],1);\n\t\t\tlst[a[i]]=i;\n\t\t\tsum+=w[a[i]];\n\t\t}\n\t\tadd(s,1,0,m-1),add(k,t,0,INF);\n\t\tAugment();\n\t\tprintf(\"%d\\n\",mincost+sum);\n\t\treturn;\n\t}\n}\n\nsigned main()\n{\n\tLgxTpre::lmy_forever();\n\treturn (0-0);\n}\n```",
        "postTime": 1679030157,
        "uid": 192648,
        "name": "My_Youth",
        "ccfLevel": 0,
        "title": "\u9898\u89e3\uff1a\u3010AT_utpc2011_8\u3011\u30ad\u30e3\u30c3\u30b7\u30e5\u6226\u7565"
    },
    {
        "content": "https://atcoder.jp/contests/utpc2011/tasks/utpc2011_8\n\n\u5f62\u5f0f\u5316\u9898\u610f\uff1a\u6709 $m$ \u4e2a\u76d2\u5b50\u548c $n$ \u4e2a\u5c0f\u7403\uff0c\u4e00\u5171 $k$ \u6b21\u64cd\u4f5c $a_i$\uff0c\u8868\u793a\u5c06\u7b2c $a_i$ \u4e2a\u5c0f\u7403\u653e\u5165\u76d2\u5b50\u4e2d\uff0c\u5e76\u4ea7\u751f $w_{a_i}$ \u7684\u4ee3\u4ef7\u3002\u5982\u679c\u76d2\u5b50\u6ee1\u4e86\uff0c\u5c31\u5fc5\u987b\u4ece\u67d0\u4e00\u4e2a\u76d2\u5b50\u4e2d\u62ff\u51fa\u53e6\u4e00\u4e2a\u5c0f\u7403\u5e76\u653e\u5165 $a_i$\uff0c\u603b\u4e4b\uff0c\u5fc5\u987b\u4fdd\u8bc1\u64cd\u4f5c $i$ \u6267\u884c\u7ed3\u675f\u540e\uff0c\u76d2\u5b50\u4e2d\u81f3\u5c11\u5b58\u5728 $1$ \u4e2a $a_i$ \u5c0f\u7403\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leq m\\leq 10,1\\leq n,k\\leq 10^4,1\\leq a_i\\leq n$\n\n---\n\n~~\u4e0d~~\u5bb9\u6613\u53d1\u73b0\u8fd9\u662f\u4e00\u9053\u8d39\u7528\u6d41\u3002\n\n\u6b63\u5411\u601d\u8003\u662f\u4e00\u4e2a\u8270\u96be\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u5047\u5b9a\u6240\u6709\u7684\u7403\u90fd\u9700\u8981\u88ab\u66ff\u6362\uff08\u4ea7\u751f\u4ee3\u4ef7\uff09\uff0c\u7136\u540e\u901a\u8fc7\u8d1f\u8d39\u7528\u7b97\u51fa\u6700\u591a\u80fd\u7701\u591a\u5c11\u3002\n\n\u5982\u679c\u5bf9\u4e8e\u4e00\u4e2a\u5c0f\u7403 $i$\uff0c\u6211\u4eec\u8981\u6c42\u5176\u4fdd\u7559\u81f3\u4e0b\u4e00\u6b21\u653e\u5165\uff0c\u5c31\u53ef\u4ee5\u8282\u7701 $w_i$ \u7684\u4ee3\u4ef7\uff0c\u4f46\u662f\u5728 $[s,t)$ \u64cd\u4f5c\u5185\u5c31\u4f1a\u6d88\u8017\u4e00\u4e2a\u76d2\u5b50\u3002\u8fd9\u79cd\u65b9\u5f0f\u6211\u4eec\u5728\u540c\u4e00\u65f6\u95f4\u4e00\u5171\u53ef\u4ee5\u505a $m-1$ \u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f\u5728\u540c\u4e00\u4e2a\u65f6\u95f4\u8282\u7701 $m-1$ \u79cd\u4ee3\u4ef7\u3002\n\n\u8003\u8651 $\\mathrm{dp}$\uff0c\u4f46\u662f\u5177\u6709\u540e\u6548\u6027\uff0c\u53cd\u5411 $\\mathrm{dp}$ \u80af\u5b9a\u4e5f\u4e0d\u884c\u3002\u8d2a\u5fc3\u5c31\u66f4\u4e0d\u7528\u60f3\u4e86\u3002\n\n\u4ee5\u76d2\u5b50\u6570\u4e3a\u6d41\u91cf\uff0c\u4ee3\u4ef7\u4e3a\u8d39\u7528\u5efa\u7acb\u8d39\u7528\u6d41\u3002\n\n\u6211\u4eec\u94a6\u5b9a\u6bcf\u4e00\u6b21\u90fd\u4f1a\u4ea7\u751f\u4ee3\u4ef7\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e00\u6b21\u90fd\u8981\u653e\u8fdb\u53bb\u3002\u4f46\u6211\u4eec\u6709 $m-1$ \u6b21\u673a\u4f1a\u53ef\u4ee5\u4f7f\u5f53\u524d\u64cd\u4f5c\u4e0d\u4ea7\u751f\u4ee3\u4ef7\uff0c\u4f46\u5728\u540c\u4e00\u65f6\u523b\u4e5f\u53ea\u6709 $m-1$ \u6b21\u3002\u800c\u5982\u679c\u6211\u4eec\u8ba9\u67d0\u4e00\u6b21\u64cd\u4f5c\u4e0d\u4ea7\u751f\u4ee3\u4ef7\uff0c\u5c31\u4f1a\u5728 $[lst_i,i]$ \u5185\u5360\u7528\u4e00\u4e2a\u76d2\u5b50\u3002\u5176\u4e2d $lst_i$ \u8868\u793a\u7b2c $i$ \u4e2a\u5c0f\u7403\u4e0a\u4e00\u6b21\u653e\u5165\u7684\u65f6\u95f4\u3002\n\n\u6240\u4ee5\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u64cd\u4f5c\uff0c\u6211\u4eec\u6709 $2$ \u79cd\u9009\u62e9\uff1a\n\n1. \u653e\u5165\uff0c\u5e76\u4ea7\u751f $w_{a_i}$ \u7684\u4ee3\u4ef7\uff1b\n2. \u4ece\u4e0a\u4e00\u6b21\u653e\u5165\u540e\u5c31\u4e0d\u79fb\u52a8\uff0c\u5e76\u8ba9\u5176\u5ef6\u7eed\u5230\u5f53\u524d\u64cd\u4f5c\uff0c\u4e0d\u4ea7\u751f\u4ee3\u4ef7\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u7b2c $2$ \u4e2a\u9009\u62e9\u5b9e\u9645\u4e0a\u5c31\u662f\u8981\u6c42\u6211\u4eec\u5728 $(lst_i,i]$ \u5185\u4e0d\u6267\u884c\u7b2c $1$ \u4e2a\u9009\u62e9\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8003\u8651\u6309\u4ee5\u4e0b\u65b9\u5f0f\u5efa\u56fe\uff1a\n\n* \u5efa\u7acb $1\\sim k$ \u7684\u64cd\u4f5c\u7ed3\u70b9\uff0c\u4ee5\u53ca\u6e90\u6c47\u70b9 $s,t$\uff1b\n* \u4ece $s$ \u5230 $1$ \u8fde\u8fb9\uff0c\u6d41\u91cf $m-1$\uff0c\u8d39\u7528 $0$\uff1b\n* \u4ece $k$ \u5230 $t$ \u8fde\u8fb9\uff0c\u6d41\u91cf $\\infty$\uff0c\u8d39\u7528 $0$\uff1b\n* \u4ece $i$ \u5230 $i+1$ \u8fde\u8fb9\uff0c\u6d41\u91cf $\\infty$\uff0c\u8d39\u7528 $0$\uff1b\n* \u4ece $lst_i+1$ \u5230 $i$ \u8fde\u8fb9\uff0c\u6d41\u91cf $1$\uff0c\u8d39\u7528 $-w_{a_i}$\u3002\n\n\u7b54\u6848\u662f $\\displaystyle\\sum_{i=1}^{k}w_{a_i}+ret$\uff0c\u5176\u4e2d $ret$ \u8868\u793a\u6700\u5c0f\u8d39\u7528\u3002\n\n\u56e0\u4e3a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u65f6\u523b\uff0c\u6211\u4eec\u90fd\u81f3\u5c11\u8981\u7559\u51fa\u4e00\u4e2a\u76d2\u5b50\u7ed9\u5f53\u524d\u64cd\u4f5c\u7684\u5c0f\u7403\uff0c\u6240\u4ee5\u6211\u4eec\u80fd\u591f\u7ef4\u62a4\u4fdd\u6301\u7684\u5c0f\u7403\u81f3\u591a\u6709 $m-1$ \u4e2a\uff0c\u603b\u6d41\u91cf\u4e3a $m-1$\u3002\u800c\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u662f\u4ece $lst_i+1$\uff0c\u5982\u679c\u8fd9\u4e2a\u5c0f\u7403\u5728\u4e0b\u4e00\u6b21\u653e\u5165\u524d\u88ab\u62ff\u51fa\u6765\u4e86\uff0c\u90a3\u65e0\u8bba\u662f\u5728 $\\forall i\\in(lst_i,i)$ \u88ab\u62ff\u51fa\u5bf9\u7ed3\u679c\u7684\u5f71\u54cd\u662f\u4e00\u6837\u7684\uff0c\u6211\u4eec\u90fd\u5fc5\u987b\u8981\u518d\u6b21\u653e\u5165\uff0c\u6240\u4ee5\u6211\u4eec\u94a6\u5b9a\u5728 $(lst_i,i]$ \u5185\u4e0d\u88ab\u62ff\u51fa\uff0c\u5c31\u4f1a\u4ea7\u751f $-w_{a_i}$ \u7684\u4ee3\u4ef7\u3002\u800c\u5728 $lst_i$ \u65f6\uff0c\u6211\u4eec\u662f\u5fc5\u987b\u4f1a\u6267\u884c\u7b2c\u4e00\u4e2a\u9009\u62e9\u7684\u3002\n\n\u9644\u4e0a[\u5b98\u65b9\u9898\u89e3](https://www.utpc.jp/2011/slides/cache.pdf)\u3002\u4ee5\u53ca\u611f\u8c22\u4e0e\u6211\u4e00\u540c\u63a2\u7a76\u7684 [$\\text{@LgxTpre}$](https://www.luogu.com.cn/user/66709)\u3002\n\n\u6700\u540e\u6574\u51e0\u4e2a\u6ce8\u610f\u4e8b\u9879\uff1a\n\n* $\\text{AT}$ \u4e0a\u53e4\u9898\uff0c\u8bb0\u5f97\u7b54\u6848\u6700\u540e\u6362\u884c\u3002\n* \u4e0d\u5efa\u8bae\u5f00 `long long`\uff0c\u597d\u50cf\u4f1a\u8d85\u65f6\uff0c\u8fd9\u4e2a\u6570\u636e\u8303\u56f4 `int` \u662f\u53ef\u4ee5\u8fc7\u7684\u3002\n* \u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u5b58\u5728 $lst_i=i-1$ \u7684\u60c5\u51b5\uff0c\u5c31\u4f1a\u4f7f\u5f97\u56fe\u4e2d\u51fa\u73b0\u4e00\u4e2a\u8d1f\u73af\uff0c\u7136\u540e\u8981\u4e48\u7b54\u6848\u4f1a\u53d8\u5c0f\uff0c\u8981\u4e48\u4f1a\u6b7b\u5faa\u73af\u3002\u6240\u4ee5\u6211\u4eec\u5728\u5efa\u56fe\u4e4b\u524d\u8981\u8fdb\u884c\u4e00\u6b21\u53bb\u91cd\u5904\u7406\uff0c\u628a\u6240\u6709 $lst_i=i-1$ \u7684\u60c5\u51b5\u5254\u9664\u6389\u3002\n\n``` c++\n// ----- Eternally question-----\n// Problem: H - \u30ad\u30e3\u30c3\u30b7\u30e5\u6226\u7565\n// Contest: AtCoder - UTPC 2011\n// URL: https://atcoder.jp/contests/utpc2011/tasks/utpc2011_8\n// Memory Limit: 292 MB\n// Time Limit: 2000 ms\n// Written by: Eternity\n// Time: 2023-03-16 14:37:28\n// ----- Endless solution-------\n\n#include<bits/stdc++.h>\n#define re register\nconst int MAXM=12,MAXN=1e4+10,MAXK=1e4+10,MAXV=1e4+10,MAXE=1e5+10;\nconst int INF=0x3f3f3f3f;\nint M,N,K,S,T;\nint Wgt[MAXN];\nstruct Net\n{ int next,to,val,cost; }Edge[MAXE<<1];\nint Head[MAXV],Cur[MAXV],Total=1;\ninline void addEdge(int u,int v,int w,int c)\n{\n    Edge[++Total]=(Net){Head[u],v,w,c};Head[u]=Total;\n    Edge[++Total]=(Net){Head[v],u,0,-c};Head[v]=Total;\n}\nint Dist[MAXV],ret;\nbool Vis[MAXV];\ninline bool Spfa(int s,int t)\n{\n\tfor(int i=S;i<=T;++i) Dist[i]=INF;\n\tfor(int i=S;i<=T;++i) Cur[i]=Head[i];\n    std::queue<int>Q;\n    Q.push(s),Dist[s]=0,Vis[s]=1;\n    while(!Q.empty())\n    {\n        int u=Q.front();Q.pop();\n        Vis[u]=0;\n        for(int e=Head[u];e;e=Edge[e].next)\n        {\n            int v=Edge[e].to;\n            if(Edge[e].val&&Dist[v]>Dist[u]+Edge[e].cost)\n            {\n                Dist[v]=Dist[u]+Edge[e].cost;\n            \tif(!Vis[v]) Q.push(v),Vis[v]=1;\n            }\n        }\n    }\n    return Dist[t]!=INF;\n}\nint Dfs(int x,int inf)\n{\n    if(x==T) return inf;\n    Vis[x]=1;\n    int flow=0;\n    for(int e=Cur[x],v;e&&flow<inf;e=Edge[e].next)\n    {\n        Cur[x]=e,v=Edge[e].to;\n        if(!Vis[v]&&Edge[e].val&&Dist[v]==Dist[x]+Edge[e].cost)\n        {\n            int k=Dfs(v,std::min(Edge[e].val,inf-flow));\n            if(k)\n            {\n                ret+=k*Edge[e].cost;\n                Edge[e].val-=k,Edge[e^1].val+=k,flow+=k;\n            }\n        }\n    }\n    Vis[x]=0;\n    return flow;\n}\ninline int SSP()\n{\n    int res=0,flow;\n    while(Spfa(S,T)) while(flow=Dfs(S,INF)) res+=flow;\n    return res;\n}\nint Sum,Lst[MAXN],Id[MAXN],Idx;\nsigned main()\n{\n\t// freopen(\".in\",\"r\",stdin);\n\t// freopen(\".out\",\"w\",stdout);\n\tscanf(\"%d%d%d\",&M,&N,&K);S=0;\n\tfor(int i=1;i<=N;++i) scanf(\"%d\",&Wgt[i]);\n\tstd::memset(Lst,-1,sizeof(Lst));\n\tfor(int i=1,x;i<=K;++i)\n\t{\n\t\tscanf(\"%d\",&x);\n\t\tif(Id[Idx]!=x) Id[++Idx]=x;\n\t}\n\tK=Idx,T=Idx+1;\n\tfor(int i=1;i<=K;++i)\n\t{\n\t\tif(~Lst[Id[i]]) addEdge(Lst[Id[i]]+1,i,1,-Wgt[Id[i]]);\n\t\tLst[Id[i]]=i,Sum+=Wgt[Id[i]];\n\t}\n\taddEdge(S,1,M-1,0);\n\tfor(int i=1;i<=K;++i) addEdge(i,i+1,INF,0);\n\tSSP();\n\tprintf(\"%d\\n\",Sum+ret);\n\treturn 0;\n}\n/*\n\n*/\n```",
        "postTime": 1679011505,
        "uid": 444040,
        "name": "_Eternal_",
        "ccfLevel": 0,
        "title": "AT_utpc2011_8 \u30ad\u30e3\u30c3\u30b7\u30e5\u6226\u7565 \u9898\u89e3"
    }
]
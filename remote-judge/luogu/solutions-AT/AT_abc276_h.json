[
    {
        "content": "\u6ca1\u6709\u9898\u89e3\uff0c\u6240\u4ee5\u6765\u5199\u4e00\u7bc7\u3002\n\n## Description\n\n\u6784\u9020\u4e00\u4e2a $N\\times N$ \u7684\u77e9\u9635 $A$\uff0c\u5176\u4e2d $A_{i,j}\\in \\{0,1,2\\}$\uff0c\u8981\u6c42\u540c\u65f6\u6ee1\u8db3 $Q$ \u6761\u9650\u5236\u3002  \n\u6bcf\u6761\u9650\u5236\u5f62\u5982\uff1a\u7ed9\u5b9a $a,b,c,d,e$\uff0c\u8981\u6c42 $A$ \u6ee1\u8db3 $\\prod\\limits_{i=a}^b\\prod\\limits_{j=c}^d A_{i,j} \\equiv e\\pmod 3$\u3002\n\n## Solution\n\n\u4e3a\u8d34\u5408\u539f\u9898\uff0c\u8bbe $(a,b,c,d)$ \u8868\u793a\u5de6\u4e0a\u89d2\u4e3a $(a,c)$\uff0c\u53f3\u4e0b\u89d2\u4e3a $(b,d)$ \u7684\u77e9\u5f62\u3002\n\n\u6839\u636e\u8fde\u4e58\u7684\u6027\u8d28\uff0c\u82e5 $e_i$ \u4e0d\u4e3a $0$\uff0c\u5219 $(a_i,b_i,c_i,d_i)$ \u4e2d\u4efb\u610f $A_{i,j}$ \u4e0d\u80fd\u4e3a $0$\u3002  \n\u800c\u5bf9\u4e8e $e_i=0$\uff0c\u8981\u6c42 $(a,b,c,d)$ \u4e2d\u81f3\u5c11\u4e00\u4e2a\u662f $0$\u3002\u90a3\u4e48\u5bf9\u4e8e\u4e0d\u88ab $e_i\\in\\{1,2\\}$ \u9650\u5236\u7684\u70b9\uff0c\u663e\u7136\u5f3a\u5236\u5b83\u4eec\u90fd\u4e3a $0$ \u4e00\u5b9a\u4e0d\u52a3\u3002\u5982\u679c\u8fd9\u79cd\u65b9\u5f0f\u4f9d\u7136\u4e0d\u80fd\u6ee1\u8db3\u6240\u6709 $e_i=0$ \u7684\u9650\u5236\uff0c\u5219\u65e0\u89e3\u3002\u4f7f\u7528\u4e8c\u7ef4\u5dee\u5206\u53ca\u524d\u7f00\u548c\u4e0d\u96be\u5b9e\u73b0\u3002\n\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u786e\u5b9a\u54ea\u4e9b\u4f4d\u7f6e\u4e3a $0$\uff0c\u53ea\u9700\u8981\u8003\u8651\u4e0d\u4e3a $0$ \u7684\u4f4d\u7f6e\u4e0e $e_i\\in\\{1,2\\}$ \u7684\u9650\u5236\u3002\u800c $A_{i,j}=1$ \u5bf9\u77e9\u9635\u79ef\u540c\u6837\u6ca1\u6709\u5f71\u54cd\uff0c\u77e9\u9635\u79ef\u6a21 $3$ \u7684\u503c\u53ea\u4e0e $A_{i,j}=2$ \u7684\u6570\u91cf\u6709\u5173\u3002\n\n\u7b80\u5355\u627e\u89c4\u5f8b\uff08\uff1f\uff09\u53ef\u4ee5\u53d1\u73b0\uff0c$2$ \u7684\u5947\u6570\u6b21\u5e42 $\\bmod 3$ \u7684\u503c\u4e3a $2$\uff0c\u5076\u6570\u6b21\u5e42 $\\bmod 3$ \u7684\u503c\u4e3a $1$\u3002  \n\n\u8003\u8651\u628a\u6bcf\u4e2a $A_{i,j}$ \u8bbe\u4e3a\u672a\u77e5\u6570\u89e3\u65b9\u7a0b\u3002  \n\u4ee4 $x_{i,j}$ \u7684\u503c $0,1$ \u5bf9\u5e94 $A_{i,j}$ \u7684 ${1,2}$\uff0c\u90a3\u4e48\u4f1a\u5f97\u5230 $Q$ \u7ec4\u65b9\u7a0b\uff0c\u5f62\u5982\uff1a\n $$x_{a,c}\\oplus x_{a,c+1}\\oplus\\dots\\oplus x_{b,d}=[e_i=1]$$\n\n\u672a\u77e5\u6570\u4e2a\u6570\u4e3a $n^2$\uff0c\u76f4\u63a5\u9ad8\u65af\u6d88\u5143\u590d\u6742\u5ea6\u4e0d\u80fd\u63a5\u53d7\u3002  \n\u91cd\u5b9a\u4e49 $x_{a,b}=\\sum\\limits_{i=1}^a\\sum\\limits_{j=1}^b A_{i,j} \\pmod 2$\uff0c\u5219\u6bcf\u4e2a\u65b9\u7a0b\u53ef\u4ee5\u5199\u6210\uff1a\n$$x_{b,d}\\oplus x_{a-1,c-1}\\oplus x_{a-1,d}\\oplus x_{b,c-1}=[e_i=1]$$\n\u8fd9\u6837\u6bcf\u6b21\u8be2\u95ee\u6700\u591a\u4f1a\u4ea7\u751f $4$ \u4e2a\u672a\u77e5\u6570\uff0c\u672a\u77e5\u6570\u4e2a\u6570\u964d\u4e3a $4Q$\u3002  \n\u53d1\u73b0\u7cfb\u6570\u53ea\u6709 $0,1$\uff0c\u4f7f\u7528 bitset \u4f18\u5316\uff0c\u590d\u6742\u5ea6\u964d\u4e3a $O(\\frac{Q^3}{w})$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n## Code\n\n\u901a\u8fc7\u7814\u8bfb\u90e8\u5206\u63d0\u4ea4\u8bb0\u5f55\u624d\u5f97\u4ee5\u5927\u81f4\u7406\u89e3\u505a\u6cd5\uff0c\u4ee3\u7801\u53ef\u80fd\u6709\u53c2\u8003\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define il inline\nusing namespace std;\nil int read()\n{\n    int xr=0,F=1; char cr;\n    while(cr=getchar(),cr<'0'||cr>'9') if(cr=='-') F=-1;\n    while(cr>='0'&&cr<='9') \n        xr=(xr<<3)+(xr<<1)+(cr^48),cr=getchar();\n    return xr*F;\n}\nconst int N=2005;\nint n,q;\nstruct node{\n\tint a,b,c,d,e;\n};\nvector<node> t;\nbitset<(N<<2)> now,a[N<<2];\nint id[N][N],s[N][N],tot;\nil void add(int x,int y) \n{\n\tif(!x||!y) return;\n\tif(!id[x][y]) id[x][y]=++tot;\n\tnow[id[x][y]]=1;\n}\nbool flag;\nil void ins()\n{\n\tfor(int i=1;i<=tot;i++)\n\t{\n\t\tif(!now[i]) continue;\n\t\tif(!a[i][i]) {a[i]=now;return;}\n\t\tnow^=a[i];\n\t}\n\tif(now[0]) {printf(\"No\\n\");flag=1;}\n}\nint ans[N][N];\nint main()\n{\n\tn=read(),q=read();\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tint a=read(),b=read(),c=read(),d=read(),e=read();\n\t\tif(!e) t.push_back({a,b,c,d,e});\n\t\telse\n\t\t{\n\t\t\ts[a][c]++,s[b+1][d+1]++,s[b+1][c]--,s[a][d+1]--;\n\t\t\tnow.reset();\n\t\t\tadd(a-1,c-1),add(b,d),add(a-1,d),add(b,c-1);\n\t\t\tif(e==2) now[0]=1; ins();\n\t\t\tif(flag) return 0;\n\t\t}\n\t}\n\t//for(int i=1;i<=tot;i++,cout<<endl) for(int j=1;j<=n+1;j++) cout<<a[i][j]<<\" \";\n\t\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\ts[i][j]=s[i-1][j]+s[i][j-1]-s[i-1][j-1]+s[i][j];\n\tfor(int i=1;i<=n;i++) for(int j=1;j<=n;j++) s[i][j]=!s[i][j];\n\tfor(int i=1;i<=n;i++) for(int j=1;j<=n;j++) s[i][j]=s[i][j-1]+s[i-1][j]-s[i-1][j-1]+s[i][j];\n\tfor(auto u:t)\n\t\tif(s[u.b][u.d]-s[u.b][u.c-1]-s[u.a-1][u.d]+s[u.a-1][u.c-1]==0) {printf(\"No\\n\");return 0;}\n\t\n\t\n\tnow.reset();\n\tfor(int i=tot;i;i--)\n\t{\n\t\tif(!a[i][i]) continue;\n\t\tnow[i]=((now&a[i]).count()&1)^(a[i][0]);\n\t}\n\tfor(int i=1;i<=n;i++) for(int j=1;j<=n;j++) if(id[i][j]) ans[i][j]=now[id[i][j]];\n\tfor(int i=n;i;i--) for(int j=n;j;j--) \n\t\tans[i][j]=ans[i][j]^ans[i-1][j]^ans[i][j-1]^ans[i-1][j-1];\n\t\n\tprintf(\"Yes\\n\");\n\tfor(int i=1;i<=n;i++,printf(\"\\n\"))\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tif(s[i][j]-s[i-1][j]-s[i][j-1]+s[i-1][j-1]) printf(\"0 \");\n\t\t\telse if(ans[i][j]) printf(\"2 \");\n\t\t\telse printf(\"1 \");\n\t\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1683035837,
        "uid": 234074,
        "name": "\u6a31\u96ea\u55b5",
        "ccfLevel": 7,
        "title": "[ABC276Ex] Construct a Matrix"
    }
]
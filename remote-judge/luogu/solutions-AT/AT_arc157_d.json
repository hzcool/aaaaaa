[
    {
        "content": "\u6211\u4eec\u53d1\u73b0\u9898\u76ee\u7684\u9650\u5236\u770b\u8d77\u6765\u975e\u5e38\u5f3a\uff0c\u5148\u8003\u8651\u4e00\u4e9b\u5fc5\u8981\u6761\u4ef6\u3002\n\n\u9996\u5148\u8bbe `Y` \u7684\u4e2a\u6570\u4e3a $k_1$\uff0c\u5bb9\u6613\u5f97\u5230 $2AB=k_1$\uff0c$A$ \u8868\u793a\u884c\u5272\u4e86\u51e0\u5200\uff0c$B$ \u540c\u7406\u3002\n\n\u7b2c\u4e8c\u4e2a\u5fc5\u8981\u6761\u4ef6\u662f\u53ea\u8003\u8651\u884c\u7684\u5200\uff0c\u5206\u6210\u7684\u6bcf\u4e00\u5757 `Y` \u7684\u4e2a\u6570\u90fd\u662f $2B$\uff0c\u5217\u540c\u7406\u3002\n\n\u7136\u540e\u6211\u4eec\u4f1a\u5bf9\u6bcf\u4e00\u5200\u786e\u5b9a\u4e00\u4e2a\u8303\u56f4\uff0c\u4f46\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a\u6761\u4ef6\u662f\u6bcf\u4e00\u5757\u6070\u597d $2$ \u4e2a `Y`\u3002\n\n\u4e0d\u8fc7\u6211\u4eec\u53c8\u53d1\u73b0\u65e0\u8bba\u5200\u5728\u54ea\u91cc\u5272\uff0c\u6bcf\u4e00\u5c0f\u5757 `Y` \u7684\u4e2a\u6570\u90fd\u662f\u56fa\u5b9a\u7684\u3002\n\n\u5224\u65ad\uff0c\u7136\u540e\u4e58\u6cd5\u539f\u7406\u8ba1\u6570\u5373\u53ef\u3002",
        "postTime": 1678369462,
        "uid": 359952,
        "name": "_lbw_",
        "ccfLevel": 6,
        "title": "\u300cARC157D\u300dYY Garden \u9898\u89e3"
    },
    {
        "content": "\u7b80\u8981\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u5927\u5c0f\u4e3a $n\\times m$ \u7684 `XY` \u77e9\u9635\uff0c\u7136\u540e\u4f60\u53ef\u4ee5\u5728\u77e9\u9635\u7684\u76f8\u90bb\u4e24\u884c/\u4e24\u5217\u4e4b\u95f4\u5207\u4e00\u5200\uff0c\u95ee\u6709\u591a\u5c11\u79cd\u5207\u6cd5\u53ef\u4ee5\u5c06\u77e9\u9635\u5206\u4e3a\u82e5\u5e72\u5757\uff0c\u4e14\u6bcf\u4e00\u5757\u90fd\u6070\u597d\u5305\u542b\u4e24\u4e2a `Y`\uff0c\u5bf9 $998244353$ \u53d6\u6a21\u3002$n,m\\le 2000$\u3002\n\n\u5982\u679c\u4e00\u5171\u6709\u5947\u6570\u4e2a `Y`\uff0c\u4e00\u5b9a\u65e0\u89e3\u3002\n\n\u5426\u5219\u5047\u8bbe\u4e00\u5171\u6709 $S$ \u4e2a `Y`\uff0c\u90a3\u4e48\u4e00\u5171\u5c31\u8981\u5206\u4e3a $\\frac S 2$ \u5757\u3002\u7136\u540e\u6211\u4eec\u679a\u4e3e\u6a2a\u7ad6\u5404\u780d\u51e0\u5200\uff0c\u5047\u8bbe\u6a2a\u7740\u780d $p$ \u5200\uff0c\u7ad6\u7740\u780d $q$ \u5200\uff0c\u63a5\u7740\u6211\u4eec\u8981\u5224\u65ad\u8fd9\u6837\u780d\u662f\u5426\u6709\u89e3\uff0c\u4ee5\u53ca\u5982\u679c\u6709\u89e3\uff0c\u4e00\u5171\u6709\u591a\u5c11\u780d\u6cd5\u3002\n\n\u8bb0 $S1_i$ \u4e3a\u524d $i$ \u884c\u4e00\u5171\u6709\u591a\u5c11\u4e2a `Y`\uff0c$S2_i$ \u4e3a\u524d $i$ \u5217\u4e00\u5171\u6709\u591a\u5c11\u4e2a `Y`\u3002\u5982\u679c\u8981\u6709\u89e3\uff0c\u6a2a\u7740\u780d\u5b8c\u4ee5\u540e\u6bcf\u4e00\u6bb5\u90fd\u8981\u6709\u6070\u597d $2q$ \u4e2a `Y`\uff0c\u7ad6\u7740\u6bcf\u4e00\u6bb5\u90fd\u8981\u6709\u6070\u597d $2p$ \u4e2a `Y`\u3002\u4e8e\u662f\u6211\u4eec\u770b\u4e00\u4e0b $S1$ \u662f\u5426\u5305\u542b\u6240\u6709 $2q$ \u7684\u500d\u6570\uff0c$S2$ \u662f\u5426\u5305\u542b\u6240\u6709 $2p$ \u7684\u500d\u6570\u3002\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u7ec4\u89e3\uff0c\u7136\u540e\u6211\u4eec\u7528\u4e8c\u7ef4\u524d\u7f00\u548c check \u4e00\u4e0b\u662f\u5426\u6bcf\u4e2a\u5757\u90fd\u662f\u4e24\u4e2a `Y`\u3002\u63a5\u7740\u6211\u4eec\u7edf\u8ba1\u4e00\u4e0b\u6bcf\u4e2a\u500d\u6570\u6709\u51e0\u4e2a\uff0c\u7136\u540e\u4e58\u8d77\u6765\u5c31\u662f\u7b54\u6848\u3002\n\n\u8fd9\u6837\u7b97\u4e00\u7ec4 $(p,q)$ \u7684\u65f6\u95f4\u662f $O(pq)=O(S)$ \u7684\uff0c\u7136\u540e\u53ef\u4ee5\u53d1\u73b0 $(p,q)$ \u7684\u5bf9\u6570\u4e0d\u4f1a\u5f88\u591a\uff0c\u597d\u50cf\u6700\u591a\u7684\u53ea\u6709\u51e0\u5341\u4e2a\uff0c\u7136\u540e\u5c31\u8fc7\u4e86\u3002\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=2005,mod=998244353;\ninline int add(int a,int b){return a+b>=mod?a+b-mod:a+b;}\ninline int mul(int a,int b){return 1ll*a*b%mod;}\nint n,m,tot,ans;\nchar s[N][N];\nint s1[N],s2[N];\nint g[N],f1[N],f2[N];\nint p1[N],p2[N];\nint sum[N][N];\ninline int S(int x1,int y1,int x2,int y2){\n\treturn sum[x2][y2]-sum[x1][y2]-sum[x2][y1]+sum[x1][y1];\n}\nint cnt1[N],cnt2[N];\nvoid solve(int k1){\n\tint k2=tot*2/k1,c1=0,c2=0;\n\tfor(int i=1;i<=n;i++)if(s1[i]!=s1[i-1]&&s1[i]%k1==0)p1[++c1]=i;\n\tfor(int i=1;i<=m;i++)if(s2[i]!=s2[i-1]&&s2[i]%k2==0)p2[++c2]=i;\n\tif(c1<<1!=k2||c2<<1!=k1)return;\n\tfor(int i=1;i<=c1;i++)\n\t\tfor(int j=1;j<=c2;j++)\n\t\t\tif(S(p1[i-1],p2[j-1],p1[i],p2[j])!=2)return;\n\tfor(int i=1;i<=c1;i++)cnt1[i]=0;\n\tfor(int i=1;i<=c2;i++)cnt2[i]=0;\n\tfor(int i=1;i<=n;i++)if(s1[i]%k1==0)cnt1[s1[i]/k1]++;\n\tfor(int i=1;i<=m;i++)if(s2[i]%k2==0)cnt2[s2[i]/k2]++;\n\tint res=1;\n\tfor(int i=1;i<c1;i++)res=mul(res,cnt1[i]);\n\tfor(int i=1;i<c2;i++)res=mul(res,cnt2[i]);\n\tans=add(ans,res);\n}\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%s\",s[i]+1);\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tsum[i][j]=sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1];\n\t\t\tif(s[i][j]=='Y')s1[i]++,s2[j]++,sum[i][j]++;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)s1[i]+=s1[i-1];\n\tfor(int i=1;i<=m;i++)s2[i]+=s2[i-1];\n\ttot=s1[n];\n\tif(tot&1)return cout<<0,0;\n\tfor(int i=2;i<=n*m;i+=2)if(tot%i==0)solve(i);\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1678197560,
        "uid": 211518,
        "name": "william555",
        "ccfLevel": 9,
        "title": "\u3010\u9898\u89e3\u3011[ARC157D] YY Garden"
    }
]
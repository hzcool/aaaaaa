[
    {
        "content": "~~\u6709\u4e2a\u5730\u65b9\u5199\u9519\u4e86\uff0c\u6539\u4e00\u4e0b~~\n## problem\nSoso \u6709\u4e00\u4e2a\u65e0\u7a77\u5e8f\u5217 $\\{X_i\\}$ \u5b9a\u4e49\u5982\u4e0b\uff1a\n\n$$X_i=\\begin{cases}\nS,&(i=0)\\\\\n(A\\cdot X_{i-1}+B)\\bmod P,&(i\\geq 1)\n\\end{cases}$$\n\n\u5176\u4e2d $0\\leq S,A,B<P\\leq 10^9$ \u5747\u4e3a\u5e38\u6570\uff0c$P\\in\\textrm{Prime}$\u3002\u73b0\u5728\u6c42\u6700\u5c0f\u7684 $i$ \u4f7f\u5f97 $X_i=G$\u3002\u591a\u6d4b $100$ \u7ec4\u6570\u636e\u3002\n\n## solution\n### general\n\u601d\u8def\uff1a\u5c06\u5f0f\u5b50\u5316\u4e3a\u53ea\u4e0e $k$ \u6709\u5173\u7684\u4e1c\u897f\u3002\n$$\\begin{aligned}\nX_k&=SA^k+BA^{k-1}+BA^{k-2}+\\cdots+BA^0\\\\\n&=SA^k+B(A^{k-1}+A^{k-2}+\\cdots+A^0)\\\\\n&=SA^k+B\\frac{A^k-1}{A-1}\\\\\n&=SA^k+\\frac{B}{A-1}A^k-\\frac{B}{A-1}\\\\\n&=(S+\\frac{B}{A-1})A^k-\\frac{B}{A-1}=G.\n\\end{aligned}$$\n\n\u4ee4 $C=\\frac{B}{A-1}$\uff0c\u6b32\u6c42 $A^k\\equiv \\frac{G+C}{S+C}\\pmod P$\uff0c\u56e0\u4e3a $P$ \u4e3a\u8d28\u6570\uff0c\u6545\u4f7f\u7528 [BSGS](https://www.luogu.com.cn/problem/solution/P3846) \u6c42\u5f97\u6700\u5c0f\u7684 $k$\u3002\n\n### special judge\n- $S=G\\Rightarrow0$\u3002\n- $A=0$\uff1acheck if $B=G$ or $S=G$\u3002\n- $A=1$\uff1a$X_n=S+Bn\\Rightarrow n=\\frac{G-S}{B}$\u3002\n- $S=B=0$\uff1a$X_n=0$\u3002\n\n## code\n```cpp\n#include <map>\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\ntypedef long long LL;\nLL qpow(LL a,LL b,int p){LL r=1;for(;b;b>>=1,a=a*a%p) if(b&1) r=r*a%p;return r;}\nLL inv(LL a,int p){return qpow(a,p-2,p);}\nLL bsgs(LL x,LL y,int p){\n//\tfprintf(stderr,\"bsgs(%lld,%lld,%d)\\n\",x,y,p);\n\tif(x%=p,y%=p,y==1||x==y) return y!=1;\n\t//x^(am-b)=(x^m)^a/x^b=y =>(x^m)^a=y*x^b\n\tint m=ceil(sqrt(p));\n\tmap<int,int> mp;\n\tfor(int i=m;i>=1;i--) mp[qpow(x,i*m,p)]=i*m;\n\tint res=1e9;\n\tfor(int i=0;i<=m;i++){\n\t\tif(mp.count(y*qpow(x,i,p)%p)) res=min(res,mp[y*qpow(x,i,p)%p]-i);\n\t}\n\treturn res==1e9?-1:res;\n}\nLL p,a,b,s,g;\nint mian(){\n\tif(s==g) puts(\"0\");\n\telse if(a==0) printf(\"%lld\\n\",b==g?1ll:-1ll);\n\telse if(a==1){\n\t\tif(!b) puts(\"-1\");\n\t\telse printf(\"%lld\\n\",(g-s+p)%p*inv(b,p)%p);\n\t}else{\n\t\tLL cmb=b*inv(a-1,p)%p;\n\t\tprintf(\"%lld\\n\",bsgs(a,(g+cmb)%p*inv(s+cmb,p)%p,p));\n\t}\n\treturn 0;\n}\nint main(){\n\tfor(scanf(\"%*d\");~scanf(\"%lld%lld%lld%lld%lld\",&p,&a,&b,&s,&g);mian());\n\treturn 0;\n}\n```\n",
        "postTime": 1666245534,
        "uid": 509229,
        "name": "yukimianyan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 ABC270G\u3010Sequence in mod P\u3011"
    },
    {
        "content": "## \u601d\u8def\n\n\u9996\u5148\u5904\u7406 $i = 0$ \u7684\u60c5\u51b5\uff1a\n\n$$\nS \\equiv G \\pmod P\n$$\n\n\u76f4\u63a5\u5224\u65ad\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u5904\u7406 $i \\geq 1$ \u7684\u60c5\u51b5\u3002\n\n\u5f53 $A \\equiv 0 \\pmod p$ \u65f6\uff1a\n\n$$\nB \\equiv G \\pmod P\n$$\n\n\u76f4\u63a5\u5224\u65ad\u5373\u53ef\u3002\n\n\u5f53 $A \\equiv 1 \\pmod p$ \u65f6\uff1a\n\n$$\nS + i B \\equiv G \\pmod P\n$$\n$$\ni \\equiv \\frac { G - S } { B } \\pmod P\n$$\n\n\u7528\u4e58\u6cd5\u9006\u5143\u6c42\u89e3\u5373\u53ef\u3002\u82e5 $B \\equiv 0 \\pmod P$\uff0c\u5219\u65e0\u89e3\u3002\n\n\u5f53 $A > 1 \\pmod p$ \u65f6\uff1a\n\n$$\nX _ i \\equiv G \\pmod P\n$$\n$$\nA ^ i S + \\sum _ { j = 0 } ^ { i - 1 } A ^ j B \\equiv G \\pmod P\n$$\n$$\nA ^ i S + \\frac { ( A ^ i - 1 ) B } { A - 1 } \\equiv G \\pmod P\n$$\n$$\nA ^ i \\equiv \\frac { A G - G + B } { A S - S + B } \\pmod P\n$$\n\n\u7528\u4e58\u6cd5\u9006\u5143\u548c $\\texttt {BSGS}$ \u7b97\u6cd5\u6c42\u89e3\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#pragma GCC optimize(\"Ofast\")\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nint T, P, A, B, S, G;\nint Power(int a, int b)\n{\n\tint res = 1;\n\twhile(b){\n\t\tif(b & 1) res = res * a % P;\n\t\ta = a * a % P;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\nint Inv(int a)\n{\n\treturn Power(a, P - 2);\n}\nint BSGS(int a, int b)\n{\n\tif(b % P == 1) return 0;\n\tint m = ceil(sqrt(P)), x = 1, y = 1;\n\tunordered_map < int, int > h;\n\tfor(int i = 1; i <= m; i ++){\n\t\tx = x * a % P;\n\t\th[b * x % P] = i;\n\t}\n\tfor(int i = 1; i <= m; i ++){\n\t\ty = y * x % P;\n\t\tif(h[y]) return m * i - h[y];\n\t}\n\treturn - 1;\n}\nsigned main()\n{\n\tscanf(\"%lld\", & T);\n\twhile(T --){\n\t\tscanf(\"%lld%lld%lld%lld%lld\", & P, & A, & B, & S, & G);\n\t\tA %= P, B %= P, S %= P, G %= P;\n\t\tif(S == G) printf(\"%d\\n\", 0);\n\t\telse{\n\t\t\tif(A == 0) printf(\"%lld\\n\", B == G ? 1ll : - 1ll);\n\t\t\tif(A == 1) printf(\"%lld\\n\", B == 0 ? - 1ll : (G - S + P) * Inv(B) % P);\n\t\t\tif(A > 1) printf(\"%lld\\n\", BSGS(A, (A * G % P - G + B + P) * Inv(A * S % P - S + B + P) % P));\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n2022.12.13",
        "postTime": 1670928814,
        "uid": 232838,
        "name": "huangkx",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT_abc270_g Sequence in mod P"
    },
    {
        "content": "\u60f3\u4e0d\u5230\u4ec0\u4e48\u597d\u7684\u505a\u6cd5\uff0c\u5c31\u5148\u8003\u8651\u5c06\u5f0f\u5b50\u5c55\u5f00\uff1a\n$$\n\\begin{aligned}\nX_i\n&=(AX_{i-1}+B)\\bmod P\\\\\n&=(A^2X_{i-2}+AB+B)\\bmod P\\\\\n&=(A^3X_{i-3}+A^2B+AB+B)\\bmod P\\\\\n&=\\dots\\\\\n&=(A^iS+B(A^{i-1}+\\dots +1))\\bmod P\\\\\n&=(A^iS+B\\frac{A^i-1}{A-1})\\bmod P\\\\\n&=G\n\\end{aligned}\n$$\n \u6211\u4eec\u628a\u6240\u6709\u548c $A_i$ \u6709\u5173\u7684\u9879\u5168\u90e8\u653e\u5230\u53f3\u8fb9\uff0c\u5269\u4e0b\u7684\u6254\u5230\u5de6\u8fb9\uff0c\u5c06\u7b49\u5f0f\u4e24\u8fb9\u540c\u65f6\u4e58\u4e0a $A-1$ \u518d\u52a0 $B$\uff0c\u5219\u6709\uff1a\n$$\nAG-G+B=(AS-S+B)A^i\\ (\\bmod P)\n$$\n\u5de6\u8fb9\u7684\u5e38\u6570\u770b\u4f5c $x$\uff0c\u53f3\u8fb9\u7684\u5e38\u6570\u770b\u4f5c $y$\uff0c\u5219\u6709\uff1a\n$$\nyA^i=x\\ (\\bmod P)\n$$\n\u4e5f\u5c31\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u9ad8\u6b21\u540c\u4f59\u65b9\u7a0b\u3002\u6211\u4eec\u53ef\u4ee5\u91c7\u7528 BSGS \u7b97\u6cd5\u6c42\u89e3\u3002\n\n\u54c8\u5e0c\u7528 map \u5b9e\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(T\\sqrt{P}\\log \\sqrt{P})$\u3002\n\n\u9700\u8981\u6ce8\u610f\u5f53 $A=1$ \u7684\u65f6\u5019\uff0c\u4e0a\u9762\u7684\u5f0f\u5b50\u662f\u4e0d\u6210\u7acb\u7684\uff0c\u6211\u4eec\u4f1a\u5f97\u5230\uff1a\n$$\nX_i=S+iB=G\\ (\\bmod P)\n$$\n\u6b64\u65f6 $i=\\frac{G-S}{B}$\uff0c\u4f5c\u4e2a\u9006\u5143\u5373\u53ef\u3002\u540c\u6837\u6b64\u65f6\u4e5f\u9700\u8981\u5224\u65ad $B$ \u662f\u5426\u4e3a $0$\uff0c\u5982\u679c\u4e3a $0$ \u5219\u9700\u8981\u8fdb\u4e00\u6b65\u7279\u5224\u3002\n\n\u9664\u6b64\u4e4b\u5916\u8fd8\u9700\u8981\u7279\u5224\u4e00\u4e0b $X_0=S$ \u662f\u5426\u7b49\u4e8e $G$\uff0c\u4ee5\u53ca $A$ \u662f\u5426\u4e3a $0$\u3002 \n\n\u603b\u7ed3\u6765\u8bf4\uff0c\u672c\u9898\u7684\u672c\u8d28\u5b9e\u9645\u4e0a\u5c31\u662f\u6839\u53f7\u4f18\u5316\uff0c\u7ec6\u62c6 BSGS \u6839\u53f7\u4f18\u5316\u7684\u672c\u8d28\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a meet in the middle\u3002$X_i$ \u663e\u7136\u662f\u4e0d\u597d\u505a\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u65e0\u6cd5\u5c06\u4e24\u4e2a $X_i$ \u7684\u7b54\u6848\u62fc\u8d77\u6765\u5f97\u5230\u53e6\u4e00\u4e2a $X_i$\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5f0f\u5b50\u4e0d\u6ee1\u8db3\u7ed3\u5408\u5f8b\u3002\u4e8e\u662f\u6211\u4eec\u5c06 $X_i$ \u7684\u5f0f\u5b50\u62c6\u5f00\uff0c\u5c06\u9ad8\u6b21\u5e42\u9879\u548c\u5176\u5b83\u9879\u5206\u79bb\uff0c\u53d1\u73b0\u53ef\u4ee5\u5316\u6210\u4e00\u4e2a\u6ee1\u8db3\u7ed3\u5408\u5f8b\u7684\u9ad8\u6b21\u540c\u4f59\u65b9\u7a0b\u7684\u5f62\u5f0f\uff0c\u4e8e\u662f\u5c31\u53ef\u4ee5\u4f7f\u7528 BSGS \u8fdb\u884c\u6839\u53f7\u4f18\u5316\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define int long long\nint p,a,b,s,g;\nmap<int,int> m;\nll read(){\n\tll w=0,f=1;\n\tchar c=getchar();\n\twhile (c>'9'||c<'0'){\n\t\tif (c=='-') f=-1;\n\t\tc=getchar();\n\t}\n\twhile (c>='0'&&c<='9'){\n\t\tw=(w<<3)+(w<<1)+(c^48);\n\t\tc=getchar();\n\t}\n\treturn w*f;\n}\nint ksm(int x,int y){\n\tint ans=1;\n\twhile (y){\n\t\tif (y&1) ans=ans*x%p;\n\t\tx=x*x%p;\n\t\ty>>=1;\n\t}\n\treturn ans;\n}\nint inv(int x){\n\treturn ksm(x,p-2);\n}\nsigned main(){\n\tint t=read();\n\twhile (t--){\n\t\tm.clear();\n\t\tp=read(),a=read(),b=read(),s=read(),g=read();\n\t\tif (s==g){\n\t\t\tputs(\"0\");\n\t\t\tcontinue;\t\n\t\t}\n\t\tif (a==0){\n\t\t\tif (b==g) puts(\"1\");\n\t\t\telse puts(\"-1\");\n\t\t\tcontinue;\n\t\t}\n\t\tif (a==1){\n\t\t\tif (b==0){\n\t\t\t\tputs(\"-1\");\n\t\t\t}else cout<<(g-s+p)%p*inv(b)%p<<'\\n';\n\t\t\tcontinue;\n\t\t}\n\t\tint x=(a*g%p-g+b+p)%p,y=(a*s%p-s+b+p)%p,sq=sqrt(p)+1,now=1;\n\t\tfor (int i=0;i<sq;i++){\n\t\t\tint zc=now*x%p;\n\t\t\tm[zc]=i;\n\t\t\tnow=now*a%p;\n\t\t}\n\t\tint sum=now;\n\t\tbool flag=0;\n\t\tfor (int i=1;i<=sq;i++){\n\t\t\tif (m.count(sum*y%p)){\n\t\t\t\tcout<<i*sq-m[sum*y%p]<<'\\n';\n\t\t\t\tflag=1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tsum=sum*now%p;\n\t\t}\n\t\tif (!flag) puts(\"-1\");\n\t}\n\t\n\treturn 0;\n}\n```",
        "postTime": 1667562074,
        "uid": 257621,
        "name": "\u7ffc\u5fb7\u5929\u5c0a",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 [ABC270G] Sequence in mod P"
    },
    {
        "content": "\u6211\u4eec\u5c06 $X$ \u8fdb\u884c\u5c55\u5f00\uff1a\n\n$X_0=S$\u3002\n\n$X_1=S\\times A+B$\u3002\n\n$X_2=A\\times X_1+B=S\\times A^2+AB+B$\u3002\n\n$X_3=A\\times X_2+B=S\\times A^3+A^2B+AB+B$\u3002\n\n$$\\vdots$$\n\n$X_n=S\\times A^n+B(A^0+A^1+\\dots+A^{n-1})(n\\neq0)$\u3002\n\n\u6839\u636e\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f $x_0+x_1+x_2+\\cdots+x_{n-1}=\\frac{x^n-1}{x-1}$\uff0c\u5316\u7b80\u53ef\u5f97\uff1a\n\n$X_n=S\\times A^n+B\\times \\frac{A^n-1}{A-1}$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u6c42\u7684\u662f $G\\equiv S\\times A^n+B\\times \\frac{A^n-1}{A-1}(\\bmod P)$\u3002\n\n\u5316\u5f0f\u5b50\u53ef\u5f97 $AG-G+B\\equiv (AS-S+B)A^n(\\bmod P)$\u3002\n\n\u4ee4\u5de6\u8fb9\u4e00\u5768\u4e3a $a$\uff0c\u53f3\u8fb9 $A^n$ \u7684\u7cfb\u6570\u4e3a $b$\uff0c\u5219\u539f\u5f0f\u76f8\u5f53\u4e8e $a\\equiv bA^n(\\bmod P)$\u3002\n\n\u7531\u4e8e $P\\in[2,10^9]$\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u5e7f\u4e3a\u4eba\u77e5\u7684 BSGS \u7b97\u6cd5\u89e3\u51b3\u672c\u95ee\u9898\u3002\n\n\u6211\u7528\u4e86 std::map \u5b9e\u73b0\u4e86\u54c8\u5e0c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathrm{O}(T\\sqrt p \\log \\sqrt p)$\u3002\n\n\u6ce8\u610f\u6211\u7684 BSGS \u6c42\u7684\u662f\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u89e3\uff0c\u6240\u4ee5\u8bb0\u5f97\u7279\u5224 $S=G$ \u7684\u60c5\u51b5\u3002\n\n\u540c\u65f6\u539f\u5f0f\u5728 $A=1$ \u65f6\u7531\u4e8e $A-1=0$ \u6240\u4ee5\u6211\u4eec\u4e0d\u80fd\u7528\u8fd9\u4e2a\u5f0f\u5b50\u7b97\uff0c\u8003\u8651 $1$ \u7684\u4efb\u4f55\u6b21\u65b9\u7b49\u4e8e $1$\uff0c\u7ed3\u5408\u4e4b\u524d\u7684\u516c\u5f0f\u53ef\u5f97 $G\\equiv S+Bn(\\bmod P)$\uff0c\u6240\u4ee5\u7b54\u6848\u5373\u4e3a $\\frac{G-S}{B}$\uff0c\u7279\u522b\u7684\uff0c\u82e5 $B=0$ \u5219\u7c7b\u6bd4 $S=G$ \u7684\u60c5\u51b5\u3002\n\n\u5982\u679c $S=0\\land B=0$\uff0c\u6b64\u65f6 $\\forall X_i=0(i\\in \\mathbb{N})$\uff0c\u82e5 $G\\neq 0$ \u5219\u65e0\u89e3\u3002\n\n\u5728 $G\\neq S$ \u7684\u524d\u63d0\u4e0b\uff0c\u82e5 $A=0$ \u5219 $\\forall b_i=B(i\\in(0,+\\infty))$\uff0c\u82e5 $B\\neq G$ \u5219\u65e0\u89e3\uff0c\u53cd\u4e4b\u4e3a $1$\u3002\n\n\u4ee3\u7801\u4e0d\u7ed9\u4e86\u3002\n\n",
        "postTime": 1666624128,
        "uid": 357163,
        "name": "shyr",
        "ccfLevel": 6,
        "title": "ABC270G \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u8fd9\u4e2a\u662f\u7ec4\u5408\u6570\u5b66\u7684\u4e00\u4e2a\u57fa\u7840 trick\uff0c\u975e\u5e38\u975e\u5e38\u5178\uff1a\n\n$X_i = AX_{i-1} + B$ \uff08\u4ee5\u4e0b\u7701\u7565\u540c\u4f59\uff09\n\n\u6211\u4eec\u8bd5\u56fe\u5229\u7528 $A$ \u4f5c\u4e3a\u8f6c\u79fb\u4e24\u6c42\u51fa\u901a\u9879\u516c\u5f0f\uff0c\u90a3\u4e48\u5bf9\u4e8e $X_i$ \u8fdb\u884c\u6362\u5143\u548c\u8c03\u6574\u3002\u5b9a\u4e49\u672a\u77e5\u91cf $C$\uff0c\u60f3\u8981\u53d8\u6210\u4e0b\u9762\u7684\u5f62\u5f0f\uff1a\n\n$X_i + C = A(X_{i-1} + C)$ \n\n\u5b9a\u4e49 $Y_i = X_{i} + C$ \u5373\u53ef\u6c42\u51fa\u901a\u9879\u3002\n\n\u90a3\u4e48\u628a\u5b83\u4e0e\u539f\u9012\u63a8\u5f0f\u7ed3\u5408\u53ef\u4ee5\u89e3\u5f97 $C = \\dfrac{B}{A-1}$\u3002\u6ce8\u610f\u770b\u5206\u6bcd\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u505a\u6389 $A=0$ \u548c $A=1$ \u7684\u60c5\u51b5\u3002\n\n\u4e0b\u9762\u6574\u7406\u4ee5\u4e0b\u6211\u4eec\u7684\u5177\u4f53\u505a\u6cd5\u3002\n\n1. \u5f53 $A=0$ \u65f6\uff0c\u5224\u65ad $G=B$ \u548c $G=S$ \u4e24\u79cd\u60c5\u51b5\u3002\n2. \u5f53 $A=1$ \u65f6\u5019\uff0c\u53d1\u73b0 $X_i = S + Bi$\uff0c\u89e3\u5f97 $i = \\dfrac{G-S}{B}$\u3002\u9700\u8981\u7279\u5224 $B=0$\u3002\n3. \u5426\u5219\u5229\u7528\u901a\u9879\u516c\u5f0f $X_i = (S + C) \\times A^i - C$ \u89e3\u65b9\u7a0b\u3002\u662f BSGS \u7684\u677f\u5b50\u3002\n\nTip\uff1a\u5b9e\u73b0\u7684\u65f6\u5019\u628a $P$ \u548c\u5934\u6587\u4ef6\u7684 $\\text{mod}$ \u641e\u6df7\uff0c\u7136\u540e\u53c8\u51fa\u73b0\u9057\u7559\u95ee\u9898\uff0c\u8b66\u949f\u6572\u70c2\u3002\n\n```cpp\nmap<ll,ll>lot;\nll solve(ll a,ll b,ll p){\n\tif(b==1||a==b) return b!=1;\n\tlot.clear();\n    ll m=ll(sqrt(p))+1;ll tmp=b,ttmp=1;\n    lot[m]=0;\n    for(ll i=1;i<=m;i++){\n        tmp=(tmp*a)%p;\n        ttmp=(ttmp*a)%p;\n        lot[tmp]=i;\n    }\n    ll cnt=1;\n    for(ll i=1;i<=m;i++){\n        cnt=(cnt*ttmp)%p;\n        if(lot[cnt]) return (i*m-lot[cnt]+2*p)%p;\n    }\n    return -1;\n} // BSGS \u677f\u5b50\nll A,B,S,G,P;\nvoid solve(){\n\tP=read(), A=read(), B=read(), S=read(), G=read();\n\tif(S == G) {puts(\"0\"); return;}\n\tif(A == 0){\n\t\tif(G == B) puts(\"1\");\n\t\telse puts(\"-1\");\n\t}else if(A == 1){\n\t\t// Xi = S + B * i\n\t\t// S + B * i = G\n\t\t// B * i = G - S\n\t\t// i = (G - S) / B\n\t\t\n\t\tll temp = (G - S + P) % P;\n\t\tif(B == 0){\n\t\t\tif(temp == 0){\n\t\t\t\tputs(\"0\");\n\t\t\t}else puts(\"-1\");\n\t\t}else{\n\t\t\tll niyuan = qpow(B, P-2, P);\n\t\t\tprintf(\"%lld\\n\", temp * niyuan % P);\n\t\t}\n\t}else{\n\t\t// X[i] = AX[i-1] + B\n\t\t// X[i] + B/(A-1) = AX[i-1] + A * B / (A-1)\n\t\t// X[i] + B/(A-1) = A(X[i-1] + B/(A-1))\n\t\t\n\t\tll add = B * qpow(A-1, P-2, P) % P;\n\t\tS = (S + add) % P;\n\t\tG = (G + add) % P;\n\t\t// G = S * (A ^ i)\n\t\t// (A ^ i) * S = G\n\t\tll T = G * qpow(S, P-2, P) % P;\n\t\t// A^i = T\n\t\t// BSGS\n\t\tprintf(\"%lld\\n\", solve(A, T, P));\n\t}\n}\n```",
        "postTime": 1672647536,
        "uid": 334727,
        "name": "BreakPlus",
        "ccfLevel": 0,
        "title": "Solution ABC270G"
    }
]
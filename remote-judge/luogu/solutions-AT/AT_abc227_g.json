[
    {
        "content": "## \u601d\u8def\n\n$\\dbinom{N}{K}=\\dfrac{\\prod_{i=N-K+1}^Ni}{ \\prod_{i=1}^Ki}$\u3002\n\n\u8003\u8651\u56e0\u5f0f\u5206\u89e3\u5b9a\u7406\uff0c$x=p_1^{q_1}p_2^{q_2}p_3^{q_3}\\dots$\uff0c\u5219 $x$ \u7684\u56e0\u5b50\u6709 $\\prod (q_i+1)$ \u4e2a\u3002\n\n\u6211\u4eec\u73b0\u5728\u60f3\u77e5\u9053\u7684\u5c31\u662f $\\dfrac{\\prod_{i=N-K+1}^Ni}{ \\prod_{i=1}^Ki}$ \u7684\u6bcf\u4e2a\u8d28\u56e0\u6570\u51fa\u73b0\u7684\u6b21\u6570\u3002\u8003\u8651\u4e24\u6bb5\u957f\u5ea6\u5747\u4e3a $K$\uff0c\u6bcf\u4e00\u6bb5\u4e2d\u5927\u4e8e $K$ \u7684\u56e0\u6570\u5728\u5176\u4e2d\u6700\u591a\u51fa\u73b0\u4e00\u6b21\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e0a\u9762\u548c\u4e0b\u9762\u5206\u522b\u8fdb\u884c\u533a\u95f4\u7b5b\uff08$1\\sim 10^6$\uff09\uff0c\u7136\u540e\u5bf9\u4e8e\u6240\u6709\u7b5b\u5b8c\u4e0d\u662f $1$ \u7684\u6570\u80af\u5b9a\u662f\u7d20\u6570\uff08$\\sqrt{N}\\leq$ \u7684\u56e0\u6570\u6700\u591a\u53ea\u6709\u4e00\u79cd\u4e00\u4e2a\uff09\u3002\u6240\u4ee5\u603b\u590d\u6742\u5ea6\u662f $\\Theta(10^6\\ln 10^6)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define double long double\n#define mid ((l+r)>>1)\nusing namespace std;\nconst int mod=998244353;\nbool isp[1000005];\nint now[1000005];\nint cnt[1000005];\nsigned main(){\n\t//freopen(\"\",\"r\",stdin);\n\t//freopen(\"\",\"w\",stdout);\n\tint n,k;\n\tcin>>n>>k;\n\tfor(int i=2;i<=1000000;i++) isp[i]=1;\n\tfor(int i=2;i<=1000000;i++) if(isp[i]) for(int j=i*2;j<=1000000;j+=i) isp[j]=0;\n\tfor(int i=1;i<=k;i++) now[i]=i;\n\tfor(int i=2;i<=1000000;i++){\n\t\tint fst=i;\n\t\tfor(int j=fst;j<=k;j+=i){\n\t\t\twhile(now[j]%i==0){\n\t\t\t\tnow[j]/=i;\n\t\t\t\tcnt[i]--;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=k;i++) now[i]=n-k+i;\n\tfor(int i=2;i<=1000000;i++){\n\t\tint fst=((n-k)/i+1)*i;\n\t\tfor(int j=fst;j<=n;j+=i){\n\t\t\twhile(now[j+k-n]%i==0){\n\t\t\t\tnow[j+k-n]/=i;\n\t\t\t\tcnt[i]++;\n\t\t\t}\n\t\t}\n\t}\n\tint ans=1;\n\tfor(int i=2;i<=1000000;i++){\n\t\tans=ans*(cnt[i]+1)%mod;\n\t}\n\tfor(int i=1;i<=k;i++) if(now[i]!=1) ans=ans*2%mod;\n\tcout<<ans;\n}\n```",
        "postTime": 1660802819,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "ABC227G \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9898\u60f3\u5230\u7b5b\u8d28\u6570\u5c31\u53ef\u4ee5\uff0c\u6ca1\u4ec0\u4e48\u96be\u70b9\u3002\n\n$\\dbinom{n}{k}=\\frac{\\prod\\limits_{i=n-k+1}^ni}{\\prod\\limits_{i=1}^ki}$\u3002\n\n$1$. \u9884\u5904\u7406\u51fa $1 \\sim 10^6$ \u4e2d\u6240\u6709\u7684\u8d28\u6570\u3002\n\n$2$. \u7528\u9884\u5904\u7406\u51fa\u7684\u8d28\u6570\u5206\u522b\u5bf9\u4e0a\u4e0b\u4e24\u4e2a\u957f\u5ea6\u4e3a $k$ \u7684\u533a\u95f4\u8fdb\u884c\u533a\u95f4\u7b5b\u3002\n\n$3$. \u8bbe $cnt_i$ \u8868\u793a\u8d28\u6570 $i$ \u51fa\u73b0\u7684\u6b21\u6570\uff0c\u626b\u63cf $1 \\sim k$ \u65f6\uff0c\u6bcf\u6b21\u5c06 $cnt_i$ \u51cf\u4e00\u3002\u626b\u63cf $n-k+1 \\sim n$ \u65f6\uff0c\u6bcf\u6b21\u5c06 $cnt_i$ \u52a0\u4e00\u3002 \n\n$4$. \u6ce8\u610f\u5230 $n-k+1 \\sim n$ \u4e2d\u4f1a\u6709\u4e00\u4e9b\u8d28\u6570\u662f\u5927\u4e8e $10^6$ \u7684\uff0c\u4f46\u662f\u90fd\u53ea\u4f1a\u51fa\u73b0\u4e00\u6b21\uff0c\u6240\u4ee5\u4e0d\u4f1a\u5f71\u54cd\u590d\u6742\u5ea6\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u4f1a\u7b97\u3002\n\n## AC Code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int M=1e6;\nconst ll mod=998244353;\nll n,m,v[M+5],pr[M],cnt[M],val[M],ans=1;\nvoid init()\n{\n\tfor(int i=2;i<=M;i++)\n\t{\n\t\tif(v[i]) continue;\n\t\tfor(int j=i;j<=M/i;j++) v[i*j]=1;\n\t}\n\tfor(int i=2;i<=M;i++) if(!v[i]) pr[++pr[0]]=ll(i);\n}\nint main()\n{\n\tscanf(\"%lld%lld\",&n,&m);\n\tinit();\n\tfor(int i=1;i<=pr[0];i++)\n\t{\n\t\tfor(ll j=1;j<=m/pr[i];j++)\n\t\t{\n\t\t\tll s=pr[i]*j;\n\t\t\twhile(s%pr[i]==0) s/=pr[i],cnt[i]--;\n\t\t}\n\t}\n\tfor(ll i=n-m+1;i<=n;i++) val[i-n+m]=i;\n\tfor(int i=1;i<=pr[0];i++)\n\t{\n\t\tfor(ll j=(n-m+1)/pr[i];j<=n/pr[i];j++)\n\t\t{\n\t\t\tif(pr[i]*j<=n-m) continue;\n\t\t\twhile(val[pr[i]*j-n+m]%pr[i]==0) val[pr[i]*j-n+m]/=pr[i],cnt[i]++;\n\t\t}\n\t}\n\tfor(int i=1;i<=pr[0];i++) ans=(ans*(cnt[i]+1ll))%mod;\n\tfor(int i=1;i<=m;i++) if(val[i]>1) ans=(ans*2ll)%mod;\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1672283163,
        "uid": 486484,
        "name": "Gaode_Sean",
        "ccfLevel": 6,
        "title": "ABC227G \u9898\u89e3"
    }
]
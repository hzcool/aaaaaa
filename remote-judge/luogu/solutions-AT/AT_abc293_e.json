[
    {
        "content": "## \u9898\u610f\n\u7ed9\u5b9a $a,x,m$\uff0c\u6c42\u51fa $ \\displaystyle\\ \\sum_{i\\ =\\ 0}^{x-1}\\ a^i \\bmod m$ \u7684\u503c\u3002\n## \u89e3\u9898\u601d\u8def 1\n\u7528\u5c0f\u5b66\u5965\u6570\u5b66\u8fc7\u7684\u65b9\u6cd5\u2014\u2014\u7b49\u6bd4\u6570\u5217\u6c42\u503c\u3002\n\n\u4ee4 $S=a^0+a^1+a^2+\\cdots+a^{x-1}$\u3002\n\n\u5219 $a\\times S=a^1+a^2+a^3+\\cdots+a^x$\u3002\n\n\u7b49\u5f0f $2$ \u51cf\u7b49\u5f0f $1$ \u5f97\uff0c$(a-1)\\times S=a^x-1$\u3002\n\n\u5219 $S=\\frac{a^x-1}{a-1}$\u3002\n\n\u4e5f\u5c31\u662f\u5feb\u901f\u5e42\u548c\u4e58\u6cd5\u9006\u5143\u4e86\u3002\n## AC \u4ee3\u7801 1\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef __int128 LL;\ntypedef long long ll;\nll a,x,m;\nLL p;\nLL qpow(LL x,LL y)\n\tLL re=1;\n\tfor(;y>0;y>>=1){\n\t\tif(y&1)re=re*x%p;\n\t\tx=x*x%p;\n\t}\n\treturn !re?p:re;\n}\nint main(){\n    cin>>a>>x>>m;\n    if(a==1){\n        cout<<x%m;\n        return 0;\n    }\n    p=m*(a-1);\n    cout<<(ll)(qpow(a,x)-1)/(a-1);\n    return 0;\n}\n```\n## \u89e3\u9898\u601d\u8def 2\n\u4f46\u8981\u662f\u50cf\u672c\u849f\u84bb\u4e00\u6837\uff0c\u4e0d\u4f1a\u4e58\u6cd5\u9006\u5143\u600e\u4e48\u529e\u5462\uff1f\u7528\u9012\u5f52\uff01\n\n\u5b9a\u4e49 $S(n)=a^0+a^1+\\cdots+a^n$\uff0c\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x46735n6.png)\n\n\u7136\u540e\u8fb9\u754c\u6761\u4ef6\uff1a\u5f53 $n=0$ \u65f6\uff0c$S=a^0=1$\uff1b\u5f53 $n=1$ \u65f6\uff0c$S=a^1+a^0=(a+1)\\bmod m$\u3002\n\n\u4e5f\u9700\u8981\u5feb\u901f\u5e42\uff0c\u4f46\u4e0d\u7528\u4e58\u6cd5\u9006\u5143\u3002\u9002\u7528\u4e8e\u50cf\u6211\u8fd9\u6837\u4e0d\u4f1a\u4e58\u6cd5\u9006\u5143\u7684\u849f\u84bb\u3002\n## AC \u4ee3\u7801 2\n```cpp\n/*\nwritten by : zjs123\n*/\n#include<bits/stdc++.h>\nusing namespace std;\n#define int __int128\ninline int read(){\n    int X=0,w=0; char ch=0;\n    while(!isdigit(ch)) {w|=ch=='-';ch=getchar();}\n    while(isdigit(ch)) X=(X<<3)+(X<<1)+(ch^48),ch=getchar();\n    return w?-X:X;\n}\ninline void write(int x){\n\tif(x<0) putchar('-'),x=-x;\n    if(x>9) write(x/10);\n    putchar(x%10+'0');\n}\nint a,x,m;\nint ksm(int a,int b,int c){\n    int re=1;\n    while(b){\n        if(b&1)re=re*a%c;\n        a=a*a%c;\n        b/=2;\n    }\n    return re;\n}\nint S(int x){\n    if(x==0)return 1;\n    if(x==1)return (a+1)%m;\n    if(x&1){\n        return (1+ksm(a,x/2+1,m))*S(x/2)%m;\n    }\n    else{\n        return ((1+ksm(a,x/2,m))*S(x/2-1)%m+ksm(a,x,m))%m;\n    }\n}\nmain(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    cout.tie(0);\n    a=read();\n    x=read();\n    m=read();\n    write(S(x-1)%m);\n    return 0;\n}\n\n```",
        "postTime": 1678589984,
        "uid": 754000,
        "name": "_JSYX_",
        "ccfLevel": 5,
        "title": "abc293_e"
    },
    {
        "content": "\u4e0d\u592a\u4f1a\u4e58\u6cd5\u9006\u5143\u2026\u2026\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u5206\u5757\u3002\n\n\u6bcf $b=\\sqrt{X-1}+1$ \u5206\u4e00\u5757\uff08\u52a0\u4e00\u662f\u4e3a\u4e86\u907f\u514d\u51fa\u73b0 $0$ \u7684\u60c5\u51b5\uff09\uff0c\u4e24\u4e2a\u5757\u4e4b\u95f4\u548c\u7684\u8f6c\u79fb\u76f4\u63a5\u4e58 $A^b$ \u5373\u53ef\u3002\n\n\u5982\u679c\u6709\u6700\u540e\u5269\u4e0b\u7684\u6563\u5757\uff0c\u76f4\u63a5\u66b4\u529b\u5feb\u901f\u5e42\u8ba1\u7b97\u5373\u53ef\u3002\u590d\u6742\u5ea6 $O(\\sqrt X\\log X)$\u3002\n\n```cpp\nint a, x, mod; \n\nint qpow(int p, int q) {\n\tint res = 1;\n\twhile (q) {\n\t\tif (q & 1) res = res * p % mod;\n\t\tp = p * p % mod, q >>= 1;\n\t}\n\treturn res;\n}\n\nsigned main() {\n\ta = read(), x = read() - 1, mod = read();\n\tint b = sqrt(x) + 1, res = 0, ans = 0;\n\tfor (int i = 1; i <= b; i++) (res += qpow(a, i)) %= mod;\n\tfor (int i = 1, tp = 1; i <= x / b; i++) {\n\t\tans = (ans + res * tp % mod) % mod;\n\t\ttp = tp * qpow(a, b) % mod;\n\t}\n\tfor (int i = x / b * b + 1; i <= x; i++) {\n\t\tans = (ans + qpow(a, i)) % mod;\n\t}\n\twrite((ans + 1) % mod);\n\treturn 0;\n}\n\n```",
        "postTime": 1678615173,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "ABC293E Geometric Progression"
    },
    {
        "content": "\u4e00\u773c\u4e01\u771f\uff1a\u7b49\u6bd4\u516c\u5f0f + \u5feb\u901f\u5e42 + \u9006\u5143\uff0c\u7136\u800c\u4e0d\u4e92\u8d28\u3002\n\n\u6709\u5927\u4f6c\u7528\u4e86\u9006\u5143\uff0c\u7136\u800c\u6211\u4e0d\u662f\u3002\n\n\u4e8e\u662f\u6211\u8003\u8651\u77e9\u9635\u4e58\u6cd5\uff0c\u8fd8\u662f\u5f88\u597d\u63a8\u7684\u3002\u8bbe $f_{i}$ \u4e3a\u7b2c $i$ \u9879\u7684\u7b54\u6848\uff0c\u5219\u6709 $f_{i}=f_{i-1}\\times a +1 \\times 1$\uff0c\u7136\u540e\u6211\u4eec\u968f\u4fbf\u51d1\u4e00\u4e2a $1=f_{i-1}\\times 0+1\\times 1$\u3002\n\n\u4e8e\u662f $\\begin{pmatrix} f_{i}\\\\1 \\end{pmatrix}=\\begin{pmatrix} a &1 \\\\ 0  & 1\\end{pmatrix} \\times \\begin{pmatrix}f_{i-1}\\\\1 \\end{pmatrix}$\u3002\n\n$\\begin{pmatrix} f_{x}\\\\1 \\end{pmatrix}=\\begin{pmatrix} a &1 \\\\ 0  & 1\\end{pmatrix} ^x \\times \\begin{pmatrix}f_{0}\\\\1 \\end{pmatrix}$\u3002\n\n\u7136\u540e\u521d\u59cb $f_{0}=0$\u3002\n\n\u5982\u679c\u60a8\u7528\u4e86\u7ed3\u6784\u4f53\uff0c\u8bf7\u4e00\u5b9a\u521d\u59cb\u5316\uff0c\u4e0d\u7136\u50cf\u6211\u8fd9\u5565\u4e00\u6837\u8d5b\u573a\u5361\u534a\u5929\uff08\u4e3b\u8981\u8fd8\u662f\u592a\u4e45\u6ca1\u5199\u77e9\u4e58\u4e86\uff09\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nll n,k,p;\n\nstruct node{\n\tll a[4][4];\n\tnode(){memset(a,0,sizeof(a));}//\u4e0d\u521d\u59cb\u5316\u5361\u534a\u5929\u7684\u6ecb\u5473\u8bf7\u8c28\u614e\u54c1\u5c1d \n\tnode operator*(const node &b)const{\n\t\tnode c;\n\t\tfor(int i=1;i<=2;i++)\n\t\t\tfor(int j=1;j<=2;j++)\n\t\t\t\tfor(int k=1;k<=2;k++)\n\t\t\t\t\tc.a[i][j]=(c.a[i][j]+a[i][k]*b.a[k][j]%p)%p;\n\t\treturn c;\n\t}\n}x,res;\n\nvoid power(node x,ll b)\n{\n\tres.a[1][1]=res.a[2][2]=1;\n\twhile(b)\n\t{\n\t\tif(b&1) res=res*x;\n\t\tx=x*x;\n\t\tb>>=1;\n\t}\n}\n\nint main()\n{\n\tcin>>n>>k>>p;\n\tx.a[1][1]=n,x.a[1][2]=1;\n\tx.a[2][1]=0,x.a[2][2]=1;\n\tpower(x,k);\n\tcout<<res.a[1][2];//\u77e9\u9635res*(0 1)\uff0cres[1][1]\u65e0\u4e86\uff0c\u8f93\u51fares[1][2]\u5373\u53ef\u3002 \n\treturn 0;\n}\n```\n",
        "postTime": 1678698054,
        "uid": 501028,
        "name": "spider_oyster",
        "ccfLevel": 5,
        "title": "Geometric Progression"
    },
    {
        "content": "[\u6d1b\u8c37\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_abc293_e)\n\n[Atcoder \u4f20\u9001\u95e8](https://atcoder.jp/contests/abc293/tasks/abc293_e)\n### \u9898\u76ee\u5927\u610f\n\u6c42 $\\sum^{X-1}_{i=0} A^i\\bmod M$ \u7684\u503c\u3002\n\n\u4e0d\u4fdd\u8bc1 $M$ \u662f\u8d28\u6570\u3002\n### \u601d\u8def\n\u9996\u5148\uff0c\u6839\u636e\u521d\u4e2d\u6570\u5b66\u8001\u5e08\u6559\u7ed9\u6211\u4eec\u7684\u77e5\u8bc6\uff0c\u6211\u4eec\u5e94\u8be5\u4f7f\u7528\u9519\u4f4d\u76f8\u51cf\u6cd5\uff08~~\u662f\u53eb\u8fd9\u4e2a\u540d\u5427\uff1f~~\uff09\uff1a\n\n\u4ee4 $S=\\sum^{X-1}_{i=0} A^i$\u3002\n\n\u6211\u4eec\u5c06\u7b49\u5f0f\u4e24\u8fb9\u540c\u4e58 $A$\uff0c\u53ef\u4ee5\u5f97\u5230 $AS=\\sum^{X}_{i=1} A^i$\u3002\n\n\u4e24\u5f0f\u76f8\u51cf\uff0c\u5f97 $(A-1)S=A^X-A^0$\u3002\n\n\u5c06 $A-1$ \u9664\u8fc7\u53bb\u5f97 $S=\\dfrac{A^X-1}{A-1}$\u3002\n\n>\u5f53\u7136\u5c06 $A-1$ \u9664\u8fc7\u53bb\u6709\u4e00\u4e2a\u91cd\u8981\u524d\u63d0\uff1a$A-1\\not=0$\uff0c\u5373 $A\\not=1$\u3002**\u4f46\u9898\u76ee\u6ca1\u6709\u4fdd\u8bc1\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u7279\u5224\u8fd9\u79cd\u60c5\u51b5\uff0c\u8f93\u51fa $X\\bmod M$\u3002**\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0 $M$ \u4e0d\u4e00\u5b9a\u6709\u9006\u5143\uff0c\u4e8e\u662f\u6211\u4eec\u6ca1\u6cd5\u76f4\u63a5\u89e3\u51b3\u5b83\u3002\n\n------------\n\n\u8fd9\u65f6\u6211\u4eec\u5f15\u5165\u4e00\u4e2a\u516c\u5f0f\uff1a\n\n>\u82e5 $b|a$\uff0c\u5219 $\\dfrac{a}{b}\\bmod m=\\dfrac{a \\bmod (m\\cdot b)}{b}$\n\n\u6839\u636e\u8fd9\u4e2a\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8f93\u51fa $\\dfrac{(A^X-1)\\bmod (M\\times(A-1))}{A-1}$ \u7684\u503c\u3002\n\n\u6ce8\u610f\u8981\u5f00 `__int128`\u3002\n\n**UPD\uff1a\u8ba1\u7b97\u5feb\u901f\u5e42\u65f6\u8981\u7279\u5224\u6574\u9664\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u6b64\u65f6\u53ef\u80fd\u4f1a\u8ba1\u7b97\u51fa\u8d1f\u6570\uff0c\u5177\u4f53\u89c1\u4ee3\u7801\uff08\u5b98\u65b9\u8d5b\u540e\u52a0\u7684\u6570\u636e\u70b9\uff09\u3002**\n### \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define int __int128 \nusing namespace std;\ninline int R(){\n\tint x=0,f=1;int ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n\twhile(isdigit(ch)){x=x*10+ch-48;ch=getchar();}return x*f;\n}\ninline void write(int x){\n\tif(x<0){x=-x;putchar('-');}\n\tint y=0;char z[70];\n\twhile(x||!y){z[y++]=x%10+48;x/=10;}\n\twhile(y--)putchar(z[y]);\n}\nint a,x,m,mod;\nint ksm(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1) res=(res*x)%mod;\n\t\tx=(x*x)%mod;\n\t\ty>>=1;\n\t}\n\treturn !res?mod:res;//\u5feb\u901f\u5e42\u7279\u5224\u6574\u9664\n}\nsigned main(){\n\ta=R(),x=R(),m=R();\n\tif(a==1) return write(x%m),0;//\u7279\u5224A=1\n\tmod=m*(a-1);\n\twrite((ksm(a,x)-1)/(a-1));\n}\n```\n",
        "postTime": 1678682947,
        "uid": 448884,
        "name": "\u5feb\u4e50\u7684\u5927\u7ae5",
        "ccfLevel": 4,
        "title": "ABC293E"
    },
    {
        "content": "\u672c\u9898\u53ef\u4ee5\u4f7f\u7528**\u5206\u6cbb**\u601d\u60f3\u3002\n\n\u4ee4 $S_n$ \u4e3a $\\sum\\limits_{i=1}^n A^i$\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n1. \u5f53 $n$ \u4e3a\u5076\u6570\u65f6\uff0c\n\n$$\n\\begin{aligned}\nS_n\n&=\\sum_{i=1}^n A^i\\\\\n&=\\sum_{i=1}^{n/2} A^i+A^{n/2}\\sum_{i=1}^{n/2} A^i\\\\\n&=\\left(\\sum_{i=1}^{n/2}A^i\\right)\\left(A^{n/2}+1\\right)\\\\\n&=S_{n/2}\\left(A^{n/2}+1\\right)\n\\end{aligned}\n$$\n\n2. \u5f53 $n$ \u4e3a\u5947\u6570\u65f6\uff0c\n\n$$\n\\begin{aligned}\nS_n\n&=\\sum_{i=1}^n A^i\\\\\n&=\\sum_{i=1}^{n-1} A^i+A^n\\\\\n&=S_{(n-1)/2}\\left(A^{(n-1)/2}+1\\right)+A^n\n\\end{aligned}\n$$\n\n\u4e0a\u8ff0\u4e8c\u5f0f\u53ef\u4ee5\u9012\u5f52\u6c42\u89e3\uff0c\u7b54\u6848\u6700\u540e\u52a0\u4e0a $A^0=1$ \u5373\u53ef\u3002\n\n\u6ce8\u610f $x=1$ \u548c $m=1$ \u7684\u60c5\u51b5\uff0c\u9700\u8981\u7279\u5224\u3002\n\n\u653e\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint m;\nint qpow(int a,int b){\n  int r=1;\n  while(b){\n    if(b&1)r=r%m*a%m;\n    a=a%m*a%m; b>>=1;\n  }\n  return r;\n} // \u5feb\u901f\u5e42\nint f(int a,int x){\n  if(!x)return 0; // x=1 \u65f6\u5982\u679c\u4e0d\u52a0\u8fd9\u884c\u4f1a RE\n  if(x==1)return a%m;\n  if(x&1)return (f(a,x>>1)*(qpow(a,x>>1)+1)%m+qpow(a,x))%m;\n  else return f(a,x>>1)*(qpow(a,x>>1)+1)%m;\n  // \u5957\u516c\u5f0f\n} // f(a,x) \u8868\u793a\u89e3\u6cd5\u63cf\u8ff0\u4e2d\u7684 S[x]\nmain(){\n  ios::sync_with_stdio(false);\n  int a,x; cin>>a>>x>>m;\n  cout<<(f(a,x-1)+1)%m<<endl;\n  return 0;\n}\n```",
        "postTime": 1678595198,
        "uid": 556366,
        "name": "zyc212303",
        "ccfLevel": 5,
        "title": "[ABC293E] Geometric Progression"
    },
    {
        "content": "# \u6838\u5fc3\u601d\u8def\uff1a\u9012\u63a8\n\u9002\u5408\u6570\u5b66\u4e0d\u597d\u7684\u9009\u624b\u53c2\u8003\n\n## \u9898\u610f\n\n- \u7ed9\u4f60\u4e09\u4e2a\u6b63\u6574\u6570 $A,X,M$ \u4f60\u8981\u6c42 $\\sum\\limits_{i=0}^{X-1}A^i \\bmod m$\u3002\n- $1 \\leq A,m \\leq10^9, 1 \\leq X \\leq 10^{12}$\n\n## \u9898\u89e3\n\n\u8fd9\u9053\u9898\u660e\u663e\u53ef\u4ee5\u7528\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\uff0c\u4f46\u662f\u6211\u4e0d\u4f1a\u8fd9\u4e2a\u516c\u5f0f\uff08\u5c5e\u4e8e\u662f\u5c0f\u5b66\u5965\u6570\u6ca1\u5b66\u597d\u7684\u4f0f\u7b14\u4e86\uff09\u6240\u4ee5\u6211\u4eec\u8003\u8651\u7528\u7b97\u6cd5\u6c42\u89e3\u3002\n\n\u7531\u4e8e\u8fd9\u9053\u9898 $X$ \u975e\u5e38\u5927\uff0c$O(n)$ \u90fd\u4e0d\u53ef\u80fd\u8fc7\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u590d\u6742\u5ea6\u5c0f\u4e8e $O(n)$ \u7684\u65b9\u6cd5\uff0c\u5f88\u81ea\u7136\u5730\u4f1a\u60f3\u5230\u5bf9\u6570\u578b\u9012\u63a8\u3002\n\n\u4ee4 $f(p)=\\sum\\limits_{i=0}^{p}A^i$\uff0c\u5bb9\u6613\u53d1\u73b0\u4ee5\u4e0b\u6027\u8d28\uff1a\n\n$$p=0,f(p)=1$$\n$$\\forall p > 0,f(p)=f(p-1) \\times A + 1$$\n$$\\forall p \\equiv 1 \\pmod 2,f(p)=f(\\frac{p}{2}) \\times (A^{\\frac{p}{2}+1}+1)$$\n\n\u8bc1\u660e\uff1a\n- \u5bf9\u4e8e\u6027\u8d28 $1$\uff0c\n\n\t$f(0)= \\sum\\limits_{i=0}^{0}A^i =A^0 =1$\u3002\n    \n- \u5bf9\u4e8e\u6027\u8d28 $2$\uff0c\n\n\t$f(p)$\n    \n   $= \\sum\\limits_{i=0}^{p}A^i $\n   \n   $= A^0 + \\sum\\limits_{i=1}^{p}A^i $\n   \n   $= 1 + A\\times\\sum\\limits_{i=0}^{p-1}A^i $\n   \n   $=f(p-1) \\times A +1$\n    \n- \u5bf9\u4e8e\u6027\u8d28 $3$\uff0c\n\n\t$f(p)$\n    \n   $= \\sum\\limits_{i=0}^{p}A^i$\n   \n   $ = \\sum\\limits_{i=0}^{\\frac{p}{2}}A^i + \\sum\\limits_{i=\\frac{p}{2}+1}^{p}A^i $\n   \n   $=\\sum\\limits_{i=0}^{\\frac{p}{2}}A^i +A^{\\frac{p}{2}+1} \\times \\sum\\limits_{i=0}^{\\frac{p}{2}}A^i$\n   \n   $=f(\\frac{p}{2})+A^{\\frac{p}{2}+1} \\times f(\\frac{p}{2})$\n   \n   $=f(\\frac{p}{2}) \\times (A^{\\frac{p}{2}+1}+1)$\n   \n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u8fd9\u4e2a\u6027\u8d28\u6765\u5206\u6cbb\uff0c\u7531\u4e8e\u5feb\u901f\u5e42\u7684\u590d\u6742\u5ea6\u662f $O(\\log n)$ \u6bcf\u4e00\u5c42\u81f3\u591a\u7b97\u4e00\u6b21\u5feb\u901f\u5e42\uff0c\u4e14\u5c42\u6570\u662f $O(\\log n)$ \u7ea7\u522b\u7684\uff0c\u6545\u6574\u4f53\u590d\u6742\u5ea6\u4e3a $O(\\log^2 n)$\u3002\n\n## code\n```cpp\n#include<iostream>\n#include<algorithm>\n#define int long long\nusing namespace std;\n#define gc getchar()\ninline int read(){//\u5feb\u8bfb\n    int x=0,f=1;char c;\n    while(!isdigit(c=gc)) if(c=='-') f=-1;\n    while(isdigit(c)){x=(x<<3)+(x<<1)+(c^48);c=gc;}\n    return x*f;\n}\n#undef gc\nint a,x,m;\ninline int ksm(int x,int k){//\u5feb\u901f\u5e42\n\tint res=1;\n\twhile(k>0){\n\t\tif(k&1) res=(res*x)%m;\n\t\tx=(x*x)%m;\n\t\tk>>=1;\n\t}\n\treturn res;\n}\ninline int sum(int p){\n//\u9700\u8981\u6ce8\u610f\uff0c\u6240\u6709\u7684\u8868\u8fbe\u5f0f\u540e\u9762\u90fd\u8981\u6a21 m\uff0c\u8fd8\u8981\u5f53\u5fc3\u4f1a\u4e0d\u4f1a\u7206 long long\u3002\n\tif(p==0) return 1%m;\n\tif(!(p&1)){\n\t\treturn (sum(p-1)*a%m+1)%m;\n\t}else{\n\t\treturn (sum(p/2)%m*(ksm(a,p/2+1)+1)%m)%m;\n\t}\n}\nsigned main(){\n\ta=read();x=read();m=read();\n\tprintf(\"%lld\",sum(x-1));\n}\n```",
        "postTime": 1678677961,
        "uid": 537230,
        "name": "\u516d\u697c\u6e9c\u5218",
        "ccfLevel": 5,
        "title": "[ABC293E] Geometric Progression \u9898\u89e3"
    },
    {
        "content": "\u7ed9\u51fa\u663e\u7136\u7684\u5355 log \u60f3\u6cd5\u3002\n\n$1+A+\\cdots+A^{l-1}=\\frac{A^l-1}{A-1}$\n\n\u5bb9\u6613\u53d1\u73b0\u5728 $l=2^{p}$ \u65f6\u901a\u8fc7\u5e73\u65b9\u5dee $A-1$ \u88ab\u7ea6\u53bb\u3002\n\n$1+A+\\cdots+A^{2^{p}-1}=(A+1)(A^{2}+1)\\cdots(A^{2^{p-1}}+1)$\n\n\u7136\u540e\u5c31\u5c06 $x$ \u4e8c\u8fdb\u5236\u62c6\u5206\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\log X)$\n\n\u7136\u800c\u5e76\u6ca1\u6253 ABC\uff0c\u4e5f\u6ca1\u6709\u60f3\u5230\u6839\u53f7/ll\n\n```cpp\nRd(a, x, P), a %= P;\npw[0] = a;\nfor (int i(1); i <= T; ++i) pw[i] = 1ll * pw[i - 1] * pw[i - 1] % P;\nf[0] = (a + 1) % P;\nfor (int i(1); i <= T; ++i) f[i] = 1ll * f[i - 1] * (pw[i] + 1) % P;\nfor (int i(T), base(1); ~i; --i) if (x >> i & 1) {\n  ans = (ans + 1ll * base * (i ? f[i - 1] : 1) % P) % P;\n  base = 1ll * base * pw[i] % P;\n}\nprintf(\"%d\", ans);\n```",
        "postTime": 1678675023,
        "uid": 312306,
        "name": "LJ07",
        "ccfLevel": 0,
        "title": "[Solution][ABC293E] Geometric Progression"
    },
    {
        "content": ">\u505a\u6cd5\u6765\u81ea @\u5bfb\u900d\u90652006\n\n#### \u9898\u610f\n\n\u6c42 $\\displaystyle \\sum_{i=0}^{X-1}A^{i} \\operatorname{mod} M$\uff0c\u4e0d\u4fdd\u8bc1 $M$ \u4e3a\u8d28\u6570\u3002\n\n#### \u505a\u6cd5\n\n\u7ef4\u62a4\u4e00\u4e2a $f_i(K)= \\sum\\limits_{i=0}^{2^K-1}A^i$\uff0c\n\n\u90a3\u4e48\u53ef\u5f97 $f_i(K)=f_{i-1}(K) \\times (A^{2^{K-1}}+1)$\u3002\n\n\u8fd9\u6837\u4e00\u6765\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u5bf9 $X$ \u8fdb\u884c\u4e8c\u8fdb\u5236\u62c6\u5206\uff0c\u7ef4\u62a4\u7b54\u6848\u5373\u53ef\u3002\n\n#### \u6838\u5fc3\u4ee3\u7801\n\n```cpp\nwhile(x)\n{\n    f[k]=f[k-1]*(qpow(a,aqpow(2,k-1))+1)%mo;\n    x>>=1;++k;\n}\nfor(int i=mxs;i>=0;--i)\n{\n    if(xs[i])\n    {\n        ans+=f[i]*qpow(a,ard)%mo;\n        ars+=aqpow(2,i);\n        ans%=mo;\n    }\n}\n```",
        "postTime": 1678610658,
        "uid": 532102,
        "name": "_FyFive_",
        "ccfLevel": 6,
        "title": "ABC293E-\u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\n\u7ed9\u5b9a $A,X,M$\uff0c\u6c42 $(\\sum\\limits_{i=0}^{X-1}A^i)\\bmod M$\u3002\n\n- $A,M\\le 10^9$\n- $M\\le 10^{12}$\n\n### \u9898\u89e3\n\u7531\u4e8e\u770b\u5230 $X$ \u5f88\u5927\uff0c\u53c8\u548c $A^i$ \u6709\u5173\uff0c\u6240\u4ee5\u5f88\u81ea\u7136\u7684\u5c31\u4f1a\u60f3\u5230\u5feb\u901f\u5e42\u3002\n\n\u8003\u8651\u628a $X$ \u4e8c\u8fdb\u5236\u5206\u89e3\uff0c\u5982\u679c $X$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4ece\u53f3\u5f80\u5de6\u6570\u7b2c $i$ \u4f4d\u662f $1$\uff0c\u90a3\u4e48\u7b54\u6848 $ans$ \u5c31\u8981\u53d8\u4e3a $ans\\times a^{2^i}+1+a+\\cdots+a^{2^i-1}$ \u3002\u800c $a^{2^i}$ \u548c $1+a+\\cdots+a^{2^i-1}$ \u53ef\u4ee5\u5728\u7c7b\u5feb\u901f\u5e42\u7b97\u6cd5\u4e2d\u8fdb\u884c\u8ba1\u7b97\u3002\n### \u4ee3\u7801\n```cpp\n#include <iostream>\nusing namespace std;\ntypedef long long LL;\nLL a,x,m;\nLL get_ans (LL a,LL b,LL m) {\n\tLL ans = 0,aa = a,bb = 1;\n\twhile (b) {\n\t\tif (b & 1) ans = (ans * aa + bb) % m;\n\t\tbb = (bb * aa + bb) % m,aa = aa * aa % m;\n\t\tb >>= 1;\n\t}\n\treturn ans;\n}\nint main () {\n\tcin >> a >> x >> m;\n\tcout << get_ans (a,x,m) << endl;\n    return 0;\n}\n```",
        "postTime": 1678583445,
        "uid": 463956,
        "name": "incra",
        "ccfLevel": 5,
        "title": "[ABC293E] Geometric Progression"
    },
    {
        "content": "# abc 293 E\n\n[\u9898\u76ee\u4f20\u9001\u95e8\uff08\u6d1b\u8c37\uff09](https://www.luogu.com.cn/problem/AT_abc293_e)\n\n[\u9898\u76ee\u4f20\u9001\u95e8\uff08AtCoder\uff09](https://atcoder.jp/contests/abc293/tasks/abc293_e)\n\n## \u9898\u610f\n\n\u7ed9\u5b9a $A, X, M$\uff0c\u8bf7\u4f60\u6c42\u51fa $\\sum \\limits _{i = 0} ^ {X - 1} A ^ i \\mod m$\u3002\n\n$1 \\le X \\le 10 ^ {12}, 1 \\le A, M \\le 10 ^ 9$\n\n## \u601d\u8def\n\n\u9996\u5148\uff0c\u8fd9\u9898\u6709\u4e00\u4e2a\u5f88\u660e\u663e\u7684\u66b4\u529b\uff1a\u679a\u4e3e\u6240\u6709\u7684 $i$\uff0c\u5c06\u6240\u6709 $A ^ i$ \u7d2f\u52a0\u8d77\u6765\u3002\n\n\u4f46\u662f\u8fd9\u6837\u7684\u8bdd\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(X)$\uff0c\u59a5\u59a5\u7684\u8d85\u65f6\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e00\u79cd\u9012\u5f52\u5206\u6cbb\u7684\u505a\u6cd5\u3002\n\n\u4ee4 $S(n) = A ^ 1 + A ^ 2 + \\dots A ^ n$\u3002\n\n- \u82e5 $n$ \u4e3a\u5076\u6570\uff1a\n\n$S(n) = S(n / 2) + A ^ {n / 2 + 1} + \\dots A ^ n$\n\n$ = S(n / 2) + (A ^ 1 \\times A ^ {n / 2}) + \\dots + (A ^ {n / 2} \\times A ^ {n / 2})$\n\n$ = S(n / 2) + (A ^ 1 + A ^ 2 + \\dots A ^ {n / 2}) \\times A ^ {n / 2}$\n\n$ = S(n / 2) + S(n / 2) \\times A ^ {n / 2}$\n\n\u5b9e\u9645\u4e0a\uff0c$n$ \u4e3a\u5947\u6570\u7684\u60c5\u51b5\u4e0e\u5076\u6570\u5e76\u6ca1\u6709\u4ec0\u4e48\u4e0d\u540c\uff0c\u53ea\u662f\u8981\u5728\u6c42\u548c\u7684\u65f6\u5019\u591a\u52a0\u4e0a\u4e00\u4e2a $A ^ n$ \u800c\u5df2\u3002\n\n- \u82e5 $n$ \u4e3a\u5947\u6570\uff1a\n\n$S(n) = S(\\lfloor n / 2 \\rfloor) + A ^ {\\lfloor n / 2 \\rfloor + 1} + \\dots A ^ n$\n\n$ = S(\\lfloor n / 2 \\rfloor) + (A ^ 1 \\times A ^ {\\lfloor n / 2 \\rfloor}) + \\dots + (A ^ {\\lfloor n / 2 \\rfloor} \\times A ^ {\\lfloor n / 2 \\rfloor}) + A ^ n$\n\n$ = S(\\lfloor n / 2 \\rfloor) + (A ^ 1 + A ^ 2 + \\dots A ^ {\\lfloor n / 2 \\rfloor}) \\times A ^ {\\lfloor n / 2 \\rfloor} + A ^ n$\n\n$ = S(\\lfloor n / 2 \\rfloor) + S(\\lfloor n / 2 \\rfloor) \\times A ^ {\\lfloor n / 2 \\rfloor} + A ^ n$\n\n\u7531\u4e8e\u8fd9\u91cc\u6211\u5b9a\u4e49\u7684\u662f $S(n) = A ^ 1 + \\dots + A ^ n$\uff0c\u6240\u4ee5\u8981\u5c06 $A ^ 0$ \u518d\u6700\u540e\u5355\u72ec\u8ba1\u7b97\u4e00\u4e0b\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nint a, m;\nlong long w;\n\nstruct Node {\n  long long x, y; \n};\n\nNode P(long long t) {\n  if (t <= 1) {\n    /*\n    \u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u4e4b\u6240\u4ee5\u8981\u5199\u6210 t <= 1\uff0c\u662f\u56e0\u4e3a w \u6709\u53ef\u80fd\u4e3a 1\n    \u82e5 w = 1\uff0c\u90a3\u4e48\u4f20\u8fdb\u6765\u7684 t \u5c31\u4f1a\u662f 0\uff0c\u5982\u679c\u53ea\u5224\u65ad t == 1\uff0c\u4f1a\u65e0\u9650\u9012\u5f52\uff0cRE\n    */\n    return {t * a % m, t * a % m};\n  }\n  Node x = P(t / 2);\n  long long p = x.x * x.x % m;\n  // x.x \u4e3a A ^ (t / 2)\uff0cx.y \u4e3a A ^ 1 + ... + A ^ (t / 2)\n  x.y = (x.y + x.y * x.x % m) % m;  // \u6c42\u548c\n  if (t % 2 == 1) {  // \u82e5 n \u4e3a\u5947\u6570 \n    p = p * a % m, x.y = (x.y + p) % m;\n  }\n  x.x = p;\n  return x;\n}\n\nint main() {\n  cin >> a >> w >> m;\n  // P(w - 1) \u6c42 A ^ 1 + ... + A ^ (w - 1)\n  cout << (P(w - 1).y + 1) % m;\n  return 0;\n}\n```",
        "postTime": 1678764373,
        "uid": 658291,
        "name": "chengning0909",
        "ccfLevel": 4,
        "title": "abc293 E \u9898\u89e3"
    },
    {
        "content": "\u8bf4\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u5206\u6cbb\u505a\u6cd5\u3002  \n\u5148\u628a\u5f0f\u5b50\u5199\u4e0b\u6765\uff1a  \n$A^0 + A^1 + A^2 + A^3 + \\cdots + A^{X-1}$  \n\u5982\u679c\u5c06\u5f0f\u5b50\u7684\u524d $\\lfloor \\frac{X}{2} \\rfloor$ \u9879\u4e0e\u540e\u9762\u7684\u9879\u5206\u5f00\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u524d\u534a\u90e8\u5206\u8ba1\u7b97\u51fa\u6765\u540e\u53ef\u4ee5\u5feb\u901f\u8ba1\u7b97\u5f97\u5230\u540e\u534a\u90e8\u5206\u3002  \n\n\u8bbe\u524d\u534a\u90e8\u5206 $res_1 = A^0 + A^1 + A^2 + \\cdots + A^{\\lfloor \\frac{x}{2} \\rfloor -1}$\u3002  \n\n\u5047\u8bbe $X$ \u662f\u5076\u6570\uff0c\u90a3\u4e48\u540e\u534a\u90e8\u5206\u5373 $A^{\\lfloor \\frac{X}{2}\\rfloor} + \\cdots + A^{X-1} = A^{\\lfloor \\frac{X}{2}\\rfloor} \\cdot res_1$\u3002  \n\n\u82e5 $X$ \u662f\u5947\u6570\uff0c\u90a3\u5c31\u5148\u6309 $X$ \u662f\u5076\u6570\u7684\u5f0f\u5b50\u8ba1\u7b97\uff0c\u6700\u540e\u5728\u539f\u6765\u7684\u7b54\u6848\u7684\u57fa\u7840\u4e0a\u52a0\u4e0a $A^{X-1}$ \u5373\u53ef\u3002  \n\n\u73b0\u5728\u5c31\u627e\u51fa\u4e86\u5df2\u77e5\u524d\u534a\u90e8\u5206\uff0c$O(1)$ \u5f97\u77e5\u540e\u534a\u90e8\u5206\u7684\u65b9\u6cd5\u3002  \n\n\u5206\u6cbb\u5373\u53ef\u3002  \n\n[Atcoder \u63d0\u4ea4\u8bb0\u5f55](https://atcoder.jp/contests/abc293/submissions/39636293)",
        "postTime": 1678614996,
        "uid": 507348,
        "name": "__vector__",
        "ccfLevel": 0,
        "title": "ABC293E \u9898\u89e3"
    },
    {
        "content": "# ATABC293E Geometric Progression\n\n[\u5728\u6211\u7684\u535a\u5ba2\u56ed\u4e2d\u67e5\u770b](https://www.cnblogs.com/forgot-dream/p/17208266.html)\n\n\u611f\u89c9\u81ea\u5df1\u5199\u4e86\u4e00\u4e2a\u795e\u79d8\u505a\u6cd5\u3002\n\n### \u9898\u610f\n\n\u7ed9\u4f60\u4e09\u4e2a\u6574\u6570 $A$\uff0c$M$ \u4e0e $X$\uff0c\u6c42\uff1a\n\n$$\n\\sum_{i = 0}^{X - 1} A^i\n$$\n\n\u5bf9 $M$ \u53d6\u6a21\u540e\u7684\u503c\u3002\n\n$1 \\le A, m \\le 10^9$\uff0c$1 \\le X \\le 10^{12}$\u3002\n\n### \u601d\u8def\n\n\u8003\u573a\u4e0a\u7b2c\u4e00\u773c\u770b\u8fd9\u4e2a\u9898\u60f3\u5230\u7684\u662f\u7528\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n\n$$\n\\sum_{i = 0}^{X - 1} A^i = \\frac{A^{X} - 1}{A - 1}\n$$\n\n\u7136\u540e\u9664\u6cd5\u7528\u9006\u5143\u505a\u4e00\u4e0b\u3002\u7ed3\u679c\u5ffd\u7565\u4e86\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u4e8b\u5b9e\uff0c\u5c31\u662f\u9898\u76ee\u6ca1\u6709\u4fdd\u8bc1 $A - 1$ \u4e0e $M$ \u4e92\u8d28\uff0c\u8fde\u7eed WA \u4e86 3 \u6b21\u624d\u53d1\u89c9\u4e0d\u5bf9\u52b2\u3002\n\n\u8fd9\u9053\u9898\u7684\u5b98\u65b9\u9898\u89e3\u662f\u77e9\u9635\u5feb\u901f\u5e42\uff1f\u6211\u504f\u4e0d\u7528~~\u5176\u5b9e\u662f\u4e0d\u4f1a~~\uff01\n\n\u4e0b\u9762\u662f\u6211\u505a\u8fd9\u9053\u9898\u7684\u601d\u8def\u3002\n\n\u7531\u4e8e\u6211\u4eec\u6709 $\\sqrt{10^{12}} = 10^6$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4ece\u8fd9\u65b9\u9762\u627e\u627e\u601d\u8def\uff08\u8c01\u4f1a\u8fd9\u4e48\u60f3\u554a\u5582\uff09\uff0c\u8003\u8651\u5c06\u539f\u5f0f\u5206\u6210 $\\sqrt{X}$ \u5757\u540e\u518d\u505a\u524d\u7f00\u548c\uff0c\u8bbe $B = \\lfloor\\sqrt{X}\\rfloor$\uff0c\u8bb0\u7b2c\u4e00\u5757\u7684\u503c\u4e3a $sum$\uff0c\u6709\uff1a\n\n$$\nsum= \\sum_{i = 0}^{B - 1} A^i\n$$\n\n\u7136\u540e\u901a\u8fc7\u4e00\u4e2a\u5c0f\u5c0f\u7684\u9012\u63a8\u5f97\u5230\u6bcf\u4e00\u5757\u7684\u503c\u3002\u5177\u4f53\u5730\uff0c\u6709\u7b2c $i$ \u5757\u7684\u503c\u4e3a $sum \\times A^{(i - 1)B}$\u3002\u6700\u540e\u5269\u4e00\u4e2a\u6563\u5757\u66b4\u529b\u7d2f\u52a0\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n\n\u90a3\u4e48\u6700\u7ec8\u7684\u7b54\u6848\u5c31\u4e3a\uff1a\n\n$$\nans = \\sum_{i = 1}^{B} sum \\times A^{(i - 1)B} + \\sum_{i = B^2}^{X - 1} A^i\n$$\n\n\n\u7531\u4e8e\u6211\u592a\u50bb\u4e86\uff0c\u662f\u76f4\u63a5\u5728\u5faa\u73af\u4e2d\u7528\u5feb\u901f\u5e42\u8ba1\u7b97\u5e42\u6b21\u7684\uff0c\u6240\u4ee5\u6211\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sqrt{X}\\log{X})$ \u7ea7\u522b\u7684\uff0c\u4f46\u4e8b\u5b9e\u4e0a\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa $\\sqrt{X}$ \u5185\u7684 $A$ \u7684\u5e42\u6b21\uff0c\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sqrt{X})$\u3002\u867d\u7136\u4e0d\u5982\u5176\u4ed6\u7684\u795e\u4ed9\u505a\u6cd5\uff0c\u4e0d\u8fc7\u5df2\u7ecf\u8db3\u591f\u597d\u4e86\u3002\n\n### \u4ee3\u7801\n\n\u4ee3\u7801\u5176\u5b9e\u975e\u5e38\u597d\u5199\uff0c\u6bd5\u7adf\u662f\u4f18\u96c5\u7684\u66b4\u529b\u3002\n\n\u6211\u5728\u4e00\u4e9b\u5947\u602a\u7684\u5730\u65b9\u7528\u4e86 `__int128`\uff0c\u4e0d\u8fc7\u4e8b\u5b9e\u4e0a\u5b8c\u5168\u4e0d\u7528\uff0c\u53ea\u662f\u6211\u8d5b\u65f6\u53d1\u766b\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nusing i64 = long long;\nusing i128 = __int128;\n\ni64 fastPow(i64 base, i64 pow, i64 mod) {\n  i64 res = 1;\n  while (pow) {\n    if (pow & 1) {\n      (res *= base) %= mod;\n    }\n    (base *= base) %= mod;\n    pow >>= 1;\n  }\n  return res;\n}\n\nint main() {\n  std::ios::sync_with_stdio(false);\n  std::cin.tie(0);\n\n  i64 a, m, x;\n  std::cin >> a >> x >> m;\n\n  i64 powNum = 0;\n  int block = std::sqrt(x);\n  for (int i = 0; i < block; i++) {\n    (powNum += fastPow(a, i, m)) %= m;\n  }\n\n  i64 ans = 0;\n  for (int i = 1; i <= block; i++) {\n    (ans += fastPow(a, ((i64) (i - 1) * block), m) * i128(powNum)) %= m;\n  }\n\n  if ((i64) block * block != x) {\n    for (i64 i = (i64) block * block; i < x; i++) {\n      (ans += fastPow(a, i, m)) %= m;\n    }\n  }\n\n  std::cout << ans << \"\\n\";\n\n  return 0;\n}\n```\n",
        "postTime": 1678606548,
        "uid": 750067,
        "name": "ForgotDream_CHN",
        "ccfLevel": 0,
        "title": "ATABC293E Geometric Progression"
    },
    {
        "content": "# [ABC293E] Geometric Progression \u9898\u89e3\n\n## \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a $a,x,m$\uff0c\u6c42 $\\sum_{i=0}^{x-1}a^i$ \u5bf9 $m$ \u53d6\u6a21\u7684\u503c\u3002\u6ce8\u610f\u6ca1\u6709\u4fdd\u8bc1 $m$ \u4e3a\u8d28\u6570\u3002\n\n## \u89e3\u51b3\u65b9\u6848\n\n\u6570\u5b66\u9898\u3002\n\n\u5982\u679c $m$ \u4e3a\u8d28\u6570\uff0c\u90a3\u4e48\u5168\u56fd\u4eba\u6c11\u90fd\u4f1a\u505a\uff0c\u4e00\u4e2a\u9006\u5143\u5373\u53ef\u3002\n\n\u7136\u800c\uff0c\u8fd9\u91cc\u5e76\u6ca1\u6709\u4fdd\u8bc1\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u5728\u60f3\u4e2a\u529e\u6cd5\u3002\n\n### \u5feb\u901f\u5e42\n\n\u8fd9\u4e2a\u5de5\u5177\u7b80\u5355\u8bf4\u4e00\u4e0b\uff0c$a^x=(a^{x/2})^2\\times (a)[x\\mod2=1]$\u3002\n\n### \u5206\u5757\n\n\u6211\u4eec\u5c06\u6240\u6c42\u5206\u6210\u957f\u5ea6\u4e3a $len=\\sqrt x$ \u5757\uff0c\u5e76\u4e14\u6709 $num$ \u4e2a\u6574\u5757\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6574\u5757\uff0c\u53ef\u4ee5\u5f88\u5feb\u6c42\u51fa\u5b83\u4eec\u7684\u5de6\u53f3\u7aef\u70b9\uff0c\u8bb0\u4e3a $l,r$\uff0c\u5219\u8fd9\u4e00\u5757\u7684\u7b54\u6848\u4e3a $a^l+a^{l+1}+\\dots+a^r$\uff0c\u63d0\u53d6 $a^l$ \u5f97 $a^l\\times(a^0+a^1+\\dots+a^{r-l=len-1})$\u3002\u6bcf\u4e00\u5757\u7684\u540e\u534a\u90e8\u5206\u90fd\u4e00\u6837\uff0c\u53ef\u9884\u5904\u7406\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sqrt x\\times\\log(x))$\uff0c\u53ef\u4ee5\u63a5\u53d7\u3002\u6bcf\u4e00\u5757\u8981\u518d\u7b97\u4e00\u904d $a^l$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sqrt x\\times\\log(x))$\uff0c\u53ef\u4ee5\u63a5\u53d7\u3002\u6700\u540e\u5269\u7684\u4e00\u5c0f\u5757\u66b4\u529b\u8ba1\u7b97\u6bcf\u4e00\u9879\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sqrt x\\times\\log(x))$\uff0c\u53ef\u4ee5\u63a5\u53d7\u3002\u7efc\u4e0a\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sqrt x\\times\\log(x))$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\u672c\u9898\u5f97\u89e3\u3002\n\n### \u4ee3\u7801\n\n\u5176\u5b9e\u6839\u636e\u4e0a\u8ff0\u89e3\u6cd5\u5f88\u597d\u5b9e\u73b0\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;typedef long long ll;\nll a,x,MOD,len,num,per,res,l,r,ans,i;\ninline ll qpow(ll x,ll y){//\u5feb\u901f\u5e42\uff0c\u6570\u8bba\u5fc5\u5907\n\tres=1;\n\twhile(y){\n\t\tif(y&1)(res*=x)%=MOD;\n\t\t(x*=x)%=MOD,y>>=1;\n\t}\n\treturn res;\n}\nint main(){\n\tscanf(\"%lld%lld%lld\",&a,&x,&MOD),len=sqrt(x),num=x/len;\n\tfor(i=0;i<len;i++)(per+=qpow(a,i))%=MOD;//\u8ba1\u7b97\u540e\u534a\u90e8\u5206\n\tfor(i=1;i<=num;i++)\n\t\tl=(i-1)*len,r=i*len-1,(ans+=qpow(a,l)*per)%=MOD;//\u8ba1\u7b97\u6bcf\u4e00\u5757\n\tif(x%len)for(i=r+1;i<x;i++)(ans+=qpow(a,i))%=MOD;//\u6700\u540e\u5269\u4e0b\u7684\n\treturn printf(\"%lld\\n\",ans),0;\n}\n```",
        "postTime": 1678593827,
        "uid": 367359,
        "name": "Neil_Qian",
        "ccfLevel": 6,
        "title": "[ABC293E] Geometric Progression \u9898\u89e3"
    },
    {
        "content": "# [ABC293E] Geometric Progression \u9898\u89e3\n\n## \u9898\u610f\n\n\u7ed9\u5b9a $a,n,m$\uff0c\u6c42\n\n$$ \\sum\\limits_{i=1}^{n-1}a^i\\bmod{m} $$\n\n## \u5206\u6790\n\n\u6211\u4eec\u6bcf\u6b21\u8fd0\u7528\u4e58\u6cd5\u5206\u914d\u5f8b\uff0c\u6bcf\u6b21\u63d0\u53d6\u516c\u56e0\u5f0f\uff0c\u4e0b\u9762\u4ee5 $n=5$ \u6765\u4e3e\u4f8b\n\n$$\n\\begin{aligned}\n\\\\&1+a^1+a^2+a^3+a^4\n\\\\&=1+a(1+a^1+a^2+a^3)\n\\\\&=1+a(1+a(1+a^1+a^2))\n\\\\&=1+a(1+a(1+a(1+a)))\n\\end{aligned}\n$$\n\n\u663e\u7136\uff0c\u5c31\u662f\u505a $n-1$ \u6b21 $\\times a+1$\u3002\n\n\u4f46\u662f,$1\\leq n\\leq 10^{12}$\uff0c\u4f1a TLE\u3002\n\n\u6211\u4eec\u8003\u8651\uff1a\n\n\u628a $f_0=1$\uff0c\n\n\u5219 $f_i=f_{i-1}\\times a+1$\uff0c\n\n\u6240\u4ee5\u7b54\u6848\u4e3a $f_{n-1}$\u3002\n\n\u800c\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6765\u6c42\uff0c\u6240\u4ee5\u65f6\u95f4\u4e3a $O(\\log{n})$\uff0c\u53ef\u8fc7\u3002\n\n\u77e9\u9635\u4e3a\uff1a\n\n$$\n\n\\begin{bmatrix}\n1,1\n\\end{bmatrix}\\times\n\\begin{bmatrix}\na,0\n\\\\1,1\n\\end{bmatrix}^{n-1}\n\n$$\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||'9'<c){if(c=='-')f=-1;c=getchar();}\n\twhile('0'<=c&&c<='9'){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n\treturn x*f;\n}\nconst int N=3;\nint x,n,mod;\nstruct qwq{\n\tint n,m,num[N][N];\n}ans,a;\nvoid print(qwq x){\n\tfor(int i=1;i<=x.n;puts(\"\"),i++)\n\t\tfor(int j=1;j<=x.m;j++)\n\t\t\tprintf(\"%lld \",x.num[i][j]);\n\treturn;\n}\nqwq operator*(const qwq &x,const qwq &y){\n\tqwq c;c.n=x.n;c.m=y.m;\n\tfor(int i=1;i<=c.n;i++)\n\t\tfor(int j=1;j<=c.m;j++)\n\t\t\tc.num[i][j]=0;\n\tfor(int i=1;i<=x.n;i++)\n\t\tfor(int j=1;j<=y.m;j++)\n\t\t\tfor(int k=1;k<=x.m;k++) \n\t\t\t\t(c.num[i][j]+=x.num[i][k]*y.num[k][j]%mod)%=mod;\n\treturn c;\n}\nqwq ksm(qwq a,int b){\n\tqwq t;t.n=t.m=2;\n\tt.num[1][1]=t.num[2][2]=1;\n\tt.num[1][2]=t.num[2][1]=0;\n\tfor(;b;b>>=1,a=a*a)if(b&1)t=t*a;\n\treturn t;\n}\nsigned main(){\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tx=read();n=read()-1;mod=read();\n\tans.n=1,ans.m=2;\n\tans.num[1][1]=ans.num[1][2]=1;\n\ta.n=a.m=2;\n\ta.num[1][1]=x;a.num[2][1]=a.num[2][2]=1;\n\ta.num[1][2]=0;\n\tqwq t=ksm(a,n);\n\tans=ans*t;\n\tprintf(\"%lld\\n\",ans.num[1][1]);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1678587400,
        "uid": 171868,
        "name": "sunzz3183",
        "ccfLevel": 4,
        "title": "[ABC293E] Geometric Progression \u9898\u89e3"
    },
    {
        "content": "\u7531\u4e8e\u6a21\u6570\u4e0d\u4e00\u5b9a\u662f\u5927\u8d28\u6570\uff0c\u6211\u4eec\u4e0d\u80fd\u76f4\u63a5\u5957\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\u3002\n\n\u6362\u4e00\u79cd\u601d\u8def\uff0c\u6570\u5217 $\\langle1,A,A^2,\\cdots,A^{X-1}\\rangle$ \u53ef\u4ee5\u770b\u505a\u7ebf\u6027\u9012\u63a8\uff0c\u56e0\u6b64\u8bbe\u8ba1\u77e9\u9635\uff1a\n\n$$\n\\boldsymbol T=\n\\begin{bmatrix}\nA & 0 \\\\\n1 & 1 \\\\\n\\end{bmatrix}\n$$\n\n\u663e\u7136\u6709\uff1a\n\n$$\n\\begin{bmatrix}\nA^i \\\\\nS_{i-1} \\\\\n\\end{bmatrix}\n\\boldsymbol T\n=\n\\begin{bmatrix}\nA^{i+1}\\\\\nS_i \\\\\n\\end{bmatrix}\n$$\n\n\u56e0\u6b64 $\\boldsymbol T^X$ \u7684\u5de6\u4e0b\u89d2\u5143\u7d20\u5373\u4e3a\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(\\log X)$\u3002\n\n```cpp\n// Problem: E - Geometric Progression\n// Contest: AtCoder - AtCoder Beginner Contest 293\n// URL: https://atcoder.jp/contests/abc293/tasks/abc293_e\n// Memory Limit: 1024 MB\n// Time Limit: 2000 ms\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n//By: OIer rui_er\n#include <bits/stdc++.h>\n#define rep(x,y,z) for(ll x=(y);x<=(z);x++)\n#define per(x,y,z) for(ll x=(y);x>=(z);x--)\n#define debug(format...) fprintf(stderr, format)\n#define fileIO(s) do{freopen(s\".in\",\"r\",stdin);freopen(s\".out\",\"w\",stdout);}while(false)\n#define likely(exp) __builtin_expect(!!(exp), 1)\n#define unlikely(exp) __builtin_expect(!!(exp), 0)\nusing namespace std;\ntypedef long long ll;\n\nmt19937 rnd(std::chrono::duration_cast<std::chrono::nanoseconds>(std::chrono::system_clock::now().time_since_epoch()).count());\nll randint(ll L, ll R) {\n\tuniform_int_distribution<ll> dist(L, R);\n\treturn dist(rnd);\n}\n\ntemplate<typename T> void chkmin(T& x, T y) {if(x > y) x = y;}\ntemplate<typename T> void chkmax(T& x, T y) {if(x < y) x = y;}\n\nll a, x, m;\n\nstruct Matrix {\n\tll a[2][2];\n\tMatrix() {memset(a, 0, sizeof(a));}\n\tfriend Matrix operator*(const Matrix& a, const Matrix& b) {\n\t\tMatrix c;\n\t\trep(i, 0, 1) rep(j, 0, 1) rep(k, 0, 1) (c.a[i][j] += a.a[i][k] * b.a[k][j] % m) %= m;\n\t\treturn c;\n\t}\n\tfriend Matrix operator^(Matrix a, ll k) {\n\t\tMatrix c;\n\t\tc.a[0][0] = c.a[1][1] = 1;\n\t\tfor(; k; k >>= 1, a = a * a) if(k & 1) c = c * a;\n\t\treturn c;\n\t}\n}mat;\n\n/*\nu * a 0 = a*u\ns   1 1   s+u\n*/\n\nint main() {\n\tscanf(\"%lld%lld%lld\", &a, &x, &m);\n\tmat.a[0][0] = a % m;\n\tmat.a[1][0] = mat.a[1][1] = 1;\n\tmat = mat ^ x;\n\tprintf(\"%lld\\n\", mat.a[1][0]);\n\treturn 0;\n}\n```",
        "postTime": 1678581364,
        "uid": 122461,
        "name": "rui_er",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 ABC293E\u3010Geometric Progression\u3011"
    }
]
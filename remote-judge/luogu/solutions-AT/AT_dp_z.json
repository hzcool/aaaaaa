[
    {
        "content": "# AT4547 \u9898\u89e3\n## Upd 9.19.2021:\u4fee\u6539\u4e86\u4e00\u4e2a\u8868\u8ff0\u95ee\u9898\n\u53ef\u80fd\u662f\u697c\u4e0a\u7684\u5de8\u4f6c\u8ba4\u4e3a\u659c\u7387\u4f18\u5316\u592a\u7b80\u5355\u4e86\uff0c\u5c31\u8bb2\u7684\u975e\u5e38\u7b80\u7565\uff0c\u90a3\u4f5c\u4e3a\u4e00\u4e2a\u521a\u5b66\u659c\u7387\u4f18\u5316\u7684\u65b0\u624b\uff0c\u6211\u5c31\u6765\u7565\u5fae\u8be6\u7ec6\u4e00\u70b9\u7684\u8bb2\u8bb2\u659c\u7387\u4f18\u5316\u662f\u5982\u4f55\u4f18\u5316\u52a8\u6001\u89c4\u5212\u7684\u8f6c\u79fb\u7684\u3002\n\n\u770b\u5230\u9898\u9762\uff0c\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u663e\u7136\u7684\u63a8\u51fa\u4e00\u4e2aDP\u5f0f\uff1a\n\n\u8bb0 $dp_i$ \u4e3a\u8df3\u5230\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u7684\u6700\u5c0f\u82b1\u8d39\uff0c\u5219\u6211\u4eec\u6709\uff1a\n\n$dp_i=min(dp_j+(h_j-h_i)^2+c) ,0<j<i$.\n\n\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5c06\u5f0f\u5b50\u4e2d\u7684 $(h_j-h_i)^2$ \u53ef\u4ee5\u62c6\u5f00\u4e3a\uff1a\n\n$(h_j-h_i)^2 = h_j^2 - 2 \\times h_j \\times h_i + h_i^2$.\n\n\u800c\u539f\u8f6c\u79fb\u5f0f\u4e2d\u7684 $h_i^2+c$ \u4e0e $j$ \u7684\u53d6\u503c\u5e76\u65e0\u5173\u8054, \u6545\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u4eec\u4ece $min$ \u5f0f\u4e2d\u63d0\u51fa\u6765\uff1a\n\n$dp_i=min(dp_j+h_j^2-2 \\times h_j \\times h_i)+h_i^2+c$.\n\n\u6211\u4eec\u53d1\u73b0\uff0c $h_i^2+c$ \u4e0e $h_j^2$ \u4e24\u9879\u90fd\u5f88\u597d\u5904\u7406\uff0c\u4f46\u5c31\u662f\u4e2d\u95f4\u7684 $2 \\times h_j \\times h_i$ \u8fd9\u4e2a\u4e0e $i$ \u548c $j$ \u90fd\u6709\u5173\u8054\u7684\u9879\u5f88\u4e0d\u597d\u5904\u7406\u3002\n\n\u6211\u4eec\u5047\u8bbe\u8f6c\u79fb\u5f0f\u4e2d\uff0c\u4f7f\u5f97 $dp_i$ \u6700\u5c0f\u7684\u4e00\u4e2a $j$ \u503c\u4e3a $k$ ,\u90a3\u4e48\u6211\u4eec\u6b64\u65f6\u5c31\u53ef\u4ee5\u628a $min$ \u7ed9\u53bb\u6389\uff0c\u5373\uff1a\n\n$dp_i=dp_k+h_k^2-2 \\times h_k \\times h_i+h_i^2+c$\n\n\u5bf9\u5f0f\u5b50\u53d8\u4e00\u4e2a\u5f62\uff0c\u5c31\u6709\uff1a\n\n$dp_k+h_k^2=(2 \\times h_i) \\times h_k+dp_i-h_i^2-c$.\n\n\u53d1\u73b0\u8fd9\u4e2a\u5f88\u50cf\u4ec0\u4e48\uff1f\u662f\u4e0d\u662f\u5f88\u50cf\u4e00\u4e2a $dp_k+h_k^2$ \u5173\u4e8e $h_k$ \u7684\u4e00\u6b21\u51fd\u6570\uff1f\n\n\u90a3\u4e48\u8fd9\u65f6\u5019\u6211\u4eec\u5c31\u7528\u4e00\u4e2a\u4e8c\u7ef4\u5750\u6807\u7cfb\u6765\u663e\u5f0f\u5730\u8868\u793a\u8fd9\u4e2a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n\u5c06 $(x=h_k,y=dp_k+h_k^2)$ \u8fd9\u4e2a\u4e8c\u5143\u7ec4\u62bd\u8c61\u6210\u5728\u4e8c\u7ef4\u5750\u6807\u7cfb\u4e0a\u7684\u4e00\u4e2a\u70b9\uff0c\u800c\n\n$dp_k+h_k^2=(2 \\times h_i) \\times h_k+dp_i-h_i^2-c$\n\n\u5c31\u662f\u4e00\u4e2a\u5f62\u5982 $y=kx+b$ \u7684\u4e00\u6b21\u51fd\u6570\uff0c\u5176\u4e2d\uff1a\n\n$k=2 \\times h_i$ ,\n\n$b=2 \\times dp_i-h_i^2-c$ .\n\n\u6211\u4eec\u518d\u89c2\u5bdf\u4e00\u4e0b\u51fd\u6570\u7684\u7279\u5f81\uff0c\u5c31\u53ef\u53d1\u73b0\uff0c\u51fd\u6570\u7684\u622a\u8ddd\uff0c\u5373 $b$ \u7adf\u7136\u53ea\u4e0e\u6211\u4eec\u9700\u8981\u6700\u5c0f\u5316\u7684 $dp_i$ \u548c\u4e00\u4e9b\u5e38\u6570\u6709\u5173\uff01\n\n\u90a3\u4e48\uff0c\u6b64\u65f6\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u4e86\u4e00\u4e2a\u7ebf\u6027\u89c4\u5212\u95ee\u9898\uff1a\n\n\u6709\u4e00\u6761\u659c\u7387\u56fa\u5b9a\uff0c\u6700\u521d\u4f4d\u7f6e\u5bf9\u5e94\u622a\u8ddd\u4e3a $-inf$ \u7684\u76f4\u7ebf\uff0c\u5c06\u76f4\u7ebf\u6162\u6162\u4e0a\u632a\uff0c\u76f4\u5230\u76f4\u7ebf\u7b2c\u4e00\u6b21\u78b0\u5230\u67d0\u4e00\u4e2a\u70b9\uff0c\u6c42\u51fa\u6b64\u65f6\u76f4\u7ebf\u7684\u622a\u8ddd\u3002\n\n\u66f4\u5f62\u5f0f\u5316\u7684\u8bf4\uff0c\u5c31\u662f\u7ed9\u5b9a\u4e86\u76f4\u7ebf\u7684\u659c\u7387\uff0c\u8981\u6c42\u4ece\u5df2\u6709\u7684 $n$ \u4e2a\u70b9\u4e2d\u627e\u51fa\u4e00\u4e2a\u70b9\u4f7f\u76f4\u7ebf\u7ecf\u8fc7\u8be5\u70b9\uff0c\u5e76\u8981\u6c42\u8fd9\u6837\u786e\u5b9a\u7684\u76f4\u7ebf\u662f\u6240\u6709 $n$ \u79cd\u4e0d\u540c\u7684\u53ef\u80fd\u76f4\u7ebf\u4e2d\uff0c\u622a\u8ddd\u6700\u5c0f\u7684\u4e00\u6761\uff0c\u5e76\u6c42\u51fa\u8be5\u76f4\u7ebf\u7684\u622a\u8ddd\u3002\n\n\u8fd9\u4e2a\u53c8\u600e\u4e48\u505a\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\uff0c\u5982\u679c $n$ \u4e2a\u70b9\u5f62\u6210\u4e86\u4e00\u4e2a\u4e0b\u51f8\u58f3\uff0c\n\n\u5373\u5bf9\u4e8e\u4efb\u610f $i$ \uff0c\u90fd\u6709\n\n$((y_i-y_{i-1})/(x_i-x_{i-1})>(y_i-y_{i+1})/(x_i-x_{i+1}))$ \uff0c\n\n\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u5c31\u53ea\u9700\u8981\u627e\u5230\u5f53\u524d\u51f8\u58f3\u4e2d\u7684\u67d0\u4e2a\u70b9\uff0c\u662f\u8be5\u70b9\u4e0e\u5176\u5de6\u8fb9\u70b9\u659c\u7387\u6bd4 $k$ \u5c0f\uff0c\u53f3\u8fb9\u7684\u6bd4 $k$ \u5927\uff0c\u90a3\u4e48\u8fd9\u4e2a\u70b9\u5c31\u662f\u7b54\u6848\u76f4\u7ebf\u6240\u5bf9\u5e94\u7684\u70b9\u4e86\u3002\n\n\u5f53\u7136\uff0c\u82e5\u662f\u6709\u4e00\u4e2a\u70b9\u4e0e\u5176\u76f8\u90bb\u7684\u70b9\u95f4\u6ca1\u6709\u5f62\u6210\u51f8\u58f3\uff0c\u5373\u82e5\u6709 $i$ \u4e0d\u6ee1\u8db3\u4e0a\u8ff0\u5bf9\u4e8e\u659c\u7387\u7684\u8981\u6c42\uff0c\u90a3\u4e48\u8fd9\u4e2a\u70b9\u4e0d\u53ef\u80fd\u4f5c\u4e3a\u6700\u4f18\u70b9\u88ab\u9009\u62e9\uff0c\u56e0\u4e3a\u65e0\u8bba\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\uff0c\u5176\u4e24\u4e2a\u76f8\u90bb\u70b9\u4e2d\u5fc5\u6709\u4e00\u4e2a\u6bd4\u5b83\u66f4\u4f18\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u5b9e\u73b0\u4e00\u4e2a\u5feb\u901f\u7ef4\u62a4\u652f\u6301\u63d2\u5165\uff0c\u5f39\u51fa\u7684\u4e0b\u51f8\u58f3\u7684\u6570\u636e\u7ed3\u6784\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u5355\u6b21\u5747\u644a\u590d\u6742\u5ea6 $O(1)$ \u7684\u5355\u8c03\u961f\u5217\u6765\u7ef4\u62a4\u51f8\u58f3\uff0c\u6545\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(N)$ \u7684\u3002\n\n**code\uff1a**\n\n```\nconst int N(2e5+10);\n\nint n,c;\n\nint h[N];\nint q[N];\nint dp[N];\n\ninline double X(int i){return h[i];}\ninline double Y(int i){return (dp[i]+(h[i]*h[i]));}\ninline double K(int i,int j){return ((Y(j)-Y(i))/(X(j)-X(i)));}\n\nsigned main(){\n\tn=read(),c=read();\n\trep(i,1,n)h[i]=read();\n\tint head=1,tail=1;\n\tq[1]=1+(dp[1]=0);\n\trep(i,2,n){\n\t\twhile(head<tail&&(h[i]<<1)>=K(q[head],q[head+1]))++head;\n\t\tdp[i]=dp[q[head]]+(h[q[head]]-h[i])*(h[q[head]]-h[i])+c;\n\t\twhile(head<tail&&K(i,q[tail])<=K(q[tail],q[tail-1]))--tail;\n\t\tq[++tail]=i;\n\t} cout<<dp[n];\n\treturn 0;\n}\n\n```",
        "postTime": 1631371789,
        "uid": 100091,
        "name": "GaryH",
        "ccfLevel": 6,
        "title": "AT4547 \u9898\u89e3"
    },
    {
        "content": "# [\u539f\u9898\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_dp_z)\n\n## Part 0\n\n\u659c\u7387\u4f18\u5316\u672c\u8d28\u4e0a\u5c31\u662f[\u5355\u8c03\u961f\u5217\u4f18\u5316](https://xyzl.blog.luogu.org/DQ-OP-DP)\u7684\u5347\u7ea7\u7248\u3002\n\n\u5728\u5b66\u4e60\u659c\u7387\u4f18\u5316\u4e4b\u524d\uff0c\u8bf7\u5148\u719f\u7ec3\u638c\u63e1\u5355\u8c03\u961f\u5217\u4f18\u5316\u3002\n\n## Part 1\n\n\u5bf9\u4e8e\u8fd9\u4e00\u9053\u9898\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u5f97\u51fa\u6734\u7d20 DP \u7684\u505a\u6cd5\u3002\u4e0d\u96be\u53d1\u73b0\uff1a\n\n$$dp_i = \\min_{0 \\leq j < i} \\{dp_j + (h_i - h_j)^2 + C\\}$$\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5148\u5199\u4e0b\u6734\u7d20 DP\uff0c\u4ee5\u4fbf\u5bf9\u62cd\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n**TLE Code**\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int mxn = 2e5;\nconst int N = mxn + 10;\nll n, h[N], dp[N], C;\nsigned main() {\n\tios::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n\tcin >> n >> C;\n\tfor(int i = 1; i <= n; ++ i) cin >> h[i];\n\tfor(int i = 2; i <= n; ++ i){\n\t\tdp[i] = 1e16;\n\t\tfor(int j = 0; j < i; ++ j)\n\t\t\tdp[i] = min(dp[i], dp[j] + (h[i] - h[j]) * (h[i] - h[j]) + C);\n\t}\n\tcout << dp[n];\n\treturn 0;\n} \n```\n\n## Part 2\n\n\u89c2\u5bdf\u4e0a\u9762\u7684\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06 $\\min$ \u4ee5\u5185\u7684\u5f0f\u5b50\u5316\u7b80\u4e3a\uff1a\n\n$$dp_j + h_i^2 + h_j^2 - 2h_ih_j + C$$\n\n\u5176\u4e2d\uff0c$h_i^2, C$ \u8fd9\u4e9b\u9879\u4e0e $j$ \u65e0\u5173\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u770b\u4f5c\u5e38\u91cf\u53d6\u51fa\uff0c\u5219\u5f0f\u5b50\u5269\u4e0b\uff1a\n\n$$dp_j + h_j^2 - 2h_ih_j$$\n\n\u800c $dp_j, h_j^2$ \u4ec5\u4e0e $j$ \u6709\u5173\uff0c\u8bbe $\\operatorname{f}(j) = dp_j + h_j^2$\uff0c\u5219\u5f0f\u5b50\u53d8\u4e3a\uff1a\n\n$$\\operatorname{f}(j) - 2h_ih_j$$\n\n\u518d\u8bbe $k = -2h_i$\uff0c\u5219\uff1a\n\n$$\\operatorname{f}(j) + h_j \\times k$$\n\n\u81f3\u6b64\uff0c\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\u5df2\u5316\u7b80\u5b8c\u6210\u3002\n\n## Part 3\n\n\u6b64\u65f6\uff0c\u8bbe $j1 < j2$\uff0c\u4e14 $j2$ \u4e0d\u6bd4 $j1$ \u4f18\uff0c\u4ec5\u5f53\uff1a\n\n$$\\operatorname{f}(j1) + h_{j1} \\times k \\leq \\operatorname{f}(j2) + h_{j2} \\times k$$\n\n\u79fb\u9879\u5f97\uff1a\n\n$$h_{j1} \\times k - h_{j2} \\times k \\leq \\operatorname{f}(j2) - \\operatorname{f}(j1)$$\n\n\u4e24\u8fb9\u540c\u65f6\u9664\u4ee5 $h_{j1} - h_{j2}$\uff0c\u7531\u4e8e $h_{j1} - h_{j2} < 0$\uff0c\u6240\u4ee5\u4e0d\u7b49\u5f0f\u8981\u53d8\u53f7\uff1a\n\n$$k \\geq \\frac{\\operatorname{f}(j2) - \\operatorname{f}(j1)}{h_{j1} - h_{j2}}$$\n\n\u5c06 $k = -2h_i$ \u4ee3\u5165\uff1a\n\n$$-2h_i \\geq \\frac{\\operatorname{f}(j2) - \\operatorname{f}(j1)}{h_{j1} - h_{j2}}$$\n\n\u4e0d\u7b49\u5f0f\u4e24\u8fb9\u540c\u65f6\u4e58 $-1$\uff1a\n\n$$2h_i \\leq \\frac{\\operatorname{f}(j1) - \\operatorname{f}(j2)}{h_{j1} - h_{j2}}$$\n\n$$\\frac{\\operatorname{f}(j1) - \\operatorname{f}(j2)}{h_{j1} - h_{j2}} \\geq 2h_i$$\n\n\u6b64\u65f6\u4e0d\u7b49\u5f0f\u7684\u5de6\u8fb9\u7c7b\u4f3c\u4e8e\u6c42\u659c\u7387\u7684\u516c\u5f0f\uff0c\u6545\u79f0\u4e3a**\u659c\u7387\u4f18\u5316**\u3002\n\n## Part 4\n\n\u672c\u6587\u5f00\u5934\u5df2\u7ecf\u8bf4\u8fc7\uff0c\u659c\u7387\u4f18\u5316\u672c\u8d28\u4e0a\u662f\u5355\u8c03\u961f\u5217\u4f18\u5316\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5fc5\u987b\u65f6\u523b\u7ef4\u62a4\u961f\u5217\u4e2d\u5143\u7d20\u7684\u5355\u8c03\u6027\u3002\n\n\u8bbe $\\operatorname{slope}(i, j) = \\frac{\\operatorname{f}(i) - \\operatorname{f}(j)}{h_{i} - h_{j}}$\uff0c\u8868\u793a $i, j$ \u4e24\u70b9\u4e4b\u95f4\u7684\u659c\u7387\u3002\n\n\u82e5\u6709 $pre, mid, nxt$ \u4e09\u4e2a\u8282\u70b9\uff0c\u4e14 $pre < mid < nxt$\uff0c\u82e5\u4f7f $mid$ \u4e3a\u6700\u4f18\u51b3\u7b56\u70b9\uff0c\u5fc5\u987b\u6ee1\u8db3\uff1a\n\n$$\\operatorname{slope}(pre, mid) \\leq 2h_i$$\n\n\u8868\u793a\u4e0d\u6ee1\u8db3 $pre$ \u6bd4 $mid$ \u4f18\uff0c\u4e14\uff1a\n\n$$\\operatorname{slope}(mid, nxt) \\geq 2h_i$$\n\n\u8868\u793a\u6ee1\u8db3 $mid$ \u6bd4 $nxt$ \u4f18\uff0c\u5373\uff1a\n\n$$\\operatorname{slope}(pre, mid) \\leq \\operatorname{slope}(mid, nxt)$$\n\n\u8fd9\u65f6\uff0c\u82e5\u6709\u4e09\u70b9\u72b6\u6001\u5982\u4e0b\u56fe\uff1a\n\n![](https://stream.lexar.com/downloadService/download/graph3.png?dKey=6398a5246fcd40763b98e46087a60e0a&type=2)\n\n\u901a\u8fc7\u89c2\u5bdf\uff0c\u6613\u5f97\uff1a\n\n$$\\operatorname{slope}(1,2) \\geq \\operatorname{slope}(2,3)$$\n\n\u56e0\u6b64\uff0c$2$ \u53f7\u70b9\u4e00\u5b9a\u4e0d\u662f\u6700\u4f18\u51b3\u7b56\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u5220\u53bb\u3002\n\n![](https://stream.lexar.com/downloadService/download/graph4.png?dKey=42a0d452fd6032214f8a9a657ff35be6&type=2)\n\n\u6700\u540e\uff0c\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4e1c\u897f\u5c31\u88ab\u7ef4\u62a4\u6210\u4e86\u4e00\u4e2a**\u51f8\u5305**\u3002\n\n![](https://stream.lexar.com/downloadService/download/graph5.png?dKey=b2e1d30ae2655d971996b7a9605874b7&type=2)\n\n## Part 5\n\n\u5f53\u7ef4\u62a4\u6210\u4e00\u4e2a\u51f8\u5305\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u961f\u5217\u4e2d\u7684\u5143\u7d20\u8fdb\u884c\u4e8c\u5206\uff0c\u627e\u5230\u659c\u7387\u5927\u4e8e\u7b49\u4e8e $2h_i$ \u7684\u6700\u5c0f\u8282\u70b9\uff0c\u7136\u540e\u8fdb\u884c\u8f6c\u79fb\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log n)$\u3002\n\n\u4f46\u6b64\u9898\u4e2d\uff0c$h$ \u662f\u4e00\u4e2a\u9012\u589e\u5e8f\u5217\uff0c\u5e76\u4e0d\u662f\u65e0\u5e8f\u7684\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4ee5\u5355\u8c03\u961f\u5217\u7684\u5f62\u5f0f\u4e0d\u65ad\u6254\u6389\u5934\u5143\u7d20\uff0c\u4ece\u800c\u627e\u5230\u6700\u4f18\u51b3\u7b56\u70b9\uff0c\u800c\u65e0\u9700\u4e8c\u5206\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\n\n**AC Code**\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int mxn = 2e5;\nconst int N = mxn + 10;\nll C, h[N], dp[N]; int head, tail, q[N], n;\ndouble Y(int i) { return dp[i] + h[i] * h[i]; }\ndouble X(int i) { return h[i]; }\ndouble slope(int i, int j) { return (Y(i) - Y(j)) / (X(i) - X(j)); }//\u8ba1\u7b97\u659c\u7387\nsigned main() {\n\tios::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n\tcin >> n >> C;\n\tfor(int i = 1; i <= n; ++ i) cin >> h[i];\n\tq[head = tail = 1] = 1;//\u5355\u8c03\u961f\u5217\u521d\u59cb\u5316\uff0c\u9752\u86d9\u539f\u6765\u5728\u4f4d\u7f6e1\n\tfor(int i = 2; i <= n; ++ i) {\n\t\twhile(head < tail && slope(q[head], q[head + 1]) <= 2 * h[i]) ++ head; //\u82e5\u524d\u4e24\u4e2a\u5143\u7d20\u4e0d\u6ee1\u8db3\u524d\u4e00\u4e2a\u5143\u7d20\u66f4\u4f18\uff0c\u5c06\u524d\u4e00\u4e2a\u5143\u7d20\u51fa\u961f\n\t\tint j = q[head]; dp[i] = dp[j] + (h[i] - h[j]) * (h[i] - h[j]) + C; //\u8fdb\u884c\u8f6c\u79fb\n\t\twhile(head < tail && slope(q[tail - 1], q[tail]) >= slope(q[tail], i)) -- tail; //\u7ef4\u62a4\u51f8\u5305\n\t\tq[++ tail] = i; //\u5165\u961f\n\t}\n\tcout << dp[n];\n\treturn 0;\n}\n```",
        "postTime": 1683642125,
        "uid": 765958,
        "name": "lottle1212",
        "ccfLevel": 5,
        "title": "Frog 3 \u9898\u89e3"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u79cd\u548c\u9898\u89e3\u533a\u76f8\u6bd4\u66f4\u52a0\u673a\u68b0\u7684\u659c\u7387\u4f18\u5316\u7684\u65b9\u6cd5\u3002\n\n\u8bbe $f_i$ \u4e3a\u81f3 $i$ \u4e3a\u6b62\u7684\u6700\u5c0f\u82b1\u8d39\uff0c\u663e\u7136\u6709\u8f6c\u79fb\uff1a\n\n$$\nf_i=\\min_{j<i}\\left\\{f_j+(h_i-h_j)^2\\right\\}+C\n$$\n\n\u5047\u8bbe\u6709\u4e24\u4e2a\u51b3\u7b56 $j,k(j<k)$\uff0c\u76f4\u63a5\u4ee4 $k$ \u4f18\u4e8e $j$\uff0c\u8003\u8651 $k$ \u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\uff1a\n\n$$\nf_j+(h_i-h_j)^2>f_k+(h_i-h_k)^2\n$$\n\n$$\nf_j+h_i^2-2h_ih_j+h_j^2>f_k+h_i^2-2h_ih_k+h_k^2\n$$\n\n\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u6700\u5c0f\u5316 $f_i$\uff0c\u56e0\u6b64\u9700\u8981\u5206\u79bb\u548c $i$ \u6709\u5173\u7684\u9879\uff1a\n\n$$\nf_j-f_k+h_j^2-h_k^2>2h_i(h_j-h_k)\n$$\n\n\u7531\u4e8e $j<k$\uff0c\u56e0\u6b64 $h_j-h_k<0$\u3002\u4ece\u800c\uff1a\n\n$$\n\\frac{f_j+h_j^2-f_k-h_k^2}{h_j-h_k}<2h_i\n$$\n\n\u73b0\u5728\u5047\u8bbe\u6709\u4e09\u4e2a\u70b9 $j_1,j_2,j_3$\uff0c\u8bbe\u524d\u540e\u4e24\u8fb9\u4e0a\u5de6\u5f0f\u5206\u522b\u4e3a $k_1,k_2$\u3002\u8003\u8651\uff1a\n- \u82e5 $k_1<2h_i$\uff0c\u5219 $j_2$ \u4f18\u4e8e $j_1$\uff1b\n- \u82e5 $k_2\\geqslant 2h_i$\uff0c\u5219 $j_3$ \u4e0d\u4f18\u4e8e $j_2$\u3002\n\n\u7531\u6b64\u53ef\u5f97\uff0c\u5f53\u8fd9\u4e09\u4e2a\u51b3\u7b56\u70b9\u5728 $h_i$ \u4e3a\u6a2a\u5750\u6807\u3001$f_i+h_i^2$ \u4e3a\u7eb5\u5750\u6807\u7684\u5750\u6807\u7cfb\u4e0a\u6784\u6210\u4e0b\u51f8\u58f3\u65f6\uff0c$j_2$ \u624d\u6709\u53ef\u80fd\u6210\u4e3a\u6700\u4f18\u51b3\u7b56\u3002\u56e0\u6b64\u65b0\u7684\u51b3\u7b56\u70b9\u8fdb\u5165\u65f6\uff0c\u7528\u4e00\u4e2a\u5355\u8c03\u961f\u5217\u53bb\u7ef4\u62a4\u3002\n\n\u8f6c\u79fb\u65f6\uff0c\u5728\u961f\u9996\u4e0d\u65ad\u6bd4\u8f83\u961f\u9996\u4e24\u70b9\u659c\u7387\u548c $2h_i$\uff0c\u5982\u679c\u6ee1\u8db3\u4e0a\u5f0f\uff0c\u8bf4\u660e $k$ \u4f18\u4e8e $j$\uff0c\u5f39\u51fa $j$\uff0c\u76f4\u81f3\u4e0d\u6ee1\u8db3\u4e3a\u6b62\u3002",
        "postTime": 1666748046,
        "uid": 246979,
        "name": "SalomeJLQ",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 AT_DP_Z \u659c\u7387\u4f18\u5316"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/AT4547)\n\n### \u9898\u610f\n\n\u4ece $i$ \u53f7\u77f3\u5934\u8df3\u5230 $j$ \u53f7\u77f3\u5934\u7684\u8d39\u7528\u4e3a $(h_i - h_j)^2 + C$\uff0c\u6c42\u4ece $1$ \u53f7\u8df3\u5230 $N$ \u53f7\u7684\u6700\u5c0f\u8d39\u7528\u3002\n\n### \u601d\u8def\n\n\u8bbe $F_i$ \u8868\u793a\u8df3\u5230 $i$ \u53f7\u77f3\u5934\u6240\u9700\u6700\u5c0f\u82b1\u8d39\uff0c\u5219\u6839\u636e\u9898\u610f\uff0c\u53ef\u5217 $O(N^2)$ \u7684\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$F_i= \\min(F_j + ( h_i - h_j )^2 + C ) ,1 \\leq j < i$.\n\n\u5316\u7b80\u65b9\u7a0b\uff0c\u5f97\uff1a\n\n$F_i= \\min( F_j +  {h_i}^2 - 2h_ih_j + {h_j}^2 + C ) ,1 \\leq j < i$.\n\n\u4e8e\u662f $F_i$ \u5373\u4e3a\u5728\u6240\u6709\u5408\u6cd5\u8303\u56f4\u5185\u7684 $F_j +  {h_i}^2 - 2h_ih_j + {h_j}^2 + C$ \u4e2d\u6700\u5c0f\u7684\u503c\uff0c\u5f53\u6b64\u5f0f\u53d6\u5f97\u6700\u5c0f\u503c\u65f6\uff0c$\\min$ \u53ef\u4ee5\u53bb\u6389\uff0c\u4e8e\u662f\u539f\u5f0f\u5316\u4e3a\uff1a\n\n$F_i= F_j +  {h_i}^2 - 2h_ih_j + {h_j}^2 + C $.\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$\uff0c\u6211\u4eec\u90fd\u9700\u8981\u627e\u5230\u76f8\u5e94\u7684\u4ee4\u53f3\u4fa7\u53d6\u5f97\u6700\u5c0f\u503c\u7684 $j$\uff0c\u800c\u5f53 $i$ \u56fa\u5b9a\u65f6\uff0c\u539f\u8f6c\u79fb\u65b9\u7a0b\u4e2d\u6240\u6709\u4e0e $i$ \u76f8\u5173\u7684\u91cf\u662f\u4e0d\u53d8\u7684\uff0c\u53ef\u4ee5\u770b\u4f5c\u5e38\u91cf\uff1b\u800c\u4e0e $j$ \u76f8\u5173\u7684\u91cf\u5728\u53d8\u5316\uff0c\u53ef\u4ee5\u770b\u4f5c\u53d8\u91cf\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u5c06\u65b9\u7a0b\u4e2d\u4e0e $i$ \u76f8\u5173\u7684\u91cf\u79fb\u5230\u4e00\u4fa7\uff1a\n\n$F_j + {h_j}^2 =  2 h_i h_j + F_i - {h_i}^2 - C$.\n\n\u7b49\u53f7\u5de6\u4fa7\u53ea\u6709\u53d8\u91cf\uff0c$2 h_i h_j$ \u9879\u662f\u5e38\u91cf\u4e0e\u53d8\u91cf\u76f8\u4e58\uff0c\u800c\u7b49\u53f7\u53f3\u4fa7\u5176\u4f59\u90e8\u5206\u90fd\u662f\u5e38\u91cf\u3002\n\n\u6b64\u65f6\uff0c\u53ef\u4ee5\u4ee4 $y = F_j + {h_j}^2$\uff0c$k = 2h_i$\uff0c$x = h_j$\uff0c$b = F_i - {h_i}^2 - C$\u3002\u4e8e\u662f\u539f\u65b9\u7a0b\u53ef\u4ee5\u88ab\u8868\u793a\u4e3a $y = kx + b$ \u7684\u4e00\u6b21\u51fd\u6570\u76f4\u7ebf\u5f62\u5f0f\u3002\n\n\u6211\u4eec\u6210\u529f\u628a\u6734\u7d20\u7684\u8f6c\u79fb\u65b9\u7a0b\u5316\u6210\u4e86\u201c\u659c\u7387\u5f0f\u201d\u3002\n\n\u56e0\u4e3a\u6211\u4eec\u8981\u6c42\u7684 $F_i$ \u5728\u659c\u7387\u5f0f\u7684 $b$ \u4e00\u9879\u4e2d\uff0c\u800c\u53c8\u5e0c\u671b $F_i$ \u5c3d\u53ef\u80fd\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u6240\u53d6\u7684\u659c\u7387\u5f0f\u7684\u622a\u8ddd\u4e5f\u8981\u5c3d\u53ef\u80fd\u5927\u3002\n\n\u6b64\u65f6\u7684\u6bcf\u4e00\u4e2a $j$\uff0c\u90fd\u53ef\u4ee5\u5728\u5e73\u9762\u4e0a\u8868\u793a\u4e3a\u5750\u6807 $(h_j,F_j + {h_j}^2)$ \u7684\u4e00\u4e2a\u70b9\u3002\u800c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$\uff0c\u5176\u5728\u659c\u7387\u5f0f\u4e2d\u5bf9\u5e94\u7684\u659c\u7387 $2h_i$ \u662f\u56fa\u5b9a\u4e0d\u53d8\u7684\u3002\u5f53\u67d0\u4e2a $i$ \u5bf9\u5e94\u659c\u7387\u7684\u76f4\u7ebf\u6b63\u597d\u7ecf\u8fc7\u4e86\u67d0\u4e2a $j$ \u5bf9\u5e94\u7684\u70b9\u65f6\uff0c\u53ef\u4ee5\u6839\u636e\u659c\u7387\u65b9\u7a0b\u6c42\u51fa\u6b64\u65f6\u5bf9\u5e94\u7684\u622a\u8ddd $b$\uff0c\u8fdb\u800c\u6839\u636e $i$ \u6c42\u51fa\u6b64\u65f6\u6240\u5f97\u7684 $F_i$ \u503c\uff0c\u5373\u4f7f\u7528\u659c\u7387\u5f0f\u5b8c\u6210\u4e86\u4e00\u6b21\u52a8\u89c4\u7684\u72b6\u6001\u8f6c\u79fb\u3002\n\n\u4f46\u4ec5\u4ec5\u8fd9\u6837\u8fd8\u4e0d\u591f\u3002\u6211\u4eec\u89c2\u5bdf\u5230\u659c\u7387\u5f0f\u4e2d\u7684 $k,x$ \u4e24\u9879\u90fd\u5177\u6709\u5355\u8c03\u6027\u3002\u5373 $i$ \u6240\u5bf9\u5e94\u7684\u76f4\u7ebf\u659c\u7387\u968f $i$ \u9012\u589e\uff1b$j$ \u6240\u5bf9\u5e94\u70b9\u7684\u6a2a\u5750\u6807\u4e5f\u968f $j$ \u9012\u589e\u3002\u7531\u6b64\u6211\u4eec\u53ef\u77e5\u4e3a\u4f7f\u622a\u8ddd\u6700\u5c0f\uff0c\u7b26\u5408\u6761\u4ef6\u7684\u70b9\u4e00\u5b9a\u5728\u6240\u6709 $j$ \u5bf9\u5e94\u70b9\u7684\u4e0b\u51f8\u5305\u4e0a\u3002\n\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u659c\u7387\u7ef4\u62a4\u4e00\u4e2a\u4e0b\u51f8\u5305\u3002\u4e0b\u51f8\u5305\u7684\u6027\u8d28\u662f\u70b9\u7684\u659c\u7387\u5355\u8c03\u9012\u589e\uff0c\u7531\u6b64\u60f3\u5230\u53ef\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u3002\u5f53\u961f\u9996\u659c\u7387\u5c0f\u4e8e\u5f53\u524d\u659c\u7387\u65f6\u5f39\u51fa\u961f\u9996\uff0c\u5f53\u65b0\u70b9\u63d2\u5165\u65f6\u5f39\u51fa\u961f\u5c3e\u7ef4\u62a4\u5355\u8c03\u6027\u3002\u7136\u540e\u8f6c\u79fb $F_i$\uff0c\u53d6\u961f\u9996\u5143\u7d20\uff0c\u7528\u659c\u7387\u5f0f\u8ba1\u7b97\u65b0\u7684 $F_i$ \u5b8c\u6210\u8f6c\u79fb\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u7528**\u659c\u7387\u4f18\u5316**\u5c06\u8f6c\u79fb\u7684\u603b\u590d\u6742\u5ea6\u964d\u4e3a\u4e86 $O(N)$\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include <cstdio>\nconst int Nx=200010;\nint N;\nlong long C,H[Nx],F[Nx],K[Nx],Y[Nx];\nint que[Nx],L,R;\ndouble slope(int a,int b)\n{\n\tdouble xx,yy;\n\tyy=Y[b]-Y[a];\n\txx=H[b]-H[a];\n\treturn yy/xx;\n}\nint main()\n{\n\tscanf(\"%d%lld\",&N,&C);\n\tint i,j,k;\n\tfor(i=1;i<=N;i++)\n\t{\n\t\tscanf(\"%lld\",&H[i]);\n\t\tK[i]=2*H[i];\n\t}\n\tF[1]=0;Y[1]=H[1]*H[1];\n\tque[1]=1;\n\tL=1;R=1;\n\tfor(i=2;i<=N;i++)\n\t{\n\t\twhile(L<R&&slope(que[L],que[L+1])<K[i]*1.0)\n\t\t\tL++;\n\t\tj=que[L];\n\t\tF[i]=Y[j]-K[i]*H[j]+H[i]*H[i]+C;\n\t\tY[i]=F[i]+H[i]*H[i];\n\t\twhile(L<R&&slope(que[R-1],que[R])>slope(que[R],i))\n\t\t\tR--;\n\t\tque[++R]=i;\n\t}\n\tprintf(\"%lld\\n\",F[N]);\n}\n```\n",
        "postTime": 1642432445,
        "uid": 291481,
        "name": "novax",
        "ccfLevel": 7,
        "title": "AT4547 Frog3"
    },
    {
        "content": "# \u9898\u9762\n\n\n\u6709 $N$ \u4e2a\u77f3\u5934\uff0c\u7f16\u53f7\u4e3a $1,2,\\dots,N$\uff0c\u7b2c $i$ \u4e2a\u9ad8\u4e3a $h_i$\u3002\u4fdd\u8bc1 $h$ \u4e25\u683c\u5355\u8c03\u9012\u589e\u3002\n\n\u6709\u4e00\u53ea\u9752\u86d9\u5728\u7b2c\u4e00\u4e2a\u77f3\u5934\u4e0a\uff0c\u5b83\u53ef\u4ee5\u8df3\u5230\u77f3\u5934\u7f16\u53f7\u4e3a $i+1,i+2,\\dots,N$\u3002\u5f53\u4ed6\u8df3\u5230\u7f16\u53f7 $j$ \u77f3\u5934\u65f6\u7684\u82b1\u8d39\u662f\n$(h_i-h_j)^2+C$\u3002\u6c42\u8df3\u5230\u7f16\u53f7\u4e3a $N$ \u77f3\u5934\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\n- $ 2\\ \\leq\\ N\\ \\leq\\ 2\\ \\times\\ 10^5 $\n- $ 1\\ \\leq\\ C\\ \\leq\\ 10^{12} $\n- $ 1\\ \\leq\\ h_1\\ <\\ h_2\\ <\\ \\cdots\\ <\\ h_N\\ \\leq\\ 10^6 $\n\n# Solution\n\u8bb0 $f_{i}$ \u4e3a\u9752\u86d9\u8df3\u5230\u7f16\u53f7\u4e3a $i$ \u7684\u77f3\u5934\u540e\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u7531\u4e8e\u8df3\u5230\u77f3\u5934 $i$ \u4e4b\u524d\u5fc5\u987b\u8df3\u5230\u4e4b\u524d\u7684\u4e00\u4e2a\u77f3\u5934 $j$\uff0c\u6240\u4ee5\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$f_{i}=f_{j}+(h_{i}-h_{j})^2+C$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u660e\u663e\u7b26\u5408**\u659c\u7387\u4f18\u5316**\uff0c\u5f80\u8fd9\u65b9\u9762\u8003\u8651\u3002\n\n\u5bf9\u4e8e\u4e24\u4e2a\u51b3\u7b56 $j,k$\uff0c\u4ee4 $j<k$\uff0c\u5219\u51b3\u7b56 $j$ \u4e25\u683c\u4f18\u4e8e\u51b3\u7b56 $k$ \u65f6\u6709\uff1a\n\n$f_{j}+(h_{i}-h_{j})^2+C  \\geq f_{k}+(h_{i}-h_{k})^2+C$\n\n\u62c6\u62ec\u53f7\uff0c\u7b80\u5355\u53d8\u6362\u540e\u79fb\u9879\u53ef\u5f97\uff1a\n\n$-2\\times h_{i}\\times h_{j}+2\\times h_{i}\\times h_{k} \\geq f_{k}+h_{k}^2-f_{j}-h_{j}^2$\n\n\u7ee7\u7eed\u63a8\u53ef\u5f97\uff1a\n\n$2\\times h_{i} \\geq \\dfrac{f_{k}+h_{k}^2-f_{j}-h_{j}^2}{h_{k}-h_{j}}$\n\n\u4ee4 $a_{i}=f_{i}+h{_i}^2$\n\n\u5219\u6709\uff1a$2\\times h_{i} \\geq \\dfrac{a_{k}-a_{j}}{h_{k}-h_{j}}$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6ee1\u8db3\u5982\u4e0a\u6761\u4ef6\u7684\u60c5\u51b5\u4e0b\uff0c\u51b3\u7b56 $j$ \u4e00\u5b9a\u52a3\u4e8e\u51b3\u7b56 $k$\u3002\n\n\u7531\u4e8e $h_{i}$ \u5355\u8c03\u9012\u589e\uff0c\u6ee1\u8db3\u5355\u8c03\u6027\uff0c\u4f7f\u7528\u666e\u901a\u7b97\u6cd5\u5373\u53ef\u3002\n\n## \u5b9e\u73b0\n\u659c\u7387\u4f18\u5316\u7684\u57fa\u672c\u6d41\u7a0b\u5982\u4e0b\uff1a\n\n- \u5f39\u51fa\u961f\u5217\u9996\u7aef\u6ee1\u8db3\u5982\u4e0a\u6761\u4ef6\u7684\u961f\u5934\uff0c\u8fd9\u662f\u56e0\u4e3a\u961f\u5185\u660e\u663e\u6709\u4f18\u4e8e\u961f\u5934\u7684\u51b3\u7b56\u3002\n- \u6c42\u51fa $f_{i}$ \u503c\u3002\n- \u66f4\u65b0\u961f\u5217\u3002\n\n\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nconst LL maxn=2e5+10;\nLL n,c,hd,tl;\nLL f[maxn],h[maxn];\nLL q[maxn];\ndouble a(LL i) {\n\treturn f[i]*1.0+h[i]*h[i];\n}\ndouble k(LL i,LL j) {\n\treturn (a(j)*1.0-a(i))/(h[j]*1.0-h[i]);\n}\nLL query(LL i,LL j) {\n\treturn (h[i]-h[j])*(h[i]-h[j]);\n}\nint main() { \n\tscanf(\"%lld%lld\",&n,&c);\n\tfor(LL i=1;i<=n;i++)\n\t\tscanf(\"%lld\",&h[i]);\n\thd=1,tl=1;\n\tq[hd]=1;\n\tfor(LL i=2;i<=n;i++) {\n\t\twhile(hd<tl && 2*h[i]>=k(q[hd],q[hd+1]))hd++;\n\t\tf[i]=f[q[hd]]+query(q[hd],i)+c;\n\t\twhile(hd<tl && k(q[tl-1],q[tl]) >= k(q[tl-1],i) )tl--;\n\t\tq[++tl]=i; \n\t}\n\tprintf(\"%lld\",f[n]);\n\treturn 0; \n} \n```\n",
        "postTime": 1683898160,
        "uid": 225515,
        "name": "\u5929\u661f\u4e36",
        "ccfLevel": 0,
        "title": "AT_dp_z frog 3"
    },
    {
        "content": "\u659c\u7387\u4f18\u5316 dp \u597d\u9898\uff0c\u63d0\u4f9b\u4e00\u79cd\u674e\u8d85\u7ebf\u6bb5\u6811\u7684\u5199\u6cd5\u3002\n\n### \u9898\u76ee\u5206\u6790\uff1a\n\n\u9996\u5148\u6211\u4eec\u5f88\u5bb9\u6613\u7684\u5230\u4e00\u4e2a $O(n^2)$ \u7684\u8f6c\u79fb\u5f0f\uff1a\n\n$$dp[i] = \\min ((h_i - h_j)^2 + dp[j]) +c,(j < i)$$\n\n\n\u8003\u8651\u5c06\u5f0f\u5b50\u62c6\u5f00\u53d8\u6210\uff1a\n\n$$dp[i]= \\min (-2 \\times h_i \\times h_j + {h_j}^2 +dp[j] ) + c$$\n\n\u4e0b\u9762\u5c31\u53ef\u4ee5\u76f4\u63a5\u4e0a\u674e\u8d85\u7ebf\u6bb5\u6811\u4e86\uff0c\u5c06 $h_i$ \u770b\u505a\u6a2a\u5750\u6807\uff0c\u659c\u7387\u5c31\u662f $-2 \\times h_j$\uff0c\u622a\u8ddd\u5c31\u662f ${h_j}^2+dp[j]$\uff0c\u6bcf\u6b21\u66f4\u65b0 $dp[i]$ \u5c31\u662f\u5728 $h[i]$ \u4e0a\u7684\u6700\u5c0f\u503c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n \\log n)$\u3002\n\n\u5176\u5b9e\uff0c\u8fdb\u4e00\u6b65\u89c2\u5bdf\u53ef\u4ee5\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u4e00\u6b21\u51fd\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u4e00\u4e0b\u4e0b\u51f8\u58f3\uff0c\u505a\u5230\u6574\u4f53\u590d\u6742\u5ea6 $O(n)$\u3002\n\n### Code.\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int N=2e6+10,M=2e5+10;\nint tr[N<<2],n;  ll c,h[N],f[M];\nstruct node\n{\n\tll k,b;\n\tll calc(ll x) {return x*k+b;}\n} a[M];\nvoid modify(int u,int l,int r,int x)\n{\n\tint mid =(l + r) >> 1;\n\tif(a[x].calc(mid) < a[tr[u]].calc(mid)) swap(tr[u],x);\n\tif(a[x].calc(l) < a[tr[u]].calc(l)) modify(u<<1,l,mid,x);\n\tif(a[x].calc(r) < a[tr[u]].calc(r)) modify(u<<1|1,mid+1,r,x);\n}\nll query(int u,int l,int r,int x)\n{\n\tif(l == r) return a[tr[u]].calc(x);\n\tint mid = (l + r) >> 1; ll res=a[tr[u]].calc(x);\n\tif(x <= mid) res=min(res,query(u<<1,l,mid,x));\n\telse res=min(res,query(u<<1|1,mid+1,r,x));\n\treturn res; \n}\nint main()\n{\n\tscanf(\"%d%lld\",&n,&c); a[0].b=1e18;\n\tfor(int i=1;i<=n;i++) scanf(\"%lld\",h+i);\n\ta[1].k=-2*h[1]; a[1].b=h[1]*h[1];\n\tmodify(1,0,1e6,1);\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tf[i]=query(1,0,1e6,h[i])+h[i]*h[i]+c;\n\t\ta[i].k=-2*h[i]; a[i].b=h[i]*h[i]+f[i];\n\t\tmodify(1,0,1e6,i);\n\t}\n\tprintf(\"%lld\\n\",f[n]);\n\treturn 0;\n}\n```\n",
        "postTime": 1665909363,
        "uid": 230865,
        "name": "EastPorridge",
        "ccfLevel": 0,
        "title": "AT4547 Frog 3 \u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT4547)\n\n[ATcoder DP \u4e13\u9898 \u4f20\u9001\u95e8](https://atcoder.jp/contests/dp/tasks)\n\n### \u9898\u610f\u7b80\u8ff0\n\u6709 $N$ \u4e2a\u77f3\u5934\uff0c\u7f16\u53f7\u4e3a $1,2,\\dots,N$ \uff0c\u7b2c $i$ \u4e2a\u9ad8\u4e3a $h_i$ **\u6ce8\u610f $h_i$ \u9012\u589e**\n\n\u6709\u4e00\u53ea\u9752\u86d9\u5728\u7b2c\u4e00\u4e2a\u77f3\u5934\u4e0a\uff0c\u5b83\u53ef\u4ee5\u8df3\u5230\u77f3\u5934\u7f16\u53f7\u4e3a $i+1,i+2,\\dots,N$ \u5f53\u4ed6\u8df3\u5230\u7f16\u53f7 $j$ \u77f3\u5934\u65f6\u7684\u82b1\u8d39\u662f $(h_i-h_j)^2$+C  \u6c42\u8df3\u5230\u7b2c $n$ \u5757\u77f3\u5934\u4e0a\u7684\u6700\u5c0f\u82b1\u8d39\n\n### Solution\n\n\u65e2\u7136\u662f DP \u4e13\u9898 \u9996\u5148 \u8bbe\u8ba1\u72b6\u6001\n\n\u8bbe $dp[i]$ \u8868\u793a \u8df3\u5230 \u7b2c $i$ \u4e2a\u77f3\u5934\u4e0a\u7684\u6700\u5c0f\u82b1\u8d39\n\n\u53ef\u5f97\u8f6c\u79fb\u65b9\u7a0b\n\n$$ dp[i]=\\min_{j<i}\\{dp[j]+(h_j-h_i)^2+c\\} $$\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$ \u4e0d\u80fd\u63a5\u53d7\n\n\u8003\u8651\u4f18\u5316 \u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50  \u53ef\u4ee5\u659c\u7387\u4f18\u5316\n\n\u8f6c\u5316\u540e\u5f0f\u5b50\u53d8\u6210  \u5f62\u5982 $y=k\\,x+b$ \u7684\n\n$$ dp[j] +h^2_j=dp[i] +2\\times h_i\\times h_j-h_i^2-C$$\n\n\u7ef4\u62a4\u6700\u5c0f\u503c\n\n\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u4e00\u4e2a \u4e0b\u51f8\u58f3\u5373\u53ef\n\n### code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int N=200005;\nint dp[N],h[N];\nint n,c;\ndouble Y(int j){return dp[j]+h[j]*h[j];}\ndouble b(int i){return dp[i]-h[i]*h[i]-c;}\ndouble X(int i){return 2*h[i];}\ndouble K(int i,int j){return (Y(i)-Y(j))/((X(i)-X(j)));}\nint q[N];\nint head,tail;\nsigned main()\n{\n\tscanf(\"%lld%lld\",&n,&c);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%lld\",&h[i]);\n\t}\n\tmemset(dp,0x3f,sizeof dp);\n\tdp[1]=0;head=tail=q[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\twhile(head<tail&&h[i]>=K(q[head],q[head+1]))head++;\n\t\tdp[i]=dp[q[head]]+c+(h[i]-h[q[head]])*(h[i]-h[q[head]]);\n\t\twhile(head<tail&&K(q[tail-1],q[tail])>=K(q[tail],i))tail--;\n\t\tq[++tail]=i;\n\t}\n\tprintf(\"%lld\",dp[n]);\n\treturn 0;\n}\n```",
        "postTime": 1628913354,
        "uid": 250916,
        "name": "_Dreamer_",
        "ccfLevel": 0,
        "title": "AT4547 Frog 3 \u9898\u89e3"
    }
]
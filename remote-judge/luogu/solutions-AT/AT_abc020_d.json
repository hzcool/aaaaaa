[
    {
        "content": "### Part1 \u9898\u610f\n\u7ed9\u5b9a $n,k$\uff0c\u6c42 $\\sum\\limits_{i=0}^n\\operatorname{lcm}(i,k)$\u3002\n\n### Part2 \u83ab\u53cd\u516c\u5f0f\u4e0e\u6700\u5927\u516c\u56e0\u6570\u7684\u5173\u7cfb\n\n1. \u5b9a\u4e49\u6570\u8bba\u51fd\u6570 $f(x)$ \u548c $g(x)$ \u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef $(f*g)(x)=\\sum\\limits_{i|x}f(x)g(\\dfrac xi)$\uff1b\n\n2. \u5b9a\u4e49\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570 $\\mu(x)$\uff0c\u5f53 $x=p^2q$\uff0c$p$ \u662f\u8d28\u6570\uff0c$q$ \u662f\u4efb\u610f\u6b63\u6574\u6570\u65f6\uff0c$\\mu(x)=0$\uff0c\u5426\u5219\u4ee4 $x=p_1p_2\\dots p_k$\uff0c\u5176\u4e2d $p_1,p_2,\\dots,p_k$ \u5747\u4e3a\u8d28\u6570\uff0c\u5219 $\\mu(x)=(-1)^k$\uff0c\u7279\u6b8a\u7684\uff0c$\\mu(1)=1$\uff1b\n\n3. \u5b9a\u4e49\u5355\u4f4d\u51fd\u6570 $\\epsilon(x)=[x=1]$\uff0c\u5373\u53ea\u6709 $x=1$ \u65f6\u503c\u4e3a\u4e00\uff0c\u5176\u4f59\u4e3a\u96f6\uff0c\u4e8e\u662f\u6709 $\\mu*1=\\epsilon$\uff0c\u5373 $\\sum\\limits_{d|x}\\mu(x)=\\epsilon(x)$\uff1b\n\n4. \u7531\u4e8e\u72c4\u5229\u514b\u96f7\u5377\u79ef\u5177\u6709\u4ea4\u6362\u5f8b\u548c\u7ed3\u5408\u5f8b\uff0c\u4e8e\u662f\u82e5 $f=g*1$\uff0c\u5219 $f*\\mu=g*(1*\\mu)=g$\uff0c\u6545\u6709 $f=g*1\\Leftrightarrow g=f*\\mu$\uff1b\n\n5. \u4e8e\u662f\u53ef\u4ee5\u8003\u8651\u8bbe $f=g*1$\uff0c\u5219 $f(\\gcd(x,y))=\\sum\\limits_{d|\\gcd(x,y)}g(d)=\\sum\\limits_{d|x,d|y}g(d)$\uff0c\u800c\u7531 4 \u5f97 $g=f*\\mu$\uff0c\u6545\u6709 $f(\\gcd(x,y))=\\sum\\limits_{d|x,d|y}(f*\\mu)(d)$\uff0c\u6709\u4e00\u79cd\u53eb\u505a\u9b54\u529b\u7b5b\u7684\u4e1c\u897f\u53ef\u4ee5\u5728 $O(n\\ln\\ln n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u51fa $(f*\\mu)(1\\sim n)$\u3002\n\n### Part3 \u672c\u9898\u516c\u5f0f\u63a8\u5bfc\n\n\u53d1\u73b0\u6211\u4eec\u53ea\u4f1a\u5904\u7406 $\\gcd$\uff0c\u800c\u4e0d\u4f1a\u5904\u7406 $\\operatorname{lcm}$\uff0c\u4e8e\u662f\u9700\u8981\u5148\u5c06 $\\operatorname{lcm}$ \u8f6c\u6210 $\\gcd$\uff1a\n\n$ans=\\sum\\limits_{i=1}^n\\dfrac{ki}{\\gcd(i,k)}=k\\sum\\limits_{i=1}^n\\dfrac i{\\gcd(i,k)}$\n\n\u8003\u8651\u679a\u4e3e $\\gcd(i,k)$\uff1a\n\n$=k\\sum\\limits_{d|k}\\sum\\limits_{i=1}^{\\lfloor\\frac n d\\rfloor}[\\gcd(i,\\dfrac k d)=1]i$\n\n\u4e0d\u59a8\u8bbe $f(n,m)=\\sum\\limits_{i=1}^n[\\gcd(i,m)=1]i$\uff0c\u5219 $f(n,m)=\\sum\\limits_{i=1}^ni[\\gcd(i,m)=1]$\n\n$=\\sum\\limits_{i=1}^ni\\sum\\limits_{d|i,d|m}\\mu(d)$\n\n$=\\sum\\limits_{d|m}\\mu(d)\\sum\\limits_{i=1}^{\\lfloor\\frac n d\\rfloor}di$\n\n$=\\sum\\limits_{d|m}\\mu(d)d\\sum\\limits_{i=1}^{\\lfloor\\frac n d\\rfloor}i$\n\n\u4e8e\u662f\uff0c$ans=k\\sum\\limits_{d|k}f(\\lfloor\\dfrac n d\\rfloor,\\dfrac k d)$\u3002\n\n### Part4 \u5177\u4f53\u5b9e\u73b0\n\n\u9b54\u529b\u7b5b\u53ef\u4ee5\u5728 $O(n\\ln\\ln n)$ \u65f6\u95f4\u6c42\u51fa\u4efb\u610f\u7684 $f*\\mu$\uff0c\u5176\u5b9e\u662f\u57fa\u4e8e\u57c3\u6c0f\u7b5b\u7684\uff0c\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\nmu[1]=1;\nfor(x=2;x<=n;++x){\n    if(vs[x])continue;\n    else p[++pt]=x;\n    for(y=n/x;y;--y)\n        vs[x*y]=1,(mu[x*y]-=mu[y])%=M;\n}\n```\n\u53ea\u8981\u5c06 $f$ \u51fd\u6570\u9884\u5b58\u5728 `mu` \u6570\u7ec4\u91cc\u5c31\u53ef\u4ee5\u4e86\uff0c\u7531\u4e8e\u672c\u9898\u9700\u8981\u6c42 $\\mu=\\mu*\\epsilon$\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u9884\u5b58 `mu[1]=1;` \u5373\u53ef\u3002\n\n\u7531\u4e8e\u53ef\u80fd\u9700\u8981\u6c42\u8d85\u8fc7 $10^7$ \u7684 $\\mu$ \u51fd\u6570\uff0c\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u66b4\u529b\u5206\u89e3\u8d28\u56e0\u6570\u6cd5\uff0c\u5176\u5b9e\u4e0d\u4f1a\u8d85\u65f6\uff1a\n```cpp\n#include<icecream>\nusing namespace std;\nusing ll=long long;\nconst int N=1e7+7,M=1e9+7;\nint n=1e7+2,_n,_k,mu[N];\nbitset<N>vs;\nint p[2000005],pt,ans;\nint mus(int x){\n    if(x<=n)return mu[x];\u5c0f\u4e8e 1e7 \u66b4\u529b\u6c42\n    int res=1,i;\n    for(i=1;p[i]*p[i]<=x;++i)\n        if(!(x%p[i])){\n            x/=p[i],res=-res;\n            if(!(x%p[i]))return 0;\n        }\n    if(x>1)res=-res;\n    return res;\n}\nvector<int>G;\nint g(int x){\u592a\u61d2\u4e86\uff0c\u5f00\u4e2a\u51fd\u6570\u6c42\u7b49\u5dee\u6570\u5217\n    return ll(x+1)*x/2%M;\n}\nint f(int n,int m){\n    int res=0;\n    for(int x:G){\n        if(x>m)return res;\n        if(m%x)continue;\n        res=(ll(x)*mus(x)%M*g(n/x)+res)%M;\n    }return res;\n}\nint main(){\n    scanf(\"%d%d\",&_n,&_k);\n    int x,y;\n    mu[1]=1;\n    for(x=2;x<=n;++x){\n        if(vs[x])continue;\n        else p[++pt]=x;\n        for(y=n/x;y;--y)\n            vs[x*y]=1,(mu[x*y]-=mu[y])%=M;\u4f3c\u4e4e\u4e0d\u9700\u8981\u53d6\u6a21\uff1f\n    }\n    for(x=1;x*x<_k;++x)\u76f4\u63a5\u9884\u5904\u7406\u56e0\u6570\n        if(!(_k%x))G.push_back(x),G.push_back(_k/x);\n    if(x*x==_k)G.push_back(x);\n    sort(G.begin(),G.end());\n    for(int x:G)ans=(ans+f(_n/x,_k/x))%M;\n    ans=ll(_k)*ans%M;\n    ans=(ans%M+M)%M;\u8fd9\u4e2a\u7b5b\u6cd5\u4f1a\u7b5b\u51fa\u8d1f\u6570\uff01\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```\n\n### Part5 \u4e00\u4e9b\u5176\u4ed6\u5206\u6790\n\u8bb0 $d(x)$ \u8868\u793a $x$ \u7684\u56e0\u6570\u4e2a\u6570\uff0c\u5219\u672c\u9898\u7684\u7406\u60f3\u590d\u6742\u5ea6\u662f $d^2(k)$\uff0c\u800c\u636e\u8bf4\u6709 $d(k)\\le k^{\\frac{1.0661}{\\ln\\ln k}}$\uff0c\u5f53 $k=10^9$ \u65f6\uff0c$k^{\\frac{1.0661}{\\ln\\ln k}}=1463.2566$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002",
        "postTime": 1668493977,
        "uid": 502410,
        "name": "EnofTaiPeople",
        "ccfLevel": 0,
        "title": "[ABC020D]\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5c0f\u590d\u4e60"
    },
    {
        "content": "\u5927\u5bb6\u597d\uff0c\u6211\u5b66\u4e86\u4e2a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u4e0d\u7528\u51fa\u6765\u6d51\u8eab\u96be\u53d7\uff0c\u521a\u597d\u5446\u552f\u6258\u68a6\u7ed9\u6211\u8bf4\u8fd9\u9898\u6570\u8bba\u5206\u5757\u53ef\u505a\uff0c\u6240\u4ee5\u6211\u62ff\u6570\u8bba\u5206\u5757\u8fc7\u4e86\u3002\n\n### \u9898\u76ee\u6982\u8ff0\uff1a\n\n\u6c42\uff1a \n\n$$\n\\sum_{i=1}^{n} \\mathrm{lcm}(i,k)\n$$\n\n### \u9898\u76ee\u5206\u6790\uff1a\n\n\u8fdb\u884c\u4e00\u4e2a\u5f0f\u5b50\u7684\u63a8\uff0c\n\n$$\n\\sum_{i=1}^{n} \\mathrm{lcm}(i,k)= \\sum_{i=1}^{n} \\frac{i \\cdot k}{\\gcd(i,k)}\n= \\sum_{d \\mid k} \\sum_{i=1}^{n} [\\gcd(i,k)=d] \\cdot \\frac{i \\cdot k}{d}\n= k \\sum_{d \\mid k} \\sum_{i=1}^{\\left \\lfloor \\frac{n}{d} \\right \\rfloor } [\\gcd(i,\\frac{k}{d})=1] \\cdot i \n$$\n\n\u628a\u540e\u9762\u90a3\u4e00\u5768\u62ce\u51fa\u6765\u505a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\n\n$$\nf(n,m)= \\sum_{i=1}^{n} [\\gcd(i,\\frac{k}{m})=1] \\cdot i \n=\\sum_{i=1}^{n}i \\cdot \\sum_{d \\mid i,d \\mid \\frac{k}{m}} \\mu(d)\n= \\sum_{d \\mid \\frac{k}{m}} d \\cdot \\sum_{i=1}^{\\frac{n}{d}} i \\cdot \\mu(d)\n$$\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\uff0c\u91cc\u5c42\u679a\u4e3e\u56e0\u6570\uff0c\u5916\u5c42\u8fdb\u884c\u6570\u8bba\u5206\u5757\uff0c\u56e0\u4e3a\u6211\u4eec\u65e0\u6cd5\u628a $10^9$ \u4e2a $\\mu$ \u51fd\u6570\u5168\u90fd\u7b5b\u51fa\u6765\uff0c\u6240\u4ee5\u53ea\u7b5b\u4e00\u90e8\u5206\uff0c\u5982\u679c\u7528\u5230\u518d\u73b0\u6c42\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u7a0d\u5927\u7684 $O( \\sqrt n)$\uff0c\u53ef\u4ee5\u78be\u8fc7\u3002\n\n### Code.\n\n```cpp\n/*\n\u03bc's Music Start!\n\u5c4a\u3051\u3066 \u5207\u306a\u3055\u306b\u306f\u540d\u524d\u3092\u3064\u3051\u3088\u3046\u304b\u201cSnow halation\u201d!\n*/\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std; const int N=1e7+10,p=1e9+7,i2=500000004;\nint n,k,pl,miu[N],res; bitset<N> st; vector<int> pri;\nint dasuki(int x)\n{\n\tif(x < N) return miu[x];  int t=1,yl=x;\n\tfor(int i=2;i*i<=yl;i++)\n\t{\n\t\tif(x%i) continue ; pl=0; while(! (x%i)) x/=i,++pl;\n\t\tif(pl > 1) return 0; t=-t;\n\t}\n\tif(x > 1) t=-t; return t;\n}\nint f(int n,int m)\n{\n\tint pl=0,t=k/m;\n\tfor(int i=1;i*i<=t;i++)\n\t{\n\t\tif(t%i) continue ; pl=(pl+(i*dasuki(i))%p*(n/i)%p*(n/i+1)%p*i2%p+p)%p;\n\t\tif(i*i != t) pl=(pl+((t/i)*dasuki(t/i))%p*(n/(t/i))%p*(n/(t/i)+1)%p*i2%p+p)%p;\n\t}\n\treturn pl;\n}\nsigned main()\n{\n\tmiu[1]=1; scanf(\"%lld%lld\",&n,&k);\n\tfor(int i=2;i<N;i++)\n\t{\n\t\tif(! st[i]) pri.emplace_back(i),miu[i]=-1;\n\t\tfor(auto j : pri)\n\t\t{\n\t\t\tif(i*j > N) break ; st[i*j]=1;\n\t\t\tif(! (i%j)) {miu[i*j]=0; break ;}\n\t\t\tmiu[i*j]=-miu[i];\n\t\t}\n\t}\n\tfor(int i=1;i*i<=k;i++) \n\t{\n\t\tif(k%i) continue ; res=(res+f(n/i,i))%p; \n\t\tif(i*i != k) res=(res+f(n/(k/i),k/i))%p;\n\t}\n\tres=(res*k)%p; printf(\"%lld\",res);\n\treturn 0;\n}\n```",
        "postTime": 1667730551,
        "uid": 230865,
        "name": "EastPorridge",
        "ccfLevel": 0,
        "title": "[ABC020D] LCM Rush \u9898\u89e3"
    },
    {
        "content": "\u6709\u8da3\u7684 AT \u7684 $2600$\u3002\n\n\u53ef\u80fd\u96be\u5ea6\u504f\u9ad8\uff1f\n\n\u9996\u5148\u6211\u4eec\u660e\u786e\u8981\u8ba1\u7b97\u7684\u662f $\\sum \\limits _{i=1} ^n \\operatorname{lcm(i,k)}$\u3002\n\n\u8f6c\u5316\u4e00\u4e0b\u53d8\u6210\u4e86 $\\sum \\limits _{i=1} ^n \\dfrac{i \\times k}{\\gcd(i,k)}$\u3002\n\n\u7136\u540e\u6211\u4eec\u5148\u8003\u8651\u70b9\u66b4\u529b\u7684\u505a\u6cd5\u3002\n\n\u6bd4\u65b9\u8bf4\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u679a\u4e3e\u8fd9\u4e2a $\\gcd(i,k)$\uff0c\u7136\u540e\u8ba1\u7b97\u6709\u591a\u5c11\u4e2a\u5408\u6cd5\u7684\u3002\n\n\u6211\u4eec\u8bbe $g=\\gcd(i,k)$\u3002\n\n\u5f53\u7136\uff0c\u8fd9\u91cc\u76f4\u63a5\u8ba1\u7b97\u4e3a $\\dfrac{n}{g}$ \u4f1a\u51fa\u95ee\u9898\uff0c\u56e0\u4e3a\u5b58\u5728 $g$ \u7684\u500d\u6570\u3002\n\n\u6211\u4eec\u8fd9\u91cc\u9700\u8981\u4e00\u4e2a\u5c0f\u5bb9\u65a5\uff0c\u5c31\u662f $\\dfrac{n}{g}$ \u51cf\u53bb\u5b83\u7684\u500d\u6570\u3002\n\n\u5177\u4f53\u7684\uff0c\u6211\u4eec\u8bbe $f_x$ \u8868\u793a $n$ \u91cc\u9762\u6709 $\\gcd(i,k)=x$ \u7684\u4e2a\u6570\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u4e00\u4e2a $f_g=\\dfrac{n}{g}-\\sum \\limits _{i=1}^{\\frac{k}{i}} f_{i \\times g}$\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u597d\u7684\u6c42\u51fa\u6240\u6709\u7684 $f$ \u6570\u7ec4\u3002\n\n\u4f46\u662f\uff0c\u6211\u4eec\u9700\u8981\u6c42\u7684\u662f $\\sum \\limits _{i=1} ^n \\dfrac{i \\times k}{\\gcd(i,k)}$\uff0c\u6211\u4eec\u786e\u5b9a\u4e86 $\\dfrac{k}{\\gcd(i,k)}$ \u4e4b\u540e\u9700\u8981\u6c42\u51fa\u7684\u5c31\u662f $i$ \u7684\u603b\u548c\u3002\n\n\u4e2a\u6570\u4f1a\u6c42\u4e86\uff0c\u90a3\u603b\u548c\u8fd8\u6c42\u4e0d\u51fa\u6765\u4e48\uff1f\n\n\u5c31\u628a\u4e2a\u6570\u6539\u4e3a\u7b49\u5dee\u6570\u5217\u5373\u53ef\u3002\n\n\u8fd9\u6837\u5c31\u80fd\u5f88\u597d\u7684\u8fc7\u6389\u5f88\u591a subtask\u3002\n\n```cpp\n\tint kk=0;\n\tfor (int i=m;i>=1;i--) {\n\t\tif (m%i) continue;\n\t\tg[i]=n/i;\n\t\t\n\t\tint l=i,r=n/i*i;\n\t\tg[i]=(l+r)*(n/i)/2%Mod;\n\t\tfor (int j=i+i;j<=m;j+=i)\n\t\t\tg[i]-=g[j],g[i]%=Mod;\n\t\tint K=g[i]%Mod;\n\t\tK*=m/i;K%=Mod;\n\t\tkk+=K;\n\t\tkk%=Mod;\n\t}\n\tkk+=Mod;kk%=Mod;\n\tcout<<kk<<\"\\n\";\n```\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u7b97\u6cd5\u8fd8\u662f\u4e0d\u591f\u4f18\u79c0\uff0c\u7ee7\u7eed\u8003\u8651\u4f18\u5316\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u5982\u679c\u4e0d\u662f $m$ \u7684\u7ea6\u6570\u5219\u4e00\u70b9\u7528\u5904\u90fd\u6ca1\u6709\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u628a\u7ea6\u6570\u7ed9\u641e\u51fa\u6765\u4e4b\u540e\u518d\u505a\u4e0a\u9762\u7684\u3002\n\n```cpp\n\tfor (int i=1;i*i<=m;i++)\n\t\tif (m%i==0) {\n\t\t\td.pb(i);\n\t\t\tif (m/i!=i) d.pb(m/i);\n\t\t}\n\tsort(d.begin(),d.end(),cmp);\n\tfor (int i:d) {\n\t\tint l=i,r=n/i*i;\n\t\tg[i]=(l+r)*(n/i)/2%Mod;\n\t\tfor (int j:d)\n\t\t\tif (j%i==0 && j>i) g[i]-=g[j],g[i]%=Mod;\n\t\tint K=g[i]%Mod;\n\t\tK*=m/i;K%=Mod;\n\t\tkk+=K;\n\t\tkk%=Mod;\n\t}\n\tkk%=Mod;kk+=Mod;kk%=Mod;\n```\n\n\u795d\u8d3a\u4f60\u901a\u8fc7\u4e86\u8fd9\u9053 $2600$ \u7684\u9898\u3002\n\n",
        "postTime": 1666937951,
        "uid": 208653,
        "name": "_edge_",
        "ccfLevel": 0,
        "title": "AT_abc020_d"
    },
    {
        "content": "# \u9898\u89e3 [ABC020D] LCM Rush\n\n\u9898\u610f\uff1a\u7ed9 $n,k$\uff0c\u6c42 $\\sum\\limits_{i=1}^n \\operatorname{lcm}(i,k)$\u3002$1\\leq n,k\\leq 10^9$\u3002\n\n$$\n\\begin{aligned}\n\\sum_{i=1}^n \\operatorname{lcm}(i,k)&=\\sum_{i=1}^n \\dfrac{ik}{\\gcd(i,k)}\\\\\n&=k\\sum_{i=1}^n \\dfrac{i}{\\gcd(i,k)}\n\\end{aligned}\n$$\n\n\u679a\u4e3e $g=\\gcd(i,k)$\uff0c\n\n$$\n\\begin{aligned}\n\\sum_{i=1}^n \\operatorname{lcm}(i,k)&=k\\sum_{g|k}\\sum_{i=1,(i,\\frac kg)=1}^{\\lfloor\\frac ng\\rfloor}i\n\\end{aligned}\n$$\n\n\u73b0\u5728\u95ee\u9898\u53d8\u6210\u4e86\uff0c\u7ed9\u5b9a $m, p$\uff0c\u6c42 $\\sum\\limits_{i=1,(i,p)=1}^mi$\u3002\u53ef\u4ee5\u5bb9\u65a5\u6c42\u89e3\u3002\n\n\u5177\u4f53\u5730\uff0c\u679a\u4e3e\u6240\u6709 $q|p$\uff0c$q$ \u6bcf\u4e2a\u8d28\u56e0\u5b50\u6b21\u6570\u4e0d\u5927\u4e8e $1$\uff0c\u5219\n\n$$\n\\sum\\limits_{i=1,(i,p)=1}^mi=\\sum_q q\\times \\left(\\sum_{i=1}^{\\lfloor\\frac mq\\rfloor}i\\right)\\times val_q\n$$\n\n\u5176\u4e2d\u5f53 $q$ \u7684\u8d28\u56e0\u5b50\u4e2a\u6570\u4e3a\u5076\u6570\u65f6 $val_q=1$\uff0c\u5426\u5219 $val_q=-1$\u3002\uff08$1$ \u4e0d\u7b97\u8d28\u56e0\u5b50\uff09\n\n```cpp\n/*\n    name: LCM Rush\n    id:   AT_abc020_d\n    date: 2023/01/25\n*/\n\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nconst ll P = 1e9 + 7;\nint n, k, top;\nll ans = 0;\n\nint calc(int p){\n\tint sum = 1;\n\tfor(int i = 2; i * i <= p; ++ i){\n\t\tif(p % i == 0){\n\t\t\t++ sum;\n\t\t\tp /= i;\n\t\t}\n\t\tif(p % i == 0){\n\t\t\treturn 0;\t\n\t\t}\n\t}\n\tif(p != 1){\n\t\t++ sum;\n\t}\n\treturn (sum&1) ? 1 : -1;\n}\n\n#define adall(k) ((ll)(k) * ((k)+1) / 2)\n\nll solve(int g){\n\tint p = k / g, m = n / g;\n\tll cur = 0;\n\tfor(int q = 1; q * q <= p; ++ q){\n\t\tif(p % q == 0){\n\t\t\tcur += calc(q) * q * adall((int)m/q);\n\t\t\tint r = p/q;\n\t\t\tif(r != q){\n\t\t\t\tcur += calc(r) * r * adall((int)m/r);\n\t\t\t}\n\t\t}\n\t}\n\treturn cur % P;\n}\n\nint main(){\n\tscanf(\"%d%d\", &n, &k);\n\tfor(int g = 1; g * g <= k; ++ g){\n\t\tif(k % g != 0){\n\t\t\tcontinue;\n\t\t}\n\t\tans += solve(g);\n\t\tif(g * g != k){\n\t\t\tans += solve(k / g);\n\t\t}\n\t\tans %= P;\n\t}\n\tprintf(\"%lld\\n\", ans * k % P);\n\treturn 0;\n}\n```",
        "postTime": 1674648386,
        "uid": 390770,
        "name": "AiRC0S",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 [ABC020D] LCM Rush"
    },
    {
        "content": "# [ABC020D] LCM Rush\n\n#### update 2023.2.22 \u4f7f\u7528alignedat\u73af\u5883\n\n## \u9898\u9762\u7ffb\u8bd1\n\n- \u8bb0\u4e24\u4e2a\u6b63\u6574\u6570 $a,b$ \u7684\u6700\u5c0f\u516c\u500d\u6570\u4e3a $\\operatorname{lcm}(a,b)$\u3002\u7ed9\u51fa\u4e24\u4e2a\u6b63\u6574\u6570 $N(1\\le N\\le 10^9)$ \u548c $K(1\\le K\\le 100)$\u3002\u5bf9\u4e8e\u6240\u6709\u6574\u6570 $i(1\\le i\\le N)$\uff0c\u7d2f\u52a0 $\\operatorname{lcm}(i,K)$ \u7684\u503c\uff0c\u5e76\u6c42\u51fa\u8fd9\u4e2a\u503c\u3002\u7531\u4e8e\u7ed3\u679c\u53ef\u80fd\u5f88\u5927\uff0c\u4f60\u53ea\u9700\u8981\u8f93\u51fa\u7b54\u6848\u6a21 $10^9+7$ \u7684\u4f59\u6570\u3002\n- \u8f93\u5165\u4ec5\u5305\u542b\u4e24\u4e2a\u6574\u6570 $N$ \u548c $K$\u3002\u8f93\u51fa\u5373\u4e3a\u9898\u4e2d\u6240\u6c42\u3002\n\n## \u505a\u6cd5\n\n$\\begin{alignedat}{3}\\sum_{i=1}^n\\operatorname{lcm}(i,k)\n&=\\sum_{i=1}^n\\frac{i\\times k}{\\gcd(i,k)}\n\\\\&=k\\times\\sum_{d|k}\\frac{1}{d}\\sum_{i=1}^n[\\gcd(i,k)=d]i\n\\\\&=k\\times\\sum_{d|k}\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}[\\gcd(i,\\frac{k}{d})=1]i\n\\end{alignedat}$\n\n\u540e\u9762\u4e00\u90e8\u5206\u63d0\u51fa\u6765\u5f97\uff1a\n\n$\\begin{alignedat}{2}\\sum_{i=1}^n[\\gcd(i,m)=1]i\n&=\\sum_{i=1}^ni\\sum_d[d|i][d|m]\\mu(d)\n\\\\&=\\sum_{d|m}\\mu(d)dS(\\lfloor\\frac{n}{d}\\rfloor)\n\\end{alignedat}$\n\n$$S(n)=\\frac{n\\times(n+1)}{2}$$\n\n\u8003\u8651\u4e0d\u7528\u66b4\u529b\u6c42\u592a\u591a\u6b21\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(d(k)^2)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n\nconst ll N=5e6+5;\nconst ll p=1e9+7;\nll n,k,cnt,ans;\nbool vis[N];\nll mu[N],prime[N];\ninline void init(ll n){\n\tmu[1]=1;\n\tF(i,2,n){\n\t\tif(!vis[i]){\n\t\t\tmu[i]=-1;\n\t\t\tprime[++cnt]=i;\n\t\t}\n\t\tfor(ll j=1;j<=cnt&&i*prime[j]<=n;j++){\n\t\t\tvis[i*prime[j]]=1;\n\t\t\tif(i%prime[j]==0) break;\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n}\nvector<int> v;\ninline ll get_mu(ll n){\n\tif(n<=5e6) return mu[n];\n\tll res=0;\n\tfor(ll i=1;prime[i]*prime[i]<=n;i++){\n\t\tif(n%prime[i]==0){\n\t\t\tres++;\n\t\t\tll num=0;\n\t\t\twhile(n%prime[i]==0) n/=prime[i],num++;\n\t\t\tif(num>1) return 0;\n\t\t}\n\t}\n\tif(n>1) res++;\n\treturn res&1?-1:1;\n}\ninline ll S(ll x){\n\treturn x*(x+1)/2%p;\n}\ninline ll get_ans(ll n,ll m){\n\tll res=0;\n\tfor(ll i:v){\n\t\tif(i>m) break;\n\t\tif(m%i) continue;\n\t\tres=(res+get_mu(i)*i%p*S(n/i)%p)%p;\n\t}\n\treturn res;\n}\nint main(){\n\tn=read();k=read();\n\tinit(5e6);\n\tfor(ll i=1;i*i<=k;i++){\n\t\tif(k%i==0){\n\t\t\tv.push_back(i);\n\t\t\tif(i*i!=k) v.push_back(k/i);\n\t\t}\n\t}\n\tsort(v.begin(),v.end());\n\tfor(ll i:v) ans=(ans+get_ans(n/i,k/i))%p;\n\tans=(ans+p)%p;\n\tprintf(\"%lld\\n\",k*ans%p);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1673762986,
        "uid": 406832,
        "name": "Mikefeng",
        "ccfLevel": 7,
        "title": "AT_abc020_d"
    },
    {
        "content": "\u5148\u63a8\u5f0f\u5b50\u3002\n\n$$\\begin{aligned}\n\\text{ans}=&\\sum\\limits_{i=1}^m\\text{lcm}(i,k)\\\\\n=&\\sum\\limits_{i=1}^m\\dfrac{ik}{\\gcd(i,k)}\\\\\n=&\\sum\\limits_{g=1}^{\\min(m,k)}\\sum\\limits_{i=1}^m\\dfrac{ik}{g}[\\gcd=g]\\\\\n=&k\\sum\\limits_{g|k}\\sum\\limits_{i=1}^{\\lfloor\\frac{m}{d}\\rfloor}i\\varepsilon(\\text{gcd}^{'})\n\\end{aligned}$$\n\n\u628a\u540e\u9762\u90a3\u4e00\u5806\u62ce\u51fa\u6765\u53cd\u6f14\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\\sum\\limits_{i=1}^{\\lfloor\\frac{m}{d}\\rfloor}i\\varepsilon(\\text{gcd}')=\\sum\\limits_{i=1}^{\\lfloor\\frac{m}{d}\\rfloor}i\\sum\\limits_{t|\\text{gcd}'}\\mu(t)=\\sum\\limits_{t|k}t\\mu(t)\\sum\\limits_{i=1}^{\\lfloor\\frac{m}{dt}\\rfloor}i$$\n\n\u7136\u540e\u53ef\u4ee5\u5feb\u901f\u6c42\u5f97\u3002\u95ee\u9898\u5728\u4e8e\u5982\u4f55\u77e5\u9053 $\\mu(t)$ \u7684\u503c\uff0c\u53ea\u9700\u8981\u5148\u6c42\u5927\u6982 $10^7$ \u7684 $\\mu$\uff0c\u7136\u540e\u5927\u4e8e\u8fd9\u4e2a\u503c\u7684 $t$ \u53ef\u4ee5\u60f3\u5230\u4e0d\u4f1a\u592a\u591a\uff0c\u6240\u4ee5\u66b4\u529b\u53bb\u7b97\u5c31\u53ef\u4ee5\u4e86\u3002\u4e00\u4e2a\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\u5c31\u662f\u8003\u8651\u5230 $\\gcd'$ \u7684\u5b9e\u9645\u542b\u4e49\u662f $\\gcd(\\frac{i}{g},\\frac{k}{g})$\uff0c\u6240\u4ee5\u663e\u7136\u6709 $\\gcd'\\le \\frac{k}{g}$\uff0c\u9700\u8981\u7279\u6b8a\u5904\u7406\u4e00\u4e0b\u3002\u4ee4 $d(k)$ \u8868\u793a $k$ \u7684\u56e0\u6570\u4e2a\u6570\uff0c\u90a3\u4e48\u590d\u6742\u5ea6\u662f $O(d(k)^2)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n//#define feyn\n#define int long long\nconst int N=5000010;\nconst int mod=1e9+7;\nusing namespace std;\ninline void read(int &wh){\n\twh=0;char w=getchar();int f=1;\n\twhile(w<'0'||w>'9'){if(w=='-')f=-1;w=getchar();}\n\twhile(w<='9'&&w>='0'){wh=wh*10+w-'0';w=getchar();}\n\twh*=f;return;\n}\n\nint m,k;\n\nint p[N>>2],cnt,mu[N];\nbool vis[N];\nvoid init(){\n\tmu[1]=1;\n\tfor(int i=2;i<N;i++){\n\t\tif(vis[i]==false)p[++cnt]=i,mu[i]=-1;\n\t\tfor(int j=1;i*p[j]<N;j++){\n\t\t\tvis[i*p[j]]=true;if(i%p[j]==0)break;\n\t\t\tmu[i*p[j]]=-mu[i];\n\t\t}\n\t}\n}\nmap<int,int>reM;\ninline int work(int val){\n\tif(val<N)return mu[val];\n\tif(reM.count(val))return reM[val];\n\tfor(int i=1;p[i]*p[i]<=val;i++){\n\t\tif(val%p[i])continue;val/=p[i];\n\t\tif(val%p[i]==0)return 0;\n\t\telse return -work(val);\n\t}\n\treturn -1;\n}\ninline int ff(int wh){return wh*(wh+1)/2%mod;}\n\nint num,c[100],d[100],a[N>>2],top;\nvoid dfs(int wh,int val){\n\tif(wh>num)return a[++top]=val,void();\n\tfor(int i=0;i<=d[wh];i++)dfs(wh+1,val),val*=c[wh];\n}\n\nsigned main(){\n\t\n\t#ifdef feyn\n\tfreopen(\"in.txt\",\"r\",stdin);\n\t#endif\n\t\n\tread(m);read(k);init();int kk=k,ans=0;\n\tfor(int i=1;p[i]*p[i]<=k;i++){\n\t\tif(k%p[i])continue;\n\t\tc[++num]=p[i];\n\t\twhile(k%p[i]==0)k/=p[i],++d[num];\n\t}\n\tif(k>1)c[++num]=k,d[num]=1;dfs(1,1);\n\tsort(a+1,a+top+1);\n\tfor(int i=1;i<=top;i++){\n\t\tfor(int j=1;j<=top;j++){\n\t\t\tint g=a[i],t=a[j];\n\t\t\tif(kk%(g*t))continue;\n\t\t\tans+=t*work(t)*ff(m/(g*t));ans%=mod;\n\t\t}\n\t}\n\tans*=kk;printf(\"%lld\\n\",(ans%mod+mod)%mod);\n\t\n\treturn 0;\n}\n```",
        "postTime": 1672750468,
        "uid": 302383,
        "name": "Feyn",
        "ccfLevel": 0,
        "title": "AT_abc020_d"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a $n,k$ \uff0c\u6c42 $\\sum_{i=1}^n \\text{lcm}(i,k)$\uff0c$n,k\\le 10^9$\u3002\n\n\u56e0\u4e3a $\\LaTeX$ \u8f83\u591a\u6240\u4ee5\u5c31\u4e22\u6d1b\u8c37\u4e0a\u4e86\u3002\n\n\u975e\u5e38\u5957\u8def\u7684\u9898\uff0c\u7136\u800c\u6211\u6709\u975e\u5e38\u5947\u602a\u7684\u505a\u6cd5...\u8001\u5e74\u9000\u5f79\u9009\u624b\u54ed\u4e86\u3002\n\n\u539f\u5f0f\u53ef\u4ee5\u53d8\u4e3a \uff1a\n\t\n  $$\\sum_{i=1}^n \\dfrac{ik}{\\gcd(i,k)}$$\n   \n\u63a5\u7740\u679a\u4e3e $\\gcd$ \u53d8\u4e3a\uff1a\n\n  $$\\sum_{d=1}^n [d|k] \\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} ik [\\gcd(i,\\frac{k}{d})=1]$$\n   \n\u4ee4 \n  $$\\text{sum}(t,d)=\\sum_{i=1}^{t} i [\\gcd(i,\\frac{k}{d})=1]$$\n    \n\u8003\u8651\u5229\u7528 $\\epsilon(n) = \\sum_{i|n} \\mu(i)$\uff0c\u8fdb\u884c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff1a\n\n  $$\\text{sum}(t,d)=\\sum_{i=1}^{t} i \\sum_{u|i,u|\\frac{k}{d}} \\mu(u)$$\n   \n\u679a\u4e3e $u$\uff1a\n\n  $$\\text{sum}(t,d)=\\sum_{u|\\frac{k}{d}} \\mu(u) \\sum_{i=1}^{\\lfloor \\frac{t}{u} \\rfloor} i$$\n   \n\u6240\u4ee5\u539f\u5f0f\u548c\u4e0a\u5f0f\u5747\u53ef\u5728 $O(d(k))$ \u7684\u590d\u6742\u5ea6\u5185\u6c42\u5f97\uff0c\u603b\u590d\u6742\u5ea6 $O(d(k)^2)$\uff0c\u5176\u4e2d $d(k)$ \u4e3a $k$ \u7684\u56e0\u6570\u4e2a\u6570\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define pii pair<int,int>\n#define pb push_back\n#define N 200005\n#define fi first\n#define se second\n#define M 1000000007\nusing namespace std;\nint n,k; map<int,int>miu,vis;\nint getmiu(int x){\n\tif(x==1) return 1; \n\tif(vis[x]) return miu[x]; \n\tvis[x]=1; int ret=x,an=1;\n\tfor(int i=2;i*i<=x;i++){\n\t\tint cn=0; while(ret%i==0) ret/=i,++cn;\n\t\tif(!cn) continue;\n\t\tif(cn>1) return miu[x]=0;\n\t\tan*=-1;\n\t}if(ret>1) an*=-1;\n\treturn miu[x]=an;\n}int o(int x){return (x*(x+1)/2)%M;}\nint sur(int T,int p){return p*getmiu(p)%M*o(T/p)%M;}\nint sum(int T,int p){\n\tint ret=0;\n\tfor(int u=1;u*u<=p;u++){\n\t\tif(p%u) continue;\n\t\tret=(ret+sur(T,u))%M;\n\t\tif(u!=p/u) ret=(ret+sur(T,p/u))%M;\n\t}return k*ret%M;\n}signed main(){\n\tscanf(\"%lld%lld\",&n,&k); int ans=0;\n\tfor(int d=1;d*d<=k;d++){\n\t\tif(k%d) continue;\n\t\tans=(ans+sum(n/d,k/d))%M;\n\t\tif(d!=k/d) ans=(ans+sum(n/(k/d),d))%M;\n\t}printf(\"%lld\\n\",(ans+M)%M);\n\treturn 0;\n}\n```",
        "postTime": 1646744473,
        "uid": 132040,
        "name": "S00021",
        "ccfLevel": 0,
        "title": "AT1268"
    }
]
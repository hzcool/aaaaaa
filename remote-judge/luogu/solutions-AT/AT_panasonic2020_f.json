[
    {
        "content": "# \u524d\u8a00\n\n\u5c0f\u6e05\u65b0\u5206\u7c7b\u8ba8\u8bba\u9898\u3002\n\n# \u6b63\u6587\n\n\u7c7b\u4f3c\u4e8e\u4e00\u822c\u6709\u65e0\u9650\u7684\u9898\u76ee\uff0c\u6211\u4eec\u8003\u8651\u5206\u6cbb\u3002\n\n\u4e0d\u8fc7\u8981\u5206\u7c7b\u8ba8\u8bba\uff08\u501f\u5f20\u56fe\uff09\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qoy0f4di.png)\n\n\u5c06 123, 456, 789 \u5404\u81ea\u5206\u4e00\u7ec4\u3002\n\n\u8bbe\u7ea7\u522b\u4e3a $K$, \u5219\u5927\u5c0f\u4e3a $3^K$.\n\n## 1. $K = 0$\n\n\u7531\u4e8e\u6ca1\u6709\u9ed1\u5757\u963b\u9694\uff0c\u6240\u4ee5 $y$ \u5750\u6807\u76f8\u51cf\u5373\u53ef\u3002\n\n## 2. $K \\neq 0$\n\n## 2. 1 \u4e0d\u5728\u540c\u4e00\u7ec4\n\n\u9664\u4e86 2 8, \u6c42\u51fa\u66fc\u54c8\u987f\u8ddd\u79bb\u5373\u53ef\u3002\n\n2 8 \u4e5f\u53ef\u4ee5\u5229\u7528\u8f74\u5bf9\u79f0\u6027\uff0c\u4ea4\u6362 $x, y$ \u5750\u6807\u518d\u6c42\u89e3\u3002\n\n## 2. 2 \u5728\u540c\u4e00\u7ec4\uff0c\u4f46\u662f\u5728 456 \u8fd9\u4e00\u7ec4\n\n\u80af\u5b9a\u8981\u7ed5\u8fc7 5.\n\n\u8003\u8651\u5de6\u53f3\u4e24\u79cd\u8d70\u6cd5\u5373\u53ef\u3002\u7b54\u6848\uff08\u4e0d\u4f1a\u7528 $\\LaTeX$ \u8868\u793a\u53d6\u6a21\uff0c\u6240\u4ee5\u7528\u4e86\u4ee3\u7801\u5757\u8bf7\u89c1\u8c05\uff09\uff1a\n\n`abs(b - d) + min(a % size + c % size + 2, size * 2 - a % size - c % size)`\n\n\uff08$size = 3^{K - 1}$\uff09\n\n## 2. 3 \u5728\u540c\u4e00\u7ec4\uff0c\u4f46\u662f\u4e0d\u5728 456 \u8fd9\u4e00\u7ec4\n\n\u9012\u5f52\u5206\u6cbb\u6c42\u89e3\u5373\u53ef\u3002\n\n\u6ce8\u610f $y$ \u5750\u6807\u4e0d\u53d8, $x$ \u5750\u6807\u6a21\u53bb $3^{K - 1}$.\n\n# \u4ee3\u7801 \n\n``` cpp\n// Problem: AT5809 Fractal Shortest Path\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/AT5809\n// Memory Limit: 1000 MB\n// Time Limit: 2000 ms\n\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\n\nll Q;\n\nll div(ll a, ll b, ll c, ll d, ll k)\n{\n\tif(k == 0)\n\t\treturn abs(b - d);\n\t\t\n\tll size = pow(3ll, (long long) k - 1ll);\n\tif(a / size != c / size) \n\t\treturn abs(a - c) + abs(b - d);\n\t\t\n\telse if(a / size == 1 && abs(b / size - d / size) >= 2)\n\t\treturn abs(b - d) + min(a % size + c % size + 2, size * 2 - a % size - c % size);\n\t\t\n\telse\n\t\treturn div(a % size, b, c % size, d, k - 1);\n}\n\nsigned main()\n{\n\tcin >> Q;\n\tfor(ll i = 1; i <= Q; ++ i)\n\t{\n\t\tll a, b, c, d;\n\t\tcin >> a >> b >> c >> d;\n\t\t-- a; -- b; -- c; -- d;\n\t\tif(abs(a - c) > abs(b - d)) \n\t\t{\n\t\t\tswap(a, b);\n\t\t\tswap(c, d);\n\t\t}\n\t\t\n\t\tcout << div(a, b, c, d, 30) << endl;\n\t}\n    \n\treturn 0;\n}\n```\n\n# \u540e\u8a00\n\n\u601d\u7ef4\u9898\u4e00\u5b9a\u8981\u591a\u601d\u8003...",
        "postTime": 1653309846,
        "uid": 224558,
        "name": "JackMerryYoung",
        "ccfLevel": 5,
        "title": "AT5809 Fractal Shortest Path \u9898\u89e3"
    },
    {
        "content": "### \u601d\u8def\uff1a  \n\u5c06\u56fe\u5206\u4e3a 9 \u5757\uff0c\u5176\u4e2d 123 \u4e3a\u4e00\u5c42\uff0c456 \u4e3a\u4e00\u5c42\uff0c789\u4e3a\u4e00\u5c42\u3002\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qoy0f4di.png)\n1.\u4e24\u70b9\u5728\u4e0d\u540c\u5c42\uff08\u9664\u4e86 2 \uff0c8 \uff09\uff1a\u4e24\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u5373\u4e3a\u4e24\u70b9\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/87kmaqwo.png)\n\n\u4e3a\u4e86\u907f\u514d\uff082\uff0c8\uff09\u8fd9\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ea4\u6362\uff08x\uff0cy\uff09\u8f6c\u5316\u4e3a\uff084\uff0c6\uff09\u3002\n\n\u4e0b\u56fe\u4e2d(0,3)->(3,0),(8,5)->(5,8)\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jrynzkcw.png)\n2.\u4e24\u70b9\u5728\u540c\u4e00\u5c42\uff0c\u5e76\u4e14\u4e0d\u5728456 \u8fd9\u5c42\uff1a\u53ef\u4ee5\u5f80\u4e0b\u9012\u5f52\uff0cy\u8f74\u4fdd\u6301\u4e0d\u53d8\u3002\n\n3.\u4e24\u70b9\u5728\u540c\u4e00\u5c42\uff0c\u5e76\u4e14\u5728 456\u8fd9\u5c42\uff1a\u7531\u4e8e\u9700\u8981\u7ed5\u8fc7\u4e2d\u95f4\u8fd9\u5757\uff0c\u53ea\u8981\u5224\u65ad\u5f80\u5de6\u8d70\u8fd8\u662f\u5f80\u53f3\u8d70\u5373\u53ef\u3002\n\n\u5411\u5de6\u8d70\uff0c\u8d70\u8fc7\u7684\u8ddd\u79bb $$    \\left |  y1-y2\\right | +x1 \\%w+1+x2 \\%w +1 $$ \u7531\u6765\uff0c\u8be6\u89c1\u4e0b\u56fe\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yqbve2r7.png)\n\u5411\u53f3\u8d70\uff0c\u8d70\u8fc7\u7684\u8ddd\u79bb $$\\left |  y1-y2\\right | +\\left ( w-x1\\%w \\right )\n\n+\\left ( w-x2\\%w \\right )$$\u7531\u6765\uff0c\u8be6\u89c1\u4e0b\u56fe\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r7o5vtli.png)\n\n\u5728\u5411\u5de6\u8d70\uff0c\u5411\u53f3\u8d70\uff0c\u8def\u5f84\u4e2d\uff0c\u53d6\u6700\u5c0f\u503c\u3002\n### \u4ee3\u7801:\n```cpp\n#include <cstdio>\n\n#include <algorithm>\n\n#define LL long long\n\nusing namespace std;\n\nLL width[35];\n\nLL cal(LL x1,LL y1,LL x2,LL y2,int level){\n\n\tLL w;\n\n\tif(level==0)return abs(y1-y2);//\u8def\u5f84\u4e0a\u4e00\u76f4\u672a\u9047\u5230\u9ed1\u8272\u65b9\u5757\n\n\tw=width[level-1];//\u5f53\u524d\u7ea7\u522blevel,\u6df1\u5165\u52309\u4e2alevel-1\u7ea7\u522b\u4e2d\u8fdb\u884c\u5904\u7406\n\n\tif(x1/w!=x2/w)return abs(x1-x2)+abs(y1-y2);//\u5904\u5728\u4e0d\u540c\u5c42\u4e2d\uff0c\u53ef\u7528\u66fc\u54c8\u987f\u8ddd\u79bb\u5904\u7406\n\n\tif(x1/w==1&&abs(y1/w-y2/w)>=2)//x1/w==x2/w  \u5904\u4e8e\u540c\u4e00\u5c42\uff0c\u4e14\u5728456\u8fd9\u4e00\u5c42\n\n\t\treturn abs(y1-y2)+min(x1%w+1+x2%w+1,(w-x1%w)+(w-x2%w));//x1%w+1+x2%w+1\u5411\u5de6\u63a8\u8fdb\uff0c(w-x1%w)+(w-x2%w)\u5411\u53f3\u63a8\u8fdb\n\n\treturn cal(x1%w,y1,x2%w,y2,level-1);//\u5f53\u524d\u5904\u7406\u4e0d\u4e86\uff0c\u53ea\u80fd\u6df1\u5165\u5230level-\u7ea7\u522b\u4e2d\u8fdb\u884c\u5904\u7406\uff0c\u56fa\u5b9aabs(y1-y2),\u9488\u5bf9x\u8fdb\u884c\u5904\u7406,\u56e0x1/w==x2/w\uff0c\u6545\u53ef\u53d6\u6a21\n\n}\n\nint main(){\n\n\tint i,q;\n\n\twidth[0]=1;\n\n\tfor(i=1;i<=29;i++)width[i]=width[i-1]*3;\n\n\tLL x1,y1,x2,y2;\n\n\tscanf(\"%d\",&q);\n\n\twhile(q--){\n\n\t\tscanf(\"%lld%lld%lld%lld\",&x1,&y1,&x2,&y2);\n\n\t\tx1--,y1--,x2--,y2--;//\u6d89\u53ca\u53d6\u6a21\u8fd0\u7b97\uff0c\u6545\u7b2c1\u884c\u53d8\u6210\u7b2c0\u884c\uff0c\u6545\u7b2c1\u5217\u53d8\u6210\u7b2c0\u5217\n\n\t\tif(abs(x1-x2)>abs(y1-y2))swap(x1,y1),swap(x2,y2);//\u6293\u4f4f\u56fe\u5f62\u5177\u6709\u5bf9\u79f0\u6027\uff0c\u907f\u514d\u51fa\u73b0258\u7684\u60c5\u51b5\u3002\n\n\t\tprintf(\"%lld\\n\",cal(x1,y1,x2,y2,30));\n\n\t}\n\n\treturn 0;\n\n}",
        "postTime": 1643617954,
        "uid": 490461,
        "name": "zy666_AC",
        "ccfLevel": 0,
        "title": "Fractal Shortest Path"
    }
]
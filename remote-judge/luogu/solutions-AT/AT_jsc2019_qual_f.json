[
    {
        "content": "\u7565\u6709\u96be\u5ea6\u7684\u7ec4\u5408\u8ba1\u6570\u9898\u3002\u6d89\u53ca\u591a\u6b65\u8f6c\u6362\uff0c\u6bcf\u4e00\u6b65\u96be\u5ea6\u90fd\u4e0d\u5927\u3002\n\n\u9996\u5148\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u7ed3\u8bba\uff1a\u5bf9\u4e8e\u957f\u5ea6\u4e3a $n$ \u7684\u975e\u8d1f\u6574\u6570\u5e8f\u5217 $\\{a_{1..n}\\}$ \uff0c\u82e5 $\\sum a_i=s$\uff0c\u5219\u7b26\u5408\u6761\u4ef6\u7684 $\\{a_{1..n}\\}$ \u4e2a\u6570\u4e3a $\\binom{s+n-1}{n-1}$ \u3002\u8bc1\u660e\u7684\u65b9\u6cd5\u662f\u9694\u677f\u6cd5\uff0c\u5c06 $s$ \u4e2a\u7403\u548c $n-1$ \u5757\u677f\u4efb\u610f\u6392\u5217\u3002\u5982\u679c\u662f $\\sum a_i\\le s$\uff0c\u5c31\u76f8\u5f53\u4e8e\u518d\u52a0\u4e86\u4e00\u4e2a\u5143\u7d20 $s-\\sum a_i$\uff0c\u65b9\u6848\u6570\u4e3a $\\binom{s+n}{n}$ \u3002\n\n\u8bbe\u964d\u5e8f\u6392\u5217\u540e\u4e3a $\\{b_i\\}$ \u3002\n\n\u9996\u5148\uff0c\u53d1\u73b0\u6309\u539f\u6761\u4ef6\u4e0d\u592a\u53ef\u505a\uff0c\u5982\u679c\u662f\u5148\u6570\u964d\u5e8f\u6392\u5217\u7684\u4e2a\u6570\uff0c\u5219\u8fd8\u8981\u4e58\u4ee5\u4e00\u4e2a\u53ef\u91cd\u590d\u5143\u7d20\u6392\u5217\u6570\uff0c\u800c $b_m=b_{m+1}=x$ \u4e2d\u8fd9\u4e2a $x$ \u8fd8\u53ef\u80fd\u51fa\u73b0\u5728 $m$ \u5de6\u8fb9\u548c $m+1$ \u53f3\u8fb9\uff0c\u6570\u91cf\u96be\u4ee5\u7edf\u8ba1\u3002\n\n\u8003\u8651\u6b63\u96be\u5219\u53cd\uff0c\u7b97 $b_{m}>b_{m+1}$ \u7684\u65b9\u6848\u6570\uff0c\u6700\u7ec8\u7528\u603b\u65b9\u6848\u6570\u51cf\u6389\u3002\n\n\u9996\u5148\uff0c\u663e\u7136\u7684\u8f6c\u6362\u662f\u53bb\u6389 $\\sum a_i$ \u7684\u5de6\u8fb9\u754c\uff0c\u53d8\u6210 $\\le R$\u7684\u65b9\u6848\u6570\u51cf $\\le L-1$\u7684\u65b9\u6848\u6570\u3002\n\n\u679a\u4e3e $b_m=x$ \u3002\u6b64\u65f6\u8981\u7b97\u51fa\u6709 $m$ \u4e2a\u6570 $\\ge x$\uff0c\u6709 $n-m$ \u4e2a\u6570 $<x$ ,\u81f3\u5c11\u4e00\u4e2a\u6570 $=x$ \u7684\u65b9\u6848\u6570\u3002\u4e3a\u4e86\u6392\u9664\u7b2c\u4e09\u4e2a\u6761\u4ef6\uff0c\u7ee7\u7eed\u4f5c\u5dee\u3002\u5b9a\u4e49 $f(x,y)$ \u4e3a $m$ \u4e2a\u6570 $\\ge x$ \uff0c$n-m$ \u4e2a\u6570 $\\le y$ \u7684\u65b9\u6848\u6570\uff0c\u5219 $b_m=x$ \u7684\u65b9\u6848\u6570\u4e3a $f(x,x-1)-f(x+1,x-1)$\u3002\n\n\u518d\u8003\u8651\u5982\u4f55\u6c42 $f(x,y)$ \u3002\n\n\u9996\u5148\u4e58\u4e0a\u7cfb\u6570 $\\binom{n}{m}$ \uff0c\u679a\u4e3e\u54ea $m$ \u4e2a $\\ge x$\u3002\u5bf9\u4e8e $m$ \u4e2a\u6570 $\\ge x$\uff0c\u76f4\u63a5\u6bcf\u4e2a\u6570\u51cf $x$ \u3002\u5bf9\u4e8e $n-m$ \u4e2a\u6570 $\\le y$\uff0c\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u679a\u4e3e\u54ea $k$ \u4e2a\u5f3a\u5236 $>y$ \uff0c\u5c31\u628a\u8fd9\u4e9b\u6570\u6bcf\u4e2a\u51cf $y+1$ \u3002\n\n\u6700\u7ec8\u5f97\u5230\uff1a\n\n$$f(s,x,y)=\\binom{n}{m}\\sum_{i=0}^{n-m}(-1)^i\\binom{n-m}{i}\\binom{s-mx-i(y+1)+n}{n}$$\n\n\u7531\u4e8e $s-mx-i(y+1)$ \u5fc5\u987b $\\ge 0$\uff0c\u6240\u4ee5\u662f\u8c03\u548c\u7ea7\u6570\u7684\u590d\u6742\u5ea6\u3002",
        "postTime": 1614651125,
        "uid": 31381,
        "name": "C3H5ClO",
        "ccfLevel": 9,
        "title": "AT5169 Candy Retribution"
    },
    {
        "content": "\u6211\u4eec\u5148\u628a\u9650\u5236 $[l,r]$ \u5dee\u5206\u4e3a $[0,l)$ \u548c $[0,r]$\uff0c\u8fd9\u6837\u95ee\u9898\u8f6c\u5316\u4e3a\u548c\u4e0d\u8d85\u8fc7\u4e00\u4e2a\u6570 $u$ \u7684\u65b9\u6848\u6570\u3002\n\n\u6839\u636e\u63d2\u677f\u6cd5\u6211\u4eec\u77e5\u9053\u4e0d\u8003\u8651\u7b2c\u4e8c\u4e2a\u9650\u5236\u7684\u65b9\u6848\u6570\u4e3a $\\sum\\limits_{i=0}^u\\binom{i-1+n}{n-1}=\\binom{u+n}{n}$\u3002\n\n\u6211\u4eec\u73b0\u5728\u53ea\u9700\u8981\u6c42\u51fa\u4e0d\u6ee1\u8db3\u7b2c\u4e8c\u4e2a\u9650\u5236\u7684\u65b9\u6848\u6570 $S$ \u51cf\u6389\u5c31\u53ef\u4ee5\u4e86\u3002\u8bbe\u7b2c $m$ \u4f4d\u4e0a\u7684\u6570\u4e3a $x$\uff0c\u679a\u4e3e $x$ \u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f\u6709\u591a\u5c11\u79cd\u5e8f\u5217\u4f7f\u5f97 $m$ \u4e2a\u6570 $\\ge x$\uff0c$n-m$ \u4e2a\u6570 $<x$\uff0c\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u6570 $=x$\u3002\u81f3\u5c11\u6709\u4e00\u4e2a\u6570 $=x$ \u7684\u9650\u5236\u662f\u597d\u5904\u7406\u7684\uff0c\u53ea\u8981\u6c42\u51fa $m$ \u4e2a\u6570 $\\ge x+1$\uff0c$n-m$ \u4e2a\u6570 $<x$ \u7684\u65b9\u6848\u6570\u51cf\u53bb\u5373\u53ef\u3002\n\n\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u89e3 $m$ \u4e2a\u6570 $\\ge a$\uff0c\u5269\u4e0b\u7684\u6570 $< b$ \u4e14\u548c\u4e0d\u8d85\u8fc7 $u$ \u7684\u5e8f\u5217\u6570\uff0c\u6211\u4eec\u79f0\u5176\u4e3a $f(a,b)$\uff0c\u7531\u4e8e\u63d2\u677f\u6cd5\u4e0d\u6613\u4e8e\u5904\u7406 $<b$ \u8fd9\u6837\u7684\u9650\u5236\uff0c\u6211\u4eec\u8003\u8651\u94a6\u5b9a\u6070\u6709 $i$ \u4e2a\u4f4d\u7f6e $\\ge b$\uff0c\u5269\u4f59\u7684\u968f\u610f\uff0c\u8fd9\u6837\u7684\u65b9\u6848\u6570\u5c31\u662f $\\binom nm\\binom{n-m}{i}\\binom{u-ma-ib+n}{n}$\uff0c\u4e8c\u9879\u5f0f\u53cd\u6f14\u53ef\u4ee5\u5f97\u5230\uff0c\u5408\u6cd5\u7684\u65b9\u6848\u6570\u4e3a\n$$\nf(a,b)=\\sum\\limits_{i=0}^{n-m}(-1)^i\\binom nm\\binom{n-m}{i}\\binom{u-ma-ib+n}{n}\n$$\n\u4e8e\u662f\u6709\n$$\nS=\\sum\\limits_{x=1}^u(f(x,x)-f(x+1,x))\n$$\n\u6211\u4eec\u73b0\u5728\u5c31\u83b7\u5f97\u4e86\u4e00\u4e2a $O(un)$ \u7684\u505a\u6cd5\uff0c\u4f46\u662f\u6211\u4eec\u4f1a\u53d1\u73b0\u5728 $f(a,b)$ \u7684\u5f0f\u5b50\u4e2d $i$ \u5fc5\u987b\u6ee1\u8db3 $ib\\le u-ma$\uff0c\u6240\u4ee5\u8fd9\u91cc\u5b9e\u9645\u4e0a\u662f\u53ea\u6709 $O(u\\ln u)$ \u79cd $ib$ \u6709\u503c\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u5728 $O(u\\ln u)$ \u7684\u590d\u6742\u5ea6\u5185\u5b8c\u6210\u4e86 $S$ \u7684\u8ba1\u7b97\u3002\n\n\u603b\u590d\u6742\u5ea6 $O(R\\log R+N)$\u3002\n\n```cpp\n#include<iostream>\nusing std::cin;\nusing std::cout;\nint const mod=1e9+7;\nint pow(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1) res=1ll*res*x%mod;\n\t\tx=1ll*x*x%mod,y>>=1;\n\t}\n\treturn res;\n}\nint fac[600010],ifac[600010];\nint C(int n,int m){\n\treturn 1ll*fac[n]*ifac[m]%mod*ifac[n-m]%mod;\n}\nvoid init(int n){\n\tfac[0]=1;\n\tfor(int i=1;i<=n;i++) fac[i]=1ll*i*fac[i-1]%mod;\n\tifac[n]=pow(fac[n],mod-2);\n\tfor(int i=n;i;i--) ifac[i-1]=1ll*i*ifac[i]%mod;\n}\nint f(int a,int b,int n,int m,int u){\n\tint ans=0;\n\tfor(int i=0;i<=n-m;i++){\n\t\tlong long p=u-1ll*m*a-1ll*i*b;\n\t\tif(p<0) return ans;\n\t\tans=(ans+(i&1?mod-1ll:1ll)*C(n,m)%mod*C(n-m,i)%mod*C(p+n,n))%mod;\n\t}\n\treturn ans;\n}\nint solve(int n,int m,int u){\n\tint ans=C(u+n,n);\n\tfor(int i=1;i<=u;i++){\n\t\tans=(ans-f(i,i,n,m,u)+mod)%mod;\n\t\tans=(ans+f(i+1,i,n,m,u))%mod;\n\t}\n\treturn ans;\n}\nint main(){\n\tstd::ios::sync_with_stdio(false),cin.tie(nullptr);\n\tint n,m,l,r;\n\tcin>>n>>m>>l>>r;\n\tinit(n+r);\n\tcout<<(solve(n,m,r)-solve(n,m,l-1)+mod)%mod<<'\\n';\n\treturn 0;\n}\n```\n\n",
        "postTime": 1646464802,
        "uid": 55707,
        "name": "gxy001",
        "ccfLevel": 9,
        "title": "JSC2019-Qual F Candy Retribution"
    }
]
[
    {
        "content": "[\u6233\u6211\uff1d\uffe3\u03c9\uffe3\uff1d](https://blog.csdn.net/litble/article/details/83176183)\n\n\u6211\u4eec\u628a\u8fd9\u4e2a\u95ee\u9898\u5199\u6210$k$\u53c9\u6811\u7ed3\u6784\uff0c\u4e00\u5171\u6709$n+m$\u7247\u53f6\u5b50\uff0c\u5176\u4e2d$n$\u7247\u5199\u7740$0$\uff0c$m$\u7247\u5199\u7740$1$\u3002\u5bf9\u4e8e\u4e00\u4e2a\u975e\u53f6\u5b50\u8282\u70b9\uff0c\u5b83\u7684\u503c\u662f\u5b83\u513f\u5b50\u4eec\u7684\u503c\u7684\u5e73\u5747\u6570\u3002\u5219\u6839\u8282\u70b9\u7684\u6570\u5c31\u662f\u9ed1\u677f\u4e0a\u5269\u4e0b\u7684\u90a3\u4e2a\u6570\u3002\n\n\u5047\u8bbe\u90a3$n$\u4e2a$0$\u7684\u6df1\u5ea6\u5206\u522b\u662f$x_i$\uff0c$m$\u4e2a$1$\u7684\u6df1\u5ea6\u5206\u522b\u662f$y_i$\uff0c\u5219\u6839\u8282\u70b9\u7684\u6570\u5c31\u662f$\\sum_{i=1}^m (\\frac{1}{k})^{y_i}$\u3002\u5e76\u4e14\u6211\u4eec\u77e5\u9053\u5982\u679c\u6240\u6709\u53f6\u8282\u70b9\u7684\u6570\u90fd\u662f$1$\u5219\u6839\u8282\u70b9\u4e5f\u662f$1$\uff0c\u6240\u4ee5$\\sum_{i=1}^m (\\frac{1}{k})^{y_i}+\\sum_{i=1}^n (\\frac{1}{k})^{x_i}$\uff0c\u800c\u82e5\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\uff0c\u4e00\u5b9a\u4e5f\u80fd\u6784\u9020\u51fa\u5408\u6cd5\u7684$k$\u53c9\u6811\uff08\u8003\u8651$k$\u8fdb\u5236\u5c0f\u6570\u7684\u8fdb\u4f4d\uff0c\u5219\u540c\u4e00\u6df1\u5ea6\u7684\u53f6\u5b50\u8282\u70b9\u4e00\u5b9a\u8981\u6709$k$\u4e2a\u624d\u80fd\u8fdb\u4ee5\u4f4d\uff0c\u4f9d\u6b64\u6784\u9020\u5373\u53ef\uff09\n\n\u73b0\u5728\u7684\u95ee\u9898\u8f6c\u5316\u4e3a\uff0c\u6709\u591a\u5c11\u4e2a$z$\u6ee1\u8db3$z$\u53ef\u4ee5\u5199\u6210$m$\u4e2a$(\\frac{1}{k})^y$\u76f8\u52a0\u7684\u5f62\u5f0f\uff0c\u800c$1-z$\u53c8\u53ef\u4ee5\u5199\u6210$n$\u4e2a$(\\frac{1}{k})^x$\u76f8\u52a0\u7684\u5f62\u5f0f\u3002\uff08litble\u7684\u4ee3\u7801\u91cc\u6c42\u89e3\u7684\u662f\u6709\u591a\u5c11\u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684$1-z$\uff0c\u8fd9\u5f53\u7136\u4e5f\u6ca1\u95ee\u9898\uff09\n\n\u5c06$z$\u5199\u6210$k$\u8fdb\u5236\u5c0f\u6570$0.c_1c_2c_3...$\uff0c\u4e0d\u8003\u8651\u8fdb\u4f4d\uff0c\u5219$\\sum c=m$\u3002\u8003\u8651\u8fd8\u539f\u8fdb\u4f4d\uff0c\u5219\u53ef\u4ee5\u5c06$c_i$\u51cf\u53bb$1$\u800c\u5c06$c_{i+1}$\u589e\u52a0$k$\uff0c\u5219$\\sum c \\equiv m \\pmod{k-1}$\u3002\u5047\u8bbe\u5c0f\u6570\u6709$len$\u4f4d\uff0c\u5219$1-z$\u7684\u4f4d\u6570\u548c\u5e94\u8be5\u662f$(len-1)(k-1)+k-\\sum c=len(k-1)-\\sum c+1$\u3002\n\n\u8bbe$f(i,j)$\u8868\u793a\u5c0f\u6570\u70b9\u540e$i$\u4f4d\uff0c\u6bcf\u4e00\u4f4d\u7684\u548c\u662f$j$\u7684\u65b9\u6848\u6570\u8fdb\u884cDP\u5373\u53ef\u3002\u56e0\u4e3a\u5c0f\u6570\u7684\u672b\u5c3e\u4e0d\u80fd\u662f0\uff0c\u6240\u4ee5\u5f53\u7b2c$i$\u4f4d\u7684\u672b\u5c3e\u662f\u5426\u662f0\u4e5f\u5e94\u8be5\u52a0\u8fdb\u72b6\u6001\u91cc\u9762\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define RI register int\nconst int mod=1e9+7,N=2005;\nint n,m,K,ans,f[N<<1][N][2],s[N];\nint qm(int x) {return x>=mod?x-mod:x;}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&K);\n\tf[0][0][0]=1;\n\tfor(RI i=1;i<=max(n,m)*2;++i) {\n\t\ts[0]=qm(f[i-1][0][0]+f[i-1][0][1]);\n\t\tfor(RI j=1;j<=n;++j)\n\t\t\ts[j]=qm(s[j-1]+qm(f[i-1][j][0]+f[i-1][j][1]));\n\t\tfor(RI j=0;j<=n;++j) {\n\t\t\tf[i][j][0]=qm(s[j]-s[j-1]+mod);\n\t\t\tif(j) f[i][j][1]=qm(s[j-1]-(j-K>=0?s[j-K]:0)+mod);\n\t\t}\n\t\tfor(RI j=0;j<=n;++j)\n\t\t\tif(j%(K-1)==n%(K-1)&&(i*(K-1)-j+1)%(K-1)==m%(K-1)&&i*(K-1)-j+1<=m)\n\t\t\t\tans=qm(ans+f[i][j][1]);\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1539938524,
        "uid": 20604,
        "name": "litble",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 AT2294 \u3010Eternal Average\u3011"
    },
    {
        "content": "\u5728\u6211\u7684\u535a\u5ba2\u67e5\u770b\uff1a[https://www.cnblogs.com/suxxsfe/p/13904106.html](https://www.cnblogs.com/suxxsfe/p/13904106.html)  \n\n[https://atcoder.jp/contests/agc009/tasks/agc009_e](https://atcoder.jp/contests/agc009/tasks/agc009_e)  \n\n\u5c06\u6a21\u578b\u8f6c\u5316\u4e3a\u4e00\u4e2a $k$ \u53c9\u6811\uff0c\u6bcf\u4e2a\u70b9\u8981\u4e48\u662f\u53f6\u5b50\uff0c\u8981\u4e48\u6070\u597d\u6709 $k$ \u4e2a\u513f\u5b50  \n\u7136\u540e\u53f6\u5b50\u8282\u70b9\u6709 $n+m$ \u4e2a\uff0c\u6743\u503c 0 \u6216 1\uff0c\u975e\u53f6\u5b50\u8282\u70b9\u7684\u6743\u503c\u662f\u6240\u6709\u5b50\u8282\u70b9\u7684\u5e73\u5747\u503c  \n\u8fd9\u6837\u6839\u7684\u6743\u503c\u5c31\u662f\u6700\u540e\u5269\u7684\u90a3\u4e2a\u6570  \n\u8bbe\u6839\u7684\u6df1\u5ea6\u4e3a $0$\uff0c\u6743\u503c\u4e3a 1 \u7684\u70b9\u6df1\u5ea6\u5206\u522b\u662f $x_i$\uff0c\u4e3a 0 \u7684\u5206\u522b\u662f $y_i$  \n\u5219\u6743\u503c\u4e3a 0 \u7684\u6ca1\u8d21\u732e\uff0c\u6839\u8282\u70b9\u7684\u6743\u503c\u662f $\\sum k^{-x_i}$  \n\u5982\u679c $n+m$ \u4e2a\u70b9\u90fd\u662f\u6743\u503c\u4e3a $1$\uff0c\u5219\u6839\u6743\u503c\u4e5f\u662f $1$\uff0c\u90a3\u4e48\u5c31\u63a8\u51fa\u4e86 $\\sum k^{-x_i}+\\sum k^{-y_i}=1$  \n\n\u6b64\u9898\u5373\u4e3a\u6c42\u6709\u591a\u5c11\u4e2a $Z$\uff0c\u4f7f\u5f97 $Z=\\sum k^{-x_i},1-Z=\\sum k^{-y_i}$  \n\u90a3\u4e48\u8bbe $k$ \u8fdb\u5236\u5c0f\u6570 $Z=(0.z_1z_2\\ldots z_l)_k$\uff0c\u56e0\u4e3a $Z$ \u8981\u5199\u6210 $\\sum k^{-x_i}$\uff0c\u6240\u4ee5 $\\sum z_i\\le n$\uff0c\u4e5f\u5c31\u662f\u6700\u591a\u53ea\u6709 $k$ \u8fdb\u5236\u4e0b $n$ \u4e2a $1$  \n\u90a3\u4e48\u4ece $1$ \u6700\u591a\u7684\u60c5\u51b5\u5f80\u540e\u63a8\uff0c\u6bcf\u6b21\u8fdb\u4f4d\uff0c\u6240\u6709\u4f4d\u7684\u548c\u51cf\u5c0f $k-1$\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u51fa $\\sum z_i \\equiv n \\pmod{k-1}$  \n\n\u6a21\u62df\u4e00\u4e0b\u5c0f\u6570\u51cf\u6cd5\u7684\u8fc7\u7a0b\uff0c\u518d\u9488\u5bf9 $1-Z=\\sum k^{-y_i}$ \u8fd9\u4e2a\u5f0f\u5b50\uff0c\u53ef\u4ee5\u4eff\u7167\u4e0a\u9762\u7684\u8fc7\u7a0b\u63a8\u51fa $1+\\sum(k-1-z_i)\\le m$ \u548c $1+\\sum(k-1-z_i)\\equiv m \\pmod{k-1}$  \n\n\u6240\u4ee5\u5c31\u662f\u8981\u6c42\u6709\u591a\u5c11\u4e2a\u5c0f\u6570 $Z$\uff0c\u4f7f\u5f97\u6ee1\u8db3\u4e00\u4e0b\u51e0\u4e2a\u5f0f\u5b50  \n\n$$0\\le z_i<k,i\\in [1,l-1]$$  \n\n$$0<z_l<k$$  \n\n$$\\sum z_i\\le n$$  \n\n$$\\sum z_i \\equiv n \\pmod{k-1}$$  \n\n$$1+\\sum(k-1-z_i)\\le m$$  \n\n$$1+\\sum(k-1-z_i)\\equiv m \\pmod{k-1}$$  \n\n\u6240\u4ee5\u53ef\u4ee5\u6765\u4e00\u4e2a dp\uff0c\u7528 $f(i,j,0/1)$ \u8868\u793a\u8003\u8651 $l=i$\uff0c\u4e5f\u5c31\u662f $Z$ \u6709 $i$ \u4f4d\u65f6\uff0c$\\sum z_i=j$\uff0c$z_i$ \u7b49\u4e8e/\u4e0d\u7b49\u4e8e $0$ \u7684\u65b9\u6848\u6570  \n\u8f6c\u79fb\uff1a$f(i,j,0)=f(i-1,j,0)+f(i-1,j,1)$  \n$f(i,j,1)=\\sum_{x=1}^{k-1} f(i-1,j-x,0)+f(i-1,j-x,1)$  \n\n\u8bb0\u4e00\u4e2a\u524d\u7f00\u548c\u4f18\u5316\u4e00\u4e0b\u5c31\u884c\u4e86  \n\u56e0\u4e3a\u6ca1\u6709\u89c4\u5b9a $l$ \u7684\u5927\u5c0f\uff0c\u6240\u4ee5\u6bcf\u5f53\u679a\u4e3e\u5b8c\u4e00\u4e2a $i$\uff0c\u5c31\u53bb\u627e\u6240\u6709\u7b26\u5408\u4e0a\u9762\u51e0\u4e2a\u5f0f\u5b50\u8981\u6c42\u7684 $j$ \u6765\u52a0\u5230\u7b54\u6848\u91cc  \n\n\u53e6\u5916\u4e00\u4e2a\u7ec6\u8282\uff0c\u5c31\u662f $i$ \u6700\u5927\u679a\u4e3e\u5230\u591a\u5c11\uff0c\u5176\u5b9e\u901a\u8fc7\u8054\u7acb\u7b2c\u4e09\u4e2a\u548c\u7b2c\u4e94\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u53d1\u73b0\uff0c$l\\le \\dfrac{n+m-1}{k-1}$\uff0c\u8fd9\u4e5f\u5c31\u662f $i$ \u7684\u6700\u5927\u503c  \n\n\u4ee3\u7801\u5c31\u4e0d\u653e\u4e86\uff0c\u672c\u6765\u81ea\u5df1\u6ca1\u5b9e\u73b0\u51fa\u6765\u770b\u4e86\u4e00\u4e0b\u53e6\u4e00\u7bc7\uff0c\u6240\u4ee5\u548c\u4ed6\u5199\u7684\u633a\u50cf\u7684  ",
        "postTime": 1604061319,
        "uid": 164432,
        "name": "suxxsfe",
        "ccfLevel": 9,
        "title": "AGC009E Eternal Average"
    },
    {
        "content": "\u8003\u8651\u53d6\u5e73\u5747\u6570\u7684\u8fc7\u7a0b\u4f1a\u5f62\u6210\u4e00\u4e2a\u6811\u5f62\u7ed3\u6784\uff0c\u53f6\u5b50\u7ed3\u70b9\u4e3a\u521d\u59cb\u7684 $0,1$\uff0c\u6bcf\u4e2a\u975e\u53f6\u5b50\u7ed3\u70b9\u90fd\u662f $K$ \u53c9\u7684\uff0c\u8868\u793a\u5c06\u5176\u6240\u6709\u5b69\u5b50\u5408\u5e76\u4e3a\u4e00\u4e2a\u6570\u3002\u5219\u6df1\u5ea6\u4e3a $i$ \u7684 $1$ \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5373\u4e3a $\\dfrac 1{K^i}$\uff0c\u4e14\u6211\u4eec\u6ce8\u610f\u5230\u6700\u540e\u7684\u7ed3\u679c\u53ea\u548c\u6bcf\u5c42\u53f6\u5b50\u4e2d $1$ \u7684\u4e2a\u6570\u6709\u5173\uff0c\u800c\u4e0e $1$ \u5177\u4f53\u7684\u6446\u653e\u987a\u5e8f\u65e0\u5173\u3002\n\n\u8bb0 $d=\\dfrac{N+M-1}{K-1}$\uff0c\u5373\u8be5\u6811\u7684\u6df1\u5ea6\uff0c\u4e0d\u96be\u6ce8\u610f\u5230\u6240\u6709\u6570\u90fd\u53ef\u5316\u4e3a $\\dfrac{A}{K^d}$ \u7684\u5f62\u5f0f\uff08\u5176\u4e2d $A$ \u4e3a\u4e00\u4e2a\u6574\u6570\uff09\u3002\n\n\u76f4\u63a5\u679a\u4e3e\u6bcf\u4e00\u5c42\u7684 $1$ \u7684\u4e2a\u6570\u6765\u7edf\u8ba1\u4f1a\u5bfc\u81f4\u7b97\u91cd\uff0c\u56e0\u4e3a\u67d0\u4e00\u5c42\u7684 $K$ \u4e2a $1$ \u7b49\u4ef7\u4e8e\u4e0a\u4e00\u5c42\u7684 $1$ \u4e2a $1$\uff0c\u4e8e\u662f\u6211\u4eec\u8003\u8651\u679a\u4e3e\u8fdb\u884c\u4e86 $x$ \u6b21\u628a $K$ \u4e2a $1$ \u53d8\u6210\u4e86\u4e00\u4e2a $1$ \u7684\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u4f1a\u4ee4\u65b0\u7684 $d'\\gets d - x$\uff0c$M'\\gets M - x(K - 1)$\uff0c\u5e76\u4e14\u5982\u679c\u67d0\u4e00\u5c42\u6709\u5927\u4e8e\u7b49\u4e8e $K$ \u4e2a $1$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u4eec\u8c03\u6574\u987a\u5e8f\uff08\u56e0\u4e3a\u987a\u5e8f\u4e0d\u6539\u53d8\u7ed3\u679c\uff09\u540e\u201c\u5408\u5e76\u201d\u4e3a\u4e00\u4e2a $1$\uff0c\u4f7f\u5f97\u5176\u5728\u679a\u4e3e $x+1$ \u6b21\u628a $K$ \u4e2a $1$ \u53d8\u6210\u4e86\u4e00\u4e2a $1$ \u7684\u64cd\u4f5c\u65f6\u518d\u7edf\u8ba1\u3002\n\n\u4e8e\u662f\u82e5\u8981\u7edf\u8ba1\u4e0d\u91cd\u590d\uff0c\u6bcf\u4e00\u5c42\u90fd\u5fc5\u987b\u53ea\u6709\u4e0d\u8d85\u8fc7 $K - 1$ \u4e2a $1$\uff0c\u4e0d\u96be\u53d1\u73b0\u6b64\u65f6\u6700\u7ec8\u7684\u5e73\u5747\u6570 $\\dfrac A{K^d}$ \u4e2d\u7684 $A$ \u6ee1\u8db3\uff1a$\\dfrac AK$\uff08\u56e0\u4e3a\u7b2c $0$ \u5c42\u4e0d\u53ef\u80fd\u6709\u53f6\u5b50\u7ed3\u70b9\uff0c\u6240\u4ee5\u8981\u9664\u4e2a $K$\uff09\u662f\u4e00\u4e2a $d'$ \u4f4d\u7684 $K$ \u8fdb\u5236\u6570\uff0c\u4e14\u6bcf\u4f4d\u6570\u503c\u4e4b\u548c\u6070\u4e3a $M'$\uff08\u56e0\u4e3a\u6b64\u65f6 $1$ \u7684\u603b\u6570\u4e3a $M'$\uff09\uff0c\u4e0d\u96be\u9a8c\u8bc1\u8be5\u6761\u4ef6\u662f\u5145\u8981\u7684\u3002\n\n\u4e0d\u96be\u7528\u4e00\u4e2a\u6734\u7d20\u7684\u80cc\u5305 dp \u505a\u5230 $\\mathcal O(N^2)$\uff08\u5047\u8bbe $N,M,K$ \u540c\u9636\uff09\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n```cpp\nconst int N = 4000 + 5, MOD = 1e9 + 7;\n\nint n, m, K, d, f[N][N];\n\nint main() {\n    rd(n, m, K); d = (n + m - 1) / (K - 1);\n    f[0][0] = 1;\n    for(int i = 1; i <= d; ++i)\n        for(int j = 0; j < K; ++j)\n            for(int k = j; k <= i * K && k <= m; ++k)\n                f[i][k] = (f[i - 1][k - j] + f[i][k]) % MOD;\n    int ans = 0;\n    for(; m >= 1; m -= K - 1, --d)\n        ans = (ans + f[d][m]) % MOD;\n    printf(\"%d\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1647172069,
        "uid": 34238,
        "name": "zhylj",
        "ccfLevel": 9,
        "title": "AGC 009E"
    },
    {
        "content": "# AT_agc009_e #\n\n\u6539\u7248\u540e\u7684\u65b0\u6807\u53f7~~\n\n\u5047\u5982\u6211\u4eec\u4e00\u76f4 $ k $ \u4e2a\u6570\u5408\u5e76\uff0c\u5e76\u4e14\u5c06\u7ed3\u679c\u653e\u5230\u4e0b\u4e00\u8f6e\u7684\u6570\u4e2d\u5408\u5e76\u7684\u8bdd\uff0c\u6700\u540e\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u679c\uff0c\u4e0d\u540c\u7684\u5408\u5e76\u65b9\u5f0f\u4f1a\u6709\u4e0d\u540c\u7684\u6570\u3002\n\n\u8fd9\u4e2a\u5408\u5e76\u5f62\u6210\u4e86\u4e00\u4e2a $ k $ \u53c9\u6811\u7ed3\u6784\uff0c\u6bd4\u5982\u6837\u4f8b1\uff0c $ \\dfrac{3}{8} $ \u7684\u7ed3\u679c\u53ef\u4ee5\u770b\u6210\u5148 $ 0,1 $ \u5408\u5e76\uff0c\u518d\u5e76\u4e0a\u4e00\u4e2a $ 1 $ \uff0c\u6700\u540e\u5e76\u4e0a\u4e00\u4e2a $ 0 $ \u7684\u7ed3\u679c\u3002\n\n\u6240\u4ee5\u8fd9\u4e2a\u7ed3\u679c\u548c\u4e00\u4e2a $ k $ \u53c9\u6811\u5bf9\u5e94\uff0c\u6211\u4eec\u5bf9\u8fd9\u4e2a $ k $ \u53c9\u6811\u6765\u8ba1\u6570\u3002\n\n\u7531\u4e8e\u5408\u5e76\u662f\u53d6\u5e73\u5747\u503c\uff0c\u5bf9\u4e00\u4e2a\u6570\uff0c\u5982\u679c\u4ed6\u88ab\u53d6\u4e86 $ x $ \u6b21\u5e73\u5747\u503c\uff0c\u90a3\u4e48\u4ed6\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5c31\u8981\u4e58\u4e0a $ \\dfrac{1}{k^x} $\u3002\u5982\u679c\u4e00\u4e2a $ 0,1 $\u70b9\u5728\u6811\u4e0a\u7684\u6df1\u5ea6\u4e3a $ x $ \u7684\u8bdd\uff0c\u90a3\u4e48\u8bf4\u660e\u4ed6\u88ab\u53d6 $ x $ \u6b21\u5e73\u5747\u503c\u3002\n\n\u90a3\u4e48\u5047\u8bbe\u6bcf\u4e00\u4e2a\u7b2c $ i $ \u4e2a $ 1 $ \u7684\u6df1\u5ea6\u4e3a $ a_i $\uff0c\u7b2c $ i $ \u4e2a $ 0 $ \u7684\u6df1\u5ea6\u4e3a $ b_i $\u3002\u90a3\u4e48\u5bf9\u4e8e\u4e00\u5bf9 $ a,b$ \u4e00\u5b9a\u80fd\u8868\u793a\u4e00\u4e2a\u6570\u3002\u5047\u8bbe\u6700\u7ec8\u7ed3\u679c\u7684 $ k $ \u8fdb\u5236\u8868\u793a\u4e3a $ 0.c_1c_2c_3....c_t $ \u90a3\u4e48\u6700\u7ec8\u7ed3\u679c\u4e00\u5b9a\u6709\uff1a\n\n$$ \\sum\\limits_{i=m}^{n} {\\frac{1}{k^{a_i}}} \\ + \\ \\sum\\limits_{i=1}^{n} {\\frac{1}{k^{b_i}}} = 1 $$\n\n\u7531\u4e8e\u4e00\u6b21\u8fdb\u4f4d\u53ea\u4f1a\u4f7f\u5f97 $ c $ \u7684\u548c\u53d8\u5c0f\uff0c\u4e14\u6a21 $ k - 1 $ \u7684\u503c\u540c\u4f59\uff0c\u6240\u4ee5\u53c8\u6709\n\n$$ \\sum{c_i} \\equiv m  \\ (\\bmod \\ k-1) $$\n\n$$ \\sum{k-1-c_i} \\equiv n - 1 \\ (\\bmod \\ k-1) $$\n\n\u5e76\u4e14\u4ed6\u4eec\u90fd\u8981\u5c0f\u4e8e\u53f3\u8fb9\u7684\u6570\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8bbe $ dp[i][j][k] $ \u8868\u793a\u73b0\u5728\u653e\u5230\u7b2c $ i $ \u5c42\uff0c\u4f4d\u6570\u548c\u5df2\u7ecf\u4e3a $ j $\uff0c\u540c\u65f6 $ k $ \u8868\u793a\u5f53\u524d\u662f\u4e0d\u662f $ 0 $ \u7684\u65b9\u6848\u6570 \uff0c$ dp $ \u5373\u53ef\u3002\n\n\u53d1\u73b0\u5f53\u524d\u4f4d\u662f $ 0 $ \u65f6 \uff0c\u4f1a\u8ddf\u524d\u9762\u7684\u7b97\u91cd\uff0c\u53c8\u4e0d\u96be\u77e5\u9053\u80af\u5b9a\u4f1a\u6709\u4e00\u4e2a\u4f4d\u662f $ 1 $\uff0c\u6240\u4ee5\u53ea\u7edf\u8ba1\u5f53\u524d\u4e3a\u662f $ 1 $ \u7684\u60c5\u51b5\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int maxn=4005,mod=1e9+7;\nint n,m,k,t,ans;\nint dp[maxn][maxn][2];\nsigned main()\n{\n\tscanf(\"%lld%lld%lld\",&n,&m,&k);\n\tt=(n+m-1)/(k-1);\n\tdp[0][0][0]=1;\n\tfor(int i=1;i<=t;i++)\n\t\tfor(int j=0;j<=m;j++)\n\t\t{\n\t\t\tdp[i][j][0]=(dp[i-1][j][0]+dp[i-1][j][1])%mod;\n\t\t\tfor(int p=1;p<k&&p<=j;p++)\n\t\t\t\tdp[i][j][1]=((dp[i][j][1]+dp[i-1][j-p][1])%mod+dp[i-1][j-p][0])%mod;\n\t\t\tif(j%(k-1)==m%(k-1)&&(k-1)*i-j<=n-1&&((k-1)*i-j)%(k-1)==(n-1)%(k-1))\n\t\t\t\tans=(ans+dp[i][j][1])%mod;\n\t\t}\n\tprintf(\"%lld\\n\",ans);\n}\n```\n\n\n\n",
        "postTime": 1666181833,
        "uid": 343060,
        "name": "kkio",
        "ccfLevel": 7,
        "title": "AT_agc009_e\u9898\u89e3"
    },
    {
        "content": "# \u9898\u89e3\n\n\u9996\u5148\u5f88\u5bb9\u6613\u770b\u51fa\u6765\uff0c\u7b54\u6848\u4e00\u5b9a\u662f\u7ed9\u6bcf\u4e2a 1 \u548c 0 \u914d\u4e0a\u4e00\u4e2a $k^{-x}$ \u7684\u7cfb\u6570\u518d\u52a0\u8d77\u6765\uff0c\u6ee1\u8db3 $\\sum k^{-x_i}=1$\uff0c\u6c42 $Z=\\sum_{a_i=1}k^{-x_i}$ \u6709\u591a\u5c11\u79cd\u53d6\u503c\u3002\n\n\u663e\u7136\u9700\u8981\u4f9d\u6b21\u8003\u8651 $k$ \u8fdb\u5236\u4e0b $Z$ \u7684\u6bcf\u4e2a\u5c0f\u6570\u4f4d\u7684\u53d6\u503c\u3002\u8bbe $Z=0.z_1z_2...z_p,z_p>0$\uff0c\u5047\u8bbe $\\sum_{a_i=1}k^{-x_i}$ \u4ece\u4f4e\u4f4d\u5230\u9ad8\u4f4d\u6c42\u548c\u7684\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u8fdb\u4f4d\uff0c\u90a3\u4e48\u80af\u5b9a\u6ee1\u8db3 $\\sum z_i=n$\uff0c\u82e5\u8003\u8651\u8fdb\u4f4d\uff0c\u90a3\u4e48\u6ee1\u8db3 $\\sum z_i\\le n$\u3002\u4f46\u662f $\\sum z_i$ \u6216\u8005\u8bf4\u6bcf\u4e00\u4e2a $z_i$ \u5177\u4f53\u7684\u9650\u5236\u7a76\u7adf\u662f\u4ec0\u4e48\uff1f\u5982\u679c\u4f60\u50cf\u50bb*\u6211\u4e00\u6837\u5230\u4e86\u8fd9\u91cc\u5c31\u4e0d\u7ee7\u7eed\u63a8\u5bfc\u800c\u60f3\u7740\u4f18\u5316\u66b4\u529bDP\u7684\u8bdd\uff0c\u90a3\u4e48\u4f60\u6700\u7ec8\u4f1a\u5728\u53d1\u73b0\u81ea\u5df1\u7684\u56db\u6b21\u65b9\u4e94\u6b21\u65b9DP\u600e\u4e48\u90fd\u4f1a\u628a\u65b9\u6848\u7b97\u91cd\u7684\u65f6\u5019\u5d29\u6e83\u6389\u3002\n\n\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u5f88\u8f7b\u6613\u5730\u53d1\u73b0\uff0c\u5f53\u4ea7\u751f\u8fdb\u4f4d\u7684\u65f6\u5019\uff0c\u4f4e\u4f4d\u5904\u51cf\u5c11 $x*k$ \uff0c\u9ad8\u4f4d\u5904\u4f1a\u589e\u52a0 $x$\uff0c\u6b64\u65f6 $\\sum z_i$ \u521a\u597d\u51cf\u5c11 $k-1$ \u7684\u6574\u6570\u500d\uff0c\u4e5f\u5c31\u662f\u8bf4 $\\sum z_i$ \u4ecd\u6ee1\u8db3 $\\sum z_i=n(\\bmod k-1)$\u3002\u5f52\u7eb3\u9a8c\u8bc1\u53d1\u73b0\uff0c$\\sum z_i\\le n$ \u548c $\\sum z_i=n(\\bmod k-1)$ \u8fd9\u4e24\u6761\u9650\u5236\u5df2\u7ecf\u8db3\u591f\u3002\n\n\u8fd8\u5269\u4e0b $\\sum k^{-x_i}=1$ \u8fd9\u4e2a\u6761\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5b83\u5176\u5b9e\u7b49\u4ef7\u4e8e $\\sum_{a_i=0}k^{-x_i}=1-Z$\uff0c\u6211\u4eec\u628a $1-Z=0.(k-1-z_1)(k-1-z_2)...(k-1-z_{p-1})(k-z_p)$ \u5957\u7528\u4e0a\u9762\u7684\u63a8\u5bfc\u5373\u53ef\u5f97\u51fa $1+(k-1)p-\\sum z_i\\le m$ \u548c $1+(k-1)p-\\sum z_i=m(\\bmod k-1)$ \u7684\u9650\u5236\u3002\n\n\u7136\u540eDP\u7684\u8f6c\u79fb\u5c31\u5f88\u660e\u663e\u4e86\uff0c\u53ea\u9700\u8981\u8bbe $dp[i][j][0/1]$ \u8868\u793a\u8003\u8651\u5230\u5c0f\u6570\u70b9\u540e\u7b2c $i$ \u4f4d\uff0c$\\sum_{x=1}^i z_x=j$ \u4e14 $z_i$ \u7b49\u4e8e/\u5927\u4e8e 0 \u65f6\u7684\u53d6\u503c\u4e2a\u6570\uff0c\u8f6c\u79fb\u65b9\u7a0b\u4e3a\n\n$$\ndp[i][j][0]=dp[i-1][j][0]+dp[i-1][j][1]\n$$\n$$\ndp[i][j][1]=\\sum_{x=1}^{k-1}(\\,dp[i-1][j-x][0]+dp[i-1][j-x][1]\\,)\n$$\n\n\u7b97\u7b54\u6848\u53ea\u9700\u8981\u7edf\u8ba1\u6240\u6709 $j$ \u6ee1\u8db3\u6761\u4ef6\u7684 $dp[i][j][1]$ \u7684\u548c\u5373\u53ef\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002**\u4e0d\u9700\u8981\u524d\u7f00\u548c\u4f18\u5316**\uff0c\u56e0\u4e3a\u7b2c\u4e00\u7ef4\u4e0d\u8d85\u8fc7\u603b\u64cd\u4f5c\u6570\uff0c\u6545\u76f4\u63a5\u8f6c\u79fb\u590d\u6742\u5ea6\u662f $O(\\frac{n+m-1}{k-1}kn)=O(n^2)$\u3002\n\n# \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>//JZM yyds!!\n#define ll long long\n#define uns unsigned\n#define IF (it->first)\n#define IS (it->second)\n#define END putchar('\\n')\nusing namespace std;\nconst int MAXN=4005;\nconst ll INF=1e18;\ninline ll read(){\n\tll x=0;bool f=1;char s=getchar();\n\twhile((s<'0'||s>'9')&&s>0){if(s=='-')f^=1;s=getchar();}\n\twhile(s>='0'&&s<='9')x=(x<<1)+(x<<3)+(s^48),s=getchar();\n\treturn f?x:-x;\n}\nint ptf[50],lpt;\ninline void print(ll x,char c='\\n'){\n\tif(x<0)putchar('-'),x=-x;\n\tptf[lpt=1]=x%10;\n\twhile(x>9)x/=10,ptf[++lpt]=x%10;\n\twhile(lpt)putchar(ptf[lpt--]^48);\n\tif(c>0)putchar(c);\n}\ninline ll lowbit(ll x){return x&-x;}\n\nconst ll MOD=1e9+7;\nint n,m,k,p;\nll dp[MAXN][MAXN][2],ans;\ninline void ad(ll&a,ll b){a+=b;if(a>=MOD)a-=MOD;}\nsigned main()\n{\n\tn=read(),m=read(),k=read(),p=(n+m-1)/(k-1);\n\tdp[0][0][0]=1;\n\tfor(int i=1;i<=p;i++){\n\t\tfor(int j=0;j<=n;j++){\n\t\t\tdp[i][j][0]=(dp[i-1][j][0]+dp[i-1][j][1])%MOD;\n\t\t\tfor(int x=1;x<k&&x<=j;x++)\n\t\t\t\tad(dp[i][j][1],dp[i-1][j-x][1]),\n\t\t\t\tad(dp[i][j][1],dp[i-1][j-x][0]);\n\t\t}\n\t\tfor(int j=0;j<=n;j++)\n\t\t\tif(j%(k-1)==n%(k-1)&&((k-1)*i+1-j)<=m&&((k-1)*i+1-j)%(k-1)==m%(k-1))\n\t\t\t\tad(ans,dp[i][j][1]);\n\t}\n\tprint(ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1644716822,
        "uid": 404407,
        "name": "OUYE2020",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 AT2294\u3010Eternal Average\u3011"
    },
    {
        "content": "\u9996\u5148\u8003\u8651\u5c06\u8fd9\u4e2a\u8fc7\u7a0b\u770b\u505a\u662f\u4e00\u68f5\u6ee1 $k$ \u53c9\u6811\uff0c\u5176\u4e2d\u6709 $n + m$ \u4e2a\u53f6\u5b50\uff0c$n$ \u4e2a\u53f6\u5b50\u4e3a $0$\uff0c$m$ \u4e2a\u53f6\u5b50\u4e3a $1$\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u5982\u679c\u4e00\u4e2a $1$ \u7684\u6df1\u5ea6\u4e3a $x$\uff0c\u90a3\u4e48\u5b83\u5bf9\u6700\u540e\u7684\u6570\u9020\u6210\u7684\u8d21\u732e\u4e3a $\\frac{1}{k^x}$\u3002\n\n\u90a3\u4e48\u5047\u5982\u6211\u4eec\u8003\u8651 $0, 1$ \u7684\u6df1\u5ea6\u5e8f\u5217 $\\{x_i\\}, \\{y_i\\}$\uff0c\u8003\u8651\u4ec0\u4e48\u6837\u7684\u5e8f\u5217\u80fd\u591f\u5bf9\u5e94\u5230\u4e00\u9897\u6811\u4e0a\u3002\u53d1\u73b0\u5b9e\u9645\u4e0a\u5c31\u662f\u5982\u679c\u628a $0, 1$ \u90fd\u7b97\u4e0a\u8d21\u732e\uff0c\u6700\u540e\u548c\u4e3a $1$\u3002\u5373\uff1a$\\sum \\frac{1}{k^{x_i}} + \\sum \\frac{1}{k^{y_i}} = 1$\u3002\u8bc1\u660e\u8003\u8651\u6bcf\u6b21\u5c06\u6b21\u6570\u6700\u5927\u7684 $k$ \u4e2a\u6570\u8fdb\u884c\u5408\u5e76\uff0c\u5982\u679c\u4e0d\u80fd\u5408\u5e76\u663e\u7136\u4e0d\u53ef\u80fd\u7b49\u4e8e $1$\uff0c\u4e8e\u662f\u4e00\u5b9a\u53ef\u4ee5\u901a\u8fc7\u8fd9\u6837\u7684\u5408\u5e76\u65b9\u5f0f\u5f97\u5230\u4e00\u68f5\u5408\u6cd5\u7684\u6811\u3002\n\n\u90a3\u4e48\u6211\u4eec\u76f8\u5f53\u4e8e\u8981\u7edf\u8ba1\u6ee1\u8db3\u4e0a\u8ff0\u7684 $\\{x_i\\}, \\{y_i\\}$ \u5e8f\u5217\u4e2d\uff0c\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684 $\\sum \\frac{1}{k^{x_i}}$\u3002\u8003\u8651\u5c06\u540e\u9762\u8fd9\u4e2a\u6570\u5199\u6210 $k$ \u8fdb\u5236\u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u95ee\u9898\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u5e8f\u5217 $\\{z_i\\}$\uff0c\u80fd\u5426\u5c06 $\\sum z_i k^i$ \u8868\u793a\u6210 $\\sum k^{x_i}$\u3002\u53ef\u4ee5\u901a\u8fc7\u4ece\u9ad8\u5230\u4f4e\u4f4d\u4f9d\u6b21\u6ee1\u8db3\u7684\u65b9\u5f0f\u6784\u9020\u51fa\u4e00\u79cd\u65b9\u6848\uff0c\u7531\u4e8e\u6bcf\u6b21\u5f80\u4e0b\u653e\u4e00\u4f4d\u9020\u6210\u7684\u5dee\u503c\u4e3a $k-1$\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u6ee1\u8db3 $\\sum z_i \\equiv n \\pmod {k-1}$ \u5373\u53ef\u4fdd\u8bc1\u8fd9\u4e2a\u6570\u4e00\u5b9a\u53ef\u4ee5\u88ab\u6784\u9020\u51fa\u6765\u3002\n\n\u6211\u4eec\u5047\u8bbe\u6700\u7ec8\u7684\u6570\u4e3a $p$\uff0c\u90a3\u4e48\u6211\u4eec\u4e00\u5f00\u59cb\u5f97\u51fa\u7684\u6761\u4ef6\u5b9e\u9645\u4e0a\u662f\u8981\u6c42\uff1a\n\n- $p$ \u80fd\u591f\u88ab\u8868\u793a\u6210 $n$ \u4e2a $\\frac{1}{k^ {x_i}}$ \u7684\u52a0\u548c\uff1b\n- $1 - p$ \u80fd\u591f\u88ab\u8868\u793a\u6210 $m$ \u4e2a $\\frac{1}{k^ {y_i}}$ \u7684\u52a0\u548c\uff1b\n\n\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u5c31\u53ef\u4ee5\u5c06\u9898\u610f\u8f6c\u6362\u6210\u7edf\u8ba1\u6709\u591a\u5c11\u5408\u6cd5\u7684\u957f\u4e3a $l$ \u7684 $\\{z_i\\}$ \u5e8f\u5217\uff0c\u6ee1\u8db3\uff1a\n\n- $0 \\le z_i < k$\uff1b\n- $z_l \\ne 0$\uff1b\n- $\\sum z_i \\le n, \\sum z_i \\equiv n \\pmod {k-1}$\uff1b\n- $1 + \\sum (k - z_i + 1) \\le m, 1 + \\sum (k - z_i + 1) \\equiv m \\pmod {k-1}$\uff1b\n\n\u8fd9\u4e2a\u5bb9\u6613 DP \u5f97\u51fa\u7b54\u6848\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 4005, P = 1000000007;\nint n, m, k;\nint f[MAXN][MAXN];\nint main() {\n    scanf(\"%d%d%d\", &n, &m, &k);\n    int ans = 0;\n    for (int i = 0; i <= n; i++)\n        f[0][i] = 1;\n    for (int i = 1; i <= n + m; i++) {\n        for (int j = max(0, (k - 1) * i - m + 1); j <= n; j++) {\n            f[i][j] = (f[i - 1][j] - f[i - 1][max(0, j - (k - 1)) - 1] + P) % P;\n            if ((j - n) % (k - 1) == 0)\n                ans = (1ll * ans + \n                    f[i - 1][j - 1] - f[i - 1][max(0, j - (k - 1)) - 1] + P) % P;\n            f[i][j] = (f[i][j] + f[i][j - 1]) % P;\n        }\n    }\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```",
        "postTime": 1684843532,
        "uid": 279652,
        "name": "APJifengc",
        "ccfLevel": 9,
        "title": "\u300c\u89e3\u9898\u62a5\u544a\u300dAGC009E Eternal Average"
    },
    {
        "content": "> - \u9ed1\u677f\u4e0a\u6709 $n$ \u4e2a $0$ \u548c $m$ \u4e2a $1$\uff0c\u6bcf\u6b21\u64cd\u4f5c\u64e6\u6389\u5176\u4e2d $k$ \u4e2a\u6570\uff0c\u7136\u540e\u5199\u4e0a\u5b83\u4eec\u7684\u5e73\u5747\u6570\uff0c\u76f4\u5230\u9ed1\u677f\u4e0a\u53ea\u5269\u4e0b\u4e00\u4e2a\u6570\u3002\n> - \u6c42\u6700\u540e\u8fd9\u4e2a\u6570\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u53ef\u80fd\uff0c\u7b54\u6848\u5bf9 $10^9 + 7$ \u53d6\u6a21\u3002\n> - $1 \\leq n,m \\leq 1000$\uff0c$2 \\leq k \\leq 2000$\uff0c\u4fdd\u8bc1\u6700\u540e\u53ea\u5269\u4e0b\u4e00\u4e2a\u6570\u3002\n\n\u4e0b\u6587\u8ba4\u4e3a $n,m$ \u540c\u9636\u3002\n\n\u628a\u64e6\u9664\u7684\u8fc7\u7a0b\u8868\u793a\u6210 $k$ \u53c9\u6811\u7684\u7ed3\u6784\uff08\u7c7b\u4f3c\u4e8e Kruskal \u91cd\u6784\u6811\uff09\uff0c\u90a3\u4e48\u5171\u6709 $n + m$ \u4e2a\u53f6\u5b50\uff0c\u5176\u4e2d $n$ \u4e2a\u53f6\u5b50\u6743\u503c\u4e3a $0$\uff0c$m$ \u4e2a\u53f6\u5b50\u6743\u503c\u4e3a $1$\u3002\u5bf9\u4e8e\u4e00\u4e2a\u975e\u53f6\u8282\u70b9\uff0c\u5176\u6743\u503c\u4e3a $k$ \u4e2a\u513f\u5b50\u6743\u503c\u7684\u5e73\u5747\u503c\uff0c\u5219\u6839\u8282\u70b9\u7684\u6743\u503c\u5c31\u662f\u5269\u4e0b\u7684\u90a3\u4e2a\u6570\u3002\n\n\u8003\u8651\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u5bf9\u6839\u8282\u70b9\u6743\u503c\u7684\u8d21\u732e\uff1a\u8bbe\u7b2c $i$ \u4e2a\u6743\u503c\u4e3a $1$ \u7684\u53f6\u5b50\u6df1\u5ea6\u4e3a $x_i$\uff0c\u7b2c $i$ \u4e2a\u6743\u503c\u4e3a $0$ \u7684\u53f6\u5b50\u6df1\u5ea6\u4e3a $y_i$\uff0c\u90a3\u4e48\u6839\u8282\u70b9\u7684\u6743\u503c\u4e3a $\\sum_{i = 1}^m (\\frac{1}{k}) ^ {y_i}$\u3002\u5e76\u4e14\u663e\u7136\u5f53\u6240\u6709\u53f6\u5b50\u7684\u6743\u503c\u5747\u4e3a $1$ \u65f6\u6839\u8282\u70b9\u7684\u6743\u503c\u4e5f\u4e3a $1$\uff0c\u56e0\u6b64\u8fd8\u9700\u6ee1\u8db3\u6761\u4ef6\uff1a\n\n$$ \\sum_{i= 1}^n (\\frac{1}{k})^{x_i} + \\sum_{i = 1}^m (\\frac{1}{k})^{y_i} = 1$$\n\n\u5fc5\u8981\u6027\u4e5f\u662f\u663e\u7136\u7684\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e00\u7ec4\u5408\u6cd5\u7684 $x_i,y_i$ \u6211\u4eec\u90fd\u53ef\u4ee5\u6839\u636e $k$ \u8fdb\u5236\u5c0f\u6570\u7684\u8fdb\u4f4d\u6784\u9020\u51fa\u4e00\u68f5\u5408\u6cd5\u7684 $k$ \u53c9\u6811\u3002\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u6709\u591a\u5c11\u4e2a $z$ \u6ee1\u8db3 $z$ \u53ef\u4ee5\u5199\u6210 $\\sum_{i = 1}^m (\\frac{1}{k}) ^ {y_i}$ \u7684\u5f62\u5f0f\uff0c\u4e14 $1-z$ \u53ef\u4ee5\u5199\u6210 $\\sum_{i = 1}^n (\\frac{1}{k}) ^ {x_i}$ \u7684\u5f62\u5f0f\u3002\n\n\u5c06 $z$ \u5199\u6210 $k$ \u8fdb\u5236\u5c0f\u6570 $0.c_1c_2\\cdots c_p$\uff0c\u5728\u4e0d\u8003\u8651\u8fdb\u4f4d\u7684\u60c5\u51b5\u4e0b\uff0c$c_i$ \u8868\u793a\u6df1\u5ea6\u4e3a $i$ \u7684\u6743\u503c\u4e3a $1$ \u4e2a\u53f6\u5b50\u7684\u4e2a\u6570\u3002\u56e0\u6b64\u663e\u7136\u6709\uff1a\n\n$$ \\sum_{i = 1}^p c_i = m $$\n\n\u800c\u5bf9\u4e8e\u4e00\u6b21\u8fdb\u4f4d\u64cd\u4f5c\uff0c\u5176\u76f8\u5f53\u4e8e\u5c06 $c_{i}$ \u7684\u503c\u51cf\u53bb $k$\uff0c\u7136\u540e\u5c06 $c_{i-1}$ \u7684\u503c\u52a0 $1$\u3002\u8fd9\u76f8\u5f53\u4e8e\u5c06 $\\sum c$ \u7684\u503c\u51cf\u53bb $k-1$\u3002\u7531\u6b64\u53ef\u77e5\uff1a\n\n$$ \\sum_{i = 1}^p c_i \\equiv m (\\mathrm{mod} \\ k-1)$$\n\n\u5c06 $1-z$ \u4e5f\u5199\u6210 $k$ \u8fdb\u5236\u5c0f\u6570 $0.d_1d_2 \\cdots d_p$\uff0c\u5bb9\u6613\u5f97\u5230\u5176\u5404\u4f4d\u6570\u4e4b\u548c\uff1a\n\n$$ \\sum_{i = 1} ^p d_i = p \\times(k -1) - \\sum_{i = 1} ^ p c_i + 1$$\n\n\u5e76\u4e14\u540c\u7406\u6211\u4eec\u6709\uff1a\n\n$$ \\sum_{i = 1}^p d_i \\equiv n (\\mathrm{mod} \\ k-1)$$\n\n\u636e\u6b64\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1 dp\uff1a\u8bbe $f_{i,j,0/1}$ \u8868\u793a\u5f53\u524d\u5728\u5c0f\u6570\u70b9\u540e\u7b2c $i$ \u4f4d\uff0c\u4f4d\u6570\u548c\u4e3a $j$\uff0c\u6700\u540e\u4e00\u4f4d\u662f/\u4e0d\u662f $0$ \u7684\u65b9\u6848\u6570\u3002\u8f6c\u79fb\u65f6\u8003\u8651\u5f53\u524d\u4f4d\u653e\u4ec0\u4e48\u6570\u5373\u53ef\uff0c\u5bb9\u6613\u53d1\u73b0\u8fd9\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u4f18\u5316\uff0c\u6700\u7ec8\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n```cpp\nint N, M, K, Ans, f[2][MN][2], s[MN];\n\nsigned main(void) {\n    N = read(), M = read(), K = read();\n    int o = 0;\n    f[o][0][0] = 1;\n    for (int i = 1; i <= max(N, M) * 2; i++) {\n        o ^= 1;\n        s[0] = (f[o ^ 1][0][0] + f[o ^ 1][0][1]) % Mod;\n        for (int j = 1; j <= N; j++) {\n            s[j] = (s[j - 1] + f[o ^ 1][j][0] + f[o ^ 1][j][1]) % Mod;\n        }\n        for (int j = 0; j <= N; j++) {\n            f[o][j][0] = (s[j] - s[j - 1] + Mod) % Mod;\n            if (j) f[o][j][1] = (s[j - 1] - (j >= K ? s[j - K] : 0) + Mod) % Mod; \n        }\n        for (int j = 0; j <= N; j++) {\n            if (j % (K - 1) == N % (K - 1) && (i * (K - 1) - j + 1) % (K - 1) == M % (K - 1) && i * (K - 1) - j + 1 <= M) {\n                Ans = (Ans + f[o][j][1]) % Mod;\n            }\n        }\n    }\n    printf(\"%lld\\n\", Ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1631440822,
        "uid": 246019,
        "name": "_came11ia_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT2294\u3010[AGC009E] Eternal Average\u3011"
    },
    {
        "content": "\u8bbe\u64cd\u4f5c\u6b21\u6570\u4e3a $d=\\frac{n+m-1}{k-1}$\u3002\n\n\u628a\u521d\u59cb\u7684 $n+m$ \u4e2a\u6570\u89c6\u4e3a $n+m$ \u4e2a\u70b9\uff0c\u6bcf\u6b21\u64cd\u4f5c $k$ \u4e2a\u6570\u5c31\u65b0\u5efa\u4e00\u4e2a\u70b9\u4f5c\u4e3a\u8fd9 $k$ \u4e2a\u6570\u5bf9\u5e94\u7684\u70b9\u7684\u7236\u4eb2\u3002\u8fd9\u6837\u53ef\u4ee5\u5c06\u64cd\u4f5c\u5bf9\u5e94\u4e3a\u4e00\u68f5 $n+m+d$ \u4e2a\u8282\u70b9\u7684 $k$ \u53c9\u6811\u3002\n\n\u8bbe\u6bcf\u4e2a\u70b9\u7684\u6743\u503c\u4e3a\u5176\u513f\u5b50\u6743\u503c\u7684\u5e73\u5747\u503c\uff0c\u5219\u6700\u540e\u7559\u4e0b\u7684\u6570 $s$ \u5373\u6839\u8282\u70b9\u7684\u6743\u503c\u3002\n\n\u4e5f\u5373\uff0c\u8bbe\u521d\u59cb\u7684 $m$ \u4e2a $1$ \u6240\u5bf9\u5e94\u7684\u7f16\u53f7\u4e3a $x_1,x_2,\\cdots,x_m$\uff0c\u5219 $s=\\sum_{i=1}^m k^{-dep_{x_i}}$\u3002\n\n\u6ce8\u610f\u5230\uff0c\u8bbe\u521d\u59cb\u7684 $n$ \u4e2a $0$ \u6240\u5bf9\u5e94\u7684\u7f16\u53f7\u4e3a $y_1,y_2,\\cdots,y_n$\uff0c\u5219\u6709\uff1a\n\n$$\\sum\\limits_{i=1}^m k^{-dep_{x_i}}+\\sum\\limits_{i=1}^n k^{-dep_{y_i}}=1$$\n\n\u8003\u8651\u5982\u4f55\u5224\u5b9a\u4e00\u4e2a $s$ \u662f\u5426\u53ef\u88ab\u6784\u9020\u51fa\u6765\uff1a\n\n> \u7ed3\u8bba\uff1a$s$ \u53ef\u88ab\u6784\u9020\u51fa\u6765\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728 $x_1,x_2,\\cdots,x_m$ \u6ee1\u8db3 $\\sum_{i=1}^m k^{-dep_{x_i}}=s$ \u4e14\u5b58\u5728 $y_1,y_2,\\cdots,y_n$ \u6ee1\u8db3 $\\sum_{i=1}^n k^{-dep_{y_i}}=1-s$\u3002\n\n> \u8bc1\u660e\uff1a\u5fc5\u8981\u6027\u663e\u7136\u3002\u5145\u5206\u6027\uff1a\u8bbe $z_t$ \u8868\u793a\u4e3a $t$ \u7684 $x_i,y_i$ \u4e2a\u6570\uff0c\u53ea\u9700\u8bc1\u53ef\u4ee5\u6784\u9020\u4e00\u68f5\u6811\u4f7f\u5f97\u6df1\u5ea6\u4e3a $i$ \u7684\u53f6\u5b50\u8282\u70b9\u6070\u6709 $z_i$ \u4e2a\u3002\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u7b97\u6cd5\uff1a\n\n+ \u7531 $d$ \u81f3 $1$ \u679a\u4e3e $p$\uff0c\u7531\u4e8e $\\sum_{t=1}^p z_t k^{-t}=1$\uff0c\u6545 $k \\mid z_p$\u3002\u90a3\u4e48\u5bf9\u8fd9 $z_p$ \u4e2a\u70b9\u5efa\u7acb $\\frac{z_p}{k}$ \u4e2a\u7236\u4eb2\u8282\u70b9\uff0c$z_{p-1} \\leftarrow z_{p-1}+\\frac{z_p}{k},z_p \\leftarrow 0$\u3002\n\n> \u5373\u53ef\u5f97\u5230\u4e00\u68f5\u6ee1\u8db3\u6761\u4ef6\u7684\u6811\u3002\u8bc1\u6bd5\u3002\n\n\u4e0b\u9762\u8003\u8651\u8ba1\u6570\u3002\u8003\u8651\u5c06 $s,1-s$ \u770b\u4f5c $k$ \u8fdb\u5236\u5c0f\u6570\uff0c\u8bbe $s=\\sum_{i=1}^d a_i k^{-i},1-s=\\sum_{i=1}^d b_i k^{-i}$\uff0c\u5176\u4e2d $a_i,b_i \\in [0,k)$\u3002\u90a3\u4e48\u9700\u8981\u6ee1\u8db3\uff1a\n\n+ $\\sum_{i=1}^d a_i=m-t_1 (k-1),t_1 \\in \\N$\u3002\n\n+ $\\sum_{i=1}^d b_i=n-t_2 (k-1),t_2 \\in \\N$\u3002\n\n\u8fd9\u662f\u56e0\u4e3a\u6bcf\u4e00\u6b21\u8fdb\u4f4d\u90fd\u4f1a\u4f7f\u6570\u4f4d\u548c\u51cf\u5c11 $(k-1)$\u3002\n\n\uff0c\u5219 $\\{b_i\\}$ \u5373\u4ee4\u6240\u6709 $a_i \\leftarrow k-1-a_i$\uff0c\u518d\u4ee4 $a_d \\leftarrow a_d+1$ \u540e\u8fdb\u4f4d\u83b7\u5f97\u7684\u7ed3\u679c\uff0c\u8bbe\u8fdb\u4f4d\u6b21\u6570\u4e3a $t_3$\uff0c\u5219\uff1a\n\n$$\\sum_{i=1}^d b_i=d (k-1)+1-\\sum_{i=1}^d a_i-t_3 (k-1)$$\n\n$$n-t_2 (k-1)=(n+m)-m+t_1 (k-1)-t_3 (k-1)$$\n\n$$t_2 (k-1)=(t_3-t_1) (k-1)$$\n\n$$t_2 \\geq 0 \\Leftrightarrow t_3 \\geq t_1$$\n\n\u6545\u679a\u4e3e $t_1 \\leq t_3$\uff0c\u7edf\u8ba1\u7b54\u6848\u3002\n\n\u8bb0 $A$ \u4e2a $[0,k)$ \u4e2d\u7684\u6574\u6570\u7ec4\u6210\u7684\u548c\u4e3a $B$ \u7684\u6570\u5217\u6570\u91cf\u4e3a $S(A,B)$\uff0c\u53ef\u4ee5\u7528\u5bb9\u65a5\u8ba1\u7b97\uff1a\n\n$$S(A,B)=\\sum\\limits_{i=0}^A (-1)^i \\dbinom{A}{i} \\dbinom{B-ik+A-1}{A-1}$$\n\n\u7b54\u6848\u4e3a\uff1a\n\n$$Ans=\\sum\\limits_{t_3=0}^{d-1} \\sum\\limits_{t_1=0}^{t_3} [S(d-t_3,m-t_1(k-1))-S(d-t_3-1,m-t_1(k-1))]$$\n\n\u76f4\u63a5\u66b4\u529b\u8ba1\u7b97\u65f6\u95f4\u590d\u6742\u5ea6 $O(d^2\\frac{m}{k})=O(\\frac{m(n+m)^2}{k^3})$\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u6ce8\u610f\u5230 $A$ \u4e0d\u8d85\u8fc7 $d-1$\uff0c$B$ \u4e0d\u8d85\u8fc7 $m$\u3002\u679a\u4e3e\u6700\u540e\u4e00\u4e2a\u6570\u662f\u4ec0\u4e48\uff0c\u7528\u4e0b\u5f0f\u9012\u63a8\uff1a\n\n$$S(A,B)=\\sum\\limits_{i=0}^{k-1} S(A-1,B-i)$$\n\n\u4e8e\u662f\u65f6\u95f4\u590d\u6742\u5ea6 $O(d\\frac{m}{k}+dmk)=O(m(n+m))$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\uff08\u53ef\u80fd\u8fd8\u6709\u66f4\u4f18\u7684\u505a\u6cd5\uff1f\uff09\n\n#### Code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=4400,mod=1e9+7;\nint n,m,k,d,ans;\nint f[N][N];\n\nint main(){\n\tcin>>n>>m>>k;\n\td=(n+m-1)/(k-1);\n\t\n\tf[0][0]=1;\n\tfor(int i=1;i<=d;i++)\n\t\tfor(int j=0;j<=m;j++)\n\t\t\tfor(int t=0;t<k && t<=j;t++)\n\t\t\t\tf[i][j]=(f[i][j]+f[i-1][j-t])%mod;\n\t\n\tfor(int t2=0;t2<d;t2++)\n\t\tfor(int t1=0;t1<=t2 && t1<=m/(k-1);t1++)\n\t\t\tans=(ans+(f[d-t2][m-t1*(k-1)]+mod-f[d-t2-1][m-t1*(k-1)])%mod)%mod;\n\tcout<<ans;\n}\n```",
        "postTime": 1670052546,
        "uid": 225645,
        "name": "\u82f9\u679c\u84dd17",
        "ccfLevel": 8,
        "title": "AT_agc009_e [AGC009E] Eternal Average \u9898\u89e3"
    }
]
[
    {
        "content": "~~\u611f\u8c22 Daniel_lele \u5728\u6211\u6253 florr \u7684\u65f6\u5019\u628a\u6211\u62d6\u8fc7\u6765\u505a\u9898~~\n\n\u9996\u5148\u8bbe $dp_{i,j}$ \u4e3a\u7528\u4e86 $i$ \u4e2a\u70b9 $j$ \u6761\u8fb9\u7ec4\u6210\u7684\u56fe\u7684\u4e2a\u6570\u3002\u4e3a\u4e86\u9632\u6b62\u7b97\u91cd\uff0c\u94a6\u5b9a\u6bcf\u4e2a\u8fde\u901a\u5757\u7684\u7b2c\u4e00\u4e2a\u70b9\u4e3a\u5f53\u524d\u6ca1\u88ab\u9009\u7684\u7b2c\u4e00\u4e2a\u70b9\uff0c\u5219\u9009\u70b9\u7684\u65b9\u6848\u5c31\u662f\u5728\u5269\u4e0b\u7684\u70b9\u4e2d\u9009\u70b9\u3002\u90a3\u4e48\u8f6c\u79fb\u65b9\u7a0b\u5c31\u5927\u6982\u662f\u8fd9\u6837\u7684\uff1a\n\n$$dp_{i,j}=\\sum^l_{k=1}\\binom{n-i+k-1}{k-1}\\times\\text{\u4e0d\u6e05\u695a}\\times dp_{i-k,j-\\text{\u4e0d\u77e5\u9053}}$$\n\n\u63a5\u4e0b\u6765\u7ed3\u5408\u9898\u76ee\u4e2d\u7ed9\u7684\u6761\u4ef6\u3002\u7531\u6240\u6709\u70b9\u5ea6\u6570\u4e0d\u8d85\u8fc7 $2$ \u53ef\u5f97\uff0c\u6bcf\u4e2a\u8fde\u901a\u5757\u53ea\u6709\u73af\u548c\u94fe\u4e24\u79cd\u60c5\u51b5\u3002\u8bbe $f(n),g(n)$ \u5206\u522b\u4e3a $n$ \u4e2a\u70b9\u7ec4\u6210\u94fe\u4e0e\u73af\u7684\u65b9\u6848\u6570\uff0c\u53ef\u5f97\uff1a\n\n$$\nf(n)=\\left\\{\n\\begin{matrix}\n1,&n=1\\\\\n\\dfrac{n!}2,&n>1\n\\end{matrix}\n\\right.,g(n)=\\left\\{\n\\begin{matrix}\n1,&n=2\\\\\n\\dfrac{(n-1)!}2,&n>2\n\\end{matrix}\n\\right.\n$$\n\n\u63a8\u5bfc\u8fc7\u7a0b\u7b80\u5355\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\u90a3\u4e48\u6700\u7ec8\u8f6c\u79fb\u5f0f\u4e3a\uff1a\n\n$$\n\\begin{aligned}\ndp_{i,j}=&\\sum^l_{k=1}\\binom{n-i+k-1}{k-1}f(n)dp_{i-k,j-k+1}\\\\\n+&\\sum^l_{k=2}\\binom{n-i+k-1}{k-1}g(n)dp_{i-k,j-k}\n\\end{aligned}\n$$\n\n~~\u5199\u5b8c\u8fd9\u4e00\u5927\u5768\u5c31\u4f1a\u53d1\u73b0\u6837\u4f8b\u90fd\u8fc7\u4e0d\u53bb~~\n\n\u4e3a\u5565\u5462\uff1f\u56e0\u4e3a\u6211\u4eec\u53ea\u80fd\u4fdd\u8bc1\u6700\u5927\u7684\u8fde\u901a\u5757\u70b9\u6570 **\u4e0d\u8d85\u8fc7** $l$\uff0c\u6240\u4ee5\u4f1a\u591a\u7b97\u70b9\u6570 $<l$ \u7684\u7b54\u6848\u3002\u7edf\u8ba1\u4e00\u904d $l-1$ \u7684\u7b54\u6848\u4ece\u91cc\u9762\u6263\u6389\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4ee3\u7801\u6709\u70b9\u4e11\uff0c\u538b\u884c\u6bd4\u8f83\u4e25\u91cd\u3002\n\n# AC \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int MAXN = 3e2 + 10;\nconst int mod = 1e9 + 7;\nconst int inv2 = mod + 1 >> 1;\n\ninline \nll inv(ll b, ll p = mod - 2) {\n\tll res = 1;\n\twhile (p) {\n\t\tif (p & 1) res = res * b % mod;\n\t\tb = b * b % mod, p >>= 1;\n\t}\n\treturn res;\n}\n\nll fac[MAXN], ifac[MAXN];\n\ninline \nvoid init(int n) {\n\t*fac = 1;\n\tfor (int i = 1; i <= n; i++) fac[i] = fac[i - 1] * i % mod;\n\tifac[n] = inv(fac[n]);\n\tfor (int i = n; i; i--) ifac[i - 1] = ifac[i] * i % mod;\n}\n\ninline \nll c(ll n, ll m) {\n\treturn fac[n] * ifac[m] % mod * ifac[n - m] % mod;\n}\n\nll dp[MAXN][MAXN];\n\ninline \nll calc(int n, int m, int l) {\n\tmemset(dp, 0, sizeof dp), **dp = 1;\n\tfor (int i = 1; i <= n; i++) {\n\t\tfor (int j = 0; j <= m; j++) {\n\t\t\tfor (int k = 1; k <= min({ l, i, j + 1 }); k++) {\n\t\t\t\tdp[i][j] = (dp[i][j] + dp[i - k][j - k + 1] * c(n - i + k - 1, k - 1) % mod * fac[k] % mod * (k > 1 ? inv2 : 1) % mod) % mod;\n\t\t\t}\n\t\t\tfor (int k = 2; k <= min({ l, i, j }); k++) {\n\t\t\t\tdp[i][j] = (dp[i][j] + dp[i - k][j - k] * c(n - i + k - 1, k - 1) % mod * fac[k - 1] % mod * (k > 2 ? inv2 : 1) % mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn dp[n][m];\n}\n\nint n, m, l;\n\nint main() {\n\tscanf(\"%d%d%d\", &n, &m, &l), init(n);\n\tprintf(\"%lld\", (calc(n, m, l) - calc(n, m, l - 1) + mod) % mod);\n}\n```",
        "postTime": 1672822039,
        "uid": 406941,
        "name": "Register_int",
        "ccfLevel": 6,
        "title": "ABC180F \u9898\u89e3"
    }
]
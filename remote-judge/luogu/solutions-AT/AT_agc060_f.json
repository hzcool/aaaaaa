[
    {
        "content": "## \u9898\u610f\n\n\u6bcf\u4e2a\u70b9\u4e0a\u6709\u4e00\u4e2a\u6574\u6570\u533a\u95f4\uff0c\u6574\u6570\u533a\u95f4\u4e3a $[i,j]$ \u7684\u70b9\u6709 $C_{i,j}$ \u4e2a\uff0c\u5e76\u4e14\u533a\u95f4\u4e00\u5b9a\u662f $[1,N]$ \u7684\u5b50\u96c6\u3002\n\n\u4e24\u4e2a\u70b9\u6709\u8fb9\u5f53\u4e14\u4ec5\u5f53\u4e24\u4e2a\u70b9\u4e0a\u7684\u533a\u95f4\u4ea4\u4e0d\u4e3a\u7a7a\u3002\n\n\u6c42\u751f\u6210\u6811\u4e2a\u6570\u3002\n\n$2\\le N\\le 400,1\\le C_{i,j}\\le 10000$\u3002\n\n## \u9898\u89e3\n\n\u8bb0 $M=2N-1,S=\\sum C_{i,j}$\u3002\u8003\u8651\u77e9\u9635\u6811\u5b9a\u7406\u3002\u628a $S$ \u4e2a\u533a\u95f4\u6807\u4e0a\u53f7\u3002\u8bbe\u7b2c $i$ \u4e2a\u533a\u95f4\u4e3a $L_i,R_i$\u3002\n\n\u8bbe\u77e9\u9635 $A$ \u4e3a $S\\times S$ \u7684\u77e9\u9635\uff0c\u6ee1\u8db3\u53ea\u6709\u4e3b\u5bf9\u89d2\u7ebf\u6709\u503c\uff0c$A_{i,i}$ \u8868\u793a $\\sum \\big[[L_i,R_i]\\cap[L_j,R_j]\\ne\\varnothing\\big]$\uff0c\u4e5f\u5c31\u662f\u6709\u4ea4\u7684\u533a\u95f4\u4e2a\u6570\uff08\u5305\u62ec\u81ea\u5df1\uff09\u3002\n\n\u8bbe\u77e9\u9635 $B$ \u4e3a $S\\times S$ \u7684\u77e9\u9635\uff0c$B_{i,j}=\\big[[L_i,R_i]\\cap [L_j,R_j]\\ne\\varnothing\\big]$\u3002\n\n\u6839\u636e\u77e9\u9635\u6811\u5b9a\u7406\uff0c\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f $A-B$ \u5212\u53bb\u4e00\u884c\u4e00\u5217\u4e4b\u540e\u7684\u884c\u5217\u5f0f\u3002\u76f4\u63a5\u505a\u662f $\\mathcal O(S^3)$ \u4e0d\u53ef\u63a5\u53d7\u3002\n\n\u8003\u8651\u4e24\u4e2a\u51fd\u6570 $F(l,r)$ \u548c $G(l,r)$\uff0c\u8fd4\u56de\u503c\u662f\u957f\u5ea6\u4e3a $M$ \u7684\u5217\u5411\u91cf\uff0c\u6ee1\u8db3\uff1a\n\n- $F(l,r)=v$\uff0c\u5219\uff1a\n  - $v_{2i-1}=1(i\\in[l,r])$\n  - $v_{2i-1}=0(i\\not\\in[l,r])$\n  - $v_{2i}=1([i,i+1]\\subseteq[l,r])$\n  - $v_{2i}=0([i,i+1]\\not\\subseteq[l,r])$\n- $G(l,r)=v$\uff0c\u5219\uff1a\n  - $v_{2i-1}=1(i\\in[l,r])$\n  - $v_{2i-1}=0(i\\not\\in[l,r])$\n  - $v_{2i}=-1([i,i+1]\\subseteq[l,r])$\n  - $v_{2i}=0([i,i+1]\\not\\subseteq[l,r])$\n\n\u4e0d\u96be\u53d1\u73b0 $B_{i,j}=F(L_i,R_i)^T\\times G(L_j,R_j)$\u3002\u56e0\u4e3a\u4e24\u4e2a\u533a\u95f4\u6709\u4ea4\u90a3\u4e48\u76f8\u4ea4\u7684\u70b9\u6570\u51cf\u53bb\u76f8\u4ea4\u7684\u8fb9\u6570 $=1$\u3002\n\n\u8003\u8651\u4e0b\u9762\u7684\u77e9\u9635\uff1a\n$$\n\\left[\\begin{array}{ccc|ccc}\n 1 &  &  &  &  & \\\\\n  & \\ddots &  & G(L_1,R_1) & \\cdots & G(L_{S-1},R_{S-1})\\\\\n  &  & 1 &  &  & \\\\\\hline\n  & F(L_1,R_1)^T &  & A_{1,1} &  & \\\\\n  & \\vdots &  &  &  \\ddots& \\\\\n  & F(L_{S-1},R_{S-1})^T &  &   & & A_{S-1,S-1}\n\\end{array}\\right]\n$$\n\u6a21\u62df\u4e00\u4e0b\u6d88\u5143\u7684\u8fc7\u7a0b\uff0c\u4e3a\u4e86\u6d88\u53bb $F(L_i,R_i)^T$ \u8fd9\u90e8\u5206\uff0c\u4f1a\u8ba9\u53f3\u4e0b\u89d2\u77e9\u9635\u7b2c $i$ \u884c $j$ \u5217\u51cf\u53bb $F(L_i,R_i)^T\\times G(L_j,R_j)=B_{i,j}$\uff0c\u4e5f\u5c31\u662f\u5f53\u5de6\u4e0b\u89d2\u77e9\u9635\u6d88\u5b8c\u65f6\uff0c\u53f3\u4e0b\u89d2\u5df2\u7ecf\u53d8\u6210\u4e86 $A-B$ \u5212\u53bb\u4e00\u884c\u4e00\u5217\uff0c\u4e5f\u5c31\u662f\uff1a\n$$\n\\left[\\begin{array}{ccc|ccc}\n 1 &  &  &  &  & \\\\\n  & \\ddots &  & G(L_1,R_1) & \\cdots & G(L_{S-1},R_{S-1})\\\\\n  &  & 1 &  &  & \\\\\\hline\n  &  &  & A_{1,1}-B_{1,1} & \\cdots & -B_{1,S-1}\\\\\n  &  &  & \\vdots &  \\ddots& \\vdots\\\\\n  & &  &  -B_{S-1,1} & \\cdots & A_{S-1,S-1}\n\\end{array}\\right]\n$$\n\u8fd9\u4e2a\u77e9\u9635\u7684\u884c\u5217\u5f0f\u5c31\u662f\u7b54\u6848\u3002\u53ef\u662f\u8fd9\u4e2a\u8fd8\u662f $\\mathcal O(S^3)$ \u7684\u3002\u5c1d\u8bd5\u6d88\u53bb\u53f3\u4e0a\u89d2\u3002\n\n\u4e3a\u4e86\u6d88\u53bb $G(L_i,R_i)$\uff0c\u6211\u4eec\u9700\u8981\u7528\u5230 $F(L_i,R_i)| A_{i,i}$ \u8fd9\u4e00\u884c\uff0c\u7136\u540e\u8ba9\u5de6\u4e0a\u89d2 $M\\times M$ \u7684\u77e9\u9635\u52a0\u4e0a $-1/A_{i,i}\\times G(L_i,R_i)\\times F(L_i,R_i)^T$\u3002\u7136\u540e\u53f3\u4e0a\u89d2\u5c31\u88ab\u6d88\u7a7a\u4e86\u3002\u77e9\u9635\u5927\u6982\u662f\u8fd9\u6837\u7684\uff1a\n$$\n\\left[\\begin{array}{ccc|ccc}\n  &  &  &  &  & \\\\\n  & ? &  &  &  & \\\\\n  &  &  &  &  & \\\\\\hline\n  & F(L_1,R_1)^T &  & A_{1,1} &  & \\\\\n  & \\vdots &  &  &  \\ddots& \\\\\n  & F(L_{S-1},R_{S-1})^T &  &   & & A_{S-1,S-1}\n\\end{array}\\right]\n$$\n\n\n\u6b64\u65f6\u7684\u884c\u5217\u5f0f\u5c31\u662f\u5de6\u4e0a\u89d2 $M\\times M$ \u7684\u90e8\u5206\u7684\u884c\u5217\u5f0f\u4e58\u4e0a $\\prod A_{i,i}$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u73b0\u5728\u53ea\u9700\u8981\u6c42\u51fa\u5de6\u4e0a\u89d2\u7684\u90e8\u5206\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u9996\u5148\u6709\u4e00\u4e2a $\\mathcal O(N^4)$ \u7684\u6c42\u6cd5\u5c31\u662f\u8003\u8651 $G(i,j)\\times F(i,j)^T$ \u4e00\u5171\u8d21\u732e\u4e86\u591a\u5c11\u6b21\uff0c\u66f4\u5177\u4f53\u5730\u5c31\u662f $- C_{i,j}/(S-\\sum_{y<i}C_{x,y}-\\sum _{j<x}C_{x,y})$\u3002\u540e\u9762\u7684\u4e24\u4e2a\u6c42\u548c\u53ef\u4ee5\u76f4\u63a5\u6c42\u524d\u7f00\u548c\u6216\u8005\u540e\u7f00\u548c\u3002\u987a\u4fbf\u53ef\u4ee5\u628a $\\prod A_{i,i}$ \u6c42\u51fa\u6765\u3002\n\n\u4f18\u5316\u5230 $\\mathcal O(N^3)$ \u5c31\u662f\u6bcf\u4e00\u6b21 $G(i,j)\\times F(i,j)^T$ \u4e0d\u8981\u66b4\u529b\u52a0\uff0c\u5dee\u5206\u52a0\u5373\u53ef\u3002\n\n\u53ef\u4ee5\u4f18\u5316\u5230 $\\mathcal O(N^2)$ \u4f46\u662f\u6c42\u884c\u5217\u5f0f\u8fd8\u662f $\\mathcal O(N^3)$ \u7684\u6240\u4ee5\u6211\u5c31\u6ca1\u5199\u3002\n\n\u8fd8\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u5c31\u662f\u4e0a\u9762\u7684\u53f3\u4e0b\u89d2\u77e9\u9635\u662f $S-1$ \u7684\u6240\u4ee5\u8981\u5220\u53bb\u4e00\u4e2a\u70b9\u55b5\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define mp make_pair\n#define mt make_tuple\n#define eb emplace_back\n#define pb push_back\n#define pc putchar\n#define chkmx(a,b) (a)=max((a),(b))\n#define chkmn(a,b) (a)=min((a),(b))\n#define fi first\n#define se second\nusing namespace std;\ntemplate<class T>\nvoid read(T&x){x=0;char c=getchar();bool f=0;for(;!isdigit(c);c=getchar())f^=c=='-';for(;isdigit(c);c=getchar())x=x*10+c-'0';if(f)x=-x;}\ntemplate<class T,class ...ARK>void read(T&x,ARK&...ark){read(x);read(ark...);}\ntemplate<class T>void write(T x){if(x<0)pc('-'),x=-x;if(x>=10)write(x/10);pc(x%10+'0');}\ntemplate<class T,class ...ARK>void write(T x,ARK...ark){write(x);pc(' ');write(ark...);}\ntemplate<class ...ARK>void writeln(ARK...ark){write(ark...);pc('\\n');}\ntypedef long long ll;\nconst int mod=998244353;\nstruct mint{\n\tint x;mint(int o=0){x=o;}mint&operator+=(mint a){return(x+=a.x)%=mod,*this;}mint&operator-=(mint a){return(x+=mod-a.x)%=mod,*this;}\n\tmint&operator*=(mint a){return(x=1ll*x*a.x%mod),*this;}mint&operator^=( int b){mint a=*this;x=1;while(b)(b&1)&&(*this*=a,1),a*=a,b>>=1;return*this;}\n\tmint&operator/=(mint a){return*this*=(a^=mod-2);}friend mint operator+(mint a,mint b){return a+=b;}friend mint operator-(mint a,mint b){return a-=b;}\n\tfriend mint operator*(mint a,mint b){return a*=b;}friend mint operator/(mint a,mint b){return a/=b;}friend mint operator^(mint a, int b){return a^=b;}\n\tmint operator-(){return 0-*this;}bool operator==(const mint b)const{return x==b.x;}\n};\nmt19937 rnd(chrono::steady_clock::now().time_since_epoch().count());\nint rint(int l,int r){return uniform_int_distribution<int>(l,r)(rnd);}\n#define lowbit(x) ((x)&-(x))\n#define mid ((l+r)>>1)\n#define lc (x<<1)\n#define rc (x<<1|1)\nconst int N=8e2+10;\nint n,c[N][N],pre[N],suf[N];\nmint a[N][N];\nmint det(int n){\n\tmint res=1;\n\tfor(int i=1;i<=n;i++){\n\t\tint p=i;while(p<=n&&!a[p][i].x)p++;\n\t\tif(p>n)return 0;\n\t\tif(p!=i)swap(a[i],a[p]),res=-res;\n\t\tres*=a[i][i];\n\t\tfor(int j=i+1;j<=n;j++){\n\t\t\tmint inv=a[j][i]/a[i][i];\n\t\t\tfor(int k=i;k<=n;k++)a[j][k]-=a[i][k]*inv;\n\t\t}\n\t}\n\treturn res;\n}\nsigned main(){\n\tread(n);int m=2*n-1;mint tot=0;\n\tfor(int i=1;i<=n;i++)for(int j=i;j<=n;j++)\n\t\tread(c[i][j]),tot+=c[i][j],pre[j]+=c[i][j],suf[i]+=c[i][j];\n\tfor(int i=1;i<=n;i++)pre[i]+=pre[i-1];\n\tfor(int i=n;i;i--)suf[i]+=suf[i+1];\n\tmint ans=1;\n\tfor(int i=1;i<=n;i++)for(int j=i;j<=n;j++){\n\t\tmint cnt=tot-pre[i-1]-suf[j+1];\n\t\tif(i==n)c[i][j]-=1;\n\t\tans*=cnt^c[i][j];\n\t\tmint coef=c[i][j]/cnt;\n\t\t/*vector<int>F(2*n),G(2*n);\n\t\tfor(int k=i;k<=j;k++)F[2*k-1]=1,G[2*k-1]=1;\n\t\tfor(int k=i;k<j;k++)F[2*k]=1,G[2*k]=mod-1;\n\t\tfor(int x=1;x<=m;x++)for(int y=1;y<=m;y++)\n\t\t\ta[x][y]-=F[x]*G[y]*coef;*/\n\t\tfor(int y=2*i-1;y<=2*j-1;y++)\n\t\t\tif(y&1)a[2*i-1][y]-=coef,a[2*j][y]+=coef;\n\t\t\telse a[2*i-1][y]+=coef,a[2*j][y]-=coef;\n\t}\n\tfor(int i=1;i<=m;i++)for(int j=1;j<=m;j++)a[i][j]+=a[i-1][j];\n\tfor(int i=1;i<=m;i++)a[i][i]+=1;\n\twriteln((ans*det(m)).x);\n}\n```",
        "postTime": 1672906075,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3  AGC060F\u3010Spanning Trees of Interval Graph\u3011"
    },
    {
        "content": "\u8bbe $S$ \u4e3a\u603b\u70b9\u6570\uff0c\u6839\u636e Matrix-tree \u5b9a\u7406\uff0c\u6211\u4eec\u8981\u8ba1\u7b97 $(S-1)\\times (S-1)$ \u7684\u77e9\u9635\u7684 $\\det$. \n\n\u8bbe $G_{i,j} = [[L_i,R_i]\u2229[L_j,R_j]\\ne \\varnothing],D_{i,i}=\\sum_j G_{i,j}$\uff0c\u8981\u8ba1\u7b97 $\\det(D-G)$. \u76f4\u63a5\u9ad8\u65af\u6d88\u5143\u662f $O(S^3)$ \u7684\u3002\n\n\u4e0b\u9762\u8003\u8651\u4f7f\u7528 [Matrix determinant lemma](https://en.wikipedia.org/wiki/Matrix_determinant_lemma) \u5316\u7b80\u5f0f\u5b50\u3002\n\n\u8003\u8651\u8bbe\u8ba1\u4e24\u4e2a $(S-1)\\times m$ \u7684\u77e9\u9635 $U,V$ \u4f7f\u5f97 $G=UV^T$.\uff08$m$ \u662f\u81ea\u5df1\u5b9a\u7684\u4e00\u4e2a\u6570\uff09\u3002\u6839\u636e [Matrix determinant lemma](https://en.wikipedia.org/wiki/Matrix_determinant_lemma)\uff1a\n\n$\\det(D-G) = \\det(D-UV^T) = \\det(I_m-V^TD^{-1}U)\\det(D)$. \uff08$I_m$ \u4e3a\u5bf9\u89d2\u7ebf\u4e3a $1$ \u7684\u77e9\u9635\uff09\n\n$D$ \u662f\u5bf9\u89d2\u77e9\u9635\uff0c$\\det$ \u597d\u7b97\u3002\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\u8ba1\u7b97 $\\det(I_m-V^TD^{-1}U)$. \n\n\u8fd9\u6837\u5c31\u8f6c\u5316\u6210\u4e86\u6c42\u5927\u5c0f\u4e3a $m$ \u77e9\u9635\u7684 $\\det$. \u6211\u4eec\u5e0c\u671b\u8bbe\u8ba1\u7684 $m$ \u80fd\u591f\u6bd4\u8f83\u5c0f\uff0c\u8fd9\u6837\u53d8\u5f62\u4e4b\u540e\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 $O(m^3)$ \u7684\u9ad8\u65af\u6d88\u5143\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u533a\u95f4\u7684\u4ea4\u96c6\u4e0d\u4e3a\u7a7a\u53ef\u4ee5\u7528\u4ea4\u96c6\u7684\u70b9\u51cf\u8fb9\u4e3a $1$ \u6765\u8868\u793a\u3002\u4e8e\u662f\u53ef\u4ee5\u8bbe $m=2n-1$\uff0c\u5e76\u8bbe $U,V$ \u5982\u4e0b\uff1a\n\n- $U_{i,2j-1} = V_{i,2j-1} = [j\\in [L_i,R_i]]$\n- $U_{i,2j} = -1\\times [[j,j+1]\\in [L_i,R_i]]$\n- $V_{i,2j} = 1\\times [[j,j+1]\\in [L_i,R_i]]$\n\n\u6b64\u65f6 $I_m-V^TD^{-1}U$ \u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u4e0d\u96be\u8ba1\u7b97\uff0c\u4e8e\u662f\u5bf9 $2n-1$ \u5927\u5c0f\u7684\u77e9\u9635\u9ad8\u65af\u6d88\u5143\uff0c\u590d\u6742\u5ea6 $O(n^3)$.\n\n\u4ee3\u7801\u4e0d\u653e\u4e86\uff0c\u653e\u4e2a[\u94fe\u63a5](https://atcoder.jp/contests/agc060/submissions/38121523).",
        "postTime": 1673834118,
        "uid": 151935,
        "name": "Rainbow_qwq",
        "ccfLevel": 0,
        "title": "agc060F"
    },
    {
        "content": "\u8bb0\u603b\u70b9\u6570 $S=\\sum_{i,j} C_{i,j}$\u3002\n\n\u8bbe $S \\times S$ \u7684\u5bf9\u89d2\u77e9\u9635 $A$ \u548c \u77e9\u9635 $B$\u3002\u5176\u4e2d $A_{i,i}$ \u8868\u793a\u4e0e\u7b2c $i$ \u4e2a\u70b9\u8fde\u8fb9\u7684\u6570\u91cf\uff08\u8ba4\u4e3a\u6bcf\u4e2a\u70b9\u4f1a\u5411\u81ea\u5df1\u8fde\u81ea\u73af\uff09\uff1b$B_{i,j}$ \u8868\u793a\u7b2c $i$ \u4e2a\u70b9\u4e0e\u7b2c $j$ \u4e2a\u70b9\u662f\u5426\u8fde\u8fb9\u3002\n\n\u90a3\u4e48\u7531 Matrix-Tree \u5b9a\u7406\uff0c\u7b54\u6848\u5373 $(A-B)$ \u7684 $n-1$ \u9636\u4e3b\u5b50\u5f0f\u3002\n\n\u7136\u800c $B$ \u77e9\u9635\u96be\u4ee5\u523b\u753b\u3002\n\n> \u5f15\u7406\uff1a\u5bf9\u4e8e $n \\times n$ \u7684\u77e9\u9635 $A$ \u53ca $f_1,\\cdots,f_n,g_1,\\cdots,g_n$\u3002\n\n$$\n\\begin{vmatrix}\nx & g_1 & g_2 & \\cdots & g_n \\\\ \nf_1 & A_{1,1} & A_{1,2} & \\cdots & A_{1,n} \\\\ \nf_2 & A_{2,1} & A_{2,2} & \\cdots & A_{2,n} \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\nf_n & A_{n,1} & A_{n,2} & \\cdots & A_{n,n} \\\\\n\\end{vmatrix}\n=\nx \\cdot\n\\begin{vmatrix}\nA_{1,1}-f_1 g_1/x & A_{1,2}-f_1 g_2/x & \\cdots & A_{1,n}-f_1 g_n/x \\\\ \nA_{2,1}-f_2 g_1/x & A_{2,2}-f_2 g_2/x & \\cdots & A_{2,n}-f_2 g_n/x \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nA_{n,1}-f_n g_1/x & A_{n,2}-f_n g_2/x & \\cdots & A_{n,n}-f_n g_n/x \\\\\n\\end{vmatrix}\n$$\n\n> \u8bc1\u660e\uff1a\u7528\u7b2c\u4e00\u884c\u5411\u4e0b\u6d88\u5143\u5373\u53ef\u3002\n\n> \u63a8\u8bba\uff1a\u5bf9\u4e8e $n \\times n$ \u7684\u77e9\u9635 $A$ \u53ca $1 \\times n$ \u884c\u5411\u91cf $F_1,\\cdots,F_n$ \u548c $n \\times 1$ \u5217\u5411\u91cf $G_1,\\cdots,G_n$\u3002\n\n$$\n\\begin{vmatrix}\n1 & 0 & \\cdots & 0 \\\\\n0 & 1 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots & G_1 & G_2 & \\cdots & G_n \\\\\n0 & 0 & \\cdots & 1 \\\\\n & & F_1 & & A_{1,1} & A_{1,2} & \\cdots & A_{1,n} \\\\ \n & & F_2 & & A_{2,1} & A_{2,2} & \\cdots & A_{2,n} \\\\\n & & \\vdots & & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n & & F_n & & A_{n,1} & A_{n,2} & \\cdots & A_{n,n} \\\\\n\\end{vmatrix}\n=\n\\begin{vmatrix}\nA_{1,1}-F_1 G_1 & A_{1,2}-F_1 G_2 & \\cdots & A_{1,n}-F_1 G_n \\\\ \nA_{2,1}-F_2 G_1 & A_{2,2}-F_2 G_2 & \\cdots & A_{2,n}-F_2 G_n \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nA_{n,1}-F_n G_1 & A_{n,2}-F_n G_2 & \\cdots & A_{n,n}-F_n G_n \\\\\n\\end{vmatrix}\n$$\n\n\u8003\u8651\u7528\u70b9\u4e58\u523b\u753b\u4e24\u4e2a\u70b9 $x,y$ \u4ee3\u8868\u7684\u533a\u95f4 $[a,b]$\uff0c$[c,d]$ \u662f\u5426\u76f8\u4ea4\uff0c\u5176\u7b49\u4e8e \u76f8\u4ea4\u7684\u70b9\u6570 $-$ \u76f8\u4ea4\u7684\u8fb9\u6570\u3002\n\n\u4e8e\u662f\u8bbe $1 \\times n$ \u884c\u5411\u91cf $F_x$ \u548c $n \\times 1$ \u5217\u5411\u91cf $G_x$\uff0c\u6ee1\u8db3\uff1a\n\n- $F_{x,2i-1}=G_{x,2i-1}=[a \\leq i \\leq b],i \\in [1,n]$\n\n- $F_{x,2i}=[a \\leq i < i+1 \\leq b],i \\in [1,n)$\n\n- $G_{x,2i}=-[a \\leq i < i+1 \\leq b],i \\in [1,n)$\n\n\u5373\u5411\u91cf\u6bcf\u4e00\u4f4d\u4ee3\u8868\u4e00\u4e2a\u70b9\u6216\u4e00\u6761\u8fb9\u3002\u4e8e\u662f $B_{i,j}=F_i G_j$\u3002\n\n\u90a3\u4e48\u4ee3\u5165\u5f15\u7406\uff0c\u6240\u6c42\u5373\uff1a\n\n$$\n\\begin{vmatrix}\n1 & 0 & \\cdots & 0 \\\\\n0 & 1 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots & G_1 & G_2 & \\cdots & G_{S-1} \\\\\n0 & 0 & \\cdots & 1 \\\\\n & & F_1 & & A_{1,1} & 0 & \\cdots & 0 \\\\ \n & & F_2 & & 0 & A_{2,2} & \\cdots & 0 \\\\\n & & \\vdots & & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n & & F_{S-1} & & 0 & 0 & \\cdots & A_{S-1,S-1} \\\\\n\\end{vmatrix}\n$$\n\n\u5012\u8fc7\u6765\u4ece\u53f3\u4e0b\u89d2\u5e94\u7528\u5f15\u7406\uff0c\u6700\u540e\u6d88\u6210\u5de6\u4e0a\u89d2\u7684 $(2n-1) \\times (2n-1)$ \u7684\u77e9\u9635\u3002\u90a3\u4e48\u76f8\u5f53\u4e8e\u6bcf\u4e2a $F_{x,i}$ \u4e0e $G_{x,j}$ \u4f1a\u5bf9\u5de6\u4e0a\u89d2\u7b2c $i$ \u5217 $j$ \u884c\u6709 $-F_{x,i}G_{x,j}/A_{x,x}$ \u7684\u8d21\u732e\uff0c\u6700\u540e\u7b54\u6848\u518d\u4e58\u4e0a $\\prod_x A_{x,x}$\u3002\n\n\u6700\u540e\u7684\u77e9\u9635\u6bcf\u4e00\u9879\u90fd\u5bb9\u6613\u7528\u4e8c\u7ef4\u524d\u540e\u7f00\u548c\u7b97\u51fa\uff0c\u9ad8\u65af\u6d88\u5143\u6c42\u884c\u5217\u5f0f\u5373\u53ef\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\u3002\n\n[**Code**](https://atcoder.jp/contests/agc060/submissions/37898818)",
        "postTime": 1673653698,
        "uid": 225645,
        "name": "\u82f9\u679c\u84dd17",
        "ccfLevel": 8,
        "title": "[AGC060F] Spanning Trees of Interval Graph \u9898\u89e3"
    }
]
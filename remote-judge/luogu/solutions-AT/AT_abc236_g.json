[
    {
        "content": "\u8bb0 $f_{i,j}$ \u8868\u793a\u4ece\u8282\u70b9 $1$ \u5f00\u59cb\u8d70 $i$ \u6b65\u53ef\u4ee5\u5230 $j$ \u7684\u6700\u5c0f\u65f6\u95f4\uff0c$t_{i,j}$ \u8868\u793a $i \\rightarrow j$ \u8fd9\u4e00\u6761\u8fb9\u6700\u65e9\u662f\u4ec0\u4e48\u65f6\u5019\u88ab\u8fde\u63a5\u7684\u3002\n\n\u6709\u663e\u7136\u8f6c\u79fb $f_{i,j} = \\min\\limits_{k=1}^n \\{ \\max(f_{i-1,k},t_{j,k}) \\}$\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u77e9\u9635\u4e58\u6cd5\u7684\u5f62\u5f0f\uff0c\u8f6c\u79fb\u4e2d\u7684 $\\min,\\max$ \u5747\u6ee1\u8db3\u7ed3\u5408\u5f8b\u3002\n\n\u53ef\u4ee5\u5199\u51fa\u9012\u63a8\u5f0f\uff1a\n\n$$\n\\left [\n\\begin{array}{l}\nf_{i,1} \\\\\nf_{i,2} \\\\\n\\dots \\\\\nf_{i,n}\n\\end{array}\n\\right ] = \\left [\n        \\begin{array}{l}\n        t_{1,1} & t_{1,2} & \\cdots & t_{1,n-1} & t_{1,n}\\\\\n        t_{2,1} & t_{2,2} & \\cdots & t_{2,n-1} & t_{2,n} \\\\\n        \\vdots  & \\vdots  & \\ddots & \\vdots  & \\vdots\\\\\n        t_{n-1,1} & t_{n-1,2} & \\cdots & t_{n-1,n-1} & t_{n-1,n}\\\\\n        t_{n,1} & t_{n,2} & \\cdots & t_{n,n-1} & t_{n,n}\\\\\n        \\end{array}\n        \\right ]\n      \\times\n      \\left [\n      \\begin{array}{l}\n      f_{i-1,1} \\\\\n      f_{i-1,2} \\\\\n      \\dots \\\\\n      f_{i-1,n}\n      \\end{array}\n      \\right ]\n$$\n\n\u6211\u4eec\u5b9a\u4e49\u8fd0\u7b97 $A \\times B$ \u4e3a $(A \\times B)_{i,j} = \\min\\limits_{k=1}^n\\{ \\max(A_{i,k},B_{k,j})\\}$\u3002\n\n\u77e9\u9635\u5feb\u901f\u5e42\u52a0\u901f\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n^3 \\log L)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define int long long\n#define vi vector<int>\n#define pb(x) push_back(x)\n#define pii pair<int,int>\n#define lowbit(x) x&-x\nusing namespace std;\nconst int N=111;\nstruct matrix{\n\tint a[N][N],n;\n}ans;\nint n,m,k,T;\ninline int read(){\n\tint s=0,f=0;\n\tchar ch=getchar();\n\twhile(ch>'9'||ch<'0') f|=(ch=='-'),ch=getchar();\n\twhile(ch<='9'&&ch>='0') s=(s<<3)+(s<<1)+(ch^48),ch=getchar();\n\treturn f?-s:s;\n}\ninline matrix operator *(const matrix a,const matrix b){\n\tmatrix res;\n\tfor(register int i=1;i<=n;++i) for(register int j=1;j<=n;++j) res.a[i][j]=1e9;\n\tfor(register int i=1;i<=n;++i){\n\t\tfor(register int j=1;j<=n;++j){\n\t\t\tfor(register int k=1;k<=n;++k){\n\t\t\t\tres.a[i][j]=min(res.a[i][j],max(a.a[i][k],b.a[k][j]));\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\ninline matrix qpow(matrix x,int y){\n\tmatrix res;\n\tfor(register int i=1;i<=n;++i) for(register int j=1;j<=n;++j) res.a[i][j]=1e9*(i!=j);\n\twhile(y){\n\t\tif(y&1) res=res*x;\n\t\tx=x*x;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\nsigned main(){\n\tn=read(),m=read(),k=read();\n\tfor(register int i=1;i<=m;++i){\n\t\tint u=read(),v=read();\n\t\tif(!ans.a[u][v]) ans.a[u][v]=i;\n\t}\n\tfor(register int i=1;i<=n;++i) for(register int j=1;j<=n;++j) if(!ans.a[i][j]) ans.a[i][j]=1e9;\n\tans=qpow(ans,k);\n\tfor(register int i=1;i<=n;++i){\n\t\tif(ans.a[1][i]>=1e9) printf(\"-1 \");\n\t\telse printf(\"%lld \",ans.a[1][i]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1683191222,
        "uid": 428089,
        "name": "HMZHMZHMZ",
        "ccfLevel": 7,
        "title": "ABC236G"
    },
    {
        "content": "$l \\le 10^9$ \u544a\u8bc9\u6211\u4eec\u5f80\u77e9\u9635\u5feb\u901f\u5e42\u4e0a\u9762\u9760\uff0c\u6211\u4eec\u4e0d\u59a8\u628a\u65f6\u95f4\u5f53\u4f5c\u6743\u503c\u3002\n\n\u8003\u8651\u72b6\u6001 $f_{v,i}$ \u8868\u793a\u4ece\u70b9 $1$ \u51fa\u53d1\u5230\u70b9 $v$ \u62e5\u6709\u957f\u5ea6\u4e3a $i$ \u7684\u8def\u5f84\u9700\u8981\u7684\u6700\u5c0f\u65f6\u95f4\uff0c\u5219\u6709\u8f6c\u79fb\n\n$$f_{v,i} = \\min \\{\\max(f_{u,i-1},w_{u \\rightarrow v}) \\}$$\n\n$w_{u \\rightarrow v}$ \u8868\u793a $u$ \u5230 $v$ \u8fd9\u6761\u8fb9\u51fa\u73b0\u7684\u65f6\u95f4\uff0c\u4e3a\u4e86\u6ee1\u8db3\u6240\u6709\u8fb9\u5747\u51fa\u73b0\uff0c\u6240\u4ee5\u91cc\u9762\u53d6 $\\max$\uff1b\u6700\u5c0f\u65f6\u95f4\uff0c\u6240\u4ee5\u5916\u9762\u53d6 $\\min$\u3002\n\n\u6839\u636e\u4f1f\u5927\u4e4b\u795e Larunatrecy \u6240\u8ff0\uff0c\u611f\u89c9\u53ef\u4ee5\u5916\u9762\u4e8c\u5206\u65f6\u95f4\uff0c\u91cc\u9762\u505a\u4e00\u4e2a $\\max$ \u77e9\u4e58\uff0c\u4f46\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u505a\u77e9\u4e58\uff0c\n\n\u6839\u636e [\u8fd9\u4e2a](https://www.cnblogs.com/juruo-zzt/p/16813076.html) \u4e1c\u897f\uff0c$(Z \\cup \\infty, \\min , \\max )$ \u6784\u6210\u534a\u73af\uff0c\u540c\u65f6 $(Z \\cup \\infty, \\min)$ \u662f\u4ea4\u6362\u5e7a\u534a\u7fa4\uff0c$(Z, \\max)$ \u662f\u534a\u7fa4\uff0c\u6240\u4ee5 $\\min ,\\max$ \u7684\u77e9\u9635\u4e58\u6cd5\u4e4b\u95f4\u6709\u7ed3\u5408\u5f8b\uff0c\u76f4\u63a5\u4e0a\u5c31\u53ef\u4ee5\u4e86\u3002\n\n### Code.\n\n```cpp\n#include<bits/stdc++.h>\nint read()\n{\n\tint x=0; bool f=0; char ch=getchar();\n\twhile(ch < '0' || ch > '9') f|=(ch == '-'),ch=getchar();\n\twhile(ch >= '0' && ch <= '9') x=x*10+(ch^48),ch=getchar();\n\treturn f ? -x : x;\n}\nusing namespace std;\nconst int imax=0x3f3f3f3f;\nint n,m,l;\nstruct mat\n{\n\tint a[101][101];\n\tmat() { memset(a,0x3f,sizeof a);}\n\tmat operator * (const mat &o) const {\n\t\tmat res;\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tfor(int k=1;k<=n;k++)\n\t\t\t\t\tres.a[i][j]=min(res.a[i][j],max(a[i][k],o.a[k][j]));\n\t\treturn res;\n\t}\n} ma;\nmat ksm(mat a,int b)\n{\n\tmat s; for(int i=1;i<=n;i++) s.a[i][i]=0;\n\twhile(b) {if(b&1) s=(s*a); a=a*a; b>>=1;}\n\treturn s;\n}\nint main()\n{\n\tn=read(); m=read(); l=read();\n\tfor(int i=1;i<=m;i++) {int u=read(),v=read(); ma.a[u][v]=min(ma.a[u][v],i);}\n\tma=ksm(ma,l);\n\tfor(int i=1;i<=n;i++) printf(\"%d \",ma.a[1][i] == imax ? -1 : ma.a[1][i]); \n\treturn 0;\n}\n```",
        "postTime": 1677503473,
        "uid": 230865,
        "name": "EastPorridge",
        "ccfLevel": 0,
        "title": "[ABC236G] Good Vertices \u9898\u89e3"
    },
    {
        "content": "\u6765\u70b9\u52a3\u8d28\u505a\u6cd5\uff0c\u6a21\u62df\u8d5b\u7684\u65f6\u5019\u5361\u5e38\u5361\u4e86\u4e24\u4e2a\u5c0f\u65f6\u5dee\u70b9\u5410\u8840\n\n\uff08\u672c\u7bc7\u590d\u6742\u5ea6\u8f83\u9ad8\uff0c\u4e0d\u662f\u5b98\u65b9\u6b63\u89e3\uff0c\u6ce8\u610f\u907f\u96f7\uff09\n\n---\n\n\u9996\u5148\u770b\u5230\u8fd9\u4e2a\u9898\u9762\uff0c\u4f60\u9a6c\u4e0a\u53ef\u4ee5\u60f3\u5230 [[TJOI2017]\u53ef\u4e50](https://www.luogu.com.cn/problem/P3758) \u7684\u7ecf\u5178 trick\u3002\n\n> \u8bbe $A$ \u4e3a\u56fe\u7684\u90bb\u63a5\u77e9\u9635\uff0c$A^k_{i,j}$ \u5c31\u8868\u793a\u4ece\u8282\u70b9 $i$ \u7ecf\u8fc7 $k$ \u6b65\u5230\u8fbe\u8282\u70b9 $j$ \u7684\u65b9\u6848\u6570\u3002\n\n\u663e\u7136\u7b54\u6848\u5177\u6709\u53ef\u4e8c\u5206\u6027\uff0c\u5bf9\u6bcf\u4e2a\u70b9\u4e8c\u5206\u7b54\u6848\uff0c\u4f7f\u7528\u77e9\u9635\u5feb\u901f\u5e42 check \u65b9\u6848\u6570\u662f\u5426\u5927\u4e8e $0$\uff0c\u590d\u6742\u5ea6 $\\mathbb O(n^4\\log L\\log T)$\uff0c\u975e\u5e38\u7684\u5bc4\u3002\n\n\u6ce8\u610f\u5230\u591a\u6b21\u8be2\u95ee\uff0c\u90a3\u6211\u4eec\u76f4\u63a5\u6539\u6210**\u6574\u4f53\u4e8c\u5206**\uff0c```solve(S,l,r)``` \u8868\u793a $S$ \u96c6\u5408\u5185\u7684\u70b9\u7b54\u6848\u533a\u95f4\u90fd\u5728 $[l,r]$ \u4e2d\u3002\u6700\u540e\u5206\u6cbb\u6811\u4e0a\u6700\u591a\u53ea\u6709 $n$ \u4e2a\u53f6\u5b50\uff0ccheck \u4e00\u5171\u4f1a\u8fdb\u884c\u5927\u7ea6 $(1+2+4+8+\\cdots+n)=\\mathbb O(n)$ \u6b21\uff0c\u590d\u6742\u5ea6 $\\mathbb O(n^4\\log L)$\u3002\u5b9e\u9645\u8fd0\u7b97\u6b21\u6570\u8fd8\u4f1a\u9ad8\u4e8e\u8fd9\u4e2a\u503c\u7684\u3002\n\n\u56de\u987e\u4e4b\u524d\u5e72\u7684\u4e8b\uff0c\u6211\u4eec\u771f\u7684\u9700\u8981\u7cbe\u786e\u7684\u65b9\u6848\u6570\u5417\uff1f\u9700\u8981\u7684\u53ea\u662f\u5b83\u662f\u5426 $>0$ \u800c\u5df2\u3002\u5047\u5982 $A_{i,j}=\\sum B_{i,k}C_{k,j}$\uff0c\u53ea\u8981\u5b58\u5728\u4e00\u4e2a $k$ \u4f7f\u5f97 $B_{i,k}>0\\land C_{k,j}>0$\uff0c\u5c31\u6709 $A_{i,j}>0$\u3002\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u628a $C$ \u77e9\u9635\u8f6c\u7f6e\u4e00\u4e0b\uff0c\u7528 $C^R$ \u8868\u793a\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 bitset \u5bf9 $B_i,C^R_j$ \u6c42\u4ea4\uff0c\u6709\u4ea4\u5219 $A_{i,j}>0$\u3002\u590d\u6742\u5ea6 $\\mathbb O(\\frac{n^4\\log L}{\\omega})$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\nCode\n\n\u6c42\u4ea4\u65f6\u8bf7\u4f7f\u7528 ```any()``` \u6210\u5458\u51fd\u6570\u8fdb\u884c\u5224\u65ad\uff0c```count()``` \u4e4b\u6d41\u4f1a\u88ab\u5361\u7206\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,T,L,x[10003],y[10003],ans[10003];\nstruct star{\n\tbitset<101>a[101];\n\tstar(){for(int i=1;i<=n;i++)a[i].reset();}\n\tfriend star operator*(const star&x,const star&y){\n\t\tstar res,Y;\n\t\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)if(y.a[i].test(j))Y.a[j].set(i);\n\t\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)if((x.a[i]&Y.a[j]).any())res.a[i].set(j);\n\t\treturn res;\n\t}\n};\ninline star quickpow(star &a,int b){\n\tstar ans;\n\tfor(int i=1;i<=n;i++)ans.a[i].set(i);\n\twhile(b){\n\t\tif(b&1)ans=ans*a;\n\t\ta=a*a,b>>=1;\n\t}return ans;\n}\ninline void solve(vector<int>&a,int l,int r){\n\tif(!a.size())return;\n\tint mid=(l+r)>>1;\n\tstar G;\n\tfor(int i=1;i<=mid;i++)G.a[x[i]].set(y[i]);\n\tG=quickpow(G,L);\n\tvector<int>A,B;\n\tfor(int v:a){\n\t\tif(l==r)ans[v]=(G.a[1].test(v)?l:-1);\n\t\telse G.a[1].test(v)?A.emplace_back(v):B.emplace_back(v);\n\t}\n\tif(l==r)return;\n\tsolve(A,l,mid),solve(B,mid+1,r);\n}\nint main(){\n\tscanf(\"%d%d%d\",&n,&T,&L);\n\tfor(int i=1;i<=T;i++)scanf(\"%d%d\",&x[i],&y[i]);\n\tvector<int>tmp;\n\tfor(int i=1;i<=n;i++)tmp.emplace_back(i);\n\tsolve(tmp,1,T);\n\tfor(int i=1;i<=n;i++)printf(\"%d \",ans[i]);return 0;\n}\n```\n",
        "postTime": 1676953204,
        "uid": 148226,
        "name": "Fan_sheng",
        "ccfLevel": 6,
        "title": "AT_abc236_g Good Vertices"
    }
]
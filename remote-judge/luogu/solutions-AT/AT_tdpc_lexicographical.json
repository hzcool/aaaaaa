[
    {
        "content": "under \u9898\u89e3 [AT686](https://www.luogu.com.cn/problem/AT686)\n\n\u540c\u6b65\u53d1\u5e03\u4e8e[\u4e2a\u4eba\u535a\u5ba2](https://fa555.github.io/2020/\u67d0At\u7684dp\u573a/#G-\u8f9e\u66f8\u9806)\n\n### problem\n\n\u6c42\u5b57\u7b26\u4e32 $s \\ (1 \\le |s| \\le 10^6)$ \u7684\u5b57\u5178\u5e8f\u7b2c $K \\ (1 \\le K \\le 10^{18})$ \u5c0f\u7684\u975e\u7a7a**\u5b50\u5e8f\u5217**\u6216\u5224\u65ad\u4e0d\u5b58\u5728\u3002\u76f8\u540c\u7684\u5b50\u5e8f\u5217\u53ea\u8ba1\u7b97\u4e00\u6b21\u3002\u5b57\u7b26\u96c6\u5c0f\u5199\u62c9\u4e01\u5b57\u6bcd\u3002\n\n### solution\n\n> \u3068\uff0c\u8272\u3005\u66f8\u3044\u305f\u3051\u3069\u308f\u304b\u308a\u306b\u304f\u3044\u89e3\u8aac\u3060\u306a\u2026\uff0e\n>\n> \u81ea\u5206\u3082\u304b\u306a\u308a\u82e6\u624b\u306a\u554f\u984c\u306a\u306e\u3067\u2026\uff0e\n>\n> \u2014\u2014 Suikaba \u7684\u539f\u8bdd\n\n\u770b\u4e86 Suikaba \u795e\u4ed9\u7684\u9898\u89e3\uff0c\u5c1d\u8bd5\u6765\u81ea\u5df1\u80e1\u4e00\u80e1\uff08\n\n\u8bbe $\\mathrm{nxt}_{i, c}$ \u4e3a $s$ \u4e2d\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u4e4b\u540e\u7b2c\u4e00\u4e2a\u51fa\u73b0 $c$ \u7684\u4f4d\u7f6e\uff1b$f_i$ \u4e3a\u4f7f\u7528\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u7684\u5b57\u7b26\uff0c\u5176\u540e\u5b50\u5e8f\u5217\u7684\u4e2a\u6570\u3002\u90a3\u4e48\u6709\n\n$$\nf_i = 1 + \\sum_{c \\in |T|} f_{\\mathrm{nxt}_{i, c}}\n$$\n\n\u5176\u4e2d $T$ \u8868\u793a\u5b57\u7b26\u96c6\u3002\u52a0\u4e0a\u7684 $1$ \u8868\u793a\u5f53\u524d\u5b57\u7b26\u5355\u72ec\u6210\u4e32\u3002\n\n\u8003\u8651\u5982\u4f55\u627e\u5230\u5b57\u5178\u5e8f\u7b2c $K$ \u5c0f\u7684\u96c6\u5408\u3002\u8bbe\u4e00\u4e2a\u5411\u540e\u8df3\u7684\u6307\u9488\uff0c\u521d\u59cb\u6307\u5411\u5b57\u7b26\u4e32\u8d77\u59cb\u4f4d\u7f6e\u3002\u4ece\u5c0f\u5230\u5927\u679a\u4e3e $T$ \u4e2d\u7684\u5b57\u7b26\uff0c\u5411\u540e\u8fb9\u8df3\u6307\u9488\u8fb9\u7edf\u8ba1\u7b54\u6848\u5373\u53ef\u3002\u5b9e\u73b0\u7ec6\u8282\u89c1\u4ee3\u7801\u3002\n\n### code\n\n``` cpp\nchar s[1000003];\nint nxt[1000003][27];\nlong long K, f[1000003];\n\nint main() {\n  scanf(\"%s%lld\", s + 1, &K);\n  const int N = strlen(s + 1);\n  std::fill(nxt[N + 1] + 1, nxt[N + 1] + 27, N + 1);\n  for (int i = N; i >= 0; --i) {\n    memcpy(nxt[i] + 1, nxt[i + 1] + 1, sizeof(int) * 26);\n    f[i] = 1;\n    for (int j = 1; j <= 26; ++j) {\n      f[i] += f[nxt[i][j]];\n      f[i] = std::min(f[i], K + 1);\n    }\n    nxt[i][s[i] & 31] = i;\n  }\n\n  bool g = 0;\n  for (int i, p = 1; K > 0; ) {\n    for (i = 1; i <= 26; ++i)\n      if (f[nxt[p][i]] < K)\n        K -= f[nxt[p][i]];\n      else {\n        --K;\n        p = nxt[p][i] + 1;\n        g = 1;\n        putchar(i - 1 + 'a');\n        break;\n      }\n    if (i > 26) break;\n  }\n  puts(g ? \"\" : \"Eel\");\n  return 0;\n}\n\n\n```",
        "postTime": 1585054142,
        "uid": 111890,
        "name": "fa_555",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT686 \u3010\u8f9e\u66f8\u9806\u3011"
    }
]
[
    {
        "content": "### \u9898\u610f\n\u7ed9\u5b9a\u4e00\u4e2a $n$ \u4e2a\u70b9\u7684\u6811\uff0c$1$ \u662f\u6839\u3002\u6bcf\u4e2a\u70b9\u521d\u59cb\u90fd\u662f\u767d\u8272\u7684\uff0c\u5982\u679c\u4e00\u4e2a\u70b9 $x$ \u5230\u6839\u7684\u94fe\u4e0a\u5b58\u5728\u767d\u8272\u70b9\uff0c\u5219\u79f0\u8fd9\u4e2a\u70b9\u662f \"bad\" \u7684\u3002\u6bcf\u4e00\u6b21\u64cd\u4f5c\u4f1a\u5728\u6240\u6709 \"bad\" \u7684\u70b9\u4e2d\u968f\u610f\u9009\u62e9\u4e00\u4e2a\u70b9\uff0c\u5c06\u5176\u67d3\u6210\u9ed1\u8272\uff0c\u95ee\u671f\u671b\u591a\u5c11\u6b21\u4f1a\u628a\u6574\u68f5\u6811\u67d3\u6210\u9ed1\u8272\uff1f\n\n### \u9898\u89e3\n\u8003\u8651\u6bcf\u4e00\u4e2a\u70b9\u88ab\u64cd\u4f5c\u4e86\u51e0\u6b21\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u70b9 $x$\uff0c\u5047\u8bbe\u5176\u6df1\u5ea6\u4e3a $d$\uff08$1$ \u7684\u6df1\u5ea6\u4e3a $1$\uff09\u6709\u4e24\u79cd\u60c5\u51b5\u3002  \n1. \u5728 $x$ \u67d3\u9ed1\u524d\uff0c\u5176\u6240\u6709\u7956\u5148\u90fd\u88ab\u67d3\u8fc7\u8272\u3002  \n2. \u5b58\u5728\u4e00\u4e2a\u7956\u5148\uff0c\u5728 $x$ \u88ab\u67d3\u9ed1\u4e4b\u540e\u624d\u88ab\u67d3\u9ed1\u3002 \n\n\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c$x$ \u4e00\u5b9a\u88ab\u53ea\u64cd\u4f5c\u4e86\u4e00\u6b21\uff0c\u5c06\u5176\u67d3\u9ed1\uff0c\u800c\u8fd9\u79cd\u60c5\u51b5\u51fa\u73b0\u7684\u6982\u7387\u4e3a $\\frac1d$\uff08$x$ \u662f\u5b83\u5230\u6839\u7684\u8def\u5f84\u4e0a $d$ \u4e2a\u70b9\u4e2d\u6700\u540e\u4e00\u4e2a\u88ab\u67d3\u9ed1\u7684\uff09\u3002\n\n\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u5148\u8003\u8651 $x$ \u5728\u5176\u7b2c\u4e00\u4e2a\u88ab\u67d3\u9ed1\u7684\u7956\u5148\u88ab\u67d3\u9ed1\u4e4b\u524d\u671f\u671b\u7684\u88ab\u64cd\u4f5c\u6b21\u6570\uff0c$x$ \u88ab\u64cd\u4f5c\uff0c\u5f53\u4e14\u4ec5\u5f53 $x$ \u662f\u8fd9 $d$ \u4e2a\u70b9\u4e2d\u7b2c\u4e00\u4e2a\u67d3\u9ed1\u7684\uff0c\u6240\u4ee5\u51fa\u73b0\u4e00\u6b21\u7684\u6982\u7387\u662f $\\frac 1 d$\uff0c\u51fa\u73b0\u4e24\u6b21\u7684\u6982\u7387\u662f $\\frac 1 {d^2} $\u2026\u2026\u4e8e\u662f\u603b\u7684\u671f\u671b\u662f:\n$$ \\sum _{i=1}^ \\infty \\frac 1 {d^i}= \\frac 1 {d-1}$$\n\u540c\u7406\uff0c$x$ \u5728\u5176\u7b2c\u4e8c\u4e2a\u88ab\u67d3\u9ed1\u7684\u7956\u5148\u67d3\u9ed1\u4e4b\u524d\u88ab\u64cd\u4f5c\u7684\u671f\u671b\u6b64\u6570\u5c31\u4e3a $ \\frac 1 {d-2} $\u3002\u4ee5\u6b64\u7c7b\u63a8\uff0c\u6240\u4ee5\u603b\u7684\u671f\u671b\u5c31\u662f : \n$$ \\sum _{i=1}^{d-1} \\frac 1 i$$ \n\n\n\u5c06\u8fd9\u4e24\u79cd\u60c5\u51b5\u6c47\u603b\uff0c$x$ \u88ab\u64cd\u4f5c\u7684\u671f\u671b\u6b21\u6570\u5c31\u662f:\n$$ \\sum _{i=1}^d \\frac 1 i$$\n\n\u4e8e\u662f\u7b97\u51fa\u6bcf\u4e2a\u70b9\u7684\u6df1\u5ea6\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a\u70b9\u64cd\u4f5c\u7684\u671f\u671b\u6c42\u548c\uff0c\u5c31\u80fd\u5f97\u51fa\u7b54\u6848\u3002\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\ninline int in(){\n\tint x;\n\tscanf(\"%d\",&x);\n\treturn x;\n}\nconst int N=2e5+5,mod=998244353;\ninline int add(int a,int b){return a+b>=mod?a+b-mod:a+b;}\ninline int mul(int a,int b){return (long long)a*b%mod;}\ninline int qpow(int a,int b){\n\tint c=1;\n\tfor(;b;b>>=1,a=mul(a,a))if(b&1)c=mul(c,a);\n\treturn c;\n}\nint n,p[N],dep[N],sum[N];\nint main(){\n\tn=in();\n\tdep[1]=1;\n\tfor(int i=2;i<=n;i++)dep[i]=dep[in()]+1;\n\tfor(int i=1;i<=n;i++)sum[i]=add(sum[i-1],qpow(i,mod-2));\n\tint ans=0;\n\tfor(int i=1;i<=n;i++)ans=add(ans,sum[dep[i]]);\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1665328610,
        "uid": 211518,
        "name": "william555",
        "ccfLevel": 9,
        "title": "\u3010\u9898\u89e3\u3011[ARC150D] Removing Gacha"
    },
    {
        "content": "\u53ea\u8981\u6709\u4fe1\u5ff5\uff0c\u5c31\u4e00\u5b9a\u80fd\u6210\u529f\uff01\n\n\u5728\u8003\u8bd5\u7ed3\u675f\u524d 5 \u5206\u949f\u53d1\u73b0\u7684\u6027\u8d28\uff0c\u867d\u7136\u53ef\u60dc\uff0c\u4f46\u4e0d\u6b63\u8bf4\u660e\u6211\u7684\u601d\u7ef4\u80fd\u529b\u548c\u4ee3\u7801\u80fd\u529b\u6709\u5f85\u63d0\u5347\u5417\uff1f\n\n### [\u9898\u610f](https://atcoder.jp/contests/arc150/tasks/arc150_d)\n\u7ed9\u5b9a\u4e00\u68f5 $n$ \u4e2a\u8282\u70b9\u7684\u6709\u6839\u6811\uff0c\u4e00\u5f00\u59cb\u6240\u6709\u7684\u70b9\u90fd\u662f\u767d\u7684\uff0c\u6bcf\u6b21\u4f1a\u7b49\u6982\u7387\u9009\u62e9\u4e00\u4e2a\u9664\u4e86\u201c\u5305\u542b\u6839\u7684\u6700\u5927\u8fde\u901a\u9ed1\u70b9\u201d\u4ee5\u5916\u7684\u70b9\uff08\u53ef\u4ee5\u662f\u9ed1\u70b9\uff09\u6d82\u9ed1\uff0c\u6c42\u5230\u8fbe\u65e0\u6cd5\u64cd\u4f5c\u5730\u6b65\u7684\u671f\u671b\u6b65\u6570\uff0c$n\\le 10^5$\u3002\n\n### \u8d5b\u65f6\u601d\u8def\n\u5bf9\u4e8e\u94fe\u4e0a\u7684\u60c5\u51b5\u5199\u4e00\u4efd\u66b4\u529b\uff0c[\u4ee3\u7801](https://www.luogu.com.cn/paste/pruxyy3f)\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u524d\u51e0\u4e2a\u6570\u5206\u522b\u662f $1,5/2,13/3,77/12,87/10,223/20$\u3002\n\n\u5bf9\u6570\u5b57\u7a0d\u5fae\u6709\u70b9\u654f\u611f\u7684\u8bdd\u5c31\u53ef\u4ee5\u53d1\u73b0\u94fe\u4e0a\u7684\u7b54\u6848\u5c31\u662f\u8c03\u548c\u6570\u7684\u524d\u7f00\u548c\uff1a\n$$\\sum_{i=1}^n\\sum_{j=1}^i\\frac1j=(n+1)(H_{n+1}-1)$$\n\n\u7136\u540e\u5982\u679c\u4f60\u518d\u654f\u611f\u4e00\u70b9\u5bb9\u6613\u53d1\u73b0\uff1a\n$$5/2+13/3-1=35/6$$\n \u800c\u8fd9\u6070\u597d\u662f\u6837\u4f8b $1$ \u7684\u7b54\u6848\uff01\u6240\u4ee5\u6211\u4eec\u5c31\u6709\u4e86\u4e00\u4e2a\u7ebf\u6027\u7684\u4e71\u641e\uff0c\u4f46\u662f\u5b83\u80fd\u591f\u901a\u8fc7\u6b64\u9898\uff0c[\u4ee3\u7801](https://www.luogu.com.cn/paste/ub3btd3q)\u3002\n \n### \u5206\u6790\n\u7531\u4e8e\u671f\u671b\u5177\u6709\u7ebf\u6027\u6027\uff0c\u6211\u4eec\u8003\u8651\u6bcf\u4e2a\u8282\u70b9 $u$ \u671f\u671b\u88ab\u9009\u4e86\u591a\u5c11\u6b21\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b8c\u5168\u5ffd\u7565\u4e0d\u5728\u94fe\u4e0a\u7684\u8d21\u732e\u3002\n\n\u90a3\u4e48\u73b0\u5728\u95ee\u9898\u53d8\u6210\u4e86\u94fe\u4e0a\u7684\u60c5\u51b5\uff0c\u6700\u540e\u4e00\u4e2a\u70b9\u671f\u671b\u88ab\u9009\u4e86\u591a\u5c11\u6b21\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u770b\u4f5c\u5728\u6d82\u6ee1\u4e4b\u524d\u968f\u4fbf\u9009\u62e9\uff0c\u800c\u4e0d\u5fc5\u8003\u8651\u94fe\u4e0a\u7684\u6700\u957f\u6d82\u9ed1\u524d\u7f00\u662f\u591a\u5c11\uff08\u56e0\u4e3a\u5728\u6d82\u6ee1\u4e4b\u524d\uff0c\u6700\u540e\u4e00\u4e2a\u70b9\u603b\u662f\u574f\u7684\uff09\u3002\n- \u9009\u62e9\u4e00\u4e2a\u975e\u94fe\u4e0a\u7684\u6700\u957f\u6d82\u9ed1\u524d\u7f00\u90e8\u5206\u6d82\u9ed1\u3002\n- \u8003\u8651\u4f60\u624b\u52a8\u6267\u884c\u8fd9\u4e2a\u64cd\u4f5c \u3002\n- \u4f46\u662f\u64cd\u4f5c\u4e0d\u591f\u7cbe\u786e\uff0c\u5bfc\u81f4\u4f60\u6bcf\u6b21\u6709\u53ef\u80fd\u6d82\u9ed1\u4e00\u4e2a\u94fe\u4e0a\u7684\u6700\u957f\u6d82\u9ed1\u524d\u7f00\u3002\n- \u4e8e\u662f\u4f60\u5fc5\u987b\u6bcf\u6b21\u624b\u52a8\u64a4\u56de\u5b83\uff0c\u5f53\u7136\u8fd9\u4e0d\u4f1a\u5f71\u54cd\u671f\u671b\u6b21\u6570\u3002\n- \u7136\u540e\u4f60\u53d1\u73b0\uff0c\u4f60\u6d82\u9ed1\u4e00\u4e2a\u94fe\u4e0a\u7684\u6700\u957f\u6d82\u9ed1\u524d\u7f00\uff0c\u64a4\u56de\u4e0d\u64a4\u56de\u6ca1\u4ec0\u4e48\u4e24\u6837\uff0c\u4e5f\u4e0d\u4f1a\u5bf9\u671f\u671b\u6b21\u6570\u4ea7\u751f\u5f71\u54cd\uff0c\u4e8e\u662f\u4f60\u5e72\u8106\u4e0d\u64a4\u56de\uff0c\u4f46\u662f\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u671f\u671b\u6b21\u6570\u3002\n\n\u90a3\u4e48\u5728\u6d82\u6ee1\u4e4b\u524d\u968f\u4fbf\u9009\u62e9\u7684\u671f\u671b\u6d82\u6ee1\u6b65\u6570\u662f\u591a\u5c11\u5462\uff1f\u8fd9\u662f[\u7ecf\u5178\u95ee\u9898](https://www.luogu.com.cn/problem/SP1026)\uff0c\u7b54\u6848\u662f\uff1a\n$$n\\sum_{i=1}^n1/i=nH_n$$\n\n\u4f46\u662f\u5728\u8fd9\u4e2a\u6a21\u578b\uff0c\u6bcf\u4e2a\u70b9\u662f\u7b49\u6548\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u6700\u7ec8\u5f97\u5230\u4e86\u8fd9\u4e2a\u70b9\u88ab\u6d82\u9ed1\u7684\u671f\u671b\u6b21\u6570\uff1a$H_n$\u3002",
        "postTime": 1665359408,
        "uid": 817142,
        "name": "bai_tang",
        "ccfLevel": 0,
        "title": "\u3010\u671f\u671b\u3011\u3010\u62c6\u8d21\u732e\u3011[ARC150D]Removing Gacha"
    },
    {
        "content": "### [arc150D](https://atcoder.jp/contests/arc150/tasks/arc150_d)\n\n\u8bbe $E(X_i)$ \u4e3a $i$ \u70b9\u671f\u671b\u88ab\u9009\u4e2d\u7684\u6b21\u6570\uff0c\u90a3\u4e48 $ans=\\sum_{i=1}^nE(X_i)$\u3002\n\n\u8bbe $i$ \u70b9\u7684\u6df1\u5ea6\u4e3a $d_i$\u3002\n\n\u5982\u679c\u4e00\u6b21\u64cd\u4f5c\u9009\u4e2d\u4e86\u9664 $1$ \u5230 $i$ \u8def\u5f84\u4ee5\u5916\u7684\u7684\u70b9\uff0c\u90a3\u4e48\u5bf9 $i$ \u6ca1\u6709\u5f71\u54cd\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u8003\u8651\u9009 $1$ \u5230 $i$ \u8def\u5f84\u4e0a\u7684\u70b9\u7684\u60c5\u51b5\u3002\n\n\u5141\u8bb8\u9009\u4e2d\u597d\u70b9\uff0c\u4f46\u4e0d\u7b97\u9009\u4e2d\u597d\u70b9\u7684\u8d21\u732e\uff0c\u8fd9\u548c\u539f\u95ee\u9898\u662f\u7b49\u4ef7\u7684\u3002\n\n\u6240\u4ee5\u95ee\u9898\u53ef\u4ee5\u8f6c\u5316\u4e3a\uff0c$d_i$ \u4e2a\u70b9\uff0c\u6bcf\u6b21\u7b49\u6982\u7387\u62bd\u53d6\u4e00\u4e2a\u70b9\uff0c\u62bd\u5230\u7b2c $d_i$ \u4e2a\u70b9\u65f6\u8d21\u732e\u52a0 $1$\uff0c\u4e00\u76f4\u62bd\u76f4\u5230\u6240\u6709\u70b9\u90fd\u88ab\u62bd\u5230\u8fc7\u3002\n\n\u5047\u8bbe\u5df2\u7ecf\u88ab\u62bd\u5230\u8fc7\u7684\u70b9\u6709 $k$ \u4e2a\uff0c\u90a3\u4e48\u518d\u62bd\u4e00\u6b21\u62bd\u5230\u672a\u88ab\u62bd\u5230\u7684\u70b9\u7684\u6982\u7387\u4e3a $\\frac{d_i-k}{d_i}$\uff0c\u671f\u671b $\\frac{d_i}{d_i-k}$ \u62bd\u5230\u4e0b\u4e00\u4e2a\u672a\u88ab\u62bd\u5230\u7684\u70b9\uff08\u505a\u67d0\u4ef6\u4e8b\u60c5\u6210\u529f\u7684\u6982\u7387\u4e3a $p$\uff0c\u671f\u671b\u505a $\\frac{1}{p}$ \u6b21\u6210\u529f\uff09\u3002\n\n\u6240\u4ee5\u628a\u6240\u6709\u70b9\u90fd\u62bd\u5230\u7684\u671f\u671b\u6b21\u6570\u4e3a $\\sum_{k=0}^{d_i-1}\\frac{d_i}{d_i-k}=d_i\\sum_{k=1}^{d_i}\\frac{1}{k}$\uff0c\u6bcf\u6b21\u62bd\u5230\u7b2c $d_i$ \u4e2a\u70b9\u7684\u6982\u7387\u90fd\u662f $\\frac{1}{d_i}$\uff0c\u6240\u4ee5\u7b2c $d_i$ \u4e2a\u70b9\u671f\u671b\u88ab\u62bd\u5230 $\\sum_{k=1}^{d_i}\\frac{1}{k}$\u3002\n\n\u6240\u4ee5 $ans=\\sum_{i=1}^n\\sum_{j=1}^{d_i}\\frac{1}{j}$\u3002",
        "postTime": 1676798727,
        "uid": 571634,
        "name": "hgzxwzf",
        "ccfLevel": 7,
        "title": "AT_arc150_d"
    },
    {
        "content": "\u9996\u5148\u539f\u95ee\u9898\u7684\u671f\u671b\uff0c\u4e0e\u597d\u70b9\u4e5f\u53ef\u4ee5\u9009\uff0c\u4f46\u9009\u5230\u597d\u70b9\u4e0d\u7b97\u6b21\u6570\uff0c\u8fd9\u4e24\u4e2a\u95ee\u9898\u7684\u671f\u671b\u76f8\u540c\uff0c\u7136\u540e\u62c6\u5f00\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u5206\u522b\u8003\u8651\u3002\n\n\u8bbe $\\mathbb{E}(x)$ \u4e3a\u70b9 $x$ \u88ab\u9009\u7684\u671f\u671b\u6b21\u6570\uff0c$p_k$ \u4e3a\u70b9 $x$ \u5728\u7b2c $k$ \u6b21\u64cd\u4f5c\u88ab\u9009\u5230\u5e76\u4e14\u8fd9\u6b21\u9009\u5230\u65f6\u70b9 $x$ \u8fd8\u662f\u574f\u70b9\u7684\u6982\u7387\uff0c\u90a3\u4e48 $\\mathbb{E}(x)=\\sum\\limits_{k\\geqslant 1}{p_k}$\uff0c\u8bbe $x$ \u7684\u6df1\u5ea6\u4e3a $d$\uff0c\u8003\u8651\u5bb9\u65a5\u8ba1\u7b97 $p_k$\u3002\n\n$$\np_k=\\frac{1}{n}\\sum_{i\\geqslant 1}{\\binom{d}{i}(-1)^i\\left(\\frac{n-i}{n}\\right)^{k-1}}\n$$\n$$\n\\mathbb{E}(x) = \\sum_{k\\geqslant 1}{p_k}=\\sum_{i\\geqslant 1}{\\binom{d}{i}(-1)^i\\frac{1}{i}}=H_d\n$$\n\n\u5176\u4e2d $H_d$ \u4e3a\u8c03\u548c\u7ea7\u6570\uff0c\u8bc1\u660e\u53ef\u4ee5\u505a\u5dee\u6216\u8005\u79ef\u5206\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n)$\u3002\n\n```cpp\n/************************************************\n*Author        :  demonlover\n*Created Time  :  2022.10.12.15:47\n*Problem       :  ARC150D\n************************************************/\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <vector>\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair <int,int> pii;\ntemplate <typename T>\ninline bool read(T &x) {\n\tint f = 1,c = getchar();x = 0;\n\twhile (!isdigit(c)) {if (c == 45)f = -1;c = getchar();}\n\twhile (isdigit(c))x = (x<<3)+(x<<1)+(c^48),c = getchar();\n\treturn x *= f,true;\n}\ntemplate <typename T,typename... Args>\ninline bool read(T &x,Args &...args) {\n\treturn read(x) && read(args...);\n}\n\nnamespace run {\n\tconst int maxn = 2e5+10;\n\tconst int mod = 998244353;\n\tinline int power(int a,int b) {\n\t\tint res = 1;\n\t\twhile (b) {\n\t\t\tif (b&1)res = 1ll*res*a%mod;\n\t\t\ta = 1ll*a*a%mod;\n\t\t\tb >>= 1;\n\t\t}\n\t\treturn res;\n\t}\n\tint dep[maxn];\n\tvector <int> g[maxn];\n\tinline void dfs(int x,int fa) {\n\t\tdep[x] = dep[fa]+1;\n\t\tfor (auto y : g[x])dfs(y,x);\n\t\treturn;\n\t}\n\tint inv[maxn],h[maxn];\n\tint n,ans;\n\tinline bool main() {\n\t\tread(n);\n\t\tfor (int i = (inv[0] = inv[1] = 1)+1;i <= n;++i)inv[i] = 1ll*(mod-mod/i)*inv[mod%i]%mod;\n\t\tfor (int i = 1;i <= n;++i)h[i] = (h[i-1]+inv[i])%mod;\n\t\tfor (int i = 2,x;i <= n;++i)read(x),g[x].push_back(i);\n\t\tdfs(1,0);\n\t\tfor (int i = 1;i <= n;++i)ans = (ans+h[dep[i]])%mod;\n\t\tprintf(\"%d\\n\",ans);\n\t\treturn 0;\n\t}\n}\n\nint main() {\n#ifdef demonlover\n\tfreopen(\"ARC150D.in\",\"r\",stdin);\n\tfreopen(\"ARC150D.out\",\"w\",stdout);\n#endif\n\treturn run :: main();\n}\n\n```",
        "postTime": 1666312286,
        "uid": 152997,
        "name": "demonlover923",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011[ARC150D]Removing Gacha"
    }
]
[
    {
        "content": "### \u5145\u8981\u6761\u4ef6\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u5e8f\u5217 $(X_1,...,X_N)$ \u662f\u597d\u7684\uff0c\u5f53\u4e14\u4ec5\u5f53\uff1a\n\n- \u8bb0 $S=X_1+...+X_N$\uff0c$S$ \u662f\u5076\u6570\uff0c\u4e14 $\\forall 1\\le i\\le N,X_i+X_{i\\mod N+1}\\le \\frac{S}{2}$\u3002\n\n\u5bf9\u6700\u540e\u4e00\u4e2a\u6761\u4ef6\u5bb9\u65a5\uff0c\u7b54\u6848\u7b49\u4e8e\uff1a\u65e0\u9650\u5236\u7684\u65b9\u6848\u6570\uff0c\u51cf\u53bb\u5b58\u5728\u4e00\u4e2a\u4f4d\u7f6e\u4e0d\u6ee1\u8db3\uff0c\u518d\u52a0\u4e0a\u4e24\u4e2a\u4f4d\u7f6e\u4e0d\u6ee1\u8db3\u3002\u6ce8\u610f\u540e\u8005\u4e24\u4e2a\u4f4d\u7f6e\u4e00\u5b9a\u76f8\u90bb\u3002\n\n### \u65e0\u9650\u5236\u7684\u65b9\u6848\u6570\n\n\u8bb0 $f(x)=\\frac{1-x^{M+1}}{1-x}$\uff0c\u8fd9\u4e2a\u5e8f\u5217\u7684\u751f\u6210\u51fd\u6570\u5c31\u662f $f(x)^N$\u3002\u6240\u6c42\u4e3a\u8fd9\u4e2a\u591a\u9879\u5f0f\u4e0d\u8d85\u8fc7 $K$ \u7684\u5076\u6570\u6b21\u7cfb\u6570\u4e4b\u548c\u3002\n\n\u4e0d\u59a8\u8bbe $K$ \u4e3a\u5076\u6570\uff0c\u90a3\u4e48\u6240\u6c42\u7b49\u4e8e $[x^K]\\frac{f(x)^N}{1-x^2}$\u3002\n\n$f(x)^N$ \u7684\u4e0a\u4e0b\u6b21\u6570\u90fd\u8f83\u9ad8\uff0c\u4e0d\u5982\u5148\u6c42\u51fa $g(x)=\\frac{(1-x^{M+1})^N}{1-x^2}$\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5feb\u901f\u6c42\u51fa $[x^K]g(x)(1-x)^{-N}$ \u4e86\u3002\n\n### \u5b58\u5728\u4e00\u4e2a\u4f4d\u7f6e\u4e0d\u6ee1\u8db3\u7684\u65b9\u6848\u6570\n\n\u4e0d\u59a8\u8bbe\u4e0d\u6ee1\u8db3\u7684\u4f4d\u7f6e\u662f $1$\u3002\n\n\u679a\u4e3e $T=X_3+...+X_N$\uff0c\u5bf9 $X_1,X_2$ \u7684\u9650\u5236\u53ea\u548c $X_1+X_2$ \u6709\u5173\u3002\n\n\u6ce8\u610f\u5230 $T<2M$\uff0c\u53ef\u4ee5\u5728 $O(M^2)$ \u7684\u65f6\u95f4\u5185\u6c42\u51fa $f(x)^{N-2}$ \u7684\u524d $2M$ \u9879\uff0c\u4e5f\u5c31\u662f $X_3...X_N$ \u7684\u586b\u6cd5\u3002\n\n\u679a\u4e3e $X_1+X_2,T$ \u8ba1\u7b97\uff0c\u590d\u6742\u5ea6 $O(M^2)$\u3002\n\n### \u4e24\u4e2a\u4f4d\u7f6e\u4e0d\u6ee1\u8db3\u7684\u65b9\u6848\u6570\n\n\u4e0d\u59a8\u8bbe\u4e0d\u6ee1\u8db3\u7684\u4f4d\u7f6e\u662f $1,2$\u3002\n\n\u679a\u4e3e $X_2,T$\uff0c\n\u6240\u6c42\u4e3a $\\sum\\limits_{0\\le X_2\\le M,T}[x^T]f(x)^{N-3}h(X_2+T,X_2-T)$\u3002\n\n\u5176\u4e2d $h(a,b)=\\sum\\limits_{0\\le X_1,X_3\\le M,2|X_1+X_3+a}[X_1+X_3\\le K-a\\land |X_1-X_3|< b]$\u3002\u53ef\u4ee5\u524d\u7f00\u548c\u9884\u5904\u7406\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O((N+M)M)$\u3002",
        "postTime": 1676856076,
        "uid": 46817,
        "name": "xcyle",
        "ccfLevel": 10,
        "title": "ARC156E \u9898\u89e3"
    },
    {
        "content": "\u5f53\u5141\u8bb8\u6709 $(i,i+1)$ \u7684\u8fb9\u65f6\uff0c\u6ee1\u8db3\u9898\u76ee\u8981\u6c42\u6709\u5145\u8981\u6761\u4ef6 $S=\\sum x_i$ \u4e3a\u5076\u6570\u4e14\u4e0d\u5b58\u5728\u67d0\u4e2a $x_i>\\frac{S}{2}$\u3002\n\n\u8003\u8651\u5728\u8fd9\u4e2a\u57fa\u7840\u4e0a\u53bb\u8c03\u6574\uff0c\u5c06 $(i,i+1)$ \u7684\u8fb9\u627e\u4e2a\u6ca1\u6709\u516c\u5171\u70b9\u7684\u8fb9\u53bb\u91cd\u65b0\u9009\u8fb9\u3002\u90a3\u4e48\u5145\u8981\u6761\u4ef6\u4e3a $S=\\sum x_i$ \u4e3a\u5076\u6570\u4e14\u4e0d\u5b58\u5728\u67d0\u4e2a $x_i+x_{i+1}>\\frac{S}{2}$\u3002\u8003\u8651\u5bf9\u8fd9\u4e2a\u4e1c\u897f\u8ba1\u6570\u3002\n\n\u76f4\u63a5\u6570\u662f\u5f88\u9ebb\u70e6\u7684\uff0c\u4f46\u662f\u5982\u679c\u53bb\u5bb9\u65a5\u7684\u8bdd\uff0c\u5bb9\u6613\u53d1\u73b0\u7531\u4e8e $>\\frac{S}{2}$\uff0c\u6240\u4ee5\u9700\u8981\u8003\u8651\u7684\u60c5\u51b5\u53ea\u6709\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u5b58\u5728 $x_i+x_{i-1}>\\frac{S}{2}$\uff0c\u4e00\u79cd\u662f\u5728\u6ee1\u8db3\u524d\u9762\u4e00\u4e2a\u6761\u4ef6\u7684\u540c\u65f6\u6ee1\u8db3 $x_{i-1}+x_i>\\frac{S}{2}$\u3002\u8bbe\u524d\u9762\u7684\u60c5\u51b5\u7684\u65b9\u6848\u6570\u4e3a $B$\uff0c\u540e\u9762\u7684\u65b9\u6848\u6570\u4e3a $C$\uff0c\u603b\u7684\u65b9\u6848\u6570\u4e3a $A$\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $A-B+C$\u3002\n\n\u8003\u8651\u9010\u4e2a\u8ba1\u7b97\u3002\n\n\u5bf9\u4e8e\u603b\u65b9\u6848\u6570\uff0c\u76f8\u5f53\u4e8e\u6c42 $n$ \u4e2a $[0,m]$ \u7684\u6570\u51d1\u51fa\u6765\u7684\u548c $\\le k$ \u4e14\u4e3a\u5076\u6570\u7684\u60c5\u51b5\u3002\u6211\u9009\u62e9\u4ece\u751f\u6210\u51fd\u6570\u7684\u89d2\u5ea6\u53bb\u8003\u8651\u3002\n\n\u6bcf\u4e2a\u6570\u7684 GF \u662f $1+x+x^2+...+x^m=\\frac{1-x^{m+1}}{1-x}$\uff0c\u90a3\u4e48 $n$ \u4e2a\u6570\u4e58\u8d77\u6765\u5c31\u662f $(\\frac{1-x^{m+1}}{1-x})^n$\u3002\u628a\u5206\u5b50\u5206\u6bcd\u62c6\u5f00\uff0c\u4ee4 $F(x)=(1-x^{m+1})^n,G(x)=\\frac{1}{(1-x)^n}$\u3002\u90a3\u4e48\u6240\u6c42\u4e3a $F(x)G(x)$ \u7684 $\\le k $ \u7684\u5076\u6570\u6b21\u9879\u7684\u7cfb\u6570\u3002\n\n\u5bf9\u4e8e $F(x)$ \u8003\u8651\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u3002\n\n$$F(x)=\\sum_{i=0}^n(-1)^i\\binom{n}{i}x^{(m+1)i}$$\n\n\u800c $G(x)$ \u662f\u4e00\u4e2a\u5f88\u7ecf\u5178\u7684\u5f0f\u5b50\uff0c\u4e5f\u53ef\u4ee5\u7ec4\u5408\u610f\u4e49\u7406\u89e3\u4e3a $n$ \u4e2a\u6ca1\u6709\u9650\u5236\u7684\u503c\u51d1\u51fa\u6765\u4e00\u4e2a\u548c\u7684\u65b9\u6848\u6570\u3002\n\n$$G(x)=\\sum_{i}\\binom{i+n-1}{n-1}x^i$$\n\n\u679a\u4e3e $F(x)$ \u7684\u6bcf\u4e00\u9879\uff0c\u4e58\u4e0a $G(x)$ \u7684\u4e00\u4e2a\u524d\u7f00\u548c\u5373\u53ef\u3002\u590d\u6742\u5ea6 $O(k)$\u3002\n\n\u7136\u540e\u8fd8\u8981\u53bb\u9664 $x_i>\\frac{S}{2}$ \u7684\u60c5\u51b5\u3002\u4f46\u662f\u56e0\u4e3a $x_i\\le m$ \u6240\u4ee5 $S< 2m$\uff0c\u6240\u4ee5\u4e0d\u59a8\u76f4\u63a5\u679a\u4e3e $x$ \u548c $S$\uff0c\u5269\u4e0b\u7684\u90e8\u5206\u63d2\u677f\u5373\u53ef\uff0c\u8d21\u732e\u662f $n\\times\\binom{S-x+n-2}{n-2}$\u3002\u590d\u6742\u5ea6 $O(m^2)$\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u51fd\u6570 $Calc(n,S)$ \u8868\u793a\u7528 $n$ \u4e2a $[0,m]$ \u7684\u6570\u51d1\u51fa\u548c**\u6070\u597d**\u4e3a $s$ \u7684\u65b9\u6848\u6570\u3002\u8ba1\u7b97\u65b9\u6cd5\u4f9d\u7136\u662f $F(x)G(x)$\uff0c\u56e0\u4e3a $F(x)$ \u6bcf $m+1$ \u4f4d\u624d\u6709\u503c\uff0c\u6240\u4ee5\u8fd9\u4e2a\u590d\u6742\u5ea6\u662f $O(\\frac{S}{m})$\u3002\n\n\u5bf9\u4e8e $B$\uff0c\u4e0d\u59a8\u8bbe $x_1+x_2>\\frac{S}{2}$\u3002\u56e0\u4e3a $x_1,x_2\\le m$\uff0c\u6240\u4ee5\u6709 $S< 4m$\u3002\u6211\u4eec\u8003\u8651\u679a\u4e3e $S$ \u548c $S_1=x_1+x_2$\u3002\u7136\u540e\u8003\u8651\u628a $x_2$ \u7528 $S_1-x_1$ \u8868\u793a\uff0c\u5217\u51fa\u4e0e $x_1$ \u6709\u5173\u7684\u4e0d\u7b49\u5f0f\u3002\n\n$$0\\le x_1,S_1-x_1\\le \\min(m,\\frac{S}{2})$$\n\n$$S_1-\\max(m,\\frac{S}{2})\\le x_1\\le\\min(m,\\frac{S}{2})$$\n\n\u6709\u4e86\u8303\u56f4\uff0c\u76f4\u63a5\u7b97\u51fa $x_1$ \u7684\u60c5\u51b5\u6570\u5373\u53ef\u3002\u590d\u6742\u5ea6 $O(m^2)$\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u5176\u4ed6\u6570\u4e58\u4e0a\u4e00\u4e2a $Calc(n-2,S-S_1)$ \u5373\u53ef\u3002\u56e0\u4e3a $S<4m$\uff0c\u6240\u4ee5\u8c03\u7528\u8be5\u51fd\u6570\u7684\u590d\u6742\u5ea6\u53ef\u4ee5\u89c6\u4f5c\u5e38\u6570\u5ffd\u7565\u4e0d\u8ba1\u3002\n\n\u5bf9\u4e8e $C$\uff0c\u4e0d\u59a8\u8bbe $x_1+x_2,x_2+x_3>\\frac{S}{2}$\u3002\u540c\u7406\u6709 $S<4m$\u3002\u679a\u4e3e $S$ \u548c $S_1=x_1+x_2+x_3$\u3002\n\n\u63a5\u7740\u6211\u4eec\u8003\u8651\u5982\u679c\u6211\u4eec\u518d\u53bb\u679a\u4e3e\u4e00\u4e2a $x_2$ \u7684\u8bdd\u76f8\u5173\u7684\u4e0d\u7b49\u5f0f\u4f1a\u53d8\u6210\u4ec0\u4e48\u6837\u5b50\uff0c\u5c3d\u7ba1\u76f4\u63a5\u679a\u4e3e\u662f $O(m^3)$ \u7684\u3002\u6211\u4eec\u5c06 $x_3$ \u7528 $S_1-x_2-x_1$ \u8868\u793a\uff0c\u5217\u51fa\u5173\u4e8e $x_1$ \u7684\u4e0d\u7b49\u5f0f\u3002\n\n$$\\frac{S}{2}-x_2+1\\le x_1,S_1-x_2-x_1\\le\\min(S_1-x_2,\\frac{S}{2},m)$$\n\n\u5316\u7b80\u3002\n\n$$\\max(\\frac{S}{2}+1,S_1-\\frac{S}{2},S_1-m)-x_2\\le x_1\\le \\min(\\frac{S}{2},m,S_1-\\frac{S}{2}-1)$$\n\n\u5bb9\u6613\u53d1\u73b0\u53f3\u7aef\u70b9\u662f\u4e00\u4e2a\u5e38\u6570\uff0c\u800c\u5de6\u7aef\u70b9\u968f\u7740 $x_2$ \u589e\u52a0\u800c\u51cf\u5c11\uff0c\u90a3\u4e48 $x_1$ \u7684\u53ef\u9009\u65b9\u6848\u6570\u5c31\u6784\u6210\u4e00\u4e2a\u516c\u5dee\u4e3a 1 \u7684\u7b49\u5dee\u6570\u5217\u3002\u76f4\u63a5\u6c42\u548c\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(m^2)$\u3002\u7136\u540e\u540c\u7406\u8c03\u7528 $Calc(n-3,S-S_1)$ \u53bb\u8ba1\u7b97\u5176\u4ed6\u6570\u7684\u65b9\u6848\u6570\u3002\u590d\u6742\u5ea6\u540c\u7406\uff0c\u5ffd\u7565\u4e0d\u8ba1\u3002\n\n\u503c\u5f97\u4e00\u63d0\u7684\u662f\u7b97\u5b8c $B$ \u548c $C$ \u90fd\u8981 $\\times n$\uff0c\u539f\u56e0\u663e\u7136\u3002\n\nhttps://atcoder.jp/contests/arc156/submissions/39080070",
        "postTime": 1676948145,
        "uid": 115936,
        "name": "\u6cf7\u6cfd\u4e09\u6708",
        "ccfLevel": 0,
        "title": "ARC156E"
    }
]
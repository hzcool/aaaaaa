[
    {
        "content": "## ABC206E - Divide Both(*1745\uff09\n### Problem\n\u7ed9\u51fa $L,R$\uff0c\u95ee\u6ee1\u8db3\u4e0b\u5217\u8981\u6c42\u7684\u6570\u5bf9 $(x,y)$ \u6709\u51e0\u4e2a\uff1f\n\n+ $L\\le x,y\\le R$\n+ $\\gcd(x,y)\\not=1$\n+ $x$ \u4e0d\u662f $y$ \u7684\u500d\u6570\u5e76\u4e14 $y$ \u4e0d\u662f $x$ \u7684\u500d\u6570\n\n### Solution\n\u8003\u8651\u6761\u4ef6 $2$\uff0c\u4e0d\u59a8\u8bbe $f(w)$ \u8868\u793a\u4f7f\u5f97 $\\gcd(x,y)=w$ \u7684\u6570\u5bf9\u4e2a\u6570\uff0c\u5f88\u660e\u663e\u7b54\u6848\u5373\u4e3a $\\sum_{i=2}^R f(i)$\uff0c\u6ce8\u610f\u5230 $f(w)$ \u4ecd\u4e0d\u597d\u6c42\uff0c\u518d\u8bbe $g(w)$ \u8868\u793a\u4f7f\u5f97 $\\gcd(x,y)\\bmod w=0$ \u7684\u6570\u5bf9\u4e2a\u6570\uff0c\u5219\u6709 $f(w)=g(w)-\\sum_{i=2}^{\\lfloor \\frac R w\\rfloor}f(iw)$\uff0c\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u8ba1\u7b97 $f(i)$ \u5373\u53ef\u3002\n\n\u6c42 $g(w)$ \u5c31\u66f4\u7b80\u5355\uff0c\u6ce8\u610f\u5230 $\\forall i\\in[\\lceil \\frac {L} w\\rceil,\\lfloor \\frac R w\\rfloor],j\\in[\\lceil \\frac {L} w\\rceil,\\lfloor \\frac R w\\rfloor]$ \u90fd\u6709 $\\gcd(iw,jw)\\bmod w=0$ \u5e76\u4e14 $L\\le iw,jw\\le R$\uff0c\u90a3\u4e48\u5728\u8fd9\u4e4b\u4e2d\u4efb\u610f\u9009\u4e24\u4e2a\uff08\u53ef\u91cd\u590d\uff09\u7684\u7b54\u6848\u5373 $g(w)=(\\lfloor \\frac R w\\rfloor-\\lceil \\frac {L-1} w\\rceil)^2$\uff0c\u6ce8\u610f\u8fd9\u91cc\u662f $L-1$\uff0c\u5c31\u50cf\u524d\u7f00\u548c\u4e00\u6837\uff0c\u4e0d\u662f $L$\u3002\n\n\u8003\u8651\u6761\u4ef6 $3$\uff0c\u5148\u770b\u5982\u679c $x$ \u662f $y$ \u7684\u500d\u6570\u6216 $y$ \u662f $x$ \u7684\u500d\u6570\u7684\u4e2a\u6570\uff0c\u66b4\u529b\u679a\u4e3e $x$\uff0c\u5219 $y$ \u53ef\u4ee5\u53d6 $x,2x,3x,...,\\lfloor \\frac R x\\rfloor x$ \u5171 $\\lfloor \\frac R x\\rfloor$  \u4e2a\u6570\uff0c\u6ce8\u610f\u5230 $(x,y)$ \u548c $(y,x)$ \u7b97\u4e24\u79cd\uff0c\u4f46 $(x,x)$ \u53ea\u7b97\u4e00\u79cd\uff0c\u6240\u4ee5\u6ee1\u8db3\u6761\u4ef6\u7684\u4e2a\u6570\u4e3a $\\sum_{i=L}^R (\\lfloor \\frac R i\\rfloor\\times 2-1)$\u3002\n\n\u6ce8\u610f\u5230\u5982\u679c $x$ \u662f $y$ \u7684\u500d\u6570\u6216 $y$ \u662f $x$ \u7684\u500d\u6570\uff0c\u90a3\u4e48 $\\gcd(x,y)\\not=1$ \uff08 $x=1$ \u662f\u7279\u4f8b\uff0c\u8981\u7279\u5224\uff09\uff0c\u6240\u4ee5\u76f4\u63a5\u62ff\u4e4b\u524d\u7684\u7b54\u6848\u51cf\u53bb\u4e0a\u9762\u7684\u5f0f\u5b50\u5373\u53ef\uff0c\u4e0d\u4f1a\u6709\u591a\u4f59\u7684\uff0c\u7efc\u4e0a\u6240\u8ff0\uff0c\u7b54\u6848\u4e3a \n\n$$\\sum_{i=2}^R f(i)-\\sum_{i=L}^R (\\lfloor \\frac R i\\rfloor\\times2-1)$$\n\n\u518d\u5f3a\u8c03\u4e00\u904d\uff0c\u4e00\u5b9a\u8981\u7279\u5224\u4e00\u4e0b $x=1$\u3002\n\n### Code\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int N=1e6+7;\nint f[N];\nmain() \n{\n    int l,r,ans=0;\n    scanf(\"%lld%lld\",&l,&r);\n    for(int i=r;i>=2;i--) \n\t{\n        int w=r/i-ceil((l-1)/i);\n        f[i]=w*w;\n        for(int j=i*2;j<=r;j+=i)\n            f[i]-=f[j];\n        ans+=f[i];\n    }\n    for(int i=l;i<=r;++i) \n\t{\n        if(i==1)continue;\n        ans-=r/i*2-1;\n    }\n    printf(\"%lld\",ans);\n    return 0;\n}\n```",
        "postTime": 1666336024,
        "uid": 207412,
        "name": "xiaoPanda",
        "ccfLevel": 0,
        "title": "ABC206E"
    },
    {
        "content": "\u9996\u5148\u53bb\u6389\u4e92\u8d28\u5bf9\u3002\u8fd9\u4e2a\u76f4\u63a5\u94a6\u5b9a $\\gcd(i,j)$ \u4e3a $k$ \u7684\u500d\u6570\uff0c$f(k)$ \u4e3a $[l,r]$ \u4e2d $\\gcd(i,j)=k$ \u7684\u6570\u7684\u5bf9\u6570\uff0c\u5219\u8981\u6263\u6389 $\\gcd(i,j)\\not=k$ \u7684\u60c5\u51b5\uff0c\u6709\uff1a\n\n$$\n\\begin{aligned}\nf(k)=\\left(\\left\\lfloor\\dfrac rk\\right\\rfloor-\\left\\lfloor\\dfrac{l-1}k\\right\\rfloor\\right)^2-\\sum^{\\left\\lfloor\\frac rk\\right\\rfloor}_{i=2}f(ik)\n\\end{aligned}\n$$\n\n\u63a5\u7740\u51cf\u53bb\u4e92\u4e3a\u500d\u6570\u7684\u60c5\u51b5\uff1a\n\n$$\n\\begin{aligned}\n\\sum^r_{k=\\max(l,2)}2\\left\\lfloor\\dfrac rk\\right\\rfloor-1\n\\end{aligned}\n$$\n\n\u505a\u5b8c\u4e86\u3002\n\n# AC \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int MAXN = 1e6 + 10;\n\nint l, r;\n\nll f[MAXN], ans;\n\nint main() {\n\tscanf(\"%d%d\", &l, &r);\n\tfor (int i = r; i > 1; i--) {\n\t\tf[i] = r / i - (l - 1) / i;\n\t\tif (i >= l) ans -= r / i * 2 - 1; f[i] *= f[i];\n\t\tfor (int j = i << 1; j <= r; j += i) f[i] -= f[j]; ans += f[i];\n\t}\n\tprintf(\"%lld\", ans);\n}\n```",
        "postTime": 1682342997,
        "uid": 406941,
        "name": "Register_int",
        "ccfLevel": 6,
        "title": "ABC206E \u9898\u89e3"
    },
    {
        "content": "# [ABC206E] Divide Both \u9898\u89e3\n\n## \u9898\u610f\n\n\u7ed9\u5b9a $l,r$\uff0c\u6c42\uff1a\n\n\u8bbe $g=\\gcd(i,j)$\n\n$$ \\sum_{i=l}^r \\sum_{j=l}^r [g\\ne 1][i\\ne g][j\\ne g] $$\n\n## \u5206\u6790\n\n\u5206\u4e24\u90e8\u5206\u6c42\uff0c\u4e00\u90e8\u5206\u662f $g\\ne 1$\uff0c\u53e6\u4e00\u90e8\u5206\u662f $g\\ne i$ \u548c  $g\\ne j$\u3002\n\n\u6211\u4eec\u8fd9\u91cc\u9ed8\u8ba4 $l=\\max(2,l)$\u3002\n\n\u5f97\u5f0f\u5b50\n\n$$ \\sum_{i=l}^r \\sum_{j=l}^r [\\gcd(i,j)\\ne 1]-2\\sum_{i=l}^r \\sum_{j=l}^i [j|i]+(r-l+1) $$\n\n\u5373\n\n$$ \\sum_{k=2}^r \\sum_{i=l}^r \\sum_{j=l}^r[\\gcd(i,j)=k]-\\sum_{k=l}^r(2(\\left \\lfloor \\frac{r}{k}  \\right \\rfloor -\\left \\lfloor \\frac{l-1}{k}  \\right \\rfloor )-1)$$\n\n\u5bf9\u4e8e\u524d\u9762\u7684\uff0c\u8bb0 $l^{\\prime}=\\left \\lfloor \\frac{l-1}{k}  \\right \\rfloor ,r^{\\prime}=\\left \\lfloor \\frac{r}{k}  \\right \\rfloor $\n\n$$\n\\begin{aligned}\n\\text { \u539f\u5f0f } & =\\sum_{k=2}^{r} \\sum_{i=l^{\\prime}+1}^{r^{\\prime}} \\sum_{j=l^{\\prime}+1}^{r^{\\prime}}[\\operatorname{gcd}(i, j)=1] \\\\\n& =\\sum_{k=2}^{r} \\sum_{i=l^{\\prime}+1}^{r^{\\prime}} \\sum_{j=l^{\\prime}+1}^{r^{\\prime}} \\sum_{d|i, d|j} \\mu(d) \\\\\n& =\\sum_{k=2}^{r} \\sum_{d=1}^{r^{\\prime}} \\mu(d)\\left(\\left\\lfloor\\frac{r^{\\prime}}{d}\\right\\rfloor-\\left\\lfloor\\frac{l^{\\prime}}{d}\\right\\rfloor\\right)^2\n\\end{aligned}\n$$\n\n\u6539\u4e3a\u679a\u4e3e $T=kd$\n\n$$\n\\begin{aligned}\n\\text { \u539f\u5f0f } & =\\sum_{T=2}^{r}\\left(\\sum_{d \\neq T, d \\mid T} \\mu(d)\\right)\\left(\\left\\lfloor\\frac{r}{T}\\right\\rfloor-\\left\\lfloor\\frac{l-1}{T}\\right\\rfloor\\right)^2 \\\\\n& =\\sum_{T=2}^{r}-\\mu(T)\\left(\\left\\lfloor\\frac{r}{T}\\right\\rfloor-\\left\\lfloor\\frac{l-1}{T}\\right\\rfloor\\right)^2\n\\end{aligned}\n$$\n\n\u6240\u4ee5\u603b\u5f0f\u5b50\u4e3a\n\n$$ \\sum_{T=2}^{r}(-\\mu(T)\\left(\\left\\lfloor\\frac{r}{T}\\right\\rfloor-\\left\\lfloor\\frac{l-1}{T}\\right\\rfloor\\right)^2-[T\\geq l](2(\\left \\lfloor \\frac{r}{T}  \\right \\rfloor -\\left \\lfloor \\frac{l-1}{T}  \\right \\rfloor )+1)) $$\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\ninline int read(){\n    char ch=getchar();int x=0;bool f=1;\n    while(ch<'0'||'9'<ch){if(ch=='-')f=0;ch=getchar();}\n    while('0'<=ch&&ch<='9'){x=(x<<1)+(x<<3)+ch-'0';ch=getchar();}\n    return f?x:-x;\n}\nconst int N=1e6+2,M=8e5;\nint cnt,prime[M],mu[N];\nbool is_p[N];\nvoid init(int n){\n    mu[1]=1;\n    for(int i=2;i<=n;i++){\n        if(!is_p[i])prime[++cnt]=i,mu[i]=-1;\n        for(int j=1;j<=cnt&&i*prime[j]<=n;j++){\n            is_p[i*prime[j]]=1;\n            if(!(i%prime[j]))break;\n            mu[i*prime[j]]=-mu[i];\n        }\n    }\n}\nint l,r,ans;\nsigned main(){\n    // freopen(\".in\",\"r\",stdin);\n    // freopen(\".out\",\"w\",stdout);\n    l=read();r=read();\n    init(r);\n    for(int i=2;i<=r;i++){\n        int t=r/i-(l-1)/i;\n        ans-=t*t*mu[i]+(i>=l?(t<<1)-1,0);\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```\n## \u7ed3\u5c3e\n\n\u611f\u8c22 `@icyM3tra` \u5927\u4f6c\u63d0\u4f9b\u7684\u5e2e\u52a9\u3002\n\n\u53e6\u5916\u4ed6\u8fd8\u63d0\u5230\u4e86\u53e6\u5916\u4e00\u79cd\u65b9\u6cd5\uff1a\n\n$$ \\because \\sum_{k=1}^r \\sum_{i=l}^r \\sum_{j=l}^r [\\gcd(i,j)=k]=(r-l+1)^2 $$\n\n$$ \n\\begin{aligned}\n\\therefore &\\sum_{k=2}^r \\sum_{i=l}^r \\sum_{j=l}^r[\\gcd(i,j)=k]\\\\\n&=(r-l+1)^2-\\sum_{i=l}^r \\sum_{j=l}^r[\\gcd(i,j)=1]\n\\end{aligned}\n$$",
        "postTime": 1682341106,
        "uid": 171868,
        "name": "sunzz3183",
        "ccfLevel": 4,
        "title": "[ABC206E] Divide Both"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u5b9a\u6b63\u6574\u6570 $L,R(L\\le R\\le 10^6)$\uff0c\u6c42\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\u7684\u6b63\u6574\u6570\u5bf9 $(x,y)$ \u7684\u6570\u91cf\uff1a\n\n- $L\\le x,y\\le R$\uff1b\n- $x,y$ \u4e0d\u4e92\u8d28\uff1b\n- $x$ \u4e0d\u6574\u9664 $y$\uff0c$y$ \u4e0d\u6574\u9664 $x$\u3002\n\n## \u9898\u89e3\n\n\u7b80\u5355\u7684\u5bb9\u65a5\u3002\n\n\u6ee1\u8db3 $L\\le x,y\\le R$ \u7684\u6b63\u6574\u6570\u5bf9 $(x,y)$ \u5171\u6709 $S=(R-L+1)^2$ \u4e2a\u3002\n\n\u4ece\u4e2d\u51cf\u53bb $x,y$ \u4e92\u8d28\u7684\u5bf9\u6570\uff1a\n\n$$\\begin{aligned}S_1\n&=\\sum_{x=L}^R\\sum_{y=L}^R[\\gcd(x,y)=1]\\\\\n&=\\sum_{x=L}^R\\sum_{y=L}^R\\sum_{d|x,d|y}\\mu(d)\\\\\n\n&=\\sum_{d=1}^R\\mu(d)\\left(\\left\\lfloor\\dfrac Rd\\right\\rfloor-\\left\\lfloor\\dfrac{L-1}d\\right\\rfloor\\right)^2\\end{aligned}$$\n\n\u51cf\u53bb $x$ \u6574\u9664 $y$ \u6216 $y$ \u6574\u9664 $x$ \u7684\u5bf9\u6570\uff1a\n\n$$S_2=-(R-L+1)+2\\sum_{x=L}^R\\left\\lfloor\\dfrac Rx\\right\\rfloor$$\n\n\u518d\u52a0\u4e0a\u4e92\u8d28\u548c\u6574\u9664\u540c\u65f6\u6210\u7acb\u7684\u5bf9\u6570\uff1a  \n\uff08\u5373 $x,y$ \u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u4e3a $1$\uff09\n\n$$S_3=[L=1](2(R-L+1)-1)$$\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4e5f\u53ef\u4ee5\u91cd\u65b0\u4ee4 $L=\\max(L,2)$\uff0c\u4e0d\u5f71\u54cd\u7b54\u6848\uff0c\u4e14\u80fd\u907f\u514d\u8003\u8651\u8fd9\u79cd\u60c5\u51b5\u3002\n\n\u6700\u540e $S-S_1-S_2+S_3$ \u5373\u4e3a\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(R)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\n\nconst int l=(scanf(\"%d\",&l),l>2?l:2)-1;\nconst int r=(scanf(\"%d\",&r),r);\nint k; ll ans; int p[80005];\nstd::bitset<1000005>v; char mu[1000005];\n\ninline ll sqr(int x) { return ll(x)*x; }\nint main() {\n    for (int i=2; i<=r; ++i) {\n        if (!v[i]) v[i]=1,mu[i]=-1,p[++k]=i;\n        if (mu[i]) ans-=mu[i]*sqr(r/i-l/i);\n        for (int j=1,t; j<=k&&(t=i*p[j])<=r; ++j) {\n            v[t]=1;\n            if (i%p[j]==0) break;\n            mu[t]=-mu[i];\n        }\n    }\n    for (int i=l+1; i<=r; ++i) ans-=(r/i)<<1;\n    printf(\"%lld\\n\",ans+r-l);\n    return 0;\n}\n```",
        "postTime": 1683529804,
        "uid": 38785,
        "name": "icyM3tra",
        "ccfLevel": 0,
        "title": "[sol] [ABC206E] Divide Both"
    }
]
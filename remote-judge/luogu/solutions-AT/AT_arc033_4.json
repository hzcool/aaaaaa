[
    {
        "content": "\u8fd9\u9898\u6570\u636e\u5176\u5b9e\u53ef\u4ee5\u52a0\u5f3a\u5230 $5\\times10^6$ \u751a\u81f3 $10^7$\u2026\u2026\n\n\u8003\u8651\u4f7f\u7528\u725b\u987f\u7ea7\u6570\u5c06 $P(x)$ \u5c55\u5f00\uff1a\n\n$$\n\\begin{aligned}\nP(x)= & \\sum_{k\\leq n}c_k\\binom xk=\\sum_{k\\leq n}\\binom xk\\sum_{t}(-1)^{k-t}\\binom kt P(t)\\\\\n= & \\sum_{t\\leq n}P(t)\\sum_{t\\leq k\\leq n}\\binom xk(-1)^{k-t}\\binom kt\\\\\n = & \\sum_{t\\leq n}P(t)\\binom xt\\sum_{t\\leq k\\leq n}\\binom {x-t}{k-t}(-1)^{k-t}\n\\end{aligned}\n$$\n\n\u4f7f\u7528\u4ea4\u9519\u548c\uff1a\n$$\n\\begin{aligned}\n= & \\sum_{t\\leq n}P(t)\\binom xt\\sum_{k\\leq n-t}\\binom{x-t}k(-1)^k\\\\\n= & \\sum_{t\\leq n}P(t)\\binom xt\\binom{n-x}{n-t}\\\\\n\\end{aligned}\n$$\n\n\u7136\u540e\u4f7f\u7528\u4e0a\u6307\u6807\u53cd\u8f6c\uff1a\n$$\n\\begin{aligned}\n= & \\sum_{t\\leq n}P(t)\\binom xt\\binom{x-t-1}{n-t}(-1)^{n-t}\\\\\n\\end{aligned}\n$$\n\n\u62c6\u6210\u4e0b\u964d\u5e42\u5f62\u5f0f\uff1a\n$$\n\\begin{aligned}\n= & \\sum_{t\\leq n}(-1)^{n-t}P(t)\\frac{x^{\\underline{n+1}}}{t!(n-t)!(x-t)}\n\\end{aligned}\n$$\n\u8fd9\u4e2a\u4e1c\u897f\u662f\u53ef\u4ee5 $\\mathcal{O}(n)$ \u9884\u5904\u7406\u4e00\u4e2a\u524d\u7f00\u79ef\u548c\u540e\u7f00\u79ef\u6765\u505a\u7684\u3002\n\n```cpp\n#include<cstdio>\n\ntypedef long long ll;\nconst int maxn = 1E+5 + 5;\nconst ll mod = 1E+9 + 7;\n\nint n;\nll p[maxn], x;\nll pre[maxn], suf[maxn];\nll Fac[maxn], Inv[maxn];\n\ninline ll sig(int x) { return x & 1 ? -1 : 1; }\nll fsp(ll a, ll b, ll mod = mod, ll res = 1) {\n\tfor(a %= mod; b; a = a * a % mod, b >>= 1)\n\t\t(b & 1) && (res = res * a % mod);\n\treturn res;\n}\n\nint main() {\n\tscanf(\"%d\", &n);\n\tfor(int i = 0; i <= n; ++i)\n\t\tscanf(\"%lld\", &p[i]);\n\tscanf(\"%lld\", &x);\n\n\tif(x <= n) return printf(\"%lld\", p[x]), 0;\n\t\n\tFac[0] = 1;\n\tfor(int i = 1; i <= n; ++i)\n\t\tFac[i] = Fac[i - 1] * i % mod;\n\tInv[n] = fsp(Fac[n], mod - 2);\n\tfor(int i = n; i >= 1; --i)\n\t\tInv[i - 1] = Inv[i] * i % mod;\n\t\n\tpre[0] = 1, suf[n] = 1;\n\tfor(int i = 1; i <= n; ++i) {\n\t\tpre[i] = pre[i - 1] * (x - i + 1) % mod;\n\t\tsuf[n - i] = suf[n - i + 1] * (x - n + i - 1) % mod;\n\t}\n\t\n\tll ans = 0;\n\tfor(int i = 0; i <= n; ++i)\n\t\t(ans += Inv[i] * Inv[n - i] % mod * pre[i] % mod * suf[i] % mod * sig(n - i) * p[i]) %= mod;\n\tprintf(\"%lld\\n\", (ans + mod) % mod);\n}\n```",
        "postTime": 1604286799,
        "uid": 68265,
        "name": "whx1003",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 AT1184 \u3010\u898b\u305f\u3053\u3068\u306e\u306a\u3044\u591a\u9805\u5f0f\u3011"
    },
    {
        "content": "\u9898\u610f\u5927\u6982\u5c31\u662f\u7ed9\u51fa\u8fde\u7eed\u7684\u4e00\u6bb5$x_0$\u548c$y_0$\uff0c\u7b97\u51fa\u591a\u9879\u5f0f$F(x)$\u5728\u4e00\u4e2a\u7279\u5b9a\u503c$x_0'$\u65f6\u7684\u503c\u3002\n\n\u6211\u4eec\u6ce8\u610f\u5230$40 \\%$\u7684\u6570\u636e\u53ef\u4ee5\u76f4\u63a5\u9ad8\u6d88\uff0c\u5217\u51fa$n+1$\u4e2a\u65b9\u7a0b\u3002\n\n\u540c\u65f6\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u7528\u6734\u7d20\u7684\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u63d2\u51fa$80pts$\u7684\u597d\u6210\u7ee9\u3002\n\n\u800c\u5bf9\u4e8e$100 \\%$\u7684\u6570\u636e\uff0c$n$\u662f$1e5$\u7ea7\u522b\u7684\uff0c\u6240\u4ee5\u8003\u8651\u9884\u5904\u7406\u51fa\u4e00\u4e9b\u4e1c\u897f\u3002\n\n\u6211\u4eec\u89c2\u5bdf\u62c9\u683c\u6717\u65e5\u63d2\u503c\u516c\u5f0f\u7684\u4e00\u822c\u5f62\u5f0f\uff1a$$F(x) = \\sum \\limits _{i=0}^{N} y_i \\cdot \\prod \\limits_{i \\neq j} \\frac{x -x_j}{x_i-x_j}$$\n\n\u6211\u4eec\u53d1\u73b0\u9996\u5148\u5206\u5b50\u53ef\u4ee5$O(n)$\u9884\u5904\u7406\uff0c\u800c\u5206\u6bcd\u7531\u4e8e$x_j$\u662f\u8fde\u7eed\u7684\uff0c\u6240\u4ee5$\\rm{\\prod \\limits _{i \\neq j} x_i  - x_j}= fac(i) \\cdot fac(N-i) \\cdot evenmark(N-i)$\uff0c\u5176\u4e2d$fac$\u8868\u793a\u6c42\u9636\u4e58\uff0c$\\rm{evenmark}$\u662f\u7b26\u53f7\u51fd\u6570\uff0c\u5f53$N-i$\u662f\u5076\u6570\u65f6\u8fd4\u56de$1$\uff0c\u5426\u5219\u8fd4\u56de$-1$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u51fa\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$$F(x) = \\sum \\limits_{i=0}^{N}{y_i \\cdot}\\frac{\\frac{Pre}{x-i}}{fac(i) \\cdot fac(N-i) \\cdot evenmark(N-i)}$$\u5176\u4e2d$\\frac{Pre}{x-i}$\u7684\u7f18\u7531\u53ef\u4ee5\u53c2\u8003\u6211\u7684\u4ee3\u7801\u3002\n\n\u53d6\u6a21\u5565\u7684\u5c31\u5c0f\u8d39\u9a6c\u641e\u4e00\u641e\u5373\u53ef\uff0c\u6700\u7ec8\u590d\u6742\u5ea6$\\Theta(n \\log n)$\n\n```cpp\ninline LL expow(LL A, LL B){\n\tLL res = 1 ;\n\twhile (B){\n\t\tif (B & 1) (res *= A) %= Mod ; \n\t\tB >>= 1, (A *= A) %= Mod ;\n\t}\n\treturn res % Mod ;\n}\ninline LL get_symbol(LL x){ return (!x ? 1 : Mod - 1) ; }\nint main(){\n\tcin >> N ; Fac[0] = qwq = 1 ;\n\tfor (i = 0 ; i <= N ; ++ i)\n\t\tscanf(\"%lld\", &base[i]), (Fac[i + 1] = Fac[i] * (i + 1)) %= Mod ;\n\tcin >> T ; Ans = 0 ;\n\tif (T <= N) return printf(\"%lld\\n\", base[T]) ;\n\tfor (i = 0 ; i <= N ; ++ i) (qwq *= (T - i + Mod)) %= Mod ;\n\tfor (i = 0 ; i <= N ; ++ i){\n\t\tM = (N - i) & 1, _qwq = qwq * expow((T - i), Mod - 2) % Mod ;\n\t\tt = expow(Fac[i] * Fac[N - i] % Mod, Mod - 2) % Mod ; \n\t\tt = t * (get_symbol(M) * _qwq % Mod) % Mod, t = (t * base[i]) % Mod ;\n\t\t(Ans += t)  %= Mod ;\n//\t\tcout << Ans << endl ;\n\t}\n\tprintf(\"%lld\\n\", Ans) ; return 0 ;\n}\n```",
        "postTime": 1548766122,
        "uid": 28313,
        "name": "\u768e\u6708\u534a\u6d12\u82b1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT1184 \u3010\u898b\u305f\u3053\u3068\u306e\u306a\u3044\u591a\u9805\u5f0f\u3011"
    }
]
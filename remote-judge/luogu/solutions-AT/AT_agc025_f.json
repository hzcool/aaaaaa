[
    {
        "content": "[\u4e3a\u4e86\u66f4\u4e0d\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\uff0c\u4f60\u53ef\u4ee5\u524d\u5f80\u6211\u7684\u535a\u5ba2\u3002](http://zhylj.cc/index.php/archives/40/)\n\n## \u9898\u76ee\n\n\u6709\u4e24\u4e2a\u4e8c\u8fdb\u5236\u6570 $x,y$\uff0c\u957f\u5ea6\u5206\u522b\u4e3a $n,m$\uff0c\u4e0d\u65ad\u8fdb\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n\n- $z \\gets x \\operatorname{and} y$.\n- $x \\gets x + z,y \\gets y + z$.\n\n\u6c42 $k$ \u6b21\u64cd\u4f5c\u540e\u7684\u7ed3\u679c\u3002\n\n$1\\le n,m,k\\le 10^6$.\n\n## \u5206\u6790\n\n\u8bb0 $x_i,y_i$ \u5206\u522b\u8868\u793a $x,y$ \u4ece\u4f4e\u5f80\u9ad8\u6570\u7684\u7b2c $i$ \u4f4d\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u4e00\u6b21\u9898\u76ee\u4e2d\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u76f8\u5f53\u4e8e\u5728\u505a\u8fd9\u6837\u7684\u4e8b\uff1a\n\n- \u4ece\u5927\u5230\u5c0f\u679a\u4e3e $i$\uff0c\u5bf9 $i$ \u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c\uff0c\u79f0\u5982\u4e0b\u64cd\u4f5c\u4e3a\u64cd\u4f5c A.\n- \u82e5 $x_i=y_i=1$\uff0c\u5219\u4ee4 $x_i,y_i\\gets 0$\uff0c\u5e76\u6709 $x_{i+1}\\gets x_{i+1}+1$\uff0c$y_{i+1}\\gets y_{i+1}+1$.\n- \u8fdb\u884c\u4ece $i + 1$ \u5f00\u59cb\u7684\u8fdb\u4f4d\u64cd\u4f5c\u3002\n\n\u5176\u4e2d\uff0c\u4ece $i+1$ \u5f00\u59cb\u7684\u8fdb\u4f4d\u64cd\u4f5c\u88ab\u5b9a\u4e49\u4e3a\uff1a\n\n- \u679a\u4e3e $j = i+1,i+2,\\cdots$.\n- \u82e5 $x_j=2$\uff0c\u5219 $x_j\\gets 0$\uff0c$x_{j+1}\\gets x_{j+1}+1$.\n- \u82e5 $y_j=2$\uff0c\u5219 $y_j\\gets 0$\uff0c$y_{j+1}\\gets y_{j+1}+1$.\n- \u82e5\u4e0a\u8ff0\u6761\u4ef6\u5747\u4e0d\u6ee1\u8db3\uff0c\u505c\u6b62\u5faa\u73af\u3002\n\n\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5728\u4efb\u4f55\u4e00\u6b21\u64cd\u4f5c\u4e2d\uff0c\u82e5 $x_i=y_i=1$\uff0c\u5bf9\u5176\u8fd9\u4e00\u4f4d\u8fdb\u884c\u64cd\u4f5c A \u540e\u6709 $x_i=y_i=0$\uff08\u6b64\u65f6\u5904\u7406\u5b8c\u4e86\u6bd4 $i$ \u5927\u7684\u6240\u6709\u4f4d\u7f6e\uff0c\u4f46\u5c0f\u7684\u8fd8\u672a\u5904\u7406\uff09\uff0c\u800c $i$ \u4ee5\u524d\uff08\u4e0d\u542b\uff09\u7684\u8fdb\u4f4d\u5f15\u8d77\u7684 $x$ \u7684\u603b\u589e\u52a0\u91cf\u4e0d\u4f1a\u8d85\u8fc7 $2^i-1$\uff0c\u6240\u4ee5 $i$ \u4ee5\u524d\u7684\u8fdb\u4f4d\u81f3\u591a\u5f71\u54cd\u5230 $i$.\n\n\u6545\u5728\u4efb\u4f55\u4e00\u6b21\u64cd\u4f5c\u4e2d\uff0c\u5728\u524d\u9762\u7684 $1$ \u4e00\u5b9a\u4e0d\u4f1a\u649e\u4e0a\u5728\u540e\u9762\u7684 $1$\uff08\u5373\uff0c\u8fdb\u4f4d\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u9047\u5230 $x_i=y_i=1$\uff09\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n$$\n\\begin{matrix}\n\t1 & 0 & 0 & 1 & {\\bf 1} & 0 \\\\\n\t1 & 1 & 1 & 0 & {\\bf 1} & 0\n\\end{matrix}\n$$\n\n\u5bf9\u52a0\u7c97\u7684\u8fdb\u884c\u64cd\u4f5c A \u540e\u6709\uff1a\n\n$$\n\\begin{matrix}\n\t1 & 0 & 0 & 1 & 0 & {\\bf 1} \\\\\n\t1 & 1 & 1 & 1 & 0 & {\\bf 1}\n\\end{matrix}\n$$\n\n\u518d\u5bf9\u4f4d\u7f6e $1(x_1=y_1=1)$ \u8fdb\u884c\u64cd\u4f5c A\uff0c\u5219\u5b83\u4eec\u81f3\u591a\u524d\u8fdb\u5230\u4f4d\u7f6e $5(x_5=y_5=0)$.\n\n$$\n\\begin{matrix}\n\t0 & {\\bf 1} & 0 & 1 & 0 & {\\bf 1} \\\\\n\t0 & 0 & 0 & 0 & {\\bf 1} & {\\bf 1}\n\\end{matrix}\n$$\n\n\u4e0d\u4f1a\u5bf9\u5148\u524d\u4f4d\u8d21\u732e\u7684 $x_6=y_6=1$ \u4ea7\u751f\u5f71\u54cd\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5f97\u5230\u63a8\u8bba\uff1a\u5bf9 $i(i>j)$ \u4e00\u6b21\u6027\u8fdb\u884c $k$ \u6b21\u64cd\u4f5c A\uff0c\u518d\u5bf9 $j$ \u8fdb\u884c $k$ \u6b21\u64cd\u4f5c A \u4e0e\u5c06\u4e24\u4e2a\u4f4d\u7f6e\u8f6e\u6d41\u8fdb\u884c\u64cd\u4f5c A \u7684\u6548\u679c\u76f8\u540c\u3002\uff08\u5373\uff0c\u67d0\u4e00\u6b21\u64cd\u4f5c A \u7684\u5f71\u54cd\u4e0e\u524d\u9762\u7684\u64cd\u4f5c A \u5982\u4f55\u53d1\u751f\u65e0\u5173\uff09\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5f97\u4ee5\u4ea4\u6362\u5faa\u73af\u987a\u5e8f\uff0c\u5f97\u5230\u4ee5\u4e0b\u7b97\u6cd5\uff1a\n\n- \u4ece\u5927\u5230\u5c0f\u679a\u4e3e $i$.\n- \u8bbe\u8ba1\u6570\u5668\u53d8\u91cf $z = k$\uff0c\u7136\u540e\u679a\u4e3e $j=i,i+1,\\cdots$.\n  - \u82e5 $x_j=y_j=1$ \u4e14 $z > 0$\uff0c\u5219\u4ee4 $x_j,y_j \\gets 0$\uff0c$x_{j+1}\\gets x_{j+1} + 1$\uff0c$y_{j+1}\\gets y_{j+1}+1$\uff0c$z\\gets z-1$.\n  - \u82e5 $x_j=2$\uff0c\u5219 $x_j\\gets 0$\uff0c$x_{j+1}\\gets x_{j+1}+1$.\n  - \u82e5 $y_j=2$\uff0c\u5219 $y_j\\gets 0$\uff0c$y_{j+1}\\gets y_{j+1}+1$.\n  - \u82e5\u4e0a\u8ff0\u6761\u4ef6\u5747\u672a\u88ab\u6ee1\u8db3\uff0c\u5219\u9000\u51fa\u5185\u5c42\u5faa\u73af\u3002\n\n~~\u7136\u540e\u4f60\u53d1\u73b0\u6309\u7167\u4e0a\u9762\u8bf4\u7684\u6a21\u62df\u4ea4\u4e00\u53d1\u5c31\u8fc7\u4e86\uff0c\u867d\u7136\u5168\u662f $1$ \u90fd\u80fd\u5361\u6389\u3002~~\n\n\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u4e0a\u9762\u7684\u64cd\u4f5c\u9664\u4e86\u5f53 $x_i=y_i=1$ \u4e14 $x_{i+1}=y_{i+1}=0$ \u4ee5\u5916\uff0c\u5747\u4f1a\u5bfc\u81f4 $1$ \u7684\u6570\u91cf\u51cf\u5c11\uff0c\u6240\u4ee5\u8003\u8651\u6bcf\u6b21\u8df3\u8fc7\u65e0\u7528\u7684 $0,0$ \u6bb5\uff0c\u5373\u53ef\u5206\u6790\u5f97\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O(n)$.\n\n\u66f4\u5177\u4f53\u5730\uff0c\u518d\u679a\u4e3e $j$ \u7684\u540c\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u6808\u6309\u987a\u5e8f\u5b58\u4e0b $j$ \u4e4b\u540e\u7684\u975e $0$ \u5143\u7d20\uff0c\u7136\u540e\u6bcf\u6b21\u5f39\u6808\u8df3 $0,0$ \u6bb5\uff0c\u5e76\u518d\u5f00\u4e00\u4e2a\u6570\u7ec4\u5b58\u4e0b\u6709\u4fee\u6539\u8fc7\u7684\u70b9\uff0c\u6bcf\u4e00\u8f6e\u5185\u5c42\u5faa\u73af\u7ed3\u675f\u540e\u904d\u5386\u4e00\u904d\u4fee\u6539\u8fc7\u7684\u70b9\uff0c\u82e5\u975e $0$ \u5c31\u52a0\u56de\u6808\u91cc\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n\n```cpp\nconst int kN = 2e6 + 5;\n\nchar s[kN], t[kN];\nint n, m, k, top, t_cnt, x[kN], y[kN], st[kN], tmp[kN];\n\nint main() { \n\trd(n, m, k);\n\tscanf(\"%s%s\", s + 1, t + 1);\n\tfor(int i = 1; i <= n; ++i) x[i] = s[n - i + 1] - '0';\n\tfor(int i = 1; i <= m; ++i) y[i] = t[m - i + 1] - '0';\n\tst[++top] = std::max(n, m) + k + 1;\n\tfor(int i = std::max(n, m); i; --i) {\n\t\tfor(int z = k, j = i; ; ) {\n\t\t\twhile(top && st[top] <= j) --top;\n\t\t\ttmp[++t_cnt] = j;\n\t\t\tif(x[j] == 1 && y[j] == 1 && z) {\n\t\t\t\tint nxt = st[top];\n\t\t\t\tx[j] = y[j] = 0;\n\t\t\t\tif(z >= nxt - j) {\n\t\t\t\t\tz -= nxt - j;\n\t\t\t\t} else {\n\t\t\t\t\tnxt = j + z;\n\t\t\t\t\tz = 0;\n\t\t\t\t}\n\t\t\t\t++x[nxt]; ++y[nxt];\n\t\t\t\tj = nxt;\n\t\t\t} else if(x[j] == 2 || y[j] == 2) {\n\t\t\t\tx[j + 1] += x[j] >> 1; x[j] &= 1;\n\t\t\t\ty[j + 1] += y[j] >> 1; y[j] &= 1;\n\t\t\t\t++j;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor(int j = t_cnt; j; --j)\n\t\t\tif(x[tmp[j]] || y[tmp[j]]) st[++top] = tmp[j];\n\t\tt_cnt = 0;\n\t}\n\tn += k; m += k;\n\tfor(; !x[n]; --n); for(; !y[m]; --m);\n\tstd::reverse(x + 1, x + n + 1);\n\tstd::reverse(y + 1, y + m + 1);\n\tfor(int i = 1; i <= n; ++i)\n\t\tprintf(\"%d\", x[i]);\n\tprintf(\"\\n\");\n\tfor(int i = 1; i <= m; ++i)\n\t\tprintf(\"%d\", y[i]);\n\tprintf(\"\\n\");\n\treturn 0;\n}\n```",
        "postTime": 1615283926,
        "uid": 34238,
        "name": "zhylj",
        "ccfLevel": 9,
        "title": "\u300cAGC 025F\u300dAddition and Andition"
    },
    {
        "content": "\u9274\u4e8e\u6ca1\u6709\u8fd9\u4e2a\u4e71\u641e\u505a\u6cd5\uff0c\u6211\u6765\u4e00\u53d1\u3002\n\n\u9996\u5148\u89c2\u5bdf\u7b2c\u4e09\u4e2a\u6837\u4f8b\uff0c\u5c06\u6bcf\u4e00\u6b65\u540e $a,b$ \u7684\u503c\u90fd\u8f93\u51fa\u51fa\u6765\uff0c\u5927\u6982\u662f\u8fd9\u6837\u7684\uff1a\n```\n10100110100\n10011001110\n----------------------------------\n100100111000\n100011010010\n----------------------------------\n1000101001000\n1000011100010\n----------------------------------\n10000110001000\n10000100100010\n----------------------------------\n100001010001000\n100001000100010\n----------------------------------\n1000010010001000\n1000010000100010\n----------------------------------\n10000100010001000\n10000100000100010\n----------------------------------\n100001000010001000\n100001000000100010\n----------------------------------\n1000010000010001000\n1000010000000100010\n----------------------------------\n10000100000010001000\n10000100000000100010\n----------------------------------\n10000100000010001000\n10000100000000100010\n----------------------------------\n```\n\n\u53d1\u73b0\u4e86\u4ec0\u4e48\uff1f\u597d\u50cf\u8fd9\u4e2a\u7b54\u6848\u4e32\u591a\u8fdb\u884c\u51e0\u6b21\u64cd\u4f5c\u5c31\u53d8\u5f97\u5f88\u6709\u89c4\u5f8b\u4e86\uff01\u5177\u4f53\u662f\u4ec0\u4e48\u89c4\u5f8b\u5462\uff1f\u5c31\u662f\u8bbe\u6211\u4eec\u53d6\u4e0e\u4e4b\u540e\u5f97\u5230\u7684\u90a3\u4e2a\u4e8c\u8fdb\u5236\u4e32\u7684 $\\text{lowbit}$ \u4e3a $x$ \uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u6570 $a,b$ \u4ece\u6700\u9ad8\u4f4d\u5230 $x$ \u7684\u6bcf\u4e00\u4f4d\u4e0a\u7684\u6570\u5fc5\u5b9a\u5b8c\u5168\u76f8\u540c\uff0c\u5373\u8981\u4e48\u540c\u4e3a $1$ \uff0c\u8981\u4e48\u540c\u4e3a $0$\uff1b\u5728\u6b64\u57fa\u7840\u4e0a\u6211\u4eec\u53d1\u73b0\u6bcf\u6b21\u6309\u7167\u9898\u76ee\u6240\u7ed9\u7684\u6b65\u9aa4\u64cd\u4f5c\u5b9e\u9645\u4e0a\u662f\u5c06\u7b54\u6848\u4e32\u5206\u4e3a\u524d\u540e\u4e24\u4e2a\u90e8\u5206\uff0c\u7136\u540e\u4e0d\u65ad\u5728\u4e24\u90e8\u5206\u95f4\u52a0 $0$\u3002\n\n\u6211\u4eec\u8003\u8651\u600e\u4e48\u4f7f\u7528\u8fd9\u4e2a\u89c4\u5f8b\uff0c\u8bbe\u5f53\u524d\u5269\u4f59\u7684\u64cd\u4f5c\u6b21\u6570\u4e3a $q$ \u6b21\uff0c\u5219\u6bcf\u6b21\u5728\u7ebf\u6027\u65f6\u95f4\u5185\u6309\u7167\u4e0a\u6587\u6240\u8ff0\u5224\u5b9a\uff0c\u5982\u679c\u5224\u5b9a\u4e3a\u771f\u5219\u76f4\u63a5\u627e\u5230\u8fd9\u4e2a\u5206\u754c\u70b9\uff0c\u7136\u540e\u5f80\u540e\u9762\u52a0 $q$ \u4e2a $0$ \u5373\u53ef\u3002\n\n\u53ea\u6709\u8fd9\u4e00\u4e2a\u89c4\u5f8b\u5417\uff1f\u6211\u4eec\u89c2\u5bdf\u7b2c\u4e00\u4e2a\u6837\u4f8b\uff0c\u53d1\u73b0\u8fd9\u4e2a\u6837\u4f8b\u4e2d\u7b54\u6848\u4e32\u4e00\u5b9a\u6b21\u64cd\u4f5c\u540e\u5c31\u4e0d\u53d8\u4e86\u3002\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\u539f\u56e0\u662f\u6b64\u65f6 $a,b$ \u7684\u6309\u4f4d\u4e0e\u503c\u4e3a $0$ \u4e86\uff0c\u4e8e\u662f\u6211\u4eec\u518d\u52a0\u5165\u4e00\u4e2a\u7279\u5224\uff1a\u5f53\u4e8c\u8fdb\u5236\u6309\u4f4d\u4e0e\u503c\u4e3a $0$ \u65f6\u76f4\u63a5 \u8f93\u51fa\u7b54\u6848\u4e32\uff0c\u7136\u540e\u7ec8\u6b62\u3002\n\n\u52a0\u4e0a\u8fd9\u4e24\u4e2a\u4f18\u5316\u540e\u4f60\u53ef\u4ee5\u8bd5\u7740\u5bf9\u62cd\uff0c\u7136\u540e\u9020\u6781\u9650\u6570\u636e\u5361\uff0c\u4f60\u53d1\u73b0\u65e0\u8bba\u5982\u4f55\u90fd\u5361\u4e0d\u6389\uff0c\u7136\u540e\u5c31\u8fc7\u4e86\uff1f\n\n\u590d\u6742\u5ea6\u5148\u5495\u7740\uff0c\u6211\u4e5f\u53ea\u4f1a\u611f\u6027\u7406\u89e3\uff0c\u5c31\u59d1\u4e14\u629b\u7816\u5f15\u4e2a\u7389\u5427\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define N 3000005\n#define pb push_back\n#define fi first\n#define se second\n#define pii pair<int,int>\nusing namespace std;\nchar s[N],t[N];\nint n,m,k,a[N],b[N],c[N],tmp[N];\nvoid print(){\n\tfor(int i=n;i;i--) printf(\"%d\",a[i]); puts(\"\");\n\tfor(int i=m;i;i--) printf(\"%d\",b[i]); puts(\"\");\n\t//puts(\"----------------------------------\");\n}signed main(){\n\tfreopen(\"d.in\",\"r\",stdin);\n\tfreopen(\"d.out\",\"w\",stdout);\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tscanf(\"%s\\n%s\",s+1,t+1);\n\treverse(s+1,s+n+1),reverse(t+1,t+m+1);\n\tfor(int i=1;i<=n;i++) a[i]=s[i]-'0';\n\tfor(int i=1;i<=m;i++) b[i]=t[i]-'0';\n\twhile(k--){\n\t\tint d=0; \n\t\tfor(int i=1;i<=max(n,m)+3;i++) tmp[i]=(a[i]&b[i]);\n\t\tint sum=0; for(int i=1;i<=max(n,m)+3;i++) sum+=tmp[i];\n\t\tint r=1,fl=1; while(r<=max(n,m)&&!tmp[r]) ++r;\n\t\tif(r>max(n,m)){print(); return 0;}\n\t\tfor(int i=max(n,m);i>=r;i--){\n\t\t\tif(tmp[i]) continue;\n\t\t\tfl&=(a[i]==0&&b[i]==0);\n\t\t}if(fl){\n\t\t\tfor(int i=n;i>=r;i--) printf(\"%d\",a[i]);\n\t\t\tfor(int i=1;i<=k+1;i++) printf(\"0\");\n\t\t\tfor(int i=r-1;i;i--) printf(\"%d\",a[i]); puts(\"\");\n\t\t\tfor(int i=m;i>=r;i--) printf(\"%d\",b[i]);\n\t\t\tfor(int i=1;i<=k+1;i++) printf(\"0\");\n\t\t\tfor(int i=r-1;i;i--) printf(\"%d\",b[i]); puts(\"\");\n\t\t\treturn 0;\n\t\t}for(int i=1;i<=n;i++){\n\t\t\tc[i]=a[i]+tmp[i]+d,d=0;\n\t\t\twhile(c[i]>=2) c[i]-=2,d++;\n\t\t}if(d) c[++n]=d; d=0;\n\t\tfor(int i=1;i<=n;i++) a[i]=c[i];\n\t\tfor(int i=1;i<=m;i++){\n\t\t\tc[i]=b[i]+tmp[i]+d,d=0;\n\t\t\twhile(c[i]>=2) c[i]-=2,d++;\n\t\t}if(d) c[++m]=d; d=0;\n\t\tfor(int i=1;i<=m;i++) b[i]=c[i];\n\t\tfor(int i=1;i<=max(n,m);i++) c[i]=0; \n\t\tprint();\n\t}print(); return 0;\n}/*1000000000*/\n```\n",
        "postTime": 1663681747,
        "uid": 132040,
        "name": "S00021",
        "ccfLevel": 0,
        "title": "AGC025F"
    }
]
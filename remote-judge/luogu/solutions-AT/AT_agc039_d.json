[
    {
        "content": "_**\u201c\u5728\u8fd9\u91cc\uff0c\u4f60\u751a\u81f3\u53ef\u4ee5\u5b66\u4e60\u5e73\u9762\u51e0\u4f55\u201d**_\n\n\u6bd4\u8d5b\u7684\u65f6\u5019\u8fd9\u4e2a\u9898\u6211\u4f3c\u4e4e\u7528\u4e09\u89d2\u51fd\u6570\u7684\u6280\u5de7\u786c\u63a8\u51fa\u6765\u4e00\u4e2a\u4e0d\u77e5\u9053\u5bf9\u4e0d\u5bf9\u7684\u5f0f\u5b50\uff0c\u7136\u540e\u6ca1\u5b9e\u73b0\u5b8c...... \u7136\u540e\u53d1\u73b0\u6807\u51c6\u505a\u6cd5\u5b8c\u5168\u4e0d\u662f\u8fd9\u6837\uff09\n\n#### \u5b9a\u7406$1$: \u5982\u56fe\uff0c$A,B,C$\u5728$\\odot O$\u4e0a\uff0c\u5728$\\triangle ABC$\u4e2d\uff0c\u4f5c$\\angle BAC,\\angle ACB,\\angle CBA$\u7684\u5e73\u5206\u7ebf\uff0c\u5206\u522b\u4ea4$\\odot O$\u4e8e$F,D,E$\uff0c\u5e76\u4e14\u4e09\u6761\u89d2\u5e73\u5206\u7ebf\u4ea4\u4e8e\u4e00\u70b9$I$\uff0c\u5219$I$\u662f$\\triangle DEF$\u7684\u5782\u5fc3\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wyogzp9g.png)\n\n\u8bc1\uff1a\n\n$$\\textrm{\u8bbe}\\odot O\\textrm{\u7684\u5468\u957f\u4e3a}c$$\n\n$$\\because AF,BE,CD\\textrm{\u5206\u522b\u662f}\\angle BAC,\\angle CBA,\\angle ACB\\textrm{\u7684\u5e73\u5206\u7ebf}$$\n\n$$\\therefore \\overset{\\LARGE{\\frown}}{AE}=\\overset{\\LARGE{\\frown}}{EC}, \n\\overset{\\LARGE{\\frown}}{CF}=\\overset{\\LARGE{\\frown}}{FB},\n\\overset{\\LARGE{\\frown}}{BD}=\\overset{\\LARGE{\\frown}}{DA}$$\n\n$$\\therefore \\overset{\\LARGE{\\frown}}{EC}+\\overset{\\LARGE{\\frown}}{DF} = \\frac{1}{2}c$$ \n\n$$\\therefore \\angle EDC+\\angle DEF=90^{\\circ}$$\n\n$$\\therefore DC\\perp EF,\\textrm{\u540c\u7406\u6709}BE\\perp DF,AF\\perp ED$$\n\n$$\\therefore I\\textrm{\u662f}\\triangle DEF\\textrm{\u5782\u5fc3}$$\n\n\u8bc1\u6bd5\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u7ed3\u8bba\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u6c42\u5185\u5fc3\u8f6c\u5316\u6210\u6c42\u53e6\u4e00\u4e2a\u4e09\u89d2\u5f62\u7684\u5782\u5fc3\u4e86\u3002\u800c\u5782\u5fc3\u7684\u4f4d\u7f6e\u53ef\u4ee5\u901a\u8fc7\u91cd\u5fc3\u6765\u8f6c\u5316\u8ba1\u7b97\uff1a\n\n#### \u5b9a\u7406$2$\uff08\u6b27\u62c9\u7ebf\uff09:\u5982\u56fe\uff0c$A,B,C$\u5728$\\odot O$\u4e0a\uff0c$D,E,F$\u5206\u522b\u4e3a$AB,BC,CA$\u4e2d\u70b9\uff0c$G,H$\u5206\u522b\u4e3a$\\triangle ABC$\u7684\u91cd\u5fc3\u3001\u5782\u5fc3\uff0c\u8fde$OH$\uff0c\u5219\u6709$G$\u5728$OH$\u4e0a\uff0c\u4e14$GH=2OG$\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/thmxckn1.png)\n\n\u8bc1\uff1a\n\n$$\\textrm{\u5982\u4e0b\u56fe\uff0c\u4f5c\u76f4\u7ebf}AO\\textrm{\u4ea4}\\odot O\\textrm{\u4e8e}P,\\textrm{\u8fde}BP,PC,PE,EH,OE$$\n![](https://cdn.luogu.com.cn/upload/image_hosting/ofz82j3w.png)\n\n$$\\because AP\\textrm{\u662f\u76f4\u5f84}\\ \\therefore AB\\perp BP$$\n\n$$\\textrm{\u53c8}\\because CH\\perp AB$$\n\n$$\\therefore CH\\parallel BP,\\textrm{\u540c\u7406\u6709} CP\\parallel BH$$\n\n$$\\therefore \\textrm{\u56db\u8fb9\u5f62}BHCP\\textrm{\u662f\u5e73\u884c\u56db\u8fb9\u5f62}$$\n\n$$\\therefore BP=CH$$\n\n$$\\because CH\\parallel BP\\ \\therefore \\angle PBC=\\angle HCB$$\n\n$$\\textrm{\u53c8}\\because BE=EC$$\n\n$$\\therefore \\triangle BPE\\ \\cong \\triangle CHE$$\n\n$$\\therefore \\angle PEB=\\angle HEC\\ \\therefore P,E,H\\textrm{\u5171\u7ebf}$$\n\n$$\\therefore OE\\textrm{\u662f}\\triangle PAH\\textrm{\u4e2d\u4f4d\u7ebf}\\ \\therefore OE=\\frac{1}{2}AH$$\n\n$$\\textrm{\u8bbe}AE\\textrm{\u4e0e}OH\\textrm{\u4ea4\u4e8e}G'$$\n\n$$\\because OE\\parallel AH\\ \\therefore \\frac{OG'}{G'H}=\\frac{G'E}{AG'}=\\frac{OE}{AH}=\\frac{1}{2}$$\n\n$$\\therefore G'\\textrm{\u662f\u91cd\u5fc3}\\ \\therefore GH=2OG$$\n\n\u8bc1\u6bd5\u3002\u90a3\u4e48\u7531\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u6211\u4eec\u6709$\\overrightarrow{OH}=3\\overrightarrow{OG}$\u3002\n\n\u5728\u8fd9\u9898\u4e2d\uff0c\u5706\u5fc3$O$\u6070\u5728\u539f\u70b9\uff0c\u800c\u5e73\u9762\u4e2d\u4e09\u70b9$(x_A,y_A),(x_B,y_B),(x_C,y_C)$\u7ec4\u6210\u7684\u4e09\u89d2\u5f62\u91cd\u5fc3\u4e4b\u5750\u6807\u4e3a$(\\frac{x_A+x_B+x_C}{3},\\frac{y_A+y_B+y_C}{3})$\uff0c**\u6240\u4ee5\u5bf9\u4e8e\u4efb\u610f$\\triangle ABC$\uff0c\u4e09\u6bb5\u5f27\u4e2d\u70b9\u7684\u5750\u6807\u4e4b\u548c\uff0c\u5c31\u662f$\\triangle ABC$\u5185\u5fc3\u7684\u5750\u6807**\u3002\n\n\u7136\u540e\u968f\u4fbf\u505a\u505a\u5c31\u597d\u5566\uff01\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <algorithm>\n#include <cmath>\n#define pi 3.14159265358979323846\n\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\nconst int MAXN = 3005;\nint n,L;\nld t[MAXN],pre[2][2][MAXN][MAXN];\n\nint main()\n{\n\tcin >> n >> L;\n\tfor(int i = 1; i<=n; i++)\n\t    cin >> t[i];\n\tld ansx = 0, ansy = 0;\n\tfor(int i = 1; i<=n; i++)\n\t\tfor(int j = i+1; j<=n; j++)\n\t    {\n\t\t\tint cnt = j-i-1;\n\t\t\tld tmp = pi*(t[i]+t[j])/L;\n\t\t\tansx += cos(tmp)*(n-2*cnt-2), ansy += sin(tmp)*(n-2*cnt-2);\n\t\t}\n\tansx /= 1ll*n*(n-1)*(n-2)/6;\n\tansy /= 1ll*n*(n-1)*(n-2)/6;\n\tprintf(\"%.12lf %.12lf\\n\",(double)ansx,(double)ansy);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1585992677,
        "uid": 31098,
        "name": "Caro23333",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 AT5618 \u3010[AGC039D] Incenters\u3011"
    },
    {
        "content": "## Introduction\n\n\u5728\u8fd9\u91cc\uff0c\u4f60\u53ef\u4ee5\u540c\u65f6\u5b66\u4e60\u521d\u4e2d\u6570\u5b66\u4ee5\u53ca\u5fc5\u4fee\u4e00\u6570\u5b66\u3002\n\n## Solution\n\n\u9996\u5148\u6211\u4eec\u770b\u5230\u5185\u5fc3\uff0c\u4ed6\u662f\u89d2\u5e73\u5206\u7ebf\u7684\u4ea4\u70b9\uff0c\u662f\u5f88\u4e0d\u597d\u505a\u7684\uff0c\u600e\u4e48\u529e\u5462\uff0c\u4e09\u89d2\u5f62\u6709 $ 5 $ \u5fc3\uff0c\u6211\u4eec\u8003\u8651\u5c06\u5176\u4ed6\u51e0\u4e2a\u5fc3\u4e0e\u8fd9\u4e2a\u5185\u5fc3\u8054\u7cfb\u8d77\u6765\uff0c\u9996\u5148\u5916\u5fc3\u7684\u5750\u6807\u662f $ (0,0) $ \u662f\u663e\u7136\u7684\uff0c\u7136\u540e\u91cd\u5fc3\u5f97\u5750\u6807\u540c\u6837\u663e\u7136\u662f $ (\\frac{x_a+x_b+x_c}{3},\\frac{y_a+y_b+y_c}{3}) $\uff0c\u5782\u5fc3\u6211\u4eec\u6709\u4e00\u4e2a\u6b27\u62c9\u7ebf\uff0c\u4ed6\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u5782\u5fc3\u7684\u5750\u6807\u662f$(x_a+x_b+x_c,y_a+y_b+y_c) $\u3002\u8fd8\u6709\u4e00\u4e2a\u65c1\u5fc3\u662f\u6ca1\u6709\u7528\u5904\u7684\uff0c\u5c31\u4e0d\u7ba1\u4ed6\u4e86\u3002 \n\n\u63a5\u4e0b\u6765\u5c31\u662f\u795e\u64cd\u4f5c\u4e86\uff0c\u6211\u4eec\u8981\u5c06\u9898\u76ee\u4e2d\u7684\u5185\u5fc3\u8f6c\u5316\u6210\u4e3a\u5782\u5fc3\u3002\n\n[![77rdVe.png](https://s4.ax1x.com/2022/01/25/77rdVe.png)](https://imgtu.com/i/77rdVe)\n\n\u6211\u4eec\u5047\u8bbe $ \\triangle ABC $ \u7684\u5185\u5fc3\u4e3a $ D $\uff0c\u6211\u4eec\u628a\u4e09\u6761\u89d2\u5e73\u5206\u7ebf\u7ed9\u5f15\u51fa\u6765\uff0c\u4e3a\u4ec0\u4e48\u8981\u8fd9\u4e48\u505a\uff0c\u56e0\u4e3a $ \\frac{\\angle A+\\angle B+\\angle C}{2}=\\frac{\\pi}{2} $\uff0c\u7136\u540e\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u65b0\u7684\u4e09\u89d2\u5f62 $ \\triangle EFG $ \uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u7684\u662f:\n\n $$ \\because \\angle GEC=\\frac{1}{2}\\angle B,\\angle FEC=\\frac{1}{2}\\angle A,\\angle EGB=\\frac{1}{2}\\angle C$$\n\n$$\\therefore \\angle FEG+EGB=\\frac{\\angle A+\\angle B +\\angle C }{2}=\\frac{\\pi}{2}$$\n\n$$\\therefore \\text{\u540c\u7406\u53ef\u77e5} \\angle EFG+\\angle BGF=\\frac{\\pi}{2}$$\n\n$$\\therefore D\\text{\u662f}\\triangle EFG\\text{\u7684\u5782\u5fc3}$$\n\n\u7136\u540e\u6211\u4eec\u5c31\u628a\u95ee\u9898\u4ece\u6c42 $ \\triangle ABC $ \u7684\u5185\u5fc3\u8f6c\u6362\u6210\u4e86\u6c42 $ \\triangle EFG $ \u7684\u5782\u5fc3\u3002\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u56e0\u4e3a\u9898\u76ee\u7ed9\u6211\u4eec\u7684\u662f\u70b9\u7684\u5f27\u5ea6\uff0c\u6240\u4ee5 $ \\triangle EFG $ \u6bcf\u4e2a\u70b9\u7684\u5750\u6807\u4e5f\u662f\u53ef\u4ee5\u8f7b\u677e\u6c42\u51fa\u7684\u3002\n\n\u7136\u540e\u5c31\u662f\u5fc5\u4fee\u4e00\u7684\u5185\u5bb9\u4e86\u3002\n\n\u56e0\u4e3a\u6211\u4eec\u73b0\u5728\u7684\u505a\u6cd5\u7684\u590d\u6742\u5ea6\u662f $ O(n^3) $ \u7684\uff0c\u663e\u7136\u65e0\u6cd5\u901a\u8fc7\u6b64\u9898\u3002\n\n\u90a3\u4e48\u5f00\u59cb\u4f18\u5316\uff0c\u6211\u4eec\u5047\u8bbe\u9009\u51fa\u7684\u4e09\u4e2a\u70b9\u7684 $ T_i $ \u662f $ x,y,z $ \u3002\n\n\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u7684\u662f\u73b0\u5728\u7684\u8868\u8fbe\u5f0f\u662f\uff1a\n\n$$(\\cos(\\frac{(x+y)\\times \\pi}{L})+\\cos(\\frac{(y+z)\\times \\pi}{L})-\\cos({\\frac{(x+z)\\times \\pi}{L}}),\\sin(\\frac{(x+y)\\times \\pi}{L})+\\sin(\\frac{(y+z)\\times \\pi}{L})-\\sin({\\frac{(x+z)\\times \\pi}{L}}))$$\n\n\u6211\u4eec\u8003\u8651\u548c\u5dee\u5316\u79ef\u3002\u90a3\u4e48\u524d\u9762\u7684\u8868\u8fbe\u5f0f\u5c31\u662f\uff1a\n\n$$(-2)\\times \\sin(\\frac{(y-z)\\times \\pi}{2\\times L})\\times\\sin(\\frac{(y+x+z\\times 2)\\times \\pi}{2\\times L})=(-2)\\times \\sin(\\frac{(y-z)\\times \\pi}{2\\times L})\\times(\\sin(\\frac{(y+x)\\times \\pi}{2\\times L}))\\times \\cos(\\frac{z\\times \\pi}{L}+\\cos(\\frac{(y+x)\\times \\pi}{2\\times L}))\\times \\sin(\\frac{z\\times \\pi}{L})$$\n\n\u7136\u540e\u4e00\u4e0b\u540e\u7f00\u548c\u5c31\u597d\u4e86\u3002\n\n\u540e\u9762\u4e00\u4e2a\u5f0f\u5b50\u4e5f\u662f\u540c\u7406\uff0c\u7136\u540e\u5c31\u4f18\u5316\u5230\u4e86 $ O(n^2) $ \n\n## Code\n\n```c++\nn=read();L=read();\n\tfor (i=1;i<=n;i++)  a[i]=read();\n\ttot=n*(n-1)*(n-2)/6;\n\tfor (i=n;i>=1;i--) sufs[i]=sufs[i+1]+sin(a[i]/L*PI),sufc[i]=sufc[i+1] +cos(a[i]/L*PI);\n\tfor (A=1;A<=n-2;A++)\n\t    for (B=A+1;B<=n-1;B++)\n\t       {\n\t       \tx=x+sin((a[A]+a[B])/L*PI)*(n-B)+2*sin((a[B]-a[A])/2/L*PI)*(cos((a[A]+a[B])/2/L*PI)*sufc[B+1]-sin((a[A]+a[B])/2/L*PI)*sufs[B+1]);\n            y=y+cos((a[A]+a[B])/L*PI)*(n-B)+(-2)*sin((a[B]-a[A])/2/L*PI)*(cos((a[A]+a[B])/2/L*PI)*sufs[B+1]+sin((a[A]+a[B])/2/L*PI)*sufc[B+1]);      \n\t\t}\n\tx/=tot;y/=tot;\n\tprintf(\"%.20lf %.20lf\\n\",y,x);\n```\n\n",
        "postTime": 1643079434,
        "uid": 508480,
        "name": "Albedo",
        "ccfLevel": 0,
        "title": "AT5618 [AGC039D] Incenters"
    },
    {
        "content": "\u8fd9\u91cc\u7ed9\u4e00\u4e2a $O(n)$ \u7684\u7b97\u6cd5\u3002\n\n\u81f3\u4e8e\u51e0\u4f55\u8f6c\u5316\uff0c\u697c\u4e0a\u7684\u5de8\u4f6c\u90fd\u5df2\u7ecf\u8bb2\u7684\u5f88\u6e05\u695a\u4e86\uff0c\u6240\u4ee5\u5c31\u8bb2\u4e00\u4e0b\u600e\u4e48\u5c06 $O(n^2)$ \u7684\u7b97\u6cd5\u4f18\u5316\u6210 $O(n)$ \u7684\u7b97\u6cd5\u3002\n\n\u4ee4 $a_i=\\frac{\\pi T_i}{L}$ \uff0c\u5219 $\\begin{cases}Ans_x=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=i+1}^{n}\\cos(a_i+a_j)\\times (n-2(j-i))\\\\Ans_y=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=i+1}^{n}\\sin(a_i+a_j)\\times (n-2(j-i))\\end{cases}$\u3002\n\n\u56e0\u4e3a $\\begin{cases}\\cos(\\alpha+\\beta)=\\cos\\alpha\\cos\\beta-\\sin\\alpha\\sin\\beta\\\\\\sin(\\alpha+\\beta)=\\sin\\alpha\\cos\\beta+\\cos\\alpha\\sin\\beta\\end{cases}$\u3002\n\n\u6240\u4ee5\uff1a $\\begin{aligned}Ans_x&=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=i+1}^{n}(n+2i-2j)(\\cos a_i\\cos a_j-\\sin a_i\\sin a_j)\\\\&=\\sum\\limits_{i=1}^{n}\\cos a_i((n+2i)\\sum\\limits_{j=i+1}\\cos a_j-2\\sum\\limits_{j=i+1}^{n}j\\cos a_j)-\\sin a_i((n+2i)\\sum\\limits_{j=i+1}\\sin a_j-2\\sum\\limits_{j=i+1}^{n}j\\sin a_j)\\end{aligned}$\n\n\u4e14\uff1a $\\begin{aligned}Ans_y&=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=i+1}^{n}(n+2i-2j)(\\sin a_i\\cos a_j+\\cos a_i\\sin a_j)\\\\&=\\sum\\limits_{i=1}^{n}\\sin a_i((n+2i)\\sum\\limits_{j=i+1}\\cos a_j-2\\sum\\limits_{j=i+1}^{n}j\\cos a_j)-\\cos a_i((n+2i)\\sum\\limits_{j=i+1}\\sin a_j-2\\sum\\limits_{j=i+1}^{n}j\\sin a_j)\\end{aligned}$\n\n\u6240\u4ee5\u6211\u4eec\u7ef4\u62a4\uff1a$\\sum\\limits_{i=1}^{n}\\sin a_i$\uff0c$\\sum\\limits_{i=1}^{n}i\\sin a_i$\uff0c$\\sum\\limits_{i=1}^{n}\\cos a_i$\uff0c$\\sum\\limits_{i=1}^{n}i\\cos a_i$\uff0c\u5373\u53ef$O(n)$\u679a\u4e3e$i$\uff0c$O(1)$\u7edf\u8ba1\u7b54\u6848\u3002\n\n\u4ee3\u7801\uff1a\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\n\nconst long double pi = 3.14159265358979323846;\n\nconst int N = 3005;\n\nlong double a[N];\n\nlong double Sin1[N], Sin2[N], Cos1[N], Cos2[N];\n\nint main(){\n\tint n, l;\n\tcin >> n >> l;\n\t\n\tfor(int i = 1; i <= n; i ++)\n\t\tcin >> a[i], a[i] *= (pi / l);\n\t\n\tlong double X = 0.0, Y = 0.0;\n\t\n\tSin1[0] = Sin2[0] = Cos1[0] = Cos2[0] = 0.0;\n\tfor(int i = 1; i <= n; i ++){\n\t\tSin1[i] = Sin1[i - 1] + sin(a[i]);\n\t\tSin2[i] = Sin2[i - 1] + sin(a[i]) * i;\n\t\t\n\t\tCos1[i] = Cos1[i - 1] + cos(a[i]);\n\t\tCos2[i] = Cos2[i - 1] + cos(a[i]) * i;\n\t}\n\t\n\tfor(int i = 1; i <= n; i ++){\n\t\tX += (n + 2 * i) * cos(a[i]) * (Cos1[n] - Cos1[i]);\n\t\tX -= 2 * cos(a[i]) * (Cos2[n] - Cos2[i]);\n\t\t\n\t\tX -= (n + 2 * i) * sin(a[i]) * (Sin1[n] - Sin1[i]);\n\t\tX += 2 * sin(a[i]) * (Sin2[n] - Sin2[i]);\n\t\t\n\t\tY += (n + 2 * i) * sin(a[i]) * (Cos1[n] - Cos1[i]);\n\t\tY -= 2 * sin(a[i]) * (Cos2[n] - Cos2[i]);\n\t\t\n\t\tY += (n + 2 * i) * cos(a[i]) * (Sin1[n] - Sin1[i]);\n\t\tY -= 2 * cos(a[i]) * (Sin2[n] - Sin2[i]);\n\t}\n\t\n\tX /= (1.0 * n * (n - 1) * (n - 2) / 6);\n\tY /= (1.0 * n * (n - 1) * (n - 2) / 6);\n\t\n\tprintf(\"%.18lf %.18lf\\n\", (double)X, (double)Y);\n\t\n\treturn 0;\n}\n```\n\n\u8fd9\u4e2a\u4ee3\u7801\u5728`Luogu`\u4e0a\u7684\u63d0\u4ea4\u53ea\u6709`211 ms`\uff0c\u800c\u7b2c\u4e8c\u540d\u90fd\u6709`3 s+`\u2026\u2026",
        "postTime": 1623324788,
        "uid": 490378,
        "name": "_lyx1311_",
        "ccfLevel": 0,
        "title": "AT5618 [AGC039D] Incenters \u9898\u89e3"
    },
    {
        "content": "\u51e0\u4f55\u7ed3\u8bba 1\uff1a\u4e09\u89d2\u5f62\u7684\u5185\u5fc3\u662f\u5916\u63a5\u5706\u4e09\u6761\u5f27\u4e2d\u70b9\u5f62\u6210\u7684\u4e09\u89d2\u5f62\u7684\u5782\u5fc3\u3002\n\n\u51e0\u4f55\u7ed3\u8bba 2\uff1a\u8bbe\u4e09\u89d2\u5f62 $ABC$ \u5782\u5fc3\u4e3a $H$\uff0c\u5916\u5fc3\u4e3a $O$\uff0c\u5219$\\vec{OH}=\\vec{OA}+\\vec{OB}+\\vec{OC} $\u3002\n\n\u6709\u4e86\u8fd9\u4e24\u4e2a\u7ed3\u8bba\u4e4b\u540e\u5c31\u53ef\u4ee5\u63a8\u51fa\u7b54\u6848\u7684\u5f0f\u5b50\u3002\u8bbe $a_i=\\frac{\\pi t_i}{L}$\uff0c\u5219\u6709\n$$ansx=\\sum_{i=1}^{n} \\sum_{j=i+1}^{n}  \\sum_{k=j+1}^{n}\\cos(a_i+a_j)+\\cos(a_j+a_k)-\\cos(a_i+a_k)$$\n\n$$ansy=\\sum_{i=1}^{n} \\sum_{j=i+1}^{n}  \\sum_{k=j+1}^{n}\\sin(a_i+a_j)+\\sin(a_j+a_k)-\\sin(a_i+a_k)$$\n\n\u679a\u4e3e $i,j$ \u7136\u540e\u7b97\u8d21\u732e\uff0c\u53ef\u5f97\n$$ansx=\\sum_{i=1}^{n} \\sum_{j=i+1}^{n}\\cos(a_i+a_j)(n-2(j-i))$$\n$$ansy=\\sum_{i=1}^{n} \\sum_{j=i+1}^{n}\\sin(a_i+a_j)(n-2(j-i))$$\n\n\u6839\u636e\u4e24\u89d2\u548c\u516c\u5f0f\uff0c\u6709\n$$ansx=\\sum_{i=1}^{n} \\sum_{j=i+1}^{n}(\\cos(a_i)\\cos(a_j)-\\sin(a_i)\\sin(a_j))(n-2(j-i))$$\n$$ansy=\\sum_{i=1}^{n} \\sum_{j=i+1}^{n}(\\sin(a_i)\\cos(a_j)+\\cos(a_i)\\sin(a_j))(n-2(j-i))$$\n\n\u5206\u79bb $i,j$ \u540e\u53ef\u5f97\n$$ansx=\\sum_{i=1}^{n} \\cos(a_i) \\left( (n+2i)\\sum_{j=i+1}^{n} \\cos(a_j)-\\sum_{j=i+1}^{n} j\\cos(a_j) \\right)-\\sin(a_i)  \\left( (n+2i)\\sum_{j=i+1}^{n} \\sin(a_j)-\\sum_{j=i+1}^{n} j\\sin(a_j) \\right)$$\n$$ansy=\\sum_{i=1}^{n} \\sin(a_i) \\left( (n+2i)\\sum_{j=i+1}^{n} \\cos(a_j)-\\sum_{j=i+1}^{n} j\\cos(a_j) \\right)+\\cos(a_i)  \\left( (n+2i)\\sum_{j=i+1}^{n} \\sin(a_j)-\\sum_{j=i+1}^{n} j\\sin(a_j) \\right)$$\n\n\u7ef4\u62a4\u4e00\u4e0b $\\cos(a_i),i\\cos(a_i),\\sin(a_i),i\\sin(a_i)$ \u7684\u540e\u7f00\u548c\u5c31\u884c\u4e86\u3002\n\n\u590d\u6742\u5ea6 $O(n)$\u3002\n```cpp\n#include<bits/stdc++.h>\n#define N 401001\n#define MAX 2005\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\nconst ll mod=998244353,inf=1e18;\ninline void read(ll &ret)\n{\n\tret=0;char c=getchar();bool pd=false;\n\twhile(!isdigit(c)){pd|=c=='-';c=getchar();}\n\twhile(isdigit(c)){ret=(ret<<1)+(ret<<3)+(c&15);c=getchar();}\n\tret=pd?-ret:ret;\n\treturn;\n}\nll n,l,t[N];\ndb sufsin[N],sufisin[N],sufcos[N],suficos[N];\ndb a[N];\nsigned main()\n{\n\tread(n);\n\tread(l);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tread(t[i]);\n\t\ta[i]=t[i]*acos(-1)/l;\n\t}\n\tfor(int i=n;i;i--)\n\t\tsufsin[i]=sufsin[i+1]+sin(a[i]),sufcos[i]=sufcos[i+1]+cos(a[i]),sufisin[i]=sufisin[i+1]+i*sin(a[i]),suficos[i]=suficos[i+1]+i*cos(a[i]);\n\tdb ansx=0,ansy=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tansx+=cos(a[i])*((n+2*i)*sufcos[i+1]-2*suficos[i+1])-sin(a[i])*((n+2*i)*sufsin[i+1]-2*sufisin[i+1]);\n\t\tansy+=sin(a[i])*((n+2*i)*sufcos[i+1]-2*suficos[i+1])+cos(a[i])*((n+2*i)*sufsin[i+1]-2*sufisin[i+1]);\n\t}\n\tansx/=n*(n-1)*(n-2)/6,ansy/=n*(n-1)*(n-2)/6;\n\tprintf(\"%.12lf %.12lf\\n\",ansx,ansy);\n\texit(0);\n}\n\n```",
        "postTime": 1668557214,
        "uid": 176990,
        "name": "Celtic",
        "ccfLevel": 9,
        "title": "AGC039D"
    }
]
[
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n> \u7ed9\u51fa $n$ \u4e2a\u6570 $a_i$ \u548c $L,R$\u3002Alice \u5148\u9009\u62e9\u4e00\u4e2a\u6570 $t\\,(L \\le t \\le R)$ \u5e76\u544a\u8bc9 Bob\uff0cBob\u5728 $n$ \u4e2a\u6570\u91cc\u9009\u62e9 $k$ \u4e2a\u6570\uff0c\u8bbe\u5b83\u4eec\u7684\u548c\u4e3a $s$\u3002Alice \u60f3\u8ba9 $|t-s|$ \u6700\u5927\uff0cBob \u60f3\u8ba9 $|t-s|$ \u6700\u5c0f\uff0c\u6c42\u6700\u4f18\u7b56\u7565\u4e0b $t$ \u548c $k$ \u4e2a\u6570\u7684\u7f16\u53f7\u3002\n>\n> $0 \\le a_i \\le 300,1 \\le k\\le n \\le 600,1\\le L \\le R \\le 180000$\u3002\n\n## \u601d\u8def\n\n\u8003\u8651\u679a\u4e3e $t$\uff0c\u90a3\u4e48\u95ee\u9898\u8f6c\u5316\u4e3a\u5bf9\u4e8e\u6bcf\u4e2a $t\\,(L \\le t \\le R)$\uff0c\u6c42\u51fa $\\ge t$ \u7684 $\\min(s)$ \u4e0e $\\le t$ \u7684 $\\max(s)$\uff08\u663e\u7136\u9009\u8fd9\u4e24\u4e2a $s$ \u5176\u4e2d\u4e4b\u4e00\u662f Bob \u7684\u6700\u4f18\u7b56\u7565\uff09\u3002\n\n\u6240\u4ee5\u9700\u8981\u6c42\u51fa\u9009 $k$ \u4e2a\u6570\u53ef\u4ee5\u7ec4\u6210\u7684\u6240\u6709\u6574\u6570\u3002\u7528 bitset \u4f18\u5316\u80cc\u5305\u8f6c\u79fb\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\frac{nkV}{w})$\u3002\n\n\u95ee\u9898\u5728\u4e8e\u5982\u4f55\u6c42\u51fa $s$ \u7684\u7ec4\u6210\u65b9\u5f0f\uff08\u5373\u6c42\u51fa $k$ \u4e2a\u6570\u7684\u7f16\u53f7\uff09\u3002\n\n\u8bbe $f_{i,j,k}$ \u8868\u793a\u524d $i$ \u4e2a\u6570\u4e2d\u9009\u4e86 $j$ \u4e2a\uff0c\u548c\u662f\u5426\u80fd\u4e3a $k$\u3002\u89c2\u5bdf\u5230\u5f53 $j,k$ \u4e00\u5b9a\u65f6\uff0c\u6211\u4eec\u53ea\u5173\u5fc3\u6ee1\u8db3 $f_{i,j,k}=1$ \u7684\u6700\u5c0f\u7684 $i$\u3002 \n\n\u6240\u4ee5\u8bbe $Fir_{j,k}$ \u8868\u793a\u6ee1\u8db3 $f_{i,j,k}=1$ \u7684\u6700\u5c0f\u7684 $i$\uff0cbitset\u8f6c\u79fb\u7684\u540c\u65f6\u5904\u7406\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define il inline\nusing namespace std;\nconst int maxn=610;\nconst int maxv=180010;\nconst int inf=1<<30;\nbitset<maxv>f[maxn],g[maxn],t;\nint Fir[maxn][maxv],a[maxn];\nint n,k,S,L,R,ans;\nvector<int>v;\nint main(){\n\tscanf(\"%d%d\",&n,&k);\n\tscanf(\"%d%d\",&L,&R);\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%d\",&a[i]),S+=a[i];\n\tf[1][a[1]]=1,f[0][0]=1;\n\tFir[1][a[1]]=1,Fir[0][0]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tfor(int j=0;j<=min(i,k);j++)\n\t\t\tif(j) g[j]=f[j]|(f[j-1]<<a[i]);\n\t\t\telse g[j]=f[j];\n//\t\tfor(int u=1;u<=S;u++) cout<<g[2][u]<<\" \";\n//\t\t\tprintf(\"\\n\");\n\t\tfor(int j=0,pos;j<=min(i,k);j++){\n\t\t\tt=g[j]^f[j];\n//\t\t\tfor(int u=1;u<=S;u++) cout<<f[j][u]<<\" \";\n//\t\t\tprintf(\"\\n\");\n//\t\t\tfor(int u=1;u<=S;u++) cout<<t[u]<<\" \";\n//\t\t\tprintf(\"\\n\");\n\t\t\twhile(t.any())\n\t\t\t\tFir[j][pos=t._Find_first()]=i,t[pos]=0;\n\t\t}\n\t\tfor(int j=0;j<=min(i,k);j++) f[j]=g[j];\n\t}\n\tfor(int i=1;i<=S;i++)\n\t\tif(f[k][i]) v.push_back(i);\n\tint t,s=-1,val;\n\tfor(int i=L,v1,v2;i<=R;i++){\n\t\tif(v[0]>i) v1=-inf;\n\t\telse v1=(*(upper_bound(v.begin(),v.end(),i)-1));\n\t\tif(v[v.size()-1]<i) v2=inf;\n\t\telse v2=(*lower_bound(v.begin(),v.end(),i));\n\t\tif(min(i-v1,v2-i)>s) s=min(i-v1,v2-i),t=i,val=(i-v1<v2-i?v1:v2);\n\t}printf(\"%d\\n\",t);\n\tfor(int i=k,sum=val;i;i--)\n\t\tprintf(\"%d \",Fir[i][sum]),sum-=a[Fir[i][sum]];\n\tprintf(\"\\n\");\n\treturn 0;\n} \n```\n\n\u8be5\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\frac{nkV}{w})$\uff0c\u76f4\u63a5\u8ba1\u7b97\u7684\u8bdd\u5927\u7ea6\u662f 1e9\uff0c\u5e76\u4e14\u5728 $k$ \u8db3\u591f\u5927\u7684\u60c5\u51b5\u4e0b\u80fd\u8f7b\u677e\u8dd1\u6ee1\uff0c\u6548\u7387\u592a\u4f4e\uff0c\u5e76\u4e0d\u80fd\u901a\u8fc7\u6b64\u9898\u3002\u8003\u8651\u8fdb\u4e00\u6b65\u4f18\u5316\u5e38\u6570\u3002\n\n\u89c2\u5bdf\u5230\u6548\u7387\u7684\u74f6\u9888\u5728\u4e8ebitset\u4e4b\u95f4\u7684\u8fd0\u7b97\uff0c\u6bcf\u6b21\u90fd\u4f1a\u5bf9 $\\max V$ \u4e2a\u5143\u7d20\u8fdb\u884c\u8f6c\u79fb\u3002\u4f46\u8fd9\u5176\u4e2d\u6709\u5927\u90e8\u5206\u8f6c\u79fb\u90fd\u662f\u5197\u4f59\u7684\u3002\n\n\u8003\u8651\u6539\u53d8\u8f6c\u79fb\u987a\u5e8f\uff0c\u679a\u4e3e\u8f6c\u79fb\u5230\u7684\u4e0b\u6807\u4ee5\u53ca\u603b\u548c\uff0c\u7528bitset\u8f6c\u79fb\u9009\u51fa\u6570\u7684\u4e2a\u6570\uff0c\u8fd9\u6837\u5c31\u80fd\u53bb\u9664\u6389 $\\max V$ \u4e2d\u7684\u5197\u4f59\u5143\u7d20\u4e86\u3002\n\n\u5177\u4f53\u65b9\u6cd5\u662f\u628a $a_i$ \u6392\u5e8f\uff0c\u7ef4\u62a4\u4ee5\u6bcf\u4e2a $i$ \u7ed3\u5c3e\u7684\u8fde\u7eed $k$ \u4e2a\u5143\u7d20\u7684\u503c $pre_i$\uff08\u5373\u8f6c\u79fb\u5230\u7b2c $i$ \u4e2a\u6570\u65f6\uff0c\u603b\u548c\u7684\u4e0a\u754c\uff09\uff0c\u6bcf\u6b21\u679a\u4e3e\u603b\u548c\u7684\u65f6\u5019\u679a\u4e3e\u5230 $pre_i$ \u5373\u53ef\u3002\n\n\u4f18\u5316\u540e\u6548\u7387\u63d0\u5347\u7ea6 $5$ \u500d\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(2)\n#pragma GCC optimize(3)\n#define il inline\nusing namespace std;\nconst int maxn=610;\nconst int maxv=180001;\nconst int inf=1<<30;\nbitset<maxn>f[maxv],g[maxv],t;\nint Fir[maxn][maxv];\nint pre[maxn];\npair<int,int>a[maxn]; \nint n,k,S,L,R;\nvector<int>v;\nint main(){\n\tscanf(\"%d%d\",&n,&k);\n\tscanf(\"%d%d\",&L,&R);\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%d\",&a[i].first),a[i].second=i,S+=a[i].first;\n\tsort(a+1,a+1+n);\n\tfor(int i=1;i<=n;i++){\n\t\tpre[i]=pre[i-1]+a[i].first;\n\t\tif(i-k>0) pre[i]-=a[i-k].first;\n\t}\n\tf[a[1].first][1]=1,f[0][0]=1;\n\tFir[1][a[1].first]=1,Fir[0][0]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tfor(int j=0;j<=pre[i];j++)\n\t\t\tif(j>=a[i].first) g[j]=f[j]|(f[j-a[i].first]<<1);\n\t\t\telse g[j]=f[j];\n\t\tfor(int j=0,pos;j<=pre[i];j++){\n\t\t\tt=g[j]^f[j];\n\t\t\twhile(t.any())\n\t\t\t\tFir[pos=t._Find_first()][j]=i,t[pos]=0;\n\t\t}\n\t\tfor(int j=0;j<=pre[i];j++) f[j]=g[j];\n\t}\n\tfor(int i=1;i<=S;i++)\n\t\tif(f[i][k]) v.push_back(i);\n\tint t,s=-1,val;\n\tfor(int i=L,v1,v2;i<=R;i++){\n\t\tif(v[0]>i) v1=-inf;\n\t\telse v1=(*(upper_bound(v.begin(),v.end(),i)-1));\n\t\tif(v[v.size()-1]<i) v2=inf;\n\t\telse v2=(*lower_bound(v.begin(),v.end(),i));\n\t\tif(min(i-v1,v2-i)>s) s=min(i-v1,v2-i),t=i,val=(i-v1<v2-i?v1:v2);\n\t}printf(\"%d\\n\",t);\n\tfor(int i=k,sum=val;i;i--)\n\t\tprintf(\"%d \",a[Fir[i][sum]].second),sum-=a[Fir[i][sum]].first;\n\tprintf(\"\\n\");\n\treturn 0;\n} \n```\n\n\n\n",
        "postTime": 1669869879,
        "uid": 288716,
        "name": "lzqy_",
        "ccfLevel": 7,
        "title": "AT_icpc2015spring_b Card Game Strategy \u9898\u89e3"
    }
]
[
    {
        "content": "\u4ee4 $n = 2N$\u3002\n\n\u628a\u5706\u4e0a\u770b\u6210\u5e8f\u5217\u4e0a\u4e5f\u53ef\u4ee5\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c $[l_1, r_1]$ \u548c $[l_2, r_2]$ \u76f8\u4ea4\u4f46\u4e0d\u5305\u542b\uff0c\u90a3\u4e48\u8f6c\u5316\u5230\u5706\u4e0a\u4ed6\u4eec\u5c31\u662f\u76f8\u4ea4\u7684\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\uff0c\u8ba1\u7b97\u5b83\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u6b21\u6570\uff0c\u52a0\u8d77\u6765\u5c31\u662f\u7b54\u6848\u3002\n\n\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u8fde\u901a\u5757\u5728\u5e8f\u5217\u4e0a\u4e00\u5b9a\u5bf9\u5e94\u4e86\u4e00\u4e2a\u533a\u95f4\uff0c\u6ee1\u8db3\u8fde\u901a\u5757\u5b8c\u5168\u5728\u8fd9\u4e2a\u533a\u95f4\u5185\uff0c\u800c\u4e14\u533a\u95f4\u7aef\u70b9\u5c5e\u4e8e\u8fde\u901a\u5757\u3002\n\n\u4f46\u662f\u8981\u6ce8\u610f\u5e76\u4e0d\u662f\u8fd9\u4e2a\u533a\u95f4\u5185\u5168\u90fd\u662f\u8fd9\u4e2a\u8fde\u901a\u5757\uff0c\u53ef\u80fd\u5176\u4e2d\u8fd8\u6709\u5c0f\u8fde\u901a\u5757\u3002\n\n\u5219\u4ee4 $dp(i, j)$ \u8868\u793a\u533a\u95f4 $[i, j]$ \u5185\u4efb\u610f\u8fde\u8fb9\uff0c\u4e14 $i, j$ \u5728\u540c\u4e00\u8fde\u901a\u5757\u5185\u7684\u533a\u95f4\u5185\u8fde\u8fb9\u65b9\u6848\u6570\u3002\n\n\u679a\u4e3e\u8fd9\u4e2a\u533a\u95f4 $[i, j]$\uff0c\u5b83\u7684\u957f\u5ea6\u4e00\u5b9a\u4e3a\u5076\u6570\u3002\u5219\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u533a\u95f4\u5185\u7684\u70b9\u4e0d\u80fd\u5411\u533a\u95f4\u5916\u8fde\u8fb9\uff0c\u8fd9\u662f\u6709\u5229\u4e8e\u7edf\u8ba1\u7684\u3002\n\n\u5982\u679c\u533a\u95f4\u5185\u4efb\u610f\u8fde\u8fb9\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u5c31\u662f $dp(i, j) = g(c(i, j))$\u3002  \n\u5176\u4e2d $g(x)$ \u8868\u793a $x$ \u4e2a\u70b9\u7684\u73af\u4efb\u610f\u8fde\u8fb9\u7684\u65b9\u6848\u6570\uff0c\u5f53 $x$ \u4e3a\u5076\u6570\u65f6\u7b49\u4e8e $1 \\cdot 3 \\cdot 5 \\cdot \\cdots \\cdot (x - 1)$\uff0c\u5426\u5219\u4e3a $0$\u3002  \n\u800c $c(i, j)$ \u4e3a $[i, j]$ \u5185\u8fd8\u6ca1\u786e\u5b9a\u8fde\u8fb9\u60c5\u51b5\u7684\u70b9\u7684\u4e2a\u6570\u3002\n\n\u4f46\u662f\u8fd8\u6709\u7b2c\u4e8c\u4e2a\u6761\u4ef6\uff0c\u5c31\u662f $i, j$ \u5728\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u5185\u3002\u8003\u8651\u5bb9\u65a5\uff0c\u5982\u679c\u4e0d\u5728\uff0c\u679a\u4e3e $i$ \u8fde\u901a\u5757\u7684\u533a\u95f4\u53f3\u7aef\u70b9 $k$\u3002\n\n\u6709 $\\displaystyle dp(i, j) = g(c(i, j)) - \\sum_{k = i}^{j - 1} dp(i, k) \\cdot g(c(k + 1, j))$\u3002\n\n\u6700\u540e\u6c42\u51fa\u6240\u6709 $dp(i, j)$ \u540e\uff0c\u5c31\u6709\u7b54\u6848\u7b49\u4e8e $\\displaystyle \\sum dp(i, j) \\cdot g(n - 2K - c(i, j))$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O (n^3)$\uff0c[\u8bc4\u6d4b\u94fe\u63a5](https://atcoder.jp/contests/agc028/submissions/10394841)\u3002",
        "postTime": 1582923137,
        "uid": 10703,
        "name": "\u5c0f\u7c89\u5154",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 AT4438 \u3010[AGC028D] Chords\u3011"
    },
    {
        "content": "\n\u6807\u7b7e: \u8bb0\u6570.\n\n\u8bb0\u8fb9 $i$ \u8868\u793a\u70b9 $i$ \u6240\u5904\u7684\u8fb9, $to_i$ \u8868\u793a\u8fb9 $i$ \u7684\u53e6\u4e00\u4e2a\u7aef\u70b9.\n\n\u8bbe $f_{l,r}$ \u8868\u793a $l, r$ \u5904\u4e8e\u540c\u4e00\u4e2a\u8054\u901a\u5757\u5e76\u4e14 $\\forall x\\in[l,r]$ , $to_x\\in[l,r]$ \u7684\u65b9\u6848\u6570, \u663e\u7136\u4e00\u4e2a\u8fde\u901a\u5757\u4ec5\u5bf9\u5e94\u552f\u4e00\u4e00\u4e2a\u8fd9\u6837\u7684 $l,r$, \u79f0 $(l,r)$ \u4e3a\u8fd9\u4e2a\u8fde\u901a\u5757\u7684**\u5173\u952e\u70b9\u5bf9**, $g_i$ \u8868\u793a $2_i$ \u4e2a\u70b9\u968f\u610f\u8fde\u7684\u65b9\u6848\u6570, $h(l,r)$ \u8868\u793a $[l,r]$ \u5185\u6ca1\u6709\u88ab\u94a6\u5b9a\u7684\u70b9\u6570.\n\n\u7edf\u8ba1\u7b54\u6848\u5c31\u5f88\u597d\u505a\u4e86 $Ans=\\sum_{i,j}f_{i,j}g_{(h(1,l-1)+h(r+1,2n))}$.\n\n$g_i$ \u5f88\u597d\u6c42: $g_i=\\prod_{j=1}^i(2j-1)$ .\n\n$f_{l,r}$ \u5176\u5b9e\u4e5f\u5f88\u597d\u60f3, \u5bb9\u65a5\u4e00\u4e0b, \u5c06 $[l,r]$ \u5185\u7684\u70b9\u968f\u4fbf\u8fde, \u51cf\u53bb $l,r$ \u4e0d\u4e3a\u5173\u952e\u70b9\u5bf9\u7684\u60c5\u51b5\u5c31\u597d\u4e86. \u679a\u4e3e $x\\in(l,r)$ , \u5f3a\u5236 $(l,x)$ \u4e3a\u5173\u952e\u70b9\u5bf9, \u5269\u4e0b\u7684\u8fb9\u968f\u4fbf\u8fde\u5373\u53ef.\n\n$f_{l,r}=g_{h(l,r)}-\\sum_{x=l+1}^{r-1}f_{l,x}g_{h(x+1,r)}$.\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^3)$.\n\n```cpp\n#include <bits/stdc++.h>\n#define mod 1000000007\nusing namespace std;\nint read();\nvoid Add(int &x, int y) { (x += y) >= mod ? x -= mod : x; }\nint n, k;\nint vis[1003];\nint f[1003][1003], g[1003], lim = 1000;\nint pre[1003];\nint h(int l, int r) { return pre[r] - pre[l - 1]; }\n\nint fsp(int bs, int p) {\n    int rt = 1;\n    while (p) {\n        if (p & 1) rt = 1ll * rt * bs % mod;\n        bs = 1ll * bs * bs % mod, p >>= 1;\n    }\n    return rt;\n}\n\nvoid init() {\n    g[0] = 1;\n    for (int i = 1; i <= lim; ++i) g[i] = 1ll * g[i - 1] * ((i << 1) - 1) % mod;\n}\n\nint res;\n\nvoid solve(int l, int r) {\n    for (int x = l; x <= r; ++x)\n        if (vis[x] && (vis[x] < l || vis[x] > r)) return;\n    f[l][r] = g[h(l, r) >> 1];\n    for (int x = l + 1; x < r; ++x)\n        Add(f[l][r], mod - 1ll * f[l][x] * g[h(x + 1, r) >> 1] % mod);\n    Add(res, 1ll * f[l][r] * g[h(1, l - 1) + h(r + 1, n << 1) >> 1] % mod);\n}\n\nint main() {\n    n = read(), k = read(), init();\n    for (int t = 1, u, v; t <= k; ++t)\n        u = read(), v = read(), vis[u] = v, vis[v] = u;\n\n    for (int i = 1; i <= 2 * n; ++i) pre[i] = pre[i - 1] + (!vis[i]);\n\n    for (int l = 1; l <= 2 * n; ++l)\n        for (int r = l + 1; r <= 2 * n; ++r)\n            !((h(l, r) & 1) || (r - l + 1 & 1)) ? solve(l, r) : void();\n    printf(\"%d\\n\", res);\n    return 0;\n}\nconst int _SIZE = 1 << 22;\nchar ibuf[_SIZE], *iS = ibuf, *iT = ibuf;\n#define gc                                                         \\\n    (iS == iT ? iT = ((iS = ibuf) + fread(ibuf, 1, _SIZE, stdin)), \\\n     (iS == iT ? EOF : *iS++) : *iS++)\nint read() {\n    int x = 0, f = 1;\n    char c = gc;\n    while (!isdigit(c)) f = (c == '-') ? -1 : f, c = gc;\n    while (isdigit(c)) x = x * 10 + c - '0', c = gc;\n    return x * f;\n}\n```",
        "postTime": 1582105469,
        "uid": 51237,
        "name": "Kinandra",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT4438 \u3010[AGC028D] Chords\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c \u6309\u7167boshi\u5de8\u4f6c\u7684\u8bf4\u6cd5\uff0c \u8003\u8651\u6bcf\u79cd\u8054\u901a\u5757\u7684\u51fa\u73b0\u6b21\u6570\u3002\u5982\u679c\u53ef\u4ee5\u6c42\u51fa\uff0c \u7b54\u6848\u5c31\u662f\u6bcf\u79cd\u8054\u901a\u5757\u7684\u51fa\u73b0\u6b21\u6570\u548c\u3002\n\n\u518d\u6309\u7167boshi\u5de8\u4f6c\u7684\u8bf4\u6cd5\uff0c \u4e00\u79cd\u5b9a\u4e49\u8054\u901a\u5757\u957f\u76f8\u7684\u65b9\u6cd5\u662f\u7528\u7f16\u53f7\u6700\u5c0f\u7684\u70b9\u548c\u7f16\u53f7\u6700\u5927\u7684\u70b9\u8868\u793a\u3002\n\n\u4e8e\u662f\u8bbe$f[l][r]$\u4e3a$l, r$\u8fde\u901a\u4e14\u5916\u9762\u7684\u70b9\u4e0d\u8fde\u63a5\u5230\u91cc\u9762\u7684\u70b9\uff0c \u91cc\u9762\u7684\u6240\u6709\u8fb9\u90fd\u4efb\u610f\u8fde\u63a5\u7684\u65b9\u6848\u6570\u3002\n\n\u7531\u4e8e$l, r$\u8fde\u901a\u4e0d\u662f\u5f88\u597d\u505a\uff0c \u6240\u4ee5\u5c31\u7528\u4efb\u610f\u8fde\u7684\u65b9\u6848\u6570\u76ee\u51cf\u53bb\u8fde\u901a\u7684\u65b9\u6848\u6570\u76ee\u3002\n\n\u8bbe$g[l][r]$\u4e3a$[l, r]$\u5185\u7684\u70b9\u4efb\u610f\u8fde\u63a5\u7684\u65b9\u6848\u6570\u76ee\uff0c \u6709\uff1a\n\n$f[l][r] = g[F(l, r)] - \\sum f[l][k] \\times g[F(k +  1, r)]$\n\n$F(l, r)$ \u6307$[l, r]$\u4e4b\u95f4\u6ca1\u6709\u88ab\u5f3a\u5236\u9009\u7684\u70b9\u6570\u3002\n\n\u90a3\u4e48\u663e\u7136\u8fd9\u4e2a\u65b9\u7a0b\u5c31\u662f\u5728\u679a\u4e3e\u672c\u533a\u95f4\u9760\u5de6\u7684\u8fde\u901a\u5757\u7684\u5927\u5c0f\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u7684\u4e8b\u5b9e\u662f\uff0c \u5408\u6cd5\u7684$f[l][r]$\u533a\u95f4\u7684\u957f\u5ea6\u4e00\u5b9a\u662f\u4e2a\u5076\u6570\u3002 \u7136\u540e$dp$\u524d\u6ce8\u610f\u5904\u7406\u4e00\u4e0b\u8fd9\u4e2a\u533a\u95f4\u662f\u5426\u6709\u8fde\u63a5\u5230\u5916\u9762\u53bb\u7684\u70b9\u5c31\u597d\u4e86\u3002\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <cstring>\n#include <algorithm>\n#include <iostream>\n\nusing namespace std;\n\n#define R register\nconst int N = 600 + 5;\nconst int P = 1e9 + 7;\n\ninline int read() {\n\tint x = 0, f = 1; char a = getchar();\n\tfor(; a > '9' || a < '0'; a = getchar()) if(a == '-') f = -1;\n\tfor(; a >= '0' && a <= '9'; a = getchar()) x = x * 10 + a - '0';\n\treturn x * f;\n}\n\nint n, m;\nint g[N], fb[N], to[N];\nint f[N][N];\n\ninline int F(int l, int r) {\n\treturn r - l + 1 + fb[l - 1] - fb[r];\n}\n\nint main() {\n\t#ifdef IN\n\t//freopen(\".in\", \"r\", stdin);\n\t//freopen(\".out\", \"w\", stdout);\n\t#endif\n\tn = read(); m = read(); n <<= 1;\n\tfor(R int i = 1; i <= m; i ++) {\n\t\tint x = read(), y = read();\n\t\tfb[x] = fb[y] = 1;\n\t\tto[x] = y; to[y] = x;\n\t}\n\tfor(R int i = 1; i <= n; i ++) fb[i] += fb[i - 1];\n\tg[0] = 1;\n\tfor(R int i = 2; i <= n; i += 2) g[i] = 1LL * g[i - 2] * (i - 1) % P;\n\tint ans = 0;\n\tfor(R int i = 1; i <= n; i ++) \n\t\tfor(R int j = i; j <= n; j ++)\n\t\t\tif((j - i) & 1) {\n\t\t\t\tbool flg = 0;\n\t\t\t\tfor(R int k = i; k <= j; k ++)\n\t\t\t\t\tif(to[k] && (to[k] < i || to[k] > j)) flg = 1;\n\t\t\t\tif(flg) continue;\n\t\t\t\tf[i][j] = g[F(i, j)];\n\t\t\t\tfor(R int k = i + 1; k < j; k ++)\n\t\t\t\t\tf[i][j] = (f[i][j] - 1LL * f[i][k] * g[F(k + 1, j)] % P + P) % P;\n\t\t\t\tans = (ans + 1LL * f[i][j] * g[F(1, i - 1) + F(j + 1, n)] % P) % P;\n\t\t\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```\n\n\n\n```",
        "postTime": 1602633435,
        "uid": 139012,
        "name": "______OvO______",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 AT4438 \u3010[AGC028D] Chords\u3011"
    },
    {
        "content": "\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u628a\u73af\u65ad\u5f00\u6210\u4e3a\u4e00\u6761\u94fe\uff0c\u90a3\u4e48\u7ebf\u6bb5\u7684\u4ea4\u5b9e\u9645\u4e0a\u5c31\u7c7b\u4f3c\u4e8e\u533a\u95f4\u7684\u4ea4\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u7528\u8fde\u901a\u5757 $S$ \u4e2d\u6d89\u53ca\u5230\u7684\u7f16\u53f7\u6700\u5c0f\u7684\u70b9 $L$ \u548c\u7f16\u53f7\u6700\u5927\u7684\u70b9 $R$ \u6240\u6784\u6210\u7684\u533a\u95f4 $[L, R]$ \u6765\u8868\u793a $S$\u3002\n\n\u4e0b\u6587\u6211\u4eec\u79f0 $[L, R]$ \u4e3a\u8fde\u901a\u5757 $S$ \u7684**\u8868\u793a\u533a\u95f4**\u3002\n\n------\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u5df2\u7ecf\u8fde\u597d\u8fb9\u7684\u56fe\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u6027\u8d28\uff1a\n\n- \u5bf9\u4e8e\u4e24\u4e2a\u4e0d\u540c\u7684\u8fde\u901a\u5757\uff0c\u5b83\u4eec\u7684\u8868\u793a\u533a\u95f4\u8981\u4e48\u662f\u5305\u542b\u5173\u7cfb\uff0c\u8981\u4e48\u4ea4\u96c6\u4e3a\u7a7a\u3002\n\n\u8fd9\u4e2a\u6027\u8d28\u662f\u6709\u5229\u4e8e\u7edf\u8ba1\u7684\uff0c\u56e0\u4e3a\u6211\u4eec**\u4e0d\u5fc5\u8003\u8651\u65b9\u6848\u4e2d\u4ea7\u751f\u7684\u4ea4\u533a\u95f4\u5bf9\u4e0d\u540c\u8fde\u901a\u5757\u7684\u5f71\u54cd**\u4e86\u3002\n\n\u5177\u4f53\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u8bbe $f_{i, j}$ \u4e3a\u6784\u9020\u51fa\u8868\u793a\u533a\u95f4\u662f $[i, j]$ \u7684\u8fde\u901a\u5757\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8fde\u901a\u5757\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f\uff1a$f_{i, j}$ \u548c\u5728\u533a\u95f4 $[i, j]$ \u5916\u7684\u5176\u5b83\u70b9\u4efb\u610f\u8fde\u63a5\u7684\u65b9\u6848\u6570\u7684\u4e58\u79ef\u3002\n\n\u8fd9\u4e2a\u201c\u5728\u533a\u95f4 $[i, j]$ \u5916\u7684\u5176\u5b83\u70b9\u4efb\u610f\u8fde\u63a5\u7684\u65b9\u6848\u6570\u201d\u8be5\u600e\u4e48\u8ba1\u7b97\u5462\uff1f\n\n\u6211\u4eec\u7684\u65b9\u6cd5\u662f\uff0c\u9884\u5904\u7406\u4e24\u4e2a\u6570\u7ec4\uff1a$g_i$ \u548c $cnt_{i, j}$\uff1a\n\n$g_i$ \u8868\u793a $i$ \u4e2a\u70b9\u4e4b\u95f4**\u4efb\u610f\u8fde\u63a5**\u7684\u65b9\u6848\u6570\uff1b\n\n$cnt_{i, j}$ \u8868\u793a\u533a\u95f4 $[i, j]$ \u5185**\u6ca1\u6709\u8fde\u63a5\u7684\u70b9**\u7684\u4e2a\u6570\uff0c\u5373\u6ca1\u6709\u5728\u7ed9\u5b9a\u7684 $k$ \u6761\u7ebf\u6bb5\u4e2d\u51fa\u73b0\u8fc7\u3002\n\n\u90a3\u4e48\uff0c\u201c\u5728\u533a\u95f4 $[i, j]$ \u5916\u7684\u5176\u5b83\u70b9\u4efb\u610f\u8fde\u63a5\u7684\u65b9\u6848\u6570\u201d\u5373\u4e3a\uff1a\n\n$$\ng_{(n - k) * 2 - cnt_{i, j}}\n$$\n\n------\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u600e\u6837\u9884\u5904\u7406\u8fd9\u4e24\u4e2a\u6570\u7ec4\u3002\n\n$g_i$ \u6570\u7ec4\uff1a\u5f53 $i$ \u4e3a\u5947\u6570\u65f6\uff0c\u7ed3\u679c\u4e3a $0$\uff08\u5947\u6570\u4e2a\u70b9\u65e0\u6cd5\u5b8c\u6574\u5730\u76f8\u8fde\uff09\uff0c\u5426\u5219\u4e3a $g_{i - 2} * (i - 1)$\u3002\n\n\u6211\u4eec\u8bbe $g_0$ \u4e3a $1$\uff0c\u90a3\u4e48 $g$ \u7684\u901a\u9879\u516c\u5f0f\u5e73\u51e1\uff0c\u8fd9\u91cc\u5c31\u7559\u7ed9\u8bfb\u8005\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$ \u3002\n\n$cnt_{i, j}$ \u6570\u7ec4\uff1a\u8fd9\u4e2a\u5c31\u4e0d\u7528\u591a\u8bf4\u4e86\uff0c$O(n^2)$ \u5904\u7406\u5373\u53ef\u3002 \n\n-----\n\n\u6700\u540e\u6211\u4eec\u8003\u8651\u5982\u4f55\u8ba1\u7b97 $f_{i, j}$\uff0c\u4e0d\u8fc7\u524d\u63d0\u662f\u8981\u4fdd\u8bc1 $f_{i, j}$ \u7684**\u5b58\u5728\u6027\u548c\u72ec\u7acb\u6027**\u3002\n\n\u9996\u5148\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u533a\u95f4 $[i, j]$ \u4e2d\u7684**\u6240\u6709\u8fde\u8fb9\u4e0d\u8d85\u51fa\u533a\u95f4\u7684\u8303\u56f4**\uff0c\u8fd9\u6837\u624d\u80fd\u4fdd\u8bc1 $f_{i, j}$ \u7684\u5b58\u5728\u6027\uff0c\u5982\u679c\u4e0a\u8ff0\u6761\u4ef6\u65e0\u6cd5\u6ee1\u8db3\uff0c\u90a3\u4e48\u4ee4 $f_{i, j} = 0$ \u3002\n\n\u5982\u679c\u4e0d\u5bb9\u65a5\uff0c\u90a3\u4e48 $f_{i, j}$ \u5c31\u662f $g_{cnt_{i, j}}$\uff0c\u4f46\u662f\u663e\u7136\u9700\u8981\u5bb9\u65a5\uff0c\u56e0\u4e3a\u533a\u95f4 $[i, j]$ \u5185\u90e8**\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e0d\u8fde\u901a\u7684\u60c5\u51b5**\u3002\n\n\u6211\u4eec\u8003\u8651\u679a\u4e3e\u4e00\u4e2a $k \\in [i + 1, j - 1]$\uff0c\u4ee4\u533a\u95f4 $[i, k]$ \u548c $[k + 1, j]$ \u72ec\u7acb\uff0c\u7531\u4e8e\u5728\u7b97 $f_{i, k}$ \u65f6\u5df2\u7ecf\u4fdd\u8bc1\u4e86\u5176\u72ec\u7acb\u6027\uff0c\u6240\u4ee5\u8fd9\u6837\u4e0d\u5408\u6cd5\u7684\u65b9\u6848\u6709 $f_{i, k} * g_{cnt_{k + 1, j}}$ \u79cd\u3002\n\n\u6240\u4ee5 $f_{i, j}$ \u7684\u8ba1\u7b97\u516c\u5f0f\u4e3a\uff1a\n\n$$\nf_{i, j} = g_{cnt_{i, j}} - \\sum_{k = i + 1}^{j - 1}f_{i, k} * g_{cnt_{k + 1, j}}\n$$\n\n\u7b97\u6cd5\u5230\u8fd9\u91cc\u5c31\u5927\u529f\u544a\u6210\u4e86\uff0c\u5b9e\u73b0\u7684\u7ec6\u8282\u5177\u4f53\u770b\u4ee3\u7801\u5427\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cassert>\n\n#define FILE\n\n#define MAXN 1005\n#define MOD 1000000007\n\nusing namespace std;\n\nint n, k, Match[MAXN], cnt[MAXN][MAXN], g[MAXN], f[MAXN][MAXN], ans;\nbool Matched[MAXN];\n\nint main()\n{\n    #ifdef FILE\n        freopen(\"Input.in\", \"r\", stdin);\n        freopen(\"Output.out\", \"w\", stdout);\n    #endif\n    scanf(\"%d%d\", &n, &k);\n    for(register int i = 1; i <= k; i++)\n    {\n        int u, v; scanf(\"%d%d\", &u, &v);\n        Matched[u] = Matched[v] = true;\n        Match[u] = v, Match[v] = u;\n    }\n    for(register int i = 1; i <= n * 2; i++) for(register int j = i; j <= n * 2; j++) cnt[i][j] = cnt[i][j - 1] + !Matched[j];\n    g[0] = 1; for(register int i = 2; i <= n * 2; i += 2) g[i] = 1LL * g[i - 2] * (i - 1) % MOD;\n    for(register int i = 1; i <= n * 2; i++)\n    {\n        for(register int j = i; j <= n * 2; j++)\n        {\n            bool Flag = false;\n            for(register int k = i; k <= j; k++) Flag |= (Matched[k] && (Match[k] < i || Match[k] > j));\n            if(Flag) continue;\n            f[i][j] = g[cnt[i][j]];\n            for(register int k = i + 1; k <= j - 1; k++) f[i][j] = (f[i][j] - 1LL * f[i][k] * g[cnt[k + 1][j]] % MOD + MOD) % MOD;\n        }\n    }\n    for(register int i = 1; i <= n * 2; i++) for(register int j = i; j <= n * 2; j++) ans = (ans + 1LL * f[i][j] * g[(n - k) * 2 - cnt[i][j]] ) % MOD;\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```\n\n## $ \\mathit{END}$",
        "postTime": 1641132723,
        "uid": 183562,
        "name": "_ReClouds_",
        "ccfLevel": 7,
        "title": "AT4438 [AGC028D] Chords \u9898\u89e3"
    },
    {
        "content": "\u663e\u7136\u4e0d\u80fd\u8003\u8651\u6240\u6709\u65b9\u6848\uff0c\u4e8e\u662f\u8003\u8651\u6bcf\u79cd\u8fde\u901a\u5757\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u628a\u73af\u5f53\u4f5c\u5e8f\u5217\uff0c\u7ebf\u5f53\u4f5c\u533a\u95f4\uff0c\u4e24\u4e2a\u70b9\u4e4b\u95f4\u6709\u8fb9\u610f\u5473\u7740\u5b83\u4eec\u5bf9\u5e94\u7684\u533a\u95f4\u6709\u4ea4\uff0c\u5e76\u4e14**\u4e92\u4e0d\u5305\u542b**\u3002\n\n\u7531\u4e8e\u4e92\u4e0d\u5305\u542b\u7684\u6027\u8d28\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c dp \u4e86\u3002\n\n\u4ee4 $f_{l,r}$ \u8868\u793a\u4ec5\u8003\u8651 $[l,r]$ \u533a\u95f4\u5185\u7684\u8fde\u8fb9\uff08\u4e5f\u5c31\u662f\u8bf4\u5916\u9762\u6ca1\u6709\u8fb9\u4f38\u8fdb\u6765\uff09\uff0c$l$ \u548c $r$ \u5728\u4e00\u4e2a\u8fde\u901a\u5757\u5185\u7684\u65b9\u6848\u6570\u3002\n\n\u4e3a\u4ec0\u4e48\u8981\u8fd9\u6837\u8bbe\u72b6\u6001\u5462\uff0c\u56e0\u4e3a\u5982\u679c\u8ba9\u5916\u9762\u6709\u8fb9\u80fd\u591f\u4f38\u8fdb\u6765\u4f1a\u7b97\u91cd\u3002\u8003\u8651\u4e00\u4e2a $[l',r']\\subset [l,r]$\uff0c$f_{l,r}$ \u548c $f_{l',r'}$ \u90fd\u5305\u62ec\u4e00\u79cd\u65b9\u6848\u4f7f\u5f97 $l,r,l',r'$ \u5728\u4e00\u4e2a\u8fde\u901a\u5757\u5185\uff08\u5982\u679c\u5b83\u4eec\u521d\u59cb\u65f6\u6ca1\u6709\u5339\u914d\u7684\u70b9\u65f6\uff09\u3002\n\n\u7edf\u8ba1\u7b54\u6848\u5c31\u662f $\\sum\\limits_{2\\mid \\text{len}(l,r)}f_{l,r}g_{2n-2k-c(l,r)}$\uff1a$g(i)$ \u4e3a $i$ \u4e2a\u70b9\u4e24\u4e24\u5339\u914d\u7684\u65b9\u6848\u6570\uff0c\u5373 $(n-1)!!(2\\mid n)$\uff1b$c(l,r)$ \u4e3a $(l,r)$ \u5185\u521d\u59cb\u65f6\u6ca1\u6709\u5339\u914d\u7684\u70b9\u7684\u4e2a\u6570\u3002\u542b\u4e49\u5c31\u662f $[l,r]$ \u5916\u9762\u7684\u70b9\u968f\u4fbf\u5339\u914d\uff0c\u5185\u90e8 $l,r$ \u8054\u901a\uff0c\u4e3a $l,r$ \u6240\u5728\u8fde\u901a\u5757\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u5269\u4e0b\u6765\u7684\u5c31\u662f\u533a\u95f4 dp \u677f\u5b50\u4e86\u3002\u8003\u8651\u5bb9\u65a5\uff0c$[l,r]$ \u968f\u4fbf\u5339\u914d\u7684\u65b9\u6848\u6570\u4e3a $g_{c(l,r)}$\u3002\u5bf9\u4e8e $l,r$ \u4e0d\u8054\u901a\u7684\u65b9\u6848\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u4f4d\u7f6e\u4f7f\u5f97\u6ca1\u6709\u533a\u95f4\u8986\u76d6\u5230\uff0c\u679a\u4e3e\u6700\u524d\u9762\u6ee1\u8db3\u6ca1\u6709\u88ab\u8986\u76d6\u7684\u4f4d\u7f6e $k$\uff0c\u4e0d\u8054\u901a\u7684\u65b9\u6848\u5373 $f_{l,k}g_{c(k+1,r)}$\u3002\n\n\u6240\u4ee5 dp \u7684\u5f0f\u5b50\u5373\uff1a\n\n$$f_{l,r}=g_{c(l,r)}-\\sum\\limits_{k=l}^{r-1}f_{l,k}g_{c(k+1,r)}$$\n\n\u8fd9\u4e2a dp \u662f $O(n^3)$ \u7684\uff0c\u505a\u5b8c\u4e86\u3002\n\n[\u8bc4\u6d4b\u8bb0\u5f55\u3002](https://atcoder.jp/contests/agc028/submissions/38582291)",
        "postTime": 1675479024,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "AGC028D Chords"
    }
]
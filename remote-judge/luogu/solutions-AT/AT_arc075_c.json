[
    {
        "content": "# [ARC075E] Meaningful Mean\n\n## \u6742\u9879\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_arc075_c)\n\n## \u601d\u8def\n\n\u7ed9\u4f60\u597d\u51e0\u4e2a\u6570\uff0c\u7136\u540e\u5bf9\u4e8e\u8fd9\u4e2a\u5e8f\u5217\u7684\u6240\u6709\u533a\u95f4\uff0c\u8ba9\u4f60\u6c42\u5176\u5e73\u5747\u503c\u5927\u4e8e\u7b49\u4e8ek\u7684\u533a\u95f4\u4e2a\u6570\n\n\u5148\u7528\u524d\u7f00\u548c\u9884\u5904\u7406\u4e00\u4e0b\uff0c\u5bf9\u4e8e\u67d0\u4e2a\u533a\u95f4[l,r]\u7684\u5e73\u5747\u503c\u4e3a$\\frac{sum_r-sum_{l-1}}{r-l+1}\\geq k$\n\n$sum_r-sum_{l-1}\\geq k\\times(r-l+1)$,\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u64cd\u4f5c\u4f7fk\u53d8\u6210\u96f6(\u8f93\u5165$a_i$\u65f6\u90fd\u51cf\u53bbk\u5c31\u597d\u5566)\uff0c\u53ef\u4ee5\u5f97\u5230$sum_r-sum_{l-1}\\geq 0$,\u5373$sum_r\\geq sum_{l-1}$,\u7136\u540e\u5c31\u53d8\u6210\u4e86\u4e8c\u7ef4\u504f\u5e8f\uff08\u6570\u70b9\uff09\uff0c\u7528\u6811\u72b6\u6570\u7ec4\u5904\u7406\u5373\u53ef\n\n\u8fd8\u6709\u5c31\u662fsum\u6570\u7ec4\u8981\u8fdb\u884c\u79bb\u6563\u5316 \u9884\u5904\u7406\u65f6\u8981\u8bb0\u5f97\u628al=1\u65f6\u7684\u8d21\u732e\u7edf\u8ba1\u8fdb\u53bb\uff08\u6811\u72b6\u6570\u7ec4\u4f1a\u7edf\u8ba1\u4e0d\u5230)\n\nAC code\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<string>\n#include<cmath>\n#include<algorithm>\n#define int long long\n\nusing namespace std;\n\nconst int maxn=2e5+5;\n\ninline int read()\n{\n\tint w=0,f=1;\n\tchar ch=getchar();\n\twhile(ch<'0' || ch>'9')\n\t{\n\t\tif(ch=='-') f=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0' && ch<='9')\n\t{\n\t\tw=(w<<3)+(w<<1)+(ch^48);\n\t\tch=getchar();\n\t}\n\treturn w*f;\n}\n\nint n,k,ans;\nint a[maxn];\nint sum[maxn];\nint cop[maxn];\nint tree[maxn];\n\nint lowbit(int x){ return x&-x; }\n\nvoid update(int x,int y)\n{\n\tfor(;x<=n;x+=lowbit(x))\n\t{\n\t\ttree[x]+=y;\n\t}\n}\n\nint query(int x)\n{\n\tint ans=0;\n\tfor(;x;x-=lowbit(x))\n\t{\n\t\tans+=tree[x];\n\t}\n\treturn ans;\n}\n\nsigned main()\n{\n\tn=read();\n\tk=read();\n\t\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\ta[i]=read()-k;\n\t}\n\t\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tsum[i]=sum[i-1]+a[i];\n\t\tcop[i]=sum[i-1]+a[i];\n\t\tif(sum[i]>=0) ans++;\n\t}\n\t\n\tsort(cop+1,cop+n+1);\n\tint num=unique(cop+1,cop+n+1)-cop-1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tsum[i]=lower_bound(cop+1,cop+n+1,sum[i])-cop;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tans+=query(sum[i]);\n\t\tupdate(sum[i],1);\n\t}\n\t\n\tcout<<ans;\n\t\n\treturn 0;\n}\n```\n",
        "postTime": 1667310154,
        "uid": 464366,
        "name": "NinT_W",
        "ccfLevel": 0,
        "title": "[ARC075E] Meaningful Mean"
    },
    {
        "content": "> ### AT2581\n\n> \u9898\u610f\uff1a\u7ed9\u51fa\u4e00\u4e2a\u6570\u5217 $a$\uff0c\u6c42\u6709\u591a\u5c11\u4e2a\u5b50\u533a\u95f4\u5e73\u5747\u503c $\\geq k$\n\n> $1 \\leq n \\leq 2 \\times 10^5$\n\n\u5f88\u663e\u7136\u53ef\u4ee5\u5c06\u5b50\u533a\u95f4\u8f6c\u5316\u4e3a\u524d\u7f00\u548c\u76f8\u51cf\uff0c\u8bb0\u524d\u7f00\u548c\u4e3a $sum$\uff0c\u90a3\u4e48\u7b97\u672f\u5e73\u5747\u503c\u4e0d\u8d85\u8fc7 $k$ \u5c31\u53ef\u4ee5\u53d8\u4e3a\n\n$$\\frac{sum_r-sum_{l-1}}{r-l+1} \\geq k$$\n\n\u8fdb\u4e00\u6b65\u8f6c\u5316\u4e3a\n\n$$k \\times (r-l+1) \\leq sum_r-sum_{l-1}$$\n\n\u5373\n\n$$sum_r - r \\times k \\geq sum_{l-1} - (l-1) \\times k$$\n\n\u4ee4 ${sum'}_x=sum_x-x \\times k$\uff0c\u79bb\u6563\u5316\u4e86\u4e4b\u540e\u4e8c\u7ef4\u6570\u70b9\u5c31\u53ef\u4ee5\u4e86\u3002\n\n```cpp\n//Coded by tzc_wk\n/*\n\u6570\u636e\u4e0d\u6e05\u7a7a\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u591a\u6d4b\u4e0d\u8bfb\u5b8c\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8fb9\u754c\u4e0d\u7279\u5224\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d2a\u5fc3\u4e0d\u8bc1\u660e\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\nD P \u987a\u5e8f\u9519\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u5927\u5c0f\u5c11\u7b49\u53f7\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u53d8\u91cf\u4e0d\u7edf\u4e00\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d8a\u754c\u4e0d\u5224\u65ad\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8c03\u8bd5\u4e0d\u6ce8\u91ca\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u6ea2\u51fa\u4e0d l l\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n*/\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi\t\t\tfirst\n#define se\t\t\tsecond\n#define fz(i,a,b)\tfor(int i=a;i<=b;i++)\n#define fd(i,a,b)\tfor(int i=a;i>=b;i--)\n#define foreach(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define all(a)\t\ta.begin(),a.end()\n#define giveup(...) return printf(__VA_ARGS__),0;\n#define fill0(a)\tmemset(a,0,sizeof(a))\n#define fill1(a)\tmemset(a,-1,sizeof(a))\n#define fillbig(a)\tmemset(a,0x3f,sizeof(a))\n#define fillsmall(a) memset(a,0xcf,sizeof(a))\n#define mask(a)\t\t(1ll<<(a))\n#define maskx(a,x)\t((a)<<(x))\n#define _bit(a,x)\t(((a)>>(x))&1)\n#define _sz(a)\t\t((int)(a).size())\n#define filei(a)\tfreopen(a,\"r\",stdin);\n#define fileo(a)\tfreopen(a,\"w\",stdout);\n#define fileio(a) \tfreopen(a\".in\",\"r\",stdin);freopen(a\".out\",\"w\",stdout)\n#define eprintf(...) fprintf(stderr,__VA_ARGS__)\n#define put(x)\t\tputchar(x)\n#define eoln        put('\\n')\n#define space\t\tput(' ')\n#define y1\t\t\ty_chenxiaoyan_1\n#define y0\t\t\ty_chenxiaoyan_0\n#define int long long\ntypedef pair<int,int> pii;\ninline int read(){\n\tint x=0,neg=1;char c=getchar();\n\twhile(!isdigit(c)){\n\t\tif(c=='-')\tneg=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\tx=x*10+c-'0',c=getchar();\n\treturn x*neg;\n}\ninline void print(int x){\n\tif(x<0){\n\t\tputchar('-');\n\t\tprint(abs(x));\n\t\treturn;\n\t}\n\tif(x<=9)\tputchar(x+'0');\n\telse{\n\t\tprint(x/10);\n\t\tputchar(x%10+'0');\n\t}\n}\ninline int qpow(int x,int e,int _MOD){\n\tint ans=1;\n\twhile(e){\n\t\tif(e&1)\tans=ans*x%_MOD;\n\t\tx=x*x%_MOD;\n\t\te>>=1;\n\t}\n\treturn ans;\n}\nint n=read(),k=read(),ans=0,a[200005],sum[200005],key[200005],hs[200005],cnt=0;\nint bit[200005];\ninline void add(int x,int v){\n\tfor(int i=x;i<=200000;i+=(i&(-i)))\n\t\tbit[i]+=v;\n}\ninline int query(int x){\n\tif(x==0)\treturn 0;\n\tint sum=0;\n\tfor(int i=x;i;i-=(i&(-i)))\n\t\tsum+=bit[i];\n\treturn sum;\n}\nsigned main(){\n\tkey[0]=-0x3f3f3f3f;\n\tfz(i,1,n)\ta[i]=read();\n\tfz(i,1,n)\tsum[i]=sum[i-1]+a[i];\n\tfz(i,1,n)\tsum[i]-=k*i,key[i]=sum[i];\n\tsort(key+1,key+n+1);\n\tfz(i,1,n+1){\n\t\tif(key[i]!=key[i-1]){\n\t\t\ths[++cnt]=key[i];\n\t\t}\n\t}\n\tadd(lower_bound(hs+1,hs+cnt+1,0)-hs,1);\n\tfz(i,1,n){\n//\t\tcout<<sum[i]<<endl;\n\t\tint ind=lower_bound(hs+1,hs+cnt+1,sum[i])-hs;\n\t\tans+=query(ind);\n\t\tadd(ind,1);\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1585474117,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 AT2581 \u3010[ARC075C] Meaningful Mean\u3011"
    },
    {
        "content": "\u7528sum[i]\u4ee3\u8868a\u5e8f\u5217\u7684[1,i]\u7684\u548c\n\n\u5bf9\u4e8e\u4e00\u4e2a\u533a\u95f4(l,r] \u53ea\u6709\u5f53(sum[r]-sum[l])/(r-l)>=k\u65f6\u624d\u5bf9\u7b54\u6848\u6709\u8d21\u732e\n\n\u8f6c\u6362\u4e00\u4e0b\u5c31\u662f sum[r]-rk>=sum[l]-lk\n\n\u518d\u8f6c\u6362\u4e00\u4e0b \u5728\u8bfb\u5165a[i]\u7684\u65f6\u5019\u51cf\u53bbk \u90a3\u5c31\u53d8\u6210\u4e86sum[r]>=sum[l]\n\n\u6240\u4ee5\u7528\u6811\u72b6\u6570\u7ec4 \u679a\u4e3er \u770b\u5b83\u524d\u9762\u6709\u591a\u5c11\u4e2al\u7b26\u5408\u8981\u6c42\n\n\u7136\u540e\u56e0\u4e3a\u533a\u95f4\u662f\u5de6\u5f00\u53f3\u95ed\u7684 [1,i]\u8fd9\u6837\u7684\u533a\u95f4\u6ca1\u6709\u8003\u8651\u5230 \u4e00\u5f00\u59cb\u76f4\u63a5\u7b97\u5c31\u5b8c\u4e8b\u4e86 \n\n\u8fd8\u6709\u4e00\u70b9\u7ec6\u8282\u5c31\u662fsum\u53ef\u80fd\u592a\u5927\u4e86 \u79bb\u6563\u5316\u4e00\u4e0b\u5c31\u884c\u4e86 \u5177\u4f53\u7684\u770b\u4ee3\u7801\u5427\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int maxn=2e5+50;\n\nint n,k,N,r[maxn];\nll ans,a[maxn],sum[maxn];\n\ninline int read(int x=0,char c=getchar()) {\n\twhile(c<'0'||c>'9') c=getchar();\n\twhile(c>='0'&&c<='9') x=x*10+c-'0',c=getchar();\n\treturn x;\n}\n\nll c[maxn];\n\ninline void add(int x,int v){for(;x<=N;x+=x&-x)c[x]+=v;}\ninline int ask(int x){int y=0;for(;x;x-=x&-x)y+=c[x];return y;}\n\nint main() {\n\tn=read();k=read();\n\tfor(register int i=1;i<=n;++i) a[i]=read()-k; //\u8f6c\u6362\u4e3a\u533a\u95f4\u548c\u5927\u4e8e\u7b49\u4e8e0 \n\tfor(register int i=1;i<=n;++i) if((sum[i]=(a[i]+=a[i-1]))>=0) ++ans;\n\t//\u5904\u7406\u524d\u7f00\u548c\u7684\u540c\u65f6\u628a\u533a\u95f4\u5de6\u7aef\u70b9\u4e3a1\u7684\u60c5\u51b5\u76f4\u63a5\u7b97\u4e86 \n\tsort(sum+1,sum+1+n); N=unique(sum+1,sum+1+n)-sum-1; //\u4e0d\u540c\u524d\u7f00\u548c\u7684\u4e2a\u6570 \n\tfor(register int i=1;i<=n;++i) r[i]=lower_bound(sum+1,sum+1+N,a[i])-sum; //\u79bb\u6563\u5316 \n\tfor(register int i=1;i<=n;++i) ans+=ask(r[i]),add(r[i],1);\n\t//\u679a\u4e3e\u53f3\u7aef\u70b9 \u770b\u6709\u591a\u5c11\u4e2a\u5de6\u7aef\u70b9\u6ee1\u8db3\u8981\u6c42 \n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1553415448,
        "uid": 64288,
        "name": "\u65cb\u8f6c\u5361\u58f3",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT2581 \u3010Meaningful Mean\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT2581)\n\n[\u524d\u6392\u5e7f\u544a](https://www.luogu.com.cn/blog/Tony-ZhuJialiang/)\n\n\u9898\u610f\uff1a\u6c42\u4e00\u4e2a\u6570\u5217 $A$ \u4e2d\u5e73\u5747\u6570\u5927\u4e8e\u7b49\u4e8e $K$ \u7684\u8fde\u7eed\u5b50\u5e8f\u5217\u4e2a\u6570\u3002\n\n\u4e0d\u96be\u60f3\u5230\u7684\u662f\uff0c\u672c\u9898\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u800c $n$ \u7684\u8303\u56f4\u662f $n\\le 2\\times {10}^5$ \u7684\uff0c\u4e0d\u80fd\u76f4\u63a5\u5bf9\u524d\u7f00\u548c\u66b4\u529b\u5904\u7406\uff0c\u5148\u5c06\u5e73\u5747\u6570\u7684\u5f0f\u5b50\u5199\u4e0b\uff0c\u5bf9\u4e8e\u533a\u95f4 $[l,r]$ \u6765\u8bf4\uff0c\u5e73\u5747\u6570\u5927\u4e8e\u7b49\u4e8e $K$ \u6ee1\u8db3\uff1a\n$$sum_r-sum_{l-1}\\ge (r-l+1)\\times K$$\n\u79fb\u9879\u4e5f\u5c31\u6709\uff1a\n$$sum_r-r\\times K\\ge sum_{l-1}-(l-1)\\times K$$\n\u4e0d\u80fd\u53d1\u73b0\u5de6\u53f3\u4e24\u8fb9\u5206\u522b\u662f\u5173\u4e8e $r$ \u548c $l-1$ \u7684\u4e00\u4e2a\u5f0f\u5b50\u4e14\u5b8c\u5168\u76f8\u540c\uff0c\u4e0d\u59a8\u8bbe $b_i=sum_i-i\\times K$\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u6240\u6709 $b_i\\le b_j\\ (0\\le i<j\\le n)$\uff0c\u56e0\u4e3a\u524d\u7f00\u548c\u53ef\u80fd\u53d6 $sum_0$\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u8303\u56f4\u662f\u5305\u542b $0$ \u7684\u3002\n\n\u89c2\u5bdf\u8fd9\u4e2a\u6761\u4ef6\uff0c\u53d1\u73b0\u548c\u6c42\u9006\u5e8f\u5bf9\u5f88\u76f8\u4f3c\u3002\u53ea\u9700\u8981\u5c06\u5f52\u5e76\u6392\u5e8f\u4e2d\u201c\u5982\u679c\u524d\u8005\u66f4\u5927\u5c31\u66f4\u65b0\u7b54\u6848\u201d\uff0c\u6539\u4e3a\u201c\u5982\u679c\u524d\u8005\u66f4\u5c0f\u6216\u76f8\u7b49\u5c31\u66f4\u65b0\u7b54\u6848\u201d\uff0c\u4e4b\u540e\u8f93\u51fa\u8fd9\u6837\u201c\u987a\u5e8f\u5bf9\u201d\u7684\u4e2a\u6570\u5373\u53ef\u3002\n\n```cpp\nint n;\nll ans;\nll a[maxm],b[maxm],p;\ninline void msort(int l,int r){\n\tif(l==r) return;\n    int mid=(l+r)>>1;\n    msort(l,mid);\n    msort(mid+1,r);\n    int i=l,j=mid+1,k=i;\n    while(i<=mid&&j<=r){\n        if(a[i]>a[j]){\n            b[k++]=a[i++];\n        }\n        else{\n            b[k++]=a[j++];\n            ans+=mid-i+1;\n        }\n    }\n    while(i<=mid){\n        b[k++]=a[i++];\n    }\n    while(j<=r){\n        b[k++]=a[j++];\n    }\n    for(i=l;i<=r;i++){\n        a[i]=b[i];\n    }\n}\nint main(){\n    n=read(),p=read();\n    for(int i=1;i<=n;i++){\n        a[i]=read();\n    }\n    for(int i=1;i<=n;i++){\n        a[i]+=a[i-1]-p;\n    }\n    msort(0,n);\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1643012570,
        "uid": 321177,
        "name": "SoyTony",
        "ccfLevel": 6,
        "title": "AT\u9898\u89e3\u2014\u2014AT2581 [ARC075C] Meaningful Mean"
    },
    {
        "content": "\u4e4b\u524d\u53d1\u73b0\u6709\u53e5\u8bdd\u8868\u8ff0\u4e0d\u6e05\uff0c\u7ba1\u7406\u5927\u5927\u7ed9\u91cd\u8fc7\u4e00\u4e0b\u8c22\u8c22qwq\n\n\u5c06\u6240\u6709\u7684 $a_i$ \u90fd\u53d8\u4e3a $a_i-k$\uff0c\u5219 $\\frac{\\sum_{i=l}^ra_i}{r-l+1}$ \u5373\u53d8\u4e3a $\\frac{\\sum_{i=l}^ra_i}{r-l+1}-k$\u3002\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u53d8\u4e3a\u4e86\u5bf9\u4e8e\u6570\u5217 $b_i=a_i-k$\uff0c\u6709\u591a\u5c11\u6bb5\u7684\u5e73\u5747\u503c\u5373\u548c $\\geq0$\u3002\n\n\u5bf9\u6570\u5217 $b$ \u505a\u524d\u7f00\u548c\uff0c$\\sum_{i=l}^rb_i\\geq0$ \u7b49\u4ef7\u4e8e $\\text{sum}_r-\\text{sum}_{l-1} \\geq 0$\u3002\n\n\u4ee5 $r$ \u4e3a\u7ed3\u5c3e\u7684\u7b26\u5408\u8981\u6c42\u7684\u533a\u95f4\u6570\u5373\u4e3a $0$ \u5230 $r-1$ \u4e4b\u95f4\u5c0f\u4e8e\u7b49\u4e8e\n$\\text{sum}_r$ \u7684 $\\text{sum}$ \u4e2a\u6570\u3002\n\n\u5bf9 $\\text{sum}$ \u8fdb\u884c\u79bb\u6563\u5316\uff0c\u5f00\u4e00\u4e2a\u6876\u8bb0\u5f55\u524d $i$ \u4e2a\u6570\u4e2d\u5c0f\u4e8e\u7b49\u4e8e\u8be5\u6570\u7684\u6570\u7684\u6570\u91cf\u3002\u7528\u6811\u72b6\u6570\u7ec4\u6216\u8005\u7ebf\u6bb5\u6811\u7ef4\u62a4\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n,k;\nint num[200007];\nlong long sum[200007];\nlong long jl[200007];\nmap <long long,int> p;\nstruct Tree{\n\tstruct nodee{\n\t\tint l,r,num,lazy;\n\t}a[1600007];\n\tvoid build(int x,int l,int r)\n\t{\n\t\ta[x].l=l;\n\t\ta[x].r=r;\n\t\tif(l==r)\n\t\treturn;\n\t\tint mid=(l+r)/2;\n\t\tint lc=x*2,rc=x*2+1;\n\t\tbuild(lc,l,mid);\n\t\tbuild(rc,mid+1,r);\n\t\ta[x].num=a[lc].num+a[rc].num;\n\t}\n\tinline void pushdown(int x)\n\t{\n\t\tint lc=x*2,rc=x*2+1;\n\t\ta[lc].lazy+=a[x].lazy;\n\t\ta[rc].lazy+=a[x].lazy;\n\t\ta[lc].num+=a[x].lazy*(a[lc].r-a[lc].l+1);\n\t\ta[rc].num+=a[x].lazy*(a[rc].r-a[rc].l+1);\n\t\ta[x].lazy=0;\n\t}\n\tinline void Add(int x,int l,int r,int k)\n\t{\n\t\tpushdown(x);\n\t\tif(l<=a[x].l&&a[x].r<=r)\n\t\t{\n\t\t\ta[x].lazy+=k;\n\t\t\ta[x].num+=k*(a[x].r-a[x].l+1);\n\t\t\treturn;\n\t\t}\n\t\tint lc=x*2,rc=x*2+1;\n\t\tif(l<=a[lc].r)\n\t\tAdd(lc,l,r,k);\n\t\tif(r>=a[rc].l)\n\t\tAdd(rc,l,r,k);\n\t\ta[x].num=a[lc].num+a[rc].num;\n\t}\n\tinline int Sum(int x,int l,int r)\n\t{\n\t\tpushdown(x);\n\t\tif(l<=a[x].l&&a[x].r<=r)\n\t\treturn a[x].num;\n\t\tint lc=x*2,rc=x*2+1,ans=0;\n\t\tif(l<=a[lc].r)\n\t\tans+=Sum(lc,l,r);\n\t\tif(r>=a[rc].l)\n\t\tans+=Sum(rc,l,r);\n\t\treturn ans;\n\t}\n}Tre;\nlong long ans=0;\nint main()\n{\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=1;i<=n;++i)\n\tscanf(\"%d\",&num[i]),num[i]-=k,sum[i]=sum[i-1]+num[i],jl[i]=sum[i];\n\tjl[n+1]=0;\n\tsort(jl+1,jl+n+2);\n\tint maxn=unique(jl+1,jl+n+2)-jl-1;\n\tfor(int i=1;i<=maxn;++i)\n\tp[jl[i]]=i;\n\tfor(int i=1;i<=n;++i)\n\tnum[i]=p[sum[i]];\n\tTre.build(1,1,maxn);\n\tTre.Add(1,p[0],maxn,1);\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tans+=Tre.Sum(1,num[i],num[i]);\n\t\tTre.Add(1,num[i],maxn,1);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1636464707,
        "uid": 414210,
        "name": "Iam1789",
        "ccfLevel": 0,
        "title": "AT2581 [ARC075C] Meaningful Mean \u9898\u89e3"
    },
    {
        "content": "CDQ\u5206\u6cbb\u7684\u677f\u5b50\u9898\u3002\n\n\u76ee\u6807\u6c42\u533a\u95f4\u7684\u5e73\u5747\u6570\u5927\u4e8e\u7b49\u4e8e $K$ \u7684\u4e2a\u6570\uff0c\u6309\u7167\u60ef\u4f8b\uff0c\u540c\u65f6\u51cf\u53bb $K$\uff0c\u5373\u6c42\u533a\u95f4\u548c\u975e\u8d1f\u7684\u4e2a\u6570\u3002\n\n\u5177\u4f53\u601d\u8def\uff1a\n\nCDQ\u5206\u6cbb\u505a\u6cd5\uff0c\u8bbe\u73b0\u5728\u7edf\u8ba1\u7684\u533a\u95f4\u4e3a $\\left[l,r\\right]$ ,\u5206\u6cbb\u7edf\u8ba1\u51fa $\\left[l,mid\\right],\\left[mid+1,r\\right]$ \u533a\u95f4\u4e2d\u7684\u7b54\u6848\u4e2a\u6570\uff0c\u5176\u4e2d $mid=(l+r)/2$\u3002\n\n\u63a5\u4e0b\u6765\u4e3b\u8981\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u8ba1\u7b97\u4e00\u4e2a\u533a\u95f4 $\\left[l,r\\right]$ \u5185\u7684\u7b54\u6848\u4e2a\u6570\u3002\n\n\u6ce8\u610f\u6b64\u5904\u7edf\u8ba1\u7684\u7b54\u6848\u533a\u95f4\u5fc5\u987b\u7ecf\u8fc7 $mid$\u3002\n\n\u4ee5 $mid$ \u4e3a\u4e2d\u5fc3\u5206\u522b\u5411\u4e24\u8fb9\u505a\u540e\u7f00\u548c\u4e0e\u524d\u7f00\u548c\u3002\n\n\u5c06\u4e24\u8fb9\u5206\u522b\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u4e24\u6307\u9488\u7684\u65b9\u5f0f\u7edf\u8ba1\u51fa\u5408\u6cd5\u7684\u7b54\u6848\u6570\u3002\n\n$i$ \u6307\u9488\u6307\u5411 $mid+1$\uff0c$j$ \u6307\u9488\u6307\u5411 $mid$\u3002$j$ \u5411\u5de6\u626b\uff0c$i$ \u5411\u53f3\u626b\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u89c1\u4ee3\u7801\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=2e5+50;\nll a[N],s[N],ans;\nvoid cdq(int l,int r){\n\tif(l==r){\n\t\tif(a[l]>=0) ans++;\n\t\treturn ;\n\t}\n\tint mid=(l+r)>>1;\n\tcdq(l,mid); cdq(mid+1,r);\n\ts[mid]=a[mid];\n\tfor(int i=mid-1;i>=l;i--) s[i]=s[i+1]+a[i];\n\ts[mid+1]=a[mid+1];\n\tfor(int i=mid+2;i<=r;i++) s[i]=s[i-1]+a[i];\n\tsort(s+l,s+mid+1);\n\tsort(s+mid+1,s+r+1);\n\tint j=mid;\n\tfor(int i=mid+1;i<=r;i++){\n\t\twhile(s[i]+s[j]>=0&&j>=l) j--;\n\t\tans+=mid-j;\n\t}\n}\nint main(){\n\tint n,m; cin>>n>>m;\n\tfor(int i=1;i<=n;i++) scanf(\"%lld\",&a[i]),a[i]-=m;\n\tcdq(1,n);\n\tprintf(\"%lld\\n\",ans);\n}\n```\n\n\n\n~~\u7801\u98ce\u8fd8\u884c\uff0c\u51d1\u5408\u7740\u770b\u5427\u3002~~",
        "postTime": 1634649456,
        "uid": 286580,
        "name": "rhyyy1",
        "ccfLevel": 6,
        "title": "AT2581 [ARC075C] Meaningful Mean\u9898\u89e3"
    },
    {
        "content": "\u5bf9\u4e8e\u4ee5$r$\u4e3a\u53f3\u7aef\u70b9\u7684\u533a\u95f4,\u53ea\u8981\u6ee1\u8db3$\\sum^{r}_{i=l} a_i>=(r-l+1)k$\u5c31\u6ee1\u8db3\u4e86\u533a\u95f4\u5e73\u5747\u6570\u5927\u4e8ek  \n\u4e5f\u5c31\u662f\u8bf4\u6ee1\u8db3$a_r>(r-l+1)k-\\sum^{r-1}_{i=l} a_i$  \n\u4e8e\u662f\u8f6c\u800c\u53bb\u7ef4\u62a4$(r-l+1)k-\\sum^{r-1}_{i=l} a_i$  \n\u6bcf\u6b21\u65b0\u52a0\u5165\u4e00\u4e2a\u5143\u7d20\u90fd\u76f8\u5f53\u4e8e\u7ed9\u6240\u6709\u5143\u7d20\u52a0\u4e0a\u4e00\u4e2a$k-a_r$,\u5e76\u52a0\u5165\u4e00\u4e2a\u65b0\u5143\u7d20$k$  \n\u6bd4\u5982\u5f53\u7ef4\u62a4\u52302\u7684\u65f6\u5019,\u6709\n$$\n2k-a_1\\\\\nk\n$$   \n\u800c\u52a0\u5165\u4e00\u4e2a2\u4e4b\u540e\u5c31\u53d8\u6210\u4e86  \n$$\n3k-a_1-a_2  \\\\\n2k-a_2 \\\\\nk\n$$  \n\u4e8e\u662f\u628a\u6bcf\u6b21\u52a0\u4e0a\u7684$k-a_r$\u4f5c\u4e3a\u7c7b\u4f3c\u7ebf\u6bb5\u6811\u7684lazytag\u4e00\u6837,(\u4ee5\u4e0b\u79f0\u4e3a$sum$)  \n\u6bcf\u6b21\u52a0\u5165\u7684\u65f6\u5019\u5c31\u76f4\u63a5\u52a0\u5165$k-sum$,\u800c\u67e5\u8be2\u7684\u65f6\u5019\u76f4\u63a5\u67e5\u8be2\u5c0f\u4e8e$a_r-sum$\u7684\u5c31\u53ef\u4ee5\u4e86  \n\u5173\u4e8e\u7ef4\u62a4\u8fd9\u4e2a\u4e1c\u897f\u7684\u65b9\u6cd5\u6709\u5f88\u591a,\u8fd9\u91cc\u8bb2\u4e24\u79cd\u6bd4\u8f83\u66b4\u529b\u7684\u65b9\u6cd5  \n\n1.vector  \n\u5173\u4e8e\u67e5\u8be2,\u53ea\u8981upper_bound\u5c31\u53ef\u4ee5\u4e86,\u800c\u63d2\u5165\u53ef\u4ee5\u9009\u62e9upper_bound\u627e\u5230\u63d2\u5165\u4f4d\u7f6e\u4e4b\u540einsert  \ninsert\u7684\u590d\u6742\u5ea6\u662f$O(\\frac{n}{w})$,\u6240\u4ee5\u6574\u4f53\u590d\u6742\u5ea6\u662f$O(\\frac{n^2}{w})$,\u5982\u679c\u662f1e5\u80fd\u5361\u8fc7,\u4f462e5\u4f3c\u4e4e\u6709\u4e9b\u56f0\u96be~~\u5f00O2\u80fd\u8fc7~~  \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define ri register int\n#define ll long long\nil ll read(){\n    bool f=true;ll x=0;\n    register char ch=getchar();\n    while(ch<'0'||ch>'9') {if(ch=='-') f=false;ch=getchar();}\n    while(ch>='0'&&ch<='9') x=(x<<3)+(x<<1)+(ch^48),ch=getchar();\n    if(f) return x;\n    return ~(--x);\n}\nil void write(const ll &x){if(x>9) write(x/10);putchar(x%10+'0');}\nil void print(const ll &x) {x<0?putchar('-'),write(~(x-1)):write(x);putchar('\\n');}\nil int max(const int &a,const int &b){return a>b?a:b;}\nil int min(const int &a,const int &b){return a<b?a:b;}\nvector<ll> s;\nint n;\nll k;\nll a,sum,ans;\nint main(){\n\t// freopen(\"rand.in\",\"r\",stdin);\n\t// freopen(\"2.out\",\"w\",stdout);\n    n=read(),k=read();\n    s.push_back(k);\n    sum=0;\n    for(ri i=1;i<=n;++i){\n        a=read();\n        ans+=upper_bound(s.begin(),s.end(),a-sum)-s.begin();\n        sum+=k-a;\n        s.insert(upper_bound(s.begin(),s.end(),k-sum),k-sum);\n    }\n    print(ans);\n\t// printf(\"%lf\",clock()/1000.0);\n    return 0;\n}\n```\n\n\n2.\u5e73\u8861\u6811  \n\u5355\u70b9\u63d2\u5165,\u67e5\u627erank,\u90fd\u662f\u5e73\u8861\u6811\u80fd\u7ef4\u62a4\u7684\u6700\u57fa\u672c\u7684\u4e1c\u897f  \n\u590d\u6742\u5ea6$O(nlogn)$  \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define ri register int\n#define ll long long\nil ll read(){\n    bool f=true;ll x=0;\n    register char ch=getchar();\n    while(ch<'0'||ch>'9') {if(ch=='-') f=false;ch=getchar();}\n    while(ch>='0'&&ch<='9') x=(x<<3)+(x<<1)+(ch^48),ch=getchar();\n    if(f) return x;\n    return ~(--x);\n}\nil void write(const ll &x){if(x>9) write(x/10);putchar(x%10+'0');}\nil void print(const ll &x) {x<0?putchar('-'),write(~(x-1)):write(x);putchar('\\n');}\nil int max(const int &a,const int &b){return a>b?a:b;}\nil int min(const int &a,const int &b){return a<b?a:b;}\nint n;\nll k;\nconst int MAXN=4e5+7;\nll a,sum,ans;\nstruct FHQ\n{\n    int cnt=0;\n    struct T{\n        ll val,key;\n        int l,r,size;\n    }tree[MAXN];\n    void update(int tmp){\n        tree[tmp].size=tree[tree[tmp].l].size+tree[tree[tmp].r].size+1;\n    }\n    void split(int now,int k,int &l,int &r){\n        if(!now){\n            l=r=0;\n            return;\n        }\n        if(tree[now].val<=k){\n            l=now;\n            split(tree[now].r,k,tree[now].r,r);\n        }\n        if(tree[now].val>k){\n            r=now;\n            split(tree[now].l,k,l,tree[now].l);\n        }\n        update(now);\n    }\n    int add(int val){\n        tree[++cnt].val=val,tree[cnt].l=tree[cnt].r=0,tree[cnt].size=1,tree[cnt].key=rand();\n        return cnt;\n    }\n    int merge(int l,int r){\n        if(!l||!r) return l+r;\n        if(tree[l].key>tree[r].key){\n            tree[l].r=merge(tree[l].r,r);\n            update(l);\n            return l;\n        }\n        else{\n            tree[r].l=merge(l,tree[r].l);\n            update(r);\n            return r;\n        }\n    }\n    int kth(int now,int k){\n        if(tree[tree[now].l].size+1==k) return now;\n        if(tree[tree[now].l].size+1>k) return kth(tree[now].l,k);\n        return kth(tree[now].r,k-tree[tree[now].l].size-1);\n    }\n    int root=0,l=0,r=0,p=0;\n    void insert(ll x){\n        split(root,x,l,r);\n        p=add(x);\n        root=merge(merge(l,p),r);\n    }\n    il ll bound(ll x){\n        ll ans=0;\n        split(root,x,l,r);\n        ans=tree[l].size;\n        root=merge(l,r);\n        return ans;\n    }\n}s;\nint main(){\n    n=read(),k=read();\n    s.insert(k);\n    for(ri i=1;i<=n;++i){\n        a=read();\n        ans+=s.bound(a-sum);\n        sum+=k-a;\n        s.insert(k-sum);\n    }\n    print(ans);\n    return 0;\n}\n```\n",
        "postTime": 1606866640,
        "uid": 206998,
        "name": "Krimson",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT2581 \u3010[ARC075C] Meaningful Mean\u3011"
    },
    {
        "content": "# $AT2581$ `Meaningful Mean`\n\u6765\u81ea@Wen_kr\u5927\u7237\u7684\u9898\u76ee\u63a8\u8350\n## \u9898\u610f\n+ \u7ed9\u5b9a\u4e00\u4e32\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217\uff0c\u8be2\u95ee\u6709\u591a\u5c11\u4e2a\u533a\u95f4\u7684\u7b97\u6570\u5e73\u5747\u6570\u5927\u4e8e\u7b49\u4e8e $K$.\n+ $n \\leq 2* 10^5, K,a_i\\leq 10^9$\n\n## $Solution$\n+ \u8fd9\u79cd\u9898\u4e00\u822c\u90fd\u8003\u8651\u63a8\u4e00\u4e0b\u5f0f\u5b50\n+ \u533a\u95f4\u548c\u8f6c\u5316\u4e3a\u524d\u7f00\u548c\n+ \u5bf9\u4e8e\u533a\u95f4$(l,r)$\uff0c\u8f6c\u5316\u6210\u524d\u7f00\u548c\n+ $$\\frac{sum[r]-sum[l-1]}{r-l+1}\\geq K$$\n+ $$sum[r]-sum[l-1]\\geq(r-l+1)\\times K$$\n+ \u539f\u5f0f\u7b49\u4ef7\u4e8e\n+ $$sum[r]-K\\times r\\geq sum[l-1]-(l-1)\\times K$$\n+ \u5316\u7b80\u601d\u8def\uff1f\u5bfb\u627e\u901a\u9879\uff0c\u6216\u8005\u8bf4\u5de6\u53f3\u79fb\u9879\u641e\u4e00\u641e\n+ \u95ee\u9898\u8f6c\u5316\u6210\u4e86$C[i]=sum[i]-K\\times i$\u524d\u9762\u6bd4\u540e\u9762\u5c0f\u4e8e\u7b49\u4e8e\u7684\u5bf9\u6570\n+ \u6811\u72b6\u6570\u7ec4\u79bb\u6563\u5316\u641e\u641e\uff0c\u6216\u8005\u5f52\u5e76\u641e\u641e\u5373\u53ef\n+ \u6ce8\u610f\u8fd9\u91cc\u5e76\u4e0d\u662f\u9006\u5e8f\u5bf9\uff0c\u6240\u4ee5\u7406\u8bba\u4e0a\u6765\u8bf4\u6811\u72b6\u6570\u7ec4\u778e\u641e\u597d\u505a\u4e00\u4e9b\n+ $yy$\u4e00\u904d\u987a\u5e8f\u5bf9\u8fc7\u4e86\uff08\u5176\u5b9e\u53ef\u4ee5\u603b\u5bf9\u6570\u51cf\u53bb\u9006\u5e8f\u5bf9\u4e2a\u6570\uff09\n\n```cpp\n\n#include <algorithm>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <map>\n#include <set>\n#include <vector>\n#define rr int\nusing namespace std;\ntypedef long long ll;\nll read() {\n    char i = getchar();\n    ll f = 1, res = 0;\n    while (i < '0' || i > '9') {\n        if (i == '-') f = -1;\n        i = getchar();\n    }\n    while (i >= '0' && i <= '9') {\n        res = res * 10 + i - '0';\n        i = getchar();\n    }\n    return f * res;\n}\nint n;\nll K;\nconst int N = 3e5 + 50;\nll a[N];\nll sum[N], c[N];\nll ans = 0;\ninline void merge(int l, int r) {\n    if (l < r) {\n        int mid = (l + r) >> 1;\n        merge(l, mid);\n        merge(mid + 1, r);\n        int i = l, j = mid + 1, now = l;\n        while (i <= mid && j <= r) {\n            if (a[i] <= a[j]) {\n                c[now++] = a[i++];\n                ans += r - j + 1; //\u8fd9\u91cc\u6ce8\u610f\u4e0d\u80fd\u91cd\u590d\u8ba1\u7b97\uff0c\u6bcf\u6b21\u53d6\u5f97\u53d6\u5355\u72ec\u66f4\u65b0\u8d21\u732e\n            } else\n                c[now++] = a[j++];\n        }\n        while (i <= mid) c[now++] = a[i++];\n        while (j <= r) c[now++] = a[j++];\n        for (rr i = l; i <= r; ++i) a[i] = c[i];\n    }\n}\nint main() {\n    n = read() + 1, K = read();\n    for (rr i = 2; i <= n; ++i) {\n        a[i] = read();\n        sum[i] = sum[i - 1] + a[i];\n        a[i] = sum[i] - K * ll(i - 1);\n    }\n    // for (rr i = 1; i <= n; ++i) cout << a[i] << ' ';\n    merge(1, n);\n    // for (rr i = 1; i <= n; ++i) cout << a[i] << endl;\n    cout << ans;\n}\n\n\n```",
        "postTime": 1572425748,
        "uid": 19905,
        "name": "DarkMoon_Dragon",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT2581 \u3010Meaningful Mean\u3011"
    },
    {
        "content": "\u672c\u9898\u6211\u4eec\u53ef\u4ee5\u60f3\u51fa\uff0c\u6211\u4eec\u628a\u6bcf\u4e00\u4e2a $a_i$ \u51cf\u53bb $K$\uff0c\u7136\u540e\u5e73\u5747\u6570\u5927\u4e8e\u7b49\u4e8e $0$ \u7684\u533a\u95f4\u6570\u91cf\u5c31\u662f\u7b54\u6848\u3002\n\n\u90a3\u4e48\u6211\u4eec\u600e\u4e48\u6c42\u533a\u95f4\u5e73\u5747\u6570\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u63a8\u51fa\uff0c\u5f53 $[1,n]$ \u7684\u533a\u95f4\u548c\u5927\u4e8e $[1,m]$ \u7684\u533a\u95f4\u548c\uff0c\u5e76\u4e14 $n>m$\uff0c\u90a3\u4e48 $[m,n]$ \u7684\u533a\u95f4\u548c\u4e00\u5b9a\u4e0d\u5c0f\u4e8e $0$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u53cd\u8bc1\u6cd5\u8bc1\u660e\uff1a\u5047\u8bbe $[m,n]$ \u533a\u95f4\u548c $<0$\uff0c\u90a3\u4e48 $[1,m]$ \u7684\u533a\u95f4\u548c\u5c31\u662f $[1,n]$ \u7684\u533a\u95f4\u548c\u51cf\u53bb $[m,n]$ \u7684\u533a\u95f4\u548c\uff0c\u7531\u4e8e $[m,n]$ \u7684\u533a\u95f4\u548c $<0$\uff0c$[1,m]$ \u7684\u533a\u95f4\u548c\u4e00\u5b9a\u5927\u4e8e $[1,n]$ \u7684\u533a\u95f4\u548c\uff0c\u6240\u4ee5\u4e0a\u8ff0\u63a8\u8bba\u6210\u7acb\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u5f52\u5e76\u6392\u5e8f\u7edf\u8ba1\u6b63\u5e8f\u5bf9\u3002\n\n\u987a\u5e26\u4ecb\u7ecd\u4e0b\u5f52\u5e76\u6392\u5e8f\uff1a\u5f52\u5e76\u6392\u5e8f\u662f\u628a\u4e00\u4e2a\u6570\u5217\u62c6\u5206\u518d\u5408\u5e76\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log_2n)$\uff0c\u6709\u4e00\u79cd\u4f18\u5316\u53eb Timsort\uff0c\u88ab\u8ba4\u4e3a\u662f\u201c\u4e16\u754c\u4e0a\u6700\u5feb\u7684\u6392\u5e8f\u201d\uff0c\u53e6\u6709\u4e00\u79cd\u57fa\u4e8e\u961f\u5217\u548c\u7ebf\u6bb5\u6811\u7684\u6392\u5e8f\u4e5f\u662f\u8fd9\u4e2a\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u4f46\u672a\u5f97\u5230\u5e7f\u6cdb\u8ba4\u53ef\u3002\n\n\u4ee3\u7801\u5b9e\u73b0\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nlong long tmp[500005],a[500005],b[500005];\nlong long ans=0;\nvoid msort(int l,int r){//\u5f52\u5e76\u6a21\u677f\uff0c\u53c2\u8003\u300a\u4fe1\u606f\u5b66\u5965\u8d5b\u4e00\u672c\u901a\u300b\n\tif(l==r)return;\n\tregister int m=(l+r)/2,i=l,j=m+1,k=l;\n\tmsort(l,m),msort(m+1,r);//\u9012\u5f52\u8c03\u7528\n\twhile(i<=m&&j<=r)\n\t\tif(a[i]>a[j])b[k++]=a[i++];\n\t\telse b[k++]=a[j++],ans=(ans+m-i+1);//\u6c42\u6b63\u5e8f\u5bf9\u4e2a\u6570\n\twhile(i<=m)b[k++]=a[i++];\n\twhile(j<=r)b[k++]=a[j++];\n\tfor(register int ii=l;ii<=r;ii++)a[ii]=b[ii];\n}\nint main(){\n    ios::sync_with_stdio(false);\n\tcin.tie(0),cout.tie(0);\n\tlong long n,k;\n\tcin>>n>>k;\n\tfor(register int i=1;i<=n;i++){\n\t\tcin>>tmp[i];\n\t\ttmp[i]-=k;\n\t}\n\ta[1]=tmp[1];\n\tfor(register int i=2;i<=n;i++)a[i]=a[i-1]+tmp[i];//a\u6570\u7ec4\u8bb0\u5f55\u524d\u7f00\u548c\n\tmsort(0,n);\n\tcout<<ans;\n}\n```\n\n\u518d\u63a8\u8350\u51e0\u9053\u9006\u5e8f\u5bf9\u7684\u9898\uff1a\n\n[P1908 \u9006\u5e8f\u5bf9](https://www.luogu.com.cn/problem/P1908)\n\n[P1774 \u6700\u63a5\u8fd1\u795e\u7684\u4eba](https://www.luogu.com.cn/problem/P1774)\n\n[P2717 \u5bd2\u5047\u4f5c\u4e1a](https://www.luogu.com.cn/problem/P2717)\n\n[P2804 \u795e\u79d8\u6570\u5b57](https://www.luogu.com.cn/problem/P2804)\n\n[P7868 VUDU](https://www.luogu.com.cn/problem/P7868)\n\n\u7ba1\u7406\u5458\u8f9b\u82e6\u4e86\uff0c\u6c42\u7ba1\u7406\u8fc7\u5ba1~",
        "postTime": 1683292906,
        "uid": 482610,
        "name": "tlxjy",
        "ccfLevel": 0,
        "title": "AT_arc075_c\u9898\u89e3"
    },
    {
        "content": "# [ARC075E] Meaningful Mean \u9898\u89e3\n## \u9898\u610f\n\u7ed9\u4e00\u4e2a\u957f\u5ea6\u4e3a $N$ \u7684\u6574\u6570\u5e8f\u5217 ${a}$\uff0c\u5bf9\u4e8e\u5176\u4e00\u5171 $\\frac{N\\times (N+1)}{2}$ \u4e2a\u7684\u975e\u7a7a\u533a\u95f4\uff0c\u6c42\u6709\u591a\u5c11\u4e2a\u533a\u95f4\u7684\u5e73\u5747\u6570\u5927\u4e8e\u7b49\u4e8e $k$\u3002\n## \u66b4\u529b\u505a\u6cd5\n\u663e\u7136\uff0c\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u533a\u95f4\u5de6\u7aef\u70b9 $j$ \u4e0e\u533a\u95f4\u53f3\u7aef\u70b9 $i$\uff0c\u68c0\u67e5\u533a\u95f4\u5e73\u5747\u503c\u662f\u5426\u5927\u4e8e\u7b49\u4e8e $k$ \u5373\u53ef\uff0c\u7528\u4ee3\u7801\u5b9e\u73b0\u5373\u4e3a\uff1a\n\n```cpp\nfor(int i=1;i<=n;i++){\n\tfor(int j=1;j<=i;j++){\n\t\tif(sum[i]-sum[j-1]>=k*(i-j+1)){//\u4e58\u6cd5\u907f\u514d\u4e22\u7cbe\u5ea6\n\t\t\tans++;\n\t\t}\n\t}\n}\n```\n\u7528\u524d\u7f00\u548c\u6570\u7ec4 $sum$ \u4f18\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2)$\u3002\u663e\u7136\uff0c\u5bf9\u4e8e $2 \\times 10^5$ \u7684\u6570\u636e\uff0c\u8be5\u7a0b\u5e8f\u4f1a\u8d85\u65f6\u3002\n## \u6b63\u89e3\n\u53ea\u8981\u5bf9\u66b4\u529b\u7b97\u6cd5\u7684\u4e0d\u7b49\u5f0f\u7a0d\u52a0\u6539\u53d8\uff0c\u6211\u4eec\u5c31\u80fd\u5f97\u5230\u6b63\u89e3\u3002\n\n\u5bf9\u4e8e\u4ee3\u7801\u4e2d\u7684\u4e0d\u7b49\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e0d\u7b49\u5f0f\u8f6c\u5316\u4e3a\uff1a$sum_i - k \\times i - k \\geq sum_{j-1} - k \\times j$\u3002 \n\n\u518d\u7ed3\u5408 $j \\leq i$\uff0c\u5c31\u663e\u7136\u53ef\u4ee5\u770b\u51fa\u516c\u5f0f\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u4f18\u5316\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$\uff0c\u6211\u4eec\u90fd\u5c06 $sum_{j-1} - k \\times j$ \u63d2\u5165\u8fdb\u6811\u72b6\u6570\u7ec4\u4e2d\uff0c\u518d\u5c06\u6811\u72b6\u6570\u7ec4\u4e2d\u5c0f\u4e8e\u7b49\u4e8e $sum_i - k \\times i - k$ \u7684\u5143\u7d20\u4e2a\u6570\u67e5\u8be2\u5e76\u7d2f\u52a0\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u6700\u7ec8\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n \\log n)$\u3002\n\n__\u6ce8\u610f__\uff1a\u7531\u4e8e\u4e0d\u7b49\u5f0f\u4e2d\u7684\u5de6\u53f3\u4e24\u9879\u53ef\u80fd\u5f88\u5927\uff0c\u6240\u4ee5\u5728\u64cd\u4f5c\u524d\u9700\u8981\u5148\u5bf9\u5176\u79bb\u6563\u5316\u3002\n## \u4ee3\u7801\n```cpp\n#include<stdio.h>\n#include<algorithm>\ntypedef long long ll;\nconst ll N=1e6+5;\nint n,cnt;\nll k,sum[N],a[N],b[N],p[N],c[N];\nint lowbit(int x){return x&~x+1;}\nvoid add(int x,ll v){while(x<=cnt) c[x]+=v,x+=lowbit(x);}\nll query(int x){\n\tll ans=0;\n\twhile(x) ans+=c[x],x-=lowbit(x);\n\treturn ans;\n}\nint main(){\n\tscanf(\"%d%lld\",&n,&k);\n\tll x;\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%lld\",&x);\n\t\tsum[i]=sum[i-1]+x;\n\t\ta[i]=sum[i]-k-k*i;//\u4e0d\u7b49\u5f0f\u5de6\u8fb9\u9879\n\t\tb[i]=sum[i-1]-k*i;//\u4e0d\u7b49\u5f0f\u53f3\u8fb9\u9879\n\t\tp[++cnt]=a[i],p[++cnt]=b[i];\n\t}\n\tstd::sort(p+1,p+cnt+1);//\u79bb\u6563\u5316\u6392\u5e8f\n\tcnt=std::unique(p+1,p+cnt+1)-p-1;\n\tll ans=0;\n\tfor(int i=1;i<=n;i++){\n\t\tint x=std::lower_bound(p+1,p+cnt+1,a[i])-p;\n\t\tint y=std::lower_bound(p+1,p+cnt+1,b[i])-p;//\u79bb\u6563\u5316\n\t\tadd(y,1);\n\t\tans+=query(x);\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1682426511,
        "uid": 544060,
        "name": "ny_fzx",
        "ccfLevel": 4,
        "title": "Meaningful Mean \u9898\u89e3"
    },
    {
        "content": "## [ARC075E] Meaningful Mean \n\n\u597d\u9898\u3002\n\n\u9996\u5148\u663e\u7136\u6709\u4e00\u4e2a\u66b4\u529b\u505a\u6cd5\uff0c\u4e5f\u5c31\u662f $O(n^2)$ \u7684\uff0c\u8003\u8651\u66b4\u529b\u679a\u4e3e\u6bcf\u4e00\u4e2a\u533a\u95f4\uff0c\u67e5\u8be2\u533a\u95f4\u548c\u663e\u7136\u53ef\u4ee5\u8003\u8651\u9884\u5904\u7406\u524d\u7f00\u548c\u3002\u5224\u65ad\u4e00\u4e0b\u8fd9\u4e2a\u548c\u662f\u5426\u5927\u4e8e\u7b49\u4e8e $k$ \u5373\u53ef\u3002\n\n\u6838\u5fc3\u7684\u4e00\u884c\u662f\uff1a\n\n```cpp\nif(s[i]-s[j-1]>=k*(i-j+1))\n```\n\u7136\u540e\u8003\u8651\u628a\u8fd9\u4e2a\u5f0f\u5b50\u62c6\u5f00\u3002\n\n$$k \\times i-k \\times(j-1)\\le s_i-s_{j-1}$$\n\n$$  s_{j-1}-k\\times (j-1)\\le s_i-k \\times i$$\n\n\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406 $1\\le i\\le n$ \u7684\u6240\u6709 $i$\uff0c\u6240\u4ee5\u5c31\u53d8\u6210\u4e86\u5728 $1\\le j < i$ \u4e2d\u627e\u5c0f\u4e8e\u7b49\u4e8e $s_i -k\\times i$ \u7684\u503c\u3002\u663e\u7136\u53ef\u4ee5\u7528\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u53bb\u7ef4\u62a4\uff0c\u7c7b\u4f3c\u4e8e\u6c42\u9006\u5e8f\u5bf9\uff0c\u5f00\u4e00\u4e2a\u503c\u57df\u5927\u5c0f\u7684\u6811\u72b6\u6570\u7ec4\uff0c\u6309\u7167\u9006\u5e8f\u5bf9\u7684\u6c42\u6cd5\u6765\u5c31\u597d\u4e86\u3002\n\n\u6ce8\u610f\uff0c\u5f53 $j=1$ \u65f6\uff0c$j-1$ \u4e3a $0$\uff0c\u5728 $1\\le i\\le n$ \u7684\u9884\u5904\u7406\u4e2d\u662f\u5904\u7406\u4e0d\u5230\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u628a\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u7559\u51fa\u6765\u7ed9 $0$\uff0c\u540e\u9762\u6574\u4f53\u632a\u4e00\u4e2a\u4f4d\u7f6e\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N =1e6+10;\n#define int long long\t\nint n,k;\nstruct node\n{\n\tint val,num;\n}a[N];\nbool cmp(node a,node b)\n{\n\tif(a.val==b.val)\n\t\treturn a.num<b.num;\n\treturn a.val<b.val;\n}\nint ranks[N],c[N],s[N];\nint lowbit(int x)\n{\n\treturn x&-x;\n}\nvoid update(int x,int change)\n{\n\tfor(int i=x;i<=n+1;i+=lowbit(i))\n\t\tc[i]+=change;\n}\nint Query(int x)\n{\n\tint sum=0;\n\tfor(int i=x;i>0;i-=lowbit(i))\n\t\tsum+=c[i];\n\treturn sum;\n}\nsigned main()\n{\n\tcin>>n>>k;\n\tfor(int i=1,x;i<=n;i++)\n\t\tcin>>x,s[i]=s[i-1]+x;\n\ta[1].val=0,a[1].num=1;\n\tfor(int i=2;i<=n+1;i++)\n\t\ta[i].val=s[i-1]-k*(i-1),a[i].num=i;\n\tsort(a+1,a+n+2,cmp);\n\tfor(int i=0;i<=n+1;i++)\t\n\t\tranks[a[i].num]=i;\n\tint ans=0;\n\tfor(int i=1;i<=n+1;i++)\n\t\tans+=Query(ranks[i]),update(ranks[i],1);\n\tcout<<ans<<endl;\n\treturn 0;\n}\n\n```\n",
        "postTime": 1677392924,
        "uid": 361141,
        "name": "_JF_",
        "ccfLevel": 0,
        "title": "[ARC075E] Meaningful Mean"
    },
    {
        "content": "**\u770b\u4e86\u4e00\u773c\u53d1\u73b0\u8fd8\u6ca1\u6709\u7528\u5e73\u8861\u6811\u7684\u9898\u89e3\uff0c\u4e8e\u662f\u81ea\u5df1\u5199\u4e00\u7bc7\u3002**\n\n~~\u4e5f\u662f\u849f\u84bb\u7684\u7b2c\u4e00\u7bc7\u9898\u89e3~~\n\n------\n### AT2581\n\n\n\u9996\u5148\u601d\u8003\u5c06\u6bcf\u4e00\u4e2a $a_i$ \u90fd\u5199\u6210 $k+b_i$ \u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u4e00\u4e2a\u957f\u5ea6\u4e3a $len$ \u7684\u533a\u95f4\u7684\u5e73\u5747\u6570 $x$ \u4e3a\n\n$$x=\\frac{len\\times k+\\sum b_i}{len}=k+\\frac{\\sum b_i}{len}$$\n\n\u82e5 $\\sum b_i\\ge0$\uff0c\u5219\u6b64\u533a\u95f4\u5e73\u5747\u6570 $x\\ge k$\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u6bcf\u4e00\u4e2a $a_i$ \u90fd\u51cf\u53bb $k$ \u540e\uff0c\u518d\u8003\u8651\u6709\u591a\u5c11\u5b50\u533a\u95f4\u7684\u548c\u5927\u4e8e\u7b49\u4e8e $0$\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u533a\u95f4\u957f\u5ea6\u7684\u5f71\u54cd\u3002\n\n\u65e2\u7136\u662f\u533a\u95f4\u548c\uff0c\u4e0d\u96be\u60f3\u5230\u505a\u4e00\u904d\u524d\u7f00\u548c\uff0c\u5728\u524d\u7f00\u548c\u6570\u7ec4\u4e0a\u5bfb\u627e\u5dee\u5927\u4e8e\u7b49\u4e8e $0$ \u7684\u4e24\u70b9\u3002\n\n\u90a3\u6211\u4eec\u679a\u4e3e\u6bcf\u4e00\u4e2a\u5de6\u7aef\u70b9\uff0c\u5728\u53f3\u8fb9\u8ba1\u7b97\u5927\u4e8e\u7b49\u4e8e\u5de6\u7aef\u70b9\u7684\u503c\u7684\u6570\u91cf\u3002\n\n\u65e2\u7136\u679a\u4e3e\u662f $O(n)$ \u7684\uff0c\u90a3\u6211\u4eec\u60f3\u5230\u53ef\u4e0d\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u6570\u636e\u7ed3\u6784\u5728 $\\log{n}$ \u7684\u65f6\u95f4\u5185\u5b8c\u6210\u4e00\u6b21\u8ba1\u7b97\uff0c\u5728\u4e00\u4e2a\u6570\u7ec4\u4e2d\u627e\u5230\u5927\u4e8e\u7b49\u4e8e\u4e00\u4e2a\u503c\u7684\u6570\u7684\u6570\u91cf\u3002\n\n\u55ef\uff0c\u6211\u4eec\u60f3\u5230\u6709\u4e00\u4e2a\u53eb\u505a\u5e73\u8861\u6811\u7684\u4e1c\u897f,\uff08\u4e0d\u4f1a\u7684\u540c\u5b66\u53ef\u4ee5\u8f6c\u53bbP3396\uff09\u4f3c\u4e4e\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u503c\u5728\u5e8f\u5217\u4e2d\u7684\u6392\u540d\u3002\u771f\u662f\u4e0d\u9519\u3002\n\n\u6211\u4eec\u4ece\u7b2c $n$ \u4e2a\u4f4d\u7f6e\u5f80\u56de\u904d\u5386\uff0c\u8bb0 $sum$ \u4e3a $b_i$ \u7684\u524d\u7f00\u548c\u6570\u7ec4\u3002\u5bf9\u4e8e\u4f4d\u7f6e $i$\uff0c\n\u6211\u4eec\u5c06 $sum_i$ \u4e22\u8fdb\u5e73\u8861\u6811\u4e2d\uff0c\u540c\u65f6\u8ba1\u7b97\u5927\u4e8e\u7b49\u4e8e $sum_{i-1}$ \u7684\u503c\u7684\u6570\u91cf\uff0c\u5e76\u52a0\u8fdb\u7b54\u6848\u4e2d\u3002\u5355\u6b21\u63d2\u5165\u4e0e\u67e5\u8be2\u90fd\u662f $O(\\log{n})$ \u7684\u3002\u6240\u4ee5\u603b\u590d\u6742\u5ea6\u4e3a $O(n\\log{n})$\u3002\n\n\u8fd9\u91cc\u6211\u7528\u7684\u662f `FHQ`\uff0c\u6ce8\u610f\u8981\u5f00 `long long` \u54e6\u3002\n                            \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int Mx=2e5+5;\nint n,k,a[Mx],s[Mx];\nint val[Mx],key[Mx],tot=0,ls[Mx],rs[Mx],siz[Mx],root;\n//\u4ee5\u4e0b\u4e3aFHQ\nvoid push_up(int p){siz[p]=siz[ls[p]]+siz[rs[p]]+1;}\nint add(int w){\n    ++tot;val[tot]=w;key[tot]=rand();siz[tot]=1;\n    return tot;\n}\n//\u52a0\u70b9\nvoid spl(int p,int v,int &x,int &y){\n    if(!p)return x=y=0,void();\n    if(val[p]<=v)spl(rs[p],v,rs[x=p],y);\n    else spl(ls[p],v,x,ls[y=p]);\n    push_up(p);\n}\n//\u5206\u88c2\nint mer(int x,int y){\n    if(!x||!y)return x|y;\n    if(key[x]<key[y])return ls[y]=mer(x,ls[y]),push_up(y),y;\n    else return rs[x]=mer(rs[x],y),push_up(x),x;\n}\n//\u5408\u5e76\nvoid insert(int v){\n    int x=0,y=0;\n    spl(root,v-1,x,y);\n    root=mer(mer(x,add(v)),y);\n}\n//\u63d2\u5165\nint query_val(int v){\n    int x=0,y=0,ans;\n    spl(root,v-1,x,y);\n    ans=siz[y];\n    root=mer(x,y);\n    return ans;\n}\n//\u67e5\u8be2\u6bd4v\u5927\u7684\u503c\u7684\u6570\u91cf\n//\u4ee5\u4e0a\u4e3aFHQ\nsigned main(){\n    // freopen(\"input.txt\",\"r\",stdin);\n    // freopen(\"output.txt\",\"w\",stdout);\n    scanf(\"%lld%lld\",&n,&k);\n    for(int i=1;i<=n;i++)scanf(\"%lld\",&a[i]),a[i]-=k;\n    for(int i=1;i<=n;i++)s[i]=s[i-1]+a[i];\n    int ans=0;\n    for(int i=n;i>=1;i--){\n        insert(s[i]);\n        int res=query_val(s[i-1]);\n        ans+=res;\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1666005129,
        "uid": 399650,
        "name": "_ZZQ_",
        "ccfLevel": 6,
        "title": "AT2581\u9898\u89e3"
    },
    {
        "content": "\u53ef\u4ee5\u628a $a$ \u7684\u6bcf\u4e2a\u6570\u51cf\u53bb $k$\uff0c\u90a3\u4e48*\u5e73\u5747\u503c\u5927\u4e8e $k$* \u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a**\u548c $\\ge 0$**\uff0c\u4e5f\u5c31\u662f\u524d\u7f00\u548c $s[i]-s[j]\\ge 0(i>j)$\u3002\n\n\u505a\u524d\u7f00\u548c\uff0c\u7528\u6811\u72b6\u6570\u7ec4\u6570\u51fa\u6709\u591a\u5c11\u4e2a $s[j]\\le s[i](i>j)$ \u5373\u53ef\u3002\n\n\u503c\u57df\u5f88\u5927\uff0c\u53ef\u4ee5\u7528 `unordered_map` \u4f5c\u4e3a\u6811\u72b6\u6570\u7ec4\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log V)$\uff0c$V$ \u4e3a\u503c\u57df\u3002\u5e38\u6570\u8f83\u5927\uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7\u3002\n\n```cpp\nconst int N = 200005;\nconst ll B = 2e14 + 5, V = B << 1; // +B \u907f\u514d\u8d1f\u6570\u3002\nint n; ll k, a[N];\nunordered_map<ll, int> tr;\nll lowbit(ll x) { return x & -x; }\nvoid add(ll p, int v) { while (p <= V) tr[p] += v, p += lowbit(p); }\nint access(ll p) { auto it = tr.find(p); return (it == tr.end()) ? 0 : it->second; }\nint query(ll p) { ll v = 0; while (p) v += access(p), p ^= lowbit(p); return v; }\n\nint main() {\n    rd(n, k);\n    U (i, 1, n) rd(a[i]), a[i] -= k, a[i] += a[i - 1];\n    ll ans = 0;\n    U (i, 1, n) {\n        add(a[i - 1] + B, 1);\n        ans += query(a[i] + B);\n    }\n    printf(\"%lld\", ans);\n    return 0;\n}\n```",
        "postTime": 1653750831,
        "uid": 120324,
        "name": "Yansuan_HCl",
        "ccfLevel": 7,
        "title": "[\u9898\u89e3] AT2581 [ARC075C] Meaningful Mean"
    }
]
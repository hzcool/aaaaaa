[
    {
        "content": "\u8fd9\u4e2a\u4e8c\u5206\u5f88\u6709\u610f\u601d\u6b38\n\n\u9996\u5148\u671f\u671b DP\uff0c\u8bbe $f_{x,i}$ \u8868\u793a\u5728\u70b9 $x$ HP \u4e3a $i$ \u7684\u671f\u671b\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e5f\u5f88\u5bb9\u6613\u5217\u51fa\n\n$$\nf_{x,j}=\\min\\{f_{1,H}+H-j,1+\\mathbb{E}_{(x,y)\\in E}(f_{y,j-d_y})\\}\n$$\n\n\u8fb9\u754c\n\n$$f_{x,j}=\\infty\\ (j\\leq0)$$\n\n$$f_{n,j}=0\\ (j>0)$$\n\n\n\u4f46\u8fd9\u4e2a\u662f\u6709\u540e\u6548\u6027\u7684\uff0c\u4e0d\u8fc7\u540e\u6548\u6027\u53ea\u4e0e $f_{1,H}$ \u6709\u5173\uff0c\u6211\u4eec\u8003\u8651\u94a6\u5b9a $f_{1,H}=A$\uff0c\u7136\u540e\u76f4\u63a5\u6309\u65b9\u7a0b\u8f6c\u79fb\uff0c\u6700\u540e\u5728\u770b\u7b97\u51fa\u7684\u5b9e\u9645 $f_{1,H}$ \u662f\u5426\u7b49\u4e8e $A$\u3002\n\n\u6211\u4eec\u628a\u8fd9\u6837\u8ba1\u7b97\u51fa\u6765\u7684 $f_{1,H}$ \u770b\u6210\u662f $A$ \u7684\u51fd\u6570 $g(A)$\uff0c\u60f3\u4e00\u60f3\u5c31\u6709 $g^\\prime(A)\\leq1$\uff0c\u6240\u4ee5\u5c31\u6709 $[g(A)-A]^\\prime\\leq 0$ \u4ed6\u662f\u6709\u5355\u8c03\u6027\u7684\uff0c\u53ef\u4ee5\u4e8c\u5206\u51fa $g(A)=A$ \u7684 $A$\uff0c\u4e5f\u5c31\u662f\u7b54\u6848\u3002\n\n\u81f3\u4e8e\u8fd9\u4e2a $g^\\prime(A)\\leq 1$ \u5e94\u8be5\u4e5f\u53ef\u4ee5\u611f\u6027\u8bc1\u660e\uff0c\u8003\u8651\u6309\u62d3\u6251\u5e8f\u5f52\u7eb3\uff0c\u8003\u8651 $A$ \u51cf\u5c0f\u4e86 $\\mathrm{d}A$\uff0c$f_{n,\\star}$ \u4e0d\u4f1a\u53d8\u6240\u4ee5\u5b83\u7684\u5bfc\u6570\u662f $0\\leq1$\uff0c$f_{x,j}$ \u5982\u679c\u4ece $A+H-j$ \u8f6c\u79fb\u6765\u90a3\u4e48 $\\mathrm{d}f_{x,j}=\\mathrm{d}A$\uff0c\u5982\u679c\u4ece $f_{y,\\star}$ \u8f6c\u79fb\u6765\uff0c\u90a3\u4e48 $\\mathrm{d}f_{x,j}=\\mathrm{d}f_{y,\\star}\\leq \\mathrm{d}A$ \u4e5f\u662f\u6210\u7acb\u7684\uff0c\u6240\u4ee5\u5c31\u8bc1\u660e\u4e86\u6052\u6709 $\\mathrm{d}f_{\\star,\\star}/\\mathrm{d}A\\leq1$\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cctype>\n#include<queue>\nusing namespace std;\n\ninline int read(){\n\tint x=0; char c=getchar();\n\twhile(!isdigit(c)) c=getchar();\n\twhile(isdigit(c)) x=x*10+(c^'0'),c=getchar();\n\treturn x;\n} \n\nint n,m,H,d[110];\n\nstruct Edge{ int to,next;}edge[10010];\nint head[110],cnt;\ninline void addedge(int u,int v){\n\tedge[++cnt]=(Edge){v,head[u]};\n\thead[u]=cnt;\n}\n\nconst double eps=1e-8;\nconst double inf=1e12;\n\ndouble A,f[110][110];\nbool v[110];\n\nvoid dfs(int x){\n\tv[x]=true;\n\tfor(int j=1;j<=H;j++) f[x][j]=0;\n\tint deg=0;\n\tfor(int i=head[x];i;i=edge[i].next){\n\t\tint y=edge[i].to;\n\t\tif(!v[y]) dfs(y);\n\t\tfor(int j=1;j<=H;j++){\n\t\t\tif(j-d[y]<=0) f[x][j]=inf;\n\t\t\telse f[x][j]+=f[y][j-d[y]];\n\t\t}\n\t\tdeg++;\n\t}\n\tfor(int j=1;j<=H;j++){\n\t\tif(x<n){\n\t\t\tif(x==1&&j==H) f[x][j]=1+f[x][j]/deg;\n\t\t\telse \n\t\t\t\tf[x][j]=min(A+H-j,1+f[x][j]/deg);\n\t\t} else\n\t\t\tf[x][j]=0;\n\t}\n}\n\ndouble calc(double mid){\n\tA=mid;\n\tmemset(v,0,sizeof(v));\n\tdfs(1);\n\tif(!v[n]) return inf;\n\treturn f[1][H];\n}\n\nint main(){\n\tn=read(),m=read(),H=read();\n\tfor(int i=1;i<=m;i++){\n\t\tint f=read(),t=read();\n\t\taddedge(f,t);\n\t}\n\tfor(int i=1;i<=n;i++) d[i]=read();\n\t\n\tdouble l=0,r=1e6+10;\n\twhile(r-l>eps){\n\t\tdouble mid=(l+r)/2;\n\t\tif(calc(mid)>mid) l=mid;\n\t\telse r=mid;\n\t}\n\t\n\tif(l>1e6) puts(\"-1\");\n\telse printf(\"%.6lf\\n\",l);\n\n\treturn 0;\n}\n\n```",
        "postTime": 1650600155,
        "uid": 176569,
        "name": "iMya_nlgau",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 AT771 \u8ecd\u8266\u30b2\u30fc\u30e0"
    }
]
[
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\n\u6709\u4e00\u5f20 $N$ \u4e2a\u70b9 $2M$ \u6761\u8fb9\u7684\u6709\u5411\u56fe\uff0c\u7b2c $i$ \u6761\u8fb9\u662f\u4e00\u6761\u4ece\u7b2c $A_i$ \u4e2a\u70b9\u5230\u7b2c $B_i$ \u4e2a\u70b9\uff0c\u6743\u503c\u4e3a $C_i$ \u7684\u8fb9\uff0c\u7b2c $i+m$ \u6761\u8fb9\u662f\u4e00\u6761\u4ece\u7b2c $B_i$ \u4e2a\u70b9\u5230\u7b2c $A_i$ \u4e2a\u70b9\uff0c\u6743\u503c\u4e3a $-C_i$ \u7684\u8fb9\u3002\u73b0\u7ed9\u5b9a $Q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u5b9a $X_i,Y_i$\uff0c\u4f60\u9700\u8981\u8f93\u51fa\u4ece\u7b2c $X_i$ \u4e2a\u70b9\u5230\u7b2c $Y_i$ \u4e2a\u70b9\u7684\u8def\u5f84\u4e0a\u7684\u6743\u503c\u6700\u5927\u503c\uff08\u53ef\u4ee5\u91cd\u590d\u7ecf\u8fc7\u67d0\u4e2a\u70b9\u6216\u67d0\u6761\u8fb9\uff09\u3002\u5982\u679c\u4e24\u70b9\u4e0d\u8fde\u901a\uff0c\u8f93\u51fa `nan`\uff1b\u5982\u679c\u6700\u5927\u503c\u4e3a\u65e0\u9650\u5927\uff0c\u8f93\u51fa `inf`\u3002\n\n\u8f93\u5165\u683c\u5f0f\uff1a\u7b2c\u4e00\u884c\u4e09\u4e2a\u6574\u6570 $N,M,Q$\uff0c\u63a5\u4e0b\u6765 $M$ \u884c\u6bcf\u884c\u4e09\u4e2a\u6574\u6570 $A_i,B_i,C_i$\uff0c\u518d\u63a5\u4e0b\u6765 $Q$ \u884c\u6bcf\u884c\u4e24\u4e2a\u6574\u6570 $X_i,Y_i$\uff0c\u8868\u793a $Q$ \u7ec4\u8be2\u95ee\u3002\n\n\u8f93\u51fa\u683c\u5f0f\uff1a\u5171 $Q$ \u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u6574\u6570\u6216\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u5bf9\u5e94\u8be2\u95ee\u7684\u56de\u7b54\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$2 \\le N \\le 10^5$\uff0c$0 \\le M \\le 10^5$\uff0c$1 \\le Q \\le 10^5$\uff0c$1 \\le A_i,B_i,X_i,Y_i \\le N$\uff0c$0 \\le C_i \\le 10^9$\u3002\n\n------------\n\n### \u89e3\u6cd5\u5206\u6790\n\n\u8d5b\u65f6\u88ab D \u628a\u5fc3\u6001\u641e\u5d29\u4e86\u6ca1\u53bb\u4ed4\u7ec6\u60f3\uff0c\u8d5b\u540e\u542c\u5b66\u957f\u8bb2\u8bc4\u540e\u53d1\u73b0\u662f\u5f88\u6709\u610f\u601d\u7684\u4e00\u9053\u9898\u3002\n\n\u4e0b\u9762\u7684\u5206\u6790\u5168\u90e8\u5efa\u7acb\u5728\u672c\u9898\u56fe\u7684\u7279\u6b8a\u6027\u8d28\u6761\u4ef6\u7684\u57fa\u7840\u4e0a\u3002\n\n\u663e\u7136\u7684\u662f\u53ea\u8981 $X_i,Y_i$ \u4e0d\u5728\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\uff0c\u8fd9\u7ec4\u8be2\u95ee\u7684\u7b54\u6848\u5c31\u662f `nan`\u3002\n\n\uff08~~\u7136\u800c\u8d5b\u65f6\u7684\u6211\u6b62\u6b65\u4e8e\u6b64\u3002~~\uff09\n\n\u540c\u6837\u663e\u7136\u7684\u662f\u53ea\u8981 $X_i,Y_i$ \u5728\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\uff0c\u800c\u4e14\u8fd9\u4e2a\u8fde\u901a\u5757\u5185\u5b58\u5728\u6b63\u73af\u7684\u8bdd\uff0c\u8fd9\u7ec4\u8be2\u95ee\u7684\u7b54\u6848\u5c31\u662f `inf`\u3002\n\n\u5e76\u4e14\uff0c\u53ea\u8981\u6709\u8d1f\u73af\uff0c\u5c31\u4e00\u5b9a\u6709\u6b63\u73af\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\n\n\u90a3\u53ea\u51fa\u73b0\u4ec0\u4e48\u6837\u7684\u73af\u624d\u80fd\u4e0d\u5b58\u5728\u6b63\u73af\u6216\u8005\u8d1f\u73af\u5462\uff1f\n\n\u8fb9\u4e0a\u6743\u503c\u4e4b\u548c\u4e3a $0$ \u7684\u73af\u3002\n\n\u800c\u4e14\uff0c\u663e\u7136\u73af\u4e0a\u4efb\u610f\u4e24\u70b9\u4e4b\u95f4\u90fd\u6709\u4e24\u6761\u7b80\u5355\u8def\u5f84\uff0c\u7136\u540e\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u5f53\u73af\u6ee1\u8db3\u8fb9\u6743\u4e4b\u548c\u4e3a $0$ \u7684\u6761\u4ef6\u65f6\uff0c\u8fd9\u4e24\u6761\u8def\u5f84\u7684\u6743\u503c\u76f8\u540c\u3002\n\n\u6240\u4ee5\uff0c**\u5f53\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\u4e0d\u5b58\u5728\u6b63\u73af\u4e0e\u8d1f\u73af\u65f6\uff0c\u5757\u4e0a\u4efb\u610f\u4e24\u70b9\u4e4b\u95f4\u4e0d\u7ba1\u6709\u591a\u5c11\u6761\u4e0d\u540c\u8def\u5f84\uff0c\u5b83\u4eec\u7684\u6743\u503c\u90fd\u662f\u76f8\u7b49\u7684\u3002**\n\n\u4fe1\u606f\u91cf\u6709\u70b9\u5927\uff0c\u82b1\u70b9\u65f6\u95f4\u7406\u89e3\u4e00\u4e0b\u3002\n\n\u4e8e\u662f\u5229\u7528\u4e0a\u9762\u7684\u7ed3\u8bba\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u79cd\u89e3\u6cd5\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\uff0c\u4ece\u5757\u4e0a\u4efb\u610f\u4e00\u70b9\u641c\u7d22\u6574\u4e2a\u5757\uff0c\u8bbe\u8fd9\u4e2a\u70b9\u4e0e\u7b2c $i$ \u4e2a\u70b9\u7684\u8ddd\u79bb\u4e3a $dis_i$\u3002\u7531\u521a\u521a\u7684\u7ed3\u8bba\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u5982\u679c\u5757\u5185\u4e0d\u5b58\u5728\u6b63\u73af\u7684\u8bdd $dis_i$ \u662f\u552f\u4e00\u7684\uff0c\u5982\u679c\u4e0d\u552f\u4e00\u5c31\u8bf4\u660e\u6709\u6b63\u73af\u3002\u5982\u679c\u8be2\u95ee\u4e2d\u7684 $X_i,Y_i$ \u5728\u540c\u4e00\u8fde\u901a\u5757\u4e14\u5757\u5185\u4e0d\u5b58\u5728\u6b63\u73af\u7684\u8bdd\uff0c\u8fd9\u4e00\u7ec4\u8be2\u95ee\u7684\u7b54\u6848\u5c31\u4e3a $dis_{Y_i}-dis_{X_i}$\uff08\u53ef\u4ee5\u7406\u89e3\u4e3a $dis_{Y_i}+(-dis_{X_i})$\u3002\u540c\u6837\u5229\u7528\u7ed3\u8bba\uff0c\u4e24\u70b9\u4e4b\u95f4\u6240\u6709\u8def\u5f84\u6743\u503c\u76f8\u7b49\uff0c\u6240\u4ee5\u53ea\u8981\u6c42\u51fa\u4efb\u610f\u4e00\u6761\u8def\u5f84\u7684\u6743\u503c\u5c31\u8db3\u591f\u4e86\uff09\u3002\n\n------------\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define pb push_back\n#define pll pair<ll,ll>\nusing namespace std;\nconst ll N=1e5+7;\nll n,m,q,coid,vis[N],dis[N],isnf[N],co[N];\nvector <pll > v[N];\nvoid dfs(ll pos) {\n\tco[pos]=coid; // \u8bb0\u8fde\u901a\u5757\u7f16\u53f7\n\tfor (pll i:v[pos]) {\n\t\tll x=i.first,y=i.second;\n\t\tif (!vis[x]) dis[x]=dis[pos]+y,vis[x]=1,dfs(x);\n\t\telse if (dis[x]!=dis[pos]+y) isnf[coid]=1; // \u5b58\u5728\u4e0d\u76f8\u7b49\u8def\u5f84\uff0c\u5219\u6709\u6b63\u73af\uff0c\u6ce8\u610f\u8fd9\u4e2a\u65f6\u5019\u8fd8\u4e0d\u80fd\u76f4\u63a5\u9000\u51fa\uff0c\u4f60\u8fde\u901a\u5757\u7f16\u53f7\u8fd8\u6ca1\u8bb0\u5b8c\u5450\n\t}\n}\nint main() {\n\tscanf(\"%lld%lld%lld\",&n,&m,&q);\n\tfor (ll i=1,r1,r2,r3;i<=m;i++)\n\t\tscanf(\"%lld%lld%lld\",&r1,&r2,&r3),v[r1].pb({r2,r3}),v[r2].pb({r1,-r3});\n\tfor (ll i=1;i<=n;i++) if (!vis[i]) coid++,vis[i]=1,dfs(i); // \u5bf9\u6bcf\u4e2a\u8fde\u901a\u5757\u641c\u7d22\n\tfor (ll r1,r2;q--;) {\n\t\tscanf(\"%lld%lld\",&r1,&r2);\n\t\tif (co[r1]!=co[r2]) printf(\"nan\\n\"); // \u4e0d\u5728\u540c\u4e00\u8fde\u901a\u5757\n\t\telse if (isnf[co[r1]]) printf(\"inf\\n\"); // \u6709\u6b63\u73af\n\t\telse printf(\"%lld\\n\",dis[r2]-dis[r1]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1670649471,
        "uid": 319803,
        "name": "CarroT1212",
        "ccfLevel": 6,
        "title": "ABC280F Sol"
    },
    {
        "content": "\u9996\u5148\u5206\u6790\u4e00\u4e0b\u9898\u76ee\u6240\u7ed9\u56fe\u7684\u7279\u6b8a\u6027\u8d28\uff1a\u8be5\u56fe\u4e0a\u7684\u8fb9\u603b\u662f\u6210\u5bf9\u51fa\u73b0\uff0c\u4e14\u4e00\u5bf9\u65b9\u5411\u76f8\u53cd\u7684\u8fb9\u6743\u503c\u4e92\u4e3a\u76f8\u53cd\u6570\u3002\u4e4b\u540e\u4f1a\u53d1\u73b0\uff0c\u8fd9\u4e00\u7279\u6b8a\u6027\u8d28\u4f1a\u5927\u5927\u7b80\u5316\u540e\u7eed\u95ee\u9898\u7684\u6c42\u89e3\u3002\n\n\u5148\u89e3\u51b3\u7b2c\u4e00\u4e2a\u5b50\u95ee\u9898\uff1a\u4e24\u70b9\u95f4\u8def\u5f84\u5b58\u5728\u6027\u7684\u5224\u5b9a\u3002\u56e0\u4e3a\u672c\u9898\u56fe\u4e0a\u8fb9\u603b\u662f\u6210\u5bf9\u51fa\u73b0\uff0c\u6240\u4ee5\u76f4\u63a5\u4f7f\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u8fde\u901a\u6027\u5373\u53ef\uff0c\u4e0d\u518d\u8d58\u8ff0\u3002\n\n\u73b0\u5728\u8003\u8651\u5982\u4f55\u5224\u5b9a\u201c\u4e24\u70b9\u95f4\u6700\u957f\u8def\u4e0d\u5b58\u5728\u201d\u8fd9\u4e00\u70b9\u3002\u8be5\u95ee\u9898\u663e\u7136\u7b49\u4ef7\u4e8e\u5224\u5b9a\u4e24\u70b9\u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u5185\u662f\u5426\u5b58\u5728\u6b63\u6743\u73af\u3002\u540c\u6837\uff0c\u5229\u7528\u8be5\u56fe\u7684\u7279\u6b8a\u6027\u8d28\uff0c\u6b63\u6743\u73af\u5224\u5b9a\u53ef\u4ee5\u8f6c\u5316\u4e3a\u8d1f\u6743\u73af\u5224\u5b9a\u3002\n\n\u76f4\u63a5\u4f7f\u7528\u5e38\u89c4\u7684 Bellman-Ford \u7b97\u6cd5\u5224\u5b9a\u8d1f\u73af\uff0c\u5e76\u6c42\u89e3\u6700\u957f\u8def\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(nm)$ \u7684\uff0c\u5e76\u4e0d\u80fd\u6ee1\u8db3\u89e3\u51b3\u95ee\u9898\u7684\u9700\u8981\u3002\n\n\u8003\u8651\u5229\u7528\u8be5\u56fe\u7684\u7279\u6b8a\u6027\u8d28\u7b80\u5316\u95ee\u9898\u3002\u6ce8\u610f\u5230\uff0c\u5728\u6b63\u6743\u73af\u548c\u8d1f\u6743\u73af\u90fd\u4e0d\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\uff0c\u56fe\u4e0a\u5373\u4f7f\u5b58\u5728\u73af\u8def\uff0c\u4e5f\u53ea\u80fd\u662f\u96f6\u6743\u73af\u8def\u3002\u4ece\u96f6\u6743\u73af\u8def\u4e0a\u7684 $u$ \u70b9\u5230 $v$ \u70b9\u65f6\uff0c\u4e24\u4e2a\u65b9\u5411\u7684\u8ddd\u79bb\u662f\u76f8\u7b49\u7684\u3002\u63a8\u800c\u5e7f\u4e4b\uff0c\u5982\u679c\u56fe\u4e0a\u4e0d\u5b58\u5728\u6b63\uff08\u8d1f\uff09\u6743\u73af\uff0c\u4ece $u$ \u70b9\u5230 $v$ \u70b9\u7684\u4efb\u4f55\u4e00\u6761\u8def\u5f84\u7684\u957f\u5ea6\u5747\u76f8\u7b49\uff01\n\n\u5728\u8fd9\u4e00\u524d\u63d0\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4efb\u610f\u6307\u5b9a\u56fe\u4e0a\u4e00\u70b9 $s$ \u4e3a\u8d77\u70b9\u8dd1 DFS\uff0c\u6c42\u51fa $s$ \u5230\u56fe\u4e0a\u4efb\u610f\u4e00\u70b9\u7684\u8ddd\u79bb $dis(u)$\uff0c\u5e76\u5b8c\u6210\u8be5\u8fde\u901a\u5206\u91cf\u5185\u6b63\uff08\u8d1f\uff09\u73af\u7684\u5b58\u5728\u6027\u5224\u5b9a\uff1a\u5982\u679c DFS \u8fc7\u7a0b\u4e2d\u91cd\u590d\u8bbf\u95ee\u4e86\u67d0\u4e2a\u70b9\uff0c\u4e14\u6c42\u51fa\u7684\u8def\u5f84\u957f\u5ea6\u4e0e\u4e4b\u524d\u6c42\u5f97\u7684\u957f\u5ea6\u4e0d\u7b49\uff0c\u5219\u6574\u4e2a\u56fe\u4e00\u5b9a\u5b58\u5728\u6b63\uff08\u8d1f\uff09\u6743\u73af\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u7ec4\u8be2\u95ee $(u,v)$\uff0c\u5229\u7528\u6240\u6709\u8def\u5f84\u7684\u7b49\u8ddd\u6027\uff0c\u53ef\u4ee5\u5c06\u8be5\u8def\u5f84\u8f6c\u6362\u4e3a $u \\to s \\to v$ \u7684\u8def\u5f84\uff0c\u4ece\u800c\u6240\u6c42\u7b54\u6848\u4e3a $dis(v) - dis(u)$\u3002\n\n```cpp\n// Problem: F - Pay or Receive\n// Contest: AtCoder - Denso Create Programming Contest 2022 Winter(AtCoder\n// Beginner Contest 280)\n// URL: https://atcoder.jp/contests/abc280/tasks/abc280_f\n// Author : StudyingFather\n// Site : https://studyingfather.com\n// Memory Limit: 1024 MB\n// Time Limit: 2000 ms\n//\n// Powered by CP Editor (https://cpeditor.org)\n\n#include <algorithm>\n#include <cstring>\n#include <iostream>\n#include <queue>\n#include <vector>\nusing namespace std;\ntypedef pair<int, int> pii;\nstruct dsu {\n  int fa[100005], siz[100005];\n  void init(int n) {\n    for (int i = 1; i <= n; i++) fa[i] = i, siz[i] = 1;\n  }\n  int find(int x) { return fa[x] == x ? x : fa[x] = find(fa[x]); }\n  bool merge(int u, int v) {\n    u = find(u), v = find(v);\n    if (u == v) return false;\n    fa[v] = u, siz[u] += siz[v];\n    return true;\n  }\n  bool together(int u, int v) { return find(u) == find(v); }\n  int size(int u) { return siz[find(u)]; }\n} ds;\nbool vis[100005], inf[100005], inque[100005];\nvector<pii> e[100005];\nlong long dis[100005];\nint n, m, q;\nvoid dfs(int u) {\n  vis[u] = true;\n  for (auto ed : e[u]) {\n    int v = ed.first, w = ed.second;\n    if (vis[v]) {\n      if (dis[v] != dis[u] + w) inf[ds.find(u)] = true;\n    } else {\n      dis[v] = dis[u] + w;\n      dfs(v);\n    }\n  }\n}\nint main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0), cout.tie(0);\n  cin >> n >> m >> q;\n  ds.init(n);\n  for (int i = 1; i <= m; i++) {\n    int u, v, c;\n    cin >> u >> v >> c;\n    e[u].emplace_back(v, c);\n    e[v].emplace_back(u, -c);\n    ds.merge(u, v);\n  }\n  for (int i = 1; i <= n; i++) {\n    if (vis[i]) continue;\n    dfs(i);\n  }\n  while (q--) {\n    int u, v;\n    cin >> u >> v;\n    if (!ds.together(u, v))\n      cout << \"nan\" << '\\n';\n    else if (inf[ds.find(u)])\n      cout << \"inf\" << '\\n';\n    else\n      cout << dis[v] - dis[u] << '\\n';\n  }\n  return 0;\n}\n```",
        "postTime": 1670433378,
        "uid": 22030,
        "name": "StudyingFather",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 ABC280F \u3010Pay or Receive\u3011"
    },
    {
        "content": "## [\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_abc280_f)\n\u9898\u610f\u4e0d\u518d\u8d58\u8ff0\u3002    \n\u6211\u4eec\u4ece\u9898\u76ee\u8981\u6c42\u7684\u56de\u7b54\u6765\u5206\u6790\u9898\u76ee\uff1a   \n\u7b2c\u4e00\u79cd\uff0c\u4e24\u70b9\u4e0d\u80fd\u4e92\u76f8\u5230\u8fbe\uff1a\u56e0\u4e3a\u8fd9\u662f\u4e2a\u65e0\u5411\u56fe\uff0c\u6240\u4ee5\u4f7f\u7528\u5e76\u67e5\u96c6\u6765\u5224\u65ad\u5373\u53ef\u3002   \n\n\u7b2c\u4e8c\u79cd\uff0c\u53ef\u4ee5\u83b7\u5f97\u65e0\u9650\u4ef7\u503c\uff1a\u5373\u5b58\u5728\u6b63\u73af\u4f7f\u5f97\u4ef7\u503c\u4e0d\u53d7\u9650\u5236\uff0c\u8fd9\u79cd\u60c5\u51b5\u6211\u4eec\u53ef\u4ee5\u7528 dfs \u6765\u5224\u65ad\u3002\u56e0\u4e3a\u662f\u65e0\u5411\u56fe\uff0c\u6240\u4ee5\u968f\u4fbf\u9009\u8fd9\u4e2a\u8fde\u901a\u5757\u4e2d\u7684\u4e00\u4e2a\u70b9\uff0c\u4f7f\u7528 dfs \u6765\u8dd1\u4e00\u4e2a\u6700\u77ed\u8def\uff0c\u5982\u679c\u5230\u67d0\u4e2a\u70b9\u7684\u6700\u77ed\u8def\u88ab\u66f4\u65b0\u4e86\uff08\u51fa\u73b0\u4e86\u4e24\u79cd\u4e0d\u540c\u6743\u503c\u7684\u8def\u5f84\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8fde\u901a\u5757\u5c31\u5b58\u5728\u6b63\u73af\u3002    \n\u89e3\u91ca\u4e00\u4e0b\uff0c\u5982\u679c\u51fa\u73b0\u4e86\u4e24\u79cd\u4e0d\u540c\u6743\u503c\u7684\u8def\u5f84\uff0c\u5219\u53ef\u4ee5\u4ece\u8d77\u70b9\u51fa\u53d1\uff0c\u9009\u62e9\u6743\u503c\u8f83\u5927\u7684\u8def\u5f84\u5230\u8fbe\u76ee\u6807\u70b9\uff0c\u518d\u7528\u6743\u503c\u8f83\u5c0f\u7684\u8def\u5f84\u7684\u9006\u8def\u5f84\u8d70\u56de\u53bb\uff0c\u8fd9\u6837\u5c31\u4f1a\u5bfc\u81f4\u6743\u503c\u4e4b\u548c\u5927\u4e8e 0\uff0c\u5373\u5b58\u5728\u6b63\u73af\u3002    \n\n\u7b2c\u4e09\u79cd\uff0c\u8981\u6c42\u8f93\u51fa\u8def\u5f84\u957f\u3002\u5728\u7b2c\u4e8c\u70b9\u4e2d\u6211\u4eec\u5df2\u7ecf\u5206\u6790\u8fc7\u4e86\uff0c\u4e24\u70b9\u95f4\u5982\u679c\u6709\u4e0d\u540c\u957f\u5ea6\u7684\u8def\u5f84\uff0c\u5fc5\u5b9a\u4f1a\u5bfc\u81f4\u6b63\u73af\uff0c\u6240\u4ee5\u5f53\u4e0b\u4e24\u70b9\u4e2d\u4efb\u610f\u4e00\u6761\u8def\u5f84\u5747\u4e3a\u7b54\u6848\u3002\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u6311\u9009\u8fd9\u6837\u4e00\u6761\u8def\u5f84\uff1a\u5728\u7b2c\u4e8c\u70b9\u4e2d\uff0c\u9884\u5904\u7406\u8fd9\u4e2a\u8fde\u901a\u5757\u65f6\uff0c\u6211\u4eec\u9009\u62e9\u4e86 $s$ \u4f5c\u4e3a\u8d77\u70b9\u6765 dfs\uff0c\u4e0d\u59a8\u9009\u62e9\u4ece $x$ \u5230 $s$ \u518d\u5230 $y$ \u8fd9\u6837\u4e00\u6761\u8def\u5f84\uff0c\u6743\u503c\u5373\u4e3a\uff1a$dist[y]-dist[x]$\uff0c\u8f93\u51fa\u5373\u53ef\u3002    \n____\n\u601d\u8def\u5206\u6790\u5b8c\u4e86\uff0c\u90a3\u4e48\u4ee3\u7801\u7684\u5185\u5bb9\u5c31\u51fa\u6765\u4e86\uff0c\u8bfb\u5165\u56fe\u540e\u8dd1\u4e00\u4e0b\u5e76\u67e5\u96c6\uff0c\u518d\u628a\u6bcf\u4e2a\u8fde\u901a\u5757\u90fd\u8dd1\u4e00\u4e2a dfs\uff0c\u5982\u679c\u6709\u6b63\u73af\u5c31\u628a\u8fd9\u4e2a\u8fde\u901a\u5757\u6807\u8bb0\u4e00\u4e0b\u3002\u8f93\u5165\u65f6\u76f4\u63a5\u8c03\u7528\u5373\u53ef\u3002\n____\n\u4e0a\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nlong long n,m,q,k1,k2,k3,head[1000003];\nstruct Edge{\n\tlong long st;\n\tlong long ed;\n\tlong long val;\n\tlong long nxt;\n}E[2000003];\nlong long totE;\nvoid addEdge(long long X,long long Y,long long Z){\n\ttotE++;\n\tE[totE].st=X;\n\tE[totE].ed=Y;\n\tE[totE].val=Z;\n\tE[totE].nxt=head[X];\n\thead[X]=totE;\n\treturn;\n}\nlong long dist[1000003],vis[1000003],bcj[1000003],rd[1000003],sz[1000003];\nvoid dfs(long long now){\n\tfor(long long i=head[now];i!=0;i=E[i].nxt){\n\t\tif(vis[E[i].ed]==0){\n\t\t\tdist[E[i].ed]=dist[now]+E[i].val;\n\t\t\tvis[E[i].ed]=1;\n\t\t\tdfs(E[i].ed);\n\t\t}\n\t\telse{\n\t\t\tif(dist[E[i].ed]!=E[i].val+dist[now]){\n\t\t\t\trd[bcj[now]]=1;\n\t\t\t}\n\t\t}\n\t\tif(rd[bcj[now]])return;\n\t}\n\treturn;\n}\nlong long finf(long long now){\n\tif(bcj[now]!=now)bcj[now]=finf(bcj[now]);\n\treturn bcj[now];\n}\nint main(){\n\tscanf(\"%lld%lld%lld\",&n,&m,&q);\n\tfor(long long i=1;i<=n;i++)bcj[i]=i;\n\tfor(long long i=1;i<=m;i++){\n\t\tscanf(\"%lld%lld%lld\",&k1,&k2,&k3);\n\t\taddEdge(k1,k2,k3);\n\t\taddEdge(k2,k1,-k3);\n\t\tbcj[finf(k2)]=finf(k1);\n\t}\n\tfor(long long i=1;i<=n;i++)\n\t{\n\t\tbcj[i]=finf(i);\n\t\tsz[bcj[i]]++;\n\t}\n\tfor(long long i=1;i<=n;i++){\n\t\tif(!vis[i]){\n\t\t\tdfs(i);\n\t\t}\n\t}\n\twhile(q--){\n\t\tscanf(\"%lld%lld\",&k1,&k2);\n\t\tif(bcj[k1]!=bcj[k2]){\n\t\t\tprintf(\"nan\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tif(rd[bcj[k1]]){\n\t\t\tprintf(\"inf\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tprintf(\"%lld\\n\",dist[k2]-dist[k1]);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1673856726,
        "uid": 340819,
        "name": "cwfxlh",
        "ccfLevel": 5,
        "title": "AT_abc280_f"
    },
    {
        "content": "### \u7b97\u6cd5\u5206\u6790\n\n\u5982\u679c\u4e24\u70b9\u4e0d\u5728\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\uff0c\u5219\u7b54\u6848\u662f `nan`\n\n\u5982\u679c\u4e24\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\u91cc\u5b58\u5728\u975e\u96f6\u8d39\u7528\u7684\u73af\u7684\u8bdd\uff0c\u5219\u7b54\u6848\u662f `inf`\n\n- \u4ece\u4e00\u4e2a\u70b9 $v$ \u51fa\u53d1\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 `dfs` \u6c42\u51fa $v$ \u5230\u6bcf\u4e2a\u70b9\u7684\u8d39\u7528\n\n- \u4ece\u70b9 $v$ \u5230\u67d0\u4e2a\u70b9\u7684\u8d39\u7528\u4e0d\u552f\u4e00\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728\u975e\u96f6\u8d39\u7528\u7684\u73af\n\n\u5bf9\u4e8e\u5176\u4ed6\u60c5\u51b5\uff0c\u6240\u6709\u73af\u7684\u8d39\u7528\u90fd\u662f $0$\uff0c\u6240\u4ee5\u5728\u4efb\u610f $\\text{dfs}$ \u751f\u6210\u6811\u4e2d\u4e24\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u662f\u552f\u4e00\u7684\n\n### \u4ee3\u7801\n```\n#include <bits/stdc++.h>\n#define rep(i, n) for (int i = 0; i < (n); ++i)\n\nusing namespace std;\nusing ll = long long;\n\nstruct Edge {\n    int to, cost;\n    Edge() {}\n    Edge(int to, int cost): to(to), cost(cost) {}\n};\n\nint main() {\n    int n, m, q;\n    cin >> n >> m >> q;\n\n    vector<vector<Edge>> g(n);\n    rep(i, m) {\n        int a, b, c;\n        cin >> a >> b >> c;\n        --a; --b;\n        g[a].emplace_back(b, c);\n        g[b].emplace_back(a, -c);\n    }\n\n    vector<ll> po(n);\n    vector<int> cid(n, -1);\n    vector<bool> ok;\n    int cn = 0;\n    auto dfs = [&](auto& f, int v, ll np=0) -> void {\n        if (cid[v] != -1) {\n            if (po[v] != np) ok[cn] = false;\n            return;\n        }\n        cid[v] = cn;\n        po[v] = np;\n        for (auto e : g[v]) {\n            f(f, e.to, np+e.cost);\n        }\n    }; \n\n    rep(i, n) {\n        if (cid[i] != -1) continue;\n        ok.push_back(true);\n        dfs(dfs, i);\n        cn++;\n    }\n\n    rep(qi, q) {\n        int a, b;\n        cin >> a >> b;\n        --a; --b;\n        if (cid[a] != cid[b]) puts(\"nan\");\n        else if (!ok[cid[a]]) puts(\"inf\");\n        else cout << po[b]-po[a] << '\\n';\n    }\n\n    return 0;\n}\n```",
        "postTime": 1672040443,
        "uid": 775296,
        "name": "sbz_ysc",
        "ccfLevel": 0,
        "title": "[ABC280F] Pay or Receive \u9898\u89e3"
    },
    {
        "content": "\u7ed9\u4e00\u5f20 $n$ \u4e2a\u70b9\u7684\u56fe\uff0c\u6709 $m$ \u4e2a\u4e09\u5143\u7ec4 $(a_i,b_i,c_i)$\uff0c\u8868\u793a $a_i,b_i$ \u95f4\u6709\u4e24\u6761\u8fb9\uff0c$a_i\\to b_i$ \u7684\u6743\u4e3a $c_i$\uff0c$b_i\\to a_i$ \u7684\u8fb9\u6743\u4e3a $-c_i$\u3002$Q$ \u7ec4\u8be2\u95ee\u6c42\u4e24\u70b9\u95f4\u7684\u6700\u957f\u8def\u3002\u5982\u679c\u4e0d\u8fde\u901a\u8f93\u51fa ```nan```\uff0c\u5982\u679c\u6700\u957f\u8def\u65e0\u9650\u5927\u8f93\u51fa ```inf```\u3002\n\n```nan``` \u662f\u5bb9\u6613\u7684\uff0c\u8003\u8651\u600e\u4e48\u505a ```inf```\u3002\u6ce8\u610f\u5230\uff0c\u5982\u679c $x,y$ \u6240\u5728\u8fde\u901a\u5757\u5185\u5b58\u5728\u4e00\u4e2a\u6b63\u73af $l$\uff0c\u90a3\u4e48\u5fc5\u7136\u662f ```inf```\u3002\u8fdb\u4e00\u6b65\u53d1\u73b0\uff0c\u5982\u679c $l$ \u4e3a\u8d1f\u73af\uff0c\u90a3\u4e48 $\\overline l$ \uff08\u5373\u53cd\u5411\u7684 $l$\uff09\u7531\u5b9a\u4e49\u53ef\u77e5\u5176\u4e3a\u6b63\u73af\u3002\u56e0\u6b64\u53ef\u4ee5\u5f97\u77e5\uff1a$x,y$ \u95f4\u4e0d\u662f ```inf```\uff0c\u5f53\u4e14\u4ec5\u5f53\u5176\u6240\u5728\u8fde\u901a\u5757\u5185\u6240\u6709\u73af\u8fb9\u6743\u4e4b\u548c\u4e3a $0$\u3002\n\n\u5982\u679c\u66b4\u529b\u627e\u73af\u7684\u8bdd\uff0c\u73af\u7684\u6570\u91cf\u6709\u53ef\u80fd\u975e\u5e38\u591a\u3002\u4f46\u662f\u6ce8\u610f\u5230\uff0c\u4e0a\u8ff0\u7ed3\u8bba\u672c\u8d28\u4e0a\u7b49\u4ef7\u4e8e\uff1a\u8fde\u901a\u5757\u4e2d\uff0c\u4efb\u610f\u4e24\u70b9 $u,v$ \u5747\u6ee1\u8db3 $u$ \u5230 $v$ \u7684\u6240\u6709\u8def\u5f84\u6743\u503c\u548c\u76f8\u7b49\u3002\u90a3\u4e48\u4f7f\u7528 **[dfs \u6700\u77ed\u8def](https://www.luogu.com.cn/problem/P8881)** \u53ef\u4ee5\u5728\u7ebf\u6027\u65f6\u95f4\u5185\u5f97\u5230\u7b54\u6848\u3002\n\n\u5177\u4f53\u800c\u8a00\uff0c\u968f\u4fbf\u6311\u4e00\u4e2a\u70b9 $u$ \u5f00\u59cb dfs\uff0c\u8fc7\u7a0b\u4e2d\u7ef4\u62a4\u5f53\u524d\u8d70\u8fc7\u8def\u5f84\u7684\u6743\u503c\u548c $dis$\u3002\u6bcf\u6b21\u5230\u8fbe\u4e00\u4e2a\u8d70\u8fc7\u7684\u70b9 $v$ \u65f6\uff0c\u4e0a\u4e00\u6b21\u5230 $v$ \u7684\u8def\u5f84\u6743\u503c\u548c $d_v$ \u4e0e $dis$ \u4e0d\u7b49\uff0c\u5219\u6574\u4e2a\u8fde\u901a\u5757\u90fd\u5b8c\u86cb\u4e86\uff1b\u5426\u5219\u8fd4\u56de\u3002\n\n\u590d\u6742\u5ea6 $O(n+m+(n+Q)\\alpha(n))$\u3002\u5bb9\u6613\u5b9e\u73b0\u81f3 $O(n+m+Q)$\u3002",
        "postTime": 1670718006,
        "uid": 314991,
        "name": "zhouyuhang",
        "ccfLevel": 7,
        "title": "\u5c0f\u6e05\u65b0"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u5f20\u5305\u542b $N$ \u4e2a\u70b9\u548c $2M$ \u6761\u8fb9\u7684\u5e26\u6743\u6709\u5411\u56fe\uff0c\u5bf9\u4e8e $1\\le i \\le M$\uff0c\u7b2c $i$ \u6761\u8fb9\u4ece $A_i$ \u8fde\u5411 $B_i$\uff0c\u8fb9\u6743\u4e3a $C_i$\uff1b\u7b2c $i+M$ \u6761\u8fb9\u4ece $B_i$ \u8fde\u5411 $A_i$\uff0c\u8fb9\u6743\u4e3a $-C_i$\u3002\n\n$Q$ \u6b21\u8be2\u95ee\u4e24\u4e2a\u70b9 $X_i,Y_i$ \u95f4\u6700\u957f\u8def\u3002\u82e5 $X_i,Y_i$ \u4e0d\u8fde\u901a\u5219\u8f93\u51fa `nan`\uff0c\u82e5\u6700\u957f\u8def\u957f\u5ea6\u65e0\u9650\u5219\u8f93\u51fa `inf`\u3002\n\n$2\\le N \\le 10^5,0\\le M\\le 10^5,1\\le Q \\le 10^5$\n\n$1\\le A_i,B_i,X_i,Y_i \\le N,0\\le C_i \\le 10^9$\n\n#### Solution\n\n\u7ed3\u8bba\uff1a\n\n- \u82e5 $X_i$ \u548c $Y_i$ \u4e0d\u5728\u540c\u4e00\u8fde\u901a\u5757\u5219\u7b54\u6848\u4e3a `nan`\u3002\n\n- \u82e5 $X_i$ \u81f3 $Y_i$ \u7684\u6240\u6709\u4e0d\u540c\u8def\u5f84\u957f\u5ea6\u5747\u76f8\u540c\u5219\u7b54\u6848\u4e3a\u8def\u5f84\u957f\u5ea6\uff0c\u5426\u5219\u7b54\u6848\u4e3a `inf`\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u6761\u7684\u8bc1\u660e\uff1a\n\n\u5047\u8bbe\u5b58\u5728\u4e24\u6761\u957f\u5ea6\u4e0d\u76f8\u540c\u7684\u4ece $X_i$ \u81f3 $Y_i$ \u7684\u8def\u5f84\uff0c\u957f\u5ea6\u5206\u522b\u4e3a $W_1$\uff0c$W_2$\u3002\u4e0d\u59a8\u8bbe $W_1<W_2$\uff0c\u7531\u9898\u76ee\u6027\u8d28\u53ef\u5f97\u5fc5\u7136\u5b58\u5728\u4e00\u6761\u4ece $Y_i$ \u81f3 $X_i$ \uff0c\u603b\u957f\u5ea6\u4e3a $-W_1$ \u7684\u8def\u5f84\uff0c\u8fd9\u6837\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u603b\u957f\u5ea6\u4e3a $W_2-W_1>0$ \u7684\u6b63\u73af\uff0c\u56e0\u6b64\u6700\u957f\u8def\u957f\u5ea6\u65e0\u9650\u3002\n\n\u5f15\u7533\u7ed3\u8bba\u4e3a\u540c\u4e00\u8fde\u901a\u5757\u5185\u4e24\u4e2a\u70b9 $X_i$ \u4e0e $Y_i$ \u95f4\u6240\u6709\u4e0d\u540c\u8def\u5f84\u957f\u5ea6\u5747\u76f8\u540c\u5f53\u4e14\u4ec5\u5f53\u8fd9\u4e24\u4e2a\u70b9\u6240\u5c5e\u8fde\u901a\u5757\u4e2d\u7684\u4efb\u610f\u4e24\u4e2a\u70b9\u5747\u6ee1\u8db3\u8be5\u6027\u8d28\uff08\u82e5\u6709\u4e24\u4e2a\u70b9\u4e0d\u6ee1\u8db3\u8be5\u6027\u8d28\uff0c\u5219\u4ece $X_i$ \u81f3 $Y_i$ \u5fc5\u7136\u53ef\u4ee5\u7ecf\u8fc7\u8fd9\u4e24\u4e2a\u70b9\u6240\u5f62\u6210\u7684\u7684\u6b63\u73af\uff0c\u4f7f\u5f97 $X_i$ \u4e0e $Y_i$ \u4e5f\u4e0d\u6ee1\u8db3\u8be5\u6027\u8d28\uff09\uff0c\u4ece\u800c\u8fde\u901a\u5757\u5185\u6bcf\u4e2a\u70b9\u5747\u53ef\u4ee5\u7528\u201c\u52bf\u80fd\u201d\u63cf\u8ff0\uff1a\n\n- \u5bf9\u4e8e\u4e00\u4e2a\u8fde\u901a\u5757\uff0c\u8bbe $x$ \u4e3a\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u70b9\uff0c\u4ee4\u70b9 $x$ \u7684\u52bf\u80fd\u4e3a $0$\uff0c\u540c\u4e00\u8fde\u901a\u5757\u5185\u5176\u4ed6\u70b9\u7684\u52bf\u80fd\u4e3a $x$ \u81f3\u5176\u7684\u8ddd\u79bb\u3002\n\n\u9010\u4e00\u5224\u65ad\u6bcf\u4e2a\u8fde\u901a\u5757\u5185\u7684\u70b9\u662f\u5426\u6ee1\u8db3\u52bf\u80fd\u6027\u8d28\uff0c\u82e5\u6ee1\u8db3\u5219\u6c42\u51fa\u6bcf\u4e2a\u70b9\u7684\u52bf\u80fd\u3002\n\n\u56de\u7b54\u8be2\u95ee\u65f6\u5148\u5224\u65ad\u4e24\u4e2a\u70b9\u662f\u5426\u4f4d\u4e8e\u540c\u4e00\u8fde\u901a\u5757\uff0c\u662f\u7684\u8bdd\u518d\u5224\u65ad\u8be5\u8fde\u901a\u5757\u662f\u5426\u6ee1\u8db3\u52bf\u80fd\u6027\u8d28\uff0c\u82e5\u4e0d\u6ee1\u8db3\u5219\u7b54\u6848\u4e3a `inf`\uff0c\u5426\u5219\u7b54\u6848\u4e3a\u7ec8\u70b9\u52bf\u80fd\u51cf\u53bb\u8d77\u70b9\u52bf\u80fd\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int M=3e5+5;\n#define int long long\nstruct edge{\n\tint u[2*M],nxt[2*M],v[2*M],l[2*M];\n\tint head[M],cnt;\n\tvoid add(int x,int y,int z){\n\t\tcnt++;\n\t\tu[cnt]=x;\n\t\tv[cnt]=y;\n\t\tl[cnt]=z;\n\t\tnxt[cnt]=head[x];\n\t\thead[x]=cnt;\n\t}\n\tvoid init(int n,int m){\n\t\tfor(int i=1;i<=n;i++){\n\t\t\thead[i]=0;\n\t\t}\n\t\tfor(int i=1;i<=m;i++){\n\t\t\tu[i]=v[i]=l[i]=nxt[i]=0;\n\t\t}\n\t\tcnt=0;\n\t}\n}e;\n\nint n,m,q,cnt;\nint p[100005],d[100005],v[100005];\n//p:\u6bcf\u4e2a\u70b9\u6240\u5c5e\u8fde\u901a\u5757\u7f16\u53f7\n//d:\u6bcf\u4e2a\u70b9\u7684\u52bf\u80fd\n//v:\u6bcf\u4e2a\u70b9\u6240\u5728\u8fde\u901a\u5757\u662f(0)/\u5426(1)\u6ee1\u8db3\u52bf\u80fd\u6027\u8d28\nvoid bfs(int u){\n\tqueue<int>q;\n\tq.push(u);\n\tp[u]=++cnt;\n\td[u]=0;\n\tset<int>st;\n\tbool dif=0;\n\twhile(!q.empty()){\n\t\tint u=q.front();\n\t\tq.pop();\n\t\tst.insert(u);\n\t\tfor(int i=e.head[u];i;i=e.nxt[i]){\n\t\t\tint v=e.v[i];\n\t\t\tif(!p[v]){\n\t\t\t\td[v]=d[u]+e.l[i];//\u7ecf\u8fc7\u4e00\u6761\u957f\u5ea6\u4e3al\u7684\u8fb9\u5219\u5c06\u52bf\u80fd\u52a0l\n\t\t\t\tq.push(v);\n\t\t\t\tp[v]=cnt;\n\t\t\t}\n\t\t\telse if(d[v]!=d[u]+e.l[i]){//\u4e0d\u6ee1\u8db3\u52bf\u80fd\u6027\u8d28\n\t\t\t\tdif=1;\n\t\t\t}\n\t\t}\n\t}\n\tif(dif){\n\t\tfor(auto it:st)v[it]=1;//\u82e5\u4e0d\u6ee1\u8db3\u52bf\u80fd\u6027\u8d28\u5219\u5c06\u8fde\u901a\u5757\u5185\u6240\u6709\u70b9\u6253\u4e0a\u6807\u8bb0\n\t}\n}\nsigned main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\tcin>>n>>m>>q;\n\tfor(int i=1;i<=m;i++){\n\t\tint x,y,z;\n\t\tcin>>x>>y>>z;\n\t\te.add(x,y,z);\n\t\te.add(y,x,-z);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tif(!p[i]){\n\t\t\tbfs(i);\n\t\t}\n\t}\n\tfor(int i=1;i<=q;i++){\n\t\tint x,y;\n\t\tcin>>x>>y;\n\t\tif(p[x]!=p[y])cout<<\"nan\"<<endl;//\u4e0d\u5728\u540c\u4e00\u8fde\u901a\u5757\n\t\telse if(v[x])cout<<\"inf\"<<endl;//\u8fde\u901a\u5757\u4e0d\u6ee1\u8db3\u52bf\u80fd\u6027\u8d28\n\t\telse cout<<d[y]-d[x]<<endl;//\u7ec8\u70b9\u52bf\u80fd\u51cf\u53bb\u8d77\u70b9\u52bf\u80fd\n\t}\n}\n```\n\n",
        "postTime": 1670332241,
        "uid": 280163,
        "name": "dapingguo8",
        "ccfLevel": 8,
        "title": "[ABC280F] Pay or Receive"
    }
]
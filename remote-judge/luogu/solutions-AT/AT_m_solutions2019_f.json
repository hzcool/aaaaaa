[
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://blog.imyangty.com/sol-msolutions2019f/)\u3002\n\n~~\u66f4\u8be6\u7ec6\u7684\u4e00\u7bc7\u9898\u89e3\u3002\u8fd9\u9898\u5176\u5b9e\u633a\u7ecf\u5178\u7684\u4e3a\u4ec0\u4e48\u6d1b\u8c37\u4e0a\u4ea4\u7684\u4eba\u4e0d\u591a\u554a/kk~~\n\n## Description\n\n\u7ed9\u5b9a\u4e00\u5f20\u7ade\u8d5b\u56fe\uff0c$i\\to j$ \u6709\u8fde\u8fb9\u8868\u793a $i$ \u80fd\u6253\u8d25 $j$\u3002\u5c06 $1,2,\\cdots,n$ \u6392\u6210\u4e00\u6392\uff0c\u6bcf\u6b21\u53ef\u4ee5\u9009\u76f8\u90bb\u4e24\u4e2a\u4eba\u5e72\u67b6\u7559\u4e0b\u80dc\u8005\uff0c\u95ee\u6700\u540e\u6709\u591a\u5c11\u4eba\u53ef\u80fd\u8d62\u3002\n\nZR \u52a0\u5f3a\u7248\u8981\u6c42\u8f93\u51fa\u65b9\u6848\u3002\n\n## Solution\n\n\u53ef\u4ee5\u8bbe\u8ba1\u51fa\u4e00\u4e2a\u6bd4\u8f83 naive \u7684 dp\uff1a$f_{i, j, k}$ \u8868\u793a $[i, j]$ \u4e2d $k$ \u80fd\u5426\u80dc\u51fa\u3002\u7136\u540e\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5 $O(n^4)$ \u6216\u8005 $O(n^5)$ \u968f\u4fbf\u8f6c\u79fb\u4e00\u4e0b\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u7136\u540e\u8003\u8651\u4f18\u5316\u72b6\u6001\uff1a\u53d1\u73b0\u6211\u4eec\u6ca1\u6709\u5fc5\u8981\u8bbe\u8ba1\u51fa\u8fd9\u4e00\u4e2a\u591a\u4f59\u7684 $k$\uff0c\u56e0\u4e3a $k$ \u80fd\u5728 $[l, r]$ \u4e2d\u80dc\u51fa\u5f53\u4e14\u4ec5\u5f53 $k$ \u80fd\u8d62\u4e86 $[l, k -1] $ \u4e2d\u7684\u4eba\u4e14\u80fd\u8d62 $[k + 1, r]$ \u4e2d\u7684\u4eba\u3002\u4e24\u8fb9\u7684\u8fd9\u4e9b\u4eba\u662f\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u8bbe\u8ba1\u51fa\u4e00\u4e2a $f_{i, j, 0/1}$ \u8868\u793a $i/j$ \u80fd\u5426\u8d62 $[i, j]$ \u4e2d\u7684\u6240\u6709\u4eba\u3002\u72b6\u6001\u77ac\u95f4\u53d8\u4e3a $O(n^2)$ \u7ea7\u522b\u3002\n\n\u4e0b\u9762\u4e3a\u4e86\u597d\u770b\u4e00\u70b9\uff0c\u6211\u4eec\u4ee4 $L_{i, j}$ \u4e3a\u4e0a\u6587\u7684 $f_{i, j, 0}$\uff0c$R_{i, j}$ \u4e3a\u4e0a\u6587\u7684 $f_{i, j ,1}$\u3002\n\n\u4e8e\u662f\u8f6c\u79fb\u5c31\u6765\u4e86\uff1a\n\n$$\n\\begin{aligned}\nL_{i, j} &= \\max_{i < k \\le j}\\{L_{k, j}\\land R_{i + 1, k}\\land a_{i, k}\\}\\\\\nR_{i, j} &= \\max_{i < k \\le j}\\{L_{k, j - 1}\\land R_{i, k}\\land a_{j, k}\\}\n\\end{aligned}\n$$\n\n\u8fd9\u4e2a\u662f $O(n^3)$ \u7684\u3002\u7136\u540e\u5462\u6240\u6709\u7684 dp \u72b6\u6001\u90fd\u662f `bool` \u578b\u7684\uff0c`bitset` \u78be\u8fc7\u53bb\u590d\u6742\u5ea6\u5c31\u662f $O\\left(\\dfrac{n^3}{w}\\right)$ \u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n## Implementation\n\n\u5b9e\u73b0\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4e00\u4e0b $L_{i, j}$ \u7684\u5b9a\u4e49\u9700\u8981\u6539\u4e00\u4e0b\uff0c \u6539\u6210 $L_{j, i}$ \u8868\u793a $i$ \u80fd\u5426\u8d62 $[i, j]$ \u4e2d\u7684\u6240\u6709\u4eba\u3002\n\n```cpp\n#include <iostream>\n#include <bitset>\n#define il inline\n#define FOR(i, a, b) for (int i = (a); i <= (b); ++i)\n#define DEC(i, a, b) for (int i = (a); i >= (b); --i)\n\nusing namespace std;\nconst int maxn = 2005;\nbitset<maxn> L[maxn], R[maxn], a[maxn];\nint n;\n\nint main() {\n    cin >> n;\n    FOR(i, 1, n) {\n        FOR(j, 1, i - 1) {\n            char ch; cin >> ch;\n            if (ch == '1') a[i][j] = 1;\n            a[j][i] = a[i][j] ^ 1;\n        }\n    }\n\n    FOR(i, 1, n) L[i][i] = R[i][i] = 1;\n    FOR(len, 2, n) {\n        FOR(i, 1, n - len + 1) {\n            int j = i + len - 1;\n            L[j][i] = (L[j] & R[i + 1] & a[i]).count() > 0;\n            R[i][j] = (L[j - 1] & R[i] & a[j]).count() > 0;\n        }\n    }\n    int ans = 0;\n    FOR(i, 1, n) ans += (L[n][i] & R[1][i]);\n    cout << ans << endl;\n    return 0;\n}\n```\n\n",
        "postTime": 1635680860,
        "uid": 212488,
        "name": "\u6e05\u70db",
        "ccfLevel": 0,
        "title": "\u9898\u89e3  AT5014 Random Tournament"
    },
    {
        "content": "\u8bbe $L_{i,j}$ \u8868\u793a $i$ \u662f\u5426\u79d2\u6740\u533a\u95f4 $[i,j]$ \uff0c $R_{i,j}$ \u8868\u793a $j$ \u662f\u5426\u79d2\u6740\u533a\u95f4 $[i,j]$\uff0c\u5176\u4e2d $i<j$\n\n\u5c31\u6709\n\n$$L_{i,j}=\\max\\limits_{i < pos \\leq j}\\{ L_{pos,j} \\  \\&  \\ R_{i+1,pos} \\ \\& \\ a_{i,pos} \\} $$\n\n$$\nR_{i,j} = \\max\\limits_{i \\leq pos < j} \\{ L_{pos,j-1} \\ \\& \\ R_{i,pos} \\ \\& \\ a_{j,pos}  \\}\n$$\n\n\n\u7b54\u6848\u5373\u4e3a $\\sum_{i=1}^n [L_{i,n} \\& R_{1,i}]$\n\n\u53ef\u4ee5\u901a\u8fc7\u5b9a\u4e49 $L_{i,j}=0,R_{i,j}=0 \\ (i > j)$ \u7684\u65b9\u5f0f\u6765\u8ba9\u8fd9\u4e2a $pos$ \u7684\u53d6\u503c\u8303\u56f4\u8fbe\u5230 $1 \\sim n$\n\n\u7136\u540e\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u5176\u5b9e\u53ef\u4ee5\u901a\u8fc7 `bitset` \u6765\u4f18\u5316\uff0c\u53ea\u662f $L_{i,j}$ \u7684\u5b9a\u4e49\u9700\u8981\u53cd\u4e00\u4e0b\uff0c\u6539\u6210 $L_{j,i}$ \u8868\u793a $i$ \u662f\u5426\u79d2\u6740\u533a\u95f4 $[i,j]$ \u5373\u53ef\u3002\n\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O(\\frac{n^3}{w})}$\n\n[code](https://atcoder.jp/contests/m-solutions2019/submissions/16969807)",
        "postTime": 1600854699,
        "uid": 344016,
        "name": "wurzang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT5014 \u3010Random Tournament\u3011"
    }
]
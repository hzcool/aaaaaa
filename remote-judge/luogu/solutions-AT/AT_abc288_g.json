[
    {
        "content": "\u4f1a\u63a8 fwt \u5c31\u80fd\u76f4\u63a5\u79d2/jy\n\n\u5148\u8003\u8651 B \u8fdb\u884c\u4e2a\u4ec0\u4e48\u7ebf\u6027\u53d8\u6362\u624d\u80fd\u5f97\u5230 A\uff0efwt \u8981\u505a\u7684\u662f\uff1a\u679a\u4e3e\u6bcf\u4e00\u7ef4\uff0c\u7136\u540e\u56fa\u5b9a\u5176\u5b83\u7ef4\u7684\u503c\u770b\u4f5c\u5e38\u6570\uff0c\u7136\u540e\u5c06\u8fd9\u4e00\u7ef4\u4e0a\u7684\u503c\u5355\u72ec\u62ce\u51fa\u6765\u4e58\u4e0a\u4e00\u4e2a\u77e9\u9635\u3002\u90a3\u4e48\u53ea\u9700\u8981\u6784\u9020 $n=3$ \u7684\u77e9\u9635\uff0c\u7136\u540e\u6bcf\u6b21\u505a\u8fd9\u6837\u4e00\u4e2a\u8fc7\u7a0b\u5c31\u80fd\u5b8c\u6210 $n=3^k$\uff0e\n\n\u6784\u9020\u5c31\u633a\u7b80\u5355\u7684\u4e86\uff1a\n\n$$\n\\begin{bmatrix}\n 1 & 1 & 0\\\\\n 1 & 1 & 1\\\\\n 0 & 1 & 1\n\\end{bmatrix}\n\\begin{bmatrix}\n b_0\\\\\n b_1\\\\\nb_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n b_0+b_1\\\\\n b_0+b_1+b_2\\\\\nb_1+b_2\n\\end{bmatrix}\n$$\n\n\u8fd9\u662f B \u5230 A \u8981\u505a\u7684\u4e8b\u60c5\u3002\u800c A \u8f6c\u6210 B \u6bcf\u6b21\u5c31\u4e58\u4e0a\u5b83\u7684\u9006\u77e9\u9635\u5c31\u884c\u4e86\u3002\n\n$$\n\\begin{bmatrix}\n 0 & 1 & -1\\\\\n 1 & -1 & 1\\\\\n -1 & 1 & 0\n\\end{bmatrix}\n$$\n\n```cpp\n#include<cstdio>\n#include<vector>\n#include<queue>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#include<ctime>\n#include<random>\n#include<assert.h>\n#define pb emplace_back\n#define mp make_pair\n#define fi first\n#define se second\n#define dbg(x) cerr<<\"In Line \"<< __LINE__<<\" the \"<<#x<<\" = \"<<x<<'\\n';\n#define dpi(x,y) cerr<<\"In Line \"<<__LINE__<<\" the \"<<#x<<\" = \"<<x<<\" ; \"<<\"the \"<<#y<<\" = \"<<y<<'\\n';\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int>pii;\ntypedef pair<ll,int>pli;\ntypedef pair<ll,ll>pll;\ntypedef pair<int,ll>pil;\ntypedef vector<int>vi;\ntypedef vector<ll>vll;\ntypedef vector<pii>vpii;\ntypedef vector<pil>vpil;\ntemplate<typename T>T cmax(T &x, T y){return x=x>y?x:y;}\ntemplate<typename T>T cmin(T &x, T y){return x=x<y?x:y;}\ntemplate<typename T>\nT &read(T &r){\n\tr=0;bool w=0;char ch=getchar();\n\twhile(ch<'0'||ch>'9')w=ch=='-'?1:0,ch=getchar();\n\twhile(ch>='0'&&ch<='9')r=r*10+(ch^48),ch=getchar();\n\treturn r=w?-r:r;\n}\ntemplate<typename T1,typename... T2>\nvoid read(T1 &x,T2& ...y){read(x);read(y...);}\nconst int mod=998244353;\ninline void cadd(int &x,int y){x=(x+y>=mod)?(x+y-mod):(x+y);}\ninline void cdel(int &x,int y){x=(x-y<0)?(x-y+mod):(x-y);}\ninline int add(int x,int y){return (x+y>=mod)?(x+y-mod):(x+y);}\ninline int del(int x,int y){return (x-y<0)?(x-y+mod):(x-y);}\nint qpow(int x,int y){\n\tint s=1;\n\twhile(y){\n\t\tif(y&1)s=1ll*s*x%mod;\n\t\tx=1ll*x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn s;\n}\nconst int N=600010;\nint n,fpow[14];\nint f[N],a[3][3],b[3],c[3];\nsigned main(){\n\t#ifdef do_while_true\n//\t\tassert(freopen(\"data.in\",\"r\",stdin));\n//\t\tassert(freopen(\"data.out\",\"w\",stdout));\n\t#endif\n\ta[0][0]=0;a[0][1]=1;a[0][2]=-1;\n\ta[1][0]=1;a[1][1]=-1;a[1][2]=1;\n\ta[2][0]=-1;a[2][1]=1;a[2][2]=0;\n\tread(n);\n\tfpow[0]=1;for(int i=1;i<=n;i++)fpow[i]=fpow[i-1]*3;\n\tfor(int i=0;i<fpow[n];i++)read(f[i]);\n\tfor(int i=0;i<n;i++){\n\t\tfor(int j=0;j<fpow[n];j++){\n\t\t\tif((j/fpow[i])%3==0){\n\t\t\t\tc[0]=c[1]=c[2]=0;\n\t\t\t\tb[0]=f[j];b[1]=f[j+fpow[i]];b[2]=f[j+fpow[i]*2];\n\t\t\t\tfor(int p=0;p<3;p++)\n\t\t\t\t\tfor(int q=0;q<3;q++)\n\t\t\t\t\t\tc[p]+=a[p][q]*b[q];\n\t\t\t\tf[j]=c[0];f[j+fpow[i]]=c[1];f[j+fpow[i]*2]=c[2];\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=0;i<fpow[n];i++)cout << f[i] << ' ';\n    #ifdef do_while_true\n\t\tcerr<<'\\n'<<\"Time:\"<<1.0*clock()/CLOCKS_PER_SEC*1000<<\" ms\"<<'\\n';\n\t#endif\n\treturn 0;\n}\n```",
        "postTime": 1675691591,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u300c\u9898\u89e3\u300dABC288G 3^N Minesweeper"
    },
    {
        "content": "\u5b9a\u4e49 $A(X_{n-1},X_{n-2},\\dots,X_{0}) = a[X_{n-1}3^{n-1}+X_{n-2}3^{n-2}+\\dots+X_{0}3^{0}]$\uff0c\u7b54\u6848\u4e3a $B(X_{n-1},X_{n-2},\\dots,X_{0})$\u3002\n\n\u5b9a\u4e49 \n\n$$F(X_{n-1},X_{n-2},\\dots,X_{0},total) = \\sum_{i\\in[total+1,n-1],\\lvert X_i-Y_i\\rvert \\le 1}^{n}B(Y_{n-1},Y_{n-2},\\dots,Y_{total+1},X_{total},\\dots,X_{0})$$\n\n\u6709\n\n$$A(X_{n-1},X_{n-2},\\dots,X_{0}) = \\sum_{i\\in[0,n-1],\\lvert X_i-Y_i\\rvert \\le 1}^{n}B(Y_{n-1},Y_{n-2},\\dots,Y_{0})$$\n\n\u5148\u8003\u8651 $n = 1$ \u7684\u60c5\u51b5\uff1a\n\n$$B(0) = A(1) - A(2)$$\n\n$$B(1) = A(0) + A(2) - A(1)$$\n\n$$B(2) = A(1) - A(0)$$\n\n\u5bf9\u5176\u63a8\u5e7f\uff1a\n\n$$\n\\begin{aligned}\nF(X_{n-1},X_{n-2},\\dots,0,X_{i-1},\\dots,X_0,i) = &F(X_{n-1},X_{n-2},\\dots,X_{i},1,\\dots,X_0,i-1) \\\\\n&- F(X_{n-1},X_{n-2},\\dots,X_{i},2,\\dots,X_0,i-1)\\\\\n\\\\\nF(X_{n-1},X_{n-2},\\dots,1,X_{i-1},\\dots,X_0,i) = &F(X_{n-1},X_{n-2},\\dots,X_{i},0,\\dots,X_0,i-1) \\\\&+ F(X_{n-1},X_{n-2},\\dots,X_{i},2,\\dots,X_0,i-1) \\\\&- F(X_{n-1},X_{n-2},\\dots,X_{i},1,\\dots,X_0,i-1)\\\\\n\\\\\nF(X_{n-1},X_{n-2},\\dots,2,X_{i-1},\\dots,X_0,i) = &F(X_{n-1},X_{n-2},\\dots,X_{i},1,\\dots,X_0,i-1) \\\\&- F(X_{n-1},X_{n-2},\\dots,X_{i},0,\\dots,X_0,i-1)\n\\end{aligned}\n$$\n\n\u4e3e\u4e2a\u6817\u5b50\uff1a\n\n$$A(0,0) = 2,A(0,1)=3,A(0,2)=2$$\n\n$$A(1,0) = 4,A(1,1)=5,A(1,2)=3$$\n\n$$A(2,0) = 3,A(2,1)=4,A(2,2)=2$$\n\n\u6709\uff1a\n\n$$F(0,0,-1)= 2,F(0,1,-1)=3,F(0,2,-1)=2$$\n\n$$F(1,0,-1) = 4,F(1,1,-1)=5,F(1,2,-1)=3$$\n\n$$F(2,0,-1) = 3,F(2,1,-1)=4,F(2,2,-1)=2$$\n\n\u4ee5 $F(0,1,0)$ \u7684\u8ba1\u7b97\u4e3a\u4f8b\uff1a\n\n$$F(0,1,0) = F(0,0,-1)+F(0,2,-1)-F(0,1,-1) = 1$$\n\n\u6709\uff1a\n\n$$F(0,0,0) = 1,F(0,1,0)=1,F(0,2,0)=1$$\n\n$$F(1,0,0) = 2,F(1,1,0)=2,F(1,2,0)=1$$\n\n$$F(2,0,0) = 2,F(2,1,0)=1,F(2,2,0)=1$$\n\n\u4ee5 $F(1,1,1)$ \u7684\u8ba1\u7b97\u4e3a\u4f8b\uff1a\n\n$$F(1,1,1) = F(0,1,0)+F(2,1,0)-F(1,1,0) = 0$$\n\n\u6709\uff1a\n\n$$F(0,0,1) = B(0,0) = 0,F(0,1,1)=B(0,1)=1,F(0,2,1)=B(0,2)=0$$\n\n$$F(1,0,1) = B(1,0) = 1,F(1,1,1)=B(1,1)=0,F(1,2,1)=B(1,2)=1$$\n\n$$F(2,0,1) = B(2,0) = 1,F(2,1,1)=B(2,1)=1,F(2,2,1)=B(2,2)=0$$\n\n\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 $F(X_{n-1},X_{n-2},\\dots,X_{0},i-1)$ \u5f97\u5230 $F(X_{n-1},X_{n-2},\\dots,X_{0},i)$ \u7684\u89e3\uff0c\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u6c42\u89e3\u7684\u8fc7\u7a0b\u65f6\u4f7f\u6a21\u7cca\u53d8**\u7cbe\u786e**\u7684\u8fc7\u7a0b\u3002\n\n~~\u5982\u679c\u6ca1\u6709\u542c\u61c2\u6211\u5728\u8bf4\u4ec0\u4e48\uff0c\u53ef\u4ee5\u53bb\u770b\u5b98\u65b9\u6587\u6863\uff0c\u6216\u5b66\u4e60 Zeta \u53d8\u6362~~\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n, a[531441+11]; // a[3^12 + 11]\nint pow3[15];\nint main(){\n    scanf(\"%d\", &n), pow3[0] = 1;\n    for(int i = 1; i <= n; i ++) pow3[i] = pow3[i-1] * 3;\n    for(int i = 0; i < pow3[n]; i++) scanf(\"%d\", &a[i]);\n    for(int wei = 0; wei < n; wei++){\n        int chu = pow3[wei];\n        for(int i = 0; i < pow3[n]; i++){\n            if((i/chu)%3)continue;\n            int val0 = a[i], val1 = a[i+chu], val2 = a[i+chu*2];\n            a[i] = val1 - val2, a[i+chu] = val0 + val2 - val1, a[i+chu*2] = val1 - val0;\n        }\n    }\n    for(int i = 0; i < pow3[n]-1; i ++){\n        printf(\"%d \", a[i]);\n    }\n  \tprintf(\"%d\", a[pow3[n]-1]);\n    return 0;\n}\n```",
        "postTime": 1676036672,
        "uid": 740607,
        "name": "__ODT__",
        "ccfLevel": 0,
        "title": "ABC-288 G"
    },
    {
        "content": "> \u7ed9\u5b9a\u957f\u5ea6\u4e3a $3^n$ \u7684\u6570\u7ec4 $A$\u3002\u82e5\u4e24\u6570 $x,y$ \u6ee1\u8db3\u5b83\u4eec\u4ece\u4f4e\u5230\u9ad8\u5bf9\u5e94\u7684\u6bcf\u4e00\u4f4d $x',y'$ \u90fd\u6709 $|x'-y'| \\le 1$\uff0c\u5219\u5efa\u8fb9 $(x,y)$\u3002  \n\u73b0\u5728\u67d0\u4e9b\u70b9\u4e0a\u6709\u4e00\u4e9b\u70b8\u5f39\uff0c$a_i$ \u5219\u4e3a\u4e0e $i$ \u76f8\u90bb\u7684\u70b9\uff08\u5305\u62ec $i$ \u672c\u8eab\uff09\u4e0a\u7684\u70b8\u5f39\u603b\u6570\u3002\u8bd5\u6c42\u51fa\u6bcf\u4e2a\u70b9\u4e0a\u7684\u70b8\u5f39\u4e2a\u6570\u3002  \n$n \\le 12$\u3002\n\n\u76f8\u5173\u6587\u732e\uff1a[\u4f4d\u8fd0\u7b97\u5377\u79ef(FWT) & \u96c6\u5408\u5e42\u7ea7\u6570 by @command_block](https://www.luogu.com.cn/blog/command-block/wei-yun-suan-juan-ji-yu-ji-kuo-zhan)\u3002\n\n\u8bbe\u6bcf\u4e2a\u70b9\u4e0a\u7684\u70b8\u5f39\u6570\u4e3a\u6570\u7ec4 $B$\uff0c\u6211\u4eec\u8003\u8651\u600e\u4e48\u4ece $B$ \u5f97\u5230 $A$\u3002\n\n\u5f88\u663e\u7136\uff0c\u8d21\u732e\u7cfb\u6570\u53ef\u4ee5\u5199\u6210\u4e00\u4e2a\u77e9\u9635 $c$ \u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u6211\u4eec\u5c06 $A$ \u4e58\u4e0a $c^{-1}$ \u5c31\u53ef\u4ee5\u5f97\u5230 $B$\u3002\u66b4\u529b\u505a\u662f $\\mathcal O(3^{2n})$ \u7684\uff0c\u73b0\u5728\u6211\u4eec\u8981\u5e72\u7684\u5c31\u662f\u4f18\u5316\u8fd9\u4e00\u8fc7\u7a0b\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u8fd9\u5341\u5206\u7c7b\u4f3c\u4e8e $3$ \u8fdb\u5236\u4e0a\u7684 IDWT\uff0c\u4f46\u662f\u8d21\u732e\u77e9\u9635\u663e\u7136\u662f\u4e0d\u540c\u7684\u3002\u6ce8\u610f\u5230\u672c\u9898\u548c\u4f4d\u8fd0\u7b97\u5377\u79ef\u95ee\u9898\u4e00\u6837\uff0c\u4ecd\u7136\u6ee1\u8db3\u53ef\u4ee5\u5206\u4f4d\u505a\u7684\u6027\u8d28\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5148\u6c42\u51fa $c([0,1,2],[0,1,2],[0,1,2])$ \u7684\u771f\u503c\u8868\uff0c\u7136\u540e\u4eff\u7167 FWT \u5206\u6cbb\u7684\u65b9\u6cd5\u505a\u5377\u79ef\u3002\n\n\u6839\u636e\u9898\u76ee\u8981\u6c42\u5bb9\u6613\u6784\u9020\u51fa\n\n$$c=\\begin{bmatrix}1 & 1 &0\\\\1 &1 &1\\\\0 &1 &1\\end{bmatrix}$$\n\n\u8fdb\u4e00\u6b65\uff0c\u5f85\u5b9a\u7cfb\u6570\u6cd5\u5bb9\u6613\u6c42\u51fa\n\n$$c^{-1}=\\begin{bmatrix}0 & 1 &-1\\\\1 &-1 &1\\\\-1 &1 &0\\end{bmatrix}$$\n\n\u548c FWT \u4e00\u6837\uff0c\u5206\u7c7b\u8ba8\u8bba $x$ \u7684\u6700\u9ad8\u4f4d $x_t=\\{0,1,2\\}$\uff0c\u5206\u522b\u5904\u7406\u5e42\u7ea7\u6570\u6700\u9ad8\u4f4d\u4e3a $\\{0,1,2\\}$ \u7684\u90e8\u5206 $A_0,A_1,A_2$ \u7684\u8d21\u732e\uff0c\u5c31\u53ef\u4ee5\u505a\u5230 $\\mathcal O(n3^n)$\u3002\n\n```cpp\nconst int N=1e6+5,c[3][3]={{0,1,-1},{1,-1,1},{-1,1,0}};\nint n,a[N],pw3[15];\nsigned main(){\n\tpw3[0]=1;\n\tfor(int i=1;i<15;i++)pw3[i]=pw3[i-1]*3;\n\tcin>>n,n=pw3[n];\n\tfor(int i=0;i<n;i++)cin>>a[i];\n\tfor(int len=1;len<n;len*=3)for(int p=0;p<n;p+=len*3)\n\tfor(int i=p;i<p+len;i++){\n\t\tint f0=a[i],f1=a[i+len],f2=a[i+len*2];\n\t\ta[i]=c[0][0]*f0+c[0][1]*f1+c[0][2]*f2;\n\t\ta[i+len]=c[1][0]*f0+c[1][1]*f1+c[1][2]*f2;\n\t\ta[i+len*2]=c[2][0]*f0+c[2][1]*f1+c[2][2]*f2;\n\t}\n\tfor(int i=0;i<n;i++)printf(\"%lld \",a[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1676354556,
        "uid": 283913,
        "name": "ZillionX",
        "ccfLevel": 6,
        "title": "\u3010k \u8fdb\u5236\u7c7b FWT\uff0c\u77e9\u9635\u6c42\u9006\u3011[ABC288G] 3^N Minesweeper"
    }
]
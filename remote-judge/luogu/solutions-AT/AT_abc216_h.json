[
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1aLGV\uff0c\u611f\u8c22 [THU POG](https://www.luogu.com.cn/user/141179)\u3002\n\n\u770b\u5230\u673a\u5668\u4eba\u4e0d\u78b0\u649e\u7684\u6761\u4ef6\uff0c\u53ef\u4ee5\u60f3\u5230\u8fd9\u9898\u9700\u8981 LGV \u5f15\u7406\u3002\u7531\u4e8e\u8fd9\u9053\u9898\u4e2d\u8d77\u70b9\u56fa\u5b9a\uff0c\u4f46\u662f\u7ec8\u70b9\u4e0d\u56fa\u5b9a\uff0c\u4e8e\u662f\u8003\u8651\u679a\u4e3e\u7ec8\u70b9\u3002\n\n\u6211\u4eec\u8003\u8651\u786e\u5b9a\u4e86\u7ec8\u70b9\u5e8f\u5217 $y_1,y_2,\\cdots,y_K$\uff0c\u7531\u4e8e\u8def\u5f84\u4e0d\u80fd\u76f8\u4ea4\u7684\u9650\u5236\uff0c\u6240\u4ee5\u8d77\u70b9\u548c\u7ec8\u70b9\u7684\u5339\u914d\u662f\u552f\u4e00\u7684\uff0c\u5373\u8def\u5f84\u4e3a $(x_1,y_1),(x_2,y_2),\\cdots,(x_k,y_k)$\uff0c\uff08$(x,y)$ \u8868\u793a\u8d77\u70b9\u4e3a $x$ \u7ec8\u70b9\u4e3a $y$ \u7684\u4e00\u6761\u8def\u5f84\u3002\n\n\u8003\u8651\u5957\u4e0a LGV \u5f15\u7406\uff0c\u53ef\u5f97\uff0c\u8def\u5f84\u7684\u65b9\u6848\u6570\u4e3a\uff1a\n\n$$\\begin{vmatrix}e(x_1,y_1)&e(x_1,y_2)&\\cdots&e(x_1,y_K)\\\\e(x_2,y_1)&e(x_2,y_2)&\\cdots&e(x_2,y_K)\\\\\\vdots&\\ddots&\\vdots\\\\e(x_k,y_1)&e(x_k,y_2)&\\cdots&e(x_k,y_k)\\end{vmatrix}$$\n\n$e(x,y)$ \u8868\u793a $x$ \u5230 $y$ \u7684\u65b9\u6848\u6570\u3002\u5728\u672c\u9898\u4e2d\uff0c$e(x,y)=\\binom{n}{y - x}$\u3002\n\n\u8003\u8651\u62c6\u884c\u5217\u5f0f\u7684\u8d21\u732e\uff0c\u8003\u8651\u8bbe $f(S, mx)$ \u8868\u793a\u786e\u5b9a\u8d77\u70b9\uff08$x'$\uff09\u7684\u96c6\u5408\u4e3a $S$\uff0c\u4e14\u5bf9\u5e94 $y_{|S|} \\le mx$ \u7684\u884c\u5217\u5f0f\u503c\uff0c \u5373\uff1a\n\n$$\\begin{vmatrix}e(x'_1,y_1)&e(x'_1,y_2)&\\cdots&e(x'_1,y_{|S|})\\\\e(x'_2,y_1)&e(x'_2,y_2)&\\cdots&e(x'_2,y_{|S|})\\\\\\vdots&\\ddots&\\vdots\\\\e(x'_{|S|},y_1)&e(x'_{|S|},y_2)&\\cdots&e(x'_{|S|},y_{|S|})\\end{vmatrix}$$\n\n\u8f6c\u79fb\uff1a\n\n1. $y_{|S|} < mx$\uff0c$f(S,mx - 1) \\to f(s, mx)$\uff1b\n2. $y_{|S|} = mx$\uff0c\u8fd9\u4e2a\u65f6\u5019\u8003\u8651\u6700\u540e\u4e00\u5217\u7684\u8d21\u732e\uff1a\n\n\t- \u6211\u4eec\u8003\u8651\u884c\u5217\u5f0f\u7684\u5b9a\u4e49\uff1a$|A|=\\sum\\limits_{p_1,p_2,\\cdots,p_n} (-1)^{\\sigma(p_1,p_2,\\cdots,p_n)}A_{i,p_i}$\u3002\n    \n\t- \u6211\u4eec\u8003\u8651\u679a\u4e3e $p_i={|S|}$\uff0c\u90a3\u4e48\u8d21\u732e\u5c31\u662f $(-1)^{|S|-i}e(x'_i,y_k)$\uff0c\u4e58\u4e0a\u524d\u9762 $p_1,p_2,\\cdots,p_{|S|-1}$ \u7684\u7b54\u6848\u548c\uff0c\u5c31\u662f $f(S \\backslash x'_{i},mx-1)\\to f(s, mx)$\u3002\n\n\u6c42\u51fa\u65b9\u6848\u6570\u4e4b\u540e\uff0c\u6982\u7387\u5c31\u662f\u518d\u4e58\u4e0a $2^{-nk}$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define SZ(x) (int) x.size() - 1\n#define all(x) x.begin(), x.end()\n#define ms(x, y) memset(x, y, sizeof x)\n#define F(i, x, y) for (int i = (x); i <= (y); i++)\n#define DF(i, x, y) for (int i = (x); i >= (y); i--)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntemplate <typename T> void chkmax(T &x, T y) { x = max(x, y); }\ntemplate <typename T> void chkmin(T &x, T y) { x = min(x, y); }\ntemplate <typename T> void read(T &x) {\n\tx = 0; int f = 1; char c = getchar();\n\tfor (; !isdigit(c); c = getchar()) if (c == '-') f = -f;\n\tfor (; isdigit(c); c = getchar()) x = x * 10 + c - '0';\n\tx *= f;\n}\nconst int K = 11, N = 1010, MOD = 998244353;\ntemplate <typename T1, typename T2> void add(T1 &x, T2 y) { x = (x + y) % MOD; }\nint n, k, x[K], f[N * 2][1 << 10], C[N][N];\nvoid init(int n) {\n\tF(i, 0, n) {\n\t\tC[i][0] = 1;\n\t\tF(j, 1, i) C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % MOD;\n\t}\n}\nint CC(int n, int m) {\n\treturn m < 0 || n < m ? 0 : C[n][m];\n}\nint e(int x, int y) {\n\treturn CC(k, y - x);\n}\nint power(int x, int y = MOD - 2) {\n\tint ans = 1;\n\tfor (; y; x = (ll) x * x % MOD, y >>= 1)\n\t\tif (y & 1) ans = (ll) ans * x % MOD;\n\treturn ans;\n}\nsigned main() {\n\tread(n); read(k);\n\tinit(k);\n\tF(i, 1, n) read(x[i]), x[i]++;\n\tint full = (1 << n) - 1;\n\tf[0][0] = 1;\n\tF(i, 1, x[n] + k) {\n\t\tF(j, 0, full) {\n\t\t\tf[i][j] = f[i - 1][j];\n\t\t\tint sz = __builtin_popcount(j), s = 0;\n\t\t\tF(k, 1, n) {\n\t\t\t\tint t = (1 << (k - 1));\n\t\t\t\tif (j & t) {\n\t\t\t\t\ts++;\n\t\t\t\t\tint pie = ((sz + s) & 1) ? MOD - 1 : 1;\n\t\t\t\t\tadd(f[i][j], (ll) f[i - 1][j ^ t] * pie % MOD * e(x[k], i));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} cout <<(ll) f[x[n] + k][full] * power(power(2), n * k) % MOD;\n\treturn 0;\n}\n```",
        "postTime": 1678799453,
        "uid": 180242,
        "name": "orzdevinwang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT_abc216_h\u3010[ABC216H] Random Robots\u3011"
    }
]
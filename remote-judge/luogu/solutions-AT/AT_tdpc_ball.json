[
    {
        "content": "## [\u30dc\u30fc\u30eb](https://www.luogu.com.cn/problem/AT_tdpc_ball)\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u72b6\u538b dp\uff0c\u6570\u5b66\u671f\u671b\u3002\n\n## Solution\n\n\u6570\u5b66\u671f\u671b\uff0c\u901a\u5e38\u7528 $E$ \u8868\u793a\u3002\u5f88\u663e\u7136 $E_0$ \u7684\u573a\u5408\u4e0d\u9700\u8981\u4efb\u4f55\u64cd\u4f5c\uff0c\u5373\u4e3a $0$\u3002\n\n\u8003\u8651\u4e00\u4e2a\u3002\n\n\u6254\u4e00\u6b21\uff0c\u5c31\u6709 $1$ \u7684\u521d\u59cb\u503c\u3002\u53ea\u6709 $\\dfrac{1}{3}$ \u7684\u6982\u7387\u51fb\u4e2d\u8fd9\u4e00\u4e2a\uff0c$\\dfrac{1}{3}$\u7684\u51fb\u4e2d\u5de6\u8fb9\uff0c$\\dfrac{1}{3}$ \u51fb\u4e2d\u53f3\u8fb9\u3002\n\n\u6709\uff1a\n\n$$E_1=1+\\dfrac{1}{3}E_0+\\dfrac{2}{3}E_1$$\n\n\u79fb\u9879\uff0c\u5e26\u5165 $E_0$ \u53ef\u4ee5\u6c42\u51fa $E_1=3$\u3002\n\n---\n\n\u8003\u8651\u4e24\u4e2a\u3002\u5f53\u4e24\u4e2a\u7d27\u6328\u7740\u653e\u7684\u65f6\u5019\uff0c\u8bb0\u4e3a $E_{11}$\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/m8oqdnhg.png)\n\n\u5047\u8bbe\u7784\u51c6\u5de6\u8fb9\u7684\uff0c\u6709\u521d\u59cb\u503c $1$\u3002\u8fd9\u4e00\u53d1\u6709 $\\dfrac{1}{3}$ \u7684\u6982\u7387\u51fb\u4e2d\u5de6\u8fb9\u7684\u767d\uff0c\u72b6\u6001\u4e0d\u53d8\uff0c\u6240\u4ee5\u8d21\u732e\u4e3a $\\dfrac{1}{3}E_{11}$\uff1b\u6709 $\\dfrac{1}{3}$ \u7684\u6982\u7387\u51fb\u4e2d\u5de6\u8fb9\u7684\u9ed1\uff0c\u72b6\u6001\u53d8\u4e3a $01$\uff0c\u8d21\u732e\u4e3a $\\dfrac{1}{3}E_{01}$\uff1b\u6709 $\\dfrac{1}{3}$ \u7684\u6982\u7387\u51fb\u4e2d\u53f3\u8fb9\u7684\u9ed1\uff0c\u72b6\u6001\u53d8\u4e3a $10$\u3002\n\n\u5f88\u663e\u7136\u7784\u51c6\u53f3\u8fb9\u662f\u4e00\u6837\u7684\u3002\n\n\u5f97\u5230\u516c\u5f0f\uff1a\n\n$$E_{11}=1+\\dfrac{1}{3}E{11}+\\dfrac{1}{3}E_{01}+\\dfrac{1}{3}E_{10}$$\n\n$01$ \u548c $10$ \u7684\u72b6\u6001\u5c31\u662f\u5355\u72ec\u4e00\u4e2a $1$\u3002\u6545\u5e26\u5165 $E_{1}$ \u89e3\u65b9\u7a0b\u53ef\u4ee5\u5f97\u51fa $E_{11}=4.5$\u3002\n\n---\n\n\u5f53\u4e24\u4e2a\u4e2d\u95f4\u7a7a\u4e00\u683c\u6392\u5217\u65f6\uff0c\u8bb0\u4e3a $E_{101}$\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gpoazk0i.png)\n\n\u5982\u679c\u5728\u6700\u4f18\u7b56\u7565\u4e0b\uff0c\u5f88\u663e\u7136\u7784\u51c6\u662f\u8981\u5bf9\u7740\u4e2d\u95f4\u7684\u767d\uff0c\u56e0\u4e3a\u5b83\u6709 $\\dfrac{2}{3}$ \u7684\u6982\u7387\u63d0\u4f9b\u8d21\u732e\uff0c\u4f46\u662f\u6253\u5176\u5b83\u5730\u65b9\u53ea\u6709 $\\dfrac{1}{3}$ \u4e43\u81f3\u66f4\u5c0f\u7684\u6982\u7387\u3002\n\n\u5206\u6790\u53ef\u5f97\n\n$$E_{101}=1+\\dfrac{1}{3}E_{001}+\\dfrac{1}{3}E_{101}+\\dfrac{1}{3}E_{100}$$\n\n\u89e3\u5f97 $E_{101}=4.5$\u3002\n\n---\n\n\u6c42\u89e3\u4e2d\uff0c\u53d1\u73b0\u6709 $10000$ \u548c $00001$ \u7684\u72b6\u6001\uff0c\u5c3d\u7ba1\u5b83\u4eec\u4ee3\u8868\u7684\u72b6\u6001\u662f\u4e00\u6837\u7684\uff0c\u4f46\u662f\u6570\u503c\u4e0a\u4e0d\u76f8\u7b49\uff0c\u4e5f\u4e0d\u597d\u5904\u7406\uff0c\u6240\u4ee5\u91c7\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\uff0c\u76f4\u63a5\u9012\u5f52\u5230 $0$ \u8fd4\u56de $1$\u3002\n\n\u91c7\u7528 $01$ \u4e32\u8bb0\u5f55\u72b6\u6001\uff0c\u6bcf\u6b21\u904d\u5386\u4ece\u6bcf\u4e00\u4e2a\u70b9\u7784\u51c6\uff0c\u7136\u540e\u53d6\u6700\u5c0f\u503c\uff08\u6700\u4f18\u7b56\u7565\uff09\u3002\n\n\u8003\u8651\u5982\u4f55\u5b9e\u73b0\u79fb\u9879\u89e3\u65b9\u7a0b\u3002\u5f88\u663e\u7136\u8fd9\u4e00\u67aa\u5982\u679c\u6253\u7a7a\u4e86\uff0c\u90a3\u4e48\u72b6\u6001\u5e94\u8be5\u662f\u4e0d\u53d8\u7684\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0d\u80fd\u76f4\u63a5\u52a0\u4e0a\u6c42\u81ea\u5df1\uff0c\u4e5f\u4e0d\u80fd\u7ee7\u7eed\u641c\u7d22\uff0c\u5426\u5219\u4f1a\u6b7b\u5faa\u73af\u3002\u6240\u4ee5\u8bb0\u5f55\u4e00\u4e0b\u6709\u51e0\u4e2a\u72b6\u6001\u4e0d\u53d8\uff0c\u548c $3$ \u505a\u4e00\u4e0b\u6bd4\uff0c\u7136\u540e\u518d\u4e58\u5012\u6570\u5c31\u884c\u4e86\u3002\n\n## AC Code\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cmath>\nusing namespace std;\nconst int inf=0x3f3f3f3f;\nint n,s;\ndouble e[1<<16];\ndouble dp(int s)\n{\n\tif (!s) return e[0]=0;\n\tif (e[s]!=inf) return e[s];\n\tfor (int i=1;i<=16;i++)\n\t{\n\t\tint a=s&~(1<<i-1),b=s&~(1<<i),c=s&~(1<<i+1),cnt=3;//    cnt/3*e[s]\n\t\tif (a==s) cnt--;\n\t\tif (b==s) cnt--;\n\t\tif (c==s) cnt--;\n\t\te[s]=min(e[s],(1+(s!=a?dp(a)/3.0:0)+(s!=b?dp(b)/3.0:0)+(s!=c?dp(c)/3.0:0))*3.0/cnt);\n\t}\n\treturn e[s];\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tint a;scanf(\"%d\",&a);\n\t\ts|=(1<<a);\n\t}\n\tfor (int i=0;i<=1<<16;i++) e[i]=inf;\n\tprintf(\"%.10lf\",dp(s));\n\treturn 0;\n}\n```",
        "postTime": 1683274546,
        "uid": 538738,
        "name": "ttttalk",
        "ccfLevel": 0,
        "title": "\u30dc\u30fc\u30eb\u9898\u89e3"
    },
    {
        "content": "\u5df2\u77e5 $x_i \\leq 15$\uff0c\u56e0\u6b64\u53ef\u4ee5\u5bf9\u4e8e\u7403\u7684\u72b6\u6001\u8fdb\u884c\u4e8c\u8fdb\u5236\u72b6\u6001\u538b\u7f29\uff0c$1$ \u8868\u793a\u6709\u7269\u54c1\uff0c$0$ \u8868\u793a\u6ca1\u6709\u7269\u54c1\u6216\u8005\u7269\u54c1\u5df2\u88ab\u6253\u5012\u3002\n\n\u8bbe $s$ \u4e3a\u538b\u7f29\u540e\u7684\u6570\u5b57\uff0c$E_s$ \u4e3a\u5bf9\u5e94\u72b6\u6001\u7684\u671f\u671b\uff0c\u6613\u77e5 $E_0=0$\u3002\n\n\u63a5\u4e0b\u6765\u63a8\u8f6c\u79fb\u65b9\u7a0b\uff1a\u8bbe\u573a\u4e0a\u4ec5\u6709\u4e00\u4e2a\u7269\u54c1\uff0c\u5219\u53ef\u4ee5\u5c06\u7403\u6295\u81f3\u8fd9\u4e2a\u7269\u54c1\u7684\u5de6\u8fb9\uff0c\u8fd9\u4e2a\u7269\u54c1\u4e0a\u548c\u8fd9\u4e2a\u7269\u54c1\u7684\u53f3\u8fb9\u3002\u4e09\u79cd\u6295\u63b7\u65b9\u5f0f\u51fb\u4e2d\u7269\u54c1\u7684\u6982\u7387\u5747\u4e3a $\\dfrac{1}{3}$\u3002\u82e5\u662f\u51fb\u4e2d\u7269\u54c1\uff0c\u5219\u72b6\u6001\u4f1a\u4ece $1$ \u53d8\u4e3a $0$\uff0c\u5426\u5219\u72b6\u6001\u5c06\u4e0d\u4f1a\u6539\u53d8\u3002\u7531\u6b64\u53ef\u77e5\uff0c$E_1=E_1\\times \\dfrac{2}{3}+E_0\\times \\dfrac{1}{3}$\uff0c$E_1$ \u53ef\u4ee5\u901a\u8fc7\u89e3\u4e00\u5143\u4e00\u6b21\u65b9\u7a0b\u5f97\u5230\u3002\n\n\u4f9d\u6b64\u7c7b\u63a8\uff0c\u53ef\u4ee5\u770b\u51fa\u82e5\u5728\u6295\u7403\u540e\u7269\u54c1\u72b6\u6001\u6ca1\u6709\u6539\u53d8\uff0c\u5219\u4f1a\u7ed9 $E_s$ \u8d21\u732e $E_s\\times \\dfrac{1}{3}$\uff0c\u5426\u5219\u8bbe\u72b6\u6001\u6539\u53d8\u4e3a $s2$\uff0c\u5219\u4f1a\u8d21\u732e $E_{s2}\\times\\dfrac{1}{3}$\u3002\n\n\u53ef\u4ee5\u4f7f\u7528\u9012\u5f52\u6765\u679a\u4e3e\u72b6\u6001\u3002\n\n```\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<string>\n#include<cmath>\nusing namespace std;\nint read() {\n\tchar c = getchar(); int f = 1, a = 0;\n\twhile(c != '-' && (c > '9' || c < '0'))\n\t\tc = getchar();\n\tif(c == '-')\n\t\tf = -1, c = getchar();\n\twhile(c >= '0' && c <= '9')\n\t\ta = a * 10 + (c - '0'), c = getchar();\n\treturn f * a;\n}\nconst int N = 65540;\ndouble E[N];\ndouble dfs(int s){\n\tif(E[s] < 100000000)\n\t\treturn E[s];\n\tbool flag = 0;\n\tfor(int i = 0; i <= 15; i++){\n\t\tint w = (s >> (15 - i)) & 1;\n\t\tif(w == 1) flag = 1;\n\t\tif(flag){\n\t\t\tdouble now = 1, ji = 0;\n\t\t\tfor(int j = -1; j <= 1; j++){\n\t\t\t\tw = (s >> (15 - i + j)) & 1;\n\t\t\t\tif(w == 0) ji++;\n\t\t\t\telse now += dfs(s - (1 << (15 - i + j))) / 3.0;\n\t\t\t}\n\t\t\tif(ji != 3){\n\t\t\t\tE[s] = min(E[s], now / (3.0 - ji) * 3.0);\n\t\t\t}\n\t\t}\n\t}\n\treturn E[s];\n}\nint main() {\n\tfor(int i = 0; i <= (1 << 16); i++){\n\t\tE[i] = 100000000;\n\t}\n\tint n = read(), s = 0;\n\tfor(int i = 1; i <= n; i++){\n\t\tint z = read();\n\t\ts += (1 << (15 - z));\n\t}\n\tE[0] = 0;\n\tdfs(s);\n\tprintf(\"%.10lf\", E[s]);\n\treturn 0;\n}\n```",
        "postTime": 1683272939,
        "uid": 343311,
        "name": "PeterBei",
        "ccfLevel": 5,
        "title": "\u30dc\u30fc\u30eb \u9898\u89e3"
    },
    {
        "content": "under \u9898\u89e3 [AT687](https://www.luogu.com.cn/problem/AT687)\n\n\u540c\u6b65\u53d1\u5e03\u4e8e[\u4e2a\u4eba\u535a\u5ba2](https://fa555.github.io/2020/\u67d0At\u7684dp\u573a/#J-\u30dc\u30fc\u30eb)\n\n### problem\n\n\u6709 $N \\ (1 \\le N \\le 16)$ \u4e2a\u7269\u54c1\uff0c\u5176\u4e2d\u7b2c $i$ \u4e2a\u5728 $x_i \\ (0 \\le x_i \\le 15)$ \u5750\u6807\u5904\u3002\u5411\u5750\u6807 $x$ \u6254\u7403\u65f6\uff0c\u5206\u522b\u6709 $\\frac{1}{3}$ \u7684\u6982\u7387\u51fb\u4e2d\u5750\u6807 $x - 1, x, x + 1$ \u4e2d\u7684\u4e00\u4e2a\uff1b\u5982\u679c\u6253\u4e2d\u7684\u5750\u6807\u4e0a\u6709\u7269\u54c1\uff0c\u5c06\u5176\u6253\u5012\u3002\u6c42\u51fa\u5728\u6700\u4f18\u7b56\u7565\u4e0b\u671f\u671b\u6254\u7403\u591a\u5c11\u6b21\u5c06\u6240\u6709\u7269\u54c1\u6253\u5012\u3002\u4fdd\u8bc1 $x_i$ \u4e24\u4e24\u4e0d\u540c\u3002\n\n\u8d5b\u65f6\u8865\u5145\uff1a**\u6bcf\u6b21\u6254\u7403\u65f6\u53ef\u4ee5\u5148\u770b\u5230\u4e0a\u4e00\u6b21\u6254\u7403\u51fb\u4e2d\u7684\u4f4d\u7f6e\u518d\u51b3\u5b9a\u5411\u54ea\u91cc\u6254\u7403\u3002**\n\n### solution\n\n\u770b\u5230\u8fd9\u4e2a\u6570\u636e\u8303\u56f4\uff0c\u76f2\u731c\u72b6\u538b\u3002\n\n\u8bbe $E(S)$ \u4e3a\u72b6\u6001 $S$ \u65f6\u7684\u671f\u671b\u6b21\u6570\u3002\u8003\u8651\u5982\u4f55\u8f6c\u79fb\u3002\u4e00\u822c\u8fd9\u79cd\u9898\u9700\u8981\u5217\u51fa\u4e00\u4e2a\u5173\u4e8e $E(S)$ \u7684\u65b9\u7a0b\uff0c\u628a\u5b83\u53cd\u89e3\u51fa\u6765\u3002\n\n\u8003\u8651\u5411 $x$ \u6254\u7403\u7684\u60c5\u51b5\uff0c\u80fd\u5217\u51fa\u8fd9\u6837\u7684\u4e00\u4e2a\u65b9\u7a0b\uff1a\n\n$$\nE(S) = 1 + \\sum{(P(u) \\times E(T))} + (1 - \\sum{P(u)}) \\times E(S)\n$$\n\n\u5176\u4e2d $P(x) = \\frac{1}{3}$ \u8868\u793a\u51fb\u4e2d\u5750\u6807 $x$ \u7684\u6982\u7387\uff0c$u \\in \\{x - 1, x, x + 1 \\}$\uff0c`T = S & ~u`\u3002\u5316\u7b80\u53ef\u5f97\n\n$$\nE(S) = \\frac{1 + \\sum{(P(u) \\times E(T))}}{\\sum P(u)}\n$$\n\n\u5c31\u53ef\u4ee5\u679a\u4e3e $x$ \u8fdb\u884c\u8f6c\u79fb\u4e86\u3002\n\n\u663e\u7136\u53ef\u4ee5\u8bb0\u5fc6\u5316\u4e00\u4e0b\u3002\u8bbe $f_S = E(S)$\uff0c\u521d\u59cb\u72b6\u6001 $f_0 = 0$\u3002\n\n\u7b54\u6848\u5373\u4e3a $E(S)$\u3002\u603b\u590d\u6742\u5ea6 $O(N \\times 2^N)$\u3002\n\n### code\n\n\u4ee3\u7801\u53ef\u80fd\u6362\u4e86\u4e00\u4e9b\u5947\u602a\u7684\u5199\u6cd5\uff0c\u4f46\u662f\u8ddf\u4e0a\u9762\u5f0f\u5b50\u662f\u7b49\u4ef7\u7684\uff08\n\n``` cpp\ndouble f[1<<16|1];\n\ndouble dfs(int S) {\n  if (f[S] >= 0.) return f[S];\n\n  double ans = 1 << 16, E;\n  for (int x = 0, c; x < 16; ++x) {\n    int T[] = {\n      S & ~((1 << x) << 1),\n      S & ~(1 << x),\n      S & ~((1 << x) >> 1)\n    };\n    c = 0, E = 1.;\n\n    for (int i = 0; i < 3; ++i)\n      if (S != T[i])\n        E += dfs(T[i]) / 3., ++c;\n    ans = std::min(ans, 3 * E / c);\n  }\n  return f[S] = ans;\n}\n\ndouble solve() {\n  int N, S = 0;\n  scanf(\"%d\", &N);\n  std::fill(f + 1, f + (1 << 16), -1);\n  for (int t; N; --N) {\n    scanf(\"%d\", &t);\n    S |= 1 << t;\n  }\n  return dfs(S);\n}\n\n```",
        "postTime": 1585193812,
        "uid": 111890,
        "name": "fa_555",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT687 \u3010\u30dc\u30fc\u30eb\u3011"
    }
]
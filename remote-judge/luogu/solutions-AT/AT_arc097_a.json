[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_arc097_a)\n### \u8981\u77e5\u9053\u7684\n[substr](https://blog.csdn.net/azw66666/article/details/121302568) \u51fd\u6570\u6c42\u5b50\u4e32\u3002\n\n[unique](https://www.cnblogs.com/wangkundentisy/p/9033782.html) \u51fd\u6570\u53bb\u91cd\u3002\n### \u601d\u8def\n\u7531\u4e8e\u6211\u4eec\u53d1\u73b0\u9898\u76ee\u7ed9\u7684 $k$ \u5f88\u5c0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u3002\n\n\u6211\u4eec\u7528 $a$ \u6570\u7ec4\u6765\u5b58 $S$ \u7684\u6bcf\u4e00\u4e2a\u5b50\u4e32\u3002\u7531\u4e8e\u4e00\u4e2a\u957f\u5ea6\u5927\u4e8e $k$ \u7684\u5b57\u4e32\u7684\u5b57\u5178\u5e8f\u80af\u5b9a\u4e0d\u5728\u524d $k$ \u4f4d\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u4e0d\u8003\u8651\u3002\u6700\u540e\u8f93\u51fa\u65f6\u9700\u8981\u6392\u5e8f\u548c\u53bb\u91cd\u3002\n\n**AC code:**\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstring a[5000010];\nint main(){\n\tstring s;\n\tint k,cnt=0;\n\tcin>>s>>k;\n\tint lens=s.size();\n\tfor(int i=0;i<lens;i++){\t//\u679a\u4e3e\u5de6\u7aef\u70b9\n\t\tfor(int j=1;j<=k;j++){\t//\u679a\u4e3e\u957f\u5ea6\n\t\t\ta[++cnt]=s.substr(i,j);\n\t\t}\n\t}\n\tsort(a,a+cnt);\n\tcnt=unique(a,a+cnt)-a-1;\n\tcout<<a[k];\n\treturn 0;\n}\n```\n",
        "postTime": 1671113422,
        "uid": 760776,
        "name": "zhaozeyu123",
        "ccfLevel": 0,
        "title": "AT_arc097_a\u9898\u89e3"
    },
    {
        "content": "## SAM \u6c42\u5b57\u5178\u5e8f\u7b2c $k$ \u5c0f\u5b50\u4e32\n\n\u9996\u5148\u8981\u77e5\u9053 SAM \u4e0a\u6bcf\u6761\u4ece\u6e90\u70b9\u5f00\u59cb\u7684\u8def\u5f84\u90fd\u662f\u539f\u4e32\u7684\u4e00\u4e2a\u4e0d\u540c\u5b57\u4e32\uff0c\u6240\u4ee5\u5b57\u5178\u5e8f\u7b2c $k$ \u5c0f\u8def\u5f84\u5c31\u662f\u9898\u76ee\u6240\u6c42\u3002\n\n\u6240\u4ee5\u5efa\u51fa SAM\uff0c\u6c42\u51fa SAM \u4e0a\u6bcf\u4e2a\u70b9\u80fd\u5230\u8fbe\u7684\u72b6\u6001\u6570\uff08\u56e0\u4e3a\u662f DAG \u6240\u4ee5\u8bb0\u641c\u4e00\u4e0b\u6216\u8005\u5efa\u53cd\u56fe\u8dd1\u62d3\u6251\u6392\u5e8f\uff09\uff0cSAM \u6700\u540e\u6309\u5b57\u5178\u5e8f\u8dd1\u7b2c $k$ \u5c0f\u8def\u5f84\uff0c\u6cbf\u8def\u8f93\u51fa\u5c31\u884c\u4e86\u3002\n\n\u8fd9\u91cc\u7528\u7684\u662f\u8bb0\u641c\u3002\n\n## CODE\n\n```cpp\n#include<bits/stdc++.h>\n#define N 10010\n#define LL long long\n#define ULL unsigned long long\n#define DB double\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define per(i,a,b) for(int i=a;i>=b;i--)\n#define tep(i,u) for(int i=head[u];~i;i=e[i].nxt)\n#define INF 0x3f3f3f3f3f3f3f\nusing namespace std;\ntemplate <typename T> inline void read(T &a)\n{\n\ta=0;T w=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){a=a*10+ch-'0';ch=getchar();}\n\ta*=w;\n}\ntemplate <typename T,typename ...Args> inline void read(T &x,Args &...args){read(x);read(args...);}\nint num[N],n,k,siz[N],len;\nchar s[N],ans[N];\nstruct SAM\n{\n\tint len[N<<1],link[N<<1],ch[N<<1][27],last,cc;\n\tinline void init(){len[0]=0;link[0]=-1;last=cc=0;}\n\tinline void insert(char x)\n\t{\n\t\tint cur=++cc,c=x-'a';\n\t\tlen[cur]=len[last]+1;\n\t\tint p=last;num[cur]=1;\n\t\twhile(p!=-1&&!ch[p][c])\n\t\t{\n\t\t\tch[p][c]=cur;\n\t\t\tp=link[p];\n\t\t}\n\t\tif(p==-1) link[cur]=0;\n\t\telse\n\t\t{\n\t\t\tint q=ch[p][c];\n\t\t\tif(len[q]==len[p]+1) link[cur]=q;\n\t\t\telse\n\t\t\t{\n\t\t\t\tint clone=++cc;\n\t\t\t\tmemcpy(ch[clone],ch[q],sizeof(ch[q]));\n\t\t\t\tlen[clone]=len[p]+1;\n\t\t\t\tlink[clone]=link[q];\n\t\t\t\twhile(p!=-1&&ch[p][c]==q)\n\t\t\t\t{\n\t\t\t\t\tch[p][c]=clone;\n\t\t\t\t\tp=link[p];\n\t\t\t\t}\n\t\t\t\tlink[q]=link[cur]=clone;\n\t\t\t}\n\t\t}\n\t\tlast=cur;\n\t}\n}t;\ninline int dfs(int u)\n{\n\tif(~siz[u]) return siz[u];siz[u]=1;\n\trep(i,0,25)\n\t{\n\t\tint v=t.ch[u][i];if(!v) continue;\n\t\tsiz[u]+=dfs(v);\n\t}\n\treturn siz[u];\n}\ninline void getans(int u)\n{\n\tif(!k) return;\n\trep(i,0,25)\n\t{\n\t\tint v=t.ch[u][i];if(!v) continue;\n\t\tif(siz[v]<k) k-=siz[v];\n\t\telse{printf(\"%c\",i+'a');k--;getans(v);return;}\n\t}\n}\nsigned main()\n{\n\tmemset(siz,-1,sizeof(siz));\n\tscanf(\"%s\",s+1);read(k);\n\tn=strlen(s+1);t.init();\n\trep(i,1,n) t.insert(s[i]);\n\tdfs(0);getans(0);\n\treturn 0;\n}\n```",
        "postTime": 1660647604,
        "uid": 251324,
        "name": "stntn",
        "ccfLevel": 0,
        "title": "AT4130 [ARC097A] K-th Substring \u9898\u89e3"
    },
    {
        "content": "## \u7b80\u8981\u5206\u6790\n\n\u610f\u5916\u53c8\u53d1\u73b0\u8fd9\u9053\u9898\uff0c\u8fd9\u91cc\u518d\u4ecb\u7ecd\u4e00\u79cd\u6bd4\u4e4b\u524d\u5199\u7684\u90a3\u7bc7\u66f4\u597d\u5199\u7684\u505a\u6cd5\n\n\u770b\u5230\u5b50\u4e32\u95ee\u9898\u975e\u5e38\u5bb9\u6613\u60f3\u5230\u53ef\u4ee5\u7528 SAM \u6765\u505a\n\n\u4e8e\u662f\u5c31\u53d8\u6210\u4e86 SAM \u6c42\u672c\u8d28\u4e0d\u540c\u7b2c K \u5c0f\u5b50\u4e32\u677f\u5b50\u9898\uff0c\u4e0d\u4f1a\u7684\u540c\u5b66\u8fd9\u91cc\u6307\u8def [OIwiki](https://oi-wiki.org/string/sam/#k)\n\n## \u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define ri register int\n#define N 10005\nusing namespace std;\nint n, k;\nchar s[N];\nstruct SAM\n{\n\tint n, lst, d[N];\n\tstruct S\n\t{\n\t\tint len, link, nxt[26];\n\t} s[N];\n\tinline SAM()\n\t{\n\t\ts[0].link = -1;\n\t}\n\tinline void insert(int c)\n\t{\n\t\tri t = ++n, p = lst;\n\t\tfor (s[t].len = s[p].len + 1, lst = t; ~p && !s[p].nxt[c]; p = s[p].link)\n\t\t\ts[p].nxt[c] = t;\n\t\tif (~p)\n\t\t{\n\t\t\tri q = s[p].nxt[c], x;\n\t\t\tif (s[q].len == s[p].len + 1)\n\t\t\t\ts[t].link = q;\n\t\t\telse\n\t\t\t\tfor (s[x = ++n] = s[q], s[x].len = s[p].len + 1, s[t].link = s[q].link = x; ~p && s[p].nxt[c] == q; p = s[p].link)\n\t\t\t\t\ts[p].nxt[c] = x;\n\t\t}\n\t\telse\n\t\t\ts[t].link = 0;\n\t}\n\tinline void dfs(int x)\n\t{\n\t\td[x] = 1;\n\t\tfor (ri i = 0; i < 26; ++i)\n\t\t\tif (s[x].nxt[i] && !d[s[x].nxt[i]])\n\t\t\t\tdfs(s[x].nxt[i]), d[x] += d[s[x].nxt[i]];\n\t\t\telse if (s[x].nxt[i])\n\t\t\t\td[x] += d[s[x].nxt[i]];\n\t}\n\tinline void query(int x, int k)\n\t{\n\t\tif (!k)\n\t\t\treturn;\n\t\tfor (ri i = 0; i < 26; ++i)\n\t\t{\n\t\t\tif (!s[x].nxt[i])\n\t\t\t\tcontinue;\n\t\t\tif (d[s[x].nxt[i]] >= k)\n\t\t\t\treturn (void)(putchar(i + 'a'), query(s[x].nxt[i], k - 1));\n\t\t\telse\n\t\t\t\tk -= d[s[x].nxt[i]];\n\t\t}\n\t}\n} SAM;\nsigned main()\n{\n\tscanf(\"%s%lld\", s, &k), n = strlen(s);\n\tfor (ri i = 0; i < n; ++i)\n\t\tSAM.insert(s[i] - 'a');\n\tSAM.dfs(0), SAM.query(0, k);\n\treturn 0;\n}\n```\n",
        "postTime": 1614503152,
        "uid": 51692,
        "name": "\u706b\u8f66\u53f8\u673a",
        "ccfLevel": 0,
        "title": "\u9898\u89e3-AT4130"
    },
    {
        "content": "## \u7b80\u8981\u5206\u6790\n\n\u672c\u4eba\u592a\u83dc\u53ea\u4f1a\u4e00\u79cd\u4e71\u641e\u505a\u6cd5\n\n\u53d1\u73b0 $K \\in [1,5]$ \u5f88\u5c0f\uff0c\u4e8e\u662f\u8003\u8651\u76f4\u63a5\u627e\u51fa\u4e00\u4e9b\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u5b50\u4e32\u4f7f\u5b83\u4eec\u53bb\u91cd\u540e\u81f3\u5c11\u6709 $K$ \u4e2a\n\n\u8981\u4f7f\u5b57\u5178\u5e8f\u6700\u5c0f\u663e\u7136\u9996\u5b57\u6bcd\u9700\u8981\u6700\u5c0f\uff0c\u4e8e\u662f\u76f4\u63a5\u904d\u5386\u6574\u4e2a\u5b57\u7b26\u4e32\u627e\u51fa\u6700\u5c0f\u5b57\u6bcd\u51fa\u73b0\u7684\u6240\u6709\u4f4d\u7f6e\n\n\u7136\u540e\u6211\u4eec\u5c06\u6240\u6709**\u4ee5\u6700\u5c0f\u5b57\u6bcd\u5f00\u5934\u5e76\u4e14\u957f\u5ea6\u5c0f\u4e8e\u7b49\u4e8e $K$ \u7684\u5b50\u4e32**\u5168\u90e8\u63d0\u53d6\u51fa\u6765\u6392\u5e8f\u53bb\u91cd\uff0c\u7136\u540e\u8f93\u51fa\u7b2c $K$ \u5927\u7684\n\n\u4e3a\u4ec0\u4e48\u662f\u8fd9\u4e9b\u5b50\u4e32\u5462\uff1f\n\n\u56e0\u4e3a\u957f\u5ea6\u4e0d\u540c\u5b57\u5178\u5e8f\u5fc5\u7136\u4e0d\u540c\uff0c\u6240\u4ee5\u8fd9\u4e9b\u5b57\u4e32\u53bb\u91cd\u540e\u4e5f\u81f3\u5c11\u6709 $K$ \u4e2a\n\n\u4f46\u662f\uff0c\u4e0a\u9762\u7684\u601d\u8def\u5e76\u4e0d\u5b8c\u5584\uff0c\u8fde\u6837\u4f8b $1$ \u90fd\u901a\u4e0d\u8fc7\n\n\u56e0\u4e3a\u5728\u6837\u4f8b $1$ \u4e2d\uff0c\u4ee5\u6700\u5c0f\u5b57\u6bcd\u5f00\u5934\u7684\u5b50\u4e32\u6700\u957f\u957f\u5ea6\u5c0f\u4e8e $K$\n\n\u90a3\u6211\u4eec\u53ef\u4ee5\u518d\u4ee5\u6b21\u5c0f\u5b57\u6bcd\u4e3a\u5f00\u5934\uff0c\u91cd\u590d\u4e0a\u8ff0\u8fc7\u7a0b\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u76f4\u5230\u51fa\u73b0\u8fc7 $K$ \u4e2a\u4e0d\u540c\u7684\u5b50\u4e32\n\n\u867d\u7136\u770b\u8d77\u6765\u5f88\u66b4\u529b\uff0c\u4f46\u662f $K$ \u548c $|S|$ \u90fd\u5f88\u5c0f\uff0c\u540c\u65f6\u590d\u6742\u5ea6\u4e5f\u5361\u4e0d\u6ee1\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f88\u8f7b\u677e\u5730\u901a\u8fc7\u6b64\u9898\n\n## \u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define ri register int\n#define N 250005\nusing namespace std;\nint n, k, mn, mx, tot, cnt, a[N];\nstring s, str[N];\nsigned main()\n{\n\tios::sync_with_stdio(0);\n\tfor (cin >> s >> k, n = s.length();;)\n\t{\n\t\tmx = 1e18, cnt = tot = 0;\n\t\tfor (ri i = 0; i < n; ++i)\n\t\t\tif (mn < s[i] && s[i] < mx)\n\t\t\t\tmx = s[i], a[cnt = 1] = i;\n\t\t\telse if (s[i] == mx)\n\t\t\t\ta[++cnt] = i;\n\t\tfor (ri i = 1; i <= cnt; ++i)\n\t\t{\n\t\t\tstring t = \"\";\n\t\t\tfor (ri j = 0; j < k && a[i] + j < n; ++j)\n\t\t\t\tt += s[a[i] + j], str[++tot] = t;\n\t\t}\n\t\tsort(str + 1, str + 1 + tot), tot = unique(str + 1, str + 1 + tot) - str - 1;\n\t\tif (k <= tot)\n\t\t{\n\t\t\tcout << str[k];\n\t\t\treturn 0;\n\t\t}\n\t\tk -= tot, mn = mx;\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1606733585,
        "uid": 51692,
        "name": "\u706b\u8f66\u53f8\u673a",
        "ccfLevel": 0,
        "title": "\u9898\u89e3-AT4130"
    }
]
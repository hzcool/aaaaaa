[
    {
        "content": "\u6807\u7b7e: DP\n\n#### Part 1\n\n\u5bf9\u4e8e\u6bcf\u6b21\u64cd\u4f5c\u5c06 $B$ \u8fde\u5411 $A$ . \u8fd9\u6837\u4f1a\u8fde $n-1$ \u6761\u8fb9\u4e14\u56fe\u8054\u901a, \u6240\u4ee5\u8fde\u51fa\u6765\u7684\u662f\u4e00\u68f5\u6811, \u4e0d\u59a8\u4ee5\u6700\u540e\u5269\u4e0b\u7684\u70b9\u4e3a**\u6839\u8282\u70b9**.\n\n\u8003\u8651\u6811\u4e0a\u6bcf\u4e2a\u70b9\u5bf9\u6839\u8282\u70b9\u7684\u5750\u6807\u7684\u8d21\u732e, \u53d1\u73b0\u70b9 $i$ (\u9664\u6839\u4ee5\u5916) \u5bf9\u7236\u4eb2\u7684\u8d21\u732e\u4e3a $+2x^i$ \u6216 $-2x^i$ , \u6613\u5f97 $i$ \u5bf9\u6839\u8282\u70b9\u7684\u8d21\u732e\u4e3a $c_i\\times2^{d_i}x$ , \u5176\u4e2d $d_i$ \u8868\u793a $i$ \u5728\u6811\u4e2d\u7684\u6df1\u5ea6(\u6839\u8282\u70b9\u4e3a $0$), $c_i\\in\\{1,-1\\}$.\n\n\u7531\u4e8e $2^n\\ll x$ , \u4e24\u4e2a\u64cd\u4f5c\u65b9\u6848\u6700\u540e\u7684\u70b9\u5750\u6807\u7684\u53d6\u503c\u4e0d\u540c**\u7b49\u4ef7\u4e8e**\u4e24\u4e2a\u65b9\u6848\u5bf9\u5e94\u7684 $(c_i,d_i)$ \u53d6\u503c\u4e0d\u540c.\n\n#### Part 2\n\n\u53d1\u73b0 $d_i$ \u4ec5\u4e0e\u6811\u7684\u5f62\u6001\u6709\u5173, \u5148\u8003\u8651 $c_i$ \u7684\u53d6\u503c\u53d7\u5230\u4ec0\u4e48\u9650\u5236.\n\n\u4ece\u8fde\u8fb9\u7684\u89d2\u5ea6\u6765\u770b, \u6ce8\u610f\u5230\u8fde\u8fb9\u7684\u987a\u5e8f\u5fc5\u7136\u662f\u4e00\u4e2a\u70b9\u7684\u6240\u6709\u513f\u5b50\u90fd\u8fde\u5411\u8fd9\u4e2a\u70b9\u540e, \u8fd9\u4e2a\u70b9\u624d\u4f1a\u8fde\u5411\u5176\u7236\u4eb2(\u4ece\u64cd\u4f5c\u7684\u5b9a\u4e49\u8003\u8651), \u5728 $u$ \u7684\u6240\u6709\u513f\u5b50\u4f9d\u6b21\u8fde\u5411 $u$ \u65f6, $u$ \u6070\u597d\u88ab\u53d6\u76f8\u53cd\u7684\u6b21\u6570\u4e3a\u513f\u5b50\u6570\u76ee $sn_u$ , \u540c\u65f6\u53ef\u77e5\u6709\u6070\u597d $\\lfloor\\frac {sn_u}2\\rfloor$ \u4e2a\u513f\u5b50\u88ab\u53d6\u76f8\u53cd\u5947\u6570\u6b21.\n\n\u7531\u6b64\u6211\u4eec\u53ef\u77e5, \u5bf9\u4e8e\u6839\u8282\u70b9 $root$, $c_{root}=(-1)^{sn_{root}}$, \u5bf9\u4e8e\u975e\u53f6\u5b50\u8282\u70b9 $u$ , \u6709 $\\lfloor\\frac{sn_u}2\\rfloor$ \u4e2a\u513f\u5b50 $v$ \u6ee1\u8db3 $c_v=(-1)^{sn_v}c_{u}$, \u5176\u4ed6$\\lceil\\frac{sn_u}2\\rceil$ \u4e2a\u513f\u5b50 $v$ \u6ee1\u8db3 $c_v=(-1)^{sn_v+1}c_{u}$ .\n\n#### Part 3\n\n\u8003\u8651DP\u6c42\u65b9\u6848\u6570, \u4e3a\u4e86\u4fbf\u4e8e\u8bbe\u8ba1DP\u72b6\u6001, \u63a2\u7a76\u4e00\u4e0b\u4e24\u4e2a\u65b9\u6848\u7684 $(c_i,d_i)$ \u76f8\u540c\u6709\u4ec0\u4e48\u6027\u8d28.\n\n\u7531 $d_i$ \u5bf9\u5e94\u76f8\u7b49\u77e5, \u4e24\u68f5\u6811\u5728\u6bcf\u4e00\u5c42\u7684\u70b9\u7ec4\u6210\u7684\u96c6\u5408\u5bf9\u5e94\u76f8\u540c. \n\n\u8bb0 $c'_i=-[sn_i\\bmod2]c_i$ , \u7531 $c_i$ \u5bf9\u5e94\u76f8\u7b49\u53ef\u77e5, \u4e24\u68f5\u6811\u6bcf\u4e00\u5c42\u7684 $\\sum c'_i$ \u5bf9\u5e94\u76f8\u7b49, \u7531\u4e8e $c_i\\in\\{-1,1\\}$ , \u6240\u4ee5 $\\sum [c'_i=1]$ \u548c $\\sum[c'_i=-1]$ \u4e5f\u5bf9\u5e94\u76f8\u7b49(\u5373\u7b2c $i$ \u5c42\u5bf9\u4e0b\u4e00\u5c42\u8d21\u732e\u4e3a $1$ \u548c $-1$ \u7684\u6570\u91cf\u5206\u522b\u662f\u4e00\u4e2a\u5b9a\u503c). \u8fd9\u4e2a\u7ed3\u8bba\u53ef\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u6765\u5f97\u51fa: \u7b2c\u4e00\u5c42(\u6839\u8282\u70b9)\u663e\u7136\u6ee1\u8db3, \u53c8\u53ef\u77e5  $\\sum_{d_u=i+1}c'_u={\\frac {\\sum_{d_u=i+1}1+\\sum_{d_u=i}c'_u}{2}}-\\sum_{d_u=i+1}[c_u=1]$ , \u7ed3\u8bba\u5f97\u8bc1.\n\n\u90a3\u4e48\u6211\u4eec\u8bbe\u8ba1\u72b6\u6001 $f[i][j][x]$ \u8868\u793a\u8003\u8651\u5b8c\u4e86 $i$ \u5c42, \u524d $i$ \u5c42\u6709 $j$ \u4e2a\u70b9, \u4e14 $\\sum_{d_u=i}c'_u=x$ \u7684\u65b9\u6848\u6570, \u7531\u4e8e\u4e00\u7ec4\u786e\u5b9a\u7684 $(c_i,d_i)$ \u5bf9\u5e94\u552f\u4e00\u4e00\u7ec4 $c'_i$ , \u6240\u4ee5\u8fd9\u4e2a\u72b6\u6001\u53ef\u4ee5\u4e0d\u91cd\u4e0d\u6f0f\u5730\u7edf\u8ba1\u7b54\u6848, \u7b54\u6848\u4e3a $\\sum_i f[i][n][0]$.\n\n\u8f6c\u79fb\u5f88\u7b80\u5355, \u679a\u4e3e\u7b2c $i$ \u5c42\u6709 $t$ \u4e2a\u70b9, \u5176\u4e2d $p$ \u4e2a\u70b9 $c=1$ \u5f97:  $f[i][j][x]=\\sum_{p\\leqslant t\\leqslant j}{j\\choose t}{t\\choose p}f[i-1][j-t][2x-t+p]$ , \u6ce8\u610f\u7b2c $i$ \u5c42\u8fde\u5411\u7b2c $i+1$ \u5c42\u5f97\u8fb9\u81f3\u5c11\u6709 $abs(x)$ \u6761, \u6545\u8981\u4fdd\u8bc1 $abs(2x-t+p)\\leqslant t$.\n\n\u66b4\u529b\u8f6c\u79fb\u5373\u53ef, \u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^5)$ , \u7f51\u4e0a\u4f3c\u4e4e\u5e7f\u4e3a\u6d41\u4f20\u5404\u79cd $n^4,n^3$ \u7684\u505a\u6cd5(\u770b\u4e0d\u61c2\u554a!!!), \u611f\u89c9\u8fd9\u4e2a\u505a\u6cd5\u88ab\u540a\u6253.\n\n```cpp\n#include <bits/stdc++.h>\n#define mod 1000000007\nusing namespace std;\nint read();\nint M(int x) { return x >= mod ? x - mod : x; }\nvoid Add(int &x, int y) { (x += y) >= mod ? x -= mod : x; }\nint n, res;\nint C[102][102];\nstruct DP {\n    int x[102];\n    int &operator[](int p) {\n        return (p <= 50 && p >= -50) ? x[p + 50] : x[101];\n    }\n} f[102][102];\nint main() {\n    scanf(\"%d\", &n), f[1][1][0] = f[1][1][1] = 1;\n    if (n == 1) return puts(\"1\"), 0;\n    for (int i = C[0][0] = 1; i <= n; ++i)\n        for (int j = C[i][0] = 1; j <= i; ++j)\n            C[i][j] = M(C[i - 1][j] + C[i - 1][j - 1]);\n    for (int i = 2; i <= n; ++i) {\n        for (int j = i; j <= n; ++j)\n            for (int x = j - n; x <= n - j; ++x)\n                for (int t = 1; t <= j; ++t)\n                    for (int p = 0; p <= t; ++p)\n                        if (abs((x + p) * 2 - t) <= t)\n                            Add(f[i][j][x],\n                                1ll * f[i - 1][j - t][(x + p) * 2 - t] *\n                                    C[j][t] % mod * C[t][p] % mod);\n        Add(res, f[i][n][0]);\n    }\n    printf(\"%d\\n\", res);\n    return 0;\n}\n```\n\n",
        "postTime": 1581862460,
        "uid": 51237,
        "name": "Kinandra",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT3951 \u3010[AGC022F] Checkers\u3011"
    },
    {
        "content": "> *I. [AT3951 [AGC022F] Checkers](https://www.luogu.com.cn/problem/AT3951)*\n\n\u4e3a\u4ec0\u4e48\u4f1a\u6709\u4eba\u6a21\u62df\u8d5b\u642c AGC F \u554a\uff1f\n\n\u9996\u5148\u5c06\u6bcf\u4e2a\u70b9\u7684\u5750\u6807\u770b\u6210 $10 ^ {100}$ \u8fdb\u5236\uff0c\u90a3\u4e48\u6bcf\u4e00\u4f4d\u72ec\u7acb\uff0c\u56e0\u4e3a\u6700\u7ec8\u7ed3\u679c\u7684\u6bcf\u4e00\u4f4d\u4e0d\u8d85\u8fc7 $2 ^ {n - 1} \\ll  10 ^ {100}$\u3002\n\n\u8003\u8651\u4e00\u4e2a\u70b9\u5220\u53bb\u53e6\u4e00\u4e2a\u70b9\u7684\u8fc7\u7a0b\uff0c\u4ece $A\\to B$ \u8fde\u8fb9\u753b\u6210\u4e00\u68f5\u6811\u3002\u90a3\u4e48\u6700\u7ec8 $B$ \u8fd9\u4e00\u4f4d\u7684\u7edd\u5bf9\u503c\u5373 $2 ^ d$\uff0c\u5176\u4e2d $d$ \u662f\u5b83\u7684\u6df1\u5ea6\uff0c\u56e0\u4e3a\u6bcf\u6b21 $0$ \u5411 $2 ^ k$ \u8df3\u4e00\u6b65\u4f1a\u8fbe\u5230 $2 ^ {k + 1}$\u3002\n\n\u73b0\u5728\u7684\u95ee\u9898\u662f\u6bcf\u4e00\u4f4d\u7684\u7b26\u53f7\u5e94\u5f53\u5982\u4f55\u786e\u5b9a\u3002\u6ce8\u610f\u5230 $B$ \u88ab\u5220\u53bb\u540e\uff0c\u5305\u542b $B$ \u8fd9\u4e00\u4f4d\u7684\u70b9\u6bcf\u5220\u53bb\u4e00\u4e2a\u70b9\uff0c$B$ \u7684\u7b26\u53f7\u5c31\u4f1a\u6539\u53d8\u4e00\u6b21\u3002\u56e0\u6b64\uff0c\u4e00\u4e2a\u8282\u70b9\u53d7\u5230\u5b83\u7684\u6240\u6709\u7956\u5148 $a$ \u5728\u4e0e $a$ \u540c\u4e00\u5c42\u7684\u4e14\u5728 $fa_a$ \u7684\u5b50\u6811\u5185\u7684 \u201c\u5144\u5f1f\u201d \u8282\u70b9\u5f53\u4e2d\u88ab\u5220\u53bb\u7684\u65f6\u95f4\u7684\u5f71\u54cd\uff0c\u6216\u8005\u8bf4\u4e00\u4e2a\u70b9 $u$ \u7684\u7b26\u53f7\u53d7\u5230 \u201c\u67d0\u4e2a\u8282\u70b9\u5220\u53bb\u5305\u542b $u$ \u7684\u8282\u70b9\uff08\u56e0\u4e3a $v$ \u5220\u53bb $u$ \u4e4b\u540e\u5c31\u5305\u542b\u4e86\u5b83\uff0c\u800c $v$ \u5220\u6389\u5b83\u7684\u6240\u6709\u513f\u5b50\u4e4b\u540e\u53c8\u88ab $w$ \u5220\u9664\uff0c\u90a3\u4e48 $w$ \u5c31\u5305\u542b\u4e86 $u$\uff09\u5e76\u5728\u6b64\u4e4b\u540e\u53c8\u5220\u6389\u4e86\u5176\u5b83\u8282\u70b9\u201d \u8fd9\u4e2a\u4e8b\u4ef6\u53d1\u751f\u6b21\u6570\u7684\u5947\u5076\u6027\u3002\u8fd9\u4e2a\u5728\u4ece\u4e0a\u5f80\u4e0b DP \u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u76f4\u63a5\u8003\u8651\u5230\uff1a\u8003\u8651\u4e00\u6b21\u6269\u5c55\u4e00\u5c42\u3002\u5982\u679c\u4e00\u4e2a\u672c\u5c42\u8282\u70b9 $u$ \u5728\u4e0b\u4e00\u5c42\u6709\u5076\u6570\u4e2a\u513f\u5b50\uff0c\u90a3\u4e48\u8fd9\u4e9b\u8282\u70b9\u6b63\u8d1f\u4e2a\u6570\u76f8\u7b49\uff0c\u5426\u5219 **\u4e0e $u$\u200b \u76f8\u540c\u7684\u7b26\u53f7** \u4f1a\u591a\u4e00\u4e2a\uff0c\u56e0\u4e3a\u6700\u540e\u88ab $u$ \u5220\u53bb\u7684\u8282\u70b9\u4e0e $u$ \u7684\u7b26\u53f7\u76f8\u540c\uff0c\u5f80\u524d\u63a8\u6b63\u8d1f\u6027\u4e0d\u65ad\u6539\u53d8\uff0c\u56e0\u4e3a\u6709\u5947\u6570\u4e2a\u6240\u4ee5\u9664\u53bb\u6700\u540e\u88ab $u$ \u5220\u53bb\u7684\u8282\u70b9\u5f80\u524d\u63a8\u5076\u6570\u4e2a\uff0c\u6b63\u8d1f\u62b5\u6d88\u4e86\u3002\n\n\u4f46\u662f $B$ \u7684\u7b26\u53f7\u8fd8\u53d7\u5230\u5b83\u7684\u513f\u5b50\u4e2a\u6570\u7684 **\u5947\u5076\u6027** \u7684\u5f71\u54cd\uff0c\u56e0\u4e3a $B$ \u6bcf\u5220\u53bb\u4e00\u4e2a\u70b9\uff0c\u7b26\u53f7\u4e5f\u4f1a\u6539\u53d8\u4e00\u6b21\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u8bb0\u5f55\u4e00\u7ef4\u4f53\u73b0\u8fd9\u4e2a\u56e0\u7d20\u3002\u5c42\u6570\u662f\u4e0d\u91cd\u8981\u7684\uff0c\u6211\u4eec\u53ea\u9700\u77e5\u9053\u5df2\u7ecf\u9009\u62e9\u4e86\u51e0\u4e2a\u8282\u70b9\uff0c\u56e0\u6b64\u8bbe $f_{i, j}$ \u8868\u793a\u5df2\u7ecf\u786e\u5b9a\u4e86 $i$ \u4e2a\u8282\u70b9\uff0c\u5176\u4e2d\u5f53\u524d\u5c42\u94a6\u5b9a **\u6070\u597d** \u6709 $j$\u200b\u200b \u4e2a\u8282\u70b9\u6709\u5947\u6570\u4e2a\u513f\u5b50\uff08\u8fd9\u610f\u5473\u7740\u8fd9\u4e9b\u8282\u70b9\u7684 **\u539f\u7b26\u53f7**\uff08\u5373\u4e0d\u8003\u8651\u513f\u5b50\u4e2a\u6570\u7684\u5947\u5076\u6027\u7684\u5f71\u54cd\uff0c\u4ec5\u8003\u8651\uff09\u4e0e **\u6700\u7ec8\u7b26\u53f7**\uff08\u5373\u8003\u8651\u513f\u5b50\u4e2a\u6570\u7684\u5947\u5076\u6027\u7684\u5f71\u54cd\uff09\u4e0d\u540c\uff09\u7684\u603b\u65b9\u6848\u6570\u3002\n\n- \u88ab\u94a6\u5b9a\u6709\u5947\u6570\u4e2a\u513f\u5b50\u7684\u8282\u70b9\u539f\u7b26\u53f7\u5fc5\u7136\u76f8\u540c\uff0c\u56e0\u4e3a\u82e5\u6709\u4e24\u4e2a\u7b26\u53f7\u4e0d\u540c\u7684\u8282\u70b9\u94a6\u5b9a\u6709\u5947\u6570\u4e2a\u513f\u5b50\uff0c\u8fd9\u4e0e\u5b83\u4eec\u540c\u65f6\u6709\u5076\u6570\u4e2a\u513f\u5b50\u6240\u4ea7\u751f\u7684\u6b63\u8d1f\u8d21\u732e\u662f\u7b49\u4ef7\u7684\u3002\u6ce8\u610f\uff0c\u7b26\u53f7\u548c\u8282\u70b9\u7f16\u53f7\u7684\u9009\u62e9\u662f\u4e24\u4e2a\u76f8\u5bf9\u72ec\u7acb\u7684\u4e8b\u4ef6\u3002\u800c\u6211\u4eec\u81ea\u7136\u662f\u5e0c\u671b\u94a6\u5b9a\u6709\u5947\u6570\u4e2a\u513f\u5b50\u7684\u8282\u70b9\u8d8a\u5c11\u8d8a\u597d\uff0c\u56e0\u4e3a\u94a6\u5b9a\u6709\u5947\u6570\u4e2a\u513f\u5b50\u610f\u5473\u7740\u4e0b\u4e00\u5c42\u5fc5\u987b\u5f97\u6709\u7b26\u53f7\u56fa\u5b9a\u7684\u4e00\u4e9b\u8282\u70b9\u3002\n\n\u9996\u5148\u8003\u8651\u521d\u59cb\u503c\uff0c\u5e94\u8be5\u662f $f_{1, 0} = f_{1, 1} = n$\u3002\u56e0\u4e3a\u6839\u53ef\u4ee5\u6709\u5947\u6570\u6216\u5076\u6570\u4e2a\u513f\u5b50\u3002\u6b64\u65f6\u8fd9\u4e2a $j = 1$ \u662f\u6b63\u53f7\uff0c\u56e0\u4e3a\u6839\u8282\u70b9\u7684\u521d\u59cb\u7684\u7b26\u53f7\u662f\u6b63\u7684\uff08\u5220\u53bb\u5305\u542b\u6839\u7684\u8282\u70b9\u5e76\u5728\u6b64\u4e4b\u540e\u53c8\u5220\u6389\u4e86\u5176\u5b83\u8282\u70b9\u7684\u6b21\u6570\u4e3a $0$\uff0c\u56e0\u4e3a\u6ca1\u6709\u8282\u70b9\u80fd\u5220\u6389\u6839\uff09\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u8f6c\u79fb\u3002\u679a\u4e3e **\u5728\u6700\u7ec8** \u4e0e $j$ \u5bf9\u5e94\u7684\u7b26\u53f7 $\\rm sign$\uff08\u4e5f\u5c31\u662f\u94a6\u5b9a\u4e86 $j$ \u4e2a\u539f\u6765\u4e3a $\\rm sign$ \u7684\u8282\u70b9\u5728\u6700\u7ec8\u8981\u53d8\u4e3a $-\\rm sign$\uff09\u76f8\u540c\u7684\u8282\u70b9\u4e2a\u6570 $x$ \u548c\u4e0d\u540c\u7684\u8282\u70b9\u4e2a\u6570 $y$\u3002\u5982\u679c $j = 0$ \u5219\u4efb\u610f\uff0c\u56e0\u4e3a\u7a76\u7adf $x$ \u662f\u6b63\u8fd8\u662f $y$ \u4e3a\u6b63\u90fd\u65e0\u6240\u8c13\uff0c\u8fd9\u662f\u5bf9\u79f0\u7684\u3002\n\n\u6839\u636e\u4e0a\u4e00\u5c42\u7684\u9650\u5236\uff0c\u6211\u4eec\u9996\u5148\u5f97\u653e $j$ \u4e2a\u7b26\u53f7\u4e3a $\\rm sign$ \u7684\u8282\u70b9\u6302\u5230\u90a3\u4e9b\u88ab\u94a6\u5b9a\u6070\u597d\u6709\u5947\u6570\u4e2a\u513f\u5b50\u7684\u8282\u70b9\u4e0a\uff0c\u5269\u4e0b\u6765\u7684**\u539f\u7b26\u53f7\u6b63\u8d1f\u5e73\u5206**\uff0c\u539f\u56e0\u5728\u4e0a\u9762\u5df2\u7ecf\u5206\u6790\u8fc7\u4e86\u3002\u56e0\u6b64 **\u539f\u7b26\u53f7** \u4e3a $\\rm sign$ \u7684\u8282\u70b9\u4e2a\u6570\u4e3a $\\dfrac {x + y + j} 2$\uff08\u5982\u679c $x + y + j$ \u7684\u5947\u5076\u6027\u4e0d\u5bf9\uff0c\u5219\u8fd9\u79cd\u65b9\u6848\u4e0d\u5408\u6cd5\uff0c\u8df3\u8fc7\uff09\u3002\u8fd9\u8bf4\u660e\u6211\u4eec\u88ab\u8feb\u7528\u94a6\u5b9a\u4e00\u4e9b\u4e14\u4ec5\u6709\u8fd9\u4e9b\u8282\u70b9\u62e5\u6709\u5947\u6570\u4e2a\u513f\u5b50\u7684\u65b9\u6cd5\u66f4\u6539\u5b83\u4eec\u7684\u7b26\u53f7\uff0c\u4e5f\u5c31\u662f\u8ba9\u6700\u7ec8\u7b26\u53f7\u7684\u5206\u5e03\u548c\u6211\u4eec\u679a\u4e3e\u7684 $x, y$ \u4e00\u81f4\uff0c\u8fd9\u6837\u8ba1\u6570\u624d\u6b63\u786e\u3002\u663e\u7136\uff0c\u6211\u4eec\u9700\u8981\u94a6\u5b9a $\\left|x- \\dfrac {x +y + j} 2\\right|$ \u4e2a\u8282\u70b9\u6539\u53d8\u7b26\u53f7\u3002\u5f53 $x$ \u66f4\u5927\u65f6\uff0c\u8bf4\u660e\u9700\u8981\u5c06\u4e00\u4e9b\u539f\u7b26\u53f7\u4e3a $-\\rm sign$ \u7684\u8282\u70b9\u6539\u6210 $\\rm sign$\uff0c\u5426\u5219\u9700\u8981\u5c06\u4e00\u4e9b\u539f\u7b26\u53f7\u4e3a $\\rm sign$ \u7684\u8282\u70b9\u6539\u6210 $\\rm -sign$\u3002\u4f46\u65e0\u8bba\u662f\u54ea\u79cd\u60c5\u51b5\uff0c\u53ea\u8981 $j$ \u7684 $-\\rm sign$ \u786e\u5b9a\u4e86\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684\u6539\u7b26\u53f7\u4e5f\u786e\u5b9a\u4e86\uff0c\u5373\u8f6c\u79fb\u5230\u7684 $\\dfrac {|x - y - j|} 2$ \u5bf9\u5e94\u7684\u7b26\u53f7\u4e5f\u786e\u5b9a\u4e86\uff0c\u56e0\u6b64 $x, y$ \u7684\u7b26\u53f7\u4e5f\u786e\u5b9a\u4e86\uff0c\u5373\u552f\u4e00\u786e\u5b9a\u4e00\u79cd\u65b9\u6848\u3002\u7531\u4e8e\u4e00\u5f00\u59cb $j = 1$ \u786e\u5b9a\u5bf9\u5e94\u6b63\u53f7\uff0c$j = 0$ \u5219 $x, y$\u200b \u7684\u7b26\u53f7\u6839\u636e\u5bf9\u79f0\u6027\u53ef\u4ee5\u4efb\u610f\u94a6\u5b9a\uff0c\u6240\u4ee5\u65b9\u6848\u552f\u4e00\u786e\u5b9a\u3002\n\n\u7efc\u4e0a\uff0c\u6709\u8f6c\u79fb\u65b9\u7a0b\n$$\nf_{i, j} \\times \\dbinom{n - i}{x + y}\\dbinom{x + y}{x} \\to f_{i + x + y, \\frac {|x - y - j|} 2}\n$$\n\u9650\u5236\u4e3a $x +y + j$ \u662f\u5076\u6570\u4e14 $x + y \\geq \\max(1, j)$\u3002\u663e\u7136\uff0c$f_{n, 0}$ \u5373\u4e3a\u6240\u6c42\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n ^ 4)$\u200b\u200b\u3002\n\n\u53ef\u80fd\u8bb2\u5f97\u6bd4\u8f83\u6df7\u4e71\uff0c\u603b\u7ed3\u4e00\u4e0b\u3002\u6211\u4eec\u5b9a\u4e49 **\u539f\u7b26\u53f7** \u4e3a\u4ec5\u8003\u8651 $u$ \u7684\u7956\u5148\u7684\u5f71\u54cd\u65f6\u7684\u7b26\u53f7\u3002$u$ \u7684\u539f\u7b26\u53f7\u7531 $u$ \u7684\u7236\u4eb2\u7684 **\u539f\u7b26\u53f7** \u4ee5\u53ca $u$ \u5728\u5b83\u7684\u6240\u6709\u5144\u5f1f\u8282\u70b9\u4e2d\u88ab\u5220\u53bb\u7684\u987a\u5e8f\u51b3\u5b9a\u3002\u5982\u679c\u4e00\u4e2a\u539f\u7b26\u53f7\u4e3a $\\rm sign$ \u7684\u8282\u70b9 $u$ \u6709\u5076\u6570\u4e2a\u513f\u5b50\uff0c\u90a3\u4e48\u5b83\u4eec\u7684\u539f\u7b26\u53f7\u6b63\u8d1f\u4e2a\u6570\u76f8\u540c\u3002\u5982\u679c\u6709\u5947\u6570\u4e2a\u513f\u5b50\uff0c\u90a3\u4e48\u4f1a\u591a\u51fa\u6765\u4e00\u4e2a\u539f\u7b26\u53f7\u4e3a $\\rm sign$ \u7684\u513f\u5b50\uff0c\u5e76\u4e14 $u$ \u7684\u6700\u7ec8\u7b26\u53f7\u4f1a\u53d8\u4e3a $-\\rm sign$\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u80fd\u591f\u4f7f\u5f97\u4e00\u4e2a\u8282\u70b9\u7684\u539f\u7b26\u53f7\u548c\u6700\u7ec8\u7b26\u53f7\u4e0d\u540c\u7684\u552f\u4e00\u65b9\u6cd5\u3002\n\n\u5bf9\u4e8e $f_{i, j}$ \u8fd9\u4e2a\u72b6\u6001\u6765\u8bf4\uff0c\u6211\u4eec\u5f3a\u5236\u4ee4 $j$ \u4e2a\u8282\u70b9\u7684\u7b26\u53f7\u9700\u8981\u4ece $\\rm sign$ \u53d8\u4e3a $-\\rm sign$\uff0c\u901a\u8fc7\u4ee4\u5b83\u4eec\u6709\u5947\u6570\u4e2a\u513f\u5b50\u5b9e\u73b0\u3002\u8fd9\u4e2a\u7b26\u53f7\u5df2\u7ecf\u786e\u5b9a\u4e86\uff0c\u539f\u56e0\u5728\u4e0a\u9762\u6709\u8bf4\u660e\u3002\u56e0\u6b64\uff0c\u8fd9\u610f\u5473\u7740\u4e0b\u4e00\u5c42\u8282\u70b9\u539f\u7b26\u53f7\u7b49\u4e8e $\\rm sign$ \u7684\u6bd4\u539f\u7b26\u53f7\u7b49\u4e8e $-\\rm sign$ \u7684\u8981\u591a\u51fa\u6765 $j$ \u4e2a\u3002\u4f46\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u5b83\u4eec\u7684\u6700\u7ec8\u7b26\u53f7\u5206\u5e03\u5c31\u7b49\u4e8e\u539f\u7b26\u53f7\u5206\u5e03\uff0c\u56e0\u4e3a\u4e0b\u4e00\u5c42\u8282\u70b9\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5b83\u4eec\u7684\u513f\u5b50\u6539\u53d8\u7b26\u53f7\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u679a\u4e3e\u6700\u7ec8\u7b26\u53f7\u5206\u5e03 $x, y$\uff0c\u8fd9\u6837\u53ef\u4ee5\u65b9\u4fbf\u5730\u7b97\u8d21\u732e\uff0c\u5e76\u76f4\u63a5\u63a8\u51fa\u81f3\u5c11\u9700\u8981\u6539\u53d8\u591a\u5c11\u4e2a\u8282\u70b9\u7684\u539f\u7b26\u53f7\uff0c\u4ece\u800c\u5b9e\u73b0\u8f6c\u79fb\u3002\n\n\u63a5\u4e0b\u6765\u8bf4\u4e00\u4e0b\u5982\u4f55\u4f18\u5316\u5230\u4e09\u6b21\u65b9\u3002\u8f6c\u79fb\u65b9\u7a0b\u5148\u5316\u7b80\u4e3a\n$$\nf_{i, j} \\times \\dfrac{(n - i)!}{(n - i - x - y)! x! y!} \\to f_{i + x + y, \\frac {|x - y - j|} 2}\n$$\n\u8003\u8651\u4e3a $f_{i, j}$ \u4e58\u4ee5 $(n - i)!$\uff0c\u90a3\u4e48\u8f6c\u79fb\u65b9\u7a0b\u53d8\u4e3a $\\dfrac {f_{i, j}}{x! y!} \\to \\cdots$\u3002\u6700\u540e\u7b54\u6848\u56e0 $(n - n)! = 1$ \u4ecd\u4e3a $f_{n, 0}$\u3002\n\n\u6211\u4eec\u6ce8\u610f\u5230 $x, y$ \u7684\u8f6c\u79fb\u76f8\u5bf9\u6765\u8bf4\u662f\u5f88\u72ec\u7acb\u7684\uff0c\u9664\u4e86\u8981\u6ee1\u8db3 $2\\mid x + y + j$\uff0c$x + y > 0$ \u4e14 $x + y\\geq j$ \u7684\u9650\u5236\u3002\u7b2c\u4e00\u9879\u7b49\u4ef7\u4e8e $2\\mid x + y - j$\uff0c\u7b2c\u4e09\u9879\u7b49\u4ef7\u4e8e $y\\geq j - x$\u3002\u7531\u4e8e\u6700\u7ec8\u8d21\u732e\u7684\u4e0b\u6807\u5f62\u4e3a $\\dfrac {|x - y - j|}2$\uff0c\u6211\u4eec\u4e0d\u59a8\u5148\u4ece $f(i, j)$ \u8f6c\u79fb\u5230 $g(i + x, x - j)$\uff0c\u518d\u4ece $g(i', j')$ \u8f6c\u79fb\u5230 $f\\left(i' + y, \\dfrac {|j' - y|} 2\\right)$\u3002\n\n\u8003\u8651\u8fd9\u4e9b\u9650\u5236\uff1a$y \\geq j - x\\iff y \\geq -j'$\uff0c\u5bb9\u6613\u8003\u8651\u5230\u3002$2\\mid x + y - j\\iff 2\\mid j' + y$\uff0c\u5bb9\u6613\u8003\u8651\u5230\u3002\u5bf9\u4e8e $x + y > 0$ \u800c\u8a00\uff0c\u6211\u4eec\u5728\u679a\u4e3e $x$ \u7684\u65f6\u5019\u4ec5\u679a\u4e3e $x \\geq 1$ \u7684\u90e8\u5206\u3002\u4e3a\u4e86\u5305\u542b $x = 0$\uff0c$y\\geq 1$\u200b\u200b \u7684\u90e8\u5206\uff0c\u6211\u4eec\u7528\u4e00\u5f00\u59cb\u7684\u8f6c\u79fb\u65b9\u7a0b\u5c31\u597d\u4e86\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n ^ 3)$\u3002\n\n\u6ce8\u610f\u5bf9\u4e8e\u6bcf\u4e2a $i$ \u8981\u5148\u7528 $g_i \\to f_{i + y}$\uff0c\u518d $f_i\\to g_{i + x}$\uff0c\u524d\u8005\u6c42\u51fa\u4e86 $f_i$ \u7684\u771f\u5b9e\u503c\uff08\u56e0\u4e3a\u6709 $y = 0$ \u7684\u60c5\u51b5\uff09\uff0c\u5426\u5219\u4f1a\u6f0f\u8003\u8651\u5f88\u591a\u60c5\u51b5\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 500 + 5, p = 1e9 + 7;\nint n, fc[N], ifc[N], f[N][N], g[N][N << 1];\nvoid add(int &x, int y) {x += y, x >= p && (x -= p);}\nint ksm(int a, int b) {\n\tint s = 1;\n\twhile(b) {\n\t\tif(b & 1) s = 1ll * s * a % p;\n\t\ta = 1ll * a * a % p, b >>= 1;\n\t}\n\treturn s;\n}\nint main() {\n\tcin >> n;\n\tfor(int i = fc[0] = 1; i <= n; i++) fc[i] = 1ll * fc[i - 1] * i % p;\n\tifc[n] = ksm(fc[n], p - 2), f[1][0] = f[1][1] = fc[n];\n\tfor(int i = n - 1; ~i; i--) ifc[i] = 1ll * ifc[i + 1] * (i + 1) % p;\n\tfor(int i = 1; i <= n; i++) {\n\t\tfor(int j = -n; j <= n; j++) if(g[i][j + n]) for(int y = max(0, -j); y <= n - i; y++) if(j - y & 1 ^ 1) add(f[i + y][abs(j - y) >> 1], 1ll * g[i][j + n] * ifc[y] % p);\n\t\tfor(int j = 0; j <= i; j++) if(f[i][j]) {\n\t\t\tfor(int x = 1; x <= n - i; x++) add(g[i + x][x - j + n], 1ll * f[i][j] * ifc[x] % p);\n\t\t\tfor(int y = 1; y <= n - i; y++) if(y >= j && (y + j & 1 ^ 1)) add(f[i + y][y + j >> 1], 1ll * f[i][j] * ifc[y] % p);\n\t\t}\n\t}\n\tcout << f[n][0] << endl;\n    return 0;\n}\n```\n\n",
        "postTime": 1649125538,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "AT3951 [AGC022F] Checkers"
    },
    {
        "content": "\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd@_Enthalpy\u6559\u6211\u7684\u5176\u5b9e\u662fAGC\u6807\u89e3\u7684\u65b9\u6cd5\n\n\u5e0c\u671b\u5927\u5bb6\u80fd\u8bfb\u5b8c\u8fd9\u7247\u9898\u89e3\uff0c\u770b\u4e0a\u53bb\u6027\u8d28\u5f88\u591a\u5f88\u6742\uff0c\u5176\u5b9e\u4f60\u4f1a\u53d1\u73b0\u6bcf\u4e00\u6b65\u90fd\u5f88\u903b\u8f91\u7d27\u5bc6\n\n\u9996\u5148\u6211\u4eec\u8f6c\u5316\u4e00\u4e0b\u95ee\u9898\n\n\u8fd9\u79cd $n$ \u5143\u7ec4\u5176\u5b9e $A_i$ \u5bf9\u5e94\u7684\u662f$(-1)^j2^{i-1}$,\u4e0b\u6807\u4e0d\u597d\u632a\u4f4d\u7f6e\u4e0b\u9762\u7ecf\u5e38\u5199\u9519\u4e86\u6709\u4e9b\u4e0b\u754c\u662f $0$ \u7684\u5199\u6210 $1$ \u4e86\u6709\u4e9b\u53c8\u53cd\u4e86\uff0c\u5e0c\u671b\u5927\u5bb6\u7406\u89e3\n\n(\u5e0c\u671b\u5927\u5bb6\u80fd\u7406\u89e3\u8fd9\u79cd\u8f6c\u6362\u548c\u5176\u4ed6\u9898\u89e3\u91cc\u6811\u505a\u6cd5\u7684\u76f8\u4f3c\u6027(~~\u6211\u4e0d\u80fd\u7406\u89e3~~))\n\n\u5b9a\u4e49 $n$ \u4e2a $n$ \u5143\u7ec4\uff0c\u5206\u522b\u4e3a $A_i($ \u6700\u521d $A_i[i]=1),\\forall j\\neq i,A_i[j]=0$\n\n\u5b9a\u4e49\u5728 $n$ \u5143\u7ec4\u57df\u4e0a\u7684\u4e8c\u5143\u8fd0\u7b97\u4e3a $*$ ,\u4f7f\u5f97 $C=A*B\\Leftrightarrow \\forall i\\in[1,n],C[i]=2A[i]-B[i]$\uff0c\u6ce8\u610f\u5230\u8fd9\u4e2a\u8fd0\u7b97\u6ca1\u6709\u4ea4\u6362\u5f8b\n\n\u7136\u540e\u95ee\u9898\u53d8\u6210\u6c42 $|\\bigcup\\limits _{p \\text{~is~a~permutation}}((((A_{p_1}*A_{p_2})*A_{p_3}))\\cdots *A_{p_n})|$\n\n\u5373\u5408\u6cd5\u7684\u53ef\u4ee5\u4f5c\u4e3a $A_i$ \u6309\u5e8f\u4e58\u79ef\u7684\u7ed3\u679c\u79cd\u7c7b\n\n\u8bbe $B$ \u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e58\u79ef\uff0c\u73b0\u5728\u5bf9 $B$ \u7684\u6027\u8d28\u4f5c\u5206\u6790\n\n- \u3010\u6027\u8d281\u3011$\\forall i, \\exists j,k\\in \\mathbb{Z},B[i]=(-1)^j2^k$\n\t- \u5f88\u5bb9\u6613\u7406\u89e3\uff0c\u8fd9\u4e2a\u5f52\u7eb3\u6cd5\u5373\u53ef\n- \u3010\u6027\u8d282\u3011\u4e0b\u6587\u5bf9\u4efb\u610f $n$\u5143\u7ec4 $A$ \u5747\u8bbe $|A|=\\sum_{i} A_i$\uff0c\u82e5 $B$ \u662f\u4efb\u610f\u5408\u6cd5\u7684\u4e58\u79ef\u6709 $|A|=1$\n\t- \u8fd9\u4e2a\u5f52\u7eb3\u6cd5\u4e5f\u53ef\uff0c\u6838\u5fc3 $C=A*B\\Rightarrow |C|=2|A|-|B|=1$\n- \u3010\u6027\u8d283\u3011\u82e5$A[i]>0$\u5219$A[i-1]>0(i>1)$\n\t- \u663e\u7136\n- \u3010\u6027\u8d284\u3011**\u8d85\u7ea7\u91cd\u8981\u7684\u6027\u8d28**:\u82e5 $A$ \u5408\u6cd5\u5219\u5bf9 $\\forall i\\in[1,n],$ \u8bbe $S_1=\\sum\\limits_{j=1}^{i-1}A[j]$ \uff0c\u518d\u8bbe $A$ \u4e2d\u5f62\u5982 $(-1)^k2^i$ \u7684\u4e2a\u6570\u4e3a $p$ \u5219\u5b58\u5728\u4e00\u79cd\u4e3a $p$ \u4e2a $2^i$ \u5b9a\u7b26\u53f7 $(+~\\mathrm{or}~-)$ \u65b9\u5f0f\u4f7f\u5f97\u8fd9 $p$ \u4e2a\u6570\u4e0e $S_1$ \u7684\u548c\u4e3a $1$ ,\u4e5f\u5373$\\forall i\\in[1,n],\\exists \\{x_j\\}(\\forall j\\in[1,i],x_j\\in\\{-1,1\\}),\\left(\\sum\\limits_{j=1}^px_j2^i\\right)+S_1=1$\n\t- \u8fd9\u4e2a\u6027\u8d28\u4f9d\u7136\u7528\u5f52\u7eb3\u6cd5\u8bc1\u660e\uff0c\u57fa\u4e8e\u5bf9\u6ee1\u8db3\u6027\u8d28\u7684 $n$ \u4e00\u5b9a\u53ef\u4ee5\u88ab\u6784\u9020\u51fa\u6765\uff0c\u6211\u4eec\u5206\u53ef\u4ee5\u62c6\u51fa\u5bf9\u6307\u5b9a\u7684 $i$ , $2^j(j\\in[1,i))$ \u90fd\u5b58\u5728\u81f3\u5c11 $2$ \u4e2a\uff0c\u548c\u4e0d\u80fd\u7684\u5206\u7c7b\u8ba8\u8bba\uff0c\u540e\u9762\u4e00\u79cd\u9664\u4e86\u552f\u72ec $2^1$ \u5355\u72ec\u4e00\u4e2a\u90fd\u662f\u975e\u6cd5\u7684\uff0c\u53ef\u8bc1\n   - \u3010\u6027\u8d284\u63a8\u8bba\u3011\u6613\u53d1\u73b0\u8fd9\u4e2a\u6027\u8d28\u5728 $A$ \u4e0a\u6ee1\u8db3\u540e\uff0c\u82e5\u6211\u4eec $A$ \u4e2d\u6709\u503c\u7684\u90e8\u5206 $2$ \u7684\u6b21\u5e42\u5f62\u5982(\u6027\u8d283) $2^{j}(j\\in[0,i])$,\u5219\u6211\u4eec\u5fc5\u5b9a\u53ef\u4ee5\u628a $|A|$ \u8868\u793a\u6210 $1+t2^{i+1},t\\in \\mathbb{Z}$\n\t\t- \u518d\u7ed9\u4e00\u4e2a\u8bc1\u660e\uff0c$\\exists \\{x_j\\}(\\forall j\\in[1,i],x_j\\in\\{-1,1\\}),\\left(\\sum\\limits_{j=1}^px_j2^i\\right)+\\left(\\sum\\limits_{j=1}^{i-1}A[j]\\right)=1 $,\u5219\u53d1\u73b0\u4efb\u610f$\\{y_j\\}(\\forall j\\in[1,i],y_j\\in\\{-1,1\\}),\\{x_j\\}\\neq \\{y_j\\}$ \u6709$\\left(\\sum\\limits_{j=1}^px_j2^i\\right)\\equiv \\left(\\sum\\limits_{j=1}^py_j2^i\\right)\\pmod {2^{i+1}}\n        $\u5373$\\left(\\sum\\limits_{j=1}^py_j2^i\\right)+\\left(\\sum\\limits_{j=1}^{i-1}A[j]\\right)\\equiv 1\\pmod{2^{i+1}}$\n\n\u8fd9\u56db\u4e2a\u6027\u8d28\u662f $n$ \u5143\u7ec4\u5408\u6cd5\u7684\u5145\u8981\u6761\u4ef6\n\n\u7136\u540e\u8bbe\u8ba1dp\n\n\u4ee4$f_{i,j}$\u8868\u793a\u503c\u57df\u4e3a$\\{x|x=2^k,k\\in[1,n]\\}$\uff0c\u653e\u5165\u4e86 $i$ \u4e2a\u5143\u7d20\uff0c$\\exists k\\in[1,n],|A|=1+j2^k$\uff0c\u7684\u6ee1\u8db3\u3010\u6027\u8d281,3,4\u3011\u7684 $n$ \u5143\u7ec4\u4e2a\u6570(\u8fd9\u4e00\u6b65dp\u7684\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\"\u524d\u7f00\")\n\n\u5bf9\u6307\u5b9a\u7684\u7528 $1+j2^k$ \u6765\u8868\u793a $|A|$\u7684\u6240\u6709\u7684\u88ab\u7edf\u8ba1 $A$ ,\u6211\u4eec\u77e5\u9053\u539f\u6765\u5143\u7d20\u7684\u7edd\u5bf9\u503c $\\in\\{x|x=2^j,j\\in[0,k)\\}$,\u6545\u8003\u8651\u5f53\u524d\u52a0\u5165 $x$ \u4e2a $2^k$ , $y$ \u4e2a $-2^k$ \u5219\u8f6c\u79fb\u5230\u7684$n$\u5143\u7ec4 $B$\u7684 $|B|$ \u53ef\u4ee5\u5199\u6210 $1+\\frac{x-y+j}{2}2^{k+1}$,\u901a\u8fc7\u521a\u521a\u7684\u8868\u793a\u53ef\u4ee5\u770b\u51fa $B$ \u4e5f\u662f\u5408\u6cd5\u7684\u5f53\u4e14\u4ec5\u5f53 $x-y\\equiv j$(\u3010\u6027\u8d284\u3011\u63a8\u8bba)\n\n\u6545\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u5199\u51fa\u8f6c\u79fb\u4e86\n\n$f_{i,j}\\to f_{i+x+y,\\frac{j+x-y}{2}}(x-y\\equiv j\\mod 2)\\frac{1}{x!y!}$\uff0c\u8fd9\u662f $\\mathcal O(n^4)$ \u7684\n\n\u6ce8\u610f\u7b54\u6848\u662f$n!f_{n,0}$,\u89c2\u5bdf\u6211\u4eec\u83ab\u540d\u52a0\u7684\u7cfb\u6570\u7684\u610f\u601d\u662f\u5176\u5b9e\u6bcf\u4e2a\u4f4d\u7f6e\u662f\u6709\u5e8f\u7684\u4f46$(-1)^k2^j$\u4e2d$k,j$**\u5747**\u76f8\u540c\u65f6\u662f\u4e0d\u5b58\u5728\u987a\u5e8f\u7684\n\n",
        "postTime": 1613647876,
        "uid": 40629,
        "name": "zzw4257",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT3951\u3010[AGC022F] Checkers\u3011"
    },
    {
        "content": "\u5148\u819c\u62dc\u4e00\u4e0b\u7b2c\u4e00\u4e2aA\u6389\u8fd9\u9898\u7684Dra\n\n\u7136\u540e\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u79cd $O(n^4)$ \u7684\u505a\u6cd5\n\n\u9996\u5148\u8fd8\u662f\u8003\u8651\u8fde\u8fb9,\u628a\u6bcf\u6b21\u6d88\u6389\u7684 B \u7684\u7236\u4eb2\u8bbe\u6210 A ,\u90a3\u4e48\u5c31\u4f1a\u53d1\u73b0\u6bcf\u4e00\u4e2a\u70b9\u7684\u8d21\u732e\u5c31\u662f $a_ic_ix_i$ \u5176\u4e2d $a_i=2^d$ ,d\u4e3a\u6df1\u5ea6,$c_i$ \u662f 1 \u6216 -1,\u56e0\u4e3a $x_i$ \u5f88\u5927,\u6240\u4ee5\u4efb\u610f\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8d21\u732e\u53ef\u4ee5\u770b\u505a\u4e0d\u4f1a\u4e92\u76f8\u62b5\u6d88,\u90a3\u4e48\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u4e24\u4e2a\u65b9\u6848\u53ea\u8981\u5b58\u5728\u4e00\u4e2a $i$ \u4f7f\u5f97 $c_i$ \u6216\u8005 $a_i$ \u4e0d\u540c,\u90a3\u4e48\u5c31\u7b97\u505a\u4e0d\u540c\u7684\u65b9\u6848\n\n\u7136\u540e\u53d1\u73b0 $a_i$ \u53ea\u8ddf\u6df1\u5ea6\u6709\u5173,\u90a3\u4e48\u8fd9\u91cc\u5148\u8ba8\u8bba $c_i$,\u6211\u4eec\u53ef\u4ee5\u9ed8\u8ba4\u6839\u8282\u70b9\u7684 $c_i=1$ ,\u90a3\u4e48\u53d1\u73b0\u5bf9\u4e8e\u4e00\u4e2a\u70b9,\u5f71\u54cd $c_i$ \u7684\u6709\u4e24\u79cd\u56e0\u7d20\n\n* \u513f\u5b50\u4e2a\u6570\u7684\u5947\u5076\u6027,\u56e0\u4e3a\u6bcf\u5b58\u5728\u4e00\u4e2a\u513f\u5b50\u90fd\u4f1a\u8ba9\u7236\u4eb2\u7684\u7b26\u53f7\u6539\u53d8\u4e00\u6b21\n* \u7236\u4eb2\u9009\u8fd9\u4e2a\u513f\u5b50\u7684\u65f6\u5019,\u4e4b\u524d\u9009\u4e86\u513f\u5b50\u4e2a\u6570\u7684\u5947\u5076\u6027,\u82e5\u662f\u5947\u6570,\u90a3\u4e48\u513f\u5b50\u5c31\u4f1a\u53d6\u53cd\u4e00\u6b21\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u6839\u636e\u8fd9\u4e2a\u6027\u8d28\u8fdb\u884cdp\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u9009\u4e86 $i$ \u4e2a\u70b9,\u6709 $j$ \u4e2a\u70b9\u7684\u513f\u5b50\u4e2a\u6570\u662f\u5947\u6570\n\n\u90a3\u4e48\u6bcf\u6b21\u5c31\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e2a\u5f53\u524d\u5c42\u6570\u6709 $k$ \u4e2a\u8282\u70b9,\u7136\u540e\u6211\u4eec\u53d1\u73b0\u662f\u5076\u6570\u7684\u513f\u5b50\u4e2a\u6570\u4e3a $\\frac {k-j}{2}$ (\u5982\u679c\u53d1\u73b0 $k-j$ \u7684\u5947\u5076\u6027\u4e0d\u5bf9\u90a3\u5c31\u4e0d\u8f6c\u79fb),\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u4e0d\u8ba1\u7b97\u4e0b\u4e00\u5c42\u7684\u5f71\u54cd\u7684\u8bdd,\u5c06\u4f1a\u6709 $\\frac {k-j}{2}$ \u4e2a\u70b9\u4e0e\u7236\u4eb2\u7684\u7b26\u53f7\u76f8\u540c\n\n\u73b0\u5728\u8003\u8651\u8ba1\u7b97\u4e0b\u4e00\u5c42\u7684\u5f71\u54cd,\u679a\u4e3e\u4e00\u4e2a $x$ \u8868\u793a\u5b9e\u9645\u4e0a\u6709 $x$ \u4e2a\u8282\u70b9\u548c\u7236\u4eb2\u4e0d\u540c,\u90a3\u4e48\u81f3\u5c11\u9700\u8981 $|\\frac {k-j}{2}-x|$ \u4e2a\u5947\u6570\u70b9,\u540c\u65f6\u53d1\u73b0\u5982\u679c\u9009 $|\\frac {k-j}{2}-x|+2k$ \u4e2a\u5947\u6570\u70b9\u7684\u8bdd\u4e5f\u6ee1\u8db3\u8981\u6c42,\u4f46\u662f\u53d1\u73b0\u8fd9\u4e24\u79cd\u65b9\u6848\u5230\u6700\u540e\u662f\u76f8\u540c\u7684,\u56e0\u4e3a\u4e0b\u4e00\u5c42\u4e0d\u8003\u8651\u4e0b\u4e0b\u5c42\u7684\u5f71\u54cd\u7684\u8bdd,\u4e0e\u8fd9\u4e00\u5c42\u7236\u4eb2\u7684\u7b26\u53f7\u76f8\u540c\u7684\u6570\u91cf\u662f\u4e00\u6837\u7684\n\n\u4f8b\u5982\u4e0b\u9762\u8fd9\u79cd\u60c5\u51b5\n![](https://cdn.luogu.com.cn/upload/image_hosting/9nn28bks.png)\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u5411 $f_{i+k}{|\\frac {k-j}{2}-x|}$ \u8f6c\u79fb\u662f\u6b63\u786e\u7684\n\ncode\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int P=1e9+7;\nconst int N=55;\nint n,f[N][N];\nlong long fac[N],inv[N];\nlong long fsp(long long x,int y){\n\tlong long ans=1;\n\twhile(y){\n\t\tif(y&1)\tans=ans*x%P;\n\t\tx=x*x%P,y>>=1;\n\t}\n\treturn ans;\n}\nlong long C(int n,int m){\n\treturn fac[n]*inv[m]%P*inv[n-m]%P;\n}\nint main(){\n\tscanf(\"%d\",&n),fac[0]=inv[0]=1,f[1][1]=f[1][0]=n;\n\tfor(int i=1;i<=n;i++)\tfac[i]=fac[i-1]*i%P;\n\tfor(int i=1;i<=n;i++)\tinv[i]=fsp(fac[i],P-2);\n\tfor(int i=1;i<n;i++)\n\t\tfor(int j=1;j<=n-i;j++)\n\t\t\tfor(int k=0;k<=j;k++){\n\t\t\t\tif((j-k)&1)\tcontinue;\n\t\t\t\tint x=(j-k)/2;\n\t\t\t\tfor(int d=0;d<=j;d++)\n\t\t\t\t\tf[i+j][abs(x-d)]=(f[i+j][abs(x-d)]+f[i][k]*C(n-i,j)%P*C(j,d))%P;\n\t\t\t}\n\tprintf(\"%d\\n\",f[n][0]);\n\treturn 0;\n}\n\n```",
        "postTime": 1582096228,
        "uid": 88567,
        "name": "lzk5627",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT3951 \u3010[AGC022F] Checkers\u3011"
    },
    {
        "content": "\u6839\u636e\u5220\u9664\u64cd\u4f5c\u8fde\u8fb9, \u4e0d\u96be\u770b\u51fa\u6700\u540e\u4f1a\u5f62\u6210\u4e00\u68f5\u6811, \u5bf9\u4e8e\u4e00\u6761\u8fb9\u4e0d\u59a8\u5c06\u7559\u4e0b\u7684\u90a3\u4e2a\u70b9\u4f5c\u4e3a\u7236\u4eb2, \u6839\u4e5f\u5c31\u662f\u6700\u540e\u5269\u4e0b\u7684\u70b9.\n\n\u6211\u4eec\u4f1a\u53d1\u73b0, \u65e0\u8bba\u5927\u5c0f\u5173\u7cfb\u5982\u4f55, \u5047\u8bbe\u6211\u4eec\u662f\u8981\u6c42 $a$ \u5bf9\u4e8e $b$ \u5bf9\u79f0\u540e\u7684\u70b9, \u90a3\u4e48\u603b\u6709 $val_a \\leftarrow 2val_b-val_a$ , \u5176\u4e2d $val_i$ \u8868\u793a\u70b9 $i$ \u5f53\u524d\u7684\u503c.\n\n\u6211\u4eec\u8003\u8651\u76f4\u63a5\u5199\u51fa\u6839\u6700\u540e\u7684\u7ed3\u679c, \u4e00\u5b9a\u4f1a\u662f\u5f62\u5982 $\\sum\\limits_{i=1}^{n}{c_i2^{d_i}x^i}$ \u7684\u5f62\u5f0f, \u5176\u4e2d $c_i$ \u4e3a\u4e00\u4e2a\u7cfb\u6570, \u53d6\u503c\u4e3a $1$ \u6216 $-1$ , $d_i$ \u4e3a\u70b9 $i$ \u5728\u6811\u4e0a\u7684\u6df1\u5ea6.\n\n\u540c\u65f6\u53ef\u4ee5\u53d1\u73b0 $2^n \\ll x$ , \u4e5f\u5c31\u662f\u8bf4, \u5728\u8fd9\u4e2a\u8ba1\u7b97\u5f0f\u4e2d, \u4efb\u610f\u4e24\u4e2a\u70b9\u5bf9\u6700\u7ec8\u7ed3\u679c\u7684\u8d21\u732e\u4e0d\u4f1a\u88ab\u62b5\u6d88, \u6240\u4ee5\u539f\u95ee\u9898\u7b49\u4ef7\u4e8e\u5bf9\u4e8e $n$ \u4e2a\u4e8c\u5143\u7ec4 $(c_i,d_i)$ \u7684\u4e0d\u540c\u65b9\u6848\u7684\u8ba1\u6570.\n\n\u6211\u4eec\u4f1a\u53d1\u73b0, $d_i$ \u7684\u5b9e\u8d28\u662f\u6bcf\u4e2a\u6df1\u5ea6\u6709\u591a\u5c11\u4e2a\u70b9\u800c\u4e0d\u662f\u6811\u7684\u5f62\u6001, \u610f\u601d\u662f\u6211\u4eec\u53ef\u4ee5\u5148\u94a6\u5b9a\u597d\u6811\u7684\u6bcf\u4e2a\u6df1\u5ea6\u6709\u591a\u5c11\u70b9\u540e\u518d\u7528\u591a\u91cd\u7ec4\u5408\u6570\u7684\u5f62\u5f0f\u6765\u786e\u5b9a\u6bcf\u4e2a\u70b9\u4e0a\u653e\u54ea\u4e2a\u503c.\n\n\u63a5\u4e0b\u6765\u518d\u8003\u8651 $c_i$ , \u624b\u73a9\u540e\u4e0d\u96be\u53d1\u73b0\u5f71\u54cd $c_i$ \u7684\u503c\u7684\u56e0\u7d20\u53ea\u6709\u4e24\u4e2a, \u70b9 $i$ \u7684\u513f\u5b50\u7684\u4e2a\u6570\u548c\u6bcf\u4e2a\u7956\u5148\u5728\u9009\u5b8c\u4e0e\u4f7f\u70b9 $i$ \u548c\u8be5\u7956\u5148\u76f8\u8fde\u7684\u94fe\u4e4b\u540e\u518d\u9009\u5219\u5176\u5b83\u513f\u5b50\u7684\u513f\u5b50\u4e2a\u6570, \u4e5f\u5c31\u662f $c_i=(-1)^{\\text{\u513f\u5b50\u4e2a\u6570+\u6bcf\u4e2a\u7956\u5148\u5728\u9009\u5b8c\u4e0e\u5176\u76f8\u8fde\u7684\u94fe\u540e\u7ee7\u7eed\u9009\u7684\u513f\u5b50\u4e2a\u6570}}$ , \u6b64\u5904\u5efa\u8bae\u8bfb\u8005\u81ea\u884c\u753b\u4e00\u4e2a\u6811\u6a21\u62df\u4e00\u4e2a\u70b9\u5728\u6309\u64cd\u4f5c\u987a\u5e8f\u64cd\u4f5c\u540e\u4f1a\u88ab\u54ea\u4e9b\u70b9\u5f71\u54cd.\n\n\u4ee5\u4e0b\u6211\u4eec\u4e3a\u7b80\u4fbf\u76f4\u63a5\u79f0 $c_i$ \u4e3a\u70b9 $i$ \u7684\u6743\u503c, \u7531\u4e8e\u4e00\u4e2a\u70b9\u7684\u6743\u503c\u53ea\u4f1a\u548c\u513f\u5b50\u4e0e\u7956\u5148\u76f8\u5173, \u6240\u4ee5\u5982\u679c\u6211\u4eec\u5728\u6700\u540e\u4e00\u5c42\u52a0\u4e0a\u4e00\u4e2a\u70b9, \u5f71\u54cd\u5230\u7684\u53ea\u4f1a\u662f\u5176\u7236\u4eb2\u4ee5\u53ca\u5176\u5148\u524d\u52a0\u5165\u7684\u5144\u5f1f\u8282\u70b9, \u5bf9\u4e8e\u5176\u4ee5\u540e\u53ef\u80fd\u7684\u513f\u5b50\u5219\u4e0d\u505a\u8003\u8651.\n\n\u6240\u4ee5\u6211\u4eec\u80fd\u53d1\u73b0\u6211\u4eec\u5e76\u4e0d\u5728\u4e4e\u4e00\u4e2a\u70b9\u7684\u6743\u503c\u7a76\u7adf\u662f $1$ \u8fd8\u662f $-1$ , \u53ea\u9700\u8981\u77e5\u9053\u5b83\u7684\u6743\u503c\u662f\u5426\u4e0e\u7236\u4eb2\u76f8\u540c\u5c31\u53ef\u4ee5\u786e\u5b9a\u4e8c\u5143\u7ec4\u4e86.\n\n\u8003\u8651 $dp$ , \u8bbe $f_{i,j}$ \u8868\u793a\u5df2\u7ecf\u8003\u8651\u4e86 $i$ \u4e2a\u70b9\u4e14\u6811\u7684\u6700\u540e\u4e00\u5c42\u6709 $j$ \u4e2a\u70b9\u7684\u513f\u5b50\u6570\u4e3a\u5947\u6570\u7684\u65b9\u6848, \u8fd9\u91cc\u8fd9\u6837\u8bbe\u8ba1\u72b6\u6001\u7684\u539f\u56e0\u662f\u65b9\u4fbf\u786e\u5b9a\u6811\u7684\u5927\u81f4\u5f62\u6001\u800c\u4e0d\u5fc5\u7cbe\u7ec6, \u5373\u65b9\u4fbf\u8ba1\u7b97\u591a\u91cd\u7ec4\u5408\u6570, \u7b97\u662f\u4e00\u4e2a\u5957\u8def, \u8f6c\u79fb\u65b9\u6cd5\u4e5f\u662f\u5957\u8def.\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5982\u679c\u4e00\u4e2a\u70b9\u6709 $x$ \u4e2a\u513f\u5b50, \u90a3\u4e48\u513f\u5b50\u4e2d\u6709 $\\lceil \\frac{x}{2} \\rceil$ \u4e2a\u70b9\u7684\u6743\u503c\u4e0e\u7236\u4eb2\u4e0d\u540c, \u6309\u52a0\u5165\u987a\u5e8f\u7f16\u53f7\u4f1a\u662f\u5947\u6570\u7f16\u53f7\u7684\u70b9.\n\n\u8f6c\u79fb\u65f6\u5c31\u679a\u4e3e\u4e0b\u4e00\u5c42\u7684\u70b9\u6570 $k$ , \u53ef\u4ee5\u63a8\u51fa\u5728\u4e0d\u8003\u8651\u8be5\u5c42\u70b9\u513f\u5b50\u7684\u60c5\u51b5\u4e0b\u6709 $\\lfloor \\frac{j+k}{2} \\rfloor$ \u4e2a\u70b9\u7684\u6743\u503c\u4e0e\u5176\u7236\u4eb2\u4e0d\u540c.\n\n\u4f46\u662f\u663e\u7136\u4e0d\u4e00\u5b9a\u6709\u8fd9\u4e48\u591a\u70b9\u7684\u6743\u503c\u4e0e\u7236\u4eb2\u4e0d\u540c, \u56e0\u4e3a\u6709\u513f\u5b50\u7684\u5f71\u54cd\u8fd8\u6ca1\u7b97\u4e0a, \u6240\u4ee5\u6211\u4eec\u518d\u679a\u4e3e\u7b97\u4e0a\u513f\u5b50\u540e\u548c\u7236\u4eb2\u6743\u503c\u4e0d\u540c\u7684\u70b9\u7684\u4e2a\u6570 $l$ , \u90a3\u4e48\u8fd9\u4e00\u5c42\u5c31\u5e94\u8be5\u6709 $|l-\\lfloor \\frac{j+k}{2} \\rfloor|$ \u4e2a\u70b9\u7684\u513f\u5b50\u6570\u662f\u5947\u6570.\n\n\u6240\u4ee5\u8f6c\u79fb\u5c31\u662f $f_{i+k,|l-\\lfloor \\frac{j+k}{2} \\rfloor|} = f_{j+k,|l-\\lfloor \\frac{j+k}{2} \\rfloor|}+f_{i,j}\\times \\binom{i+k}{i}\\times \\binom{k}{l}$ , $\\binom{i+k}{i}$ \u662f\u591a\u91cd\u7ec4\u5408\u6570\u5e26\u7740\u7b97.\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(n^4)$ .\n\n```cpp\n/************************************************\n*Author        :  demonlover\n*Created Time  :  2022.04.09.13:00\n*Problem       :  AGC22F\n************************************************/\n#include <iostream>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair <int,int> pii;\ntemplate <typename T>\ninline bool read(T &x) {\n\tint f = 1,c = getchar();x = 0;\n\twhile (!isdigit(c)) {if (c == 45)f = -1;c = getchar();}\n\twhile (isdigit(c))x = (x<<3)+(x<<1)+(c^48),c = getchar();\n\treturn x *= f,true;\n}\ntemplate <typename T,typename... Args>\ninline bool read(T &x,Args &...args) {\n\treturn read(x) && read(args...);\n}\n\nnamespace run {\n\tconst int maxn = 1e2+10;\n\tconst int mod = 1e9+7;\n\tinline void add(int &a,int b) {return a = a+b >= mod ? a+b-mod : a+b,void();}\n\tinline int power(int a,int b) {\n\t\tint res = 1;\n\t\twhile (b) {\n\t\t\tif (b&1)res = 1ll*res*a%mod;\n\t\t\ta = 1ll*a*a%mod;\n\t\t\tb >>= 1;\n\t\t}\n\t\treturn res;\n\t}\n\tint fac[maxn],nfac[maxn];\n\tinline int C(int n,int m) {\n\t\tif (n < m)return 0;\n\t\treturn 1ll*fac[n]*nfac[m]%mod*nfac[n-m]%mod;\n\t}\n\tint f[maxn][maxn];\n\tint n;\n\tinline bool main() {\n\t\tread(n);\n\t\tfac[0] = nfac[0] = 1;\n\t\tfor (int i = 1;i <= n;++i)fac[i] = 1ll*fac[i-1]*i%mod;\n\t\tnfac[n] = power(fac[n],mod-2);\n\t\tfor (int i = n-1;i >= 1;--i)nfac[i] = 1ll*nfac[i+1]*(i+1)%mod;\n\t\tf[1][0] = f[1][1] = 1;\n\t\tfor (int i = 1;i < n;++i)\n\t\t\tfor (int j = 0;j <= i;++j)\n\t\t\t\tfor (int k = max(1,j);k <= n-i;++k)\n\t\t\t\t\tif (!((j+k)&1))\n\t\t\t\t\t\tfor (int l = 0;l <= k;++l) {\n\t\t\t\t\t\t\tint tmp = (j+k)>>1;\n\t\t\t\t\t\t\tadd(f[i+k][abs(l-tmp)],1ll*f[i][j]*C(i+k,i)%mod*C(k,l)%mod);\n\t\t\t\t\t\t}\n\t\tprintf(\"%d\\n\",f[n][0]);\n\t\tcerr<<1.0*clock()/CLOCKS_PER_SEC<<\"\\n\";\n\t\treturn 0;\n\t}\n}\n\n#define demonlover\nint main() {\n#ifdef demonlover\n\tfreopen(\"AGC22F.in\",\"r\",stdin);\n\tfreopen(\"AGC22F.out\",\"w\",stdout);\n#endif\n\treturn run :: main();\n}\n```\n",
        "postTime": 1649484299,
        "uid": 152997,
        "name": "demonlover923",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011[AGC022F] Checkers"
    },
    {
        "content": "## \u9898\u610f\uff1a\n\u4ee4 $x=10^{100}$\uff0c \u6570\u8f74\u4e0a\u6709 $n$ \u4e2a\u70b9\uff0c\u7b2c $i$ \u4e2a\u70b9\u7684\u5750\u6807\u4e3a $x_i$\u3002   \n\u8fdb\u884c $n-1$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u9009\u62e9\u4e24\u70b9 $A$ \u548c $B$\uff0c\u5c06 $A$ \u79fb\u52a8\u5230 $A$ \u5173\u4e8e $B$ \u7684\u5bf9\u79f0\u7684\u4f4d\u7f6e\u5e76\u5220\u53bb $B$\u3002  \n\u6c42\u6700\u540e\u5269\u4e0b\u7684\u4e00\u4e2a\u6570\u6709\u591a\u5c11\u79cd\u53ef\u80fd\u7684\u53d6\u503c\u3002  \n$n \\leq 50$\n\n## sol \n\u9996\u5148\u8003\u8651\u4e24\u4e2a\u6570 $A$\uff0c$B$\u3002$A$ \u5173\u4e8e $B$ \u8fdb\u884c\u4e86\u4e00\u6b21\u64cd\u4f5c\uff0c\u90a3\u4e48 $A$ \u65b0\u7684\u5750\u6807\u5c31\u662f $2B-A$\uff0c\u6ce8\u610f\u5230\u6bcf\u4e2a\u70b9\u53ea\u4f1a\u88ab\u4e00\u4e2a\u70b9\u8fdb\u884c\u4e00\u6b21\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f $n-1$ \u4e2a $B$\uff0c\u90a3\u4e48\u5f62\u6210\u4e86\u4e00\u4e2a\u6811\u5f62\u7684\u7ed3\u6784\uff0c$A$ \u5173\u4e8e $B$ \u8fdb\u884c\u64cd\u4f5c\u540e\uff0c\u5c31\u628a $B$ \u8bbe\u4e3a $A$ \u7684\u513f\u5b50\uff0c\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f\u6839\u8282\u70b9\u7684\u5750\u6807\uff0c\u6811\u7ed3\u6784\u786e\u5b9a\u540e\uff0c$x_i$ \u5bf9\u6839\u8282\u70b9\u7684\u8d21\u732e\u5c31\u662f $c_i2^{d_i}x_i$\uff0c\u5176\u4e2d $d_i$ \u662f $i$ \u8282\u70b9\u5728\u6811\u4e2d\u7684\u6df1\u5ea6\uff0c$c_i \\in \\{-1,1\\}$\uff0c$x_i$ \u5f88\u5927\uff0c\u6240\u4ee5\u6bcf\u4e2a\u70b9\u7684\u7cfb\u6570\u4ea7\u751f\u4e00\u70b9\u53d8\u5316\u90fd\u662f\u4e00\u4e2a\u65b0\u65b9\u6848\u3002  \n\n$d_i$ \u7684\u503c\u7531\u6811\u7684\u5c42\u6570\u800c\u5b9a\uff0c\u4e00\u4e2a\u70b9 $i$ \u7684\u7b26\u53f7\u53d8\u5316\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u7b2c\u4e00\u79cd\u662f\u88ab $i$ \u7684\u513f\u5b50\u8282\u70b9\u6539\u53d8\uff0c\u7b2c\u4e8c\u79cd\u662f\u5728\u8d21\u732e\u5230\u7236\u4eb2\u8282\u70b9\u4e0a\u4e4b\u540e\u968f\u7740\u7236\u4eb2\u8282\u70b9\u4e00\u8d77\u6539\u53d8\uff0c\u6ce8\u610f\u5230\u4e00\u4e2a\u70b9\u5728\u4ece\u7236\u4eb2\u7684\u7b26\u53f7\u5f97\u5230\u81ea\u5df1\u7684\u201c\u539f\u7b26\u53f7\u201d\uff0c\u5e76\u4e14\u53ea\u4f1a\u88ab\u81ea\u5df1\u7684\u513f\u5b50\u5f71\u54cd\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u6b21\u5728\u4e00\u68f5\u6811\u7684\u6700\u5e95\u5c42\u518d\u6dfb\u52a0\u4e00\u5c42\u65f6\uff0c\u53ea\u9700\u77e5\u9053\u6700\u540e\u4e00\u5c42\u7684\u4e00\u4e9b\u4fe1\u606f\u5373\u53ef\u3002\u90a3\u6211\u4eec\u8003\u8651\u4ece\u4e0a\u5f80\u4e0b DP\uff0c\u9996\u5148\u5c42\u6570\u662f\u4e0d\u5fc5\u8981\u8bb0\u5f55\u7684\uff0c\u53ea\u9700\u77e5\u9053\u70b9\u7684\u4e2a\u6570\uff0c\u540c\u65f6\u6211\u4eec\u7528\u4e0a\u4e00\u5c42\u7684\u8282\u70b9\u8ba1\u7b97\u51fa\u4e0b\u4e00\u5c42\u8282\u70b9\u7b26\u53f7\u540e\uff0c\u6709\u4e00\u4e9b\u70b9\u7684\u7b26\u53f7\u53ef\u80fd\u4e5f\u4f1a\u88ab\u518d\u6b21\u6539\u53d8\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u518d\u52a0\u4e00\u7ef4\uff0c\u5177\u4f53\u6765\u8bf4\uff1a  \n\n\u8bbe $dp_{i,j}$ \u8868\u793a $i$ \u4e2a\u70b9\u5f62\u6210\u7684\u6811\uff0c\u6700\u4e0b\u9762\u4e00\u5c42\u6709 $j$ \u4e2a\u8282\u70b9\u6709\u5947\u6570\u4e2a\u513f\u5b50\u8282\u70b9\u7684\u65b9\u6848\u6570\u3002\u4e3a\u4ec0\u4e48\u8fd9\u6837\u8bbe\u8ba1\u5462\uff0c\u660e\u786e\u4e00\u4e2a\u4e8b\u5b9e\uff0c\u4e00\u4e2a\u70b9 $i$ \u4f1a\u88ab\u513f\u5b50\u4fee\u6539\u7b26\u53f7\u5f53\u4e14\u4ec5\u5f53\u513f\u5b50\u4e2a\u6570\u662f\u5947\u6570\uff0c\u56e0\u6b64\u9700\u8981\u8fd9\u6837\u8bb0\u5f55\u3002\u540c\u65f6\uff0cDP \u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ea\u8003\u8651\u4e0e\u6bcf\u4e2a\u8282\u70b9\u662f\u5426\u4e0e\u7236\u4eb2\u8282\u70b9\u7b26\u53f7\u76f8\u540c\u3002\u56e0\u4e3a\u5f53\u7236\u4eb2\u8282\u70b9\u7b26\u53f7\u786e\u5b9a\u65f6\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u8282\u70b9\u4e0e\u7236\u4eb2\u7b26\u53f7\u5173\u7cfb\u53d8\u5316\u4e86\uff0c\u5c31\u662f\u4e00\u4e2a\u65b0\u7684\u65b9\u6848\u3002\u53cd\u4e4b\uff0c\u662f\u540c\u4e00\u4e2a\u65b9\u6848\u3002  \n\u8f6c\u79fb\uff1a  \n\u8003\u8651\u5f53\u524d\u72b6\u6001 $dp_{i,j}$\uff0c\u5411\u540e\u8f6c\u79fb\u3002\u679a\u4e3e\u4e0b\u4e00\u5c42\u7684\u8282\u70b9\u6570 $k$\uff0c\u90a3\u4e48\u6211\u4eec\u77e5\u9053\u6709 $j$ \u4e2a\u8282\u70b9\u7b26\u53f7\u786e\u5b9a\u4e0e\u7236\u4eb2\u4e0d\u540c\uff0c\u5269\u4e0b\u7684\u4e00\u534a\u76f8\u540c\uff0c\u4e00\u534a\u4e0d\u540c\u3002\u6211\u4eec\u518d\u679a\u4e3e\u5b9e\u9645\u4e0e\u7236\u4eb2\u76f8\u540c\u7684\u4e2a\u6570 $p$\uff0c\u90a3\u4e48\u4e0b\u4e00\u5c42\u81f3\u5c11\u9700\u8981 $|\\frac{k-j}{2}-p|$ \u4e2a\u6709\u5947\u6570\u4e2a\u513f\u5b50\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u8f6c\u79fb\u5230 $dp_{i+k,|\\frac{k-j}{2}-p|}$ \u53bb\u3002\u4e00\u4e2a\u9519\u8bef\u7684\u60f3\u6cd5\u662f\uff0c\u540c\u65f6\u8f6c\u79fb\u5230 $dp_{i+k,|\\frac{k-j}{2}-p|+2w}$ \u53bb\u3002\u8fd9\u6837\u4f1a\u7b97\u91cd\uff1a\u5728\u679a\u4e3e\u51fa\u8fd9\u5c42\u7684\u70b9\u540e\uff0c$d_i$ \u662f\u56fa\u5b9a\u7684\uff0c\u53ea\u8003\u8651 $c_i$\uff0c\u6211\u4eec\u901a\u8fc7\u786e\u5b9a\u4e0e\u7236\u4eb2\u7b26\u53f7\u76f8\u540c\u7684\u8282\u70b9\u6570\u91cf\u6765\u8ba1\u6570\uff0c\u4f46\u662f\u65e0\u8bba\u662f\u5426\u591a\u52a0\u5076\u6570\u4e2a\u5947\u6570\u513f\u5b50\u8282\u70b9\uff0c\u4e0e\u7236\u4eb2\u8282\u70b9\u7b26\u53f7\u76f8\u540c\u7684\u8282\u70b9\u6570\u91cf\u4e0d\u53d8\uff0c\u59cb\u7ec8\u662f\u540c\u4e00\u79cd\u60c5\u51b5\uff0c\u800c\u4e0b\u4e00\u5c42\u786e\u5b9a\u4e86\u7b26\u53f7\u7684\u70b9\u53cd\u800c\u53d8\u591a\u4e86\uff0c\u6240\u4ee5\u53d6\u6700\u5c0f\u503c\u5f88\u660e\u663e\u5305\u542b\u4e86\u6240\u6709\u7684\u60c5\u51b5\u3002   \n\u65b9\u7a0b\uff1a\n$$\ndp_{i+k,|\\frac{k-j}{2}-p|} \\Leftarrow dp_{i,j} \\times \\dbinom{n-i}{k} \\times \\dbinom{k}{p} \n$$\n\n\u521d\u59cb\u503c\uff1a$dp_{1,0}=n,dp_{1,1}=n$\uff0c\u7b54\u6848\uff1a$dp_{n,0}$\u3002  \n\n\u8fd9\u6837\u505a\u662f $O(n^4)$ \u7684\u3002\u80fd\u4e0d\u80fd\u66f4\u5feb\u5462\uff1f  \n\u7b54\u6848\u662f\u53ef\u4ee5\u7684\uff0c\u53ef\u4ee5\u505a\u5230 $O(n^3)$ \u3002  \n\n\u89c2\u5bdf\u65b9\u7a0b\uff1a  \n$$\ndp_{i+k,|\\frac{k-j}{2}-p|} \\Leftarrow dp_{i,j} \\times \\dbinom{n-i}{k} \\times \\dbinom{k}{p} \n$$\n\u5c06\u4e58\u7684\u7cfb\u6570\u5c55\u5f00\uff1a\n$$\n\\dbinom{n-i}{k} \\times \\dbinom{k}{p} = \\frac{(n-i)!}{k!(n-k)!} \\frac{k!}{p!(k-p)!}=\\frac{(n-i)!}{(n-k)!p!(k-p)!}\n$$\n\u53d1\u73b0\u5305\u542b $k$ \u548c $p$ \u7684\u9879\u7684\u7cfb\u6570\u6709\u4f9d\u8d56\uff0c\u5f88\u70e6\uff0c\u8003\u8651\u6362\u5143\u3002\n$$\nx=p,y=k-p\n$$\n$$\n\\frac{(n-i)!}{(n-k)!p!(k-p)!}=\\frac{(n-i)!}{(n-x-y)!x!y!}\n$$\n\u8003\u8651\u628a $f_{i,j}$ \u4e58\u4ee5 $(n-i)!$\uff1a\n$$\ndp_{i+x+y,|\\frac{-x+y-j}{2}|} \\Leftarrow dp_{i,j} \\times \\frac{1}{x!y!}\n$$\n\u6ce8\u610f\u5230 $x$ \u548c $y$ \u7684\u8f6c\u79fb\u6b64\u65f6\u662f\u6bd4\u8f83\u72ec\u7acb\u7684\uff0c\u8003\u8651\u62c6\u5f00\uff0c\u8bb0\u539f\u6765\u7684 $dp$ \u4e3a $f$\uff0c\u518d\u8bb0\u4e00\u4e2a\u65b0\u7684 $g$\uff1a\n$$\ng_{i+y,y-j} \\Leftarrow f_{i,j} \\times \\frac{1}{y!}\n$$\n$$\nf_{i+x,|\\frac{j-x}{2}|} \\Leftarrow g_{i,j} \\times \\frac{1}{x!}\n$$\n\u8003\u8651\u9650\u5236\u6761\u4ef6\uff1a\n$$\n0<x+y,j \\leq x+y \\Rightarrow 0<x+y,x \\geq j-y\n$$\n$$\n2|(y-j-x)\n$$\n\u552f\u4e00\u56f0\u96be\u7684\u662f $0<x+y$\uff0c$y=0$ \u7684\u60c5\u51b5\u6211\u4eec\u7528\u666e\u901a\u7684 dp \u505a\uff0c\u7136\u540e\u7b97 $g$ \u7684\u65f6\u5019 $y$ \u4ece $1$ \u5f00\u59cb\u679a\u4e3e\uff0c\u7528 $f$ \u7b97 $g$ \u65f6 $x$ \u4ece $0$ \u679a\u4e3e\u3002  \n\u521d\u59cb\u503c\uff1a$dp_{1,0}=n!,dp_{1,1}=n!$\uff0c\u7b54\u6848\uff1a$dp_{n,0}$  \n$O(n^3)$\uff0c\u505a\u5b8c\u4e86~",
        "postTime": 1659157269,
        "uid": 399611,
        "name": "Lisdery",
        "ccfLevel": 0,
        "title": "AGC022F-Checkers \u9898\u89e3"
    },
    {
        "content": "> # \u9898\u76ee\u5927\u610f\n> \u8bbe $x=10^{100}$\uff0c\u5728\u6570\u8f74\u4e0a\u6709 $n$ \u4e2a\u70b9\uff0c\u7b2c $i$ \u4e2a\u70b9\u7684\u5750\u6807\u4e3a $x^i$\uff0c\u6bcf\u6b21\u53ef\u4ee5\u5c06\u4e00\u4e2a\u70b9 $A$ \u53d8\u4e3a\u5173\u4e8e\u70b9 $B$ \u7684\u5bf9\u79f0\u70b9\uff0c\u5e76\u628a $B$ \u5220\u9664\uff0c\u8fdb\u884c $n-1$ \u6b21\u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u95ee\u6700\u540e\u80fd\u5f97\u5230\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u5750\u6807\u3002\n> \n> $n \\le 50$\n\n\u53bb\u770b\u4e86\u5b98\u65b9\u7684\u9898\u89e3\uff0c\u8fd9\u91cc\u7ed9\u51fa\u5b98\u65b9\u7684 $O(n^4)$ \u505a\u6cd5\u548c\u6bd4\u8f83\u5b8c\u6574\u7684\u8bc1\u660e\u3002\n\n# \u601d\u8def\n\n\u9996\u5148\uff0c$x$ \u7279\u522b\u5927\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u628a\u6bcf\u4e2a $x^i$ \u770b\u4f5c\u662f\u4e92\u76f8\u72ec\u7acb\u7684\u3002$A$ \u5173\u4e8e $B$ \u7684\u5bf9\u79f0\u70b9\u5b9e\u9645\u4e0a\u5c31\u662f $2B-A$\u3002\n\n\u9996\u5148\u89c2\u5bdf\u53ef\u4ee5\u53d1\u73b0\uff0c\u5f97\u5230\u7684\u6240\u6709\u6570\u80af\u5b9a\u90fd\u662f\u957f\u6210 $\\sum 2^a(-1)^bx^i$ \u7684\u5f62\u5f0f\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6bd4\u5982\u6700\u540e\u6211\u4eec\u5f97\u5230\u4e86 $2x^1+2x^2+x^3-4x^4$\uff0c\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\u5176\u5b9e\u53ea\u9700\u8981\u628a\u70b9\u7684\u987a\u5e8f\u8c03\u6362\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u53e6\u5916\u4e00\u79cd\u7ed3\u679c\uff0c\u6bd4\u5982 $2x^1+2x^3+x^2-4x^4$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5176\u5b9e\u53ea\u5173\u5fc3\u6700\u540e\u5f97\u5230\u7684**\u7cfb\u6570\u7684\u96c6\u5408**\u3002\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u53ea\u5173\u5fc3\u6700\u540e\u5f97\u5230\u7684\u7cfb\u6570\u96c6\u5408 $\\{1, 2, 2, -4\\}$\u3002\n\n\u6211\u4eec\u5bfb\u627e\u8fd9\u6837\u7684\u7cfb\u6570\u96c6\u5408 $A$ \u90fd\u6709\u4ec0\u4e48\u6027\u8d28\uff1a\n\n1. $\\forall i\\in A,\\, \\exists j,\\, \\rvert i\\lvert=2^j$\uff0c\u5373\u96c6\u5408\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u7edd\u5bf9\u503c\u90fd\u662f $2$ \u7684\u6b21\u5e42\u3002\n\n   \u8bc1\u660e\uff1a\u8003\u8651\u5bf9\u79f0\u7684\u8fc7\u7a0b $2B-A$\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a\u6bcf\u4e2a\u6570\u5c31\u662f\u88ab\u4e58\u4e0a\u4e86\u82e5\u5e72\u4e2a $2$\u3002\n\n2. $\\sum_{i\\in A}i=1$\uff0c\u5373\u96c6\u5408\u4e2d\u5143\u7d20\u7684\u548c\u4e3a $1$\u3002\n\n   \u8bc1\u660e\uff1a\u8003\u8651\u5f52\u7eb3\u6cd5\u8bc1\u660e\u3002\n\n   \u9996\u5148\u521d\u59cb\u503c $\\{1\\}$ \u7684\u548c\u4e3a $1$\u3002\n\n   \u82e5 $A,B$ \u96c6\u5408\u5747\u6ee1\u8db3\u4ee5\u4e0a\u6761\u4ef6\uff0c\u90a3\u4e48\u65b0\u5f97\u5230\u7684\u96c6\u5408 $2B-A$ \u7684\u548c\u4e3a $2 \\times 1 - 1 = 1$\uff0c\u5f97\u8bc1\u3002\n\n3. \u82e5 $2^i$ \u6216 $-2^i$ \u5c5e\u4e8e $A$\uff0c\u90a3\u4e48 $2^{i-1}$ \u6216 $-2^{i-1}$ \u4e5f\u5c5e\u4e8e $A$\u3002\n\n   \u8bc1\u660e\uff1a\u540c\u6837\u5f52\u7eb3\u6cd5\u8bc1\u660e\uff0c\u5982\u679c $A$ \u5305\u542b\u7684\u6307\u6570\u8303\u56f4\u4e3a $[0,a]$\uff0c $B$ \u5305\u542b\u7684\u6307\u6570\u8303\u56f4\u4e3a $[0,b]$\uff0c\u90a3\u4e48\u6613\u8bc1 $2B-A$ \u5305\u542b\u7684\u6307\u6570\u8303\u56f4\u4e3a $[0,\\max(a,b+1)]$\u3002\n\n4. $2^0$ \u548c $-2^0$ \u4e2d\u6709\u4e00\u4e2a\u4e14\u4ec5\u6709\u4e00\u4e2a\u5c5e\u4e8e $A$\u3002\n\n   \u8bc1\u660e\uff1a\u5f52\u7eb3\u6cd5\uff0c\u9996\u5148 $2^0,-2^0$ \u90fd\u4e0d\u5c5e\u4e8e $2B$\uff0c\u800c $A$ \u4e2d\u6709 $2^0,-2^0$ \u4e2d\u7684\u5176\u4e2d\u4e00\u4e2a\uff0c\u6240\u4ee5 $2B-A$ \u4e2d\u6709\u4e14\u4ec5\u6709 $2^0,-2^0$ \u4e2d\u7684\u4e00\u4e2a\u3002\n\n\u4f46\u662f\u8fd9\u4e9b\u6027\u8d28\u90fd\u8fd8\u53ea\u662f\u5fc5\u8981\u6761\u4ef6\uff0c\u5e76\u4e0d\u5145\u5206\u3002\u6211\u4eec\u6709\u4e00\u4e2a\u5145\u8981\u6761\u4ef6\u5982\u4e0b\uff1a\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i>1$\uff0c\u5b58\u5728\u4e00\u79cd\u5c06 $A$ \u4e2d\u7684\u6240\u6709 $\\pm 2^i$ \u5143\u7d20\u524d\u7684\u6b63\u8d1f\u53f7\u8fdb\u884c\u4fee\u6539\u7684\u65b9\u6848\uff0c\u4f7f\u5f97 $\\sum_{\\rvert x\\lvert=2^j,j\\in[0,i]}x=1$\uff08\u5373\u6240\u6709\u6307\u6570\u5c0f\u4e8e\u7b49\u4e8e $i$ \u7684\u6570\u7684\u548c\u4e3a $1$\uff09\n\n\u8bc1\u660e\uff1a\n\n1. \u5fc5\u8981\u6027\uff1a\n\n   \u5f52\u7eb3\u6cd5\u3002\n\n   \u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i>1$\uff0c\u5c06 $B$ \u96c6\u5408\u4e2d\u7684 $2^{i-1}$ \u5143\u7d20\u91cd\u6807\u6b63\u8d1f\u53f7\u540e\uff0c\u5f97\u5230\u6307\u6570\u8303\u56f4\u5728 $[0,i-1]$ \u5185\u7684\u6570\u7684\u548c\u4e3a $1$\uff0c\u5e76\u5c06 $A$ \u96c6\u5408\u4e2d\u7684 $2^i$ \u5143\u7d20\u91cd\u6807\u6b63\u8d1f\u53f7\u540e\uff0c\u5f97\u5230\u6307\u6570\u8303\u56f4\u5728 $[0,i]$ \u5185\u7684\u6570\u7684\u548c\u4e3a $1$\u3002\n\n   \u90a3\u4e48 $2B$ \u7684\u6307\u6570\u8303\u56f4\u5c31\u662f $[1,i]$\uff0c\u4e14 $2^i$ \u7684\u6b63\u8d1f\u53f7\u88ab\u91cd\u6807\uff0c\u90a3\u4e48 $2B-A$ \u5c31\u4e5f\u7b26\u5408\u4e0a\u8ff0\u6027\u8d28\u3002\n\n   \u5bf9\u4e8e $i=1$\uff0c\u6839\u636e\u6027\u8d28 $4$\uff0c\u4e00\u5b9a\u53ef\u4ee5\u8fdb\u884c\u91cd\u6807\u6b63\u8d1f\u53f7\u4f7f\u5f97\u548c\u4e3a $1$\u3002\n\n2. \u5145\u5206\u6027\uff1a\n\n   \u6211\u4eec\u60f3\u529e\u6cd5\u6784\u9020\u51fa\u4e00\u79cd\u65b9\u6848\uff0c\u4f7f\u5f97 $C$ \u96c6\u5408\u80fd\u591f\u88ab\u5206\u4e3a $2B-A$\uff0c\u5e76\u4e14 $A,B,C$ \u96c6\u5408\u5747\u6ee1\u8db3\u4ee5\u4e0a\u7684\u6240\u6709\u6027\u8d28\uff0c\u5373\u53ef\u8bc1\u660e\u5145\u5206\u6027\u3002\n\n   ------------\n\n   \u9996\u5148\u5047\u8bbe $-2^0 \\in C$\u3002\n\n   \u8bbe $k$ \u4e3a\u6700\u5c0f\u7684\u6b63\u6574\u6570\u4f7f\u5f97 $2^k\\in C$\u3002\u5982\u679c\u5bf9\u4e8e\u6307\u6570\u8303\u56f4\u5728 $[1,k-1]$ \u5185\u7684\u6240\u6709\u6570\u90fd\u51fa\u73b0\u4e86\u5927\u4e8e\u7b49\u4e8e\u4e24\u6b21\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020 $B=\\{-2^0,-2^1,\\cdots,-2^{k-2},2^{k-1}\\}$\uff0c\u8fd9\u6837 $2B=\\{-2^1,-2^2,\\cdots,-2^{k-1},2^k\\}$\uff0c\u6211\u4eec\u4ece $C$ \u96c6\u5408\u4e2d\u5228\u9664\u6389\u8fd9\u4e9b\u5143\u7d20\uff0c\u518d\u5c06\u5143\u7d20\u53d6\u53cd\uff0c\u5c31\u5f97\u5230\u4e86 $A$ \u96c6\u5408\u3002\n\n   \u9996\u5148\u53ef\u4ee5\u53d1\u73b0 $B$ \u96c6\u5408\u6ee1\u8db3\u4ee5\u4e0a\u7684\u6240\u6709\u6027\u8d28\uff0c\u5e76\u4e14 $A$ \u96c6\u5408\u6ee1\u8db3\u4ee5\u4e0a\u7684 $4$ \u6761\u57fa\u672c\u6027\u8d28\u3002\n\n   --------------\n\n   \u4e0b\u9762\u662f $A$ \u96c6\u5408\u6ee1\u8db3\u6027\u8d28 $5$ \u7684\u8bc1\u660e\uff1a\n\n   \u9996\u5148\u5bf9\u4e8e\u6240\u6709\u7684 $i\\le k$\uff0c$C$ \u96c6\u5408\u4e2d\u7684 $\\pm2^i$ \u5728\u91cd\u6807\u6b63\u8d1f\u53f7\u540e\uff0c$2^i$ \u7684\u4e2a\u6570\u4e00\u5b9a\u5927\u4e8e $-2^i$ \u7684\u4e2a\u6570\uff0c\u5426\u5219\u548c $<0$\uff0c\u4e0d\u6ee1\u8db3\u6027\u8d28 $5$\u3002\n\n   \u90a3\u4e48\u5728\u91cd\u6807\u6b63\u8d1f\u53f7\u7684\u7ed3\u679c\u4e2d\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a $2^i$\u3002\u6211\u4eec\u5c06\u8fd9\u4e2a $2^i$ \u5206\u914d\u7ed9 $B$ \u96c6\u5408\uff0c\u5c06\u5269\u4e0b\u7684\u5206\u914d\u7ed9 $A$ \u96c6\u5408\uff0c\u90a3\u4e48\u53ef\u4ee5\u8bc1\u660e $i\\le k$ \u7684\u65f6\u5019\u6027\u8d28 $5$ \u662f\u6210\u7acb\u7684\u3002\n\n   \u5bf9\u4e8e $i > k$\uff0c$C$ \u96c6\u5408\u91cd\u6807\u6b63\u8d1f\u53f7\u7684\u7ed3\u679c\u90fd\u5206\u914d\u7ed9\u4e86 $A$\uff0c\u56e0\u4e3a $C$ \u96c6\u5408\u7684\u548c\u4e3a $1$\uff0c$B$ \u96c6\u5408\u7684\u548c\u4e5f\u4e3a $1$\uff0c\u90a3\u4e48 $A$ \u96c6\u5408\u7684\u548c\u80af\u5b9a\u4e5f\u4e3a $2\\times 1 - 1 = 1$\uff0c\u6240\u4ee5\u4e5f\u662f\u6210\u7acb\u7684\u3002\n\n   \u7efc\u4e0a\uff0c\u8fd9\u6837\u6784\u9020\u51fa\u6765\u7684 $A$ \u96c6\u5408\u662f\u6ee1\u8db3\u6027\u8d28 $5$ \u7684\u3002\n\n   -------------\n\n   \u5982\u679c\u5bf9\u4e8e\u6307\u6570\u8303\u56f4\u5728 $[1,k-1]$ \u5185\uff0c\u5b58\u5728\u4e00\u4e2a\u6570\u53ea\u51fa\u73b0\u4e86\u4e00\u6b21\uff0c\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\u518d\u6309\u7167\u4e0a\u9762\u7684\u65b9\u5f0f\u5206\u914d\uff0c\u4f1a\u5bfc\u81f4\u5f97\u5230\u7684 $A$ \u96c6\u5408\u4e0d\u6ee1\u8db3\u6027\u8d28 $3$\u3002\n\n   \u90a3\u4e48\u6211\u4eec\u8bb0\u6700\u5c0f\u7684\u53ea\u51fa\u73b0\u4e86\u4e00\u6b21\u7684\u6307\u6570\u4e3a $j$\u3002\u5982\u679c $j=1$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ee4 $A=\\{2^0\\}$\uff0c\u5e76\u4e14 $B$ \u4e3a\u5269\u4e0b\u7684\u6570\u9664\u4ee5 $2$\u3002\u5bf9\u4e8e $C$ \u7684\u6bcf\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u5c06\u5b83\u51cf\u53bb\u7b2c\u4e00\u4e2a\u5143\u7d20 $-2^0$ \u518d\u9664\u4ee5 $2$ \u4e5f\u7b49\u4e8e $1$\uff0c\u6240\u4ee5 $B$ \u96c6\u5408\u4e5f\u662f\u7b26\u5408\u6027\u8d28 $5$ \u7684\u3002\n\n   \u5982\u679c $j>1$\uff0c\u90a3\u4e48\u6307\u6570\u8303\u56f4\u5728 $[0,j-1]$ \u5185\u7684\u6570\u7684\u548c\u7684\u6700\u5927\u503c\u5e94\u8be5\u4e3a $-2^0+2(-2^1-2^2-\\cdots -2^{j-1})=-2^{j+1}+3$\uff0c\u53d1\u73b0\u8fd9\u4e2a\u6570\u6c38\u8fdc\u5c0f\u4e8e $-2^j$\uff0c\u90a3\u4e48\u65e0\u8bba\u5982\u4f55\u4fee\u6539 $2^j$ \u524d\u9762\u7684\u6b63\u8d1f\u53f7\u90fd\u65e0\u6cd5\u4f7f\u5f97\u524d\u7f00\u548c\u7b49\u4e8e $1$\uff0c\u6240\u4ee5\u662f\u4e0d\u5b58\u5728 $j>1$ \u7684\u60c5\u51b5\u7684\u3002\n\n\u4e8e\u662f\u6211\u4eec\u8bc1\u660e\u4e86\u6027\u8d28 $5$ \u662f\u4e00\u4e2a\u5145\u8981\u6761\u4ef6\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7edf\u8ba1\u6ee1\u8db3\u4ee5\u4e0a\u4e94\u4e2a\u6761\u4ef6\u7684\u96c6\u5408\u6570\u6709\u591a\u5c11\u79cd\u5373\u53ef\u3002\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u5df2\u7ecf\u653e\u4e86 $i$ \u4e2a\u5143\u7d20\uff0c\u5e76\u4e14\u8fd9\u4e9b\u5143\u7d20\u7684\u548c\u4e3a $1+jV$\uff0c\u5176\u4e2d $V$ \u4e3a\u73b0\u5728\u8981\u653e\u7684 $2$ \u7684\u6b21\u5e42\u662f\u591a\u5c11\u3002\n\n\u90a3\u4e48\u6211\u4eec\u679a\u4e3e\u9009\u4e86 $a$ \u4e2a $V$\uff0c\u9009\u4e86 $b$ \u4e2a $-V$\uff0c\u90a3\u4e48\u5143\u7d20\u7684\u548c\u5c31\u53d8\u4e3a\u4e86 $1+(j+a-b)V$\u3002\u56e0\u4e3a\u4e0b\u4e00\u4e2a\u586b\u7684\u6570\u5c31\u8981\u6bd4\u73b0\u5728\u7684\u6570\u4e58 $2$\uff0c\u6240\u4ee5 $f_{i,j}$ \u8f6c\u79fb\u5230 $f_{i+a+b,\\frac{j+a-b}{2}}$\u3002\n\n\u6211\u4eec\u9700\u8981\u6ee1\u8db3\u5c06\u8fd9\u4e9b\u6570\u4efb\u610f\u6807\u6b63\u8d1f\u53f7\u4e4b\u540e\uff0c\u548c\u4e3a $1$\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u6ee1\u8db3 $j \\equiv a+b \\pmod 2$ \u4e14 $a+b\\ge \\rvert j\\lvert$ \u5373\u53ef\u3002\n\n\u7136\u540e\u8003\u8651\u5bf9\u8fd9\u4e2a\u7cfb\u6570\u96c6\u5408\u5206\u914d\u539f\u6765\u7684 $x^i$\uff0c\u8fd9\u4e2a\u5c31\u662f\u591a\u91cd\u7ec4\u5408\u6570\u7684\u5f62\u5f0f\uff08$\\frac{n!}{\\prod a!}$\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u628a $\\frac{1}{\\prod a!}$ \u7684\u90e8\u5206\u62c6\u5230\u8f6c\u79fb\u4e0a\uff0c\u4e5f\u5c31\u662f $f_{i,j} \\times \\frac{1}{a!b!}\\rightarrow f_{i+a+b,\\frac{j+a-b}{2}}$\u3002\n\n\u521d\u59cb\u72b6\u6001\u4e3a $f_{0,-1}=1$\uff0c\u7b54\u6848\u4e3a $n!f_{n,0}$\u3002\n\n\u9700\u8981\u6ce8\u610f\uff0c\u4e3a\u4e86\u6ee1\u8db3\u6027\u8d28 $4$\uff0c\u9700\u8981\u7279\u6b8a\u5224\u65ad\u4e00\u4e0b\uff0c\u5f53 $i=0$ \u65f6\uff0c\u5fc5\u987b\u6ee1\u8db3 $a+b=1$ \u65f6\u624d\u53ef\u4ee5\u8f6c\u79fb\u3002\n\n# Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 55, P = 1000000007;\nint f[MAXN][MAXN << 1];\nint n;\nint fac[MAXN], inv[MAXN];\nint qpow(int a, int b) {\n    int ans = 1;\n    while (b) {\n        if (b & 1) ans = 1ll * ans * a % P;\n        a = 1ll * a * a % P;\n        b >>= 1;\n    }\n    return ans;\n}\nint main() {\n    scanf(\"%d\", &n);\n    f[0][MAXN + -1] = 1;\n    fac[0] = 1;\n    for (int i = 1; i <= n; i++) fac[i] = 1ll * fac[i - 1] * i % P;\n    inv[n] = qpow(fac[n], P - 2);\n    for (int i = n; i >= 1; i--) inv[i - 1] = 1ll * inv[i] * i % P;\n    for (int i = 0; i < n; i++) {\n        for (int j = -n; j <= n; j++) if (f[i][j + MAXN]) {\n            for (int a = 0; a <= n; a++) {\n                for (int b = 0; i + a + b <= n; b++) if ((a || b) && ((j + a + b) % 2 == 0) && a + b >= abs(j)) {\n                    if (i == 0 && a + b != 1) continue;\n                    f[i + a + b][(j + a - b) / 2 + MAXN] = (f[i + a + b][(j + a - b) / 2 + MAXN]\n                         + 1ll * f[i][j + MAXN] * inv[a] % P * inv[b]) % P;\n                }\n            }\n        }\n    }\n    printf(\"%lld\\n\", 1ll * f[n][MAXN + 0] * fac[n] % P);\n    return 0;\n}\n```\n\n",
        "postTime": 1662784033,
        "uid": 279652,
        "name": "APJifengc",
        "ccfLevel": 9,
        "title": "\u300c\u89e3\u9898\u62a5\u544a\u300d[AGC022F] Checkers"
    }
]
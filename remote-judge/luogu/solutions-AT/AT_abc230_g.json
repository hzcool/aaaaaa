[
    {
        "content": "\u9898\u76ee\u53ef\u4ee5\u8f6c\u5316\u6210\u6240\u6709 $\\gcd(p_i,p_j) \\ne 1$ \u7684\u5bf9\u6570\u51cf\u53bb $\\gcd(i,j) = 1$ \u4e14 $\\gcd(p_i,p_j) \\ne 1$ \u7684\u5bf9\u6570\u3002\n\n\u53ef\u4ee5\u8003\u8651\u5916\u9762\u5957\u4e00\u5c42\u5bb9\u65a5\uff0c\u679a\u4e3e $d$\uff0c\u8ba1\u7b97\u4e0b\u6807\u4e3a $d$ \u7684\u500d\u6570\u7684\u6570\u4e2d\u6ee1\u8db3 $\\gcd(p_i,p_j) \\ne 1$ \u7684 $(i,j)$ \u6709\u591a\u5c11\u5bf9\u3002\u5c31\u662f\u5148\u7b97\u51fa $d|\\gcd(i,j)$ \u7684\u7b54\u6848\uff0c\u6700\u540e\u5bb9\u65a5\u5f97\u51fa $d = \\gcd(i,j)$ \u7684\u7b54\u6848\u3002\n\n\u73b0\u5728\u8003\u8651\u5b50\u95ee\u9898\uff1a\u7ed9\u5b9a\u4e00\u4e9b\u6570\uff0c\u6c42 $\\gcd(a_i,a_j) \\ne 1$ \u7684 $(i,j)$ \u5bf9\u6570\u3002\u53ef\u4ee5\u7528\u603b\u5bf9\u6570\u51cf\u53bb $\\gcd(a_i,a_j) = 1$ \u7684\u5bf9\u6570\u3002\n\n\u8bb0 $c_x$ \u4e3a $x$ \u5728 $a$ \u4e2d\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u7136\u540e\u63a8\u5f0f\u5b50\uff1a\n\n$$\\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^n [\\gcd(a_i,a_j)=1]$$\n\n$$= \\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^n c_i c_j [\\gcd(i,j)=1]$$\n\n$$= \\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^n c_i c_j \\sum\\limits_{p|i,p|j} \\mu(p)$$\n\n$$= \\sum\\limits_{p=1}^n \\mu(p) \\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{p}\\right\\rfloor}c_{ip} \\sum\\limits_{j=1}^{\\left\\lfloor\\frac{n}{p}\\right\\rfloor}c_{jp}$$\n\n$$= \\sum\\limits_{p=1}^n \\mu(p) ( \\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{p}\\right\\rfloor} c_{ip} )^2$$\n\n\u8003\u8651\u6bcf\u52a0\u8fdb\u6765\u4e00\u4e2a\u6570 $x$\uff0c\u7b54\u6848\u7684\u53d8\u5316\u91cf\u3002\u5bf9\u4e8e\u6bcf\u4e2a $k|x$\uff0c\u8bb0 $b_k$ \u8868\u793a\u5df2\u7ecf\u52a0\u8fdb\u6765\u7684\u6570\u4e2d $k$ \u7684\u500d\u6570\u7684\u6570\u91cf\uff0c\u7b54\u6848\u65b0\u589e $\\mu(k) \\times [(b_k + 1)^2 - b_k^2] = \\mu(k) \\times (2b_k + 1)$\u3002\u9884\u5904\u7406\u51fa\u56e0\u6570\uff0c\u52a8\u6001\u7ef4\u62a4\u7b54\u6848\u5373\u53ef\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u7ea6\u662f $O(n \\log n \\max\\limits_{i=1}^n d(i))$\uff0c\u5176\u4e2d $d(i)$ \u4e3a $i$ \u7684\u56e0\u6570\u4e2a\u6570\u3002\n\n[code](https://atcoder.jp/contests/abc230/submissions/36476089)\n\n\u540c\u7c7b\u9898\u76ee\uff1a[CF1575G GCD Festival](https://www.luogu.com.cn/problem/CF1575G)",
        "postTime": 1668342235,
        "uid": 275273,
        "name": "zltqwq",
        "ccfLevel": 0,
        "title": "ABC230G \u9898\u89e3"
    },
    {
        "content": "[My blog](https://www.cnblogs.com/Feyn/p/16977678.html)\n\n\u5916\u9762\u5148\u5957\u4e00\u5c42\u5bb9\u65a5\uff0c\u7136\u540e\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u6709\u4e00\u4e9b\u6570\uff0c\u6c42\u4e0d\u4e92\u8d28\u7684\u6570\u5bf9\u7684\u6570\u91cf\u3002\u6b63\u96be\u5219\u53cd\uff0c\u8003\u8651\u6c42\u4e92\u8d28\u7684\u6570\u91cf\u3002\u8bb0\u6bcf\u4e2a\u6570\u7684\u6570\u91cf\uff08\u4e5f\u5c31\u662f\u662f\u5426\u51fa\u73b0\u8fc7\uff09\u4e3a $c$\uff0c\u90a3\u4e48\u6709\uff1a\n\n$$\n\\begin{aligned}\n\\text{ans}=&\\sum\\limits_{i=1}\\sum\\limits_{j=1}\\varepsilon(\\gcd(i,j))c_ic_j\\\\\n=&\\sum\\limits_{i,j}c_ic_j\\sum\\limits_{t|i,t|j}\\mu(t)\\\\\n=&\\sum\\limits_{t}\\mu(t)\\sum\\limits_{t|i,t|j}c_ic_j\\\\\n=&\\sum\\limits_{t}\\mu(t)(\\sum\\limits_{t|i}c_i)^2\n\\end{aligned}\n$$\n\n\u8003\u8651\u5bf9\u6bcf\u4e2a $t$ \u6c42\u8d21\u732e\uff0c\u90a3\u4e48\u6bcf\u4e2a\u65b0\u52a0\u5165\u7684\u6570\u76f4\u63a5\u66b4\u529b\u904d\u5386\u6240\u6709\u7684\u56e0\u6570\u66f4\u65b0\u5373\u53ef\u3002\u7406\u8bba\u590d\u6742\u5ea6\u4f3c\u4e4e\u9ad8\u4e8e $O(n\\log^2n)$\uff0c\u4f46\u5bb9\u6613\u60f3\u5230\u526a\u679d\u53ef\u4ee5\u526a\u53bb\u5f88\u591a\u65e0\u7528\u8ba1\u7b97\uff0c\u4e8e\u662f\u5c31\u53ef\u4ee5\u901a\u8fc7\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n//#define feyn\n#define int long long\nusing namespace std;\nconst int N=200010;\ninline void read(int &wh){\n    wh=0;int f=1;char w=getchar();\n    while(w<'0'||w>'9'){if(w=='-')f=-1;w=getchar();}\n    while(w<='9'&&w>='0'){wh=wh*10+w-'0';w=getchar();}\n    wh*=f;return;\n}\n\nint m,a[N];\n\nint mu[N],p[N>>2],cnt;\nbool vis[N];\nvoid init(){\n\tmu[1]=1;\n\tfor(int i=2;i<=m;i++){\n\t\tif(vis[i]==false)p[++cnt]=i,mu[i]=-1;\n\t\tfor(int j=1;p[j]*i<=m;j++){\n\t\t\tvis[i*p[j]]=true;\n\t\t\tif(i%p[j]==0)break;\n\t\t\tmu[i*p[j]]=-mu[i];\n\t\t}\n\t}\n}\n\nvector<int>d[N];\n\nint an,nt,num[N],ti[N];\ninline void add(int val){\n\tfor(int now:d[val]){\n\t\tif(ti[now]^nt)ti[now]=nt,num[now]=0;\n\t\tan-=num[now]*num[now]*mu[now];\n\t\tnum[now]++;\n\t\tan+=num[now]*num[now]*mu[now];\n\t}\n\tif(val==1)an--;\n}\nint solve(int wh){\n\t++nt,an=0;\n\tfor(int i=wh;i<=m;i+=wh)add(a[i]);\n\tint Num=(m/wh)*(m/wh-1);\n\treturn (Num-an)/2;\n}\n\nsigned main(){\n\t\n\t#ifdef feyn\n\tfreopen(\"in.txt\",\"r\",stdin);\n\t#endif\n\t\n\tread(m);\n\tfor(int i=1;i<=m;i++)read(a[i]);\n\tinit();\n\tfor(int i=1;i<=m;i++){\n\t\tif(mu[i]==0)continue;\n\t\tfor(int j=i;j<=m;j+=i)d[j].push_back(i);\n\t}\n\tint ans=0;\n\tfor(int i=2;i<=m;i++){\n\t\tif(mu[i]==0)continue;\n\t\tans-=mu[i]*solve(i);\n\t}\n\t--ans;\n\tfor(int i=2;i<=m;i++)ans-=a[i]==1;\n\tprintf(\"%lld\\n\",ans+m);\n\t\n\treturn 0;\n}\n```",
        "postTime": 1680753583,
        "uid": 302383,
        "name": "Feyn",
        "ccfLevel": 0,
        "title": "AT_abc230_g"
    },
    {
        "content": "\u8bb2\u79cd\u5f88\u66b4\u529b\u7684\u505a\u6cd5\u5427\u3002\n\n## \u601d\u8def\n\n\u9996\u5148\u6211\u4eec\u5148\u8003\u8651\u94a6\u5b9a $x|\\gcd(i,j)$\uff0c\u4ee4 $f(x)$ \u4e3a\u6ee1\u8db3 $x|\\gcd(i,j),\\gcd(a_i,a_j)\\not=1$ \u7684\u65b9\u6848\u6570\uff0c\u6700\u540e\u505a\u4e00\u4e2a Dirichlet \u5dee\u5206\u3002\n\n\u8003\u8651\u600e\u4e48\u8ba1\u7b97 $f(x)$\uff0c\u91cd\u65b0\u94a6\u5b9a $g(x,y)=x|\\gcd(i,j),y=\\gcd(a_i,a_j)$ \u7684 $(i,j)$ \u6570\u91cf\u3002\u6211\u4eec\u53ef\u4ee5\u5148\u5bf9\u6bcf\u4e2a $a_i,x|i$ \u6254\u5230\u6876\u4e2d\uff0c\u505a\u4e00\u904d Dirichlet \u524d\u7f00\u548c\uff0c\u5f97\u5230 $h(x,y)$\uff0c\u4ee4 $h(x,y)=\\dfrac{h(x,y)\\times (h(x,y)-1)}{2}$\uff0c\u6b64\u65f6 $h(x,y)$ \u662f $g(x,y)=x|\\gcd(i,j),y|\\gcd(a_i,a_j)$ \u7684 $(i,j)$ \u6570\u91cf\uff0c\u7136\u540e\u505a\u4e00\u904d\u5dee\u5206\u5373\u53ef\u5f97\u5230 $g(x,y)$\uff0c\u610f\u4e49\u662f\u5148\u8003\u8651\u6240\u6709\u6ee1\u8db3 $x|i,y|a_i$ \u7684 $i$ \u4f4d\u7f6e\uff0c\u4ece\u6ee1\u8db3\u8981\u6c42\u7684\u6570\u4e2d\u4efb\u610f\u9009\u62e9\u4e24\u4e2a\u7136\u540e\u505a\u4e00\u904d\u5dee\u5206\u5f97\u5230\u3002\n\n\u6b64\u65f6 $f(x)=\\lfloor\\frac{n}{x}\\rfloor\\times(\\lfloor\\frac{n}{x}\\rfloor-1)-g(x,1)$\u3002\n\n\u8003\u8651\u590d\u6742\u5ea6\uff0c\u76f4\u63a5\u505a\u662f $O(n^2)$ \u7684\uff0c\u663e\u7136\u4e0d\u53ef\u8fc7\uff0c\u5bb9\u6613\u53d1\u73b0\u5b9e\u8d28\u4e0a\u6211\u4eec\u8981\u6254\u5230\u6876\u4e2d\u6570\u7684\u6570\u91cf\u662f $O(n\\ln n)$\uff08\u8c03\u548c\u7ea7\u6570\uff09\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u6839\u53f7\u5206\u6cbb\uff0c\u5bf9\u4e8e $x\\leq \\sqrt{n\\ln n}$ \u8fdb\u884c\u524d\u7f00\u548c/\u5dee\u5206\uff0c\u5927\u4e8e\u7b49\u4e8e\u7684\u76f4\u63a5\u66b4\u529b\u5373\u53ef\u3002\u590d\u6742\u5ea6\u662f\u5927\u7ea6 $O(n\\ln n\\log n+n\\log\\log n\\times\\sqrt{n\\ln n})$\uff0c\u540e\u8005\u663e\u7136\u5df2\u7ecf\u7206\u70b8\uff0c\u4e8e\u662f\u6211\u4eec\u4e0d\u80fd\u628a\u754c\u9650\u5b9a\u5728 $\\sqrt{n\\ln n}$\uff0c\u6211\u662f\u5b9a\u7684 $500$\uff0c\u6b64\u65f6\u524d\u8005\u4f1a\u6bd4\u8f83\u6162\uff0c$\\gcd$ \u51fd\u6570\u6709\u4e00\u5b9a\u5e38\u6570\uff0c\u9700\u8981\u5361\u5e38\uff0c\u6211\u7528\u7684\u505a\u6cd5\u662f\u5224\u65ad\u662f\u5426 $2|a_i,2|a_j$\uff0c$3|a_i,3|a_j$\uff0c$5|a_i,5|a_j$\uff0c\u90fd\u4e0d\u6ee1\u8db3\u518d\u7528 $\\gcd$\u3002\n\n\u6700\u7ec8\u590d\u6742\u5ea6 $O(n\\ln^2 n+n\\log\\log n\\times \\sqrt{n})$\uff0c\u5176\u4e2d\u524d\u8005\u6709\u4e00\u5b9a\u5e38\u6570\uff08\u9700\u8981 $\\gcd$ \u7684\u7ec4\uff09\uff0c\u540e\u8005\u53ef\u4ee5\u901a\u8fc7 $\\max{a_i}$ \u6765\u51cf\u5c0f\u5e38\u6570\u3002\u5b9e\u9645\u5faa\u73af\u6b21\u6570\u5927\u7ea6 $4\\times 10^8$\u3002\n\n\u819c\u62dc $\\texttt{\\color{black}z\\color{red}ltqwq}$ \u5feb\u901f\u89e3\u6cd5\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#pragma GCC optimize(2)\n#define int long long\n#define double long double\n#define mid ((L+R)>>1)\nusing namespace std;\nint prm[200005],tot;\nbool isp[200005];\nconst int mod=998244353;\nint f[200005],g[200005];\nint read(){\n\tchar c; int ans=0; int z=1;\n\twhile(!isdigit(c=getchar()))z-=2*(c=='-');\n\tdo{ans=(ans*10+c-'0');}while(isdigit(c=getchar()));\n\treturn ans*z;\n}\nvoid print(int x){\n\tif(x<0) putchar('-');\n\tif(llabs(x)>=10) print(llabs(x)/10);\n\tputchar((llabs(x)%10)+'0');\n}\nint ok2[200005],ok3[200005],ok5[200005];\nsigned main(){\n\tfor(int i=1;i<=200000;i++) isp[i]=1;\n\tfor(int i=2;i<=200000;i++){\n\t\tif(isp[i]){\n\t\t\ttot++;\n\t\t\tprm[tot]=i;\n\t\t\tfor(int j=2;j*i<=200000;j++){\n\t\t\t\tisp[j*i]=0;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=2;i<=200000;i+=2) ok2[i]=1;\n\tfor(int i=3;i<=200000;i+=3) ok3[i]=1;\n\tfor(int i=5;i<=200000;i+=5) ok5[i]=1;\n\tint n=200000;\n\tn=read();\n\tint a[n+1];\n\tfor(int i=1;i<=n;i++){\n\t\ta[i]=i;\n\t\ta[i]=read();\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tif(i<=500){\n\t\t\tmemset(g,0,sizeof(g));\n\t\t\tfor(int j=1;j*i<=n;j++){\n\t\t\t\tg[a[i*j]]=1;\n\t\t\t}\n\t\t\tfor(int k=1;k<=tot;k++){\n\t\t\t\tfor(int j=n/prm[k];j>=1;j--){\n\t\t\t\t\tg[j]+=g[j*prm[k]];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j=1;j<=n;j++) if(g[j]) g[j]=g[j]*(g[j]-1)/2;\n\t\t\tfor(int k=1;k<=tot;k++){\n\t\t\t\tint top=n/prm[k];\n\t\t\t\tfor(int j=1;j<=top;j++){\n\t\t\t\t\tg[j]-=g[j*prm[k]];\n\t\t\t\t}\n\t\t\t}\n\t\t\tf[i]=(n/i)*(n/i-1)/2-g[1];\n\t\t}\n\t\telse{\n\t\t\tfor(int j=1;j*i<=n;j++){\n\t\t\t\tfor(int k=j+1;k*i<=n;k++){\n\t\t\t\t\tif(ok2[a[j*i]]&&ok2[a[k*i]]){\n\t\t\t\t\t\tf[i]++; continue;\n\t\t\t\t\t}\n\t\t\t\t\tif(ok3[a[j*i]]&&ok3[a[k*i]]){\n\t\t\t\t\t\tf[i]++; continue;\n\t\t\t\t\t}\n\t\t\t\t\tif(ok3[a[j*i]]&&ok3[a[k*i]]){\n\t\t\t\t\t\tf[i]++; continue;\n\t\t\t\t\t}\n\t\t\t\t\tif(__gcd(a[j*i],a[k*i])!=1){\n\t\t\t\t\t\tf[i]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int k=1;k<=tot;k++){\n\t\tfor(int j=1;j*prm[k]<=n;j++){\n\t\t\tf[j]-=f[j*prm[k]];\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int j=2;j<=n;j++) ans+=f[j];\n\tcout<<ans+n-1-(a[1]!=1);\n\treturn 0;\n}\n```",
        "postTime": 1667449833,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "ABC230G \u9898\u89e3"
    }
]
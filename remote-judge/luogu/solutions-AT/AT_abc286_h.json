[
    {
        "content": "\u6211\u4eec\u9996\u5148\u6c42\u51fa\u7ebf\u6bb5\u4e0e\u591a\u8fb9\u5f62\u7684\u4ea4\u70b9\uff0c\u5982\u679c\u4ea4\u70b9\u4e2a\u6570 $<2$ \u6216\u8005\u6709\u65e0\u6570\u4e2a\u4ea4\u70b9\uff0c\u5219\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa $S$ \u5230 $T$ \u4e4b\u95f4\u7684\u8ddd\u79bb\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u4ea4\u70b9\u4e2a\u6570\u4e3a $2$ \u7684\u60c5\u51b5\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u8bb0\u8ddd\u79bb $S$ \u6700\u8fd1\u7684\u90a3\u4e2a\u4ea4\u70b9\u4e3a $P_1$\uff0c\u8fdc\u7684\u4e3a $P_2$\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e0f0ck34.png)\n\n\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u76f4\u7ebf $ST$ \u5c06\u6574\u4e2a\u591a\u8fb9\u5f62\u5206\u6210\u4e86\u4e24\u4e2a\u51f8\u58f3\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u591a\u8fb9\u5f62\u4e0b\u9762\u8fc7\u53bb\u4e5f\u53ef\u4ee5\u4ece\u4e0a\u9762\u8fc7\u53bb\u3002\u8003\u8651\u5bf9\u4e8e\u4e24\u90e8\u4efd\u5206\u522b\u6c42\u51fa\u4e00\u6761\u6700\u77ed\u8def\u5f84\u518d\u53d6\u4e00\u4e2a\u6700\u5c0f\u503c\u3002\uff08\u8fd9\u91cc\u4e0a\u534a\u90e8\u5206\u6307\u7684\u662f\u5411\u91cf $\\overrightarrow{ST}$ \u7684\u5de6\u534a\u5e73\u9762\uff09\n\n\u6211\u4eec\u5148\u8003\u8651\u4e0a\u534a\u90e8\u5206\u7684\u4e00\u6761\u8def\u5f84 $S\\rightarrow P_1 \\rightarrow A_1\\rightarrow A_6 \\rightarrow A_5 \\rightarrow P_2 \\rightarrow T$\uff0c\u53ef\u4ee5\u53d1\u73b0\u8fd9\u6761\u8def\u5f84\u7684\u4e00\u4e2a\u524d\u7f00 $S\\rightarrow P_1 \\rightarrow A_1$ \u6ca1\u6709 $S\\rightarrow A_1$ \u66f4\u4f18\uff08\u4e09\u89d2\u5f62\u7684\u6027\u8d28\uff09\u3002\n\n\u8003\u8651\u6309\u5230 $S$ \u7684\u8ddd\u79bb\u7684\u987a\u5e8f\u679a\u4e3e\u4e0a\u534a\u90e8\u5206\u7684\u6240\u6709\u70b9\u3002\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u6808\uff0c\u6bcf\u6b21\u65b0\u52a0\u5165\u4e00\u4e2a\u70b9\u65f6\uff0c\u5982\u679c\u6808\u7684\u5927\u5c0f $<2$\uff0c\u5c31\u76f4\u63a5\u5165\u6808\u3002\n\n\u5bf9\u4e8e\u5176\u5b83\u60c5\u51b5\uff0c\u6211\u4eec\u8bb0\u5f53\u524d\u8fd9\u4e2a\u70b9\u4e3a $P$\uff0c\u6808\u9876\u7684\u4e24\u4e2a\u70b9\u5206\u522b\u4e3a $A,B$\uff08$A$ \u6bd4 $B$ \u5148\u5165\u6808\uff09\uff0c\u8003\u8651\u5411\u91cf $\\overrightarrow{AB}$ \u4e0e\u5411\u91cf $\\overrightarrow{BP}$ \u7684\u53c9\u79ef\uff0c\u5982\u679c\u7b26\u53f7\u4e0d\u4e3a**\u8d1f**\u5219\u5c06 $B$ \u5f39\u51fa\u6808\uff0c\u91cd\u590d\u8fd9\u4e2a\u64cd\u4f5c\u76f4\u5230\u7b26\u53f7\u4e0d\u4e3a\u8d1f\u6216\u8005\u6808\u7684\u5927\u5c0f $<2$\u3002\u6700\u540e\u518d\u5c06 $P$ \u5165\u6808\u3002\n\n\u90a3\u4e48\u8def\u5f84\u7684\u957f\u5ea6\u5c31\u662f\u6700\u540e\u7684\u6808\u4e2d\u76f8\u90bb\u4e24\u4e2a\u70b9\u7684\u8ddd\u79bb\u7684\u548c\u3002\u5bf9\u4e8e\u4e0b\u534a\u90e8\u5206\u4e5f\u662f\u7c7b\u4f3c\u7684\u64cd\u4f5c\uff0c\u4f46\u662f\u5728\u5224\u65ad\u53c9\u79ef\u7684\u7b26\u53f7\u65f6\u5982\u679c\u7b26\u53f7\u4e0d\u4e3a**\u6b63**\u624d\u5c06 $B$ \u5f39\u51fa\u6808\u3002\n\n\u90a3\u4e48\u5269\u4e0b\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u6c42\u51fa\u4e24\u534a\u90e8\u4efd\u7684\u70b9\u4e86\u3002\u6211\u4eec\u8bb0 $P_1$ \u6240\u5728\u7684\u7ebf\u6bb5\u7684\u4e24\u4e2a\u7aef\u70b9\u5206\u522b\u662f $A_i,A_{(i+1)\\mod n}$\uff08\u5982\u679c\u5b58\u5728\u591a\u6761\u7ebf\u6bb5\u5219\u4efb\u53d6\u4e00\u4e2a\uff09\uff0c$P_2$ \u6240\u5728\u7684\u7ebf\u6bb5\u7684\u4e24\u4e2a\u7aef\u70b9\u5206\u522b\u662f $A_j,A_{(j+1)\\mod n}$\uff0c\u90a3\u4e48\u70b9 $A_{i+1},A_{i+2},\\dots,A_{n-1},A_0,A_1,\\dots A_j$ \u5c5e\u4e8e\u4e0b\u534a\u90e8\u5206\uff0c\u5269\u4e0b\u7684\u5c31\u5c5e\u4e8e\u4e0a\u534a\u90e8\u5206\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define mxn 100003\n#define md 1000000007\n#define pb push_back\n#define mkp make_pair\n#define ld long double\n#define umap unordered_map\n#define rep(i,a,b) for(int i=a;i<=b;++i)\n#define rept(i,a,b) for(int i=a;i<b;++i)\n#define drep(i,a,b) for(int i=a;i>=b;--i)\n#define pq priority_queue\nusing namespace std;\nstruct point{\n\tld x,y;\n\tinline void in(){\n\t\tscanf(\"%Lf%Lf\",&x,&y);\n\t}\n}s,t,a[mxn],q[mxn+10];\nstruct line{\n\tld k,b;\n\tline(point x,point y){\n\t\tk=(y.y-x.y)/(y.x-x.x);\n\t\tb=x.y-x.x*k;\n\t}\n\tinline ld at(ld x){\n\t\treturn x*k+b;\n\t}\n};\nconst ld esp=1e-8;\ninline point operator-(point x,point y){\n\treturn {x.x-y.x,x.y-y.y};\n}\ninline bool operator==(point x,point y){\n\treturn fabs(x.x-y.x)<esp&&fabs(x.y-y.y)<esp;\n}\ninline bool operator==(line x,line y){\n\treturn fabs(x.k-y.k)<esp&&fabs(x.b-y.b)<esp;\n}\ninline point operator&(line a,line b){\n\tld x=(b.b-a.b)/(a.k-b.k);\n\treturn {x,a.k*x+a.b};\n}\ninline ld operator*(point x,point y){\n\treturn x.x*y.y-x.y*y.x;\n}\ninline int cmp(ld x){\n\tif(fabs(x)<esp)return 0;\n\treturn x<0?-1:1;\n}\ninline ld len(point x){\n\treturn sqrt(x.x*x.x+x.y*x.y);\n}\nint n,m;\nvector<pair<point,int> >st,d1;\nld ans1,ans2;\ninline void add1(point x){\n\twhile(m>1&&(x==q[m]||cmp((q[m]-q[m-1])*(x-q[m]))!=1))m--;\n\tq[++m]=x;\n}\ninline void add2(point x){\n\twhile(m>1&&(x==q[m]||cmp((q[m]-q[m-1])*(x-q[m]))!=-1))m--;\n\tq[++m]=x;\n}\nsigned main(){\n\tscanf(\"%d\",&n);\n\trept(i,0,n)a[i].in();\n\ts.in(),t.in();\n\tline d(s,t);\n\trept(i,0,n){\n\t\tline x(a[i],a[(i+1)%n]);\n\t\tif(s.x==t.x&&a[i].x==a[(i+1)%n].x){\n\t\t\tif(s.x==a[i].x){\n\t\t\t\tprintf(\"%.10Lf\",len(s-t));\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif(s.x!=t.x&&x.k==d.k){\n\t\t\tif(x.b==d.b){\n\t\t\t\tprintf(\"%.10Lf\",len(s-t));\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tpoint p;\n\t\tif(s.x==t.x){\n\t\t\tp={s.x,x.at(s.x)};\n\t\t}else if(a[i].x==a[(i+1)%n].x){\n\t\t\tp={a[i].x,d.at(a[i].x)};\n\t\t}else p=x&d;\n\t\tif(p.x>=min(a[i].x,a[(i+1)%n].x)&&p.x<=max(a[i].x,a[(i+1)%n].x)&&p.x>=min(s.x,t.x)&&p.x<=max(s.x,t.x)&&p.y>=min(a[i].y,a[(i+1)%n].y)&&p.y<=max(a[i].y,a[(i+1)%n].y)&&p.y>=min(s.y,t.y)&&p.y<=max(s.y,t.y)){\n\t\t\td1.pb(mkp(p,i));\n\t\t}\n\t}\n\tfor(auto i:d1){\n\t\tfor(auto j:st)if(i.first==j.first)goto next;\n\t\tst.pb(i);\n\t\tnext:;\n\t}\n\tif(st.size()!=2){\n\t\tprintf(\"%.10Lf\",len(s-t));\n\t\treturn 0;\n\t}\n\tif(len(s-st[0].first)>len(s-st[1].first))swap(st[0],st[1]);\n\tadd1(s),add1(st[0].first);\n\tint i=(st[0].second+1)%n;\n\twhile(1){\n\t\tadd1(a[i]);\n\t\tif(i==st[1].second)break;\n\t\ti=(i+1)%n;\n\t}\n\tadd1(st[1].first),add1(t);\n\trep(i,2,m)ans1+=len(q[i]-q[i-1]);\n\tm=0;\n\tadd2(s),add2(st[0].first);\n\ti=st[0].second;\n\twhile(1){\n\t\tadd2(a[i]);\n\t\tif(i==(st[1].second+1)%n)break;\n\t\ti=(i+n-1)%n;\n\t}\n\tadd2(st[1].first),add2(t);\n\trep(i,2,m)ans2+=len(q[i]-q[i-1]);\n\tprintf(\"%.10Lf\",min(ans1,ans2));\n\treturn 0;\n}\n```",
        "postTime": 1674466301,
        "uid": 329857,
        "name": "zifanwang",
        "ccfLevel": 7,
        "title": "[ABC286Ex] Don't Swim \u9898\u89e3"
    },
    {
        "content": "\u7b2c\u4e00\u6b21\u8d5b\u573a\u4e0a\u505a\u51fa Ex\uff0c\u796d\u4e4b\u3002\uff08\u5176\u5b9e\u6211\u8fd8\u6ca1\u505a\u51fa\u8fc7 G\u3002\uff09\n\n## Problem\n\n\u7ed9\u4f60\u5e73\u9762\u4e0a\u7684 $S,T$ \u4ee5\u53ca\u4e00\u4e2a\u591a\u8fb9\u5f62\u7684\u5899\uff0c\u6c42 $S\\to T$ \u4e0d\u8de8\u8d8a\u5899\u7684\u6700\u77ed\u8def\u3002\n\n\u4e00\u9053\u4e0d\u9519\u7684\u8ba1\u7b97\u51e0\u4f55\u3002\n\n## Solution 1\n\n\u5efa\u8bae\u4e0d\u611f\u5174\u8da3\u7684\u76f4\u63a5\u770b Solution 2\u3002\n\n\u9996\u5148\uff0c\u5982\u679c $S\\to T$ \u7ebf\u6bb5\u4e0e\u591a\u8fb9\u5f62\u7684\u8fb9\u4e0d\u4ea4\uff0c\u90a3\u4e48\u4e24\u70b9\u4e4b\u95f4\u7ebf\u6bb5\u6700\u77ed\u3002\n\n```\n      B G\n     A    E\nS               T\n     C    F\n      D H\n```\n\n\u5047\u5982\u6211\u4eec\u6709\u4e00\u6761\u8def\u662f $S\\to A\\to B \\to G\\to T$\uff0c\u6211\u4eec\u53d1\u73b0\u5728 $\\Delta ABS$ \u4e2d\uff0c$|SA|+|AB|>|SB|$\uff0c\u6240\u4ee5 $S\\to B\\to G\\to T$ \u662f\u6700\u4f18\u7684\u3002\n\n\u7ecf\u8fc7\u4e00\u4e9b\u5c1d\u8bd5\uff0c\u6211\u4eec\u53d1\u73b0\uff1a\n\n\u6700\u77ed\u8def\u5f84\u5fc5\u987b\u5f62\u5982\uff1a$S$ \u5230 $S$ \u5bf9\u591a\u8fb9\u5f62\u7684\u4e00\u6761\u5207\u7ebf\u7684\u5207\u70b9\uff08\u6bd4\u5982\u56fe\u4e2d\u7684 $B,D$\uff0c\u5373\u6574\u4e2a\u591a\u8fb9\u5f62\u5728\u5207\u7ebf\u7684\u4e00\u4fa7\uff0c\u4e14\u5207\u7ebf\u7ecf\u8fc7\u591a\u8fb9\u5f62\u7684\u4e00\u4e2a\u9876\u70b9\uff09\u5230 $T$ \u7684\u4e00\u4e2a\u5207\u70b9\uff08\u8fd9\u4e00\u6bb5\u6cbf\u7740\u591a\u8fb9\u5f62\u5916\u6846\uff09\u5230 $T$\u3002\n\n\u5207\u70b9\u7684\u8bdd\uff0c$S$ \u548c $T$ \u5206\u522b\u5904\u7406\uff0c\u6bd4\u5982\u5904\u7406 $S$ \u7684\u65f6\u5019\uff0c\u628a\u6240\u6709\u70b9\u6309\u7167\u6781\u89d2\u6392\u5e8f\uff0c\u53d6\u6700\u5927\u548c\u6700\u5c0f\u7684\u5c31\u884c\u3002\n\n\u7136\u540e\u8ba8\u8bba $2\\times 2=4$ \u79cd\u60c5\u51b5\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4e00\u4e2a\u5c0f\u63d0\u793a\uff1a`atan2(y,x)` \u503c\u57df\u662f $[-\\pi,\\pi]$\uff0c\u9700\u8981\u7279\u6b8a\u5904\u7406\u3002\u6211\u7684\u5904\u7406\u662f\u624b\u52a8\u628a\u503c\u57df\u5904\u7406\u6210 $[0,2\\pi]$\uff0c\u7136\u540e\u7279\u5224\u5b58\u5728\u70b9\u540c\u65f6\u5728 $S$ \u7684\u53f3\u4e0b\u65b9\u548c\u53f3\u4e0a\u65b9\u7684\u60c5\u51b5\u3002\n\n\u603b\u4e4b\u6709\u90a3\u4e48\u70b9\u590d\u6742\uff0c\u6211\u8003\u573a\u4e0a\u82b1\u4e86\u6574\u6574\u4e5d\u5341\u51e0\u5206\u949f\u5916\u52a0 7 \u53d1\u7f5a\u65f6\u624d\u5e72\u51fa\u6765\uff0c\u5176\u5b83\u5565\u4e8b\u6ca1\u5e72\u3002\n\n**upd\uff1a**\u5224\u65ad\u7ebf\u6bb5\u4e0d\u76f8\u4ea4\u65f6\u4e00\u5b9a\u4e0d\u80fd\u7b49\u4e8e 0\uff0c\u5177\u4f53\u770b\u4ee3\u7801\u3002\n\n\u4e3a\u4ec0\u4e48\uff1f\u56e0\u4e3a\uff1a\n\n```\nS=(-100,0),T=(100,0)\nA(-1,0) B(0,1) C(1,0) D(0,-1)\n```\n\n\u7ebf\u6bb5 $ST$ \u4e0e\u522b\u7684\u7ebf\u6bb5\u53ea\u4ea4\u5728\u7aef\u70b9\uff0c\u4f1a\u51fa\u95ee\u9898\uff0c\u8bef\u5224\u6210\u4e0e\u591a\u8fb9\u5f62\u4e0d\u76f8\u4ea4\u3002\n\n\u8d34\u4e2a\u4e11\u964b\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define db double\nconst int N=100005;\nconst db eps=1e-9;\n#define pi 6.283185307179\nint n;\ninline int sgn(db a) {return a<-eps?-1:a>eps;}\ninline int cmp(db a,db b){return sgn(a-b);}\nstruct P{\n\tdb x,y;\n\tP operator +(P p){return {x+p.x,y+p.y};}\n\tP operator -(P p){return {x-p.x,y-p.y};}\n\tdb operator *(P p){return x*p.y-y*p.x;}\n\tP operator /(db d){return {x/d,y/d};}\n\tbool operator <(const P& p) const{\n\t\tint c=cmp(x,p.x);\n\t\tif(c) return c==-1;\n\t\treturn cmp(y,p.y)==-1;\n\t}\n\tbool operator ==(const P& o) const{\n\t\treturn cmp(x,o.x)==0 && cmp(y,o.y)==0;\n\t}\n\tdb dot(P p){return x*p.x+y*p.y;}\n\tdb abs2(){return x*x+y*y;}\n\tdb abs() {return sqrt(abs2());}\n\tdb distTo(P p) {return (*this-p).abs();}\n\tdb alpha() {return sgn(atan2(y,x))==-1?atan2(y,x)+pi:atan2(y,x);}\n\tvoid read() {cin>>x>>y;}\n\tvoid write(){printf(\"(%lf,%lf)\\n\",x,y);}\n\tP rot90() {return P{-y,x};}\n\tP unit() {return *this/abs();}\n\tint quad() const{\n\t\tif(sgn(x)==1&&sgn(y)==1) return 1;\n\t\tif(sgn(x)==1&&sgn(y)<=0) return 4;\n\t\tif(sgn(x)<=0&&sgn(y)<=0) return 3;\n\t\tif(sgn(x)<=0&&sgn(y)==1) return 2;\n\t}\n\tvoid rev(){x=-x;}\n};\nP a[2*N];\nP S,T;\nbool inter(P A,P B,P C,P D)\n{\n\tif(((C-A)*(D-A))*((C-B)*(D-B))>0.0) return 0;\n\tif(((A-C)*(B-C))*((A-D)*(B-D))>0.0) return 0;\n\treturn 1;//\u8fd9\u91cc\u662f>\u4e0d\u662f>=!!!!!!!!!!(\u6211\u8d5b\u540e\u88abhack\u4e86)\n}\nvoid solve1()\n{\n\tfor(int i=1;i<=n;i++)\n\t\tif(inter(S,T,a[i],a[i+1])) return;\n\tprintf(\"%.7f\",(T-S).abs());\n\texit(0);\n}\ndb dis[2*N];\ndb d(int x,int y)\n{\n\tif(y<x) y+=n;\n\treturn dis[y]-dis[x]; \n}\ndb dist(int x,int y)\n{\n\treturn min(d(x,y),d(y,x));\n}\nint s1=1,s2=1,t1=1,t2=1;\n\nvoid solve(P S,int& s1,int& s2)\n{\n\tbool vis[5];\n\tmemset(vis,0,sizeof(vis));\n\tfor(int i=1;i<=n;i++) \n\t\tvis[(a[i]-S).quad()]=1;\n\tif((vis[1]&&vis[4]))\n\t{\n\t\tS.rev();\n\t\tfor(int i=1;i<=n;i++) a[i].rev();\n\t}\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif((a[s1]-S).alpha()<(a[i]-S).alpha()) s1=i;\n\t\tif((a[s2]-S).alpha()>(a[i]-S).alpha()) s2=i;\n\t}\n\tif((vis[1]&&vis[4]))\n\t{\n\t\tS.rev();\n\t\tfor(int i=1;i<=n;i++) a[i].rev();\n\t}\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++) \n\t{\n\t\ta[i].read();\n\t\ta[n+i]=a[i];\n\t}\n\tS.read(); T.read();\n\tsolve1();\n\tdis[1]=0.0;\n\tfor(int i=2;i<=2*n;i++) dis[i]=dis[i-1]+(a[i]-a[i-1]).abs();\n\tsolve(S,s1,s2);\n\tsolve(T,t1,t2);\n\tdb ans=1e19;\n\tans=min(ans,(S-a[s1]).abs()+dist(s1,t1)+(a[t1]-T).abs());\n\tans=min(ans,(S-a[s2]).abs()+dist(s2,t1)+(a[t1]-T).abs());\n\tans=min(ans,(S-a[s1]).abs()+dist(s1,t2)+(a[t2]-T).abs());\n\tans=min(ans,(S-a[s2]).abs()+dist(s2,t2)+(a[t2]-T).abs());\n\tprintf(\"%.7f\",ans);\n\treturn 0;\n}\n```\n\n## Solution 2\n\n\u6c42 $S,T,A_1,A_2,\\cdots,A_n$ \u7684\u51f8\u5305\u4e0a $S$ \u5230 $T$ \u7684\u8ddd\u79bb\u3002\u6ca1\u4e86\u3002~~\u8bfb\u8005\u81ea\u8bc1\u4e0d\u96be~~\u53ef\u4ee5\u53c2\u8003 Solution 1 \u6765\u7406\u89e3\u3002",
        "postTime": 1674743642,
        "uid": 148507,
        "name": "_Imaginary_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT_abc286Ex\u3010Dont Swim\u3011"
    }
]
[
    {
        "content": "\u672c\u6587\u7ae0\u4e3a\u8f6c\u8f7d \u8f6c\u8f7d\u81eaCgfyufsygsm\u7684\u535a\u5ba2\r\n\r\n\u6e90\u672c\u6587\u94fe\u63a5\uff1a[https://blog.csdn.net/qq_44950190/article/details/117340101](https://blog.csdn.net/qq_44950190/article/details/117340101)\r\n\r\n## Description\r\n\r\n\u5e73\u9762\u5185 $N$ \u4e2a\u5750\u6807\u5747\u4e3a\u6574\u6570\u7684\u70b9\uff0c\u5176\u4e2d\u4efb\u610f\u4e09\u70b9\u4e0d\u5171\u7ebf\uff0c\u4ee4\u6240\u6709\u70b9 $ P_i$ \u6784\u6210\u4e00\u4e2a\u5168\u96c6 $U$\uff0c\u5b50\u96c6 $S\\subseteq U$ \u4e14 $|S|\\ge 3$\u3002\u95ee\u51f8\u5305\u9762\u79ef\u4e3a\u6574\u6570\u7684\u5b50\u96c6 $S$ \u7684\u4e2a\u6570\u6a21 $10^9 + 7$ \u7684\u503c\u3002\r\n\r\n$3\\le N\\le 80$\u3002\r\n\r\n## Solution\r\n\r\n\u6bd4\u8f83\u795e\u5947\u7684\u9898\u76ee\u3002\r\n\r\n\u8003\u8651 Andrew \u7b97\u6cd5\u7684\u6267\u884c\u6d41\u7a0b\uff1a\u5c06\u6240\u6709\u70b9\u6309\u7167\u5148 $x$ \u8f74\u5347\u5e8f\u540e $y$ \u8f74\u5347\u5e8f\u6392\u5e8f\uff0c\u7136\u540e\u4ece\u5de6\u5f80\u53f3\u5f04\u51fa\u4e0b\u51f8\u5305\uff0c\u518d\u4ece\u53f3\u5f80\u5de6\u5f04\u51fa\u4e0a\u51f8\u5305\u3002\u672c\u9898\u53ef\u4ee5\u5229\u7528\u7c7b\u4f3c\u7684\u601d\u8def\u3002\r\n\r\n\u7136\u540e\u6211\u4eec\u7531\u53c9\u79ef\u8ba1\u7b97\u9762\u79ef\u7684\u65b9\u6cd5\u77e5\u9053\uff0c\u6574\u70b9\u4e09\u89d2\u5f62\u7684\u9762\u79ef\u4e58\u4e8c\u4e4b\u540e\u5fc5\u7136\u662f\u6574\u6570\u3002\u4e8e\u662f\u6211\u4eec\u8003\u8651\u4f9d\u6b21\u7528\u4e09\u89d2\u5f62\u5f04\u51fa\u51f8\u5305\uff0c\u5177\u4f53\u5730\uff0c\u53ef\u4ee5 dp\uff1a\r\n\r\n- $O(n)$ \u679a\u4e3e\u51f8\u5305\u6700\u5de6\u7aef\u7684\u7aef\u70b9 $P_{s}$\u3002\r\n- $\\mathrm{upper}_{i,j,k}$\uff1a\u51f8\u5305\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\u7684\u70b9\u96c6 $S$ \u7684\u6570\u91cf\uff1a\r\n  - \u4ece $P_s$ \u987a\u65f6\u9488\u8003\u8651\u6bcf\u4e2a\u70b9\uff0c\u6700\u540e\u4e24\u4e2a\u5206\u522b\u662f $P_i$ \u548c $P_j$\uff1b\r\n  - \u6240\u6709\u7684\u70b9\u90fd\u5728\u76f4\u7ebf $P_sP_j$ \u4ee5\u4e0a\uff1b\r\n  - \u9762\u79ef\u4e58\u4ee5\u4e8c\u4e4b\u540e\u6a21\u4e8c\u4e3a $k$\u3002\r\n- $\\mathrm{lower}_{i,j,k}$\uff1a\u51f8\u5305\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\u7684\u70b9\u96c6 $S$ \u7684\u6570\u91cf\uff1a\r\n  - \u4ece $P_s$ \u9006\u65f6\u9488\u8003\u8651\u6bcf\u4e2a\u70b9\uff0c\u6700\u540e\u4e24\u4e2a\u5206\u522b\u662f $P_i$ \u548c $P_j$\uff1b\r\n  - \u6240\u6709\u7684\u70b9\u90fd\u5728\u76f4\u7ebf $P_sP_j$ \u4ee5\u4e0b\uff1b\r\n  - \u9762\u79ef\u4e58\u4ee5\u4e8c\u4e4b\u540e\u6a21\u4e8c\u4e3a $k$\u3002\r\n- \u786e\u5b9a\u6bcf\u4e2a\u6700\u53f3\u7aef\u7684\u70b9 $P_j$\uff0c\u7136\u540e\u679a\u4e3e $i$ \u548c $k$ \u7edf\u8ba1\u7b54\u6848\uff1a\r\n  $\\mathrm{ans}_s = \\sum_{j = s + 1}^n\\sum_{k \\in \\{0, 1\\}}\\left(\\sum_{i}\\mathrm{upper}_{i,j,k} \\times \\sum_{i}\\mathrm{lower_{i,j,k}} \\right)$\r\n\r\n\u8fd9\u6837\u505a\u7684\u539f\u7406\u5176\u5b9e\u5c31\u662f\u5408\u5e76\u4e0a\u4e0b\u51f8\u58f3\uff1a\u6839\u636e\u4e0a\u9762\u8bbe\u8ba1\u7684 dp \u72b6\u6001\u53ef\u77e5\u6211\u4eec\u786e\u5b9a\u4e86\u5de6\u7aef\u70b9 $P_s$ \u548c\u53f3\u7aef\u70b9 $P_j$ \u540e\uff0c\u6ee1\u8db3\u4e0a\u51f8\u58f3\u7684\u70b9\u96c6\u4e2a\u6570\u5373\u4e3a\u679a\u4e3e\u5012\u6570\u7b2c\u4e8c\u4e2a\u70b9 $i$ \u7136\u540e\u6c42\u548c\u7684\u7ed3\u679c $\\sum_{i}\\mathrm{upper}_{i,j,k}$\uff0c\u6ee1\u8db3\u4e0b\u51f8\u58f3\u7684\u70b9\u96c6\u4e2a\u6570\u5373\u4e3a  $\\sum_i\\mathrm{lower}_{i,j,k}$\u3002\r\n\r\n\u600e\u4e48\u8ba1\u7b97 $\\mathrm{upper}$ \u548c $\\mathrm{lower}$ \u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 $\\mathrm{upper}_{i,j,k}$ \u9012\u63a8\u51fa $\\mathrm{upper}_{j,l,k}$\uff0c\u5176\u539f\u7406\u5c31\u662f\u5224\u65ad $P_l$ \u80fd\u5426\u88ab\u52a0\u5165\u51f8\u58f3\u4e2d\uff0c\u80fd\u5219\u66f4\u65b0\uff0c\u4e0d\u80fd\u5c31\u66f4\u65b0 $\\mathrm{lower}_{j,l,k}$\uff08\u52a0\u5165\u4e0b\u51f8\u58f3\uff09\u3002\u65b0\u52a0\u5165\u7684\u90e8\u5206\u5373\u4e3a $\\triangle P_sP_jP_l$\uff0c\u9700\u8981\u6839\u636e\u8fd9\u4e2a\u9762\u79ef\u7684\u4e8c\u500d\u7684\u5947\u5076\u6027\u5224\u65ad\u66f4\u65b0\u54ea\u4e2a $k$\u3002\r\n\r\n\u8fd9\u4e2a\u505a\u6cd5\u8981\u6c42\u6211\u4eec\u63d0\u524d\u9884\u5904\u7406\u6bcf\u4e2a\u4e09\u89d2\u5f62\u7684\u9762\u79ef\u7684\u4e8c\u500d\u7684\u5947\u5076\u6027 $\\mathrm{parity}_{i,j,k}$ \u548c\u4e09\u89d2\u5f62\u5185\u70b9\u7684\u4e2a\u6570 $\\mathrm{inside}_{i,j,k}$\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4)$\u3002\r\n\r\n\u4ee3\u7801\uff1a\r\n\r\n```cpp\r\n#include <cstdio>\r\n#include <cctype>\r\n#include <cmath>\r\n#include <algorithm>\r\n#define il inline\r\n#define FOR(i, a, b) for (int i = a; i <= b; ++i)\r\n#define DEC(i, a, b) for (int i = a; i >= b; --i)\r\n\r\nconst int maxn = 85;\r\n\r\nint read()\r\n{\r\n    int s = 0, x = 0;\r\n    char c = getchar();\r\n    while (!isdigit(c))\r\n        x |= (c == '-'), c = getchar();\r\n    while (isdigit(c))\r\n        s = s * 10 + c - '0', c = getchar();\r\n    return x ? -s : s;\r\n}\r\n\r\nstruct Point\r\n{\r\n    int x, y;\r\n    Point() {}\r\n    Point(int _x, int _y) {x = _x, y = _y;}\r\n    il bool operator<(const Point &b) const {return x == b.x ? y < b.y : x < b.x;}\r\n} P[maxn];\r\n\r\ntypedef Point Vector;\r\n\r\nstruct modint\r\n{\r\n    typedef long long ll;\r\n    const static ll mod = 1e9 + 7;\r\n    ll val;\r\n    modint(int _val = 0) {val = _val;}\r\n    modint operator+(const modint &b) const {return modint((val + b.val) % mod);}\r\n    modint operator-(const modint &b) const {return modint((val - b.val + mod) % mod);}\r\n    modint operator*(const modint &b) const {return modint((val * b.val) % mod);}\r\n    modint operator+=(const modint &b) {return *this = *this + b;}\r\n    modint operator*=(const modint &b) {return *this = *this * b;}\r\n    modint operator-=(const modint &b) {return *this = *this - b;}\r\n    modint operator+(const int &b) const {return modint((val + b) % mod);}\r\n    modint operator-(const int &b) const {return modint((val - b + mod) % mod);}\r\n    modint operator*(const int &b) const {return modint((val * b) % mod);}\r\n    modint operator+=(const int &b) {return *this = *this + b;}\r\n    modint operator-=(const int &b) {return *this = *this - b;}\r\n    modint operator*=(const int &b) {return *this = *this * b;}\r\n};\r\n\r\nil Vector operator-(const Point &a, const Point &b) {return Point(b.x - a.x, b.y - a.y);}\r\nil int operator^(const Vector &a, const Vector &b) {return a.x * b.y - a.y * b.x;}//\u53c9\u79ef\r\n\r\nint area2(Point x, Point y, Point z)//\u8fd4\u56de\u9762\u79ef\u7684\u4e8c\u500d\r\n{\r\n    return abs((y - x) ^ (z - x));\r\n}\r\n\r\nint n, parity[maxn][maxn][maxn], inside[maxn][maxn][maxn];\r\nmodint pow2[maxn], upper[maxn][maxn][2], lower[maxn][maxn][2];\r\n\r\nint main()\r\n{\r\n    n = read();\r\n    FOR(i, 1, n) P[i].x = read(), P[i].y = read();\r\n    std::sort(P + 1, P + n + 1);//\u5bf9\u70b9\u8fdb\u884c\u6392\u5e8f\r\n\r\n    FOR(i, 1, n)\r\n        FOR(j, 1, n)\r\n            FOR(k, 1, n)\r\n            {\r\n                if (i == j || j == k || i == k) continue;\r\n                parity[i][j][k] = area2(P[i], P[j], P[k]) % 2;//\u66f4\u65b0\u9762\u79ef\u5947\u5076\u6027\r\n                FOR(l, 1, n)//\u679a\u4e3e\u6bcf\u4e2a l \u70b9\u5224\u65ad l \u5728\u4e0d\u5728\u4e09\u89d2\u5f62\u5185\r\n                    if (l != i && l != j && l != k && area2(P[i], P[j], P[k]) == area2(P[l], P[j], P[k]) + area2(P[i], P[l], P[k]) + area2(P[i], P[j], P[l]))\r\n                        inside[i][j][k] += 1;\r\n            }\r\n    \r\n\r\n    pow2[0] = 1;\r\n    FOR(i, 1, n) pow2[i] = pow2[i - 1] * 2;//\u9884\u5904\u7406\u4e8c\u7684\u6b21\u5e42\r\n\r\n    modint ans = 0;\r\n\r\n    DEC(must, n, 1)//\u679a\u4e3e\u6700\u5de6\u8fb9\u7684\u7aef\u70b9\r\n    {\r\n        FOR(i, must, n)\r\n            FOR(j, must, n)\r\n                FOR(k, 0, 1)\r\n                    upper[i][j][k] = lower[i][j][k] = 0;//\u6e05\u7a7a\u6570\u7ec4\r\n        FOR(i, must + 1, n) upper[must][i][0] = lower[must][i][0] = 1;//\u8fb9\u754c\u6761\u4ef6\r\n        FOR(i, must, n)\r\n            FOR(j, must + 1, n)\r\n                FOR(k, 0, 1)\r\n                    FOR(l, j + 1, n)\r\n                        if (((P[l] - P[j]) ^ (P[j] - P[i])) > 0)//\u52a0\u5165\u4e0a\u51f8\u58f3\r\n                            upper[j][l][k ^ parity[must][j][l]] += upper[i][j][k] * pow2[inside[must][j][l]];//\u4e58\u6cd5\u539f\u7406\r\n                        else lower[j][l][k ^ parity[must][j][l]] += lower[i][j][k] * pow2[inside[must][j][l]];\r\n        FOR(j, must + 1, n)//\u679a\u4e3e\u6700\u53f3\u7aef\u70b9\r\n            FOR(k, 0, 1)\r\n            {\r\n                modint up = 0, lo = 0;//\u4e0a\u4e0b\u51f8\u58f3\r\n                FOR(i, must, j - 1)\r\n                    up += upper[i][j][k], lo += lower[i][j][k];\r\n                ans += up * lo;\r\n            }\r\n    }\r\n\r\n    printf(\"%d\\n\", (ans - n * (n - 1) / 2).val);//\u6700\u540e\u8981\u53bb\u9664\u7ebf\u6bb5\u7684\u8d21\u732e\r\n    return 0;\r\n}\r\n```\r\n\r\n",
        "postTime": 1678721639,
        "uid": 757139,
        "name": "zhangsenhao6728",
        "ccfLevel": 0,
        "title": "AT_abc202_f\u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u8003\u8651\u4ec0\u4e48\u65f6\u5019\u51f8\u5305\u9762\u79ef\u662f\u6574\u6570\uff0c\u56e0\u4e3a\u51f8\u5305\u9762\u79ef\u7b49\u4e8e\u90bb\u8fb9\u53c9\u79ef\u4e4b\u548c\u9664\u4e8c\uff0c\u6240\u4ee5\u5c31\u662f\u5224\u65ad\u5947\u5076\u6027\u3002\n\n\u51f8\u5305\u53ef\u4ee5\u5206\u6210\u4e0a\u4e0b\u4e24\u90e8\u5206\uff0c\u5982\u679c\u6211\u4eec\u56fa\u5b9a\u4e00\u4e2a\u5de6\u7aef\u70b9\uff0c\u4ece\u8fd9\u4e2a\u70b9\u6269\u5c55\u51fa $a$ \u4e2a\u4e0a\u51f8\u5305\uff0c$b$ \u4e2a\u4e0b\u51f8\u5305\uff0c\u90a3\u5c31\u5bf9\u7b54\u6848\u6709\u8d21\u732e $a \\times  b$\u3002\n\n\u5982\u4f55\u8ba1\u7b97\u5462\uff0c\u8003\u8651 dp\u3002\n\n\u6bcf\u6b21\u56fa\u5b9a\u4e00\u4e2a\u70b9 $p$\uff0c\u8bbe $dp_{i,j,k,0}$ \u8868\u793a\u4ece $p$ \u70b9\u5f00\u59cb\u53d6\u4e00\u4e2a\u4e0a\u51f8\u5305\uff0c\u6700\u540e\u4e24\u4e2a\u70b9\u662f $i,j$ \uff0c\u4e0a\u51f8\u5305\u9762\u79ef\u53d6\u6a21 $2$ \u4e3a $k$\u3002$dp_{i,j,k,1}$ \u8868\u793a\u4ece $p$ \u70b9\u5f00\u59cb\u53d6\u4e00\u4e2a\u4e0b\u51f8\u5305\uff0c\u6700\u540e\u4e24\u4e2a\u70b9\u662f $i,j$ \uff0c\u4e0b\u51f8\u5305\u9762\u79ef\u53d6\u6a21 $2$ \u4e3a $k$\u3002\n\n\u6c42\u89e3\u8fd9\u4e2a dp \u6570\u7ec4\u53ef\u4ee5\u6a21\u62df\u6c42\u51f8\u5305\u7684\u8fc7\u7a0b\uff0c\u5f53\u52a0\u5165\u4e00\u4e2a\u70b9\u65f6\uff0c\u5224\u65ad\u5176\u53c9\u79ef\u662f\u5426\u5927\u4e8e $0$\uff0c\u82e5\u5927\u4e8e $0$ \u5219\u52a0\u5165\u4e0a\u51f8\u5305\uff0c\u53cd\u4e4b\u52a0\u5165\u4e0b\u51f8\u5305\uff0c\u518d\u6839\u636e\u4e09\u89d2\u5f62\u9762\u79ef\u4e8c\u500d\u7684\u5947\u5076\u6027\u6765\u66f4\u65b0\uff0c\u8bbe\u8fd9\u4e2a\u4e09\u89d2\u5f62\u91cc\u6709 $x$ \u4e2a\u70b9\uff0c\u8fd9\u4e9b\u70b9\u80af\u5b9a\u968f\u4fbf\u9009\uff0c\u6240\u4ee5\u518d\u4e58\u4e0a $2^x$ \u5c31\u884c\u4e86\u3002\n\n\u56fa\u5b9a\u5b8c\u5de6\u7aef\u70b9 $p$ \u4e4b\u540e\uff0c\u518d\u56fa\u5b9a\u4e00\u4e2a\u53f3\u7aef\u70b9 $i$ \uff0c\u7b54\u6848\u5373\u4e3a\n\n$$\\sum_{p}^{}\\sum_{i}^{}\\sum_{k=0,1}^{}\\left ( \\sum_{j}^{} dp_{i,j,k,0} \\right )\\times \\left ( \\sum_{j}^{} dp_{i,j,k,1} \\right ) $$\n\n\u6700\u540e\u8fd8\u8981\u51cf\u6389\u7ebf\u6bb5\u7684\u6570\u91cf\uff0c\u6ca1\u6709\u4e09\u70b9\u5171\u7ebf\uff0c\u5c31\u662f    $\\frac{n(n-1)}{2}$\u3002\n\n\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u4e09\u89d2\u5f62\u5185\u90e8\u6709\u591a\u5c11\u70b9\u5c31\u884c\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4)$\u3002\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio> \n#include<cmath>\nusing namespace std;\n#define int long long\nconst int mod=1e9+7;\nconst int N=105;\nstruct ss\n{\n\tint x,y;\n};\nss p[N];\nint dp[N][N][2][2];\nint dian[N][N][N];\nint p2[N];\nint cj(ss a,ss b,ss base)\n{\n\treturn (a.x-base.x)*(b.y-base.y)-(a.y-base.y)*(b.x-base.x);\n}\nbool cmp(ss a,ss b)\n{\n\tif(a.x^b.x)\n\treturn a.x<b.x;\n\treturn a.y<b.y;\n}\nsigned main()\n{\n\tint n;\n\tcin>>n;\n\tp2[0]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tp2[i]=p2[i-1]*2%mod;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcin>>p[i].x>>p[i].y;\n\t}\n\tsort(p+1,p+1+n,cmp);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tfor(int k=1;k<=n;k++)\n\t\t\t{\n\t\t\t\tif(i==j || i==k || j==k)\n\t\t\t\tcontinue; \n\t\t\t\tfor(int l=1;l<=n;l++)\n\t\t\t\t{\n\t\t\t\t\tif(l!=i && l!=j && l!=k && abs(cj(p[k],p[j],p[i]))==abs(cj(p[j],p[l],p[i]))+abs(cj(p[l],p[k],p[i]))+abs(cj(p[k],p[j],p[l])))//\u4e09\u89d2\u5f62\u9762\u79ef\u7b49\u4e8e\u4e09\u4e2a\u540c\u9876\u70b9\u7684\u4e09\u89d2\u5f62\u9762\u79ef\u4e4b\u548c\uff0c\u8bf4\u660e\u8fd9\u4e2a\u70b9\u5728\u4e09\u89d2\u5f62\u5185\u90e8 \n\t\t\t\t\tdian[i][j][k]++; \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} \n\tint ans=0;\n\tfor(int P=n-1;P;P--) \n\t{\n\t\tmemset(dp,0,sizeof(dp));\n\t\tfor(int i=P+1;i<=n;i++)\n\t\t{\n\t\t\tdp[P][i][0][0]=dp[P][i][0][1]=1;\n\t\t}\n\t\tfor(int i=P;i<=n;i++)\n\t\t{\n\t\t\tfor(int j=P;j<=n;j++)\n\t\t\t{\n\t\t\t\tfor(int k=0;k<=1;k++)\n\t\t\t\t{\n\t\t\t\t\tfor(int l=j+1;l<=n;l++)\n\t\t\t\t\t{ \n\t\t\t\t\t\tint chaji=abs(cj(p[j],p[l],p[P]));\n\t\t\t\t\t\tif(cj(p[l],p[i],p[j])>0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[j][l][(k+chaji)%2][0]+=dp[i][j][k][0]*p2[dian[P][j][l]]%mod,dp[j][l][(k+chaji)%2][0]%=mod;\n//\t\t\t\t\t\t\tcout<<dp[j][l][(k+chaji)%2][0]<<endl;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[j][l][(k+chaji)%2][1]+=dp[i][j][k][1]*p2[dian[P][j][l]]%mod,dp[j][l][(k+chaji)%2][1]%=mod;\n//\t\t\t\t\t\t\tcout<<dp[j][l][(k+chaji)%2][1]<<endl;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int j=P+1;j<=n;j++)\n\t\t{\n\t\t\tfor(int k=0;k<=1;k++)\n\t\t\t{\n\t\t\t\tint ans1=0,ans2=0;\n\t\t\t\tfor(int i=P;i<j;i++)\n\t\t\t\t{\n\t\t\t\t\tans1+=dp[i][j][k][0],ans1%=mod;\n\t\t\t\t\tans2+=dp[i][j][k][1],ans2%=mod;\n\t\t\t\t}\n\t\t\t\tans+=ans1*ans2%mod;\n\t\t\t\tans%=mod;\n\t\t\t}\n\t\t}\n\t} \n\tint r=n*(n-1)/2;\n\tcout<<(ans-r+mod)%mod;\n\treturn 0;\n}\n```\n",
        "postTime": 1671550404,
        "uid": 225580,
        "name": "qazqazqaz",
        "ccfLevel": 0,
        "title": "[ABC202F] Integer Convex Hull"
    }
]
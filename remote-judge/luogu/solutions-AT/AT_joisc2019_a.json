[
    {
        "content": "**[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/MnZnOIerLzy/articles/17205561.html)**\n\n# $\\texttt{Description}$\n\n**[\u6d1b\u8c37\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/AT_joisc2019_a \"\u6d1b\u8c37\u9898\u76ee\u94fe\u63a5\")**\n\n**[AtCoder \u9898\u76ee\u94fe\u63a5](https://atcoder.jp/contests/joisc2019/tasks/joisc2019_a \"AtCoder \u9898\u76ee\u94fe\u63a5\")**\n\n**[PDF \u9898\u9762](https://www.ioi-jp.org/camp/2019/2019-sp-tasks/day1/examination.pdf \"PDF \u9898\u9762\")**\n\n> - \u6709 $n$ \u4e2a\u4e8c\u5143\u7ec4 $(a_i,b_i)$ \u548c $q$ \u4e2a\u8be2\u95ee $(x_j,y_j,z_j)$\uff0c\u6bcf\u4e2a\u8be2\u95ee\u6c42\u6ee1\u8db3 $a_i\\ge x_j$\uff0c$b_i\\ge y_j$\uff0c$a_i+b_i\\ge z_j$ \u7684\u4e8c\u5143\u7ec4\u4e2a\u6570\u3002\n>\n>- $n,q\\le 10^5$\uff0c$a_i,b_i,x_j,y_j\\le 10^9$\uff0c$z_j\\le 2\\times 10^9$\u3002\n\n# $\\texttt{Solution}$\n\n\u4e09\u7ef4\u504f\u5e8f\u6a21\u677f\u9898\uff0c\u8003\u8651\u4f7f\u7528**\u6743\u503c\u6811\u72b6\u6570\u7ec4\u5957\u5e73\u8861\u6811**\u3002\n\n\u5148\u5bf9\u4e8e $b_i$ \u548c $y_j$ \u79bb\u6563\u5316\uff0c\u5f00\u4e00\u68f5\u6743\u503c\u6811\u72b6\u6570\u7ec4\uff0c\u5185\u90e8\u5d4c\u5957\u5e73\u8861\u6811\u3002\n\n\u518d\u628a\u6240\u6709\u4fe1\u606f\u6309\u7167 $a_i$ \u548c $x_j$ **\u4ece\u5927\u5230\u5c0f**\u6392\u5e8f\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u8be2\u95ee\u7edf\u8ba1\u7684\u90fd\u662f $\\ge x_j$ \u7684\u8d21\u732e\u3002\u82e5\u76f8\u540c\uff0c\u5219\u628a**\u4e8c\u5143\u7ec4**\u6392\u5728\u524d\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u4e8c\u5143\u7ec4\u662f\u6ee1\u8db3 $a_i\\ge x_j$ \u7684\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u8d21\u732e\uff08\u82e5\u6ca1\u6709\u5219\u4f1a\u5728\u6811\u5957\u6811\u4e2d\u88ab\u820d\u53bb\uff0c\u6240\u4ee5\u8981\u6392\u5728\u524d\uff09\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u4e8c\u5143\u7ec4\uff0c\u628a $a_i+b_i$ \u63d2\u5165\u5230\u81ea\u5df1\u548c\u7956\u5148\u7684\u5e73\u8861\u6811\u4e0a\u3002\u6ce8\u610f\u63d2\u5165\u4e00\u4e2a\u4e8c\u5143\u7ec4\uff0c\u7528\u7b2c\u4e8c\u5143\u6765\u7ef4\u62a4\u53ef\u91cd\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u67e5\u8be2 $[1,y_j]$ \u7684\u5e73\u8861\u6811\u4e2d\uff0c$[z_j,\\infty]$ \u4e2d\u7684\u5143\u7d20\u4e2a\u6570\u3002\u7531\u4e8e\u6ca1\u6709\u4e0a\u754c\uff0c\u53ef\u4ee5\u7528\u6574\u68f5\u6811\u7684\u5927\u5c0f\u51cf\u53bb $<z_j$ \u7684\u4e2a\u6570\u3002\u6811\u72b6\u6570\u7ec4\u524d\u7f00\u67e5\u8be2\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}((n+q)\\log^2n)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n\\log n)$\u3002\u53ef\u4ee5\u5728\u88ab cdq \u5206\u6cbb\u540a\u6253\u7684\u540c\u65f6\u63a5\u53d7\uff0c\u5f53\u7136\u8fd8\u662f\u53ef\u4ee5\u540a\u6253\u6743\u503c\u6811\u72b6\u6570\u7ec4\u5957\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\u7684\u3002\n\n# $\\texttt{Code}$\n\n\u4ee3\u7801\u5b9e\u73b0\u7ec6\u8282\uff1a\n\n- \u6ce8\u610f\u6743\u503c\u6811\u72b6\u6570\u7ec4\u5f00 $2$ \u500d\u7a7a\u95f4\uff0c\u56e0\u4e3a\u4e8c\u5143\u7ec4\u548c\u8be2\u95ee\u4e00\u8d77\u79bb\u6563\u5316\u3002\n\n- \u53ef\u4ee5\u7528\u6307\u4ee4\u96c6\u52a0\u5feb\u4ee3\u7801\u6548\u7387\u3002\n\n- \u6211\u662f\u4f7f\u7528 `set` \u548c `map` \u4e24\u4e2a STL \u6765\u5b9e\u73b0\u79bb\u6563\u5316\u7684\u3002\n\n- \u6211\u662f\u4f7f\u7528 [`pb_ds` \u5e93\u4e2d\u7684 `rb_tree_tag`\uff08\u7ea2\u9ed1\u6811\uff09](https://oi.wiki/lang/pb-ds/tree/ \"`pb_ds`\")\u6765\u5b9e\u73b0\u5e73\u8861\u6811\u7684\u3002\u7801\u91cf\u8f83\u5c0f\uff0c\u7406\u8bba\u6548\u7387\u8f83\u4f18\uff0c\u4f46\u662f\u5e38\u6570\u8f83\u5927\u3002\n\n\n**[Submission](https://atcoder.jp/contests/joisc2019/submissions/39580060 \"Submission\")**\n\n```cpp\n#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\n#include<ext/pb_ds/assoc_container.hpp>\n#define g __gnu_pbds\n#define N 100005\n#define pii pair<int,int>\n#define tp make_pair\nusing namespace std;\nint n,q,lsh,ans[N],cnt;\nset<int>s;\nmap<int,int>mp;\ng::tree<pii,g::null_type,less<pii>,g::rb_tree_tag,g::tree_order_statistics_node_update>bit[N<<1];\nstruct query{\n    int a,b,c,id;\n    query(){\n        a=b=c=id=0;\n    }\n}p[N<<1];\nvoid modify(int x,int k){\n    for(int i=x;i<=lsh;i+=i&-i){\n        bit[i].insert(tp(k,++cnt));\n    }\n}\nint qnum(int x,int k){\n    int ret=0;\n    for(int i=x;i;i-=i&-i){\n        ret+=bit[i].size()-bit[i].order_of_key(tp(k,0));\n    }\n    return ret;\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    for(int i=1;i<=n;++i){\n        scanf(\"%d%d\",&p[i].a,&p[i].b);\n        s.insert(-p[i].b);//\u53d6\u53cd\u5b9e\u73b0\u5927\u7684\u5728\u524d\n        p[i].c=p[i].a+p[i].b;\n    }\n    for(int i=1;i<=q;++i){\n        scanf(\"%d%d%d\",&p[n+i].a,&p[n+i].b,&p[n+i].c);\n        s.insert(-p[n+i].b);\n        p[n+i].id=i;\n    }\n    for(int i:s){\n        mp[-i]=++lsh;\n    }\n    for(int i=1;i<=n+q;++i){\n        p[i].b=mp[p[i].b];\n    }\n    sort(p+1,p+1+n+q,[](query u,query v){return u.a^v.a?u.a>v.a:u.id<v.id;});\n    for(int i=1;i<=n+q;++i){\n        if(p[i].id){\n            ans[p[i].id]=qnum(p[i].b,p[i].c);\n        }else{\n            modify(p[i].b,p[i].c);\n        }\n    }\n    for(int i=1;i<=q;++i){\n        printf(\"%d\\n\",ans[i]);\n    }\n}\n```",
        "postTime": 1678505994,
        "uid": 539211,
        "name": "\u849f\u84bb\u00b7\u5ed6\u5b50\u9633",
        "ccfLevel": 5,
        "title": "JOISC 2019 Day1 A \u8a66\u9a13 (Examination)"
    }
]
[
    {
        "content": "\u9996\u5148\u663e\u7136 RB \u4e92\u6362\u7b54\u6848\u4e0d\u53d8\uff0c\u6240\u4ee5\u53ea\u8003\u8651 $S_1=R$ \u7684\u60c5\u51b5. \n\n\u5982\u679c $S$ \u5168\u90fd\u662f $R$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u7684\u9650\u5236\u5c31\u662f\u4e0d\u5b58\u5728\u76f8\u90bb\u7684 $B$. \u8bbe $f_i$ \u8868\u793a\u957f\u5ea6\u4e3a $i$ \u7684\u5e8f\u5217\uff08\u6ce8\u610f\u4e0d\u662f\u73af\uff09\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u8f6c\u79fb\u5c31\u679a\u4e3e\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u9009\u4ec0\u4e48\uff0c\u5982\u679c\u9009\u4e86 $R$ \u65b9\u6848\u6570\u662f $f_{i-1}$\uff0c\u5426\u5219\u76f8\u5f53\u4e8e\u5f3a\u5236\u7b2c $i-1$ \u4f4d\u9009 $R$\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u662f $f_{i-2}$. \u7531\u4e8e\u6211\u4eec\u8981\u6c42\u7684\u662f\u73af\uff0c\u6240\u4ee5\u8fd8\u8981\u6c42\u9996\u5c3e\u4e0d\u540c\u65f6\u662f $B$. \u5982\u679c\u672b\u5c3e\u662f $R$ \u90a3\u4e48\u65b9\u6848\u6570\u662f $f_{n-1}$\uff0c\u5426\u5219\u76f8\u5f53\u4e8e\u5f3a\u5236\u7b2c $n-1$ \u548c\u7b2c $1$ \u4e2a\u4f4d\u7f6e\u9009 $R$\uff0c\u65b9\u6848\u6570\u662f $f_{n-3}$. \u7279\u5224 $n<3$ \u7684\u60c5\u51b5.\n\n\u5426\u5219\uff0c\u5982\u679c $S$ \u4e2d\u5b58\u5728 $B$\uff0c\u90a3\u4e48\u6211\u4eec\u9996\u5148\u8fd8\u662f\u6709\u4e0d\u5b58\u5728\u76f8\u90bb\u7684 $B$ \u8fd9\u4e00\u9650\u5236\uff0c\u5e76\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a $B$. \u8bbe $S$ \u7684\u7b2c\u4e00\u4e2a $B$ \u4e4b\u524d\u6709 $L$ \u4e2a $R$. \u7528 $B$ \u628a\u73af\u5206\u6210\u82e5\u5e72\u4e2a\u6781\u957f\u7684 $R$ \u8fde\u7eed\u6bb5\uff0c\u90a3\u4e48\u9996\u5148\u6bcf\u4e2a\u8fde\u7eed\u6bb5\u957f\u5ea6\u5fc5\u987b\u662f\u5947\u6570\uff0c\u5426\u5219\u4e00\u6bb5\u4e0a\u7684\u67d0\u4e2a\u70b9\u5230\u4e24\u7aef\u7684\u8ddd\u79bb\u540c\u4e3a\u5947\u6570\u6216\u540c\u4e3a\u5076\u6570\u5e76\u4e14\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e00\u5b9a\u90fd\u4f1a\u51fa\u73b0\uff0c\u6240\u4ee5\u4e00\u5b9a\u5b58\u5728\u67d0\u4e2a\u70b9\u4e0d\u80fd\u8d70\u6070\u597d $L$ \u6b65\u5230\u7aef\u70b9. \u7136\u540e\u53e6\u4e00\u4e2a\u9650\u5236\u662f\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7 $L+1$\uff0c\u8fd9\u4e2a\u4e5f\u6bd4\u8f83\u663e\u7136\uff0c\u5947\u5076\u5206\u7c7b\u8ba8\u8bba\u5373\u53ef. \u5bf9\u4e8e $S$ \u4e2d\u7684\u5176\u4ed6 $R$ \u6781\u957f\u8fde\u7eed\u6bb5\u4e5f\u6709\u7c7b\u4f3c\u7684\u9650\u5236\uff0c\u5373\u5982\u679c\u67d0\u4e2a\u8fde\u7eed\u6bb5\u540e\u9762\u8fd8\u6709 $B$ \u5e76\u4e14\u957f\u5ea6\u4e3a\u5947\u6570\u90a3\u4e48\u73af\u4e2d\u7684\u6781\u957f $R$ \u8fde\u7eed\u6bb5\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7\u5b83. \u6709\u4e86\u8fd9\u4e9b\u9650\u5236\u4e4b\u540e\u53ef\u4ee5\u76f4\u63a5 dp\uff0c\u628a\u4e00\u4e2a $B$ \u548c\u540e\u9762\u8ddf\u7740\u7684\u6781\u957f $R$ \u8fde\u7eed\u6bb5\u653e\u5728\u4e00\u8d77\uff0c\u90a3\u4e48\u6bcf\u4e00\u6bb5\u957f\u5ea6\u90fd\u662f\u5076\u6570\uff0c\u5e76\u4e14\u957f\u5ea6\u6709\u4e0a\u754c\uff0c\u8f6c\u79fb\u53ef\u4ee5\u524d\u7f00\u548c\u4f18\u5316. \u6ce8\u610f\u53ef\u4ee5\u65cb\u8f6c\uff0c\u6240\u4ee5\u65b9\u6848\u6570\u8fd8\u8981\u4e58\u4e0a\u7b2c\u4e00\u6bb5\u7684\u957f\u5ea6\uff0c\u8fd9\u53ef\u4ee5\u5728 dp \u521d\u503c\u4e2d\u4f53\u73b0.\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nconst int mod=1000000007,N=5e5;\nint f[N],p[N],nxt[N],n,m;\nchar st[N];\nint qmod1(int x){return x>=mod?x-mod:x;}\nint qmod2(int x){return x+(x>>31&mod);}\nvoid solve1()\n{\n    f[0]=1,f[1]=2;\n    if(n==1){cout<<1<<endl;return;}\n    if(n==2){cout<<3<<endl;return;}\n    for(int i=2;i<=n;i++)f[i]=qmod1(f[i-1]+f[i-2]);\n    cout<<qmod1(f[n-1]+f[n-3])<<endl;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    scanf(\"%s\",st+1);\n    for(int i=1;i<=m;i++)p[i]=st[i]=='R';\n    if(!p[1])for(int i=1;i<=m;i++)p[i]^=1;\n    nxt[m+1]=m+1;for(int i=m;i>=1;i--)if(!p[i])nxt[i]=i;else nxt[i]=nxt[i+1];\n    if(nxt[1]==m+1){solve1();return 0;}\n    if(n&1){puts(\"0\");return 0;}\n    int mi=n;\n    for(int i=1;i<=m;i++)\n        if(nxt[i]!=m+1&&!p[i-1])\n        {\n            int len=nxt[i]-i;\n            if(len&1)mi=min(mi,len);\n        }\n    mi=min(mi,nxt[1]);\n    if(~mi&1)--mi;\n    n>>=1;mi=(mi+1)>>1;\n    int s=0;\n    for(int i=1;i<=n;i++)\n    {\n        if(i>mi)s=qmod2(s-f[i-mi-1]);\n        f[i]=s;if(i<=mi)f[i]=qmod1(f[i]+i*2);\n        s=qmod1(s+f[i]);\n    }\n    cout<<f[n]<<endl;\n}\n```",
        "postTime": 1605604715,
        "uid": 22136,
        "name": "qwaszx",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 AT4928 \u3010[AGC033E] Go around a Circle\u3011"
    },
    {
        "content": "### \u524d\u8a00\n\n\u600e\u4e48\u9898\u89e3\u91cc\u5168\u662f dp\u3002\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u6bd4\u8f83\u5957\u8def\u7684 GF \u505a\u6cd5\u3002\n\n### \u601d\u8def\n\n\u4e0d\u59a8\u603b\u662f\u4ee4\u7b2c\u4e00\u9879\u4e3a $\\tt R$\u3002\u5219\uff0c\u8bf4\u660e\u5f27\u4e0a\u4e0d\u5b58\u5728\u76f8\u90bb\u7684 $\\tt B$\u3002\n\n\u5982\u679c\u4e32 $S$ \u4ec5\u7531 $\\tt R$ \u6784\u6210\uff0c\u5219\u65b9\u6848\u6570\u5373\u4e3a\u4e0d\u5b58\u5728\u76f8\u90bb $\\tt B$ \u7684\u65b9\u6848\u6570\u3002\u8fd9\u4e2a\u7b54\u6848\u663e\u7136\u5c31\u662f $\\sum_k\\binom{n-k}{k}+\\sum_k\\binom{n-k-2}{k}$\u3002\n\n\u5426\u5219\uff0c\u73af\u4e0a\u65e2\u6709 $\\tt B$ \u53c8\u6709 $\\tt R$\uff0c\u4e0d\u59a8\u5047\u8bbe\u6709 $k$ \u4e2a $\\tt B$\uff0c\u800c $\\tt R$ \u6784\u6210\u7684\u8054\u901a\u5757\u5927\u5c0f\u4f9d\u6b21\u4e3a $a_1,a_2,\\dots,a_k$\uff0c\u4f7f\u5f97 $a_i\\ge1\\land\\sum a=n-k$\uff0c\u4e14\u8be5\u5e8f\u5217\u82e5\u5408\u6cd5\uff0c\u5219\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a\u6070 $\\frac{n}{k}$ \u4efd\u3002\n\n\u8003\u8651\u600e\u6837\u7684\u5e8f\u5217\u662f\u5408\u6cd5\u7684\u3002\n\n\u5047\u8bbe $S$ \u4e32\u4e2d\u6709 $t$ \u4e2a $\\tt B$\uff0c\u5176\u628a $\\tt R$ \u5e8f\u5217\u5206\u6210\u4e86 $c_0\\sim c_t$ \u5404\u6bb5\uff0c\u5176\u4e2d $c\\ge0$\u3002\n\n\u9996\u5148\uff0c\u663e\u7136\u6709 $a\\le c_0+1\\land2\\nmid a$\uff0c\u800c $c_t$ \u5bf9\u7b54\u6848\u6ca1\u6709\u5f71\u54cd\u3002\n\n\u7136\u540e\uff0c\u5982\u679c\u6709 $2\\nmid c_j(1\\le j\\le t-1)$\uff0c\u5219\u8bf4\u660e\u8be5\u6b65\u5fc5\u7136\u8d70\u5230\u4e86\u4e0b\u4e00\u4e2a\uff08\u76f8\u5bf9\u4e8e\u4e0a\u4e00\u4e2a\uff09$\\tt R$ \u8054\u901a\u5757\uff0c\u4e14\u5f53\u524d $a\\le c$\uff1b\u5982\u679c $2|c_j(1\\le j\\le t-1)$\uff0c\u5219\u8be5\u6b65\u5fc5\u7136\u662f\u5f80\u56de\u6298\u8fd4\u7684\uff0c\u800c\u6ca1\u6709\u5176\u4f59\u9650\u5236\u3002\n\n\u7531\u4e8e\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9 $a$\uff0c\u7b2c\u4e00\u6b65\u5411\u5de6 / \u5411\u53f3\u8d70\u90fd\u662f\u8981\u505a\u5230\u53ef\u884c\u7684\uff0c\u6240\u4ee5\u6bcf\u79cd\u8def\u7ebf\u5e26\u6765\u7684\u9650\u5236\u90fd\u662f\u8981\u88ab\u8ba1\u5165\u7684\uff1b\u4e14\u5bb9\u6613\u53d1\u73b0\u6ca1\u6709\u591a\u4f59\u7684\u9650\u5236\u3002\n\n\u6240\u4ee5\u5176\u5b9e\u603b\u7684\u9650\u5236\u5c31\u662f\n\n$$2\\nmid a$$\n\n$$1\\le a\\le\\min\\{c_0+[2|c_0],\\min_{0<j<t,2\\nmid c_j}c_j\\}$$\n\n$$\\sum a=n-k$$\n\n\u8fd9\u6837\u7684\u65b9\u6848\u6709\u51e0\u79cd\u5462\uff1f\u8bbe\n\n$$a=1+2b$$\n\n\u5219\n\n$$0\\le b\\le\\frac{\\min\\{c_0+[2|c_0],\\min_{0<j<t,2\\nmid c_j}c_j\\}-1}{2}$$\n\n$$\\sum b=\\frac{n}{2}-k$$\n\n\u8bbe $d=\\frac{\\min\\{c_0+[2|c_0],\\min_{0<j<t,2\\nmid c_j}c_j\\}-1}{2}$\uff0c\u5219\u65b9\u6848\u6570\u5373\n\n$$[z^{n/2-k}] (\\frac{1-z^{d+1}}{1-z})^k$$\n\n\u4ece\u800c\u7b54\u6848\u5373\u4e3a\n\n$$\nn[z^{n/2}]\\sum_k\\frac{(z\\frac{1-z^{d+1}}{1-z})^k}{k}\n\\\\=n[z^{n/2}]\\ln\\frac{1}{1-z\\frac{1-z^{d+1}}{1-z}}\n$$\n\n~~\u4f7f\u7528 MTT \u5373\u53ef\u505a\u5230 $O(n\\log n)$\u3002~~\n\nMTT \u592a\u6df7\u4e71\u90aa\u6076\u4e86\uff0c\u8003\u8651\u9633\u95f4\u4e00\u70b9\u7684\u63a8\u5bfc\u3002\n\n$$\nn[z^{n/2}]\\ln\\frac{1}{1-z\\frac{1-z^{d+1}}{1-z}}\n\\\\=2[z^{n/2-1}] (\\ln\\frac{1}{1-z\\frac{1-z^{d+1}}{1-z}})'\n\\\\=2[z^{n/2-1}]\\frac{1-(d+2)z^{d+1}+(d+1)z^{d+2}}{1-3z+2z^2+z^{d+2}-z^{d+3}}\n$$\n\n\u7531\u4e8e\u5206\u6bcd\u7684\u975e $0$ \u9879\u5f88\u5c11\uff0c\u76f4\u63a5\u9012\u63a8\u5373\u53ef\u3002\n\n\u603b\u590d\u6742\u5ea6 $O(n+m)$\u3002\n\n### Code\n\n\u4ee3\u7801\u5f88\u597d\u5199\u3002\n\n```cpp\nconst ullt Mod=1e9+7;\ntypedef ConstMod::mod_ullt<Mod>modint;\ntypedef std::vector<modint>modvec;\nint main()\n{\n#ifdef MYEE\n    freopen(\"QAQ.in\",\"r\",stdin);\n    freopen(\"QAQ.out\",\"w\",stdout);\n#endif\n    std::vector<uint>V{0};\n    uint n;scanf(\"%u\",&n);\n    {\n        chr c;\n        do c=getchar();while(c!='R'&&c!='B');\n        chr o=c;\n        do\n        {\n            if(o==c)V.back()++;else V.push_back(0);\n            c=getchar();\n        }\n        while(c=='R'||c=='B');\n        V.pop_back();\n    }\n    if(V.empty())\n    {\n        modint a(2),b(1);\n        while(n--)std::swap(a+=b,b);\n        a.println();return 0;\n    }\n    if(n&1)return puts(\"0\"),0;\n    uint d=V[0]/2;for(auto s:V)if(s&1)_min(d,s/2);\n    static modint P[100005];\n    P[0]=1,P[d+1]=-modint(d+2),P[d+2]=d+1;\n    for(uint i=1;i<n/2;i++)\n    {\n        P[i]+=3*P[i-1];\n        if(i>=2)P[i]-=2*P[i-2];\n        if(i>=d+2)P[i]-=P[i-d-2];\n        if(i>=d+3)P[i]+=P[i-d-3];\n    }\n    (P[n/2-1]*2).println();\n    return 0;\n}\n```\n",
        "postTime": 1682401496,
        "uid": 105050,
        "name": "myee",
        "ccfLevel": 7,
        "title": "agc033_e"
    },
    {
        "content": "\u8bbe\u7ed9\u5b9a\u5b57\u7b26\u4e32\u4e3a $S$\uff0c\u6784\u9020\u4e32\u4e3a $T$\u3002\n\n\u4e0d\u59a8\u8bbe $S_1=R$\uff0c\u82e5\u4e3a $B$\uff0c\u5219\u53d6\u53cd\u6574\u4e2a $S$\uff0c\u4e24\u4e32\u7b49\u4ef7\u3002\n\n\u6b64\u65f6 $T$ \u4e2d\u663e\u7136\u4e0d\u80fd\u5b58\u5728\u76f8\u90bb\u7684 $B$\uff0c\u5426\u5219\u53ea\u9700\u8981\u5728\u5f00\u59cb\u65f6\u5c06\u68cb\u5b50\u653e\u5728 $B$ \u4e4b\u95f4\u5373\u53ef\u4f7f\u5f97 $S_1$ \u65e0\u6cd5\u53d6\u5f97\u3002\u7531\u6b64\u53ef\u77e5 $T$ \u4e00\u5b9a\u662f\u7531\u82e5\u5e72\u4e2a\u300c\u8fde\u7eed $R$ \u52a0\u5355\u72ec $B$\u300d \u7ec4\u6210\u7684\u3002\n\n\u8003\u8651\u7b56\u7565\u4f1a\u662f\u600e\u6837\u7684\uff0c\u8bbe\u521d\u59cb\u653e\u68cb\u5b50\u7684\u4f4d\u7f6e\u5de6\u4fa7\u6709 $x$ \u4e2a $R$\uff0c\u53f3\u4fa7\u6709 $y$ \u4e2a $R$\uff0c\u5219\u5982\u679c\u5f53\u524d $S$ \u5f00\u5934\u4e00\u6bb5 $R$ \u957f\u5ea6\u4e3a\u5947\u6570 $k$\uff0c\u6211\u4eec\u4f1a\u6311 $x,y$ \u4e2d\u4e3a\u5947\u6570\u4e14\u4e0d\u5927\u4e8e $k$ \u7684\u4e00\u4e2a\u4f5c\u4e3a\u65b9\u5411\u524d\u8fdb\uff0c\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u5728\u8d70\u5b8c\u8fd9\u6bb5 $S$ \u4e2d\u7684 $R$ \u4e4b\u524d\u8d70\u5230\u68cb\u5b50\u6240\u5728 $R$ \u6bb5\u7684\u8fb9\u754c\uff0c\u4e14\u5728\u8d70\u5b8c\u65f6\u521a\u597d\u5728\u8fb9\u754c\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u8981\u505a\u51fa\u4e24\u4e2a\u9650\u5236\uff1a\n\n- $T$ \u4e2d\u6bcf\u4e00\u6bb5 $R$ \u7684\u957f\u5ea6\u5fc5\u987b\u4e3a\u5947\u6570\uff0c\u5426\u5219\u65e0\u6cd5\u4fdd\u8bc1 $x,y$ \u5947\u5076\u6027\u4e0d\u540c\uff0c\u5bfc\u81f4\u6709\u90e8\u5206\u521d\u59cb\u4f4d\u7f6e\u65e0\u6cd5\u9009\u62e9\u5947\u5076\u6027\u6b63\u786e\u7684\u65b9\u5411\u3002\n- $T$ \u4e2d\u6bcf\u4e00\u6bb5 $R$ \u7684\u957f\u5ea6\u5fc5\u987b\u4e0d\u5927\u4e8e $k$\uff08\u5177\u4f53\u6765\u8bf4\uff0c\u5f53 $k$ \u4e3a\u5947\u6570\u65f6\uff0c\u4e0d\u5927\u4e8e $k$\uff0c\u5f53 $k$ \u4e3a\u5076\u6570\u65f6\uff0c\u4e0d\u5927\u4e8e $k+1$\uff09\uff0c\u5426\u5219\u65e0\u6cd5\u8d70\u5230\u8fb9\u754c\u3002\n\n\u9664\u6b64\u4e4b\u5916\uff0c\u53d1\u73b0\u6211\u4eec\u6bcf\u6b21\u8d70\u5b8c $S$ \u4e2d\u7684\u4e00\u6bb5 $B$ \u540e\u8d70\u5230\u4e00\u6bb5\u65b0\u7684 $R$ \u65f6\uff0c\u82e5\u8be5 $R$ \u6bb5\u4e3a\u5076\u6570\uff0c\u5219\u663e\u7136\u68cb\u5b50\u53ef\u4ee5\u5de6\u53f3\u6a2a\u8df3\uff0c\u5bf9\u5176\u6ca1\u6709\u4efb\u4f55\u9650\u5236\uff1b\u82e5\u4e3a\u5947\u6570 $k$\uff0c\u5219\u8fd8\u9700\u6ee1\u8db3 $T$ \u4e2d\u6240\u6709 $R$ \u6bb5\u957f\u5ea6\u90fd\u4e0d\u5927\u4e8e $k$\u3002\n\n\u6ce8\u610f\u6b64\u65f6\u6211\u4eec\u6709\u4e00\u70b9\u9700\u8981\u7279\u6b8a\u5224\u65ad\uff0c\u5373\u5f53 $S$ \u4e2d\u5168\u4e3a $R$ \u65f6\uff0c\u7531\u4e8e\u65e0\u9700\u8d70\u5230 $R$ \u6bb5\u8fb9\u754c\uff0c\u6545\u6ca1\u6709\u4efb\u4f55\u9650\u5236\uff0c\u5355\u72ec\u505a dp \u8ba1\u6570\u6709\u591a\u5c11\u73af\u7531\u82e5\u5e72\u65e0\u9650\u5236 $R$ \u6bb5\u548c\u5355\u72ec $B$ \u7ec4\u6210\u5373\u53ef\u3002\n\n\u800c\u5bf9\u4e8e\u975e\u5168 $R$ \u7684\u60c5\u51b5\uff0c\u6211\u4eec\u5148\u7efc\u4e0a\u6240\u8ff0\u627e\u5230 $R$ \u6bb5\u957f\u5ea6\u7684\u4e0a\u754c\uff0c\u7136\u540e\u8bbe $dp_i$ \u8868\u793a\u72b6\u6001\uff0c\u679a\u4e3e\u6700\u540e\u4e00\u6bb5\u6bb5\u957f\u8f6c\u79fb\u5373\u53ef\uff0c\u6ce8\u610f\u7531\u4e8e\u4e24\u79cd\u65b9\u6848\u65cb\u8f6c\u540e\u76f8\u540c\u4e0d\u7b97\u4e00\u79cd\u65b9\u6848\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u5c06\u6bcf\u4e00\u79cd\u65b9\u6848\u4e58\u4e0a\u5f00\u5934\u6bb5\u7684\u957f\u5ea6\u3002\n\n**\u672c\u9898\u518d\u6b21\u542f\u53d1\u6211\u4eec\u5728\u65e0\u4ece\u4e0b\u624b\u65f6\uff0c\u8981\u4ed4\u7ec6\u5206\u6790\u9898\u76ee\u6027\u8d28\uff0c\u901a\u8fc7\u589e\u52a0\u9650\u5236\u51cf\u5c11\u51b3\u7b56\u7684\u65b9\u5f0f\uff0c\u89e3\u51b3\u8f6c\u5316\u540e\u7684\u95ee\u9898\u3002**\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=2e5+5;\nconst int mod=1e9+7;\nint n,m;\nchar s[N];\nll dp[N],sum[N],f[N][2];\nbool flag1,flag2;\nint read(){\n\tint w=0,fh=1;\n\tchar c=getchar();\n\twhile (c>'9'||c<'0'){\n\t\tif (c=='-') fh=-1;\n\t\tc=getchar();\n\t}\n\twhile (c>='0'&&c<='9'){\n\t\tw=(w<<3)+(w<<1)+(c^48);\n\t\tc=getchar();\n\t}\n\treturn w*fh;\n}\n\nint main(){\n#ifndef ONLINE_JUDGE\n\tfreopen(\"in.in\",\"r\",stdin);\n\tfreopen(\"out.out\",\"w\",stdout);\n#endif\n\tn=read(),m=read();\n    scanf(\"%s\",s+1);\n    if (s[1]=='B'){\n        for (int i=1;i<=m;i++)\n            s[i]=(s[i]=='B')?'R':'B';\n    }\n    int minn=1e9;\n    for (int i=1,len=0,hav=1;i<=m;i++){\n        if (s[i]=='B'){\n            if (len&1||hav) minn=min(minn,len);\n            len=0,hav=0;\n        }else ++len;\n        if (s[i]=='B') flag1=1;\n        else if (s[i]=='R') flag2=1;\n    }\n    if (!flag1||!flag2){\n        ll ans=0;\n        f[1][0]=1;\n        for (int i=2;i<=n;i++)\n            f[i][0]=(f[i-1][0]+f[i-1][1])%mod,f[i][1]=f[i-1][0];\n        ans=(f[n][0]+f[n][1])%mod;\n        f[1][0]=0,f[1][1]=1;\n        for (int i=2;i<=n;i++)\n            f[i][0]=(f[i-1][0]+f[i-1][1])%mod,f[i][1]=f[i-1][0];\n        ans=(ans+f[n][0])%mod;\n        cout<<ans<<\"\\n\";\n        return 0;\n    }\n    if (n&1){\n        puts(\"0\");\n        return 0;\n    }\n    n/=2,minn=minn/2+1;\n    for (int i=1;i<=minn;i++) dp[i]=2*i;\n    for (int i=1;i<=n;i++){\n        dp[i]=(dp[i]+sum[i-1])%mod;\n        if (i-minn-1>=0) dp[i]=(dp[i]-sum[i-minn-1]+mod)%mod;\n        sum[i]=(sum[i-1]+dp[i])%mod;\n        // cout<<dp[i]<<\"\\n\";\n    }\n    cout<<dp[n]<<\"\\n\";\n\treturn 0;\n}\n```",
        "postTime": 1682081903,
        "uid": 257621,
        "name": "\u7ffc\u5fb7\u5929\u5c0a",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 [AGC033E] Go around a Circle"
    },
    {
        "content": "\u4e0d\u59a8\u4ee4 $S_1=\\mathtt R$\uff0c\u7136\u540e\u76f8\u5e94\u5730\u6539\u53d8\u5176\u5b83 $S_i$\u3002\u82e5\u6240\u6709 $S_i$ \u90fd\u4e3a $\\mathtt R$\uff0c\u5219\u4e0d\u80fd\u5b58\u5728\u8fde\u7eed\u7684\u4e24\u4e2a $\\mathtt B$\uff0c\u4e0d\u96be\u7528\u4e00\u4e2a\u7b80\u5355\u7684 DP \u6c42\u51fa\u3002\u5426\u5219\u5fc5\u987b\u5b58\u5728\u81f3\u5c11\u4e00\u4e2a $\\mathtt B$\uff0c\u4f46\u6bcf\u4e2a $\\mathtt B$ \u6bb5\u4e5f\u4e0d\u80fd\u8fde\u7eed\u8d85\u8fc7 $2$ \u4e2a\u3002\u8003\u8651 $S$ \u4e2d\u9047\u5230\u7684\u7b2c\u4e00\u4e2a $\\mathtt B$\uff0c\u5047\u5982\u5b58\u5728\u4e00\u4e2a\u957f\u5ea6 $\\ge 2$ \u7684\u5076\u6570 $\\mathtt R$ \u6bb5\uff0c\u90a3\u5176\u4e2d\u5fc5\u7136\u540c\u65f6\u5b58\u5728\u5230\u8fb9\u754c\u5747\u4e3a\u5947\u6570\u6216\u5747\u4e3a\u5076\u6570\u7684\u68cb\u5b50\u7684\u8d77\u59cb\u70b9\uff0c\u6545\u5728\u67d0\u4e00\u6b65\u65f6\u8981\u4e48\u5947\u6570\u6ca1\u6cd5\u5230\u8fbe\uff0c\u8981\u4e48\u5076\u6570\u7684\u6ca1\u6cd5\u5230\u8fbe\u3002\u6240\u4ee5\u73af\u4e0a\u4e0d\u53ef\u80fd\u51fa\u73b0\u957f\u5ea6 $\\ge 2$ \u7684\u4e3a\u5076\u6570\u7684\u6bb5\u3002\u7136\u540e\u8003\u8651\u8fd9\u4e9b\u5947\u6570\u6bb5\u7684\u957f\u5ea6\u90fd\u8981\u591a\u957f\uff0c\u6ce8\u610f\u5230\u4ee5\u540e\u5982\u679c $S$ \u6709\u4e2a\u6781\u957f\u5947\u6570 $\\mathtt R$ \u6bb5\uff0c\u5728\u7ecf\u8fc7\u8fd9\u4e2a $\\mathtt R$ \u540e\uff0c\u67d0\u4e2a\u4f4d\u4e8e\u4e00\u7aef\u7684\u68cb\u5b50\u5fc5\u987b\u79fb\u52a8\u5230\u5f53\u524d\u6240\u5904\u73af\u4e0a\u5947\u6570\u6bb5\u7684\u53e6\u4e00\u7aef\uff0c\u5426\u5219\u5fc5\u987b\u56de\u5230\u539f\u70b9\uff0c\u4e8e\u662f\u8bb0 $L$ \u4e3a\u5f00\u5934\u7684 $\\mathtt R$ \u6bb5\u548c\u6240\u6709\u5947\u6570 $\\mathtt R$ \u6bb5\u7684\u6700\u5c0f\u503c\uff0c\u5219\u6240\u6709\u73af\u4e0a\u7684 $\\mathtt R$ \u6bb5\u7684\u957f\u5ea6\u5fc5\u987b $\\ge L$\u3002\n\n\u4e0d\u59a8\u89c6 $\\mathtt {BRRR\\cdots R}$ \u4e3a\u4e00\u6574\u6bb5\uff0c\u90a3\u4e48\u6bcf\u4e00\u6bb5\u5fc5\u7136\u957f\u5ea6\u4e3a\u5076\u6570\uff0c\u8bb0\u4e3a $2l$\uff0c\u6240\u4ee5\u82e5 $2\\nmid N$ \u5219\u7b54\u6848\u7b49\u4e8e $0$\uff0c\u5219\u6211\u4eec\u8981\u5c06 $n=N/2$ \u4e2a\u6709\u6807\u53f7\u5143\u7d20\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u6bb5\uff0c\u4f7f\u5f97\u6bcf\u6bb5\u957f\u5ea6 $l\\le L'=\\lfloor L/2\\rfloor + 1$\uff0c\u6211\u4eec\u5c06\u9996\u4e2a\u4f4d\u7f6e\u94a6\u5b9a\u4e3a $\\mathtt B$\uff0c\u7136\u540e\u6700\u540e\u7ed9\u7b54\u6848\u4e58\u4e0a\u7b2c\u4e00\u6bb5\u7684\u957f\u5ea6\u5373\u4e3a\u6240\u6c42\uff0c\u8bb0 $f_i$ \u8868\u793a\u524d $i$ \u4e2a\u4f4d\u7f6e\u5212\u5206\u6210\u82e5\u5e72\u5b8c\u6574\u7684\u6bb5\u7684\u65b9\u6848\u6570\uff0c\u679a\u4e3e\u6700\u540e\u4e00\u6bb5\u7684\u957f\u5ea6\u5373\u53ef\u8f6c\u79fb\uff0c\u4e0d\u96be\u7528\u524d\u7f00\u548c\u4f18\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(N)$\u3002\n\n```cpp\nconst int N = 2e5 + 5, MOD = 1e9 + 7;\n\nint n, _m, m, L, pre[N], f[N], d[N];\nchar _s[N], s[N];\n\nint main() {\n\trd(n, _m); L = n;\n\tscanf(\"%s\", _s + 1);\n\tbool flag = true;\n\tfor(int i = 1; i <= _m; ++i) {\n\t\tif(_s[i] == _s[1]) s[++m] = 'R';\n\t\telse {\n\t\t\tif(!m || s[m] != 'B') s[++m] = 'B';\n\t\t\tflag = false;\n\t\t}\n\t\tif(m) pre[m] = s[m - 1] == s[m] ? pre[m - 1] : m;\n\t\telse pre[m] = 1;\n\t\tif(m > 1 && s[m] == 'B' && s[m - 1] == 'R' && (m - pre[m - 1]) % 2)\n\t\t\tL = std::min(L, m - pre[m - 1]);\n\t}\n\tfor(int i = 1; i <= m; ++i)\n\t\tif(s[i] == 'B') {\n\t\t\tL = std::min(L, i - 1 + (i % 2 == 1));\n\t\t\tbreak;\n\t\t}\n\tif(flag) {\n\t\tf[0] = 1; f[1] = 1;\n\t\tfor(int i = 2; i <= n; ++i)\n\t\t\tf[i] = (f[i - 1] + f[i - 2]) % MOD;\n\t\tint ans = (f[n] + f[n - 1] - (n >= 3 ? f[n - 3] : 0) + MOD) % MOD;\n\t\tprintf(\"%d\\n\", ans);\n\t\tcontinue;\n\t}\n\tif(n % 2 != 0) {\n\t\tprintf(\"0\\n\");\n\t\treturn 0;\n\t}\n\tn /= 2;\n\tL = (L + 1) / 2;\n\tfor(int i = 1; i <= L; ++i) f[i] = 2 * i;\n\tfor(int i = 1; i <= n; ++i) {\n\t\td[i] = (d[i] + d[i - 1]) % MOD;\n\t\tf[i] = (f[i] + d[i]) % MOD;\n\t\td[i + 1] = (d[i + 1] + f[i]) % MOD;\n\t\td[i + L + 1] = (d[i + L + 1] - f[i] + MOD) % MOD;\n\t}\n\tprintf(\"%d\\n\", f[n]);\n\treturn 0;\n}\n```",
        "postTime": 1648433677,
        "uid": 34238,
        "name": "zhylj",
        "ccfLevel": 9,
        "title": "AGC 033E"
    }
]
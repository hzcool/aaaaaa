[
    {
        "content": "## Description\n\n[link](https://www.luogu.com.cn/problem/AT_arc144_d)\n\n## Solution\n\n\u7531\u4e8e\u4e8c\u8fdb\u5236\u53ef\u4ee5\u7b49\u4ef7\u4e8e\u4e00\u4e2a\u96c6\u5408\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a $f$ \u770b\u4f5c\u4e00\u4e2a\u6709\u5173\u96c6\u5408\u7684\u51fd\u6570\u3002\n\n\u8bbe $f(\\emptyset)=c$\uff0c$f(\\{i\\})=A_i$\u3002\u5f53 $s=\\{b_1,b_2,...,b_k\\}$ \u4e0e $\\{b_{k+1}\\}$ \u4e0d\u76f8\u4ea4\uff0c\u90a3\u4e48 $f(\\{b_1,b_1,...,b_{k+1}\\})+f(\\emptyset)=f(s)+f(\\{b_{k+1}\\})$\u3002\n\n\u6240\u4ee5 $f(\\{b_1,b_2,...,b_{k+1}\\})=\\sum_{i=1}^{k+1}{A_{b_i}})-ck$\u3002\n\n\u8bbe $x_i=A_i-k$\uff0c\u90a3\u4e48 $f(s)=\\sum_{i\\in s}{x_i}-k$\u3002\n\n\u90a3\u4e48 $0\\leq a_i\\leq k$ \u8fd9\u4e2a\u6761\u4ef6\u5c31\u7b49\u4ef7\u4e8e\u6240\u6709 $f$ \u51fd\u6570\u503c $\\in [0,k]$\uff0c\u5047\u8bbe $X$ \u662f\u6240\u6709  $x_i$ \u4e2d\u8d1f\u6570\u7684\u548c\uff0c$Y$ \u662f\u6b63\u6570\u7684\u548c\u3002\n\n\u90a3\u4e48 $X+c\\geq 0,Y+c\\leq k$\uff0c\u6240\u4ee5 $c\\in [-X,k-Y]$\uff0c$c$ \u5c31\u6709 $\\max\\{k+1-Y+X,0\\}$ \u79cd\u53d6\u503c\uff0c\u6ce8\u610f\u5230 $X-Y$ \u662f $\\sum{|x_i|}$\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u51b3\u5b9a $x$  \u7684\u7edd\u5bf9\u503c\u4e4b\u548c\u5373\u53ef\u3002\n\n---\n\n\u8003\u8651\u679a\u4e3e\u7edd\u5bf9\u503c\u4e0d\u4e3a $0$ \u7684\u5143\u7d20\u4e2a\u6570\uff0c\u8bbe\u6709 $i$ \u4e2a\u3002\n\n\u9009\u51fa\u8fd9 $i$ \u4e2a\u6570\u6709 $C_{n}^{i}$ \u79cd\uff0c\u6b63\u8d1f\u6709 $2^{i}$ \u79cd\uff0c\u5185\u90e8\u7684\u65b9\u6848\u6570\u6709 $\\sum\\limits_{s=n}^{k+1}{C_{s-1}^{n-1}\\cdot s}$\u3002\n\n\u628a\u6700\u540e\u90a3\u4e2a\u5f0f\u5b50\u5316\u7b80\u4e00\u4e0b\uff1a\n$$\n\\begin{aligned}\n&\\sum_{s=n}^{k+1}{C_{s-1}^{i-1}\\cdot s}\\\\\n=&(k+1)\\sum_{s=i-1}^{k}{C_{s}^{i-1}}-\\sum_{s=i}^{k+1}{C_{s-1}^{i-1}\\cdot s}\\\\\n=&(k+1)\\cdot C_{k+1}^{i}-\\sum_{s=i}^{k+1}{i\\cdot C_{s}^{i}}\\\\\n=&(k+1)\\cdot C_{k+1}^{i}-i\\cdot C_{k+2}^{i+1}\\\\\n=&\\dfrac{(k+1)!\\cdot (k+1)}{i!\\cdot (k+1-i)!}-\\dfrac{(k+2)!\\cdot i}{(i+1)!\\cdot (k+1-i)!}\\\\\n=&\\dfrac{(i+1)\\cdot (k+1)\\cdot (k+1)!-i\\cdot (k+2)!}{(i+1)!\\cdot (k-i+1)!}\\\\\n=&\\dfrac{(k+1)!\\cdot (k-i+1)}{(i+1)!\\cdot (k-i+1)!}\\\\\n=&\\dfrac{(k+1)!}{(i+1)!\\cdot (k-i)!}\\\\\n=&C_{k+1}^{i+1}\n\\end{aligned}\n$$\n\n\n\u6240\u4ee5\u7b54\u6848\u5c31\u662f $\\sum_{i=0}^{n}{2^i C_{n}^{i}C_{k+1}^{i+1}}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n)$\u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\n\n#define int long long\n\nusing namespace std;\n\nconst int kMaxN = 3e5 + 5, kMod = 998244353;\n\nint n, k;\nint fac[kMaxN], ifac[kMaxN], inv[kMaxN], pw[kMaxN];\n\nint C(int m, int n) {\n  return 1ll * fac[m] * ifac[n] % kMod * ifac[m - n] % kMod;\n}\n\nsigned main() {\n#ifdef ORZXKR\n  freopen(\"in.txt\", \"r\", stdin);\n  freopen(\"out.txt\", \"w\", stdout);\n#endif\n  ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n  cin >> n >> k;\n  fac[0] = ifac[0] = fac[1] = ifac[1] = inv[1] = 1;\n  pw[0] = 1, pw[1] = 2;\n  for (int i = 2; i <= n + 1; ++i) {\n    inv[i] = (-1ll * (kMod / i) * inv[kMod % i] % kMod + kMod) % kMod;\n    fac[i] = 1ll * fac[i - 1] * i % kMod;\n    ifac[i] = 1ll * ifac[i - 1] * inv[i] % kMod;\n    pw[i] = 2ll * pw[i - 1] % kMod;\n  }\n  k %= kMod;\n  int ans = 0, now = k + 1;\n  for (int i = 0; i <= n; ++i) {\n    ans = (ans + 1ll * now * ifac[i + 1] % kMod * pw[i] % kMod * C(n, i) % kMod) % kMod;\n    now = 1ll * now * ((k - i) % kMod + kMod) % kMod;\n  }\n  cout << ans << '\\n';\n  return 0;\n}\n```\n\n",
        "postTime": 1674212565,
        "uid": 176843,
        "name": "Scarab",
        "ccfLevel": 0,
        "title": "[ARC144D] AND OR Equation \u9898\u89e3"
    }
]
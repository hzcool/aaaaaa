{
    "description": "$ 2^k $ teams participate in a playoff tournament. The tournament consists of $ 2^k - 1 $ games. They are held as follows: first of all, the teams are split into pairs: team $ 1 $ plays against team $ 2 $ , team $ 3 $ plays against team $ 4 $ (exactly in this order), and so on (so, $ 2^{k-1} $ games are played in that phase). When a team loses a game, it is eliminated, and each game results in elimination of one team (there are no ties). After that, only $ 2^{k-1} $ teams remain. If only one team remains, it is declared the champion; otherwise, $ 2^{k-2} $ games are played: in the first one of them, the winner of the game \" $ 1 $ vs $ 2 $ \" plays against the winner of the game \" $ 3 $ vs $ 4 $ \", then the winner of the game \" $ 5 $ vs $ 6 $ \" plays against the winner of the game \" $ 7 $ vs $ 8 $ \", and so on. This process repeats until only one team remains.\n\nFor example, this picture describes the chronological order of games with $ k = 3 $ :\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1535D/c7e451b61d4040a41b998ad855d9eabb637fb38d.png)Let the string $ s $ consisting of $ 2^k - 1 $ characters describe the results of the games in chronological order as follows:\n\n- if $ s_i $ is 0, then the team with lower index wins the $ i $ -th game;\n- if $ s_i $ is 1, then the team with greater index wins the $ i $ -th game;\n- if $ s_i $ is ?, then the result of the $ i $ -th game is unknown (any team could win this game).\n\nLet $ f(s) $ be the number of possible winners of the tournament described by the string $ s $ . A team $ i $ is a possible winner of the tournament if it is possible to replace every ? with either 1 or 0 in such a way that team $ i $ is the champion.\n\nYou are given the initial state of the string $ s $ . You have to process $ q $ queries of the following form:\n\n- $ p $ $ c $ \u2014 replace $ s_p $ with character $ c $ , and print $ f(s) $ as the result of the query.",
    "inputFormat": "The first line contains one integer $ k $ ( $ 1 \\le k \\le 18 $ ).\n\nThe second line contains a string consisting of $ 2^k - 1 $ characters \u2014 the initial state of the string $ s $ . Each character is either ?, 0, or 1.\n\nThe third line contains one integer $ q $ ( $ 1 \\le q \\le 2 \\cdot 10^5 $ ) \u2014 the number of queries.\n\nThen $ q $ lines follow, the $ i $ -th line contains an integer $ p $ and a character $ c $ ( $ 1 \\le p \\le 2^k - 1 $ ; $ c $ is either ?, 0, or 1), describing the $ i $ -th query.",
    "outputFormat": "For each query, print one integer \u2014 $ f(s) $ .",
    "samples": [
        [
            "3\n0110?11\n6\n5 1\n6 ?\n7 ?\n1 ?\n5 ?\n1 1",
            "1\n2\n3\n3\n5\n4"
        ]
    ],
    "hint": "",
    "translation": "\u7ed9\u5b9a\u6574\u6570 $k$\uff0c\u73b0\u5728\u6709 $2^k$ \u652f\u961f\u4f0d\uff08\u7f16\u53f7\u4e3a $1$ \u5230 $2^k$\uff09\u8fdb\u884c\u5171 $2^k-1$ \u573a\u6bd4\u8d5b\uff0c\u6d41\u7a0b\u5982\u4e0b\uff1a\n\n1. \u7b2c $1$ \u652f\u4e0e\u7b2c $2$ \u652f\u8fdb\u884c\u6bd4\u8d5b\u3001\u7b2c $3$ \u652f\u4e0e\u7b2c $4$ \u652f\u8fdb\u884c\u6bd4\u8d5b\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u8fd9\u4e00\u9636\u6bb5\u603b\u5171\u8fdb\u884c _\u961f\u4f0d\u6570\u9664\u4ee5\u4e8c_ \u573a\u6bd4\u8d5b\u3002\u8fd9\u4e9b\u6bd4\u8d5b\u4e2d\u5fc5\u5b9a\u5206\u51fa\u80dc\u8d1f\uff0c\u8d1f\u65b9\u6dd8\u6c70\uff0c\u80dc\u65b9\u7ee7\u7eed\u4e0b\u4e00\u8f6e\u7684\u6bd4\u8d5b\uff1b\n2. \u91cd\u590d\u8fdb\u884c\u4e0a\u8ff0\u6b65\u9aa4\uff0c\u76f4\u5230\u53ea\u6709\u4e00\u652f\u961f\u4f0d\u6ca1\u6709\u88ab\u6dd8\u6c70\uff0c\u8fd9\u652f\u961f\u4f0d\u6210\u4e3a\u51a0\u519b\u3002\n\n\uff08\u4f9d\u636e\u539f\u9898\u76ee\u63cf\u8ff0\u4e2d\u7684\u56fe\u7247\u6765\u83b7\u5f97\u66f4\u597d\u7406\u89e3\u3002\u8be5\u56fe\u6ee1\u8db3 $k=3$\u3002\uff09  \n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $2^k-1$ \u7684\u3001\u4ec5\u5305\u542b\u5b57\u7b26 `0 1 ?` \u7684\u5b57\u7b26\u4e32 $s$\uff0c\u5177\u4f53\u7684\uff1a\n\n- \u5982\u679c $s_i=\\texttt{\"0\"}$\uff0c\u8868\u793a\u7b2c $i$ \u6b21\u6bd4\u8d5b\u4e2d\uff0c\u7f16\u53f7\u66f4\u5c0f\u7684\u961f\u4f0d\u83b7\u80dc\u3002\n- \u5982\u679c $s_i=\\texttt{\"1\"}$\uff0c\u8868\u793a\u7b2c $i$ \u6b21\u6bd4\u8d5b\u4e2d\uff0c\u7f16\u53f7\u66f4\u5927\u7684\u961f\u4f0d\u83b7\u80dc\u3002\n- \u5982\u679c $s_i=\\texttt{\"?\"}$\uff0c\u8868\u793a\u7b2c $i$ \u6b21\u6bd4\u8d5b\u4e2d\uff0c\u4efb\u610f\u4e00\u65b9\u90fd\u53ef\u80fd\u83b7\u80dc\u3002\n\n\u8bbe $f(s)$ \u8868\u793a\u6839\u636e\u5b57\u7b26\u4e32 $s$\uff0c\u6240\u6709\u53ef\u80fd\u6210\u4e3a\u51a0\u519b\u7684\u4e0d\u540c\u7684\u961f\u4f0d\u6570\u3002  \n\u7ed9\u5b9a\u67e5\u8be2\u6b21\u6570 $q$\uff0c\u6bcf\u6b21\u67e5\u8be2\u7ed9\u5b9a\u6574\u6570 $p$ \u548c\u5b57\u7b26 $c$\uff0c\u6c42\u5c06 $s$ \u7684\u7b2c $p$ \u4f4d\u4fee\u6539\u4e3a $c$ \u540e $f(s)$ \u7684\u503c\u3002  \n\u5e94\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u6b21\u8be2\u95ee\u4e4b\u95f4**\u5e76\u4e0d\u662f\u4e92\u76f8\u72ec\u7acb\u7684**\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e00\u6b21\u67e5\u8be2\u90fd\u4f1a\u5f71\u54cd\u4e4b\u540e\u7684\u67e5\u8be2\u3002  \n$1\\leq k\\leq18;|s|=2^k-1;1\\leq q\\leq2\\times10^5;1\\leq p\\leq|s|;$  \n$s,c$ \u4ec5\u5305\u542b\u5b57\u7b26 `0 1 ?`\u3002"
}
{
    "description": "You are playing yet another game where you kill monsters using magic spells. There are $ n $ cells in the row, numbered from $ 1 $ to $ n $ . Initially, the $ i $ -th cell contains the $ i $ -th monster with $ h_i $ health.\n\nYou have a basic spell that costs $ 1 $ MP and deals $ 1 $ damage to the monster you choose. You can cast it any number of times. Also, you have a special scroll with \"Explosion\" spell you can use only once. You want to finish killing monsters with explosion, that's why you, firstly, cast the basic spell several times (possibly, zero), and then after that, you cast one \"Explosion\".\n\nHow does \"Explosion\" spell work? Firstly, you choose the power of the spell: if you pour $ x $ MP into it, \"Explosion\" will deal $ x $ damage. Secondly, you choose some monster $ i $ , which will be targeted by the spell. That's what happens next:\n\n- if its current health $ h_i > x $ , then he stays alive with health decreased by $ x $ ;\n- if $ h_i \\le x $ , the $ i $ -th monster dies with an explosion that deals $ h_i - 1 $ damage to monsters in the neighboring cells $ i - 1 $ and $ i + 1 $ , if these cells exist and monsters inside are still alive;\n- if the damage dealt by the explosion is enough to kill the monster $ i - 1 $ (or $ i + 1 $ ), i. e. the current $ h_{i - 1} \\le h_i - 1 $ (or $ h_{i + 1} \\le h_i - 1 $ ), then that monster also dies creating a secondary explosion of power $ h_{i-1} - 1 $ (or $ h_{i+1} - 1 $ ) that may deals damage to their neighbors, and so on, until the explosions end.\n\nYour goal is to kill all the remaining monsters with those \"chaining\" explosions, that's why you need a basic spell to decrease $ h_i $ of some monsters or even kill them beforehand (monsters die when their current health $ h_i $ becomes less or equal to zero). Note that monsters don't move between cells, so, for example, monsters $ i $ and $ i + 2 $ will never become neighbors.\n\nWhat is the minimum total MP you need to kill all monsters in the way you want? The total MP is counted as the sum of the number of basic spells you cast and the power $ x $ of explosion scroll you've chosen.",
    "inputFormat": "The first line contains one integer $ t $ ( $ 1 \\le t \\le 10^4 $ ) \u2014 the number of test cases.\n\nThe first line of each test case contains the single integer $ n $ ( $ 1 \\le n \\le 3 \\cdot 10^5 $ ) \u2014 the number of cells in the row, i. e. the number of monsters.\n\nThe second line of each test case contains $ n $ integers $ h_1, h_2, \\dots, h_n $ ( $ 1 \\le h_i \\le 10^6 $ ) \u2014 the initial health of the monsters.\n\nIt's guaranteed that the sum of $ n $ over all test cases doesn't exceed $ 3 \\cdot 10^5 $ .",
    "outputFormat": "For each test case, print one integer \u2014 the minimum total MP you need to kill all monsters by finishing them with explosion.",
    "samples": [
        [
            "5\n3\n1 1 1\n4\n4 1 2 1\n4\n5 10 15 10\n1\n42\n9\n1 2 3 2 2 2 3 2 1",
            "3\n6\n15\n42\n12"
        ]
    ],
    "hint": "In the first test case, you can, for example, use basic spell on monsters $ 1 $ and $ 2 $ (once per monster) to kill them. After that, you cast \"Explosion\" of power $ x = 1 $ on monster $ 3 $ to kill it. The total MP you need is $ 2 + 1 = 3 $ .\n\nIn the second test case, it's optimal to cast basic spell $ 4 $ times onto monster $ 1 $ to kill it. After that, you can cast \"Explosion\" of power $ x = 2 $ onto monster $ 3 $ . It dies, creating an explosion of power $ 1 $ that kills monsters $ 2 $ and $ 4 $ . The total MP you need is $ 4 + 2 = 6 $ .\n\nIn the third test case, you cast \"Explosion\" of power $ 15 $ onto monster $ 3 $ . Explosion of the $ 3 $ -rd monster (of power $ 14 $ ) kills monsters $ 2 $ and $ 4 $ . Secondary explosion of monster $ 2 $ (of power $ 9 $ ) kills monster $ 1 $ .",
    "translation": "### \u9898\u76ee\u5927\u610f\n\n\u4f60\u5728\u73a9\u4e00\u4e2a\u5229\u7528\u9b54\u6cd5\u6740\u602a\u7269\u7684\u6e38\u620f\u3002\u5177\u4f53\u5730\uff0c\u6709\u4e00\u6392 $n$ \u4e2a\u683c\u5b50\uff0c\u7b2c $i$ \u4e2a\u683c\u5b50\u91cc\u6709\u7f16\u53f7\u4e3a $i$\u3001\u521d\u59cb\u751f\u547d\u503c\u4e3a $h_i$ \u7684\u602a\u7269\u3002\u602a\u7269\u751f\u547d\u503c\u5c0f\u4e8e\u7b49\u4e8e $0$ \u5219\u88ab\u6740\u6b7b\uff0c\u6240\u6709\u602a\u7269\u88ab\u6740\u6b7b\u5219\u6e38\u620f\u7ed3\u675f\u3002\n\n\u4f60\u6709\u4e24\u79cd\u653b\u51fb\u65b9\u5f0f\uff1a\u4e00\u79cd\u662f\u666e\u901a\u653b\u51fb\uff0c\u4f60\u5c06\u6d88\u8017 $1$ \u70b9\u80fd\u91cf\u5bf9\u9009\u4e2d\u7684\u602a\u7269\u8fdb\u884c $1$ \u70b9\u4f24\u5bb3\uff08\u4e5f\u5c31\u662f\u602a\u7269\u7684\u751f\u547d\u503c\u51cf $1$\uff09\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u666e\u901a\u653b\u51fb\u4efb\u610f\u6b21\u6570\u3002\u540c\u65f6\uff0c\u4f60\u8fd8\u53ef\u4ee5\u4f7f\u7528\u6070\u597d\u4e00\u6b21\u201c\u7206\u70b8\u201d\u653b\u51fb\u3002\u4f60\u60f3\u8981\u6e38\u620f\u4ee5\u201c\u7206\u70b8\u201d\u653b\u51fb\u7ed3\u675f\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f60\u4f1a\u5148\u8fdb\u884c\u82e5\u5e72\u6b21\u666e\u901a\u653b\u51fb\uff08\u53ef\u4ee5\u4e3a $0$ \u6b21\uff09\uff0c\u7136\u540e\u4f7f\u7528\u4e00\u6b21\u201c\u7206\u70b8\u201d\u653b\u51fb\u7ed3\u675f\u6e38\u620f\u3002\n\n\u201c\u7206\u70b8\u201d\u653b\u51fb\u7684\u673a\u5236\u5982\u4e0b\uff1a\u4f60\u53ef\u4ee5\u9009\u62e9\u6d88\u8017\u7684\u80fd\u91cf\u6570 $x$\uff0c\u7136\u540e\u9009\u4e2d\u4e00\u4e2a\u602a\u7269 $i$\uff0c\u4e4b\u540e\uff1a\n\n- \u82e5\u602a\u7269 $i$ \u5f53\u524d\u7684\u751f\u547d\u503c $h_i > x$\uff0c\u90a3\u4e48\u8be5\u602a\u7269\u751f\u547d\u503c\u51cf\u53bb $x$\uff1b\n- \u82e5 $h_i\\le x$\uff0c\u5219\u8be5\u602a\u7269\u88ab\u51fb\u6740\uff0c\u540c\u65f6\u5411\u4e24\u65c1\u7684\u602a\u7269\uff08\u5373\u7b2c $i-1$ \u548c $i+1$ \u53ea\u602a\u7269\uff0c\u5982\u679c\u6709\u4e14\u8fd8\u5b58\u6d3b\u7684\u8bdd\uff09\u9020\u6210 $h_i - 1$ \u7684\u4f24\u5bb3\uff1b\n- \u82e5 $h_i - 1$ \u7684\u4f24\u5bb3\u8db3\u4ee5\u6740\u6b7b\u7b2c $i-1$ \uff08\u6216 $i+1$\uff09\u53ea\u602a\u7269\uff0c\u5373 $h_{i-1}\\le h_i - 1$\uff08\u6216 $h_{i+1}\\le h_i - 1$\uff09\uff0c\u90a3\u4e48\u8fd9\u53ea\u602a\u7269\u540c\u6837\u88ab\u51fb\u6740\u5e76\u5411\u4e24\u65c1\u7684\u602a\u7269\u9020\u6210 $h_{i-1} - 1$\uff08\u6216 $h_{i+1} - 1$\uff09\u7684\u4f24\u5bb3\u3002\u5982\u6b64\u5faa\u73af\u53ea\u5230\u6740\u4e0d\u6b7b\u4e00\u76f4\u602a\u7269\u4e3a\u6b62\u3002\n\n\u4f60\u7684\u76ee\u6807\u5c31\u662f\u5148\u7528\u666e\u901a\u653b\u51fb\u51cf\u5c11\u67d0\u4e9b\u602a\u7269\u7684\u751f\u547d\u503c\u6216\u76f4\u63a5\u6740\u6b7b\u67d0\u4e9b\u602a\u7269\uff0c\u7136\u540e\u7528\u8fd9\u6837\u201c\u94fe\u5f0f\u201d\u7684\u201c\u7206\u70b8\u201d\u653b\u51fb\u6740\u6b7b\u6240\u6709\u602a\u7269\u3002\u6ce8\u610f\u602a\u7269\u4e0d\u4f1a\u79fb\u52a8\uff0c\u4f8b\u5982\u7b2c $i$ \u53ea\u602a\u7269\u548c\u7b2c $i+2$ \u53ea\u602a\u7269\u6c38\u8fdc\u4e0d\u4f1a\u76f8\u90bb\u3002\n\n\u4f60\u9700\u8981\u6d88\u8017\u6700\u5c11\u7684\u80fd\u91cf\u503c\u6765\u8fbe\u6210\u76ee\u6807\uff08\u5305\u62ec\u666e\u901a\u653b\u51fb\u548c\u201c\u7206\u70b8\u201d\u653b\u51fb\u7684\uff09\uff0c\u6c42\u51fa\u8fd9\u4e2a\u6700\u5c0f\u503c\u3002\n\n### \u8f93\u5165\u683c\u5f0f\n\n\u8f93\u5165\u7b2c\u4e00\u884c\u4e00\u4e2a\u6b63\u6574\u6570 $t$\uff08$1\\le t\\le 10^4$\uff09\u8868\u793a\u6d4b\u8bd5\u6570\u636e\u7ec4\u6570\u3002\n\n\u6bcf\u7ec4\u6d4b\u8bd5\u6570\u636e\u7b2c\u4e00\u884c\u4e00\u4e2a\u6b63\u6574\u6570 $n$\uff08$1\\le n\\le 3\\cdot 10^5$\uff09\u8868\u793a\u602a\u7269\u6570\u91cf\uff1b\n\n\u7b2c\u4e8c\u884c $n$ \u4e2a\u6b63\u6574\u6570 $h_1,h_2,\\ldots,h_n$\uff08$1\\le h_i\\le 10^6$\uff09\u4f9d\u6b21\u8868\u793a\u602a\u7269\u7684\u751f\u547d\u503c\u3002\n\n\u4fdd\u8bc1\u6240\u6709\u6d4b\u8bd5\u6570\u636e\u7684 $n$ \u4e4b\u548c\u4e0d\u8d85\u8fc7 $3\\cdot 10^5$\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\n\n\u8f93\u51fa\u4e00\u884c\u4e00\u4e2a\u6b63\u6574\u6570\u8868\u793a\u6740\u6b7b\u6240\u6709\u602a\u7269\u6240\u9700\u8981\u6d88\u8017\u7684\u6700\u5c0f\u80fd\u91cf\u503c\u3002"
}
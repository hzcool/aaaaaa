{
    "description": "You are given an integer array $ a_1,\\dots, a_n $, where $ 1\\le a_i \\le n $ for all $ i $.\n\nThere's a \"replace\" function $ f $ which takes a pair of integers $ (l, r) $, where $ l \\le r $, as input and outputs the pair $f((l, r))=\\left(\\min\\{a_l,a_{l+1},\\dots,a_r\\},\\max\\{a_l,a_{l+1},\\dots,a_r\\}\\right)$.\n\nConsider repeated calls of this function. That is, from a starting pair  $(l, r)$  we get  $ f((l, r)) $, then $ f(f((l, r))) $, then $ f(f(f((l,r)))) $, and so on.\n\nNow you need to answer $ q $ queries. For the $ i $-th query you have two integers $ l_i $ and $ r_i $ $(1\\le l_i\\le r_i\\le n)$. You must answer the minimum number of times you must apply the \"replace\" function to the pair $(l_i,r_i)$ to get $ (1, n) $, or report that it is impossible.",
    "inputFormat": "The first line contains two positive integers $ n $ , $ q $ ( $ 1\\le n,q\\le 10^5 $ ) \u2014 the length of the sequence $ a $ and the number of the queries.\n\nThe second line contains $ n $ positive integers $ a_1,a_2,\\ldots,a_n $ ( $ 1\\le a_i\\le n $ ) \u2014 the sequence $ a $ .\n\nEach line of the following $ q $ lines contains two integers $ l_i $ , $ r_i $ ( $ 1\\le l_i\\le r_i\\le n $ ) \u2014 the queries.",
    "outputFormat": "For each query, output the required number of times, or $ -1 $ if it is impossible.",
    "samples": [
        [
            "5 6\n2 5 4 1 3\n4 4\n1 5\n1 4\n3 5\n4 5\n2 3",
            "-1\n0\n1\n2\n3\n4"
        ],
        [
            "6 3\n2 3 4 6 1 2\n5 6\n2 5\n2 3",
            "5\n1\n3"
        ],
        [
            "5 3\n3 2 2 4 1\n2 5\n1 3\n1 5",
            "-1\n-1\n0"
        ]
    ],
    "hint": "In the first example, $ n=5 $ and $ a=[2,5,4,1,3] $ .\n\nFor the first query: $ (4,4)\\to(1,1)\\to(2,2)\\to(5,5)\\to(3,3)\\to(4,4)\\to\\ldots $ , so it's impossible to get $ (1,5) $ .\n\nFor the second query, you already have $ (1,5) $ .\n\nFor the third query: $ (1,4)\\to(1,5) $ .\n\nFor the fourth query: $ (3,5)\\to(1,4)\\to(1,5) $ .\n\nFor the fifth query: $ (4,5)\\to(1,3)\\to(2,5)\\to(1,5) $ .\n\nFor the sixth query: $ (2,3)\\to(4,5)\\to(1,3)\\to(2,5)\\to(1,5) $ .",
    "translation": "### \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u4e3a $n$ \u7684\u5e8f\u5217 $a_1,\\ldots,a_n$\uff0c\u5176\u4e2d\u5bf9\u4e8e\u4efb\u610f\u7684 $i$ \u6ee1\u8db3 $1 \\leq a_i \\leq n$\u3002\n\n\u5b9a\u4e49\u4e00\u4e2a\u4e8c\u5143\u7ec4\u51fd\u6570\u5982\u4e0b\uff1a\n$$f((l,r))=(\\min\\{a_l,\\ldots,a_r\\},\\max\\{a_l,\\ldots,a_r\\})(l \\leq r)$$\n\n\u4f60\u9700\u8981\u56de\u7b54 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u5b9a $(l_i,r_i)$\uff0c\u95ee\u5176\u6700\u5c11\u7ecf\u8fc7\u591a\u5c11\u6b21 $f$ \u7684\u8c03\u7528\uff08\u5373 $(l,r) \\rightarrow f((l,r))$\uff09\u4f7f\u5f97 $(l_i,r_i)$ \u53d8\u6210 $(1,n)$\uff0c\u82e5\u65e0\u89e3\u8bf7\u8f93\u51fa `-1`\u3002\n\n### \u8f93\u5165\u683c\u5f0f\n\n\u7b2c\u4e00\u884c\u5305\u542b\u4e24\u4e2a\u6574\u6570 $n,q(1 \\leq n,q \\leq 10^5)$\uff0c\u8868\u793a\u5e8f\u5217\u957f\u5ea6\u548c\u8be2\u95ee\u6b21\u6570\u3002\n\n\u7b2c\u4e8c\u884c\u5305\u542b $n$ \u4e2a\u6574\u6570 $a_i(1 \\leq a_i \\leq n)$\uff0c\u8868\u793a\u5e8f\u5217 $a$\u3002\n\n\u63a5\u4e0b\u6765 $q$ \u884c\u6bcf\u884c\u4e24\u4e2a\u6574\u6570 $l_i,r_i(1 \\leq l_i \\leq r_i \\leq n)$\uff0c\u8868\u793a\u6bcf\u7ec4\u8be2\u95ee\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\n\n\u5bf9\u6bcf\u4e00\u4e2a\u8be2\u95ee\uff0c\u8f93\u51fa\u5176\u6700\u5c0f\u6b21\u6570\uff0c\u6216\u65e0\u89e3\u8f93\u51fa `-1`\u3002\n\n### \u6837\u4f8b\u89e3\u91ca\n\n\u7b2c\u4e00\u4e2a\u6837\u4f8b\u4e2d\uff0c$a=\\{2,5,4,1,3\\}$\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u8be2\u95ee\uff0c$(4,4) \\rightarrow (1,1) \\rightarrow (2,2) \\rightarrow (5,5) \\rightarrow (3,3) \\rightarrow (4,4) \\rightarrow \\cdots$\uff0c\u6545\u65e0\u89e3\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u8be2\u95ee\uff0c\u5df2\u7ecf\u6709 $(l_i,r_i)=(1,n)$\uff0c\u9700\u8981 $0$ \u6b21\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u8be2\u95ee\uff0c$(1,4) \\rightarrow (1,5)$\uff0c\u9700\u8981 $1$ \u6b21\u3002\n\n\u5bf9\u4e8e\u7b2c\u56db\u4e2a\u8be2\u95ee\uff0c$(3,5) \\rightarrow (1,4) \\rightarrow (1,5)$\uff0c\u9700\u8981 $2$ \u6b21\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e94\u4e2a\u8be2\u95ee\uff0c$(4,5) \\rightarrow (1,3) \\rightarrow (2,5) \\rightarrow (1,5)$\uff0c\u9700\u8981 $3$ \u6b21\u3002\n\n\u5bf9\u4e8e\u7b2c\u516d\u4e2a\u8be2\u95ee\uff0c$(2,3) \\rightarrow (4,5) \\rightarrow (1,3) \\rightarrow (2,5) \\rightarrow (1,5)$\uff0c\u9700\u8981 $4$ \u6b21\u3002"
}
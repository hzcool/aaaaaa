{
    "description": "The only difference between easy and hard versions is the maximum values of $ n $ and $ q $ .\n\nYou are given an array, consisting of $ n $ integers. Initially, all elements are red.\n\nYou can apply the following operation to the array multiple times. During the $ i $ -th operation, you select an element of the array; then:\n\n- if the element is red, it increases by $ i $ and becomes blue;\n- if the element is blue, it decreases by $ i $ and becomes red.\n\nThe operations are numbered from $ 1 $ , i. e. during the first operation some element is changed by $ 1 $ and so on.\n\nYou are asked $ q $ queries of the following form:\n\n- given an integer $ k $ , what can the largest minimum in the array be if you apply exactly $ k $ operations to it?\n\nNote that the operations don't affect the array between queries, all queries are asked on the initial array $ a $ .",
    "inputFormat": "The first line contains two integers $ n $ and $ q $ ( $ 1 \\le n, q \\le 2 \\cdot 10^5 $ ) \u2014 the number of elements in the array and the number of queries.\n\nThe second line contains $ n $ integers $ a_1, a_2, \\dots, a_n $ ( $ 1 \\le a_i \\le 10^9 $ ).\n\nThe third line contains $ q $ integers $ k_1, k_2, \\dots, k_q $ ( $ 1 \\le k_j \\le 10^9 $ ).",
    "outputFormat": "For each query, print a single integer \u2014 the largest minimum that the array can have after you apply exactly $ k $ operations to it.",
    "samples": [
        [
            "4 10\n5 2 8 4\n1 2 3 4 5 6 7 8 9 10",
            "3 4 5 6 7 8 8 10 8 12"
        ],
        [
            "5 10\n5 2 8 4 4\n1 2 3 4 5 6 7 8 9 10",
            "3 4 5 6 7 8 9 8 11 8"
        ],
        [
            "2 5\n2 3\n10 6 8 1 3",
            "10 7 8 3 3"
        ]
    ],
    "hint": "",
    "translation": "\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a$ \uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u6709\u4e00\u4e2a\u989c\u8272\uff0c\u521d\u59cb\u5168\u4e3a\u7ea2\u8272\u3002\u7b2c $i$ \u6b21\u64cd\u4f5c\u9009\u62e9\u4e00\u4e2a\u4f4d\u7f6e $x$\uff0c\u5982\u679c\u4e3a\u7ea2\u8272\u5c31\u628a $a_x$ \u52a0 $i$ \uff0c\u5e76\u53d8\u6210\u84dd\u8272\uff0c\u5426\u5219\u628a $a_x$ \u51cf $i$ \uff0c\u5e76\u53d8\u6210\u7ea2\u8272\u3002\n\n$q$ \u6b21\u8be2\u95ee\u7ed9\u5b9a\u4e00\u4e2a $k$ \uff0c\u6c42\u6070\u597d $k$ \u6b21\u64cd\u4f5c\u540e $a$ \u5e8f\u5217\u6700\u5c0f\u503c\u7684\u6700\u5927\u503c\u3002"
}
{
    "description": "LuoTianyi is watching the anime Made in Abyss. She finds that making a Cartridge is interesting. To describe the process of making a Cartridge more clearly, she abstracts the original problem and gives you the following problem.\n\nYou are given a tree $ T $ consisting of $ n $ vertices. Each vertex has values $ a_i $ and $ b_i $ and each edge has values $ c_j $ and $ d_j $ .\n\nNow you are aim to build a tree $ T' $ as follows:\n\n- First, select $ p $ vertices from $ T $ ( $ p $ is a number chosen by yourself) as the vertex set $ S' $ of $ T' $ .\n- Next, select $ p-1 $ edges from $ T $ one by one (you cannot select one edge more than once).\n- May you have chosen the $ j $ -th edge connects vertices $ x_j $ and $ y_j $ with values $ (c_j,d_j) $ , then you can choose two vertices $ u $ and $ v $ in $ S' $ that satisfy the edge $ (x_j,y_j) $ is contained in the simple path from $ u $ to $ v $ in $ T $ , and link $ u $ and $ v $ in $ T' $ by the edge with values $ (c_j,d_j) $ ( $ u $ and $ v $ shouldn't be contained in one connected component before in $ T' $ ).\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1824E/4010695a2d14e09c089bade861d04ad57c9c8698.png) A tree with three vertices, $ \\min(A,C)=1,B+D=7 $ , the cost is $ 7 $ .  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1824E/6d1a5a3a11d6b53c0b34ce38768cf6022a42f564.png) Selected vertices $ 2 $ and $ 3 $ as $ S' $ , used the edge $ (1,2) $ with $ c_j = 2 $ and $ d_j = 1 $ to link this vertices, now $ \\min(A,C)=2,B+D=4 $ , the cost is $ 8 $ .Let $ A $ be the minimum of values $ a_i $ in $ T' $ and $ C $ be the minimum of values $ c_i $ in $ T' $ . Let $ B $ be the sum of $ b_i $ in $ T' $ and $ D $ be the sum of values $ d_i $ in $ T' $ . Let $ \\min(A, C) \\cdot (B + D) $ be the cost of $ T' $ . You need to find the maximum possible cost of $ T' $ .",
    "inputFormat": "The first line contains one integer $ n $ ( $ 3\\le n \\le 2\\cdot 10^5 $ ) \u2014 the number of vertices in the tree $ T $ .\n\nThe second line contains $ n $ integers $ a_1, a_2, \\ldots, a_n $ ( $ 1\\le a_i\\le 2\\cdot 10^5 $ ), where the $ i $ -th integer represents the $ a_i $ value of the $ i $ -th vertex.\n\nThe third line contains $ n $ integers $ b_1, b_2, \\ldots, b_n $ ( $ 1\\le b_i\\le 2\\cdot 10^5 $ ), where the $ i $ -th integer represents the $ b_i $ value of the $ i $ -th vertex.\n\nThen $ n-1 $ lines follow, the $ j $ -th of them contains four integers $ x_j,y_j,c_j,d_j $ ( $ 1\\le x_j,y_j\\le n,1\\le c_j,d_j\\le 2\\cdot 10^5 $ ) representing the edge $ (x_j,y_j) $ and its values $ c_j $ and $ d_j $ respectively. It's guaranteed that edges form a tree.",
    "outputFormat": "Print a single integer \u2014 the maximum possible cost of $ T' $ .",
    "samples": [
        [
            "3\n1 2 2\n1 1 2\n1 2 2 1\n1 3 1 2",
            "8"
        ],
        [
            "5\n2 4 2 1 1\n2 4 4 4 4\n2 5 3 3\n3 5 2 4\n4 2 5 5\n5 1 1 5",
            "35"
        ],
        [
            "6\n5 7 10 7 9 4\n6 9 7 9 8 5\n2 1 5 1\n3 2 2 4\n4 3 6 3\n5 1 7 4\n6 5 6 8",
            "216"
        ],
        [
            "5\n1000 1000 1 1000 1000\n1000 1000 1 1000 1000\n1 2 1 1\n2 3 1000 1000\n3 4 1000 1000\n3 5 1000 1000",
            "7000000"
        ]
    ],
    "hint": "The tree from the first example is shown in the statement.\n\nThe tree from the second example is shown below:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1824E/b1421c4a79f6deaad5a2fd7aeb276ff934c5ef93.png) $ A = 1, B = 18, C = 1, D = 17 $ , so the cost is $ \\min(1,1) \\cdot (18 + 17) = 35 $ .",
    "translation": "### \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a\u4e00\u68f5 $n$ \u4e2a\u7ed3\u70b9\u7684\u6811 $T$\uff0c\u70b9\u6709\u70b9\u6743 $a_i, b_i$\uff0c\u8fb9\u6709\u8fb9\u6743 $c_i, d_i$\u3002\n\n\u6309\u5982\u4e0b\u65b9\u5f0f\u6784\u5efa\u53e6\u4e00\u68f5\u6811 $T'$\uff1a\n\n- \u9009\u62e9 $T$ \u7684 $p$ \u4e2a\u7ed3\u70b9\u4f5c\u4e3a $T'$ \u7684\u70b9\u96c6 $V'$\u3002$p$ \u53ef\u4ee5\u662f $1\\sim n$ \u7684\u4efb\u610f\u6b63\u6574\u6570\u3002\n- \u63a5\u4e0b\u6765 **\u4f9d\u6b21** \u9009\u62e9 $T$ \u7684 $p - 1$ \u6761 **\u4e92\u4e0d\u76f8\u540c** \u7684\u8fb9\u3002\n- \u5bf9\u4e8e\u7b2c $i$ \u6b21\u9009\u8fb9\uff0c\u5047\u8bbe\u9009\u62e9\u7b2c $j$ \u6761\u8fb9 $(x_j, y_j)$\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u9009\u62e9 $V'$ \u7684 **\u4e0d\u8fde\u901a** \u7684\u4e24\u4e2a\u70b9 $u, v$\uff0c\u8981\u6c42 $(x_j, y_j)$ \u5305\u542b\u4e8e $u, v$ \u5728 $T$ \u4e0a\u7684\u7b80\u5355\u8def\u5f84\uff0c\u5728 $u, v$ \u4e4b\u95f4\u4ee5 $c_j, d_j$ \u4e3a\u6743\u503c\u8fde\u8fb9\u3002\n\n\u8bbe $A, C$ \u5206\u522b\u4e3a $T'$ \u7684 $a_i, c_i$ \u7684\u6700\u5c0f\u503c\uff0c$B, D$ \u5206\u522b\u4e3a $T'$ \u7684 $b_i, d_i$ \u4e4b\u548c\uff0c\u5219 $T'$ \u7684\u6743\u503c\u4e3a $\\min(A, C)\\cdot (B + D)$\u3002\n\n\u6c42 $T'$ \u7684\u6700\u5927\u6743\u503c\u3002\n\n$3\\leq n\\leq 2\\times 10 ^ 5$\uff0c$1\\leq a_i, b_i, c_i, d_i\\leq 2\\times 10 ^ 5$\uff0c\u4fdd\u8bc1 $(x_i, y_i)$ \u5f62\u6210\u4e00\u68f5\u6811\u3002\n\n### \u8f93\u5165\u683c\u5f0f\n\n\u7b2c\u4e00\u884c\u4e00\u4e2a\u6b63\u6574\u6570 $n$\u3002\n\n\u7b2c\u4e8c\u884c $n$ \u4e2a\u6b63\u6574\u6570 $a_i$\u3002\n\n\u7b2c\u4e09\u884c $n$ \u4e2a\u6b63\u6574\u6570 $b_i$\u3002\n\n\u63a5\u4e0b\u6765 $n - 1$ \u884c\uff0c\u6bcf\u884c\u56db\u4e2a\u6b63\u6574\u6570 $x_i, y_i, c_i, d_i$\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\n\n\u8f93\u51fa\u4e00\u884c\u4e00\u4e2a\u6574\u6570\u8868\u793a\u7b54\u6848 \u2014\u2014 $T'$ \u7684\u6700\u5927\u6743\u503c\u3002\n\n\u7ffb\u8bd1\u63d0\u4f9b\u8005\uff1a[Alex_Wei](https://www.luogu.com.cn/user/123294)\u3002"
}
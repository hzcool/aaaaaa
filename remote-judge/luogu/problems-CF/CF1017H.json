{
    "description": "In \"The Man in the High Castle\" world, there are $ m $ different film endings.\n\nAbendsen owns a storage and a shelf. At first, he has $ n $ ordered films on the shelf. In the $ i $ -th month he will do:\n\n1. Empty the storage.\n2. Put $ k_i \\cdot m $ films into the storage, $ k_i $ films for each ending.\n3. He will think about a question: if he puts all the films from the shelf into the storage, then randomly picks $ n $ films (from all the films in the storage) and rearranges them on the shelf, what is the probability that sequence of endings in $ [l_i, r_i] $ on the shelf will not be changed? Notice, he just thinks about this question, so the shelf will not actually be changed.\n\nAnswer all Abendsen's questions.\n\nLet the probability be fraction $ P_i $ . Let's say that the total number of ways to take $ n $ films from the storage for $ i $ -th month is $ A_i $ , so $ P_i \\cdot A_i $ is always an integer. Print for each month $ P_i \\cdot A_i \\pmod {998244353} $ .\n\n $ 998244353 $ is a prime number and it is equal to $ 119 \\cdot 2^{23} + 1 $ .\n\nIt is guaranteed that there will be only no more than $ 100 $ different $ k $ values.",
    "inputFormat": "The first line contains three integers $ n $ , $ m $ , and $ q $ ( $ 1 \\le n, m, q \\le 10^5 $ , $ n+q\\leq 10^5 $ ) \u2014 the number of films on the shelf initially, the number of endings, and the number of months.\n\nThe second line contains $ n $ integers $ e_1, e_2, \\ldots, e_n $ ( $ 1\\leq e_i\\leq m $ ) \u2014 the ending of the $ i $ -th film on the shelf.\n\nEach of the next $ q $ lines contains three integers $ l_i $ , $ r_i $ , and $ k_i $ ( $ 1 \\le l_i \\le r_i \\le n, 0 \\le k_i \\le 10^5 $ ) \u2014 the $ i $ -th query.\n\nIt is guaranteed that there will be only no more than $ 100 $ different $ k $ values.",
    "outputFormat": "Print the answer for each question in a separate line.",
    "samples": [
        [
            "6 4 4\n1 2 3 4 4 4\n1 4 0\n1 3 2\n1 4 2\n1 5 2\n",
            "6\n26730\n12150\n4860\n"
        ],
        [
            "5 5 3\n1 2 3 4 5\n1 2 100000\n1 4 4\n3 5 5\n",
            "494942218\n13125\n151632\n"
        ]
    ],
    "hint": "In the first sample in the second query, after adding $ 2 \\cdot m $ films into the storage, the storage will look like this: $ \\{1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 4\\} $ .\n\nThere are $ 26730 $ total ways of choosing the films so that $ e_l, e_{l+1}, \\ldots, e_r $ will not be changed, for example, $ [1, 2, 3, 2, 2] $ and $ [1, 2, 3, 4, 3] $ are such ways.\n\nThere are $ 2162160 $ total ways of choosing the films, so you're asked to print $ (\\frac{26730}{2162160} \\cdot 2162160) \\mod 998244353 = 26730 $ .",
    "translation": "\u7ed9\u5b9a $n,m,q$\uff0c\u7ed9\u5b9a\u957f\u4e3a $n$ \u7684\u5e8f\u5217 $\\{a\\}$\uff0c\u6ee1\u8db3 $a_i\\in [1,m]$\n\n\u591a\u7ec4\u67e5\u8be2\uff0c\u6bcf\u6b21\u7ed9\u51fa\u533a\u95f4 $[l_i,r_i]$ \u4e0e $k$\uff0c\u8868\u793a\u5982\u4e0b\u64cd\u4f5c\uff1a\n\n- \u4ee4\u96c6\u5408 $S$ \u4e3a\u5e8f\u5217 $a$ \u6784\u6210\u7684\u53ef\u91cd\u96c6\u3002\n- \u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272 $c\\in [1,m]$\uff0c\u52a0\u5165 $k$ \u4e2a\u6b64\u989c\u8272\u7684\u5143\u7d20\u3002\n- \u4ece\u4e2d\u968f\u673a\u9009\u51fa $n$ \u4e2a\u5143\u7d20\uff0c\u7136\u540e\u968f\u673a\u6392\u6210\u4e00\u4e2a\u6392\u5217\u3002\n- \u8ba1\u7b97\u6700\u540e\u533a\u95f4 $[l_i,r_i]$ \u4e0e\u521d\u59cb\u5e8f\u5217\u76f8\u7b49\u7684\u65b9\u6848\u6570\u3002\n\n\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n$n,m,q\\le 10^5$\uff0c\u4fdd\u8bc1\u4e0d\u540c\u7684 $k$ \u53ea\u6709 $100$ \u79cd\u3002"
}
{
    "description": "This version of the problem differs from the previous one only in the constraint on $ n $ .\n\nA tree is a connected undirected graph without cycles. A weighted tree has a weight assigned to each edge. The distance between two vertices is the minimum sum of weights on the path connecting them.\n\nYou are given a weighted tree with $ n $ vertices, each edge has a weight of $ 1 $ . Denote $ d(v) $ as the distance between vertex $ 1 $ and vertex $ v $ .\n\nLet $ f(x) $ be the minimum possible value of $ \\max\\limits_{1 \\leq v \\leq n} \\ {d(v)} $ if you can temporarily add an edge with weight $ x $ between any two vertices $ a $ and $ b $ $ (1 \\le a, b \\le n) $ . Note that after this operation, the graph is no longer a tree.\n\nFor each integer $ x $ from $ 1 $ to $ n $ , find $ f(x) $ .",
    "inputFormat": "The first line contains a single integer $ t $ ( $ 1 \\le t \\le 10^4 $ ) \u2014 the number of test cases.\n\nThe first line of each test case contains a single integer $ n $ ( $ 2 \\le n \\le 3 \\cdot 10^5 $ ).\n\nEach of the next $ n\u22121 $ lines contains two integers $ u $ and $ v $ ( $ 1 \\le u,v \\le n $ ) indicating that there is an edge between vertices $ u $ and $ v $ . It is guaranteed that the given edges form a tree.\n\nIt is guaranteed that the sum of $ n $ over all test cases doesn't exceed $ 3 \\cdot 10^5 $ .",
    "outputFormat": "For each test case, print $ n $ integers in a single line, $ x $ -th of which is equal to $ f(x) $ for all $ x $ from $ 1 $ to $ n $ .",
    "samples": [
        [
            "3\n4\n1 2\n2 3\n1 4\n2\n1 2\n7\n1 2\n1 3\n3 4\n3 5\n3 6\n5 7",
            "1 2 2 2 \n1 1 \n2 2 3 3 3 3 3"
        ]
    ],
    "hint": "![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1632E2/bde039035f2fc0c7e75fd7b5909dff635e928d1e.png) In the first testcase: - For $ x = 1 $ , we can an edge between vertices $ 1 $ and $ 3 $ , then $ d(1) = 0 $ and $ d(2) = d(3) = d(4) = 1 $ , so $ f(1) = 1 $ .\n- For $ x \\ge 2 $ , no matter which edge we add, $ d(1) = 0 $ , $ d(2) = d(4) = 1 $ and $ d(3) = 2 $ , so $ f(x) = 2 $ .",
    "translation": "**\u672c\u9898\u4e0e CF1632E1 \u7684\u552f\u4e00\u533a\u522b\u5728\u4e8e $n$ \u7684\u6570\u636e\u8303\u56f4\u3002**\n\n\u7ed9\u5b9a\u4e00\u4e2a\u5305\u542b $n$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u6bcf\u6761\u8fb9\u7684\u957f\u5ea6\u4e3a $1$\u3002\u7ed9\u51fa\u5982\u4e0b\u5b9a\u4e49\uff1a\n\n- \u5b9a\u4e49 $d(v)$ \u4e3a\u4ece\u8282\u70b9 $1$ \u5230\u8282\u70b9 $v$ \u7684\u8ddd\u79bb\u3002\n- \u5b9a\u4e49 $f(x)$ \u4e3a\u5728\u4efb\u610f\u4e24\u4e2a\u70b9 $a,b$ \u4e4b\u95f4\u6dfb\u52a0\u4e00\u4e2a\u957f\u5ea6\u4e3a $x$ \u7684\u8fb9\u540e\uff0c$\\max\\limits_{1\\leqslant v\\leqslant n}d(v)$ \u7684\u6700\u5c0f\u503c\u3002\n\n\u73b0\u5728\uff0c\u5bf9\u4e8e\u6240\u6709\u7684 $1\\leqslant x\\leqslant n$\uff0c\u6c42\u51fa $f(x)$ \u7684\u503c\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a\n\n- $t$ \u7ec4\u6570\u636e\uff0c$1\\leqslant t\\leqslant 10^4$\u3002\n- $2\\leqslant n,\\sum n\\leqslant\\bf 3\\times 10^5$\u3002\n\nTranslated by Eason_AC  \n2022.1.31"
}
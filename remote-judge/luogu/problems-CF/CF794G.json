{
    "description": "Igor the analyst is at work. He learned about a feature in his text editor called \"Replace All\". Igor is too bored at work and thus he came up with the following problem:\n\nGiven two strings $ x $ and $ y $ which consist of the English letters 'A' and 'B' only, a pair of strings $ (s,t) $ is called good if:\n\n- $ s $ and $ t $ consist of the characters '0' and '1' only.\n- $ 1<=|s|,|t|<=n $ , where $ |z| $ denotes the length of string $ z $ , and $ n $ is a fixed positive integer.\n- If we replace all occurrences of 'A' in $ x $ and $ y $ with the string $ s $ , and replace all occurrences of 'B' in $ x $ and $ y $ with the string $ t $ , then the two obtained from $ x $ and $ y $ strings are equal.\n\nFor example, if $ x= $ AAB, $ y= $ BB and $ n=4 $ , then (01, 0101) is one of good pairs of strings, because both obtained after replacing strings are \"01010101\".\n\nThe flexibility of a pair of strings $ x $ and $ y $ is the number of pairs of good strings $ (s,t) $ . The pairs are ordered, for example the pairs $ ( $ 0, 1 $ ) $ and $ ( $ 1, 0 $ ) $ are different.\n\nYou're given two strings $ c $ and $ d $ . They consist of characters 'A', 'B' and '?' only. Find the sum of flexibilities of all possible pairs of strings $ (c',d') $ such that $ c' $ and $ d' $ can be obtained from $ c $ and $ d $ respectively by replacing the question marks with either 'A' or 'B', modulo $ 10^{9}+7 $ .",
    "inputFormat": "The first line contains the string $ c $ ( $ 1<=|c|<=3\u00b710^{5} $ ).\n\nThe second line contains the string $ d $ ( $ 1<=|d|<=3\u00b710^{5} $ ).\n\nThe last line contains a single integer $ n $ ( $ 1<=n<=3\u00b710^{5} $ ).",
    "outputFormat": "Output a single integer: the answer to the problem, modulo $ 10^{9}+7 $ .",
    "samples": [
        [
            "A?\n?\n3\n",
            "2\n"
        ],
        [
            "A\nB\n10\n",
            "2046\n"
        ]
    ],
    "hint": "For the first sample, there are four possible pairs of $ (c',d') $ .\n\nIf $ (c',d')=( $ AA $ , $ A $ ) $ , then the flexibility is $ 0 $ .\n\nIf $ (c',d')=( $ AB $ , $ A $ ) $ , then the flexibility is $ 0 $ .\n\nIf $ (c',d')=( $ AA $ , $ B $ ) $ , then the flexibility is $ 2 $ , as the pairs of binary strings $ ( $ 1 $ , $ 11 $ ) $ , $ ( $ 0 $ , $ 00 $ ) $ are the only good pairs.\n\nIf $ (c',d')=( $ AB $ , $ B $ ) $ , then the flexibility is $ 0 $ .\n\nThus, the total flexibility is $ 2 $ .\n\nFor the second sample, there are $ 2^{1}+2^{2}+...+2^{10}=2046 $ possible binary strings of length not greater $ 10 $ , and the set of pairs of good strings is precisely the set of pairs $ (s,s) $ , where $ s $ is a binary string of length not greater than $ 10 $ .",
    "translation": "\u7ed9\u4e24\u4e2a\u5305\u542b`A`,`B`,`?`\u7684\u4e32\uff0c`?`\u53ef\u4ee5\u662f`A`\u6216`B`\uff0c\u6c42\u6240\u6709`\uff1f`\u7684\u60c5\u51b5\u4e0b\uff0c\u6c42\u4e0b\u9762\u8fd9\u4e2a\u4e1c\u897f\u7684\u548c\uff1a\u7edf\u8ba1\u6709\u591a\u5c11\u5bf9\u957f\u5ea6$\\le n$\u768401\u4e32(S,T)\u4f7f\u5f97\u628a\u6240\u6709`A`\u6362\u6210S\uff0c`B`\u6362\u6210T\u4f7f\u5f97\u4e24\u4e2a\u4e32\u76f8\u7b49"
}
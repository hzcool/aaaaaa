{
    "description": "This is the hard version of the problem. The only difference is maximum value of $ a_i $ .\n\nOnce in Kostomuksha Divan found an array $ a $ consisting of positive integers. Now he wants to reorder the elements of $ a $ to maximize the value of the following function: $ $$$\\sum_{i=1}^n \\operatorname{gcd}(a_1, \\, a_2, \\, \\dots, \\, a_i), $ $  where  $ \\\\operatorname{gcd}(x\\_1, x\\_2, \\\\ldots, x\\_k) $  denotes the <a href=\"https://en.wikipedia.org/wiki/Greatest_common_divisor\">greatest common divisor</a> of integers  $ x\\_1, x\\_2, \\\\ldots, x\\_k $ , and  $ \\\\operatorname{gcd}(x) = x $  for any integer  $ x$$$.\n\nReordering elements of an array means changing the order of elements in the array arbitrary, or leaving the initial order.\n\nOf course, Divan can solve this problem. However, he found it interesting, so he decided to share it with you.",
    "inputFormat": "The first line contains a single integer $ n $ ( $ 1 \\leq n \\leq 10^5 $ ) \u2014 the size of the array $ a $ .\n\nThe second line contains $ n $ integers $ a_{1}, \\, a_{2}, \\, \\dots, \\, a_{n} $ ( $ 1 \\le a_{i} \\le 2 \\cdot 10^7 $ ) \u2014 the array $ a $ .",
    "outputFormat": "Output the maximum value of the function that you can get by reordering elements of the array $ a $ .",
    "samples": [
        [
            "6\n2 3 1 2 6 2",
            "14"
        ],
        [
            "10\n5 7 10 3 1 10 100 3 42 54",
            "131"
        ]
    ],
    "hint": "In the first example, it's optimal to rearrange the elements of the given array in the following order: $ [6, \\, 2, \\, 2, \\, 2, \\, 3, \\, 1] $ :\n\n $ $$$\\operatorname{gcd}(a_1) + \\operatorname{gcd}(a_1, \\, a_2) + \\operatorname{gcd}(a_1, \\, a_2, \\, a_3) + \\operatorname{gcd}(a_1, \\, a_2, \\, a_3, \\, a_4) + \\operatorname{gcd}(a_1, \\, a_2, \\, a_3, \\, a_4, \\, a_5) + \\operatorname{gcd}(a_1, \\, a_2, \\, a_3, \\, a_4, \\, a_5, \\, a_6) = 6 + 2 + 2 + 2 + 1 + 1 = 14. $ $  It can be shown that it is impossible to get a better answer.</p><p>In the second example, it's optimal to rearrange the elements of a given array in the following order:  $ \\[100, \\\\, 10, \\\\, 10, \\\\, 5, \\\\, 1, \\\\, 3, \\\\, 3, \\\\, 7, \\\\, 42, \\\\, 54\\]$$$.",
    "translation": "\u7ed9\u5b9a\u4e00\u4e2a\u5e8f\u5217 $a$ \uff0c\u5b9a\u4e49\u5176\u6743\u503c\u4e3a\uff1a\n\n$$\n\\sum_{i=1}^n\\gcd(a_1,a_2,...,a_i) \n$$\n\n\u73b0\u5728\u4f60\u53ef\u4ee5\u91cd\u6392 $a$ \uff0c\u6c42\u8fd9\u4e2a\u6743\u503c\u7684\u6700\u5927\u503c\u3002\n\n**\u672c\u9898\u4e0e\u540c\u573a D1 \u7684\u552f\u4e00\u5dee\u522b\u5728\u4e8e $a_i$ \u7684\u8303\u56f4\u3002**"
}
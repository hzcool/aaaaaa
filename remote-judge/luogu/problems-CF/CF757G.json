{
    "description": "Whoa! You did a great job helping Team Rocket who managed to capture all the Pokemons sent by Bash. Meowth, part of Team Rocket, having already mastered the human language, now wants to become a master in programming as well. He agrees to free the Pokemons if Bash can answer his questions.\n\nInitially, Meowth gives Bash a weighted tree containing $ n $ nodes and a sequence $ a_{1},a_{2}...,a_{n} $ which is a permutation of $ 1,2,...,n $ . Now, Mewoth makes $ q $ queries of one of the following forms:\n\n- 1 l r v: meaning Bash should report ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF757G/ea8253b2e126f0f9a4f7e577c28110ed4a318c5a.png), where $ dist(a,b) $ is the length of the shortest path from node $ a $ to node $ b $ in the given tree.\n- 2 x: meaning Bash should swap $ a_{x} $ and $ a_{x+1} $ in the given sequence. This new sequence is used for later queries.\n\nHelp Bash to answer the questions!",
    "inputFormat": "The first line contains two integers $ n $ and $ q $ ( $ 1<=n<=2\u00b710^{5} $ , $ 1<=q<=2\u00b710^{5} $ ) \u2014 the number of nodes in the tree and the number of queries, respectively.\n\nThe next line contains $ n $ space-separated integers \u2014 the sequence $ a_{1},a_{2},...,a_{n} $ which is a permutation of $ 1,2,...,n $ .\n\nEach of the next $ n-1 $ lines contain three space-separated integers $ u $ , $ v $ , and $ w $ denoting that there exists an undirected edge between node $ u $ and node $ v $ of weight $ w $ , ( $ 1<=u,v<=n $ , $ u\u2260v $ , $ 1<=w<=10^{6} $ ). It is guaranteed that the given graph is a tree.\n\nEach query consists of two lines. First line contains single integer $ t $ , indicating the type of the query. Next line contains the description of the query:\n\n- t = 1: Second line contains three integers $ a $ , $ b $ and $ c $ ( $ 1<=a,b,c&lt;2^{30} $ ) using which $ l $ , $ r $ and $ v $ can be generated using the formula given below: \n  - ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF757G/8aee8013a9e038e56ef819c034e3f838e39c5b69.png),\n  - ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF757G/8a6ca8e44774777b9443d62d70704ae5a8cbd864.png),\n  - ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF757G/2332d289771b1a35329bc48f3b3da516601f653d.png).\n- t = 2: Second line contains single integer $ a $ ( $ 1<=a&lt;2^{30} $ ) using which $ x $ can be generated using the formula given below: \n  - ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF757G/eb2a03b6eebdb7c4867abe4c7844cc3adf9f4a53.png).\n\nThe $ ans_{i} $ is the answer for the $ i $ -th query, assume that $ ans_{0}=0 $ . If the $ i $ -th query is of type 2 then $ ans_{i} $ = $ ans_{i-1} $ . It is guaranteed that:\n\n- for each query of type 1: $ 1<=l<=r<=n $ , $ 1<=v<=n $ ,\n- for each query of type 2: $ 1<=x<=n-1 $ .\n\nThe ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF757G/4298d47c0191af3c0a3103f431751061bc7e2362.png) operation means bitwise exclusive OR.",
    "outputFormat": "For each query of type $ 1 $ , output a single integer in a separate line, denoting the answer to the query.",
    "samples": [
        [
            "5 5\n4 5 1 3 2\n4 2 4\n1 3 9\n4 1 4\n4 5 2\n1\n1 5 4\n1\n22 20 20\n2\n38\n2\n39\n1\n36 38 38\n",
            "23\n37\n28\n"
        ]
    ],
    "hint": "In the sample, the actual queries are the following:\n\n- 1 1 5 4\n- 1 1 3 3\n- 2 3\n- 2 2\n- 1 1 3 3",
    "translation": "\u4e00\u68f5 $n$ \u4e2a\u70b9\u7684\u6811\u548c\u4e00\u4e2a\u6392\u5217 $p_i$\uff0c\u8fb9\u6709\u8fb9\u6743\uff0c\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a\n- `l r x`\uff0c\u8be2\u95ee $\\sum\\limits _{i=l}^{r} dis(p_i,x)$\u3002\n- `x`\uff0c\u4ea4\u6362 $p_x,p_{x+1}$\u3002\n\n$n,q\\leq 2\\times 10^5$\uff0c\u5f3a\u5236\u5728\u7ebf\u3002"
}
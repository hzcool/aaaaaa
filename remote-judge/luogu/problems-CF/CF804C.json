{
    "description": "Isart and Modsart were trying to solve an interesting problem when suddenly Kasra arrived. Breathless, he asked: \"Can you solve a problem I'm stuck at all day?\"\n\nWe have a tree $ T $ with $ n $ vertices and $ m $ types of ice cream numerated from $ 1 $ to $ m $ . Each vertex $ i $ has a set of $ s_{i} $ types of ice cream. Vertices which have the $ i $ -th ( $ 1<=i<=m $ ) type of ice cream form a connected subgraph. We build a new graph $ G $ with $ m $ vertices. We put an edge between the $ v $ -th and the $ u $ -th ( $ 1<=u,v<=m $ , $ u\u2260v $ ) vertices in $ G $ if and only if there exists a vertex in $ T $ that has both the $ v $ -th and the $ u $ -th types of ice cream in its set. The problem is to paint the vertices of $ G $ with minimum possible number of colors in a way that no adjacent vertices have the same color.\n\nPlease note that we consider that empty set of vertices form a connected subgraph in this problem.\n\nAs usual, Modsart don't like to abandon the previous problem, so Isart wants you to solve the new problem.",
    "inputFormat": "The first line contains two integer $ n $ and $ m $ ( $ 1<=n,m<=3\u00b710^{5} $ ) \u2014 the number of vertices in $ T $ and the number of ice cream types.\n\n $ n $ lines follow, the $ i $ -th of these lines contain single integer $ s_{i} $ ( $ 0<=s_{i}<=3\u00b710^{5} $ ) and then $ s_{i} $ distinct integers, each between $ 1 $ and $ m $ \u2014 the types of ice cream in the $ i $ -th vertex. The sum of $ s_{i} $ doesn't exceed $ 5\u00b710^{5} $ .\n\n $ n-1 $ lines follow. Each of these lines describes an edge of the tree with two integers $ u $ and $ v $ ( $ 1<=u,v<=n $ ) \u2014 the indexes of connected by this edge vertices.",
    "outputFormat": "Print single integer $ c $ in the first line \u2014 the minimum number of colors to paint the vertices in graph $ G $ .\n\nIn the second line print $ m $ integers, the $ i $ -th of which should be the color of the $ i $ -th vertex. The colors should be between $ 1 $ and $ c $ . If there are some answers, print any of them.",
    "samples": [
        [
            "3 3\n1 1\n2 2 3\n1 2\n1 2\n2 3\n",
            "2\n1 1 2 "
        ],
        [
            "4 5\n0\n1 1\n1 3\n3 2 4 5\n2 1\n3 2\n4 3\n",
            "3\n1 1 1 2 3 "
        ]
    ],
    "hint": "In the first example the first type of ice cream is present in the first vertex only, so we can color it in any color. The second and the third ice cream are both presented in the second vertex, so we should paint them in different colors.\n\nIn the second example the colors of the second, the fourth and the fifth ice cream should obviously be distinct.",
    "translation": "\u6709\u4e00\u9897 $n$ \u4e2a\u8282\u70b9\u7684\u6811 $T$ \u548c $m$ \u79cd\u51b0\u6dc7\u6dcb\uff0c\u6811\u4e0a\u7684\u7b2c $i$ \u4e2a\u8282\u70b9\u6709 $s_i$ \u4e2a\u51b0\u6dc7\u6dcb\uff0c\u4e14\u6240\u6709\u76f8\u540c\u79cd\u7c7b\u7684\u51b0\u6dc7\u6dcb\u5728\u6811\u4e0a\u6784\u6210\u4e86\u4e00\u4e2a\u8054\u901a\u5757\u3002\n\n\u6784\u9020\u4e00\u4e2a\u65b0\u7684\u56fe $G$ \uff0c$G$ \u6709 $m$ \u4e2a\u8282\u70b9\uff0c$G$ \u4e2d\u7684 $u,v$ \u4e4b\u95f4\u6709\u8fb9\uff0c\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728\u81f3\u5c11\u4e00\u4e2a\u5728 $T$ \u4e0a\u7684\u8282\u70b9\u6ee1\u8db3\u4ed6\u540c\u65f6\u6709\u7b2c $u$ \u79cd\u548c\u7b2c $v$ \u79cd\u51b0\u6dc7\u6dcb\u3002\n\n\u4f60\u7684\u4efb\u52a1\u662f\u7528\u5c3d\u53ef\u80fd\u5c11\u7684\u989c\u8272\u79cd\u7c7b\u6570\u7ed9 $G$ \u7684\u6bcf\u4e00\u4e2a\u8282\u70b9\u67d3\u8272\uff0c\u4f7f\u5f97\u6ca1\u6709\u4e24\u4e2a\u76f8\u90bb\u7684\u8282\u70b9\u6709\u76f8\u540c\u7684\u989c\u8272\uff0c\u8981\u6c42\u8f93\u51fa\u65b9\u6848\u3002\n\n\u6ce8\u610f\u7a7a\u7684\u70b9\u96c6\u4e5f\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u8054\u901a\u5757\u3002\n\nBy wasa855"
}
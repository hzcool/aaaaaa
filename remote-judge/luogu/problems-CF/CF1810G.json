{
    "description": "You're going to generate an array $ a $ with a length of at most $ n $ , where each $ a_{i} $ equals either $ 1 $ or $ -1 $ .\n\nYou generate this array in the following way.\n\n- First, you choose some integer $ k $ ( $ 1\\le k \\le n $ ), which decides the length of $ a $ .\n- Then, for each $ i $ ( $ 1\\le i \\le k $ ), you set $ a_{i} = 1 $ with probability $ p_{i} $ , otherwise set $ a_{i} = -1 $ (with probability $ 1 - p_{i} $ ).\n\nAfter the array is generated, you calculate $ s_{i} = a_{1} + a_{2} + a_{3}+ \\ldots + a_{i} $ . Specially, $ s_{0} = 0 $ . Then you let $ S $ equal to $ \\displaystyle \\max_{i=0}^{k}{s_{i}} $ . That is, $ S $ is the maximum prefix sum of the array $ a $ .\n\nYou are given $ n+1 $ integers $ h_{0} , h_{1}, \\ldots ,h_{n} $ . The score of an array $ a $ with maximum prefix sum $ S $ is $ h_{S} $ . Now, for each $ k $ , you want to know the expected score for an array of length $ k $ modulo $ 10^9+7 $ .",
    "inputFormat": "Each test contains multiple test cases. The first line contains a single integer $ t $ ( $ 1 \\le t \\le 5000 $ ) \u2014 the number of test cases. Their description follows.\n\nThe first line contains an integer $ n $ ( $ 1\\le n \\le 5000 $ ).\n\nThen for the following $ n $ lines, each line contains two integers $ x_{i} $ and $ y_{i} $ ( $ 0 \\le x_{i} < 10^9 + 7 $ , $ 1\\le y_{i} < 10^9 + 7 $ , $ x_{i} \\le y_{i} $ ), indicating $ p_{i} = \\frac{x_{i}}{y_{i}} $ .\n\nThe next line contains $ n+1 $ integers $ h_{0},h_{1}, \\ldots, h_{n} $ ( $ 0 \\le h_{i} < 10^9 + 7 $ ).\n\nIt is guaranteed that the sum of $ n $ over all test cases does not exceed $ 5000 $ .",
    "outputFormat": "For each test case, output $ n $ integers in one single line, the $ i $ -th of which denotes the expected score for an array of length $ i $ , modulo $ 10^9 + 7 $ .\n\nFormally, let $ M = 10^9 + 7 $ . It can be shown that the answer can be expressed as an irreducible fraction $ \\frac{p}{q} $ , where $ p $ and $ q $ are integers and $ q \\not \\equiv 0 \\pmod{M} $ . Output the integer equal to $ p \\cdot q^{-1} \\bmod M $ . In other words, output such an integer $ x $ that $ 0 \\le x < M $ and $ x \\cdot q \\equiv p \\pmod{M} $ .",
    "samples": [
        [
            "4\n2\n1 2\n1 2\n1 2 3\n3\n1 3\n1 4\n5 5\n1 1 1 1\n3\n2 5\n4 6\n0 2\n4 3 2 1\n5\n5 6\n5 7\n1 6\n1 3\n4 7\n9 0 4 5 2 4",
            "500000005 750000007 \n1 1 1 \n200000005 333333339 333333339 \n500000005 880952391 801587311 781746041 789304620"
        ]
    ],
    "hint": "In the first test case, if we choose $ k=1 $ , there are $ 2 $ possible arrays with equal probabilities: $ [1] $ and $ [-1] $ . The $ S $ values for them are $ 1 $ and $ 0 $ . So the expected score is $ \\frac{1}{2}h_{0} + \\frac{1}{2}h_{1} = \\frac{3}{2} $ . If we choose $ k=2 $ , there are $ 4 $ possible arrays with equal probabilities: $ [1,1] $ , $ [1,-1] $ , $ [-1,1] $ , $ [-1,-1] $ , and the $ S $ values for them are $ 2,1,0,0 $ . So the expected score is $ \\frac{1}{2}h_{0} + \\frac{1}{4}h_{1} + \\frac{1}{4}h_{2} = \\frac{7}{4} $ .\n\nIn the second test case, no matter what the $ S $ value is, the score is always $ 1 $ , so the expected score is always $ 1 $ .",
    "translation": "\u6784\u9020\u4e00\u4e2a\u957f\u5ea6\u6700\u591a\u4e3a $n$ \u7684\u6570\u7ec4 $a$\uff0c\u5176\u6bcf\u4e2a\u5143\u7d20\u5747\u4e3a $1$ \u6216 $-1$\u3002\u751f\u6210\u65b9\u5f0f\u5982\u4e0b\uff1a\n+ \u9009\u62e9\u4efb\u610f\u6574\u6570 $k\\in[1,n]$ \u4f5c\u4e3a $a$ \u7684\u957f\u5ea6\u3002\n+ \u5bf9\u4e8e $\\forall i\\in[1,k]$\uff0c\u6709 $p_i$ \u7684\u6982\u7387\u8bbe $a_i=1$\uff0c\u6709 $1-p_i$ \u7684\u6982\u7387\u8bbe $a_i=-1$\u3002\n\n\u5728\u6570\u5217\u88ab\u751f\u6210\u540e\uff0c\u8ba1\u7b97 $s_i=a_1+a_2+a_3+...+a_i$\u3002\u7279\u522b\u5730\uff0c$s_0=0$\u3002\u6b64\u65f6 $s$ \u6570\u7ec4\u7684\u6700\u5927\u524d\u7f00\u548c $S=max_{i=0}^ks_i$\u3002\n\n\u73b0\u5728\u7ed9\u5b9a $n+1$ \u4e2a\u6b63\u6574\u6570 $h_0,h_1,...,h_n$\u3002$a$ \u6570\u7ec4\u6700\u5927\u524d\u7f00\u548c $S$ \u7684\u5206\u6570\u4e3a $h_s$\u3002\u73b0\u5728\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $k$\uff0c\u4f60\u8981\u6c42\u51fa\u4e00\u4e2a\u6570\u7ec4\u957f\u5ea6\u4e3a $k$ \u7684\u671f\u671b\u5206\u6570\u5bf9 $10^9+7$ \u53d6\u6a21\u7684\u7ed3\u679c\u3002"
}
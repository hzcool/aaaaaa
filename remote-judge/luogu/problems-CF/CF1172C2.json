{
    "description": "The only difference between easy and hard versions is constraints.\n\nNauuo is a girl who loves random picture websites.\n\nOne day she made a random picture website by herself which includes $ n $ pictures.\n\nWhen Nauuo visits the website, she sees exactly one picture. The website does not display each picture with equal probability. The $ i $ -th picture has a non-negative weight $ w_i $ , and the probability of the $ i $ -th picture being displayed is $ \\frac{w_i}{\\sum_{j=1}^nw_j} $ . That is to say, the probability of a picture to be displayed is proportional to its weight.\n\nHowever, Nauuo discovered that some pictures she does not like were displayed too often.\n\nTo solve this problem, she came up with a great idea: when she saw a picture she likes, she would add $ 1 $ to its weight; otherwise, she would subtract $ 1 $ from its weight.\n\nNauuo will visit the website $ m $ times. She wants to know the expected weight of each picture after all the $ m $ visits modulo $ 998244353 $ . Can you help her?\n\nThe expected weight of the $ i $ -th picture can be denoted by $ \\frac {q_i} {p_i} $ where $ \\gcd(p_i,q_i)=1 $ , you need to print an integer $ r_i $ satisfying $ 0\\le r_i<998244353 $ and $ r_i\\cdot p_i\\equiv q_i\\pmod{998244353} $ . It can be proved that such $ r_i $ exists and is unique.",
    "inputFormat": "The first line contains two integers $ n $ and $ m $ ( $ 1\\le n\\le 2\\cdot 10^5 $ , $ 1\\le m\\le 3000 $ ) \u2014 the number of pictures and the number of visits to the website.\n\nThe second line contains $ n $ integers $ a_1,a_2,\\ldots,a_n $ ( $ a_i $ is either $ 0 $ or $ 1 $ ) \u2014 if $ a_i=0 $ , Nauuo does not like the $ i $ -th picture; otherwise Nauuo likes the $ i $ -th picture. It is guaranteed that there is at least one picture which Nauuo likes.\n\nThe third line contains $ n $ positive integers $ w_1,w_2,\\ldots,w_n $ ( $ w_i \\geq 1 $ ) \u2014 the initial weights of the pictures. It is guaranteed that the sum of all the initial weights does not exceed $ 998244352-m $ .",
    "outputFormat": "The output contains $ n $ integers $ r_1,r_2,\\ldots,r_n $ \u2014 the expected weights modulo $ 998244353 $ .",
    "samples": [
        [
            "2 1\n0 1\n2 1\n",
            "332748119\n332748119\n"
        ],
        [
            "1 2\n1\n1\n",
            "3\n"
        ],
        [
            "3 3\n0 1 1\n4 3 5\n",
            "160955686\n185138929\n974061117\n"
        ]
    ],
    "hint": "In the first example, if the only visit shows the first picture with a probability of $ \\frac 2 3 $ , the final weights are $ (1,1) $ ; if the only visit shows the second picture with a probability of $ \\frac1 3 $ , the final weights are $ (2,2) $ .\n\nSo, both expected weights are $ \\frac2 3\\cdot 1+\\frac 1 3\\cdot 2=\\frac4 3 $ .\n\nBecause $ 332748119\\cdot 3\\equiv 4\\pmod{998244353} $ , you need to print $ 332748119 $ instead of $ \\frac4 3 $ or $ 1.3333333333 $ .\n\nIn the second example, there is only one picture which Nauuo likes, so every time Nauuo visits the website, $ w_1 $ will be increased by $ 1 $ .\n\nSo, the expected weight is $ 1+2=3 $ .\n\nNauuo is very naughty so she didn't give you any hint of the third example.",
    "translation": "[**Easy version**](https://www.luogu.com.cn/problem/CF1172C1) \u548c [**Hard version**](https://www.luogu.com.cn/problem/CF1172C2) \u7684\u552f\u4e00\u533a\u522b\u662f\u6570\u636e\u8303\u56f4\u3002\n\n\u4e00\u4e2a\u968f\u673a\u56fe\u7247\u7f51\u7ad9\u4e0a\u6709 $n$ \u5f20\u56fe\u7247\uff0c\u6bcf\u6b21\u8bbf\u95ee\u8fd9\u4e2a\u7f51\u7ad9\u65f6\u4f1a\u663e\u793a\u4e00\u5f20\u56fe\u7247\u3002\n\n\u4f46\u662f\u6bcf\u5f20\u56fe\u7247\u663e\u793a\u7684\u6982\u7387\u4e0d\u4e00\u5b9a\u76f8\u540c\u3002\n\n\u6bcf\u5f20\u56fe\u7247\u6709\u4e00\u4e2a\u6743\u503c\uff0c\u8bbe\u7b2c $i$ \u5f20\u56fe\u7247\u7684\u6743\u503c\u4e3a $w_i$\uff0c\u5219\u7b2c $i$ \u5f20\u56fe\u7247\u88ab\u663e\u793a\u7684\u6982\u7387\u4e3a $\\frac{w_i}{\\sum_{j=1}^n w_j}$ \u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u5f20\u56fe\u7247\u88ab\u663e\u793a\u7684\u6982\u7387\u4e0e\u5176\u6743\u503c\u6210\u6b63\u6bd4\u3002\n\n\u6bcf\u5f20\u7167\u7247\u4f1a\u88ab \"\u559c\u6b22\" \u6216 \"\u4e0d\u559c\u6b22\" \uff0c\u7528 $a$ \u6765\u8868\u793a\u3002\n\n\u82e5 $a_i=0$ \uff0c\u5219\u7b2c $i$ \u5f20\u7167\u7247\u4e0d\u88ab\u559c\u6b22\uff1b\u82e5 $a_i=1$ \uff0c\u5219\u7b2c $i$ \u5f20\u7167\u7247\u88ab\u559c\u6b22\u3002\n\n\u6bcf\u6b21\u8bbf\u95ee\u7f51\u7ad9\u65f6\uff0c\u82e5\u51fa\u73b0\u7684\u7167\u7247\u88ab\u559c\u6b22\uff0c\u5219 $w_i$ \u52a0\u4e00\uff0c\u5426\u5219 $w_i$ \u51cf\u4e00\u3002\n\n\u63a5\u4e0b\u6765\u4f1a\u8bbf\u95ee\u8be5\u7f51\u7ad9 $m$ \u6b21\uff0c\u8bf7\u6c42\u51fa\u6bcf\u5f20\u56fe\u7247\u5728 $m$ \u6b21\u8bbf\u95ee\u540e\u7684\u9884\u671f\u6743\u503c $\\bmod 998244353$ \u7684\u7ed3\u679c \u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leqslant n \\leqslant 2\\times10^5$ \uff0c$1\\leqslant m\\leqslant 3000$ \uff0c$1\\leqslant w_i$ \u3002"
}
{
    "description": "Easy and hard versions are actually different problems, so we advise you to read both statements carefully.\n\nYou are given a weighted rooted tree, vertex $ 1 $ is the root of this tree. Also, each edge has its own cost.\n\nA tree is a connected graph without cycles. A rooted tree has a special vertex called the root. A parent of a vertex $ v $ is the last different from $ v $ vertex on the path from the root to the vertex $ v $ . Children of vertex $ v $ are all vertices for which $ v $ is the parent. A vertex is a leaf if it has no children. The weighted tree is such a tree that each edge of this tree has some weight.\n\nThe weight of the path is the sum of edges weights on this path. The weight of the path from the vertex to itself is $ 0 $ .\n\nYou can make a sequence of zero or more moves. On each move, you select an edge and divide its weight by $ 2 $ rounding down. More formally, during one move, you choose some edge $ i $ and divide its weight by $ 2 $ rounding down ( $ w_i := \\left\\lfloor\\frac{w_i}{2}\\right\\rfloor $ ).\n\nEach edge $ i $ has an associated cost $ c_i $ which is either $ 1 $ or $ 2 $ coins. Each move with edge $ i $ costs $ c_i $ coins.\n\nYour task is to find the minimum total cost to make the sum of weights of paths from the root to each leaf at most $ S $ . In other words, if $ w(i,       j) $ is the weight of the path from the vertex $ i $ to the vertex $ j $ , then you have to make $ \\sum\\limits_{v \\in       leaves} w(root, v) \\le S $ , where $ leaves $ is the list of all leaves.\n\nYou have to answer $ t $ independent test cases.",
    "inputFormat": "The first line of the input contains one integer $ t $ ( $ 1       \\le t \\le 2 \\cdot 10^4 $ ) \u2014 the number of test cases. Then $ t $ test cases follow.\n\nThe first line of the test case contains two integers $ n $ and $ S $ ( $ 2 \\le n \\le 10^5; 1 \\le S \\le 10^{16} $ ) \u2014 the number of vertices in the tree and the maximum possible sum of weights you have to obtain. The next $ n-1 $ lines describe edges of the tree. The edge $ i $ is described as four integers $ v_i $ , $ u_i $ , $ w_i $ and $ c_i $ ( $ 1 \\le v_i, u_i \\le n; 1 \\le       w_i \\le 10^6; 1 \\le c_i \\le 2 $ ), where $ v_i $ and $ u_i $ are vertices the edge $ i $ connects, $ w_i $ is the weight of this edge and $ c_i $ is the cost of this edge.\n\nIt is guaranteed that the sum of $ n $ does not exceed $ 10^5 $ ( $ \\sum n \\le 10^5 $ ).",
    "outputFormat": "For each test case, print the answer: the minimum total cost required to make the sum of weights paths from the root to each leaf at most $ S $ .",
    "samples": [
        [
            "4\n4 18\n2 1 9 2\n3 2 4 1\n4 1 1 2\n3 20\n2 1 8 1\n3 1 7 2\n5 50\n1 3 100 1\n1 5 10 2\n2 3 123 2\n5 4 55 1\n2 100\n1 2 409 2",
            "0\n0\n11\n6"
        ]
    ],
    "hint": "",
    "translation": "\u7ed9\u51fa\u4e00\u4e2a\u7ed3\u70b9\u6570\u91cf\u4e3a $n$ \u7684\u8fb9\u5e26\u6743\u7684\u6709\u6839\u6811\uff0c\u6811\u7684\u6839\u7ed3\u70b9\u4e3a $1$\u3002\u4f60\u53ef\u4ee5\u8fdb\u884c\u4ee5\u4e0b\u64cd\u4f5c\u3002\n\n* \u9009\u5b9a\u4efb\u610f\u4e00\u6761\u6743\u503c\u4e3a $w_i$ \u7684\u8fb9\uff0c\u4f7f $w_i \\gets \\lfloor \\frac{w_i}{2} \\rfloor$\uff0c\u82b1\u8d39\u4e3a $c_i$ \u4e14 $c_i \\in \\{1, 2\\}$\u3002\n\n\u5b9a\u4e49 $w(i,j)$ \u4e3a\u7ed3\u70b9 $i$ \u5230\u7ed3\u70b9 $j$ \u7684\u8def\u5f84\u8fb9\u6743\u548c\u3002\u5bf9\u4e8e\u6bcf\u7ec4\u6d4b\u8bd5\u6570\u636e\uff0c\u4f60\u9700\u8981\u56de\u7b54\u6700\u5c0f\u7684\u82b1\u8d39\uff0c\u4f7f\u5f97 $\\sum\\limits_{v\\in leaves}w(root,v)\\leq S$\uff0c\u5176\u4e2d $leaves$ \u4e3a\u53f6\u5b50\u7ed3\u70b9\u7f16\u53f7\u7684\u96c6\u5408\u3002"
}
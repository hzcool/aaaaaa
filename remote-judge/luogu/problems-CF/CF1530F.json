{
    "description": "Getting ready for VK Fest 2021, you prepared a table with $ n $ rows and $ n $ columns, and filled each cell of this table with some event related with the festival that could either happen or not: for example, whether you will win a prize on the festival, or whether it will rain.\n\nForecasting algorithms used in VK have already estimated the probability for each event to happen. Event in row $ i $ and column $ j $ will happen with probability $ a_{i, j} \\cdot 10^{-4} $ . All of the events are mutually independent.\n\nLet's call the table winning if there exists a line such that all $ n $ events on it happen. The line could be any horizontal line (cells $ (i, 1), (i, 2), \\ldots, (i, n) $ for some $ i $ ), any vertical line (cells $ (1, j), (2, j), \\ldots, (n, j) $ for some $ j $ ), the main diagonal (cells $ (1, 1), (2, 2), \\ldots, (n, n) $ ), or the antidiagonal (cells $ (1, n), (2, n - 1), \\ldots, (n, 1) $ ).\n\nFind the probability of your table to be winning, and output it modulo $ 31\\,607 $ (see Output section).",
    "inputFormat": "The first line contains a single integer $ n $ ( $ 2 \\le n \\le 21 $ ) \u2014 the dimensions of the table.\n\nThe $ i $ -th of the next $ n $ lines contains $ n $ integers $ a_{i, 1}, a_{i, 2}, \\ldots, a_{i, n} $ ( $ 0 < a_{i, j} < 10^4 $ ). The probability of event in cell $ (i, j) $ to happen is $ a_{i, j} \\cdot 10^{-4} $ .",
    "outputFormat": "Print the probability that your table will be winning, modulo $ 31\\,607 $ .\n\nFormally, let $ M = 31\\,607 $ . It can be shown that the answer can be expressed as an irreducible fraction $ \\frac{p}{q} $ , where $ p $ and $ q $ are integers and $ q \\not \\equiv 0 \\pmod{M} $ . Output the integer equal to $ p \\cdot q^{-1} \\bmod M $ . In other words, output such an integer $ x $ that $ 0 \\le x < M $ and $ x \\cdot q \\equiv p \\pmod{M} $ .",
    "samples": [
        [
            "2\n5000 5000\n5000 5000",
            "5927"
        ],
        [
            "2\n2500 6000\n3000 4000",
            "24812"
        ],
        [
            "3\n1000 2000 3000\n4000 5000 6000\n7000 8000 9000",
            "25267"
        ]
    ],
    "hint": "In the first example, any two events form a line, and the table will be winning if any two events happen. The probability of this is $ \\frac{11}{16} $ , and $ 5927 \\cdot 16 \\equiv 11 \\pmod{31\\,607} $ .",
    "translation": "- \u7ed9\u5b9a\u4e00\u4e2a $n \\times n$ \u7684\u8868\u683c\uff0c\u8868\u683c\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u6709 $p_{i,j}$ \u7684\u6982\u7387\u4e3a $1$\uff0c\u5426\u5219\u4e3a $0$\u3002\n- \u6c42\u81f3\u5c11\u6709\u4e00\u884c\u6216\u4e00\u5217\u6216\u4e00\u6761\u5bf9\u89d2\u7ebf\u5168\u4e3a $1$ \u7684\u6982\u7387\u3002\u5bf9\u89d2\u7ebf\u6307\u4e3b\u5bf9\u89d2\u7ebf\u6216\u526f\u5bf9\u89d2\u7ebf\u3002\n- $n \\le 21$"
}
{
    "description": "Yuu Koito and Touko Nanami are newlyweds! On the wedding day, Yuu gifted Touko a directed tree with $ n $ nodes and rooted at $ 1 $ , and a labeling $ a $ which is some DFS order of the tree. Every edge in this tree is directed away from the root.\n\nAfter calling dfs(1) the following algorithm returns $ a $ as a DFS order of a tree rooted at $ 1 $ :\n\n```\n<pre class=\"verbatim\"><br></br>order := 0<br></br>a := array of length n <br></br><br></br>function dfs(u):<br></br>    order := order + 1<br></br>    a[u] := order<br></br>    for all v such that there is a directed edge (u -> v):<br></br>        dfs(v)<br></br>\n```\n\nNote that there may be different DFS orders for a given tree.\n\nTouko likes the present so much she decided to play with it! On each day following the wedding day, Touko performs this procedure once:\n\n- Among all directed edges $ u \\rightarrow v $ such that $ a_u < a_v $ , select the edge $ u' \\rightarrow v' $ with the lexicographically smallest pair $ (a_{u'}, a_{v'}) $ .\n- Swap $ a_{u'} $ and $ a_{v'} $ .\n\nDays have passed since their wedding, and Touko has somehow forgotten which date the wedding was and what was the original labeling $ a $ ! Fearing that Yuu might get angry, Touko decided to ask you to derive these two pieces of information using the current labeling.\n\nBeing her good friend, you need to find the number of days that have passed since the wedding, and the original labeling of the tree. However, there is a chance that Touko might have messed up her procedures, which result in the current labeling being impossible to obtain from some original labeling; in that case, please inform Touko as well.",
    "inputFormat": "The first line of the input contains an integer $ n $ ( $ 2 \\le n \\le 3 \\cdot 10^5 $ ) \u2014 the number of nodes on the tree.\n\nThe second line contains $ n $ integers $ a_1 $ , $ a_2 $ , ..., $ a_n $ ( $ 1 \\le a_i \\le n $ , all $ a_i $ are distinct) \u2014 the current labeling of the tree.\n\nEach of the next $ n - 1 $ lines contains two integers $ u_i $ and $ v_i $ ( $ 1 \\le u, v \\le n $ , $ u \\neq v $ ), describing an directed edge from $ u_i $ to $ v_i $ . The edges form a directed tree rooted at $ 1 $ .",
    "outputFormat": "If the current labeling is impossible to arrive at from any DFS order, print NO.\n\nElse, on the first line, print YES. On the second line, print a single integer denoting the number of days since the wedding. On the third line, print $ n $ numbers space-separated denoting the original labeling of the tree.\n\nIf there are multiple correct outputs, print any. This means: you are allowed to output any pair (DFS order, number of days), such that we get the current configuration from the DFS order you provided in exactly the number of days you provided.",
    "samples": [
        [
            "7\n4 5 2 1 7 6 3\n1 5\n7 6\n1 2\n2 7\n3 4\n1 3",
            "YES\n5\n1 4 2 3 7 6 5"
        ],
        [
            "7\n7 6 5 3 1 4 2\n4 3\n2 5\n3 7\n1 4\n7 2\n2 6",
            "NO"
        ]
    ],
    "hint": "The following animation showcases the first sample test case. The white label inside the node represents the index of the node $ i $ , while the boxed orange label represents the value $ a_i $ .\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1508E/3e50fa34f107fc2604db0e1747008bb1dad1f82b.png)",
    "translation": "\u4f60\u6709\u4e00\u4e2a $n(2 \\le n \\le 3 \\times 10^5)$ \u4e2a\u8282\u70b9\uff0c\u4ee5 $1$ \u4e3a\u6839\u7684\u6811\u548c\u5b83\u7684\u67d0\u4e00\u4e2a DFS \u5e8f\uff08\u4f46\u4f60\u4e0d\u77e5\u9053\u5177\u4f53\u662f\u4ec0\u4e48\uff09\u3002\u53c8\u6709\u4e00\u4e2a\u5e8f\u5217 $a$\uff0c\u521d\u59cb\u65f6 $a_i$ \u5c31\u662f\u7b2c $i$ \u4e2a\u70b9\u5728 DFS \u5e8f\u4e2d\u7684\u4f4d\u7f6e\u3002\n\n\u67d0\u4eba\u5bf9\u8fd9\u4e2a\u6811\u8fdb\u884c\u4e86\u82e5\u5e72\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u5f62\u5982\u627e\u5230\u4e00\u4e2a\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u4e8c\u5143\u7ec4 $(a_i,a_j)$\uff08$\u9700\u6ee1\u8db3 a_i < a_j$\uff09\uff0c\u4f7f\u5f97 $i$ \u662f $j$ \u6811\u4e0a\u7684\u7236\u4eb2 \uff0c\u5e76\u4e14\u4ea4\u6362 $a_i,a_j$\u3002\n\n\u73b0\u5728\u7ed9\u5b9a\u4f60\u8fd9\u68f5\u6811\u548c\u64cd\u4f5c\u82e5\u5e72\u6b21\u540e\u7684\u5e8f\u5217 $a'$\uff0c\u8981\u6c42\u4f60\u5224\u65ad\u662f\u5426\u5b58\u5728\u4e00\u79cd DFS \u5e8f\u4f7f\u5f97\u8fdb\u884c\u82e5\u5e72\u6b21\u64cd\u4f5c\u540e\u7684 $a$ \u5e8f\u5217\u662f\u7ed9\u5b9a\u7684 $a'$\u3002\u6709\u89e3\u8fd8\u9700\u8f93\u51fa\u64cd\u4f5c\u6b21\u6570\u548c\u521d\u59cb\u7684 $a$ \u5e8f\u5217\uff08\u5982\u6709\u591a\u89e3\u8f93\u51fa\u4efb\u610f\u4e00\u89e3\u5373\u53ef\uff09\u3002"
}
{
    "description": "Fedya has a string $ S $ , initially empty, and an array $ W $ , also initially empty.\n\nThere are $ n $ queries to process, one at a time. Query $ i $ consists of a lowercase English letter $ c_i $ and a nonnegative integer $ w_i $ . First, $ c_i $ must be appended to $ S $ , and $ w_i $ must be appended to $ W $ . The answer to the query is the sum of suspiciousnesses for all subsegments of $ W $ $ [L, \\ R] $ , $ (1 \\leq L \\leq R \\leq i) $ .\n\nWe define the suspiciousness of a subsegment as follows: if the substring of $ S $ corresponding to this subsegment (that is, a string of consecutive characters from $ L $ -th to $ R $ -th, inclusive) matches the prefix of $ S $ of the same length (that is, a substring corresponding to the subsegment $ [1, \\ R - L + 1] $ ), then its suspiciousness is equal to the minimum in the array $ W $ on the $ [L, \\ R] $ subsegment. Otherwise, in case the substring does not match the corresponding prefix, the suspiciousness is $ 0 $ .\n\nHelp Fedya answer all the queries before the orderlies come for him!",
    "inputFormat": "The first line contains an integer $ n $ $ (1 \\leq n \\leq 600\\,000) $ \u2014 the number of queries.\n\nThe $ i $ -th of the following $ n $ lines contains the query $ i $ : a lowercase letter of the Latin alphabet $ c_i $ and an integer $ w_i $ $ (0 \\leq w_i \\leq 2^{30} - 1) $ .\n\nAll queries are given in an encrypted form. Let $ ans $ be the answer to the previous query (for the first query we set this value equal to $ 0 $ ). Then, in order to get the real query, you need to do the following: perform a cyclic shift of $ c_i $ in the alphabet forward by $ ans $ , and set $ w_i $ equal to $ w_i \\oplus (ans \\ \\& \\ MASK) $ , where $ \\oplus $ is the bitwise exclusive \"or\", $ \\& $ is the bitwise \"and\", and $ MASK = 2^{30} - 1 $ .",
    "outputFormat": "Print $ n $ lines, $ i $ -th line should contain a single integer \u2014 the answer to the $ i $ -th query.",
    "samples": [
        [
            "7\na 1\na 0\ny 3\ny 5\nv 4\nu 6\nr 8",
            "1\n2\n4\n5\n7\n9\n12"
        ],
        [
            "4\na 2\ny 2\nz 0\ny 2",
            "2\n2\n2\n2"
        ],
        [
            "5\na 7\nu 5\nt 3\ns 10\ns 11",
            "7\n9\n11\n12\n13"
        ]
    ],
    "hint": "For convenience, we will call \"suspicious\" those subsegments for which the corresponding lines are prefixes of $ S $ , that is, those whose suspiciousness may not be zero.\n\nAs a result of decryption in the first example, after all requests, the string $ S $ is equal to \"abacaba\", and all $ w_i = 1 $ , that is, the suspiciousness of all suspicious sub-segments is simply equal to $ 1 $ . Let's see how the answer is obtained after each request:\n\n1\\. $ S $ = \"a\", the array $ W $ has a single subsegment \u2014 $ [1, \\ 1] $ , and the corresponding substring is \"a\", that is, the entire string $ S $ , thus it is a prefix of $ S $ , and the suspiciousness of the subsegment is $ 1 $ .\n\n2\\. $ S $ = \"ab\", suspicious subsegments: $ [1, \\ 1] $ and $ [1, \\ 2] $ , total $ 2 $ .\n\n3\\. $ S $ = \"aba\", suspicious subsegments: $ [1, \\ 1] $ , $ [1, \\ 2] $ , $ [1, \\ 3] $ and $ [3, \\ 3] $ , total $ 4 $ .\n\n4\\. $ S $ = \"abac\", suspicious subsegments: $ [1, \\ 1] $ , $ [1, \\ 2] $ , $ [1, \\ 3] $ , $ [1, \\ 4] $ and $ [3, \\ 3] $ , total $ 5 $ .\n\n5\\. $ S $ = \"abaca\", suspicious subsegments: $ [1, \\ 1] $ , $ [1, \\ 2] $ , $ [1, \\ 3] $ , $ [1, \\ 4] $ , $ [1, \\ 5] $ , $ [3, \\ 3] $ and $ [5, \\ 5] $ , total $ 7 $ .\n\n6\\. $ S $ = \"abacab\", suspicious subsegments: $ [1, \\ 1] $ , $ [1, \\ 2] $ , $ [1, \\ 3] $ , $ [1, \\ 4] $ , $ [1, \\ 5] $ , $ [1, \\ 6] $ , $ [3, \\ 3] $ , $ [5, \\ 5] $ and $ [5, \\ 6] $ , total $ 9 $ .\n\n7\\. $ S $ = \"abacaba\", suspicious subsegments: $ [1, \\ 1] $ , $ [1, \\ 2] $ , $ [1, \\ 3] $ , $ [1, \\ 4] $ , $ [1, \\ 5] $ , $ [1, \\ 6] $ , $ [1, \\ 7] $ , $ [3, \\ 3] $ , $ [5, \\ 5] $ , $ [5, \\ 6] $ , $ [5, \\ 7] $ and $ [7, \\ 7] $ , total $ 12 $ .\n\nIn the second example, after all requests $ S $ = \"aaba\", $ W = [2, 0, 2, 0] $ .\n\n1\\. $ S $ = \"a\", suspicious subsegments: $ [1, \\ 1] $ (suspiciousness $ 2 $ ), totaling $ 2 $ .\n\n2\\. $ S $ = \"aa\", suspicious subsegments: $ [1, \\ 1] $ ( $ 2 $ ), $ [1, \\ 2] $ ( $ 0 $ ), $ [2, \\ 2] $ ( $ 0 $ ), totaling $ 2 $ .\n\n3\\. $ S $ = \"aab\", suspicious subsegments: $ [1, \\ 1] $ ( $ 2 $ ), $ [1, \\ 2] $ ( $ 0 $ ), $ [1, \\ 3] $ ( $ 0 $ ), $ [2, \\ 2] $ ( $ 0 $ ), totaling $ 2 $ .\n\n4\\. $ S $ = \"aaba\", suspicious subsegments: $ [1, \\ 1] $ ( $ 2 $ ), $ [1, \\ 2] $ ( $ 0 $ ), $ [1, \\ 3] $ ( $ 0 $ ), $ [1, \\ 4] $ ( $ 0 $ ), $ [2, \\ 2] $ ( $ 0 $ ), $ [4, \\ 4] $ ( $ 0 $ ), totaling $ 2 $ .\n\nIn the third example, from the condition after all requests $ S $ = \"abcde\", $ W = [7, 2, 10, 1, 7] $ .\n\n1\\. $ S $ = \"a\", suspicious subsegments: $ [1, \\ 1] $ ( $ 7 $ ), totaling $ 7 $ .\n\n2\\. $ S $ = \"ab\", suspicious subsegments: $ [1, \\ 1] $ ( $ 7 $ ), $ [1, \\ 2] $ ( $ 2 $ ), totaling $ 9 $ .\n\n3\\. $ S $ = \"abc\", suspicious subsegments: $ [1, \\ 1] $ ( $ 7 $ ), $ [1, \\ 2] $ ( $ 2 $ ), $ [1, \\ 3] $ ( $ 2 $ ), totaling $ 11 $ .\n\n4\\. $ S $ = \"abcd\", suspicious subsegments: $ [1, \\ 1] $ ( $ 7 $ ), $ [1, \\ 2] $ ( $ 2 $ ), $ [1, \\ 3] $ ( $ 2 $ ), $ [1, \\ 4] $ ( $ 1 $ ), totaling $ 12 $ .\n\n5\\. $ S $ = \"abcde\", suspicious subsegments: $ [1, \\ 1] $ ( $ 7 $ ), $ [1, \\ 2] $ ( $ 2 $ ), $ [1, \\ 3] $ ( $ 2 $ ), $ [1, \\ 4] $ ( $ 1 $ ), $ [1, \\ 5] $ ( $ 1 $ ), totaling $ 13 $ .",
    "translation": "\u7ed9\u5b9a\u4e00\u4e2a\u5b57\u7b26\u4e32 $S$ \u548c\u4e00\u4e2a\u5e8f\u5217 $W$\uff0c\u521d\u59cb\u65f6\u5b83\u4eec\u90fd\u4e3a\u7a7a\u3002\n\n\u4f60\u9700\u8981\u5728\u7ebf\u5b8c\u6210 $n$ \u6b21\u64cd\u4f5c\u3002\u6bcf\u6b21\u64cd\u4f5c\u5728 $S$ \u540e\u9762\u6dfb\u52a0\u4e00\u4e2a\u5b57\u7b26 $c_i$\uff0c\u5728\u5e8f\u5217 $W$ \u540e\u9762\u6dfb\u52a0\u4e00\u4e2a\u6570\u5b57 $w_i$\u3002\u4e8c\u8005\u5747\u52a0\u5bc6\u3002\n\n\u52a0\u5bc6\u89c4\u5219\u5982\u4e0b\uff1a\u8bbe $ans$ \u4e3a\u4e0a\u4e00\u4e2a\u67e5\u8be2\u7684\u7b54\u6848\uff0c\u521d\u59cb\u503c\u4e3a $0$\u3002\u5c06 $c_i$ \u6309\u5b57\u5178\u5e8f\u540e\u79fb $ans$ \u4f4d\uff0c\u5c06 $w_i$ \u6539\u6210 $w_i\\oplus (ans \\operatorname{\\&} M)$\uff0c\u5176\u4e2d $M = 2^{30} - 1$\u3002\u7279\u522b\u5730\uff0c\u5b9a\u4e49 `z` \u540e\u79fb\u4e00\u4f4d\u4e3a `a`\u3002\n\n\u5b9a\u4e49\u4e00\u4e2a\u5b50\u533a\u95f4 $[L, R]$ \u7684\u53ef\u7591\u5ea6\u4e3a\uff1a\n\u82e5\u5b50\u4e32 $[L,R]$ \u548c\u524d\u7f00 $[1,R-L+1]$ \u76f8\u540c\uff0c\u5219\u5176\u53ef\u7591\u5ea6\u4e3a $\\min_{i=L}^{R} W_i$\u3002\u5426\u5219\u5176\u53ef\u7591\u5ea6\u4e3a $0$\u3002\n\n\u6bcf\u6b21\u64cd\u4f5c\u540e\uff0c\u4f60\u90fd\u8981\u6c42\u51fa\u5f53\u524d\u7684\u4e32\u7684\u6240\u6709\u5b50\u533a\u95f4\u7684\u53ef\u7591\u5ea6\u4e4b\u548c\u3002\n\n$1\\leq n\\leq 6\\times 10 ^ 5$\uff0c$0\\leq w_i < 2 ^ {30}$\uff0c$c_i$ \u4e3a\u5c0f\u5199\u5b57\u6bcd\u3002"
}
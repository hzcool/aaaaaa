{
    "description": "Monocarp plays a computer game called \"Goblins and Gnomes\". In this game, he manages a large underground city of gnomes and defends it from hordes of goblins.\n\nThe city consists of $ n $ halls and $ m $ one-directional tunnels connecting them. The structure of tunnels has the following property: if a goblin leaves any hall, he cannot return to that hall.\n\nThe city will be attacked by $ k $ waves of goblins; during the $ i $ -th wave, $ i $ goblins attack the city. Monocarp's goal is to pass all $ k $ waves.\n\nThe $ i $ -th wave goes as follows: firstly, $ i $ goblins appear in some halls of the city and pillage them; at most one goblin appears in each hall. Then, goblins start moving along the tunnels, pillaging all the halls in their path.\n\nGoblins are very greedy and cunning, so they choose their paths so that no two goblins pass through the same hall. Among all possible attack plans, they choose a plan which allows them to pillage the maximum number of halls. After goblins are done pillaging, they leave the city.\n\nIf all halls are pillaged during the wave \u2014 Monocarp loses the game. Otherwise, the city is restored. If some hall is pillaged during a wave, goblins are still interested in pillaging it during the next waves.\n\nBefore each wave, Monocarp can spend some time preparing to it. Monocarp doesn't have any strict time limits on his preparations (he decides when to call each wave by himself), but the longer he prepares for a wave, the fewer points he gets for passing it. If Monocarp prepares for the $ i $ -th wave for $ t_i $ minutes, then he gets $ \\max(0, x_i - t_i \\cdot y_i) $ points for passing it (obviously, if he doesn't lose in the process).\n\nWhile preparing for a wave, Monocarp can block tunnels. He can spend one minute to either block all tunnels leading from some hall or block all tunnels leading to some hall. If Monocarp blocks a tunnel while preparing for a wave, it stays blocked during the next waves as well.\n\nHelp Monocarp to defend against all $ k $ waves of goblins and get the maximum possible amount of points!",
    "inputFormat": "The first line contains three integers $ n $ , $ m $ and $ k $ ( $ 2 \\le n \\le 50 $ ; $ 0 \\le m \\le \\frac{n(n - 1)}{2} $ ; $ 1 \\le k \\le n - 1 $ ) \u2014 the number of halls in the city, the number of tunnels and the number of goblin waves, correspondely.\n\nNext $ m $ lines describe tunnels. The $ i $ -th line contains two integers $ u_i $ and $ v_i $ ( $ 1 \\le u_i, v_i \\le n $ ; $ u_i \\ne v_i $ ). It means that the tunnel goes from hall $ u_i $ to hall $ v_i $ . The structure of tunnels has the following property: if a goblin leaves any hall, he cannot return to that hall. There is at most one tunnel between each pair of halls.\n\nNext $ k $ lines describe the scoring system. The $ i $ -th line contains two integers $ x_i $ and $ y_i $ ( $ 1 \\le x_i \\le 10^9 $ ; $ 1 \\le y_i \\le 10^9 $ ). If Monocarp prepares for the $ i $ -th wave for $ t_i $ minutes, then he gets $ \\max(0, x_i - t_i \\cdot y_i) $ points for passing it.",
    "outputFormat": "Print the optimal Monocarp's strategy in the following format:\n\nAt first, print one integer $ a $ ( $ k \\le a \\le 2n + k $ ) \u2014 the number of actions Monocarp will perform. Next, print actions themselves in the order Monocarp performs them. The $ i $ -th action is described by a single integer $ b_i $ ( $ -n \\le b_i \\le n $ ) using the following format:\n\n- if $ b_i > 0 $ then Monocarp blocks all tunnels going out from the hall $ b_i $ ;\n- if $ b_i < 0 $ then Monocarp blocks all tunnels going into the hall $ |b_i| $ ;\n- if $ b_i = 0 $ then Monocarp calls the next goblin wave.\n\nYou can't repeat the same block action $ b_i $ several times. Monocarp must survive all waves he calls (goblins shouldn't be able to pillage all halls). Monocarp should call exactly $ k $ waves and earn the maximum possible number of points in total.\n\nIf there are several optimal strategies \u2014 print any of them.",
    "samples": [
        [
            "5 4 4\n1 2\n2 3\n4 3\n5 3\n100 1\n200 5\n10 10\n100 1",
            "6\n-2 -3 0 0 0 0"
        ],
        [
            "5 4 4\n1 2\n2 3\n4 3\n5 3\n100 100\n200 5\n10 10\n100 1",
            "6\n0 -3 0 0 1 0"
        ],
        [
            "5 10 1\n1 2\n1 3\n1 4\n1 5\n5 2\n5 3\n5 4\n4 2\n4 3\n2 3\n100 100",
            "6\n1 2 3 4 5 0"
        ]
    ],
    "hint": "In the first example, Monocarp, firstly, block all tunnels going in hall $ 2 $ , secondly \u2014 all tunnels going in hall $ 3 $ , and after that calls all waves. He spent two minutes to prepare to wave $ 1 $ , so he gets $ 98 $ points for it. He didn't prepare after that, that's why he gets maximum scores for each of next waves ( $ 200 $ , $ 10 $ and $ 100 $ ). In total, Monocarp earns $ 408 $ points.\n\nIn the second example, Monocarp calls for the first wave immediately and gets $ 100 $ points. Before the second wave he blocks all tunnels going in hall $ 3 $ . He spent one minute preparing to the wave, so he gets $ 195 $ points. Monocarp didn't prepare for the third wave, so he gets $ 10 $ points by surviving it. Before the fourth wave he blocks all tunnels going out from hall $ 1 $ . He spent one minute, so he gets $ 99 $ points for the fourth wave. In total, Monocarp earns $ 404 $ points.\n\nIn the third example, it doesn't matter how many minutes Monocarp will spend before the wave, since he won't get any points for it. That's why he decides to block all tunnels in the city, spending $ 5 $ minutes. He survived the wave though without getting any points.",
    "translation": "### \u9898\u610f\n\u6709\u4e00\u4e2a $n$ \u4e2a\u70b9\u7684 DAG\uff0c\u73b0\u5728\u6709 $k$ \u6ce2\u8fdb\u653b\uff0c\u7b2c $i$ \u6ce2\u6709 $i$ \u4e2a\u4eba\uff0c\u5b83\u4eec\u6bcf\u4e2a\u4eba\u4f1a\u9009\u62e9\u4e00\u6761 DAG \u4e0a\u7684\u8def\u5f84\uff0c\u5e76\u5360\u9886\u8fd9\u4e2a\u8def\u5f84\u4e0a\u7684\u6240\u6709\u70b9\uff0c\u8def\u5f84\u4e4b\u95f4\u662f\u4e0d\u80fd\u76f8\u4ea4\u7684\u3002\u7b2c $i$ \u6ce2\u8fdb\u653b\u524d\u53ef\u4ee5\u505a\u4e00\u4e9b\u51c6\u5907\uff0c\u53ef\u4ee5\u82b1 $1$ \u79d2\u5173\u95ed\u67d0\u4e2a\u70b9\u7684\u6240\u6709\u5165\u8fb9\uff0c\u6216\u5173\u95ed\u67d0\u4e2a\u70b9\u7684\u6240\u6709\u51fa\u8fb9\u3002\u7b2c $i$ \u6ce2\u8fdb\u653b\u6709\u4e2a\u53c2\u6570 $a_i,b_i$\uff0c\u5982\u679c\u82b1\u8d39\u4e86 $t_i$ \u65f6\u95f4\u51c6\u5907\uff0c\u5982\u679c\u4e0d\u4f1a\u6240\u6709\u70b9\u90fd\u88ab\u5360\u9886\uff0c\u5c31\u4f1a\u83b7\u5f97\u6536\u76ca $\\max(0,a_i-tb_i)$\uff0c\u5982\u679c\u88ab\u5360\u9886\u5c31\u4e0d\u4f1a\u6709\u6536\u76ca\u4e86\uff0c\u6c42\u6700\u5927\u6536\u76ca\uff0c\u8f93\u51fa\u65b9\u6848\u3002\n\n$n \\leq 50$\u3002"
}
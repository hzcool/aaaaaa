{
    "description": "This is the hard version of the problem. The difference between versions is the constraints on $ n $ and $ a_i $ . You can make hacks only if all versions of the problem are solved.\n\nFirst, Aoi came up with the following idea for the competitive programming problem:\n\nYuzu is a girl who collecting candies. Originally, she has $ x $ candies. There are also $ n $ enemies numbered with integers from $ 1 $ to $ n $ . Enemy $ i $ has $ a_i $ candies.\n\nYuzu is going to determine a permutation $ P $ . A permutation is an array consisting of $ n $ distinct integers from $ 1 $ to $ n $ in arbitrary order. For example, $ \\{2,3,1,5,4\\} $ is a permutation, but $ \\{1,2,2\\} $ is not a permutation ( $ 2 $ appears twice in the array) and $ \\{1,3,4\\} $ is also not a permutation (because $ n=3 $ but there is the number $ 4 $ in the array).\n\nAfter that, she will do $ n $ duels with the enemies with the following rules:\n\n- If Yuzu has equal or more number of candies than enemy $ P_i $ , she wins the duel and gets $ 1 $ candy. Otherwise, she loses the duel and gets nothing.\n- The candy which Yuzu gets will be used in the next duels.\n\nYuzu wants to win all duels. How many valid permutations $ P $ exist?\n\nThis problem was easy and wasn't interesting for Akari, who is a friend of Aoi. And Akari made the following problem from the above idea:\n\nLet's define $ f(x) $ as the number of valid permutations for the integer $ x $ .\n\nYou are given $ n $ , $ a $ and a prime number $ p \\le n $ . Let's call a positive integer $ x $ good, if the value $ f(x) $ is not divisible by $ p $ . Find all good integers $ x $ .\n\nYour task is to solve this problem made by Akari.",
    "inputFormat": "The first line contains two integers $ n $ , $ p $ $ (2 \\le p       \\le n \\le 10^5) $ . It is guaranteed, that the number $ p $ is prime (it has exactly two divisors $ 1 $ and $ p $ ).\n\nThe second line contains $ n $ integers $ a_1, a_2, \\ldots,       a_n $ $ (1 \\le a_i \\le 10^9) $ .",
    "outputFormat": "In the first line, print the number of good integers $ x $ .\n\nIn the second line, output all good integers $ x $ in the ascending order.\n\nIt is guaranteed that the number of good integers $ x $ does not exceed $ 10^5 $ .",
    "samples": [
        [
            "3 2\n3 4 5",
            "1\n3"
        ],
        [
            "4 3\n2 3 5 6",
            "2\n3 4"
        ],
        [
            "4 3\n9 1 1 1",
            "0"
        ],
        [
            "3 2\n1000000000 1 999999999",
            "1\n999999998"
        ]
    ],
    "hint": "In the first test, $ p=2 $ .\n\n- If $ x \\le 2 $ , there are no valid permutations for Yuzu. So $ f(x)=0 $ for all $ x \\le 2 $ . The number $ 0 $ is divisible by $ 2 $ , so all integers $ x \\leq 2 $ are not good.\n- If $ x = 3 $ , $ \\{1,2,3\\} $ is the only valid permutation for Yuzu. So $ f(3)=1 $ , so the number $ 3 $ is good.\n- If $ x = 4 $ , $ \\{1,2,3\\} , \\{1,3,2\\} , \\{2,1,3\\} ,         \\{2,3,1\\} $ are all valid permutations for Yuzu. So $ f(4)=4 $ , so the number $ 4 $ is not good.\n- If $ x \\ge 5 $ , all $ 6 $ permutations are valid for Yuzu. So $ f(x)=6 $ for all $ x \\ge 5 $ , so all integers $ x \\ge 5 $ are not good.\n\nSo, the only good number is $ 3 $ .\n\nIn the third test, for all positive integers $ x $ the value $ f(x) $ is divisible by $ p = 3 $ .",
    "translation": "\u8fd9\u662f\u95ee\u9898 E \u7684\u56f0\u96be\u7248\u672c\u3002\u5b83\u4e0e E1 \u7684\u552f\u4e00\u533a\u522b\u5728\u4e8e $n$ \u548c $a_i$ \u7684\u5927\u5c0f\u3002\n\nYuzu~~soft~~ \u662f\u4e00\u4e2a\u6536\u96c6\u7cd6\u679c\u7684\u5973\u5b69\u3002\u6700\u521d\uff0c\u5979\u6709 $x$ \u4e2a\u7cd6\u679c\u3002\u6709 $n$ \u4e2a\u654c\u4eba\uff0c\u7f16\u53f7\u4ece $1$ \u5230 $n$\uff0c\u7b2c $i$ \u4e2a\u654c\u4eba\u6709 $a_i$ \u4e2a\u7cd6\u679c\u3002\n\nYuzu \u9700\u8981\u786e\u5b9a\u4e00\u4e2a $1$ \u5230 $n$ \u7684\u6392\u5217 $P$\u3002\u5728\u6b64\u4e4b\u540e\uff0c\u5979\u6309\u7167\u4ee5\u4e0b\u89c4\u5219\u6311\u6218\u654c\u4eba\uff1a\n\n- \u5982\u679c Yuzu \u7684\u7cd6\u679c\u4e0d\u5c11\u4e8e\u7f16\u53f7\u4e3a $P_i$ \u7684\u654c\u4eba\u7684\u7cd6\u679c\uff0c\u5979\u4f1a\u8d62\u5f97\u4e00\u4e2a\u7cd6\u679c\u3002\u5426\u5219\uff0c\u5979\u4ec0\u4e48\u4e5f\u5f97\u4e0d\u5230\u3002\n- \u5f97\u5230\u7684\u7cd6\u679c\u52a0\u5165\u5979\u62e5\u6709\u7cd6\u679c\u7684\u603b\u6570\u91cf\u4e2d\uff0c\u53ef\u4ee5\u5728\u4e0b\u6b21\u6311\u6218\u4e2d\u4f7f\u7528\u3002\n\nYuzu \u60f3\u8d62\u5f97\u6240\u6709\u6311\u6218\u3002\u6709\u591a\u5c11\u79cd\u6392\u5217 $P$\uff1f\n\n\u7136\u800c\uff0c\u8fd9\u4e2a\u95ee\u9898\u592a\u7b80\u5355\u4e86\u3002\u8bbe $f(x)$ \u4e3a Yuzu \u521d\u59cb\u6709 $x$ \u4e2a\u7cd6\u679c\u65f6\u7684\uff0c\u5408\u6cd5\u7684\u6392\u5217\u603b\u6570\u3002\u7ed9\u5b9a\u8d28\u6570 $p \\leq n$\uff0c\u90a3\u4e48\u4f60\u9700\u8981\u6c42\u51fa\u6709\u591a\u5c11\u4e2a $x$ \u4f7f\u5f97 $p \\nmid f(x)$\uff0c\u5176\u4e2d $p \\nmid f(x)$ \u8868\u793a $f(x)$ \u4e0d\u80fd\u88ab $p$ \u6574\u9664\u3002\n\n$2 \\leq p \\leq n \\leq 10^5,1 \\leq a_i \\leq 10^9$\n\n\u7ffb\u8bd1 by Meatherm\n\n"
}
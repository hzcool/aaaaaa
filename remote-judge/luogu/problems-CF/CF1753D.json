{
    "description": "Andrew loves the sea. That's why, at the height of the summer season, he decided to go to the beach, taking a sunbed with him to sunbathe.\n\nThe beach is a rectangular field with $ n $ rows and $ m $ columns. Some cells of the beach are free, some have roads, stones, shops and other non-movable objects. Some of two adjacent along the side cells can have sunbeds located either horizontally or vertically.\n\nAndrew hopes to put his sunbed somewhere, but that's a bad luck, there may no longer be free places for him! That's why Andrew asked you to help him to find a free place for his sunbed. Andrew's sunbed also should be places on two adjacent cells.\n\nIf there are no two adjacent free cells, then in order to free some place for a sunbed, you will have to disturb other tourists. You can do the following actions:\n\n- Come to some sunbed and, after causing $ p $ units of discomfort to its owner, lift the sunbed by one of its sides and rotate it by $ 90 $ degrees. One half of the sunbed must remain in the same cell and another half of the sunbed must move to the free cell. At the same time, anything could be on the way of a sunbed during the rotation . ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1753D/09cf95acda528113fcf87f6bc31ab7d9580f9b23.png)![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1753D/e96ec982370c391087a31ef1cfeb944b9fd4ac91.png)![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1753D/8b6042ca01ea6cacf0633d3660a9b5fb584e0afa.png)Rotation of the sunbed by $ 90 $ degrees around cell $ (1, 2) $ .\n- Come to some sunbed and, after causing $ q $ units of discomfort to its owner, shift the sunbed along its long side by one cell. One half of the sunbed must move to the place of another, and another \u2014 to the free cell. ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1753D/09cf95acda528113fcf87f6bc31ab7d9580f9b23.png)![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1753D/e96ec982370c391087a31ef1cfeb944b9fd4ac91.png)![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1753D/064eca01a3f71efefd1525ba89d6d5585d09cb41.png)Shift of the sunbed by one cell to the right.\n\nIn any moment each sunbed occupies two adjacent free cells. You cannot move more than one sunbed at a time.\n\nHelp Andrew to free a space for his sunbed, causing the minimum possible number of units of discomfort to other tourists, or detect that it is impossible.",
    "inputFormat": "The first line contains two integers $ n $ and $ m $ ( $ 1 \\le n, m \\le 300\\,000 $ , $ 1 \\le n \\cdot m \\le 300\\,000 $ ) \u2014 the number of rows and columns in rectangle.\n\nThe second line contains two integers $ p $ and $ q $ ( $ 1 \\le p, q \\le 10^9 $ ) \u2014 the number of units of discomfort caused by rotation and shift of a sunbed, respectively.\n\nEach of the following $ n $ lines contains $ m $ characters, describing cells of the rectangle. Each lines consists of characters \"L\", \"R\", \"D\", \"U\", \".\" and \"\\#\", denoting the type of the cell. Characters \"L\", \"R\", \"D\" and \"U\" denote a half of a sunbed placed in the cell \u2014 left, right, bottom and top half, respectively. Character \".\" denotes a free cell and character \"\\#\" \u2014 a cell, occupied by some non-movable object.",
    "outputFormat": "Print one integer \u2014 the minimum possible number of units of discomfort, caused to other tourists, to free a space for a sunbed. If it is impossible to free a space for a sunbed, print $ -1 $ .",
    "samples": [
        [
            "2 5\n5 2\n.LR##\n##LR.",
            "4"
        ],
        [
            "2 3\n4 5\nLR.\n#.#",
            "-1"
        ],
        [
            "4 3\n10 10\n.LR\n###\nUU#\nDD.",
            "-1"
        ],
        [
            "3 6\n10 7\n.U##.#\n#DLR##\n.##LR.",
            "24"
        ]
    ],
    "hint": "In the first example we can shift upper sunbed to the left and lower sunbed \u2014 to the right. Andrew will be able to put his sunbed vertically in the middle of the beach. We well cause $ 2 + 2 = 4 $ units of discomfort. It is easy to prove that it is an optimal answer.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1753D/068dcd3f383e5c13a23b270ba14b23f29dcfb57a.png)![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1753D/e96ec982370c391087a31ef1cfeb944b9fd4ac91.png)![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1753D/e2807d62f101bfa5c0609da1577d4e543cbce572.png)Optimal strategy in the first example (Andrew's sunbed is colored white).  In the second example it is impossible to free a space for Andrew's sunbed. All possible states of the beach after any rotates and shifts are illustrated in the problem statement.",
    "translation": "## \u9898\u76ee\u5927\u610f\n\n\u6709\u4e00\u4e2a $n\\times m$ \u7684\u7f51\u683c\u56fe\uff0c\u573a\u5730\u4e0a\u6709\u8bb8\u591a\u4e0d\u53ef\u79fb\u52a8\u7684\u969c\u788d\uff0c\u6807\u8bb0\u4e3a `#`\uff0c\u8fd8\u6709\u4e00\u4e9b\u53ef\u4ee5\u79fb\u52a8\u7684\u969c\u788d\uff0c\u5982\u679c\u4ed6\u662f\u6a2a\u7740\u7684\uff0c\u5b9a\u4e49\u5b83\u7684\u4e00\u8fb9\u4e3a `L`\uff0c\u53e6\u4e00\u8fb9\u4e3a `R`\uff1b\u5426\u5219\u5b9a\u4e49\u5b83\u7684\u4e0a\u8fb9\u4e3a `U`\uff0c\u4e0b\u8fb9\u4e3a `D`\uff0c\u73b0\u5728\u9700\u8981\u5728\u8fd9\u4e2a\u7f51\u683c\u56fe\u4e2d\u7a7a\u51fa\u4e00\u4e2a $1\\times 2$ \u7684\u7a7a\u4f4d\uff0c\u53ef\u4ee5\u79fb\u52a8\u7684\u969c\u788d\u79fb\u52a8\u5982\u4e0b\uff1a\n\n- \u9009\u62e9\u56fa\u5b9a\u5b83\u7684\u4e00\u8fb9\uff0c\u5c06\u5176\u65cb\u8f6c $90^\\degree$\uff0c\u82b1\u8d39 $p$ \u5355\u4f4d\uff0c\u524d\u63d0\u662f\u65cb\u8f6c\u540e\u4e0d\u51c6\u4e0e\u5176\u4ed6\u969c\u788d\u91cd\u5408\u3002\n- \u5c06\u5176\u5e73\u79fb\u4e00\u4e2a\u5355\u4f4d\uff0c\u82b1\u8d39 $q$ \u5355\u4f4d\uff0c\u524d\u63d0\u662f\u5e73\u79fb\u540e\u4e0d\u51c6\u4e0e\u5176\u4ed6\u969c\u788d\u91cd\u5408\u3002\n\n\u73b0\u5728\u8981\u6c42\u51fa\u5728\u8fd9\u4e2a\u7f51\u683c\u56fe\u91cc\u7a7a\u51fa $1\\times 2$ \u7684\u7a7a\u4f4d\uff0c\u81f3\u5c11\u9700\u8981\u82b1\u8d39\u591a\u5c11\u5355\u4f4d\uff0c\u5982\u679c\u4e0d\u53ef\u80fd\uff0c\u8f93\u51fa `-1`\u3002\n\n## \u8f93\u5165\u683c\u5f0f\n\n\u7b2c\u4e00\u884c\u4e24\u4e2a\u6574\u6570 $1\\leqslant n,m\\leqslant 3\\times 10^5,n\\times m\\leqslant 3\\times 10^5$\uff0c\u8868\u793a\u8fd9\u4e2a\u7f51\u683c\u7684\u5927\u5c0f\u3002\n\n\u7b2c\u4e8c\u884c\u4e24\u4e2a\u6574\u6570 $1\\leqslant p,q\\leqslant 10^9$\uff0c\u5982\u9898\u610f\u6240\u8ff0\u3002\n\n\u63a5\u4e0b\u6765 $n$ \u884c\uff0c\u6bcf\u884c $m$ \u4e2a\u5b57\u7b26\uff0c\u6bcf\u4e2a\u5b57\u7b26\u4e3a `.`\uff08\u8868\u793a\u7a7a\u4f4d\uff09\u3001`#`\uff08\u8868\u793a\u4e0d\u53ef\u79fb\u52a8\u969c\u788d\uff09\u3001`L`\u3001`R`\u3001`U`\u3001`D`\uff08\u5206\u522b\u8868\u793a\u53ef\u79fb\u52a8\u7684\u969c\u788d\u662f\u5982\u4f55\u6446\u653e\u7684\uff09\u4e2d\u7684\u4e00\u79cd\u3002\n\n## \u8f93\u51fa\u683c\u5f0f\n\n\u8f93\u51fa\u4e00\u4e2a\u6574\u6570\u8868\u793a\u6700\u5c0f\u82b1\u8d39\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u65b9\u6848\uff0c\u8f93\u51fa `-1`\u3002\n\n## \u6837\u4f8b\u89e3\u91ca\n\n\u7b2c\u4e00\u4e2a\u6837\u4f8b\u4e2d\u53ef\u4ee5\u628a\u4f4d\u4e8e $(1,2),(1,3)$ \u7684\u969c\u788d\u5f80\u5de6\u79fb\u52a8\u4e00\u683c\uff0c$(2,3),(2,4)$ \u7684\u969c\u788d\u5f80\u53f3\u79fb\u52a8\u4e00\u683c\uff0c\u82b1\u8d39 $2q=4$\u3002\n\n\u7b2c\u4e8c\u4e2a\u6837\u4f8b\u4e2d\u65e0\u8bba\u5982\u4f55\u79fb\u52a8\u969c\u788d\u90fd\u4e0d\u53ef\u80fd\u7a7a\u51fa $1\\times 2$ \u7684\u7a7a\u4f4d\uff0c\u8f93\u51fa `-1`\u3002"
}
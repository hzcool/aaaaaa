{
    "description": "There are $ n $ people at a party. The $ i $ -th person has an amount of happiness $ a_i $ .\n\nEvery person has a certain kind of personality which can be represented as a binary integer $ b $ . If $ b = 0 $ , it means the happiness of the person will increase if he tells the story to someone strictly less happy than them. If $ b = 1 $ , it means the happiness of the person will increase if he tells the story to someone strictly more happy than them.\n\nLet us define a speaking order as an ordering of the people from left to right. Now the following process occurs. We go from left to right. The current person tells the story to all people other than himself. Note that all happiness values stay constant while this happens. After the person is done, he counts the number of people who currently have strictly less/more happiness than him as per his kind of personality, and his happiness increases by that value. Note that only the current person's happiness value increases.\n\nAs the organizer of the party, you don't want anyone to leave sad. Therefore, you want to count the number of speaking orders such that at the end of the process all $ n $ people have equal happiness.\n\nTwo speaking orders are considered different if there exists at least one person who does not have the same position in the two speaking orders.",
    "inputFormat": "The first line contains a single integer $ n $ ( $ 1 \\leq n \\leq 2 \\cdot 10^5 $ ) \u2014 the number of people.\n\nThe second line contains a sequence of $ n $ integers $ a_1,a_2,...,a_n $ ( $ 1 \\leq a_i \\leq 2n $ ) \u2014 the happiness values.\n\nThe third line contains a sequence of $ n $ binary numbers $ b_1,b_2,...,b_n $ ( $ b_i \\in \\{0,1\\} $ ) \u2014 the kinds of personality.",
    "outputFormat": "Output the number of different valid speaking orders. Since this number can be large, output it modulo $ 998244353 $ .",
    "samples": [
        [
            "4\n1 2 4 4\n1 1 0 0",
            "2"
        ],
        [
            "4\n3 4 3 1\n0 1 0 0",
            "0"
        ],
        [
            "21\n1 2 19 19 19 19 19 19 19 19 19 21 21 21 21 21 21 21 21 21 21\n1 1 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1",
            "49439766"
        ]
    ],
    "hint": "Here is the explanation for the first example. One valid speaking order is $ [2,1,4,3] $ (here, we have written the indices of each person). Each step shows the current happiness values and results.\n\nStep $ 1 $ : $ [1,2,4,4] $ $ \\rightarrow $ Person $ 2 $ tells the story to others. Since his kind of personality is $ 1 $ , his happiness increases by $ 2 $ since persons $ 3 $ and $ 4 $ have strictly greater happiness.\n\nStep $ 2 $ : $ [1,4,4,4] $ $ \\rightarrow $ Person $ 1 $ tells the story to others. Since his kind of personality is $ 1 $ , his happiness increases by $ 3 $ since persons $ 2 $ , $ 3 $ and $ 4 $ have strictly greater happiness.\n\nStep $ 3 $ : $ [4,4,4,4] $ $ \\rightarrow $ Person $ 4 $ tells the story to others. Since his kind of personality is $ 0 $ , his happiness increases by $ 0 $ since no one has strictly lesser happiness.\n\nStep $ 4 $ : $ [4,4,4,4] $ $ \\rightarrow $ Person $ 3 $ tells the story to others. Since his kind of personality is $ 0 $ , his happiness increases by $ 0 $ since no one has strictly lesser happiness.\n\nAt the end, everyone has equal happiness.\n\nNote that $ [2,1,3,4] $ is also a valid answer for this example.\n\nIt can be shown that there is no valid ordering for the second example.",
    "translation": "## \u9898\u610f\u7ffb\u8bd1\n### \u9898\u76ee\u63cf\u8ff0\n\u805a\u4f1a\u4e0a\u6709 $n$ \u4e2a\u4eba\uff0c\u7b2c $i$ \u4e2a\u4eba\u6709\u4e00\u4e2a\u5f00\u5fc3\u6307\u6570 $a_i$ \u3002\n\n\u6bcf\u4e2a\u4eba\u90fd\u6709\u4e00\u79cd\u786e\u5b9a\u7684\u4e2a\u6027\uff0c\u8fd9\u79cd\u4e2a\u6027\u53ef\u4ee5\u7528\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6574\u6570 $b$ \u6765\u8868\u793a\u3002\u5982\u679c $b=0$ \uff0c\u90a3\u4e48\u610f\u5473\u7740\u5982\u679c\u4ed6\u5c06\u4e00\u4e2a\u6545\u4e8b\u8bb2\u7ed9\u4e00\u4e2a\u5f00\u5fc3\u6307\u6570\u6bd4\u4ed6\u4f4e\u7684\u4eba\uff0c\u4ed6\u7684\u5f00\u5fc3\u6307\u6570\u5c31\u4f1a\u589e\u52a0\u3002\u5982\u679c $b=1$ \uff0c\u90a3\u4e48\u610f\u5473\u7740\u5982\u679c\u4ed6\u5c06\u4e00\u4e2a\u6545\u4e8b\u8bb2\u7ed9\u4e00\u4e2a\u5f00\u5fc3\u6307\u6570\u6bd4\u4ed6\u9ad8\u7684\u4eba\uff0c\u4ed6\u7684\u5f00\u5fc3\u6307\u6570\u5c31\u4f1a\u589e\u52a0\u3002\n\n\u8ba9\u6211\u4eec\u5b9a\u4e49\u8bb2\u6545\u4e8b\u7684\u987a\u5e8f\u4e3a\u4ece\u5de6\u5230\u53f3\u3002\u63a5\u4e0b\u6765\u53d1\u751f\u4ee5\u4e0b\u8fc7\u7a0b\uff1a\u4ece\u5de6\u81f3\u53f3\u7684\u6bcf\u4e2a\u4eba\u7ed9\u9664\u4ed6\u4ee5\u5916\u7684\u6240\u6709\u4eba\u542c\u3002\u8bf7\u6ce8\u610f\uff0c\u5f53\u8fd9\u53d1\u751f\u65f6\uff0c**\u6240\u6709\u7684\u5feb\u4e50\u6307\u6570\u4fdd\u6301\u4e0d\u53d8**\u3002\u5f53\u8fd9\u4e2a\u4eba\u8bb2\u5b8c\u4ee5\u540e\uff0c\u4ed6\u4f1a\u6839\u636e\u4ed6\u7684\u4e2a\u6027\u8ba1\u7b97\u76ee\u524d\u5f00\u5fc3\u6307\u6570\u6bd4\u4ed6\u5c11/\u591a\u7684\u4eba\u6570\uff0c\u4ed6\u7684\u5f00\u5fc3\u6307\u6570\u4f1a\u52a0\u4e0a\u8fd9\u4e2a\u91cf\u3002\u8bf7\u6ce8\u610f\uff0c**\u53ea\u6709\u5f53\u524d\u7684\u4eba\u7684\u5feb\u4e50\u6307\u6570\u589e\u52a0**\u3002\n\n\u4f5c\u4e3a\u805a\u4f1a\u7684\u7ec4\u7ec7\u8005\uff0c\u4f60\u4e0d\u5e0c\u671b\u4efb\u4f55\u4eba\u4f24\u5fc3\u5730\u79bb\u5f00\u3002\u56e0\u6b64\uff0c\u4f60\u9700\u8981\u8ba1\u7b97\u53ef\u4ee5\u4f7f\u5f97\u5168\u90e8 $n$ \u4eba\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u7684\u6700\u540e\u5f00\u5fc3\u6307\u6570\u90fd\u76f8\u540c\u7684\u53d1\u8a00\u987a\u5e8f\u7684\u6570\u91cf\u3002\u5982\u679c\u4e24\u4e2a\u53d1\u8a00\u987a\u5e8f\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u4eba\u7684\u4f4d\u7f6e\u4e0d\u540c\uff0c\u5219\u8fd9\u4e24\u4e2a\u53d1\u8a00\u987a\u5e8f\u662f\u4e0d\u540c\u7684\u3002\n\n\n### \u8f93\u5165\u683c\u5f0f\n\u7b2c\u4e00\u884c\u4e3a\u4e00\u4e2a\u6b63\u6574\u6570 $n (1  \\leq n \\leq 2\\times10^5)$ \uff0c\u4ee3\u8868\u4e86\u4eba\u6570\u3002\n\n\u7b2c\u4e8c\u884c\u4e3a $n$ \u4e2a\u6b63\u6574\u6570 $a_1 , a_2 ,...,a_n(1\\leq a_i\\leq 2n)$ \uff0c\u4ee3\u8868\u4e86\u6bcf\u4e2a\u4eba\u7684\u5f00\u5fc3\u6307\u6570\u3002\n\n\u7b2c\u4e09\u884c\u4e3a $n$ \u4e2a\u4e8c\u8fdb\u5236\u6574\u6570 $b_1 , b_2 ,...,b_n(b_i \\in \\{1,2\\})$ \uff0c\u4ee3\u8868\u4e86\u6bcf\u4e2a\u4eba\u7684\u4e2a\u6027\u3002\n\n\n### \u8f93\u51fa\u683c\u5f0f\n\u8f93\u51fa\u4e0d\u540c\u53d1\u8a00\u987a\u5e8f\u7684\u603b\u4e2a\u6570\u7531\u4e8e\u8fd9\u4e2a\u6570\u5b57\u53ef\u80fd\u5f88\u5927\uff0c\u6240\u4ee5\u8bf7\u5c06\u5b83\u6a21 $998244353$ \u8f93\u51fa\u3002"
}
{
    "description": "A map is a matrix consisting of symbols from the set of 'U', 'L', 'D', and 'R'.\n\nA map graph of a map matrix $ a $ is a directed graph with $ n \\cdot m $ vertices numbered as $ (i, j) $ ( $ 1 \\le i \\le n; 1 \\le j \\le m $ ), where $ n $ is the number of rows in the matrix, $ m $ is the number of columns in the matrix. The graph has $ n \\cdot m $ directed edges $ (i, j) \\to (i + di_{a_{i, j}}, j + dj_{a_{i, j}}) $ , where $ (di_U, dj_U) = (-1, 0) $ ; $ (di_L, dj_L) = (0, -1) $ ; $ (di_D, dj_D) = (1, 0) $ ; $ (di_R, dj_R) = (0, 1) $ . A map graph is valid when all edges point to valid vertices in the graph.\n\nAn admissible map is a map such that its map graph is valid and consists of a set of cycles.\n\nA description of a map $ a $ is a concatenation of all rows of the map \u2014 a string $ a_{1,1} a_{1,2} \\ldots a_{1, m} a_{2, 1} \\ldots a_{n, m} $ .\n\nYou are given a string $ s $ . Your task is to find how many substrings of this string can constitute a description of some admissible map.\n\nA substring of a string $ s_1s_2 \\ldots s_l $ of length $ l $ is defined by a pair of indices $ p $ and $ q $ ( $ 1 \\le p \\le q \\le l $ ) and is equal to $ s_ps_{p+1} \\ldots s_q $ . Two substrings of $ s $ are considered different when the pair of their indices $ (p, q) $ differs, even if they represent the same resulting string.",
    "inputFormat": "In the only input line, there is a string $ s $ , consisting of at least one and at most $ 20\\,000 $ symbols 'U', 'L', 'D', or 'R'.",
    "outputFormat": "Output one integer \u2014 the number of substrings of $ s $ that constitute a description of some admissible map.",
    "samples": [
        [
            "RDUL",
            "2"
        ],
        [
            "RDRU",
            "0"
        ],
        [
            "RLRLRL",
            "6"
        ]
    ],
    "hint": "In the first example, there are two substrings that can constitute a description of an admissible map \u2014 \"RDUL\" as a matrix of size $ 2 \\times 2 $ (pic. 1) and \"DU\" as a matrix of size $ 2 \\times 1 $ (pic. 2).\n\nIn the second example, no substring can constitute a description of an admissible map. E. g. if we try to look at the string \"RDRU\" as a matrix of size $ 2 \\times 2 $ , we can find out that the resulting graph is not a set of cycles (pic. 3).\n\nIn the third example, three substrings \"RL\", two substrings \"RLRL\" and one substring \"RLRLRL\" can constitute an admissible map, some of them in multiple ways. E. g. here are two illustrations of substring \"RLRLRL\" as matrices of size $ 3 \\times 2 $ (pic. 4) and $ 1 \\times 6 $ (pic. 5).\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1666A/7b0f47ed84a4fc965364c0dcb66b1066a58824c1.png)\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1666A/ae14f0b812a17c2ccfba01d97742a575c6bef3b7.png)\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1666A/1bf548996b58314f04b8c00347ef677531624f46.png)\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1666A/288f2baeb453d4c4da44fd0bf50b7f4c742f1558.png)\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1666A/a3b89f548182f9ca6d4fa8df48a043cd43ce3afe.png)",
    "translation": "\u6240\u8c13\u201c\u6620\u5c04\u201d\uff0c\u662f\u7531 'U'\u3001'L'\u3001'D' \u548c 'R' \u56db\u4e2a\u5b57\u7b26\u7ec4\u6210\u7684\u77e9\u9635\u3002\n\n\u5bf9\u4e8e\u6620\u5c04\u77e9\u9635 $a$, \u6709\u4e00 $n \\cdot m$ \u6709\u5411\u6620\u5c04\u56fe\uff08$n$ \u4e3a\u77e9\u9635 $a$ \u7684\u884c\u6570\uff0c$m$ \u4e3a\u77e9\u9635 $a$ \u7684\u5217\u6570\uff09\uff0c\u56fe\u4e2d\u6709 $n \\cdot m$ \u6761\u6709\u5411\u8fb9\uff0c\u5f62\u5f0f\u5982\u4e0b\uff1a\n\n- $(i,j) \\rightarrow (i+di_{a_{i,j}},j+dj_{a_{i,j}})$\n\n\u5176\u4e2d\uff1a\n\n- $(i,j)$ \u4e0e $(i+di_{a_{i,j}},j+dj_{a_{i,j}})$ \u90fd\u8868\u793a $a$ \u7684\u6709\u5411\u6620\u5c04\u56fe\u4e2d\u7684\u9876\u70b9\uff1b\n- $\\rightarrow$ \u8868\u793a\u6307\u5411\uff1b\n\n- $(di_U,dj_U)=(-1,0)$;\n\n- $(di_L,dj_L)=(0,-1)$;\n\n- $(di_D,dj_D)=(1,0)$;\n\n- $(di_R,dj_R)=(0,1)$;\n- $a_{i,j}$ \u4e3a\u6620\u5c04\u77e9\u9635 $a$ \u4e2d\u7b2c $i$ \u884c\u7b2c $j$ \u5217\u7684\u5b57\u7b26\u3002\n\n\uff08$di_U$ \u4e2d\u7684 'U', $di_L$ \u4e2d\u7684 'L', $di_D$ \u4e2d\u7684 'D', $di_R$ \u4e2d\u7684 'R' \u7686\u4e3a\u6620\u5c04\u77e9\u9635 $a$ \u4e2d\u7684\u5b57\u7b26\uff09\n\n\u6211\u4eec\u5c06\u56fe\u4e2d\u4efb\u610f\u4e00\u8fb9\u90fd\u6307\u5411\u6709\u6548\u9876\u70b9\u7684\u6620\u5c04\u56fe\u89c6\u4f5c\u201c\u6709\u6548\u7684\u201d\u3002\n\n\u56e0\u800c\u5b9a\u4e49\uff1a\u5bb9\u8bb8\u6620\u5c04\u662f\u5176\u6620\u5c04\u56fe\u6709\u6548\u4e14\u5176\u4e2d\u5b58\u5728\u5982\u201c\u8bf4\u660e/\u63d0\u793a\u201d\u4e2d\u6240\u5c55\u793a\u7684\u201c\u5faa\u73af\u201d\u7684\u6620\u5c04\u3002\n\n\u6211\u4eec\u7528\u4e00\u4e32\u7531\u6620\u5c04 $a$ \u4e2d\u6240\u6709\u5b57\u7b26\u7ec4\u6210\u4e14\u6309\u7167\u5982\u4e0b\u987a\u5e8f\u6392\u5217\u7684\u5b57\u7b26\u4e32\u63cf\u8ff0\u6620\u5c04 $a$\uff1a\n\n- $a_{1,1}a_{1,2}\u2026a_{1,m}a_{2,1}\u2026a_{n,m}$\uff08$n,m$ \u540c\u4e0a\u8ff0\uff09\u3002\n\n\u7ed9\u51fa\u8fd9\u6837\u7684\u4e00\u4e2a\u5b57\u7b26\u4e32 $s$\uff0c\u6c42\u5b57\u7b26\u4e32 $s$ \u4e2d\u6709\u591a\u5c11\u4e2a\u5b50\u4e32\u662f\u5bb9\u8bb8\u6620\u5c04\u7684\u63cf\u8ff0\u3002\n\n\u539f\u9898\u9762\u4e2d\u4e3a\u4e0d\u4f7f\u6240\u6c42\u503c\u4ea7\u751f\u6b67\u4e49\uff0c\u8865\u5145\u5982\u4e0b\uff1a\n\n- \u5df2\u77e5\u4e00\u4e2a\u957f $l$ \u7684\u5b57\u7b26\u4e32 $s_1s_2\u2026s_l$\uff0c\u6b63\u6574\u6570 $p$ \u548c $q$\uff0c\u4e14 $1 \\leq p \\leq q \\leq l$\uff0c\u5219\u4ece\u4f4d\u7f6e $p$ \u5230 $q$ \u7684\u5b50\u4e32\u4e3a $s_p s_{p+1}\u2026s_q$.\n\n- \u6709\u5b50\u4e32 $substr_1$ \u548c $substr_2$\uff0c\u5206\u522b\u5bf9\u5e94 $(p_1,q_1)$ \u548c $(p_2,q_2)$\uff0c\u82e5 $(p_1,q_1)$ \u4e0e $(p_2,q_2)$ \u4e0d\u540c\uff0c\u5219\u5373\u4f7f $substr_1=substr_2$\uff0c\u4e5f\u79f0 $substr_1$ \u4e0e $substr_2$ \u4e0d\u540c\u3002"
}
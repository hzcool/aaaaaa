{
    "description": "This time you should help a team of researchers on an island in the Pacific Ocean. They research the culture of the ancient tribes that used to inhabit the island many years ago.\n\nOverall they've dug out $ n $ villages. Some pairs of villages were connected by roads. People could go on the roads in both directions. Overall there were exactly $ n-1 $ roads, and from any village one could get to any other one.\n\nThe tribes were not peaceful and they had many wars. As a result of the wars, some villages were destroyed completely. During more peaceful years some of the villages were restored.\n\nAt each moment of time people used only those roads that belonged to some shortest way between two villages that existed at the given moment. In other words, people used the minimum subset of roads in such a way, that it was possible to get from any existing village to any other existing one. Note that throughout the island's whole history, there existed exactly $ n-1 $ roads that have been found by the researchers. There never were any other roads.\n\nThe researchers think that observing the total sum of used roads\u2019 lengths at different moments of time can help to better understand the tribes' culture and answer several historical questions.\n\nYou will be given the full history of the tribes' existence. Your task is to determine the total length of used roads at some moments of time.",
    "inputFormat": "The first line contains an integer $ n $ ( $ 1<=n<=10^{5} $ ) \u2014 the number of villages. The next $ n-1 $ lines describe the roads. The $ i $ -th of these lines contains three integers $ a_{i} $ , $ b_{i} $ and $ c_{i} $ ( $ 1<=a_{i},b_{i}<=n $ , $ a_{i}\u2260b_{i} $ , $ 1<=c_{i}<=10^{9} $ , $ 1<=i&lt;n $ ) \u2014 the numbers of villages that are connected by the $ i $ -th road and the road's length. The numbers in the lines are separated by a space.\n\nThe next line contains an integer $ q $ ( $ 1<=q<=10^{5} $ ) \u2014 the number of queries. Then follow $ q $ queries, one per line, ordered by time. Each query belongs to one of three types:\n\n- \"+  $ x $ \" \u2014 village number $ x $ is restored ( $ 1<=x<=n $ ).\n- \"-  $ x $ \" \u2014 village number $ x $ is destroyed ( $ 1<=x<=n $ ).\n- \"?\" \u2014 the archaeologists want to know the total length of the roads which were used for that time period.\n\nIt is guaranteed that the queries do not contradict each other, that is, there won't be queries to destroy non-existing villages or restore the already existing ones. It is guaranteed that we have at least one query of type \"?\". It is also guaranteed that one can get from any village to any other one by the given roads.\n\nAt the initial moment of time no village is considered to exist.",
    "outputFormat": "For each query of type \"?\" print the total length of used roads on a single line. You should print the answers to the queries in the order, in which they are given in the input.\n\nPlease do not use the %lld specifier to read or write 64-bit integers in \u0421++. It is preferred to use cin, cout streams or the %I64d specifier.",
    "samples": [
        [
            "6\n1 2 1\n1 3 5\n4 1 7\n4 5 3\n6 4 2\n10\n+ 3\n+ 1\n?\n+ 6\n?\n+ 5\n?\n- 6\n- 3\n?\n",
            "5\n14\n17\n10\n"
        ]
    ],
    "hint": "",
    "translation": "\u6709\u4e00\u68f5 $n$ \u4e2a\u70b9\u7684\u5e26\u6743\u6811\uff0c\u6bcf\u4e2a\u70b9\u90fd\u662f\u9ed1\u8272\u6216\u767d\u8272\uff0c\u6700\u521d\u6240\u6709\u70b9\u90fd\u662f\u767d\u8272\u7684\u3002\u6709 $q$ \u4e2a\u8be2\u95ee\uff1a\n\n- \u628a\u70b9 $x$ \u4ece\u767d\u8272\u53d8\u6210\u9ed1\u8272\u3002\n- \u628a\u70b9 $x$ \u4ece\u9ed1\u8272\u53d8\u6210\u767d\u8272\u3002\n- \u67e5\u8be2\u9ed1\u70b9\u7684\u5bfc\u51fa\u5b50\u6811 $($\u7528\u6700\u5c11\u7684\u8fb9\u628a**\u6240\u6709\u7684**\u9ed1\u70b9\u8fde\u901a\u8d77\u6765\u7684\u6811$)$ \u7684\u603b\u8fb9\u6743\u548c\u3002\n\n\u4fdd\u8bc1 $1 \\leq n, q \\leq 10^5, 1 \\leq x \\leq n$\u3002"
}
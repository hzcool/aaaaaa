{
    "description": "This problem is a version of problem D from the same contest with some additional constraints and tasks.\n\nThere are $ n $ candies in a candy box. The type of the $ i $ -th candy is $ a_i $ ( $ 1 \\le a_i \\le n $ ).\n\nYou have to prepare a gift using some of these candies with the following restriction: the numbers of candies of each type presented in a gift should be all distinct (i. e. for example, a gift having two candies of type $ 1 $ and two candies of type $ 2 $ is bad).\n\nIt is possible that multiple types of candies are completely absent from the gift. It is also possible that not all candies of some types will be taken to a gift.\n\nYou really like some of the candies and don't want to include them into the gift, but you want to eat them yourself instead. For each candy, a number $ f_i $ is given, which is equal to $ 0 $ if you really want to keep $ i $ -th candy for yourself, or $ 1 $ if you don't mind including it into your gift. It is possible that two candies of the same type have different values of $ f_i $ .\n\nYou want your gift to be as large as possible, but you don't want to include too many of the candies you want to eat into the gift. So, you want to calculate the maximum possible number of candies that can be included into a gift, and among all ways to choose maximum number of candies, you want to maximize the number of candies having $ f_i = 1 $ in your gift.\n\nYou have to answer $ q $ independent queries.\n\nIf you are Python programmer, consider using PyPy instead of Python when you submit your code.",
    "inputFormat": "The first line of the input contains one integer $ q $ ( $ 1 \\le q \\le 2 \\cdot 10^5 $ ) \u2014 the number of queries.\n\nThe first line of each query contains one integer $ n $ ( $ 1 \\le n \\le 2 \\cdot 10^5 $ ) \u2014 the number of candies.\n\nThen $ n $ lines follow, each containing two integers $ a_i $ and $ f_i $ ( $ 1 \\le a_i \\le n $ , $ 0 \\le f_i \\le 1 $ ), where $ a_i $ is the type of the $ i $ -th candy, and $ f_i $ denotes whether you want to keep the $ i $ -th candy for yourself ( $ 0 $ if you want to keep it, $ 1 $ if you don't mind giving it away).\n\nIt is guaranteed that the sum of $ n $ over all queries does not exceed $ 2 \\cdot 10^5 $ .",
    "outputFormat": "For each query print two integers:\n\n- the maximum number of candies in a gift you can compose, according to the constraints in the statement;\n- the maximum number of candies having $ f_i = 1 $ in a gift you can compose that contains the maximum possible number of candies.",
    "samples": [
        [
            "3\n8\n1 0\n4 1\n2 0\n4 1\n5 1\n6 1\n3 0\n2 0\n4\n1 1\n1 1\n2 1\n2 1\n9\n2 0\n2 0\n4 1\n4 1\n4 1\n7 0\n7 1\n7 0\n7 1\n",
            "3 3\n3 3\n9 5\n"
        ]
    ],
    "hint": "In the first query, you can include two candies of type $ 4 $ and one candy of type $ 5 $ . All of them have $ f_i = 1 $ and you don't mind giving them away as part of the gift.",
    "translation": "\u672c\u9898\u662fD\u9898\u7684\u52a0\u5f3a\u7248\u3002\n\n\u4f60\u6709$n$\u5757\u7cd6\u679c\uff0c\u7b2c$i$\u5757\u7cd6\u679c\u7684\u79cd\u7c7b\u662f$a_i$\u3002\n\n\u4f60\u60f3\u9009\u51fa\u6765\u82e5\u5e72\u5757\u7cd6\u679c\u9001\u7ed9\u522b\u4eba\u3002\u4f60\u9009\u51fa\u6765\u7684\u7cd6\u679c\u9700\u8981\u6ee1\u8db3\u4efb\u610f\u4e24\u79cd\u7cd6\u679c\u7684\u6570\u91cf\u90fd\u4e0d\u80fd\u76f8\u7b49\u3002\n\n\u7279\u522b\u7684\uff0c\u6709\u4e00\u4e9b\u7cd6\u679c\u4f60\u6bd4\u8f83\u559c\u6b22\uff0c\u4e0d\u60f3\u628a\u5b83\u9001\u7ed9\u522b\u4eba\u3002\u5bf9\u4e8e\u7b2c$i$\u5757\u7cd6\u679c\uff0c\u5982\u679c$f_i=0$\uff0c\u8868\u793a\u4f60\u4e0d\u60f3\u628a\u5b83\u9001\u7ed9\u522b\u4eba\uff0c\u5426\u5219\u8868\u793a\u4f60\u60f3\u628a\u5b83\u9001\u7ed9\u522b\u4eba\u3002\n\n\u4f60\u60f3\u9009\u51fa\u6765\u5c3d\u53ef\u80fd\u591a\u7684\u7cd6\u679c\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4f60\u8fd8\u60f3\u6700\u5927\u5316\u5176\u4e2d$f_i=1$\u7684\u7cd6\u679c\u6570\u91cf\u3002\n\n\u8f93\u51fa\u6700\u591a\u7684\u7cd6\u679c\u6570\u91cf\u4ee5\u53ca\u5176\u4e2d$f_i=1$\u7684\u7cd6\u679c\u6570\u91cf\u3002\n\n\u4f60\u9700\u8981\u56de\u7b54$q$\u7ec4\u8be2\u95ee\u3002\n\n$\\text{\u2014\u2014by wucstdio}$"
}
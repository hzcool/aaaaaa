{
    "description": "You have a root tree containing $ n $ vertexes. Let's number the tree vertexes with integers from $ 1 $ to $ n $ . The tree root is in the vertex $ 1 $ .\n\nEach vertex (except fot the tree root) $ v $ has a direct ancestor $ p_{v} $ . Also each vertex $ v $ has its integer value $ s_{v} $ .\n\nYour task is to perform following queries:\n\n- P $ v $ $ u $ ( $ u\u2260v $ ). If $ u $ isn't in subtree of $ v $ , you must perform the assignment $ p_{v}=u $ . Otherwise you must perform assignment $ p_{u}=v $ . Note that after this query the graph continues to be a tree consisting of $ n $ vertexes.\n- V $ v $ $ t $ . Perform assignment $ s_{v}=t $ .\n\nYour task is following. Before starting performing queries and after each query you have to calculate expected value written on the lowest common ancestor of two equiprobably selected vertices $ i $ and $ j $ . Here lowest common ancestor of $ i $ and $ j $ is the deepest vertex that lies on the both of the path from the root to vertex $ i $ and the path from the root to vertex $ j $ . Please note that the vertices $ i $ and $ j $ can be the same (in this case their lowest common ancestor coincides with them).",
    "inputFormat": "You have a root tree containing $ n $ vertexes. Let's number the tree vertexes with integers from $ 1 $ to $ n $ . The tree root is in the vertex $ 1 $ .\n\nEach vertex (except fot the tree root) $ v $ has a direct ancestor $ p_{v} $ . Also each vertex $ v $ has its integer value $ s_{v} $ .\n\nYour task is to perform following queries:\n\n- P $ v $ $ u $ ( $ u\u2260v $ ). If $ u $ isn't in subtree of $ v $ , you must perform the assignment $ p_{v}=u $ . Otherwise you must perform assignment $ p_{u}=v $ . Note that after this query the graph continues to be a tree consisting of $ n $ vertexes.\n- V $ v $ $ t $ . Perform assignment $ s_{v}=t $ .\n\nYour task is following. Before starting performing queries and after each query you have to calculate expected value written on the lowest common ancestor of two equiprobably selected vertices $ i $ and $ j $ . Here lowest common ancestor of $ i $ and $ j $ is the deepest vertex that lies on the both of the path from the root to vertex $ i $ and the path from the root to vertex $ j $ . Please note that the vertices $ i $ and $ j $ can be the same (in this case their lowest common ancestor coincides with them).",
    "outputFormat": "Print $ q+1 $ number \u2014 the corresponding expected values. Your answer will be considered correct if its absolute or relative error doesn't exceed $ 10^{-9} $ .",
    "samples": [
        [
            "5\n1 2 2 1\n1 2 3 4 5\n5\nP 3 4\nP 4 5\nV 2 3\nP 5 2\nP 1 4\n",
            "1.640000000\n1.800000000\n2.280000000\n2.320000000\n2.800000000\n1.840000000\n"
        ]
    ],
    "hint": "You have a root tree containing $ n $ vertexes. Let's number the tree vertexes with integers from $ 1 $ to $ n $ . The tree root is in the vertex $ 1 $ .\n\nEach vertex (except fot the tree root) $ v $ has a direct ancestor $ p_{v} $ . Also each vertex $ v $ has its integer value $ s_{v} $ .\n\nYour task is to perform following queries:\n\n- P $ v $ $ u $ ( $ u\u2260v $ ). If $ u $ isn't in subtree of $ v $ , you must perform the assignment $ p_{v}=u $ . Otherwise you must perform assignment $ p_{u}=v $ . Note that after this query the graph continues to be a tree consisting of $ n $ vertexes.\n- V $ v $ $ t $ . Perform assignment $ s_{v}=t $ .\n\nYour task is following. Before starting performing queries and after each query you have to calculate expected value written on the lowest common ancestor of two equiprobably selected vertices $ i $ and $ j $ . Here lowest common ancestor of $ i $ and $ j $ is the deepest vertex that lies on the both of the path from the root to vertex $ i $ and the path from the root to vertex $ j $ . Please note that the vertices $ i $ and $ j $ can be the same (in this case their lowest common ancestor coincides with them).",
    "translation": "### \u9898\u76ee\u63cf\u8ff0\n\u6709\u4e00\u68f5\u4ee5 $1$ \u4e3a\u6839\u7684\u6709\u6839\u6811\uff0c\u7b2c $i$ \u4e2a\u8282\u70b9\u7684\u7236\u4eb2\u4e3a $f_i$\uff0c\u6bcf\u4e2a\u8282\u70b9\u4e0a\u6709\u4e00\u4e2a\u6570\u4e3a $a_i$\u3002\n\n\u5171\u6709 $m$ \u4e2a\u4e8b\u4ef6\uff1a\n\n`P x y` : \u82e5 $x$ \u662f $y$ \u7684\u7956\u5148\uff0c\u628a $f_y$ \u6539\u4e3a $x$\uff0c\u5426\u5219\u628a$ f_x$ \u6539\u4e3a $y$\u3002\n\n`V x v` : \u628a $a_x$ \u6539\u4e3a $v$\u3002\n\n\u6c42\u521d\u59cb\u548c\u6bcf\u4e2a\u4e8b\u4ef6\u53d1\u751f\u540e\u968f\u673a\u4e24\u4e2a\u70b9\uff08\u53ef\u4ee5\u662f\u540c\u4e00\u4e2a\u70b9\uff09\u7684 LCA \u7684 $a_i$ \u7684\u671f\u671b\n\n### \u8f93\u5165\u683c\u5f0f\n\u7b2c\u4e00\u884c\u6709\u4e00\u4e2a\u6574\u6570n\n\n\u7b2c\u4e8c\u884c\u6709n-1\u4e2a\u6574\u6570\uff0c\u7b2ci\u4e2a\u6574\u6570\u662f$f_{i+1}$\n\n\u7b2c\u4e09\u884c\u6709n\u4e2a\u6574\u6570\uff0c\u7b2ci\u4e2a\u6574\u6570\u662f$a_i$\n\n\u7b2c\u56db\u884c\u6709\u4e00\u4e2a\u6574\u6570m\n\n\u63a5\u4e0b\u6765m\u884c\u6bcf\u884c\u6709\u4e00\u4e2a\u4e8b\u4ef6\n\n### \u8f93\u51fa\u683c\u5f0f\n\u5171m+1\u884c\uff0c\u8f93\u51fa\u521d\u59cb\u548c\u6bcf\u4e2a\u4e8b\u4ef6\u53d1\u751f\u540e\u968f\u673a\u4e24\u4e2a\u70b9\uff08\u53ef\u4ee5\u662f\u540c\u4e00\u4e2a\u70b9\uff09\u7684LCA\u7684$a_i$\u7684\u671f\u671b"
}
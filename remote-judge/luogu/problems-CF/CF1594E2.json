{
    "description": "It is the hard version of the problem. The difference is that in this version, there are nodes with already chosen colors.\n\nTheofanis is starving, and he wants to eat his favorite food, sheftalia. However, he should first finish his homework. Can you help him with this problem?\n\nYou have a perfect binary tree of $ 2^k - 1 $ nodes \u2014 a binary tree where all vertices $ i $ from $ 1 $ to $ 2^{k - 1} - 1 $ have exactly two children: vertices $ 2i $ and $ 2i + 1 $ . Vertices from $ 2^{k - 1} $ to $ 2^k - 1 $ don't have any children. You want to color its vertices with the $ 6 $ Rubik's cube colors (White, Green, Red, Blue, Orange and Yellow).\n\nLet's call a coloring good when all edges connect nodes with colors that are neighboring sides in the Rubik's cube.\n\n ![](https://espresso.codeforces.com/81468de2d38e27a371abfa76db5ecd8938d6437a.png)![](https://espresso.codeforces.com/acbbacfbb22e480bc2bdcb3e0731504ff698a3f2.png)A picture of Rubik's cube and its 2D map.More formally:\n\n- a white node can not be neighboring with white and yellow nodes;\n- a yellow node can not be neighboring with white and yellow nodes;\n- a green node can not be neighboring with green and blue nodes;\n- a blue node can not be neighboring with green and blue nodes;\n- a red node can not be neighboring with red and orange nodes;\n- an orange node can not be neighboring with red and orange nodes;\n\nHowever, there are $ n $ special nodes in the tree, colors of which are already chosen.\n\nYou want to calculate the number of the good colorings of the binary tree. Two colorings are considered different if at least one node is colored with a different color.\n\nThe answer may be too large, so output the answer modulo $ 10^9+7 $ .",
    "inputFormat": "The first line contains the integers $ k $ ( $ 1 \\le k \\le 60 $ ) \u2014 the number of levels in the perfect binary tree you need to color.\n\nThe second line contains the integer $ n $ ( $ 1 \\le n \\le \\min(2^k - 1, 2000) $ ) \u2014 the number of nodes, colors of which are already chosen.\n\nThe next $ n $ lines contains integer $ v $ ( $ 1 \\le v \\le 2^k - 1 $ ) and string $ s $ \u2014 the index of the node and the color of the node ( $ s $ is one of the white, yellow, green, blue, red and orange).\n\nIt is guaranteed that each node $ v $ appears in the input at most once.",
    "outputFormat": "Print one integer \u2014 the number of the different colorings modulo $ 10^9+7 $ .",
    "samples": [
        [
            "3\n2\n5 orange\n2 white",
            "1024"
        ],
        [
            "2\n2\n1 white\n2 white",
            "0"
        ],
        [
            "10\n3\n1 blue\n4 red\n5 orange",
            "328925088"
        ]
    ],
    "hint": "In the picture below, you can see one of the correct colorings of the first test example.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1594E2/dcebca3c4893383a751dc627ead5632c7d038ce7.png)",
    "translation": "\u6709\u4e00\u68f5\u6df1\u5ea6\u4e3a $k$ \u7684\u6ee1\u4e8c\u53c9\u6811\uff08\u6839\u8282\u70b9\u6df1\u5ea6\u4e3a $1$\uff09\u3002  \n\u4f60\u8981\u7528 $6$ \u79cd\u989c\u8272\u53bb\u67d3\u8272\uff0c\u4f7f\u5f97\u76f8\u90bb\u8282\u70b9\u989c\u8272\u4e0d\u540c\uff0c\u5e76\u4e14\u4e5f\u4e0d\u4f1a\u662f\u9b54\u65b9\u5bf9\u9762\u7684\u4e24\u4e2a\u9762\u7684\u989c\u8272\u3002  \n\u5177\u4f53\u6765\u8bf4\uff1a  \n- \u5982\u679c\u4e00\u4e2a\u8282\u70b9\u662f\u767d\u8272\u7684\uff0c\u90a3\u4e48\u76f8\u90bb\u8282\u70b9\u4e0d\u80fd\u662f\u767d\u8272\u7684\u6216\u9ec4\u8272\u7684\u3002 \n- \u5982\u679c\u4e00\u4e2a\u8282\u70b9\u662f\u9ec4\u8272\u7684\uff0c\u90a3\u4e48\u76f8\u90bb\u8282\u70b9\u4e0d\u80fd\u662f\u767d\u8272\u7684\u6216\u9ec4\u8272\u7684\u3002 \n- \u5982\u679c\u4e00\u4e2a\u8282\u70b9\u662f\u7eff\u8272\u7684\uff0c\u90a3\u4e48\u76f8\u90bb\u8282\u70b9\u4e0d\u80fd\u662f\u7eff\u8272\u7684\u6216\u84dd\u8272\u7684\u3002 \n- \u5982\u679c\u4e00\u4e2a\u8282\u70b9\u662f\u84dd\u8272\u7684\uff0c\u90a3\u4e48\u76f8\u90bb\u8282\u70b9\u4e0d\u80fd\u662f\u7eff\u8272\u7684\u6216\u84dd\u8272\u7684\u3002 \n- \u5982\u679c\u4e00\u4e2a\u8282\u70b9\u662f\u7ea2\u8272\u7684\uff0c\u90a3\u4e48\u76f8\u90bb\u8282\u70b9\u4e0d\u80fd\u662f\u7ea2\u8272\u7684\u6216\u6a59\u8272\u7684\u3002 \n- \u5982\u679c\u4e00\u4e2a\u8282\u70b9\u662f\u6a59\u8272\u7684\uff0c\u90a3\u4e48\u76f8\u90bb\u8282\u70b9\u4e0d\u80fd\u662f\u7ea2\u8272\u7684\u6216\u6a59\u8272\u7684\u3002 \n\n\u73b0\u5728\u5df2\u77e5\u4e86 $n$ \u4e2a\u8282\u70b9\u7684\u989c\u8272\u4fe1\u606f\uff08\u5728 E1 \u4e2d\u4e3a 0\uff09\uff0c\u6c42\u7ed9\u6574\u68f5\u6811\u67d3\u8272\u7684\u65b9\u6848\u6570\u3002"
}
{
    "description": "There is a social website with $ n $ fanpages, numbered $ 1 $ through $ n $ . There are also $ n $ companies, and the $ i $ -th company owns the $ i $ -th fanpage.\n\nRecently, the website created a feature called following. Each fanpage must choose exactly one other fanpage to follow.\n\nThe website doesn\u2019t allow a situation where $ i $ follows $ j $ and at the same time $ j $ follows $ i $ . Also, a fanpage can't follow itself.\n\nLet\u2019s say that fanpage $ i $ follows some other fanpage $ j_{0} $ . Also, let\u2019s say that $ i $ is followed by $ k $ other fanpages $ j_{1},j_{2},...,j_{k} $ . Then, when people visit fanpage $ i $ they see ads from $ k+2 $ distinct companies: $ i,j_{0},j_{1},...,j_{k} $ . Exactly $ t_{i} $ people subscribe (like) the $ i $ -th fanpage, and each of them will click exactly one add. For each of $ k+1 $ companies $ j_{0},j_{1},...,j_{k} $ , exactly ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/21bba61653cf179f89248142af248d7df7419d53.png) people will click their ad. Remaining ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/41e88e0191cf8cbf46af6c24ce4f538a6481272e.png) people will click an ad from company $ i $ (the owner of the fanpage).\n\nThe total income of the company is equal to the number of people who click ads from this copmany.\n\nLimak and Radewoosh ask you for help. Initially, fanpage $ i $ follows fanpage $ f_{i} $ . Your task is to handle $ q $ queries of three types:\n\n- 1 i j \u2014 fanpage $ i $ follows fanpage $ j $ from now. It's guaranteed that $ i $ didn't follow $ j $ just before the query. Note an extra constraint for the number of queries of this type (below, in the Input section).\n- 2 i \u2014 print the total income of the $ i $ -th company.\n- 3 \u2014 print two integers: the smallest income of one company and the biggest income of one company.",
    "inputFormat": "The first line of the input contains two integers $ n $ and $ q $ ( $ 3<=n<=100000 $ , $ 1<=q<=100000 $ ) \u2014 the number of fanpages and the number of queries, respectively.\n\nThe second line contains $ n $ integers $ t_{1},t_{2},...,t_{n} $ ( $ 1<=t_{i}<=10^{12} $ ) where $ t_{i} $ denotes the number of people subscribing the $ i $ -th fanpage.\n\nThe third line contains $ n $ integers $ f_{1},f_{2},...,f_{n} $ ( $ 1<=f_{i}<=n $ ). Initially, fanpage $ i $ follows fanpage $ f_{i} $ .\n\nThen, $ q $ lines follow. The $ i $ -th of them describes the $ i $ -th query. The first number in the line is an integer $ type_{i} $ ( $ 1<=type_{i}<=3 $ ) \u2014 the type of the query.\n\nThere will be at most $ 50000 $ queries of the first type. There will be at least one query of the second or the third type (so, the output won't be empty).\n\nIt's guaranteed that at each moment a fanpage doesn't follow itself, and that no two fanpages follow each other.",
    "outputFormat": "For each query of the second type print one integer in a separate line - the total income of the given company. For each query of the third type print two integers in a separate line - the minimum and the maximum total income, respectively.",
    "samples": [
        [
            "5 12\n10 20 30 40 50\n2 3 4 5 2\n2 1\n2 2\n2 3\n2 4\n2 5\n1 4 2\n2 1\n2 2\n2 3\n2 4\n2 5\n3\n",
            "10\n36\n28\n40\n36\n9\n57\n27\n28\n29\n9 57\n"
        ]
    ],
    "hint": " ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/d9db9bc44e733c82215e5751c44c438174d7820a.png)In the sample test, there are $ 5 $ fanpages. The $ i $ -th of them has $ i\u00b710 $ subscribers.\n\nOn drawings, numbers of subscribers are written in circles. An arrow from $ A $ to $ B $ means that $ A $ follows $ B $ .\n\nThe left drawing shows the initial situation. The first company gets income ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/66341a4c63fe8dcbff87b6d1efb8920e9cbb8631.png) from its own fanpage, and gets income ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/e1ae5946de33df9032cda69753ae955ed119e264.png) from the $ 2 $ -nd fanpage. So, the total income is $ 5+5=10 $ . After the first query (\"2 1\") you should print $ 10 $ .\n\nThe right drawing shows the situation after a query \"1 4 2\" (after which fanpage $ 4 $ follows fanpage $ 2 $ ). Then, the first company still gets income $ 5 $ from its own fanpage, but now it gets only ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF643D/2ec2bf132e45182de4904da17cfe1690c0fccba6.png) from the $ 2 $ -nd fanpage. So, the total income is $ 5+4=9 $ now.",
    "translation": "\u7ed9\u5b9a\u4e00\u4e2a $n$ \u4e2a\u70b9\u7684\u57fa\u73af\u5185\u5411\u6811\u68ee\u6797\uff0c\u5373\u7ed9\u5b9a\u6bcf\u4e2a\u70b9 $i$ \u7684\u540e\u7ee7 $f_i$\u3002  \n\uff08**\u7279\u522b\u5730\uff0c\u4fdd\u8bc1\u5728\u4efb\u610f\u65f6\u523b\uff0c\u8fd9\u4e2a\u57fa\u73af\u5185\u5411\u68ee\u6797\u4e2d\u7684\u73af\u957f\u90fd** $\\boldsymbol{\\ge 3}$\uff09\n\n\u5728\u8fd9\u4e2a\u9650\u5236\u4e0b\uff0c\u8003\u8651\u4e0e\u67d0\u4e2a\u70b9 $i$ \u8ddd\u79bb\u4e0d\u8d85\u8fc7 $1$ \u7684\u70b9\uff0c\u4e5f\u5c31\u662f $i$ \u672c\u8eab\uff0c$i$ \u7684\u540e\u7ee7 $f_i$ \u4ee5\u53ca\u82e5\u5e72\u4e2a\u540e\u7ee7\u4e3a $i$ \u7684\u70b9\u3002  \n\u4e0d\u59a8\u5047\u8bbe\u6709 $k$ \u4e2a\u70b9\u7684\u540e\u7ee7\u4e3a $i$\uff0c\u5219\u6211\u4eec\u9700\u8981\u8003\u8651\u8fd9 $k + 2$ \u4e2a\u70b9\uff08\u8fd9\u662f\u56e0\u4e3a\u73af\u957f $\\ge 3$\uff0c\u4e0d\u4f1a\u51fa\u73b0\u91cd\u590d\u7684\u70b9\uff09\u3002  \n\u79f0\u8fd9 $k + 2$ \u4e2a\u70b9\u5206\u522b\u4e3a $i, j_0, j_1, j_2, \\ldots , j_k$\uff08$j_0$ \u4e3a $i$ \u7684\u540e\u7ee7\uff0c$j_{1 \\ldots k}$ \u4e3a\u540e\u7ee7\u4e3a $i$ \u7684\u90a3 $k$ \u4e2a\u70b9\uff09\u3002\n\n\u73b0\u5728\u5047\u8bbe**\u795e\u79d8\u4e8b\u4ef6**\u53d1\u751f\u4e86\uff0c\u6bcf\u4e2a\u70b9\u90fd\u4f1a\u8fdb\u5165\u4e00\u4e9b\u4eba\uff0c\u7b2c $i$ \u4e2a\u70b9\u4f1a\u8fdb\u5165 $t_i$ \u4e2a\u4eba\u3002  \n\u6070\u597d $\\left\\lfloor \\frac{t_i}{k+2} \\right\\rfloor$ \u4e2a\u4eba\u4f1a\u8fdb\u5165 $j_0, j_1, j_2, \\ldots , j_k$ \u53f7\u70b9\uff08\u6bcf\u4e2a\u70b9\u90fd\u8fdb\u5165 $\\left\\lfloor \\frac{t_i}{k+2} \\right\\rfloor$ \u4e2a\u4eba\uff09\uff0c\u5269\u4e0b\u7684 $t_i - (k + 1) \\cdot \\!\\left\\lfloor \\frac{t_i}{k+2} \\right\\rfloor$ \u4e2a\u4eba\u4f1a\u7559\u5728\u70b9 $i$\u3002\n\n\u4f60\u9700\u8981\u4f9d\u6b21\u5904\u7406 $q$ \u4e2a\u64cd\u4f5c\uff1a\n\n1. `1 i j`\uff1a\u5c06 $f_i$ \u6539\u4e3a $j$\uff0c\u5373\u628a $i$ \u7684\u540e\u7ee7\u53d8\u6210 $j$\u3002\u4fdd\u8bc1\u4ecd\u7136\u6ee1\u8db3\u4e0a\u6587\u4e2d\u7684\u6761\u4ef6\u3002\n2. `2 i`\uff1a\u8ba1\u7b97\u5f53**\u795e\u79d8\u4e8b\u4ef6**\u53d1\u751f\u65f6\uff0c\u7b2c $i$ \u4e2a\u70b9\u6700\u7ec8\u4f1a\u7559\u4e0b\u591a\u5c11\u4eba\u3002\n3. `3`\uff1a\u8ba1\u7b97\u5f53**\u795e\u79d8\u4e8b\u4ef6**\u53d1\u751f\u65f6\uff0c\u6bcf\u4e2a\u70b9\u5185\u6700\u7ec8\u7559\u4e0b\u7684\u4eba\u6570\u7684\u6700\u5c0f\u503c\u548c\u6700\u5927\u503c\u3002\n\n\u6ce8\u610f\uff1a\u6bcf\u6b21**\u795e\u79d8\u4e8b\u4ef6**\u53d1\u751f\u90fd\u662f\u4e92\u4e0d\u5f71\u54cd\u7684\u3002"
}
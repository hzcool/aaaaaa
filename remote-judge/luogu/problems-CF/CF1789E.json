{
    "description": "Serval loves playing music games. He meets a problem when playing music games, and he leaves it for you to solve.\n\nYou are given $ n $ positive integers $ s_1 < s_2 < \\ldots < s_n $ . $ f(x) $ is defined as the number of $ i $ ( $ 1\\leq i\\leq n $ ) that exist non-negative integers $ p_i, q_i $ such that:\n\n$$\ns_i=p_i\\left\\lfloor{s_n\\over x}\\right\\rfloor + q_i\\left\\lceil{s_n\\over x}\\right\\rceil\n$$\n\nFind out $ \\sum_{x=1}^{s_n} x\\cdot f(x)$  modulo $ 998\\,244\\,353 $ .\n\nAs a reminder,  $ \\lfloor x\\rfloor $  denotes the maximal integer that is no greater than  $ x $ , and  $ \\lceil x\\rceil $  denotes the minimal integer that is no less than $x$.",
    "inputFormat": "Each test contains multiple test cases. The first line contains the number of test cases $ t $ ( $ 1\\leq t\\leq 10^4 $ ). The description of the test cases follows.\n\nThe first line of each test cases contains a single integer $ n $ ( $ 1\\leq n\\leq 10^6 $ ).\n\nThe second line of each test case contains $ n $ positive integers $ s_1,s_2,\\ldots,s_n $ ( $ 1\\leq s_1 < s_2 < \\ldots < s_n \\leq 10^7 $ ).\n\nIt is guaranteed that the sum of $ n $ over all test cases does not exceed $ 10^6 $ , and the sum of $ s_n $ does not exceed $ 10^7 $ .",
    "outputFormat": "For each test case, print a single integer in a single line \u2014 the sum of $ x\\cdot f(x) $ over all possible $ x $ modulo $ 998\\,244\\,353 $ .",
    "samples": [
        [
            "4\n3\n1 2 4\n4\n1 2 7 9\n4\n344208 591000 4779956 5403429\n5\n1633 1661 1741 2134 2221",
            "26\n158\n758737625\n12334970"
        ]
    ],
    "hint": "For the first test case, $ s_n=4 $ , $ f(x) $ are calculated as followings:\n\n- $ f(1)=1 $ \n  - $ \\left\\lfloor s_n\\over 1\\right\\rfloor=4 $ , $ \\left\\lceil s_n\\over 1\\right\\rceil=4 $ .\n  - It can be shown that such $ p_1,p_2 $ and $ q_1,q_2 $ that satisfy the conditions don't exist.\n  - Let $ p_3=1 $ and $ q_3=0 $ , then $ s_3 = p_3\\cdot\\left\\lfloor s_n\\over 1\\right\\rfloor + q_3\\cdot\\left\\lceil s_n\\over 1\\right\\rceil = 1\\cdot 4 + 0\\cdot 4 = 4 $ .\n- $ f(2)=2 $ \n  - $ \\left\\lfloor s_n\\over 2\\right\\rfloor=2 $ , $ \\left\\lceil s_n\\over 2\\right\\rceil=2 $ .\n  - It can be shown that such $ p_1 $ and $ q_1 $ that satisfy the conditions don't exist.\n  - Let $ p_2=1 $ and $ q_2=0 $ , then $ s_2 = p_2\\cdot\\left\\lfloor s_n\\over 2\\right\\rfloor + q_2\\cdot\\left\\lceil s_n\\over 2\\right\\rceil = 1\\cdot 2 + 0\\cdot 2 = 2 $ .\n  - Let $ p_3=0 $ and $ q_3=2 $ , then $ s_3 = p_3\\cdot\\left\\lfloor s_n\\over 2\\right\\rfloor + q_3\\cdot\\left\\lceil s_n\\over 2\\right\\rceil = 0\\cdot 2 + 2\\cdot 2 = 4 $ .\n- $ f(3)=3 $ \n  - $ \\left\\lfloor s_n\\over 3\\right\\rfloor=1 $ , $ \\left\\lceil s_n\\over 3\\right\\rceil=2 $ .\n  - Let $ p_1=1 $ and $ q_1=0 $ , then $ s_1 = p_1\\cdot\\left\\lfloor s_n\\over 3\\right\\rfloor + q_1\\cdot\\left\\lceil s_n\\over 3\\right\\rceil = 1\\cdot 1 + 0\\cdot 2 = 1 $ .\n  - Let $ p_2=0 $ and $ q_2=1 $ , then $ s_2 = p_2\\cdot\\left\\lfloor s_n\\over 3\\right\\rfloor + q_2\\cdot\\left\\lceil s_n\\over 3\\right\\rceil = 0\\cdot 1 + 1\\cdot 2 = 2 $ .\n  - Let $ p_3=0 $ and $ q_3=2 $ , then $ s_3 = p_3\\cdot\\left\\lfloor s_n\\over 3\\right\\rfloor + q_3\\cdot\\left\\lceil s_n\\over 3\\right\\rceil = 0\\cdot 1 + 2\\cdot 2 = 4 $ .\n- $ f(4)=3 $ \n  - $ \\left\\lfloor s_n\\over 4\\right\\rfloor=1 $ , $ \\left\\lceil s_n\\over 4\\right\\rceil=1 $ .\n  - Let $ p_1=1 $ and $ q_1=0 $ , then $ s_1 = p_1\\cdot\\left\\lfloor s_n\\over 4\\right\\rfloor + q_1\\cdot\\left\\lceil s_n\\over 4\\right\\rceil = 1\\cdot 1 + 0\\cdot 1 = 1 $ .\n  - Let $ p_2=1 $ and $ q_2=1 $ , then $ s_2 = p_2\\cdot\\left\\lfloor s_n\\over 4\\right\\rfloor + q_2\\cdot\\left\\lceil s_n\\over 4\\right\\rceil = 1\\cdot 1 + 1\\cdot 1 = 2 $ .\n  - Let $ p_3=2 $ and $ q_3=2 $ , then $ s_3 = p_3\\cdot\\left\\lfloor s_n\\over 4\\right\\rfloor + q_3\\cdot\\left\\lceil s_n\\over 4\\right\\rceil = 2\\cdot 1 + 2\\cdot 1 = 4 $ .\n\nTherefore, the answer is $ \\sum_{x=1}^4 x\\cdot f(x) = 1\\cdot 1 + 2\\cdot 2 + 3\\cdot 3 + 4\\cdot 3 = 26 $ .\n\nFor the second test case:\n\n- $ f(1)=f(2)=f(3)=1 $\n- $ f(4)=3 $\n- $ f(5)=f(6)=f(7)=f(8)=f(9)=4 $\n\nFor example, when $ x=3 $ we have $ f(3)=1 $ because there exist $ p_4 $ and $ q_4 $ :\n\n$$\n9 = 1 \\cdot\\left\\lfloor{9\\over 3}\\right\\rfloor + 2 \\cdot\\left\\lceil{9\\over 3}\\right\\rceil\n$$\n\nIt can be shown that it is impossible to find  $ p_1,p_2,p_3 $  and  $ q_1,q_2,q_3 $  that satisfy the conditions.\n\nWhen  $ x=5 $  we have  $ f(5)=4 $  because there exist  $ p_i $  and  $ q_i $  as followings:\n\n$$\n1 = 1 \\cdot\\left\\lfloor{9\\over 5}\\right\\rfloor + 0 \\cdot\\left\\lceil{9\\over 5}\\right\\rceil\n$$\n\n$$\n2 = 0 \\cdot\\left\\lfloor{9\\over 5}\\right\\rfloor + 1 \\cdot\\left\\lceil{9\\over 5}\\right\\rceil\n$$\n\n$$\n7 = 3 \\cdot\\left\\lfloor{9\\over 5}\\right\\rfloor + 2 \\cdot\\left\\lceil{9\\over 5}\\right\\rceil\n$$\n\n$$\n9 = 3 \\cdot\\left\\lfloor{9\\over 5}\\right\\rfloor + 3 \\cdot\\left\\lceil{9\\over 5}\\right\\rceil\n$$\n\nTherefore, the answer is $ \\sum_{x=1}^9 x\\cdot f(x) = 158$.",
    "translation": "### \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a\u6574\u6570 $n$ \u548c\u957f\u5ea6\u4e3a $n$ \u7684**\u9012\u589e**\u5e8f\u5217 $s$\u3002  \n\u5b9a\u4e49 $f(x)$ \u4e3a\u6ee1\u8db3\u4e0b\u5217\u8981\u6c42\u7684\u6574\u6570 $i(1\\leq i\\leq n)$ \u7684\u6570\u91cf\uff1a\n\n- \u5b58\u5728**\u975e\u8d1f\u6574\u6570** $p_i,q_i$ \u4f7f\u5f97 $s_i=p_i\\bigg\\lfloor\\dfrac{s_n}{x}\\bigg\\rfloor+q_i\\bigg\\lceil\\dfrac{s_n}{x}\\bigg\\rceil$\u3002\n\n\u4f60\u9700\u8981\u6c42\u51fa $\\sum_{x=1}^{s_n}x\\times f(x)$ \u5bf9 $998244353$ \u53d6\u6a21\u540e\u7684\u503c\u3002  \n\u6bcf\u4e2a\u6d4b\u8bd5\u70b9\u5305\u542b $t$ \u7ec4\u6570\u636e\u3002\n\n### \u8f93\u5165\u683c\u5f0f\n\n\u7b2c\u4e00\u884c\u8f93\u5165\u4e00\u4e2a\u6574\u6570 $t(1\\leq t\\leq10^4)$ \u8868\u793a\u6570\u636e\u7ec4\u6570\uff0c\u63a5\u4e0b\u6765\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff1a  \n\u7b2c\u4e00\u884c\u8f93\u5165\u4e00\u4e2a\u6574\u6570 $n(1\\leq n\\leq10^6)$\u3002  \n\u63a5\u4e0b\u6765\u8f93\u5165\u4e00\u884c $n$ \u4e2a\u6574\u6570\u8868\u793a\u5e8f\u5217 $s(1\\leq s_1<s_2<\\cdots<s_n\\leq10^7)$\u3002  \n\u5355\u4e2a\u6d4b\u8bd5\u70b9\u5185\u6240\u6709\u7ec4\u6570\u636e\u5bf9\u5e94\u7684 $n$ \u4e4b\u548c\u4e0d\u8d85\u8fc7 $10^6$\uff0c\u5bf9\u5e94\u7684 $s_n$ \u4e4b\u548c\u4e0d\u8d85\u8fc7 $10^7$\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\n\n\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff1a  \n\u8f93\u51fa\u4e00\u884c\u4e00\u4e2a\u6574\u6570\u8868\u793a $\\sum_{x=1}^{s_n}x\\times f(x)$ \u5bf9 $998244353$ \u53d6\u6a21\u540e\u7684\u503c\u3002"
}
{
    "description": "This is the hard version of this problem. In this version, we have queries. Note that we do not have multiple test cases in this version. You can make hacks only if both versions of the problem are solved.\n\nAn array $ b $ of length $ m $ is good if for all $ i $ the $ i $ -th element is greater than or equal to $ i $ . In other words, $ b $ is good if and only if $ b_i \\geq i $ for all $ i $ ( $ 1 \\leq i \\leq m $ ).\n\nYou are given an array $ a $ consisting of $ n $ positive integers, and you are asked $ q $ queries.\n\nIn each query, you are given two integers $ p $ and $ x $ ( $ 1 \\leq p,x \\leq n $ ). You have to do $ a_p := x $ (assign $ x $ to $ a_p $ ). In the updated array, find the number of pairs of indices $ (l, r) $ , where $ 1 \\le l \\le r \\le n $ , such that the array $ [a_l, a_{l+1}, \\ldots, a_r] $ is good.\n\nNote that all queries are independent, which means after each query, the initial array $ a $ is restored.",
    "inputFormat": "The first line contains a single integer $ n $ ( $ 1 \\le n \\le 2 \\cdot 10^5 $ ).\n\nThe second line contains $ n $ integers $ a_1, a_2, \\ldots, a_n $ ( $ 1 \\le a_i \\le n $ ).\n\nThe third line contains an integer $ q $ ( $ 1 \\leq q \\leq 2 \\cdot 10^5 $ ) \u2014 the number of queries.\n\nEach of the next $ q $ lines contains two integers $ p_j $ and $ x_j $ ( $ 1 \\leq p_j, x_j \\leq n $ ) \u2013 the description of the $ j $ -th query.",
    "outputFormat": "For each query, print the number of suitable pairs of indices after making the change.",
    "samples": [
        [
            "4\n2 4 1 4\n3\n2 4\n3 3\n2 1",
            "6\n10\n5"
        ],
        [
            "5\n1 1 3 2 1\n3\n1 3\n2 5\n4 5",
            "7\n9\n8"
        ]
    ],
    "hint": "Here are notes for first example.\n\nIn first query, after update $ a=[2,4,1,4] $ . Now $ (1,1) $ , $ (2,2) $ , $ (3,3) $ , $ (4,4) $ , $ (1,2) $ , and $ (3,4) $ are suitable pairs.\n\nIn second query, after update $ a=[2,4,3,4] $ . Now all subarrays of $ a $ are good.\n\nIn third query, after update $ a=[2,1,1,4] $ . Now $ (1,1) $ , $ (2,2) $ , $ (3,3) $ , $ (4,4) $ , and $ (3,4) $ are suitable.",
    "translation": "\u8fd9\u9898\u662f CF1936C1 \u7684\u56f0\u96be\u7248\u3002\n\n\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4 $b$ \u662f\u597d\u7684\u5f53\u4e14\u4ec5\u5f53\u6240\u6709\u7684 $b_i \\ge i$\u3002\n\n\u73b0\u5728\u7ed9\u4f60 $q$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u6709\u4e24\u4e2a\u6570 $p$ \u548c $x$\uff0c\u95ee\u628a $a_p$ \u8d4b\u503c\u6210 $x$ \u540e $a$ \u6570\u7ec4\u597d\u7684\u5b50\u5e8f\u5217\uff08**\u8fd9\u4e9b\u5b50\u5e8f\u5217\u5fc5\u987b\u8fde\u7eed**\uff09\u7684\u4e2a\u6570\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a\n\n+ $1 \\le n \\le 2 \\times 10^5$\uff0c$1 \\le q \\le 2 \\times 10^5$\u3002\n+ $1 \\le a_i \\le n$\uff0c$1 \\le p_j,x_j \\le n$\u3002\n\n$\\verb!by!$ [Tx_Lcy](https://www.luogu.com.cn/user/253608)"
}
{
    "description": "...Mike the TV greets you again!\n\nTired of the monotonous furniture? Sick of gray routine? Dreaming about dizzying changes in your humble abode? We have something to offer you!\n\nThis domino carpet for only $99.99 will change your life! You can lay it on the floor, hang it on the wall or even on the ceiling! Among other things ...\n\nHaving watched the commercial, virus Hexadecimal also wanted to get a Domino Carpet and wanted badly to be photographed in front of it. But of course, a virus will never consent to buying a licensed Carpet! So she ordered a truck of dominoes and decided to make such a Carpet herself.\n\nThe original Domino Carpet is a field of squares $ n\u00d7m $ in size. Each square is half of a domino, and can be rotated either vertically or horizontally, independently from its neighbors. Vertically rotated domino halves look like this:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF77D/24b223911e7d414b4105f5f7b384a2c2404033bc.png)And horizontally rotated halves look like this:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF77D/2e953cc07e102d1dc6925e21d1623a202ee1f98f.png)Notice, that some halves looks the same in both rotations, but other halves differ.\n\nDominoes bought by Hexadecimal are represented by uncuttable chips $ 1\u00d72 $ in size, which can be laid either vertically or horizontally. If the chip is laid vertically, then both of it's halves should be laid vertically orientated; if the chip is laid horizontally, then both of it's halves should be laid horizontally.\n\nThe samples of valid and invalid dominoes laid vertically and horizontally are:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF77D/5374017256a96c5a451a244dd383a369135da2b6.png)Virus Hexadecimal assembles her own Domino Carpet so that the following conditions are satisfied:\n\n- each carpet square is covered by a domino chip, i.e. there are no empty squares;\n- all domino chips lie entirely within the carpet and don't overlap with each other;\n- if there is a horizontal domino chip with its left half in column $ j $ then there are no horizontal domino chips with their left halves in columns $ j-1 $ or $ j+1 $ .\n\nBefore starting to assemble her own Domino Carpet, the virus wants to know the number of ways to achieve the intended purpose modulo $ 10^{9}+7 $ .\n\nYou can assume that the virus has an infinitely large number of dominoes of each type.",
    "inputFormat": "The first line contains two integers $ n $ and $ m $ , separated by a space \u2014 the size of the Domino Carpet ( $ 1<=n,m<=250 $ ). Next $ 4n+1 $ lines contain $ 4m+1 $ symbols.\n\nEach square of the Domino Carpet, which is a domino half, is described by a $ 3\u00d73 $ square. Symbol 'O' in this square indicates the presence of a point, symbol '.' \u2014 its absence.\n\nEach $ 3\u00d73 $ square is delineated from adjacent squares by symbols '#' as shown in the examples.\n\nIt is guaranteed that every box describes the correct half of a domino.\n\nIn all pretests the Domino Carpets have the size of $ 2\u00d72 $ and $ 4\u00d74 $ .",
    "outputFormat": "Print a single number, the number of ways to assemble the Domino Carpet modulo $ 10^{9}+7 $ , using only standard dominoes of size $ 1\u00d72 $ .",
    "samples": [
        [
            "3 4\n#################\n#O..#...#O.O#...#\n#.O.#.O.#.O.#...#\n#..O#...#O.O#...#\n#################\n#O.O#OOO#O.O#...#\n#.O.#...#...#.O.#\n#O.O#OOO#O.O#...#\n#################\n#O.O#...#O.O#...#\n#...#...#...#.O.#\n#O.O#...#O.O#...#\n#################\n",
            "3"
        ],
        [
            "2 2\n#########\n#O.O#O.O#\n#.O.#...#\n#O.O#O.O#\n#########\n#...#O.O#\n#...#...#\n#...#O.O#\n#########\n",
            "2"
        ],
        [
            "2 2\n#########\n#..O#O..#\n#...#...#\n#O..#..O#\n#########\n#O..#..O#\n#...#...#\n#..O#O..#\n#########\n",
            "0"
        ]
    ],
    "hint": "A note to the first example: all correct ways to make Domino Carpet are represented below:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF77D/981dbdf83cacdc8575134f74d310175de347a9dc.png)And this way is incorrect:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF77D/e27d2b360b8d6e5a93ae8ba6b82c2ca4f625b27b.png)",
    "translation": "\u6709\u82e5\u5e72\u4e2a $1\\times2$ \u7684\u591a\u7c73\u8bfa\u9aa8\u724c\u3002\n\n\u6a2a\u5411\u7684\u9aa8\u724c\u7531\u5982\u56fe\u6240\u793a\u7684\u51e0\u4e2a\u65b9\u683c\u4e2d\u7684\u4efb\u610f\u4e24\u4e2a**\u4e0d\u52a0\u65cb\u8f6c**\u62fc\u63a5\u800c\u6210\u3002\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF77D/2e953cc07e102d1dc6925e21d1623a202ee1f98f.png)\n\n\u7eb5\u5411\u7684\u9aa8\u724c\u7531\u5982\u56fe\u6240\u793a\u7684\u51e0\u4e2a\u65b9\u683c\u4e2d\u7684\u4efb\u610f\u4e24\u4e2a**\u4e0d\u52a0\u65cb\u8f6c**\u62fc\u63a5\u800c\u6210\u3002\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF77D/24b223911e7d414b4105f5f7b384a2c2404033bc.png)\n\n\u5982\u56fe\u4e3a\u5408\u6cd5\u7684\u9aa8\u724c\uff0c\u800c\u6253\u4e86\u7ea2\u53c9\u7684\u4e3a\u4e0d\u5408\u6cd5\u7684\u9aa8\u724c\u3002\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF77D/5374017256a96c5a451a244dd383a369135da2b6.png)\n\n\u7ed9\u5b9a\u4e00\u4e2a\u591a\u7c73\u8bfa\u9aa8\u724c\u62fc\u63a5\u6210\u7684\u56fe\u5f62\uff0c\u6c42\u4e00\u5171\u6709\u51e0\u79cd\u65b9\u6848\u62fc\u63a5\u8fd9\u4e2a\u56fe\u5f62\u3002\n\n\u7b54\u6848\u5bf9\u4e8e $10^9+7$ \u53d6\u6a21\u3002\n\n\u7531 [Error_Eric](https://www.luogu.com.cn/user/217300)\u7ffb\u8bd1\u3002"
}
{
    "description": "\u2014 Willem...\n\n\u2014 What's the matter?\n\n\u2014 It seems that there's something wrong with Seniorious...\n\n\u2014 I'll have a look...\n\n\n\n\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF896C/98774bbeb6d46d43baff377283b5b8c924efc206.png)\n\nSeniorious is made by linking special talismans in particular order.\n\nAfter over 500 years, the carillon is now in bad condition, so Willem decides to examine it thoroughly.\n\nSeniorious has $ n $ pieces of talisman. Willem puts them in a line, the $ i $ -th of which is an integer $ a_{i} $ .\n\nIn order to maintain it, Willem needs to perform $ m $ operations.\n\nThere are four types of operations:\n\n- $ 1\\ l\\ r\\ x $ : For each $ i $ such that $ l<=i<=r $ , assign $ a_{i}+x $ to $ a_{i} $ .\n- $ 2\\ l\\ r\\ x $ : For each $ i $ such that $ l<=i<=r $ , assign $ x $ to $ a_{i} $ .\n- $ 3\\ l\\ r\\ x $ : Print the $ x $ -th smallest number in the index range $ [l,r] $ , i.e. the element at the $ x $ -th position if all the elements $ a_{i} $ such that $ l<=i<=r $ are taken and sorted into an array of non-decreasing integers. It's guaranteed that $ 1<=x<=r-l+1 $ .\n- $ 4\\ l\\ r\\ x\\ y $ : Print the sum of the $ x $ -th power of $ a_{i} $ such that $ l<=i<=r $ , modulo $ y $ , i.e. ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF896C/78509e8cef6ae4ac71093ef3596987ee9ded5b23.png).",
    "inputFormat": "The only line contains four integers $ n,m,seed,v_{max} $ ( $ 1<=n,m<=10^{5},0<=seed<10^{9}+7,1<=vmax<=10^{9} $ ).\n\nThe initial values and operations are generated using following pseudo code:\n```\ndef rnd():\n\n    ret = seed\n    seed = (seed * 7 + 13) mod 1000000007\n    return ret\n\nfor i = 1 to n:\n\n    a[i] = (rnd() mod vmax) + 1\n\nfor i = 1 to m:\n\n    op = (rnd() mod 4) + 1\n    l = (rnd() mod n) + 1\n    r = (rnd() mod n) + 1\n\n    if (l > r): \n         swap(l, r)\n\n    if (op == 3):\n        x = (rnd() mod (r - l + 1)) + 1\n    else:\n        x = (rnd() mod vmax) + 1\n\n    if (op == 4):\n        y = (rnd() mod vmax) + 1\n```\nHere $ op $ is the type of the operation mentioned in the legend.",
    "outputFormat": "For each operation of types $ 3 $ or $ 4 $ , output a line containing the answer.",
    "samples": [
        [
            "10 10 7 9\n",
            "2\n1\n0\n3\n"
        ],
        [
            "10 10 9 9\n",
            "1\n1\n3\n3\n"
        ]
    ],
    "hint": "In the first example, the initial array is $ {8,9,7,2,3,1,5,6,4,8} $ .\n\nThe operations are:\n\n- $ 2\\ 6\\ 7\\ 9 $\n- $ 1\\ 3\\ 10\\ 8 $\n- $ 4\\ 4\\ 6\\ 2\\ 4 $\n- $ 1\\ 4\\ 5\\ 8 $\n- $ 2\\ 1\\ 7\\ 1 $\n- $ 4\\ 7\\ 9\\ 4\\ 4 $\n- $ 1\\ 2\\ 7\\ 9 $\n- $ 4\\ 5\\ 8\\ 1\\ 1 $\n- $ 2\\ 5\\ 7\\ 5 $\n- $ 4\\ 3\\ 10\\ 8\\ 5 $",
    "translation": "\u3010\u9898\u9762\u3011\n\u8bf7\u4f60\u5199\u4e00\u79cd\u5947\u602a\u7684\u6570\u636e\u7ed3\u6784\uff0c\u652f\u6301\uff1a\n- $1$  $l$  $r$  $x$ \uff1a\u5c06$[l,r]$ \u533a\u95f4\u6240\u6709\u6570\u52a0\u4e0a$x$ \n- $2$  $l$  $r$  $x$ \uff1a\u5c06$[l,r]$ \u533a\u95f4\u6240\u6709\u6570\u6539\u6210$x$ \n- $3$  $l$  $r$  $x$ \uff1a\u8f93\u51fa\u5c06$[l,r]$ \u533a\u95f4\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u540e\u7684\u7b2c$x$ \u4e2a\u6570\u662f\u7684\u591a\u5c11(\u5373\u533a\u95f4\u7b2c$x$ \u5c0f\uff0c\u6570\u5b57\u5927\u5c0f\u76f8\u540c\u7b97\u591a\u6b21\uff0c\u4fdd\u8bc1 $1\\leq$  $x$  $\\leq$  $r-l+1$  )\n- $4$  $l$  $r$  $x$  $y$ \uff1a\u8f93\u51fa$[l,r]$ \u533a\u95f4\u6bcf\u4e2a\u6570\u5b57\u7684$x$ \u6b21\u65b9\u7684\u548c\u6a21$y$ \u7684\u503c(\u5373($\\sum^r_{i=l}a_i^x$ ) $\\mod y$ )\n\n\u3010\u8f93\u5165\u683c\u5f0f\u3011\n\u8fd9\u9053\u9898\u76ee\u7684\u8f93\u5165\u683c\u5f0f\u6bd4\u8f83\u7279\u6b8a\uff0c\u9700\u8981\u9009\u624b\u901a\u8fc7$seed$ \u81ea\u5df1\u751f\u6210\u8f93\u5165\u6570\u636e\u3002\n\u8f93\u5165\u4e00\u884c\u56db\u4e2a\u6574\u6570$n,m,seed,v_{max}$ \uff08$1\\leq $  $n,m\\leq 10^{5}$  ,$0\\leq seed \\leq 10^{9}+7$  $,1\\leq vmax \\leq 10^{9} $ \uff09\n\u5176\u4e2d$n$ \u8868\u793a\u6570\u5217\u957f\u5ea6\uff0c$m$ \u8868\u793a\u64cd\u4f5c\u6b21\u6570\uff0c\u540e\u9762\u4e24\u4e2a\u7528\u4e8e\u751f\u6210\u8f93\u5165\u6570\u636e\u3002\n\u6570\u636e\u751f\u6210\u7684\u4f2a\u4ee3\u7801\u5982\u4e0b\n![](https://cdn.luogu.org/upload/pic/13887.png )\n\n\u5176\u4e2d\u4e0a\u9762\u7684op\u6307\u9898\u9762\u4e2d\u63d0\u5230\u7684\u56db\u4e2a\u64cd\u4f5c\u3002\n\n\u3010\u8f93\u51fa\u683c\u5f0f\u3011\n\u5bf9\u4e8e\u6bcf\u4e2a\u64cd\u4f5c3\u548c4\uff0c\u8f93\u51fa\u4e00\u884c\u4ec5\u4e00\u4e2a\u6570\u3002"
}
{
    "description": "This is the harder version of the problem. In this version, $ 1 \\le n, m \\le 2\\cdot10^5 $ . You can hack this problem if you locked it. But you can hack the previous problem only if you locked both problems.\n\nYou are given a sequence of integers $ a=[a_1,a_2,\\dots,a_n] $ of length $ n $ . Its subsequence is obtained by removing zero or more elements from the sequence $ a $ (they do not necessarily go consecutively). For example, for the sequence $ a=[11,20,11,33,11,20,11] $ :\n\n- $ [11,20,11,33,11,20,11] $ , $ [11,20,11,33,11,20] $ , $ [11,11,11,11] $ , $ [20] $ , $ [33,20] $ are subsequences (these are just some of the long list);\n- $ [40] $ , $ [33,33] $ , $ [33,20,20] $ , $ [20,20,11,11] $ are not subsequences.\n\nSuppose that an additional non-negative integer $ k $ ( $ 1 \\le k \\le n $ ) is given, then the subsequence is called optimal if:\n\n- it has a length of $ k $ and the sum of its elements is the maximum possible among all subsequences of length $ k $ ;\n- and among all subsequences of length $ k $ that satisfy the previous item, it is lexicographically minimal.\n\nRecall that the sequence $ b=[b_1, b_2, \\dots, b_k] $ is lexicographically smaller than the sequence $ c=[c_1, c_2, \\dots, c_k] $ if the first element (from the left) in which they differ less in the sequence $ b $ than in $ c $ . Formally: there exists $ t $ ( $ 1 \\le t \\le k $ ) such that $ b_1=c_1 $ , $ b_2=c_2 $ , ..., $ b_{t-1}=c_{t-1} $ and at the same time $ b_t<c_t $ . For example:\n\n- $ [10, 20, 20] $ lexicographically less than $ [10, 21, 1] $ ,\n- $ [7, 99, 99] $ is lexicographically less than $ [10, 21, 1] $ ,\n- $ [10, 21, 0] $ is lexicographically less than $ [10, 21, 1] $ .\n\nYou are given a sequence of $ a=[a_1,a_2,\\dots,a_n] $ and $ m $ requests, each consisting of two numbers $ k_j $ and $ pos_j $ ( $ 1 \\le k \\le n $ , $ 1 \\le pos_j \\le k_j $ ). For each query, print the value that is in the index $ pos_j $ of the optimal subsequence of the given sequence $ a $ for $ k=k_j $ .\n\nFor example, if $ n=4 $ , $ a=[10,20,30,20] $ , $ k_j=2 $ , then the optimal subsequence is $ [20,30] $ \u2014 it is the minimum lexicographically among all subsequences of length $ 2 $ with the maximum total sum of items. Thus, the answer to the request $ k_j=2 $ , $ pos_j=1 $ is the number $ 20 $ , and the answer to the request $ k_j=2 $ , $ pos_j=2 $ is the number $ 30 $ .",
    "inputFormat": "The first line contains an integer $ n $ ( $ 1 \\le n \\le 2\\cdot10^5 $ ) \u2014 the length of the sequence $ a $ .\n\nThe second line contains elements of the sequence $ a $ : integer numbers $ a_1, a_2, \\dots, a_n $ ( $ 1 \\le a_i \\le 10^9 $ ).\n\nThe third line contains an integer $ m $ ( $ 1 \\le m \\le 2\\cdot10^5 $ ) \u2014 the number of requests.\n\nThe following $ m $ lines contain pairs of integers $ k_j $ and $ pos_j $ ( $ 1 \\le k \\le n $ , $ 1 \\le pos_j \\le k_j $ ) \u2014 the requests.",
    "outputFormat": "Print $ m $ integers $ r_1, r_2, \\dots, r_m $ ( $ 1 \\le r_j \\le 10^9 $ ) one per line: answers to the requests in the order they appear in the input. The value of $ r_j $ should be equal to the value contained in the position $ pos_j $ of the optimal subsequence for $ k=k_j $ .",
    "samples": [
        [
            "3\n10 20 10\n6\n1 1\n2 1\n2 2\n3 1\n3 2\n3 3\n",
            "20\n10\n20\n10\n20\n10\n"
        ],
        [
            "7\n1 2 1 3 1 2 1\n9\n2 1\n2 2\n3 1\n3 2\n3 3\n1 1\n7 1\n7 7\n7 4\n",
            "2\n3\n2\n3\n2\n3\n1\n1\n3\n"
        ]
    ],
    "hint": "In the first example, for $ a=[10,20,10] $ the optimal subsequences are:\n\n- for $ k=1 $ : $ [20] $ ,\n- for $ k=2 $ : $ [10,20] $ ,\n- for $ k=3 $ : $ [10,20,10] $ .",
    "translation": "**\u672c\u9898\u4e3a\u8f83\u56f0\u96be\u7248\u672c\u3002**\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6b63\u6574\u6570\u5e8f\u5217 $a_1,a_2,...,a_n$\u3002\n\n\u6709 $m$ \u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u51fa\u4e24\u4e2a\u6b63\u6574\u6570 $k,pos$\u3002\u4f60\u9700\u8981\u627e\u5230\u4e00\u4e2a\u957f\u5ea6\u4e3a $k$ \u7684**\u5b50\u5e8f\u5217**\uff0c\u4e14\u6ee1\u8db3\u5982\u4e0b\u8981\u6c42\uff1a\n\n- \u8be5\u5b50\u5e8f\u5217\u7684**\u5143\u7d20\u548c**\u662f\u6240\u6709\u5b50\u5e8f\u5217\u4e2d\u6700\u5927\u7684\uff1b\n- \u8be5\u5b50\u5e8f\u5217\u662f\u6240\u6709\u6ee1\u8db3\u4e0a\u4e00\u6761\u4ef6\u7684\u5b50\u5e8f\u5217\u4e2d**\u5b57\u5178\u5e8f**\u6700\u5c0f\u7684\u4e00\u4e2a\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u8f93\u51fa\u8be5\u5b50\u5e8f\u5217\u7684\u7b2c $pos$ \u4e2a\u5143\u7d20\u7684\u503c\u3002\n\n$1 \\le n,m \\le 2 \\times 10^5$\uff08\u8fd9\u662f\u4e0e\u7b80\u5355\u7248\u672c**\u552f\u4e00**\u7684\u533a\u522b\uff09\uff0c $\\ 1 \\le k \\le n$\uff0c\u5728\u540c\u4e00\u8be2\u95ee\u4e2d\u6709 $1 \\le pos \\le k$\u3002\n\nTranslated by HoshizoraZ"
}
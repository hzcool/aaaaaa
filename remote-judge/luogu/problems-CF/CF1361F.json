{
    "description": "Johnny has a new toy. As you may guess, it is a little bit extraordinary. The toy is a permutation $ P $ of numbers from $ 1 $ to $ n $ , written in one row next to each other.\n\nFor each $ i $ from $ 1 $ to $ n - 1 $ between $ P_i $ and $ P_{i + 1} $ there is a weight $ W_i $ written, and those weights form a permutation of numbers from $ 1 $ to $ n - 1 $ . There are also extra weights $ W_0 = W_n = 0 $ .\n\nThe instruction defines subsegment $ [L, R] $ as good if $ W_{L - 1} < W_i $ and $ W_R < W_i $ for any $ i $ in $ \\{L, L + 1, \\ldots, R - 1\\} $ . For such subsegment it also defines $ W_M $ as minimum of set $ \\{W_L, W_{L + 1}, \\ldots, W_{R - 1}\\} $ .\n\nNow the fun begins. In one move, the player can choose one of the good subsegments, cut it into $ [L, M] $ and $ [M + 1, R] $ and swap the two parts. More precisely, before one move the chosen subsegment of our toy looks like: $ $$$W_{L - 1}, P_L, W_L, \\ldots, W_{M - 1}, P_M, W_M, P_{M + 1}, W_{M + 1}, \\ldots, W_{R - 1}, P_R, W_R $ $  and afterwards it looks like this:  $ $ W_{L - 1}, P_{M + 1}, W_{M + 1}, \\ldots, W_{R - 1}, P_R, W_M, P_L, W_L, \\ldots, W_{M - 1}, P_M, W_R $ $  Such a move can be performed multiple times (possibly zero), and the goal is to achieve the minimum number of inversions in  $ P $ . </p><p>Johnny's younger sister Megan thinks that the rules are too complicated, so she wants to test her brother by choosing some pair of indices  $ X $  and  $ Y $ , and swapping  $ P\\_X $  and  $ P\\_Y $  ( $ X $  might be equal  $ Y $ ). After each sister's swap, Johnny wonders, what is the minimal number of inversions that he can achieve, starting with current  $ P $  and making legal moves?</p><p>You can assume that the input is generated <span class=\"tex-font-style-bf\">randomly</span>.  $ P $  and  $ W$$$ were chosen independently and equiprobably over all permutations; also, Megan's requests were chosen independently and equiprobably over all pairs of indices.",
    "inputFormat": "The first line contains single integer $ n $ $ (2 \\leq n \\leq 2 \\cdot 10^5) $ denoting the length of the toy.\n\nThe second line contains $ n $ distinct integers $ P_1, P_2, \\ldots, P_n $ $ (1 \\leq P_i \\leq n) $ denoting the initial permutation $ P $ . The third line contains $ n - 1 $ distinct integers $ W_1, W_2, \\ldots, W_{n - 1} $ $ (1 \\leq W_i \\leq n - 1) $ denoting the weights.\n\nThe fourth line contains single integer $ q $ $ (1 \\leq q \\leq 5 \\cdot 10^4) $ \u2014 the number of Megan's swaps. The following $ q $ lines contain two integers $ X $ and $ Y $ $ (1 \\leq X, Y \\leq n) $ \u2014 the indices of elements of $ P $ to swap. The queries aren't independent; after each of them, the permutation is changed.",
    "outputFormat": "Output $ q $ lines. The $ i $ -th line should contain exactly one integer \u2014 the minimum number of inversions in permutation, which can be obtained by starting with the $ P $ after first $ i $ queries and making moves described in the game's instruction.",
    "samples": [
        [
            "3\n3 2 1\n2 1\n3\n1 3\n3 2\n3 1",
            "0\n1\n0"
        ],
        [
            "5\n4 3 2 5 1\n3 2 1 4\n7\n5 4\n5 2\n1 5\n2 4\n2 4\n4 3\n3 3",
            "3\n1\n2\n1\n2\n3\n3"
        ]
    ],
    "hint": "Consider the first sample. After the first query, $ P $ is sorted, so we already achieved a permutation with no inversions.\n\nAfter the second query, $ P $ is equal to \\[ $ 1 $ , $ 3 $ , $ 2 $ \\], it has one inversion, it can be proven that it is impossible to achieve $ 0 $ inversions.\n\nIn the end, $ P $ is equal to \\[ $ 2 $ , $ 3 $ , $ 1 $ \\]; we can make a move on the whole permutation, as it is a good subsegment itself, which results in $ P $ equal to \\[ $ 1 $ , $ 2 $ , $ 3 $ \\], which has $ 0 $ inversions.",
    "translation": "\u7ed9\u5b9a\u4e00\u4e2a\u5e8f\u5217 $P_1W_1P_2W_2 \\cdots W_{n-1}P_n$\n\n\u662f\u4e00\u4e2a $1$ \u5230 $n$ \u7684\u6392\u5217\uff0c$W$ \u662f\u4e00\u4e2a $1$ \u5230 $n\u22121$ \u7684\u6392\u5217\uff0c\u5b9a\u4e49 $W_0=W_n=0$\n\n\u6bcf\u6b21\u53ef\u4ee5\u9009\u62e9\u4e00\u5bf9 $1 \\le l \\le r < n$\n\u6ee1\u8db3 $\\min_{i=l}^r{W_i}>\\max \\{W_{l-1},W_{r+1} \\}$\n\n\u8bbe $W_{l\\cdots r}$ \u4e2d\u7684\u6700\u5c0f\u503c\u4e3a $W_m$\uff0c\u628a $P_l$ \u5230 $P_m$ \u7ec4\u6210\u7684\u6bb5\u548c $P_{m+1}$ \u5230 $P_{r+1}$\n\u7ec4\u6210\u7684\u6bb5\u4e92\u6362\u4f4d\u7f6e\n\n\u8fd9\u79cd\u64cd\u4f5c\u53ef\u4ee5\u8fdb\u884c\u4efb\u610f\u591a\u6b21\uff0c\u6709 $q$ \u6b21\u4fee\u6539\uff0c\u6bcf\u6b21\u4ea4\u6362 $P$ \u4e2d\u7684\u4e24\u4e2a\u6570\uff0c\u4fee\u6539\u540e\u6c42 $P$ \u80fd\u8fbe\u5230\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\u6700\u5c0f\u503c\n\n$2 \\le n \\le 2 \\times 10^5,1 \\le q \\le 5 \\times 10^4$\uff0c\u4fdd\u8bc1\u4e24\u4e2a\u6392\u5217\u548c\u6240\u6709\u4fee\u6539\u968f\u673a\u751f\u6210"
}
{
    "description": "This is the hard version of the problem. The only difference from the easy version is that in this version the coordinates can be both odd and even.\n\nThere are $ n $ fence-posts at distinct coordinates on a plane. It is guaranteed that no three fence posts lie on the same line.\n\nThere are an infinite number of cows on the plane, one at every point with integer coordinates.\n\nGregor is a member of the Illuminati, and wants to build a triangular fence, connecting $ 3 $ distinct existing fence posts. A cow strictly inside the fence is said to be enclosed. If there are an odd number of enclosed cows and the area of the fence is an integer, the fence is said to be interesting.\n\nFind the number of interesting fences.",
    "inputFormat": "The first line contains the integer $ n $ ( $ 3 \\le n \\le 6000 $ ), the number of fence posts which Gregor can choose to form the vertices of a fence.\n\nEach of the next $ n $ line contains two integers $ x $ and $ y $ ( $ 0 \\le x,y \\le 10^7 $ , where $ (x,y) $ is the coordinate of a fence post. All fence posts lie at distinct coordinates. No three fence posts are on the same line.",
    "outputFormat": "Print a single integer, the number of interesting fences. Two fences are considered different if they are constructed with a different set of three fence posts.",
    "samples": [
        [
            "3\n0 0\n2 0\n0 4",
            "1"
        ],
        [
            "4\n1 8\n0 6\n5 2\n5 6",
            "1"
        ],
        [
            "10\n170 59\n129 54\n5 98\n129 37\n58 193\n154 58\n24 3\n13 138\n136 144\n174 150",
            "29"
        ]
    ],
    "hint": "In the first example, there is only $ 1 $ fence. That fence is interesting since its area is $ 4 $ and there is $ 1 $ enclosed cow, marked in red.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1548D2/0403ceae6e73450fcff5ed53159c4a8d4ef6577c.png)In the second example, there are $ 4 $ possible fences. Only one of them is interesting however. That fence has an area of $ 8 $ and $ 5 $ enclosed cows.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1548D2/ce471f2b829d9495e34a49534fc52a48c1ca9528.png)",
    "translation": "\u7ed9\u4e00\u4e2a\u7f51\u683c\u56fe\uff0c\u4e0a\u9762\u6709 $n$ \u4e2a\u70b9\uff0c\u4fdd\u8bc1\u4e0d\u5b58\u5728\u4e09\u70b9\u5171\u7ebf\u4e14\u6bcf\u4e2a\u70b9\u90fd\u5728\u683c\u70b9\u4e0a\uff0c\u8be2\u95ee\u6709\u591a\u5c11\u4e2a\u4e09\u5143\u7ec4 $(p_1,p_2,p_3)(p_1<p_2<p_3<n)$ \u6ee1\u8db3\u7531 $p_1,p_2,p_3$ \u4e09\u4e2a\u70b9\u6784\u6210\u7684\u4e09\u89d2\u5f62\u7684\u9762\u79ef\u662f\u6574\u6570\uff0c\u5e76\u4e14\u5185\u90e8\uff08\u4e0d\u5305\u542b\u8fb9\u754c\uff09\u7684\u683c\u70b9\u6570\u91cf\u662f\u5947\u6570\u3002"
}
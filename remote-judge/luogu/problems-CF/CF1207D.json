{
    "description": "You are given a sequence of $ n $ pairs of integers: $ (a_1, b_1), (a_2, b_2), \\dots , (a_n, b_n) $ . This sequence is called bad if it is sorted in non-descending order by first elements or if it is sorted in non-descending order by second elements. Otherwise the sequence is good. There are examples of good and bad sequences:\n\n- $ s = [(1, 2), (3, 2), (3, 1)] $ is bad because the sequence of first elements is sorted: $ [1, 3, 3] $ ;\n- $ s = [(1, 2), (3, 2), (1, 2)] $ is bad because the sequence of second elements is sorted: $ [2, 2, 2] $ ;\n- $ s = [(1, 1), (2, 2), (3, 3)] $ is bad because both sequences (the sequence of first elements and the sequence of second elements) are sorted;\n- $ s = [(1, 3), (3, 3), (2, 2)] $ is good because neither the sequence of first elements $ ([1, 3, 2]) $ nor the sequence of second elements $ ([3, 3, 2]) $ is sorted.\n\nCalculate the number of permutations of size $ n $ such that after applying this permutation to the sequence $ s $ it turns into a good sequence.\n\nA permutation $ p $ of size $ n $ is a sequence $ p_1, p_2, \\dots , p_n $ consisting of $ n $ distinct integers from $ 1 $ to $ n $ ( $ 1 \\le p_i \\le n $ ). If you apply permutation $ p_1, p_2, \\dots , p_n $ to the sequence $ s_1, s_2, \\dots , s_n $ you get the sequence $ s_{p_1}, s_{p_2}, \\dots , s_{p_n} $ . For example, if $ s = [(1, 2), (1, 3), (2, 3)] $ and $ p = [2, 3, 1] $ then $ s $ turns into $ [(1, 3), (2, 3), (1, 2)] $ .",
    "inputFormat": "The first line contains one integer $ n $ ( $ 1 \\le n \\le 3 \\cdot 10^5 $ ).\n\nThe next $ n $ lines contains description of sequence $ s $ . The $ i $ -th line contains two integers $ a_i $ and $ b_i $ ( $ 1 \\le a_i, b_i \\le n $ ) \u2014 the first and second elements of $ i $ -th pair in the sequence.\n\nThe sequence $ s $ may contain equal elements.",
    "outputFormat": "Print the number of permutations of size $ n $ such that after applying this permutation to the sequence $ s $ it turns into a good sequence. Print the answer modulo $ 998244353 $ (a prime number).",
    "samples": [
        [
            "3\n1 1\n2 2\n3 1\n",
            "3\n"
        ],
        [
            "4\n2 3\n2 2\n2 1\n2 4\n",
            "0\n"
        ],
        [
            "3\n1 1\n1 1\n2 3\n",
            "4\n"
        ]
    ],
    "hint": "In first test case there are six permutations of size $ 3 $ :\n\n1. if $ p = [1, 2, 3] $ , then $ s = [(1, 1), (2, 2), (3, 1)] $ \u2014 bad sequence (sorted by first elements);\n2. if $ p = [1, 3, 2] $ , then $ s = [(1, 1), (3, 1), (2, 2)] $ \u2014 bad sequence (sorted by second elements);\n3. if $ p = [2, 1, 3] $ , then $ s = [(2, 2), (1, 1), (3, 1)] $ \u2014 good sequence;\n4. if $ p = [2, 3, 1] $ , then $ s = [(2, 2), (3, 1), (1, 1)] $ \u2014 good sequence;\n5. if $ p = [3, 1, 2] $ , then $ s = [(3, 1), (1, 1), (2, 2)] $ \u2014 bad sequence (sorted by second elements);\n6. if $ p = [3, 2, 1] $ , then $ s = [(3, 1), (2, 2), (1, 1)] $ \u2014 good sequence.",
    "translation": "\u7ed9\u5b9a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5bf9\u5217 $s_1 \\sim s_n$\uff0c\u5176\u4e2d $s_i = (a_i, b_i)$ \u7ed9\u5b9a\u3002**\u597d\u5e8f\u5217**\u7684\u5b9a\u4e49\u662f\uff1a\u4ec5\u770b\u7b2c\u4e00\u5173\u952e\u5b57\u6216\u7b2c\u4e8c\u5173\u952e\u5b57\u90fd\u4e0d\u6309\u5347\u5e8f\u6392\u5e8f\u7684\u5e8f\u5217\u3002\n\n\u8f93\u51fa\u7b26\u5408\u9898\u610f\u7684\u5927\u5c0f\u4e3a $n$ \u7684\u6392\u5217\u7684\u65b9\u6848\u6570\uff0c\u4f7f\u5f97\u7ecf\u8fc7\u8fd9\u4e9b\u6392\u5217\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u7684\u6392\u5217\u64cd\u4f5c\u4e4b\u540e\uff0c\u5e8f\u5217 $s$ \u4f1a\u6210\u4e3a\u4e00\u4e2a**\u597d\u5e8f\u5217**\u3002\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\uff08\u4e00\u4e2a\u8d28\u6570\uff09\u3002"
}
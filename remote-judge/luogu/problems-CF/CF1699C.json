{
    "description": "You are given a permutation $ a_1,a_2,\\ldots,a_n $ of integers from $ 0 $ to $ n - 1 $ . Your task is to find how many permutations $ b_1,b_2,\\ldots,b_n $ are similar to permutation $ a $ .\n\nTwo permutations $ a $ and $ b $ of size $ n $ are considered similar if for all intervals $ [l,r] $ ( $ 1 \\le l \\le r \\le n $ ), the following condition is satisfied: $ $$$\\operatorname{MEX}([a_l,a_{l+1},\\ldots,a_r])=\\operatorname{MEX}([b_l,b_{l+1},\\ldots,b_r]), $ $  where the  $ \\\\operatorname{MEX} $  of a collection of integers  $ c\\_1,c\\_2,\\\\ldots,c\\_k $  is defined as the smallest non-negative integer  $ x $  which does not occur in collection  $ c $ . For example,  $ \\\\operatorname{MEX}(\\[1,2,3,4,5\\])=0 $ , and  $ \\\\operatorname{MEX}(\\[0,1,2,4,5\\])=3 $ .</p><p>Since the total number of such permutations can be very large, you will have to print its remainder modulo  $ 10^9+7 $ .</p><p>In this problem, a permutation of size  $ n $  is an array consisting of  $ n $  distinct integers from  $ 0 $  to  $ n-1 $  in arbitrary order. For example,  $ \\[1,0,2,4,3\\] $  is a permutation, while  $ \\[0,1,1\\] $  is not, since  $ 1 $  appears twice in the array.  $ \\[0,1,3\\] $  is also not a permutation, since  $ n=3 $  and there is a  $ 3$$$ in the array.",
    "inputFormat": "Each test contains multiple test cases. The first line of input contains one integer $ t $ ( $ 1 \\le t \\le 10^4 $ ) \u2014 the number of test cases. The following lines contain the descriptions of the test cases.\n\nThe first line of each test case contains a single integer $ n $ ( $ 1 \\le n \\le 10^5 $ ) \u2014 the size of permutation $ a $ .\n\nThe second line of each test case contains $ n $ distinct integers $ a_1,a_2,\\ldots,a_n $ ( $ 0 \\le a_i \\lt n $ ) \u2014 the elements of permutation $ a $ .\n\nIt is guaranteed that the sum of $ n $ across all test cases does not exceed $ 10^5 $ .",
    "outputFormat": "For each test case, print a single integer, the number of permutations similar to permutation $ a $ , taken modulo $ 10^9+7 $ .",
    "samples": [
        [
            "5\n5\n4 0 3 2 1\n1\n0\n4\n0 1 2 3\n6\n1 2 4 0 5 3\n8\n1 3 7 2 5 0 6 4",
            "2\n1\n1\n4\n72"
        ]
    ],
    "hint": "For the first test case, the only permutations similar to $ a=[4,0,3,2,1] $ are $ [4,0,3,2,1] $ and $ [4,0,2,3,1] $ .\n\nFor the second and third test cases, the given permutations are only similar to themselves.\n\nFor the fourth test case, there are $ 4 $ permutations similar to $ a=[1,2,4,0,5,3] $ :\n\n- $ [1,2,4,0,5,3] $ ;\n- $ [1,2,5,0,4,3] $ ;\n- $ [1,4,2,0,5,3] $ ;\n- $ [1,5,2,0,4,3] $ .",
    "translation": "\u7ed9\u5b9a\u4e00\u4e2a $0\\sim n-1$ \u7684\u6392\u5217 $a$\u3002\u5b9a\u4e49 $0~n-1$ \u7684\u6392\u5217 $b$ \u4e0e $a$ \u76f8\u4f3c\uff0c\u5f53\u4e14\u4ec5\u5f53 $\\forall 1\\le l\\le r\\le n$\uff0c\u6709 $\\operatorname{MEX}_{i=l}^r a_i=\\operatorname{MEX}_{i=l}^r b_i$\u3002\u6c42\u4e0e $a$ \u76f8\u4f3c\u7684\u6392\u5217\u4e2a\u6570\uff08$\\bmod (10^9+7)$\uff09\u3002\n\n\u6ce8\uff1a\u4e00\u4e2a\u6570\u5217\u7684 $\\operatorname{MEX}$ \u8868\u793a**\u6ca1\u6709\u51fa\u73b0\u5728\u6570\u5217\u4e2d\u7684\u6700\u5c0f\u81ea\u7136\u6570**\uff0c\u5982 $\\operatorname{MEX}([1,2,3,4,5]) = 0$\uff0c$\\operatorname{MEX}([0,1,2,4,5]) = 3$\u3002\n\n\u591a\u6d4b\uff0c$t\\le10^4$\uff0c$1\\le n,\\sum n\\le10^5$\uff0c$0\\le a_i<n$\u3002\n\nTranslated by @Sya_Resory"
}
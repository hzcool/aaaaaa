{
    "description": "You are given a permutation $ p_1, p_2, \\dots, p_n $ . You should answer $ q $ queries. Each query is a pair $ (l_i, r_i) $ , and you should calculate $ f(l_i, r_i) $ .\n\nLet's denote $ m_{l, r} $ as the position of the maximum in subsegment $ p_l, p_{l+1}, \\dots, p_r $ .\n\nThen $ f(l, r) = (r - l + 1) + f(l, m_{l,r} - 1) + f(m_{l,r} + 1, r) $ if $ l \\le r $ or $ 0 $ otherwise.",
    "inputFormat": "The first line contains two integers $ n $ and $ q $ ( $ 1 \\le n \\le 10^6 $ , $ 1 \\le q \\le 10^6 $ ) \u2014 the size of the permutation $ p $ and the number of queries.\n\nThe second line contains $ n $ pairwise distinct integers $ p_1, p_2, \\dots, p_n $ ( $ 1 \\le p_i \\le n $ , $ p_i \\neq p_j $ for $ i \\neq j $ ) \u2014 permutation $ p $ .\n\nThe third line contains $ q $ integers $ l_1, l_2, \\dots, l_q $ \u2014 the first parts of the queries.\n\nThe fourth line contains $ q $ integers $ r_1, r_2, \\dots, r_q $ \u2014 the second parts of the queries.\n\nIt's guaranteed that $ 1 \\le l_i \\le r_i \\le n $ for all queries.",
    "outputFormat": "Print $ q $ integers \u2014 the values $ f(l_i, r_i) $ for the corresponding queries.",
    "samples": [
        [
            "4 5\n3 1 4 2\n2 1 1 2 1\n2 3 4 4 1\n",
            "1 6 8 5 1 \n"
        ]
    ],
    "hint": "Description of the queries:\n\n1. $ f(2, 2) = (2 - 2 + 1) + f(2, 1) + f(3, 2) = 1 + 0 + 0 = 1 $ ;\n2. $ f(1, 3) = (3 - 1 + 1) + f(1, 2) + f(4, 3) = 3 + (2 - 1 + 1) + f(1, 0) + f(2, 2) = 3 + 2 + (2 - 2 + 1) = 6 $ ;\n3. $ f(1, 4) = (4 - 1 + 1) + f(1, 2) + f(4, 4) = 4 + 3 + 1 = 8 $ ;\n4. $ f(2, 4) = (4 - 2 + 1) + f(2, 2) + f(4, 4) = 3 + 1 + 1 = 5 $ ;\n5. $ f(1, 1) = (1 - 1 + 1) + 0 + 0 = 1 $ .",
    "translation": "## \u9898\u76ee\u63cf\u8ff0\n\n\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a$n$\u7684\u6392\u5217$p_1,p_2,\\dots,p_n$\uff0c\u8fd8\u6709$q$\u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u4e00\u6bb5\u533a\u95f4$[l_i, r_i]$\uff0c\u4f60\u9700\u8981\u8ba1\u7b97\u51fa$f(l_i, r_i)$\u3002\n\n\u5b9a\u4e49$m_{l, r}$\u8868\u793a$p_l, p_{l+1}, \\dots, p_r$\u8fd9\u4e00\u6bb5\u6570\u5217\u7684\u6700\u5927\u503c\u7684\u51fa\u73b0\u4f4d\u7f6e\uff0c\u5219\n\n$$f(l, r) =\\begin{cases}(r-l+1)+f(l,m_{l,r}-1)+f(m_{l,r}+1,r)&\\text{if $l<=r$}\\\\0&\\text{else}\\end{cases}$$\n\n## \u8f93\u5165\u8f93\u51fa\u683c\u5f0f\n\n### \u8f93\u5165\u683c\u5f0f\uff1a\n\n\u7b2c\u4e00\u884c\u4e24\u4e2a\u6574\u6570$n$\u548c$q$\uff0c\u8868\u793a\u6392\u5217\u7684\u957f\u5ea6\u548c\u8be2\u95ee\u7684\u4e2a\u6570\u3002$(1\\le n\\le 10^6,1\\le q\\le 10^6)$\n\n\u7b2c\u4e8c\u884c$n$\u4e2a\u6574\u6570\uff0c\u8868\u793a\u6392\u5217$p$\u3002\n\n\u7b2c\u4e09\u884c$q$\u4e2a\u6574\u6570\uff0c\u4f9d\u6b21\u8868\u793a\u6bcf\u4e00\u6b21\u8be2\u95ee\u7684\u5de6\u7aef\u70b9\u3002\n\n\u7b2c\u56db\u884c$q$\u4e2a\u6574\u6570\uff0c\u4f9d\u6b21\u8868\u793a\u6bcf\u4e00\u6b21\u8be2\u95ee\u7684\u53f3\u7aef\u70b9\u3002\n\n\u6570\u636e\u4fdd\u8bc1$1\\le l_i\\le r_i\\le n$\n\n### \u8f93\u51fa\u683c\u5f0f\uff1a\n\n\u8f93\u51fa\u4e00\u884c$q$\u4e2a\u6574\u6570\uff0c\u8868\u793a\u6bcf\u4e00\u6b21\u8be2\u95ee\u7684\u7b54\u6848\u3002"
}
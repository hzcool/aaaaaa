{
    "description": "Two positive integers are coprime if and only if they don't have a common divisor greater than $ 1 $ .\n\nSome bear doesn't want to tell Radewoosh how to solve some algorithmic problem. So, Radewoosh is going to break into that bear's safe with solutions. To pass through the door, he must enter a permutation of numbers $ 1 $ through $ n $ . The door opens if and only if an entered permutation $ p_{1},p_{2},...,p_{n} $ satisfies:\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF698F/9d4538a9a97e6652f8a13f246927402ea6472421.png)In other words, two different elements are coprime if and only if their indices are coprime.\n\nSome elements of a permutation may be already fixed. In how many ways can Radewoosh fill the remaining gaps so that the door will open? Print the answer modulo $ 10^{9}+7 $ .",
    "inputFormat": "The first line of the input contains one integer $ n $ ( $ 2<=n<=1000000 $ ).\n\nThe second line contains $ n $ integers $ p_{1},p_{2},...,p_{n} $ ( $ 0<=p_{i}<=n $ ) where $ p_{i}=0 $ means a gap to fill, and $ p_{i}>=1 $ means a fixed number.\n\nIt's guaranteed that if $ i\u2260j $ and $ p_{i},p_{j}>=1 $ then $ p_{i}\u2260p_{j} $ .",
    "outputFormat": "Print the number of ways to fill the gaps modulo $ 10^{9}+7 $ (i.e. modulo $ 1000000007 $ ).",
    "samples": [
        [
            "4\n0 0 0 0\n",
            "4\n"
        ],
        [
            "5\n0 0 1 2 0\n",
            "2\n"
        ],
        [
            "6\n0 0 1 2 0 0\n",
            "0\n"
        ],
        [
            "5\n5 3 4 2 1\n",
            "0\n"
        ]
    ],
    "hint": "In the first sample test, none of four element is fixed. There are four permutations satisfying the given conditions: (1,2,3,4), (1,4,3,2), (3,2,1,4), (3,4,1,2).\n\nIn the second sample test, there must be $ p_{3}=1 $ and $ p_{4}=2 $ . The two permutations satisfying the conditions are: (3,4,1,2,5), (5,4,1,2,3).",
    "translation": "\u7ed9\u5b9a\u4e00\u4e2a\u672a\u586b\u6ee1\u7684\u6570\u7ec4 $p$\uff0c\u6c42\u6709\u591a\u5c11\u79cd $1\\sim n$ \u7684\u6392\u5217 $p$ \u6ee1\u8db3\u5bf9\u4e8e\u4efb\u610f $i, j$\uff0c\u90fd\u6709\n\n$$[\\gcd(i, j)=1]=[\\gcd(p_i, p_j)=1]$$\n\n\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n$n \\leq 10^6$\u3002"
}
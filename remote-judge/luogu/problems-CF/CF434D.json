{
    "description": "Nanami likes playing games, and is also really good at it. This day she was playing a new game which involved operating a power plant. Nanami's job is to control the generators in the plant and produce maximum output.\n\nThere are $ n $ generators in the plant. Each generator should be set to a generating level. Generating level is an integer (possibly zero or negative), the generating level of the $ i $ -th generator should be between $ l_{i} $ and $ r_{i} $ (both inclusive). The output of a generator can be calculated using a certain quadratic function $ f(x) $ , where $ x $ is the generating level of the generator. Each generator has its own function, the function of the $ i $ -th generator is denoted as $ f_{i}(x) $ .\n\nHowever, there are $ m $ further restrictions to the generators. Let the generating level of the $ i $ -th generator be $ x_{i} $ . Each restriction is of the form $ x_{u}<=x_{v}+d $ , where $ u $ and $ v $ are IDs of two different generators and $ d $ is an integer.\n\nNanami found the game tedious but giving up is against her creed. So she decided to have a program written to calculate the answer for her (the maximum total output of generators). Somehow, this became your job.",
    "inputFormat": "The first line contains two integers $ n $ and $ m\u00a0(1<=n<=50;\u00a00<=m<=100) $ \u2014 the number of generators and the number of restrictions.\n\nThen follow $ n $ lines, each line contains three integers $ a_{i} $ , $ b_{i} $ , and $ c_{i}\u00a0(|a_{i}|<=10;\u00a0|b_{i}|,|c_{i}|<=1000) $ \u2014 the coefficients of the function $ f_{i}(x) $ . That is, $ f_{i}(x)=a_{i}x^{2}+b_{i}x+c_{i} $ .\n\nThen follow another $ n $ lines, each line contains two integers $ l_{i} $ and $ r_{i}\u00a0(-100<=l_{i}<=r_{i}<=100) $ .\n\nThen follow $ m $ lines, each line contains three integers $ u_{i} $ , $ v_{i} $ , and $ d_{i}\u00a0(1<=u_{i},v_{i}<=n;\u00a0u_{i}\u2260v_{i};\u00a0|d_{i}|<=200) $ , describing a restriction. The $ i $ -th restriction is $ x_{ui}<=x_{vi}+d_{i} $ .",
    "outputFormat": "Print a single line containing a single integer \u2014 the maximum output of all the generators. It is guaranteed that there exists at least one valid configuration.",
    "samples": [
        [
            "3 3\n0 1 0\n0 1 1\n0 1 2\n0 3\n1 2\n-100 100\n1 2 0\n2 3 0\n3 1 0\n",
            "9\n"
        ],
        [
            "5 8\n1 -8 20\n2 -4 0\n-1 10 -10\n0 1 0\n0 -1 1\n1 9\n1 4\n0 10\n3 11\n7 9\n2 1 3\n1 2 3\n2 3 3\n3 2 3\n3 4 3\n4 3 3\n4 5 3\n5 4 3\n",
            "46\n"
        ]
    ],
    "hint": "In the first sample, $ f_{1}(x)=x $ , $ f_{2}(x)=x+1 $ , and $ f_{3}(x)=x+2 $ , so we are to maximize the sum of the generating levels. The restrictions are $ x_{1}<=x_{2} $ , $ x_{2}<=x_{3} $ , and $ x_{3}<=x_{1} $ , which gives us $ x_{1}=x_{2}=x_{3} $ . The optimal configuration is $ x_{1}=x_{2}=x_{3}=2 $ , which produces an output of 9.\n\nIn the second sample, restrictions are equal to $ |x_{i}-x_{i+1}|<=3 $ for $ 1<=i&lt;n $ . One of the optimal configurations is $ x_{1}=1 $ , $ x_{2}=4 $ , $ x_{3}=5 $ , $ x_{4}=8 $ and $ x_{5}=7 $ .",
    "translation": "\u6709$n$\u4e2a\u4e8c\u6b21\u51fd\u6570\uff0c\u7b2c$i$\u4e2a\u5f62\u5982$f(i,x)=a_ix^2+b_ix+c_i$\r\n\r\n\u4f60\u7684\u603b\u6536\u76ca\u662f$\\sum_{i=1}^nf(i,x_i)$\uff0c\u4f46\u662f\u6709\u51e0\u4e2a\u9650\u5236\uff1a\r\n\r\n1. $x_i$\u662f$[l_i,r_i]$\u4e2d\u7684\u4e00\u4e2a\u6574\u6570\r\n2. \u8fd8\u7ed9\u4e86$m$\u6761\u989d\u5916\u7684\u9650\u5236\uff0c\u6bcf\u6761\u5f62\u5982`u v d`\uff0c\u8868\u793a\u7684\u662f$x_u\\leq x_v+d$\r\n\r\n\u6c42\u6700\u5927\u7684\u603b\u6536\u76ca\u3002"
}
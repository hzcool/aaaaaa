{
    "description": "This is a hard version of the problem. It differs from the easy one only by constraints on $ n $ and $ t $ .\n\nThere is a deck of $ n $ cards, each of which is characterized by its power. There are two types of cards:\n\n- a hero card, the power of such a card is always equal to $ 0 $ ;\n- a bonus card, the power of such a card is always positive.\n\nYou can do the following with the deck:\n\n- take a card from the top of the deck;\n- if this card is a bonus card, you can put it on top of your bonus deck or discard;\n- if this card is a hero card, then the power of the top card from your bonus deck is added to his power (if it is not empty), after that the hero is added to your army, and the used bonus discards.\n\nYour task is to use such actions to gather an army with the maximum possible total power.",
    "inputFormat": "The first line of input data contains single integer $ t $ ( $ 1 \\le t \\le 10^4 $ ) \u2014 the number of test cases in the test.\n\nThe first line of each test case contains one integer $ n $ ( $ 1 \\le n \\le 2 \\cdot 10^5 $ ) \u2014 the number of cards in the deck.\n\nThe second line of each test case contains $ n $ integers $ s_1, s_2, \\dots, s_n $ ( $ 0 \\le s_i \\le 10^9 $ ) \u2014 card powers in top-down order.\n\nIt is guaranteed that the sum of $ n $ over all test cases does not exceed $ 2 \\cdot 10^5 $ .",
    "outputFormat": "Output $ t $ numbers, each of which is the answer to the corresponding test case \u2014 the maximum possible total power of the army that can be achieved.",
    "samples": [
        [
            "5\n5\n3 3 3 0 0\n6\n0 3 3 0 0 3\n7\n1 2 3 0 4 5 0\n7\n1 2 5 0 4 3 0\n5\n3 1 0 0 4",
            "6\n6\n8\n9\n4"
        ]
    ],
    "hint": "In the first sample, you can take bonuses $ 1 $ and $ 2 $ . Both hero cards will receive $ 3 $ power. If you take all the bonuses, one of them will remain unused.\n\nIn the second sample, the hero's card on top of the deck cannot be powered up, and the rest can be powered up with $ 2 $ and $ 3 $ bonuses and get $ 6 $ total power.\n\nIn the fourth sample, you can take bonuses $ 1 $ , $ 2 $ , $ 3 $ , $ 5 $ and skip the bonus $ 6 $ , then the hero $ 4 $ will be enhanced with a bonus $ 3 $ by $ 5 $ , and the hero $ 7 $ with a bonus $ 5 $ by $ 4 $ . $ 4+5=9 $ .",
    "translation": "\u6709\u4e00\u526f\u7531 $n$ \u5f20\u5361\u7ec4\u6210\u7684\u724c\uff0c\u6bcf\u4e00\u5f20\u724c\u6709\u4e00\u4e2a\u529b\u91cf\u503c\uff0c\u5361\u724c\u5206\u4e3a\u4e24\u79cd\u7c7b\u578b\uff1a\n+ \u5bf9\u4e8e\u4e00\u5f20\u82f1\u96c4\u5361\uff0c\u5b83\u7684\u529b\u91cf\u503c\u603b\u662f $0$\u3002\n+ \u5bf9\u4e8e\u4e00\u5f20\u9644\u52a0\u5361\uff0c\u5176\u529b\u91cf\u503c\u603b\u4e3a **\u6b63\u6570**\u3002\n\n\u4f60\u53ef\u4ee5\u5bf9\u8fd9\u526f\u724c\u505a\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n+ \u4ece\u724c\u5806\u9876\u7aef\u53d6\u8d70\u4e00\u5f20\u724c\uff1b\n+ \u5982\u679c\u8fd9\u5f20\u724c\u662f\u9644\u52a0\u724c\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u653e\u5230\u4f60\u7684\u9644\u52a0\u724c\u5806\u7684 **\u5806\u9876**\uff0c\u6216\u8005\u76f4\u63a5\u4e22\u5f03\uff1b\n+ \u5982\u679c\u8fd9\u5f20\u724c\u662f\u82f1\u96c4\u724c\uff0c\u90a3\u4e48\u9644\u52a0\u724c\u5806\u9876\u7684\u724c\u7684\u529b\u91cf\u503c\u4f1a\u8d4b\u7ed9\u5f53\u524d\u82f1\u96c4\u5361\uff08\u5982\u679c\u9644\u52a0\u724c\u5806\u975e\u7a7a\uff09\uff0c\u4e4b\u540e\u5176\u4f1a\u52a0\u5165\u4f60\u7684\u519b\u961f\uff0c\u5e76\u4e14\u6d88\u8017\u6240\u7528\u9644\u52a0\u724c\u3002\n\n\u4f60\u7684\u4efb\u52a1\u662f\u7528\u8fd9\u4e9b\u64cd\u4f5c\u96c6\u7ed3\u4e00\u652f **\u6700\u5927\u603b\u529b\u91cf\u503c\u7684** \u519b\u961f\u3002"
}
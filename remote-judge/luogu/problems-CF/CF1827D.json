{
    "description": "You are given a tree (an undirected connected acyclic graph) which initially only contains vertex $ 1 $ . There will be several queries to the given tree. In the $ i $ -th query, vertex $ i + 1 $ will appear and be connected to vertex $ p_i $ ( $ 1 \\le p_i \\le i $ ).\n\nAfter each query, please find out the least number of operations required to make the current tree has two centroids. In one operation, you can add one vertex and one edge to the tree such that it remains a tree.\n\nA vertex is called a centroid if its removal splits the tree into subtrees with at most $ \\lfloor \\frac{n}{2} \\rfloor $ vertices each, with $ n $ as the number of vertices of the tree. For example, the centroid of the following tree is $ 3 $ because the biggest subtree after removing the centroid has $ 2 $ vertices.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1827D/ecc06e1bfbfa2b50ddf426bffbad51ace4e5a023.png)In the next tree, vertex $ 1 $ and $ 2 $ are both centroids.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1827D/42a5367fe4666594cdbcb007a8104c576dad78f0.png)",
    "inputFormat": "Each test contains multiple test cases. The first line contains the number of test cases $ t $ ( $ 1 \\le t \\le 10^4 $ ). The description of the test cases follows.\n\nThe first line of each test case contains a single integer $ n $ ( $ 2 \\le n \\le 5 \\cdot 10^{5} $ ) \u2014 the number of nodes of the final tree.\n\nThe second line of each test case contains $ n - 1 $ integers $ p_1, p_2, \\ldots, p_{n - 1} $ ( $ 1 \\le p_i \\le i $ ) \u2014 the index of the vertex that is connected to vertex $ i + 1 $ .\n\nIt is guaranteed that the sum of $ n $ over all test cases does not exceed $ 5 \\cdot 10^{5} $ .",
    "outputFormat": "For each test case, output $ n - 1 $ integers. The $ i $ -th integer is the answer to the $ i $ -th query \u2014 the least number of operations required to make the current tree have two centroids.\n\nWe can show that an answer always exists.",
    "samples": [
        [
            "5\n2\n1\n3\n1 1\n4\n1 2 3\n7\n1 2 3 2 5 2\n10\n1 2 2 4 5 5 7 8 9",
            "0\n0 1\n0 1 0\n0 1 0 1 2 3\n0 1 2 1 0 1 0 1 2"
        ]
    ],
    "hint": "The illustrations below are of the fourth example test case.\n\nAfter the third query:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1827D/15c7a987e93f4191ff93989ce5a5d836a3f65c54.png)  The tree already has vertices $ 2 $ and $ 3 $ as centroids, so no operations are needed.After the fourth query:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1827D/510bc6f02a1aac0ae1f0e8ae57461166a9b6fabc.png)  Adding vertex $ x $ to the tree makes vertices $ 2 $ and $ 3 $ centroids. Only one operation is needed.After the fifth query:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1827D/29421eb0f8c94af01daaf309b6ffbeb3c5c65c23.png)  Adding vertex $ x $ and $ y $ to the tree makes vertices $ 5 $ and $ 2 $ centroids. Two operations are needed.After the sixth query:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1827D/276326fe18921ee503ac095502b55c698850d8c6.png)  Adding vertex $ x $ , $ y $ , and $ z $ to the tree makes vertices $ 5 $ and $ 2 $ centroids. Three operations are needed.",
    "translation": "\u5730\u7075\u6bbf\u95e8\u53e3\u6709\u4e00\u4e2a\u5c0f\u6302\u4ef6\uff0c\u5c0f\u6302\u4ef6\u53ef\u89c6\u4f5c\u4e00\u68f5\u6811\uff0c\u521d\u59cb\u53ea\u6709 $1$ \u4e2a\u7f16\u53f7\u4e3a $1$ \u7684\u8282\u70b9\u3002\n\n\u63a5\u4e0b\u6765\u604b\u604b\u4f1a\u505a $n-1$ \u6b21\u64cd\u4f5c\uff0c\u7b2c $i$ \u6b21\u64cd\u4f5c\u6dfb\u52a0\u4e00\u4e2a\u7f16\u53f7\u4e3a $i+1$ \u7684\u8282\u70b9\uff0c\u5e76\u5728\u8282\u70b9 $i+1$ \u4e0e $p_i$ \u4e4b\u95f4\u8fde\u8fb9\u3002\n\n\u73b0\u5728\u5979\u60f3\u77e5\u9053\uff0c\u5728\u6bcf\u4e00\u6b21\u64cd\u4f5c\u4e4b\u540e\uff0c\u81f3\u5c11\u9700\u8981\u591a\u505a\u591a\u5c11\u6b21\u64cd\u4f5c\uff0c\u624d\u80fd\u4f7f\u8fd9\u68f5\u6811\u5177\u6709\u4e24\u4e2a\u91cd\u5fc3\u3002\n\n\u7531\u4e8e\u604b\u604b\u5fd9\u7740\u7ed9\u6302\u4ef6\u505a\u88c5\u9970\uff0c\u6240\u4ee5\u4f60\u8981\u5e2e\u5979\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u672c\u9898\u6709 $t$ \u7ec4\u6570\u636e\u3002\n\n### \u6570\u636e\u8303\u56f4\n\n- $1 \\le t \\le 10^4$\n- $1 \\le n \\le 5 \\cdot 10^5$\n- $1 \\le \\sum n \\le 5 \\cdot 10^5$\n- $1 \\le p_i \\le i$\n- \u7ed9\u5b9a\u8f93\u5165\u5747\u4e3a\u6b63\u6574\u6570\n\n### \u63d0\u793a\n\n\u6811\u7684\u91cd\u5fc3\u7684\u5b9a\u4e49\u53ef\u53c2\u8003[OI-wiki](https://oi-wiki.org/graph/tree-centroid/)\u3002"
}
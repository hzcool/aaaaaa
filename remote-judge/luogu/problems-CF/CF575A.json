{
    "description": "Fibonotci sequence is an integer recursive sequence defined by the recurrence relation\n\n $ F_{n}=s_{n-1}\u00b7F_{n-1}+s_{n-2}\u00b7F_{n-2} $  with  $ F_{0}=0,F_{1}=1 $ Sequence $ s $ is an infinite and almost cyclic sequence with a cycle of length $ N $ . A sequence $ s $ is called almost cyclic with a cycle of length $ N $ if ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF575A/489fd2e5fb549725a7a9de5a934f7a838952563f.png), for $ i>=N $ , except for a finite number of values $ s_{i} $ , for which ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF575A/3f92eca313b934333be63d48e6d251e408e4922e.png) ( $ i>=N $ ).\n\nFollowing is an example of an almost cyclic sequence with a cycle of length 4:\n\n s = (5,3,8,11,5,3,7,11,5,3,8,11,\u2026) Notice that the only value of $ s $ for which the equality ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF575A/c723ac9c89791a5b8e370fa82e33937eb7ce6a73.png) does not hold is $ s_{6} $ ( $ s_{6}=7 $ and $ s_{2}=8 $ ). You are given $ s_{0},s_{1},...s_{N-1} $ and all the values of sequence $ s $ for which ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF575A/3f92eca313b934333be63d48e6d251e408e4922e.png) ( $ i>=N $ ).\n\nFind ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF575A/1ed5b2d60749876c1857042c6e156873ebb4e0f0.png).",
    "inputFormat": "The first line contains two numbers $ K $ and $ P $ . The second line contains a single number $ N $ . The third line contains $ N $ numbers separated by spaces, that represent the first $ N $ numbers of the sequence $ s $ . The fourth line contains a single number $ M $ , the number of values of sequence $ s $ for which ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF575A/3f92eca313b934333be63d48e6d251e408e4922e.png). Each of the following $ M $ lines contains two numbers $ j $ and $ v $ , indicating that ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF575A/61d61b0cd4f25e1afcd53e14ccd0e5748081a98b.png) and $ s_{j}=v $ . All j-s are distinct.\n\n- $ 1<=N,M<=50000 $\n- $ 0<=K<=10^{18} $\n- $ 1<=P<=10^{9} $\n- $ 1<=s_{i}<=10^{9} $ , for all $ i=0,1,...N-1 $\n- $ N<=j<=10^{18} $\n- $ 1<=v<=10^{9} $\n- All values are integers",
    "outputFormat": "Output should contain a single integer equal to ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF575A/1ed5b2d60749876c1857042c6e156873ebb4e0f0.png).",
    "samples": [
        [
            "10 8\n3\n1 2 1\n2\n7 3\n5 4\n",
            "4\n"
        ]
    ],
    "hint": "",
    "translation": "$\\{ s_n \\}_{n=0}^\\infty$ \u662f\u4e00\u4e2a\u6b63\u6574\u6570\u5e8f\u5217\u3002\n\n\u7ed9\u5b9a $s_0,s_1, \\dots ,s_{n-1}$\uff0c\u5bf9\u4e8e $i \\ge n$\uff0c\u6709 $m$ \u4e2a $i$ \u7ed9\u5b9a $s_i$\uff0c\u5269\u4e0b\u7684 $i$ \u6ee1\u8db3 $s_i = s_{i \\bmod n}$\u3002\n\n$\\{ f_n \\}_{n=0}^\\infty$ \u540c\u6837\u662f\u4e00\u4e2a\u6b63\u6574\u6570\u5e8f\u5217\u3002\n\n$f_0 = 0,f_1 = 1$\uff0c\u5bf9\u4e8e $i \\ge 2$\uff0c$f_i = s_{i-1}f_{i-1} + s_{i-2}f_{i-2}$\uff0c\u6c42 $f_k \\bmod p$\u3002\n\n$n,m \\le 5 \\times 10^4$\uff0c$k \\le 10^{18}$\uff0c$s_i,p \\le 10^9$\u3002"
}
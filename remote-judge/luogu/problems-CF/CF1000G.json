{
    "description": "You are given a weighted tree (undirected connected graph with no cycles, loops or multiple edges) with $ n $ vertices. The edge $ \\{u_j, v_j\\} $ has weight $ w_j $ . Also each vertex $ i $ has its own value $ a_i $ assigned to it.\n\nLet's call a path starting in vertex $ u $ and ending in vertex $ v $ , where each edge can appear no more than twice (regardless of direction), a 2-path. Vertices can appear in the 2-path multiple times (even start and end vertices).\n\nFor some 2-path $ p $ profit $ \\text{Pr}(p) = \\sum\\limits_{v \\in \\text{distinct vertices in } p}{a_v} - \\sum\\limits_{e \\in \\text{distinct edges in } p}{k_e \\cdot w_e} $ , where $ k_e $ is the number of times edge $ e $ appears in $ p $ . That is, vertices are counted once, but edges are counted the number of times they appear in $ p $ .\n\nYou are about to answer $ m $ queries. Each query is a pair of vertices $ (qu, qv) $ . For each query find 2-path $ p $ from $ qu $ to $ qv $ with maximal profit $ \\text{Pr}(p) $ .",
    "inputFormat": "The first line contains two integers $ n $ and $ q $ ( $ 2 \\le n \\le 3 \\cdot 10^5 $ , $ 1 \\le q \\le 4 \\cdot 10^5 $ ) \u2014 the number of vertices in the tree and the number of queries.\n\nThe second line contains $ n $ space-separated integers $ a_1, a_2, \\dots, a_n $ $ (1 \\le a_i \\le 10^9) $ \u2014 the values of the vertices.\n\nNext $ n - 1 $ lines contain descriptions of edges: each line contains three space separated integers $ u_i $ , $ v_i $ and $ w_i $ ( $ 1 \\le u_i, v_i \\le n $ , $ u_i \\neq v_i $ , $ 1 \\le w_i \\le 10^9 $ ) \u2014 there is edge $ \\{u_i, v_i\\} $ with weight $ w_i $ in the tree.\n\nNext $ q $ lines contain queries (one per line). Each query contains two integers $ qu_i $ and $ qv_i $ $ (1 \\le qu_i, qv_i \\le n) $ \u2014 endpoints of the 2-path you need to find.",
    "outputFormat": "For each query print one integer per line \u2014 maximal profit $ \\text{Pr}(p) $ of the some 2-path $ p $ with the corresponding endpoints.",
    "samples": [
        [
            "7 6\n6 5 5 3 2 1 2\n1 2 2\n2 3 2\n2 4 1\n4 5 1\n6 4 2\n7 3 25\n1 1\n4 4\n5 6\n6 4\n3 4\n3 7\n",
            "9\n9\n9\n8\n12\n-14\n"
        ]
    ],
    "hint": "Explanation of queries:\n\n1. $ (1, 1) $ \u2014 one of the optimal 2-paths is the following: $ 1 \\rightarrow 2 \\rightarrow 4 \\rightarrow 5 \\rightarrow 4 \\rightarrow 2 \\rightarrow 3 \\rightarrow 2 \\rightarrow 1 $ . $ \\text{Pr}(p) = (a_1 + a_2 + a_3 + a_4 + a_5) - (2 \\cdot w(1,2) + 2 \\cdot w(2,3) + 2 \\cdot w(2,4) + 2 \\cdot w(4,5)) = 21 - 2 \\cdot 12 = 9 $ .\n2. $ (4, 4) $ : $ 4 \\rightarrow 2 \\rightarrow 1 \\rightarrow 2 \\rightarrow 3 \\rightarrow 2 \\rightarrow 4 $ . $ \\text{Pr}(p) = (a_1 + a_2 + a_3 + a_4) - 2 \\cdot (w(1,2) + w(2,3) + w(2,4)) = 19 - 2 \\cdot 10 = 9 $ .\n3. $ (5, 6) $ : $ 5 \\rightarrow 4 \\rightarrow 2 \\rightarrow 3 \\rightarrow 2 \\rightarrow 1 \\rightarrow 2 \\rightarrow 4 \\rightarrow 6 $ .\n4. $ (6, 4) $ : $ 6 \\rightarrow 4 \\rightarrow 2 \\rightarrow 1 \\rightarrow 2 \\rightarrow 3 \\rightarrow 2 \\rightarrow 4 $ .\n5. $ (3, 4) $ : $ 3 \\rightarrow 2 \\rightarrow 1 \\rightarrow 2 \\rightarrow 4 $ .\n6. $ (3, 7) $ : $ 3 \\rightarrow 2 \\rightarrow 1 \\rightarrow 2 \\rightarrow 4 \\rightarrow 5 \\rightarrow 4 \\rightarrow 2 \\rightarrow 3 \\rightarrow 7 $ .",
    "translation": "\u7ed9\u4f60\u4e00\u68f5 $n$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u6bcf\u6761\u8fb9\u6709\u6743\u503c $w$ ,\u6bcf\u4e2a\u70b9\u6709\u6743\u503c $a$ \uff0c\u6743\u503c\u8303\u56f4\u90fd\u662f $[1,10^9]$ \u3002\n\n\u5b9a\u4e492-Path\u4e3a\u6bcf\u6761\u8fb9\u6700\u591a\u7ecf\u8fc7\u4e24\u6b21\u7684\u8def\u5f84\uff0c\u8def\u5f84\u6743\u503c\u4e3a $\\sum a_v-\\sum w_e k_e$ , $k_e$ \u8868\u793a\u6bcf\u6761\u8fb9\u7684\u7ecf\u8fc7\u6b21\u6570\u3002\n\n\u6709 $Q$ \u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u4ece $x$ \u5230 $y$ \uff0c\u6700\u5927\u6743\u503c2-Path\u7684\u6743\u503c\u3002\n\n\u611f\u8c22@litble \u63d0\u4f9b\u7ffb\u8bd1"
}
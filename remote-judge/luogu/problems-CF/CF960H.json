{
    "description": "Santa has an infinite number of candies for each of $ m $ flavours. You are given a rooted tree with $ n $ vertices. The root of the tree is the vertex $ 1 $ . Each vertex contains exactly one candy. The $ i $ -th vertex has a candy of flavour $ f_i $ .\n\nSometimes Santa fears that candies of flavour $ k $ have melted. He chooses any vertex $ x $ randomly and sends the subtree of $ x $ to the Bakers for a replacement. In a replacement, all the candies with flavour $ k $ are replaced with a new candy of the same flavour. The candies which are not of flavour $ k $ are left unchanged. After the replacement, the tree is restored.\n\nThe actual cost of replacing one candy of flavour $ k $ is $ c_k $ (given for each $ k $ ). The Baker keeps the price fixed in order to make calculation simple. Every time when a subtree comes for a replacement, the Baker charges $ C $ , no matter which subtree it is and which flavour it is.\n\nSuppose that for a given flavour $ k $ the probability that Santa chooses a vertex for replacement is same for all the vertices. You need to find out the expected value of error in calculating the cost of replacement of flavour $ k $ . The error in calculating the cost is defined as follows.\n\n $ $$$ Error\\ E(k) =\\ (Actual Cost\\ \u2013\\ Price\\ charged\\ by\\ the\\ Bakers) ^ 2. $ $ </p><p>Note that the actual cost is the cost of replacement of one candy of the flavour  $ k $  multiplied by the number of candies in the subtree.</p><p>Also, sometimes Santa may wish to replace a candy at vertex  $ x $  with a candy of some flavour from his pocket.</p><p>You need to handle two types of operations: </p><ul> <li> Change the flavour of the candy at vertex  $ x $  to  $ w $ . </li><li> Calculate the expected value of error in calculating the cost of replacement for a given flavour  $ k$$$.",
    "inputFormat": "The first line of the input contains four integers $ n $ ( $ 2\u2009\\leqslant\u2009n\u2009\\leqslant\u20095 \\cdot 10^4 $ ), $ m $ , $ q $ , $ C $ ( $ 1\u2009\\leqslant\u2009m, q\u2009\\leqslant\u20095 \\cdot 10^4 $ , $ 0 \\leqslant C \\leqslant 10^6 $ ) \u2014 the number of nodes, total number of different flavours of candies, the number of queries and the price charged by the Bakers for replacement, respectively.\n\nThe second line contains $ n $ integers $ f_1, f_2, \\dots, f_n $ ( $ 1 \\leqslant f_i \\leqslant m $ ), where $ f_i $ is the initial flavour of the candy in the $ i $ -th node.\n\nThe third line contains $ n - 1 $ integers $ p_2, p_3, \\dots, p_n $ ( $ 1 \\leqslant p_i \\leqslant n $ ), where $ p_i $ is the parent of the $ i $ -th node.\n\nThe next line contains $ m $ integers $ c_1, c_2, \\dots c_m $ ( $ 1 \\leqslant c_i \\leqslant 10^2 $ ), where $ c_i $ is the cost of replacing one candy of flavour $ i $ .\n\nThe next $ q $ lines describe the queries. Each line starts with an integer $ t $ ( $ 1\u2009\\leqslant\u2009t\u2009\\leqslant\u20092 $ ) \u2014 the type of the query.\n\nIf $ t\u2009=\u20091 $ , then the line describes a query of the first type. Two integers $ x $ and $ w $ follow ( $ 1\u2009\\leqslant \u2009x \\leqslant \u2009n $ , $ 1 \\leqslant \u2009w \\leqslant\u2009m $ ), it means that Santa replaces the candy at vertex $ x $ with flavour $ w $ .\n\nOtherwise, if $ t = 2 $ , the line describes a query of the second type and an integer $ k $ ( $ 1\u2009\\leqslant\u2009k\u2009\\leqslant\u2009m $ ) follows, it means that you should print the expected value of the error in calculating the cost of replacement for a given flavour $ k $ .\n\nThe vertices are indexed from $ 1 $ to $ n $ . Vertex $ 1 $ is the root.",
    "outputFormat": "Output the answer to each query of the second type in a separate line.\n\nYour answer is considered correct if its absolute or relative error does not exceed $ 10^{-6} $ .\n\nFormally, let your answer be $ a $ , and the jury's answer be $ b $ . The checker program considers your answer correct if and only if $ \\frac{|a-b|}{max(1,b)}\\leqslant 10^{-6} $ .",
    "samples": [
        [
            "3 5 5 7\n3 1 4\n1 1\n73 1 48 85 89\n2 1\n2 3\n1 2 3\n2 1\n2 3\n",
            "2920.333333333333\n593.000000000000\n49.000000000000\n3217.000000000000\n"
        ]
    ],
    "hint": "For $ 1 $ -st query, the error in calculating the cost of replacement for flavour $ 1 $ if vertex $ 1 $ , $ 2 $ or $ 3 $ is chosen are $ 66^2 $ , $ 66^2 $ and $ (-7)^2 $ respectively. Since the probability of choosing any vertex is same, therefore the expected value of error is $ \\frac{66^2+66^2+(-7)^2}{3} $ .\n\nSimilarly, for $ 2 $ -nd query the expected value of error is $ \\frac{41^2+(-7)^2+(-7)^2}{3} $ .\n\nAfter $ 3 $ -rd query, the flavour at vertex $ 2 $ changes from $ 1 $ to $ 3 $ .\n\nFor $ 4 $ -th query, the expected value of error is $ \\frac{(-7)^2+(-7)^2+(-7)^2}{3} $ .\n\nSimilarly, for $ 5 $ -th query, the expected value of error is $ \\frac{89^2+41^2+(-7)^2}{3} $ .",
    "translation": "- \u7ed9\u51fa\u4e00\u68f5 $n$ \u4e2a\u8282\u70b9\u7684\u6709\u6839\u6811\uff0c\u6839\u4e3a $1$\u3002\u70b9 $2\\sim n$ \u7684\u7236\u4eb2\u4e3a $p_2\\sim p_n$\u3002\u6709 $m$ \u79cd\u989c\u8272\u3002\u70b9 $i$ \u7684\u989c\u8272\u4e3a $f_i$\uff0c\u989c\u8272 $i$ \u7684\u6743\u503c\u4e3a $c_i$\u3002\u6709\u4e24\u79cd\u64cd\u4f5c\u5171 $q$ \u6b21\uff1a\n\n    - $\\texttt{1 }x\\text{ }y$\uff0c\u5c06 $c_x\\leftarrow y$\u3002\n\n    - $\\texttt{2 }x$\uff0c\u4ece\u6811\u4e2d\u7b49\u6982\u7387\u9009\u53d6\u4e00\u4e2a\u70b9 $i$\uff0c\u5f97\u5230 $(S_i\\times b_x-C)^2$ \u7684\u4ef7\u503c\u3002\u6c42\u671f\u671b\u4ef7\u503c\u3002\u5176\u4e2d $S_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u989c\u8272\u4e3a $x$ \u7684\u8282\u70b9\u6570\u3002$C$ \u662f\u7ed9\u5b9a\u7684\u5e38\u6570\u3002\n\n**\u8f93\u5165\u683c\u5f0f**\n\n- \u7b2c\u4e00\u884c\u56db\u4e2a\u81ea\u7136\u6570 $n,m,q,C$\uff08$2\\le n\\le 5\\times 10^4$\uff0c$1\\le m,q\\le 5\\times 10^4$\uff0c$0\\le C\\le 10^6$\uff09\u3002\n\n- \u7b2c\u4e8c\u884c $n$ \u4e2a\u6b63\u6574\u6570 $f_1\\sim f_n$\uff08$1\\le f_i\\le m$\uff09\u3002\n\n- \u7b2c\u4e09\u884c $n-1$ \u4e2a\u6b63\u6574\u6570\u4e3a $p_2\\sim p_n$\uff08$1\\le p_i\\le n$\uff09\u3002\n\n- \u7b2c\u56db\u884c $m$ \u4e2a\u6b63\u6574\u6570 $b_1\\sim b_m$\uff08$1\\le c_i\\le 100$\uff09\u3002\n\n- \u63a5\u4e0b\u6765 $q$ \u884c\u6bcf\u884c\u4e3a\u4e00\u4e2a\u64cd\u4f5c $\\texttt{1 }x\\text{ }y$ \u6216 $\\texttt{2 }x$\u3002\n\n**\u8f93\u51fa\u683c\u5f0f**\n\n\u5bf9\u4e8e $\\texttt{2}$ \u64cd\u4f5c\uff0c\u8f93\u51fa\u671f\u671b\u3002"
}
{
    "description": "The only difference between the two versions is that in this version $ n \\leq 2 \\cdot 10^5 $ and the sum of $ n $ over all test cases does not exceed $ 2 \\cdot 10^5 $ .\n\nA terminal is a row of $ n $ equal segments numbered $ 1 $ to $ n $ in order. There are two terminals, one above the other.\n\nYou are given an array $ a $ of length $ n $ . For all $ i = 1, 2, \\dots, n $ , there should be a straight wire from some point on segment $ i $ of the top terminal to some point on segment $ a_i $ of the bottom terminal. For example, the following pictures show two possible wirings if $ n=7 $ and $ a=[4,1,4,6,7,7,5] $ .\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1676H2/71a1fe41f3cad0f3cbda88716457eefb4e46b4ca.png)A crossing occurs when two wires share a point in common. In the picture above, crossings are circled in red.\n\nWhat is the maximum number of crossings there can be if you place the wires optimally?",
    "inputFormat": "The first line contains an integer $ t $ ( $ 1 \\leq t \\leq 1000 $ ) \u2014 the number of test cases.\n\nThe first line of each test case contains an integer $ n $ ( $ 1 \\leq n \\leq 2 \\cdot 10^5 $ ) \u2014 the length of the array.\n\nThe second line of each test case contains $ n $ integers $ a_1, a_2, \\dots, a_n $ ( $ 1 \\leq a_i \\leq n $ ) \u2014 the elements of the array.\n\nThe sum of $ n $ across all test cases does not exceed $ 2 \\cdot 10^5 $ .",
    "outputFormat": "For each test case, output a single integer \u2014 the maximum number of crossings there can be if you place the wires optimally.",
    "samples": [
        [
            "4\n7\n4 1 4 6 7 7 5\n2\n2 1\n1\n1\n3\n2 2 2",
            "6\n1\n0\n3"
        ]
    ],
    "hint": "The first test case is shown in the second picture in the statement.\n\nIn the second test case, the only wiring possible has the two wires cross, so the answer is $ 1 $ .\n\nIn the third test case, the only wiring possible has one wire, so the answer is $ 0 $ .",
    "translation": "\u4e24\u4e2a\u7248\u672c\u95f4\u552f\u4e00\u7684\u533a\u522b\u662f\uff0c\u6b64\u7248\u672c\u4e2d $n\u22642\u00b710^5\uff0c\\sum n\u22642\u00b710^5$\u3002\n\n\u4e00\u4e2a\u7ec8\u7aef\u662f\u4e00\u6392 $n$ \u4e2a\u8fde\u63a5\u5728\u4e00\u8d77\u7684\u76f8\u7b49\u7684\u7ebf\u6bb5\uff0c\u6709\u4e24\u4e2a\u7ec8\u7aef\uff0c\u4e00\u4e0a\u4e00\u4e0b\u3002\n\n\u6709\u4e00\u4e2a\u6570\u7ec4 $a_i$\uff0c\u4ee3\u8868\u4ece\u4e0a\u9762\u7684\u7ec8\u7aef\u4e2d\u7b2c $i$ \u6761\u7ebf\u6bb5\uff0c\u5230\u4e0b\u9762\u7684\u7ec8\u7aef\u4e2d\u7b2c $a_i$ \u6761\u7ebf\u6bb5\uff0c\u6709\u4e00\u6761\u8fde\u7ebf\u3002\n\n\u95ee\u8fd9\u4e9b\u8fde\u7ebf\u6700\u591a\u6709\u51e0\u4e2a\u4ea4\u70b9\u3002"
}
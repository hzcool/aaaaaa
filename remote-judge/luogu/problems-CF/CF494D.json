{
    "description": "Ali is Hamed's little brother and tomorrow is his birthday. Hamed wants his brother to earn his gift so he gave him a hard programming problem and told him if he can successfully solve it, he'll get him a brand new laptop. Ali is not yet a very talented programmer like Hamed and although he usually doesn't cheat but this time is an exception. It's about a brand new laptop. So he decided to secretly seek help from you. Please solve this problem for Ali.\n\nAn $ n $ -vertex weighted rooted tree is given. Vertex number $ 1 $ is a root of the tree. We define $ d(u,v) $ as the sum of edges weights on the shortest path between vertices $ u $ and $ v $ . Specifically we define $ d(u,u)=0 $ . Also let's define $ S(v) $ for each vertex $ v $ as a set containing all vertices $ u $ such that $ d(1,u)=d(1,v)+d(v,u) $ . Function $ f(u,v) $ is then defined using the following formula:\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF494D/a49e19fad915afd07784c02308a91dfcb85750c8.png)The goal is to calculate $ f(u,v) $ for each of the $ q $ given pair of vertices. As the answer can be rather large it's enough to print it modulo $ 10^{9}+7 $ .",
    "inputFormat": "Ali is Hamed's little brother and tomorrow is his birthday. Hamed wants his brother to earn his gift so he gave him a hard programming problem and told him if he can successfully solve it, he'll get him a brand new laptop. Ali is not yet a very talented programmer like Hamed and although he usually doesn't cheat but this time is an exception. It's about a brand new laptop. So he decided to secretly seek help from you. Please solve this problem for Ali.\n\nAn $ n $ -vertex weighted rooted tree is given. Vertex number $ 1 $ is a root of the tree. We define $ d(u,v) $ as the sum of edges weights on the shortest path between vertices $ u $ and $ v $ . Specifically we define $ d(u,u)=0 $ . Also let's define $ S(v) $ for each vertex $ v $ as a set containing all vertices $ u $ such that $ d(1,u)=d(1,v)+d(v,u) $ . Function $ f(u,v) $ is then defined using the following formula:\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF494D/a49e19fad915afd07784c02308a91dfcb85750c8.png)The goal is to calculate $ f(u,v) $ for each of the $ q $ given pair of vertices. As the answer can be rather large it's enough to print it modulo $ 10^{9}+7 $ .",
    "outputFormat": "Ali is Hamed's little brother and tomorrow is his birthday. Hamed wants his brother to earn his gift so he gave him a hard programming problem and told him if he can successfully solve it, he'll get him a brand new laptop. Ali is not yet a very talented programmer like Hamed and although he usually doesn't cheat but this time is an exception. It's about a brand new laptop. So he decided to secretly seek help from you. Please solve this problem for Ali.\n\nAn $ n $ -vertex weighted rooted tree is given. Vertex number $ 1 $ is a root of the tree. We define $ d(u,v) $ as the sum of edges weights on the shortest path between vertices $ u $ and $ v $ . Specifically we define $ d(u,u)=0 $ . Also let's define $ S(v) $ for each vertex $ v $ as a set containing all vertices $ u $ such that $ d(1,u)=d(1,v)+d(v,u) $ . Function $ f(u,v) $ is then defined using the following formula:\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF494D/a49e19fad915afd07784c02308a91dfcb85750c8.png)The goal is to calculate $ f(u,v) $ for each of the $ q $ given pair of vertices. As the answer can be rather large it's enough to print it modulo $ 10^{9}+7 $ .",
    "samples": [
        [
            "5\n1 2 1\n4 3 1\n3 5 1\n1 3 1\n5\n1 1\n1 5\n2 4\n2 1\n3 5\n",
            "10\n1000000005\n1000000002\n23\n1000000002\n"
        ],
        [
            "8\n1 2 100\n1 3 20\n2 4 2\n2 5 1\n3 6 1\n3 7 2\n6 8 5\n6\n1 8\n2 3\n5 8\n2 6\n4 7\n6 1\n",
            "999968753\n49796\n999961271\n999991235\n999958569\n45130\n"
        ]
    ],
    "hint": "",
    "translation": "\u7ed9\u5b9a\u4e00\u68f5 n($1 \\leq n\\leq 10^5$) \u4e2a\u9876\u70b9\u7684\u5e26\u8fb9\u6743\u7684\u6811\uff0c\u4ee5\u70b9 1 \u4e3a\u6839\u3002\u5b9a\u4e49 $d(u,v)$ \u4e3a u \u5230 v \u7684\u7b80\u5355\u8def\u5f84\u4e0a\u6240\u6709\u8fb9\u7684\u6743\u503c\u4e4b\u548c\u3002\u7279\u522b\u5730\uff0c\u6211\u4eec\u6709 $d(u,u)=0$\u3002\r\n\r\n\u63a5\u7740\u5bf9\u8282\u70b9 v \u5b9a\u4e49\u96c6\u5408 S(v)\uff0c\u8868\u793a\u6240\u6709\u6ee1\u8db3 $d(1,u)=d(1,v)+d(v,u)$\u7684\u70b9 u \u7684\u96c6\u5408\u3002\r\n\r\n\u51fd\u6570 $f(u,v)$\u7531\u4e0b\u5f0f\u5b9a\u4e49\uff1a\r\n\r\n$f(u,v)=\\sum_{x \\in S(v)} d(u,x)^2-\\sum_{x \\notin S(v)} d(u,x)^2$\r\n\r\n\u4f60\u7684\u4efb\u52a1\u5c31\u662f\u5bf9\u4e8e q \u5bf9 $u,v$ \u8ba1\u7b97\u51fa $f(u,v)$ \u7684\u503c\u3002\u7531\u4e8e\u7b54\u6848\u53ef\u80fd\u8fc7\u5927\uff0c\u8bf7\u6a21 $10^9+7$ \u8f93\u51fa\u3002"
}
{
    "description": "The court wizard Zigzag wants to become a famous mathematician. For that, he needs his own theorem, like the Cauchy theorem, or his sum, like the Minkowski sum. But most of all he wants to have his sequence, like the Fibonacci sequence, and his function, like the Euler's totient function.\n\nThe Zigag's sequence with the zigzag factor z is an infinite sequence $ S_{i}^{z} $ $ (i>=1;\u00a0z>=2) $ , that is determined as follows:\n\n- $ S_{i}^{z}=2 $ , when ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF228D/1fc56311cea86788c18234c599c8f92cc5ebba9d.png);\n- ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF228D/ad97d919418272cb1cdb46ba452989798e6974e7.png), when ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF228D/6179730a0df51ee18bdf9ecd603e5b64dcb3420e.png);\n- ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF228D/f8beda00fdbd6f880a0d5b94505438316b9375d8.png), when ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF228D/d06cbc7d8f16f69377c086d5016a206ef49a583c.png).\n\nOperation ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF228D/cb1d84ad58154eb7ea26b65d1ae0039570db9bb6.png) means taking the remainder from dividing number $ x $ by number $ y $ . For example, the beginning of sequence $ S_{i}^{3} $ (zigzag factor 3) looks as follows: 1, 2, 3, 2, 1, 2, 3, 2, 1.\n\nLet's assume that we are given an array $ a $ , consisting of $ n $ integers. Let's define element number $ i $ $ (1<=i<=n) $ of the array as $ a_{i} $ . The Zigzag function is function ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF228D/dacb3dbde26850605897345a1babcd064176c50b.png), where $ l,r,z $ satisfy the inequalities $ 1<=l<=r<=n $ , $ z>=2 $ .\n\nTo become better acquainted with the Zigzag sequence and the Zigzag function, the wizard offers you to implement the following operations on the given array $ a $ .\n\n1. The assignment operation. The operation parameters are $ (p,v) $ . The operation denotes assigning value $ v $ to the $ p $ -th array element. After the operation is applied, the value of the array element $ a_{p} $ equals $ v $ .\n2. The Zigzag operation. The operation parameters are $ (l,r,z) $ . The operation denotes calculating the Zigzag function $ Z(l,r,z) $ .\n\nExplore the magical powers of zigzags, implement the described operations.",
    "inputFormat": "The first line contains integer $ n $ $ (1<=n<=10^{5}) $ \u2014 The number of elements in array $ a $ . The second line contains $ n $ space-separated integers: $ a_{1},a_{2},...,a_{n} $ $ (1<=a_{i}<=10^{9}) $ \u2014 the elements of the array.\n\nThe third line contains integer $ m $ $ (1<=m<=10^{5}) $ \u2014 the number of operations. Next $ m $ lines contain the operations' descriptions. An operation's description starts with integer $ t_{i} $ $ (1<=t_{i}<=2) $ \u2014 the operation type.\n\n- If $ t_{i}=1 $ (assignment operation), then on the line follow two space-separated integers: $ p_{i},v_{i} $ $ (1<=p_{i}<=n;\u00a01<=v_{i}<=10^{9}) $ \u2014 the parameters of the assigning operation.\n- If $ t_{i}=2 $ (Zigzag operation), then on the line follow three space-separated integers: $ l_{i},r_{i},z_{i} $ $ (1<=l_{i}<=r_{i}<=n;\u00a02<=z_{i}<=6) $ \u2014 the parameters of the Zigzag operation.\n\nYou should execute the operations in the order, in which they are given in the input.",
    "outputFormat": "For each Zigzag operation print the calculated value of the Zigzag function on a single line. Print the values for Zigzag functions in the order, in which they are given in the input.\n\nPlease, do not use the %lld specifier to read or write 64-bit integers in \u0421++. It is preferred to use cin, cout streams or the %I64d specifier.",
    "samples": [
        [
            "5\n2 3 1 5 5\n4\n2 2 3 2\n2 1 5 3\n1 3 5\n2 1 5 3\n",
            "5\n26\n38\n"
        ]
    ],
    "hint": "Explanation of the sample test:\n\n- Result of the first operation is $ Z(2,3,2)=3\u00b71+1\u00b72=5 $ .\n- Result of the second operation is $ Z(1,5,3)=2\u00b71+3\u00b72+1\u00b73+5\u00b72+5\u00b71=26 $ .\n- After the third operation array $ a $ is equal to $ 2,3,5,5,5 $ .\n- Result of the forth operation is $ Z(1,5,3)=2\u00b71+3\u00b72+5\u00b73+5\u00b72+5\u00b71=38 $ .",
    "translation": "### \u9898\u76ee\u63cf\u8ff0\n\n\u4e00\u5929\uff0cWSY\u540c\u5b66\u6784\u9020\u4e86\u4e00\u4e2a\u7279\u6b8a\u7684\u6570\u5217 $S$ \uff0c\u8fd9\u4e2a\u6570\u5217\u9664\u4e86\u89d2\u6807\u4ee5\u5916\u8fd8\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684\u53c2\u6570 $z$\uff0c$S$ \u6709\u4e00\u4e2a\u56fa\u5b9a\u7684\u751f\u6210\u89c4\u5219\u5982\u4e0b\uff1a\n\n$i\\ge 0$\n\n- \u5f53 $i\\mod 2\\times(z-1)\\le z$ \u65f6\uff0c$S_i^z=i\\mod 2\\times(z-1)$\n- \u5f53 $i\\mod 2\\times(z-1)>z$ \u65f6\uff0c$S_i^z=2z-(i\\mod 2*(z-1))$\n- \u7279\u522b\u7684\uff0c\u5f53 $i\\mod 2\\times(z-1)=0$ \u65f6\uff0c$S_i^z=2$\n\n\u8fd8\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u666e\u901a\u6570\u5217 $a$ \u5df2\u7ecf\u7ed9\u51fa\uff0c\u73b0\u5728\u8ba9\u4f60\u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c\uff1a\n\n\u6bcf\u4e2a\u64cd\u4f5c\u7684\u7b2c\u4e00\u4e2a\u6570 $op$ \u8868\u793a\u64cd\u4f5c\u7c7b\u578b\uff0c$op=1$ \u5373\u4e3a\u64cd\u4f5c\u4e00\uff0c $op=2$ \u4e3a\u64cd\u4f5c\u4e8c\n\n- \u64cd\u4f5c\u4e00\u8fd8\u5305\u542b\u4e24\u4e2a\u53c2\u6570 $pos,val$ \u8868\u793a\u5c06 $a_{pos}$ \u7684\u503c\u4fee\u6539\u4e3a $val$\n- \u64cd\u4f5c\u4e8c\u6709\u4e09\u4e2a\u53c2\u6570 $l,r,z$ \u8981\u6c42\u4f60\u8f93\u51fa\u4e0b\u9762\u7b97\u5f0f\u7684\u7ed3\u679c\uff1a\n\n$$\\sum_{i=l}^r \\ \\ a_i\\times S_i^z$$\n\n### \u8f93\u5165\u683c\u5f0f\n\n\u7b2c\u4e00\u884c\u4e00\u4e2a\u6574\u6570 $n$\uff0c\u8868\u793a\u6570\u5217 $a$ \u7684\u957f\u5ea6\n\n\u7b2c\u4e8c\u884c\u6709 $n$ \u4e2a\u6574\u6570\uff0c\u8868\u793a\u6570\u5217 $a$\n\n\u7b2c\u4e09\u884c\u53ea\u6709\u4e00\u4e2a\u6574\u6570 $m$\uff0c\u8868\u793a\u64cd\u4f5c\u6570\n\n\u63a5\u4e0b\u6765 $m$ \u884c\u6bcf\u884c\u63cf\u8ff0\u4e00\u4e2a\u64cd\u4f5c\uff0c\u89c1\u9898\u76ee\u63cf\u8ff0\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u64cd\u4f5c\u4e8c\uff0c\u8f93\u51fa\u7b97\u5f0f\u7684\u7ed3\u679c\n\n### \u6570\u636e\u8303\u56f4\n\n$1\\le n,m\\le 10^5$\n\n\u4fdd\u8bc1\u4efb\u4f55\u65f6\u5019 $a_i\\le 10^9,2\\le z\\le 6$"
}
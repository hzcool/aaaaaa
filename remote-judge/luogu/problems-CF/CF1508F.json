{
    "description": "Touko's favorite sequence of numbers is a permutation $ a_1, a_2, \\dots, a_n $ of $ 1, 2, \\dots, n $ , and she wants some collection of permutations that are similar to her favorite permutation.\n\nShe has a collection of $ q $ intervals of the form $ [l_i, r_i] $ with $ 1 \\le l_i \\le r_i \\le n $ . To create permutations that are similar to her favorite permutation, she coined the following definition:\n\n- A permutation $ b_1, b_2, \\dots, b_n $ allows an interval $ [l', r'] $ to holds its shape if for any pair of integers $ (x, y) $ such that $ l' \\le x < y \\le r' $ , we have $ b_x < b_y $ if and only if $ a_x < a_y $ .\n- A permutation $ b_1, b_2, \\dots, b_n $ is  $ k $ -similar if $ b $ allows all intervals $ [l_i, r_i] $ for all $ 1 \\le i \\le k $ to hold their shapes.\n\nYuu wants to figure out all $ k $ -similar permutations for Touko, but it turns out this is a very hard task; instead, Yuu will encode the set of all $ k $ -similar permutations with directed acylic graphs (DAG). Yuu also coined the following definitions for herself:\n\n- A permutation $ b_1, b_2, \\dots, b_n $ satisfies a DAG $ G' $ if for all edge $ u \\to v $ in $ G' $ , we must have $ b_u < b_v $ .\n- A  $ k $ -encoding is a DAG $ G_k $ on the set of vertices $ 1, 2, \\dots, n $ such that a permutation $ b_1, b_2, \\dots, b_n $ satisfies $ G_k $ if and only if $ b $ is $ k $ -similar.\n\nSince Yuu is free today, she wants to figure out the minimum number of edges among all $ k $ -encodings for each $ k $ from $ 1 $ to $ q $ .",
    "inputFormat": "The first line contains two integers $ n $ and $ q $ ( $ 1 \\le n \\le 25\\,000 $ , $ 1 \\le q \\le 100\\,000 $ ).\n\nThe second line contains $ n $ integers $ a_1, a_2, \\dots, a_n $ which form a permutation of $ 1, 2, \\dots, n $ .\n\nThe $ i $ -th of the following $ q $ lines contains two integers $ l_i $ and $ r_i $ . ( $ 1 \\le l_i \\le r_i \\le n $ ).",
    "outputFormat": "Print $ q $ lines. The $ k $ -th of them should contain a single integer \u2014 The minimum number of edges among all $ k $ -encodings.",
    "samples": [
        [
            "4 3\n2 4 1 3\n1 3\n2 4\n1 4",
            "2\n4\n3"
        ],
        [
            "8 4\n3 7 4 8 1 5 2 6\n3 6\n1 6\n3 8\n1 8",
            "3\n5\n9\n7"
        ],
        [
            "10 10\n10 5 1 2 7 3 9 4 6 8\n2 2\n4 5\n6 8\n4 10\n4 4\n2 7\n2 2\n7 8\n3 7\n2 10",
            "0\n1\n3\n6\n6\n9\n9\n9\n9\n8"
        ]
    ],
    "hint": "For the first test case:\n\n- All $ 1 $ -similar permutations must allow the interval $ [1, 3] $ to hold its shape. Therefore, the set of all $ 1 $ -similar permutations is $ \\{[3, 4, 2, 1], [3, 4, 1, 2], [2, 4, 1, 3], [2, 3, 1, 4]\\} $ . The optimal encoding of these permutations is ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1508F/85de89b00f0437164d2c51ab0a45d57494c6671b.png)\n- All $ 2 $ -similar permutations must allow the intervals $ [1, 3] $ and $ [2, 4] $ to hold their shapes. Therefore, the set of all $ 2 $ -similar permutations is $ \\{[3, 4, 1, 2], [2, 4, 1, 3]\\} $ . The optimal encoding of these permutations is ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1508F/9812f99e6109928593fe56033ff4c0fee9e53ec0.png)\n- All $ 3 $ -similar permutations must allow the intervals $ [1, 3] $ , $ [2, 4] $ , and $ [1, 4] $ to hold their shapes. Therefore, the set of all $ 3 $ -similar permutations only includes $ [2, 4, 1, 3] $ . The optimal encoding of this permutation is ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1508F/3afffad12ee48608f1c3c75965871674387d3ef4.png)",
    "translation": "\u7ed9\u5b9a $1 \\sim n$ \u7684\u6392\u5217 $a_1, a_2, \\cdots, a_n$ \u548c $q$ \u4e2a\u533a\u95f4 $[l_1, r_1], [l_2, r_2], \\cdots, [l_q, r_q]$\u3002\u5b9a\u4e49\uff1a\n\n- \u6392\u5217 $b_1, b_2, \\cdots, b_n$ \u5bf9\u533a\u95f4 $[l', r']$ **\u4fdd\u5e8f**\u5f53\u4e14\u4ec5\u5f53 $\\forall l' \\leq x < y \\leq r'$ \u6ee1\u8db3 $[a_x < a_y] = [b_x < b_y]$\u3002\n- \u6392\u5217 $b_1, b_2, \\cdots, b_n$ \u662f **$k \\text{-}$\u76f8\u4f3c\u7684**\u5f53\u4e14\u4ec5\u5f53 $\\{ b_n \\}$ \u5bf9\u6240\u6709 $[l_i, r_i]$ $(1 \\leq i \\leq k)$ \u4fdd\u5e8f\u3002\n- \u4e00\u4e2a DAG \u662f\u5bf9 $k \\text{-}$\u76f8\u4f3c\u6392\u5217\u7684**\u7f16\u7801**\uff0c\u5f53\u4e14\u4ec5\u5f53\u5176\u6240\u6709\u62d3\u6251\u5e8f\u4e0e\u6240\u6709 $k \\text{-}$\u76f8\u4f3c\u6392\u5217\u4e00\u4e00\u5bf9\u5e94\u3002\n\n\u5bf9\u4e8e $k = 1, 2, \\cdots, q$\uff0c\u6c42\u5bf9 $k \\text{-}$\u76f8\u4f3c\u6392\u5217\u7684\u7f16\u7801\u7684\u6700\u5c11\u8fb9\u6570\u3002\u4fdd\u8bc1 $n \\leq 2.5 \\times 10^4, q \\leq 10^5$\u3002"
}
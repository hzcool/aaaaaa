{
    "description": "A Thue-Morse-Radecki-Mateusz sequence (Thorse-Radewoosh sequence in short) is an infinite sequence constructed from a finite sequence $ \\mathrm{gen} $ of length $ d $ and an integer $ m $ , obtained in the following sequence of steps:\n\n- In the beginning, we define the one-element sequence $ M_0=(0) $ .\n- In the $ k $ -th step, $ k \\geq 1 $ , we define the sequence $ M_k $ to be the concatenation of the $ d $ copies of $ M_{k-1} $ . However, each of them is altered slightly \u2014 in the $ i $ -th of them ( $ 1 \\leq i \\leq d $ ), each element $ x $ is changed to $ (x+\\mathrm{gen}_i) \\pmod{m} $ .\n\nFor instance, if we pick $ \\mathrm{gen} = (0, \\color{blue}{1}, \\color{green}{2}) $ and $ m = 4 $ :\n\n- $ M_0 = (0) $ ,\n- $ M_1 = (0, \\color{blue}{1}, \\color{green}{2}) $ ,\n- $ M_2 = (0, 1, 2, \\color{blue}{1, 2, 3}, \\color{green}{2, 3, 0}) $ ,\n- $ M_3 = (0, 1, 2, 1, 2, 3, 2, 3, 0, \\color{blue}{1, 2, 3, 2, 3, 0, 3, 0, 1}, \\color{green}{2, 3, 0, 3, 0, 1, 0, 1, 2}) $ , and so on.\n\nAs you can see, as long as the first element of $ \\mathrm{gen} $ is $ 0 $ , each consecutive step produces a sequence whose prefix is the sequence generated in the previous step. Therefore, we can define the infinite Thorse-Radewoosh sequence $ M_\\infty $ as the sequence obtained by applying the step above indefinitely. For the parameters above, $ M_\\infty = (0, 1, 2, 1, 2, 3, 2, 3, 0, 1, 2, 3, 2, 3, 0, 3, 0, 1, \\dots) $ .\n\nMateusz picked a sequence $ \\mathrm{gen} $ and an integer $ m $ , and used them to obtain a Thorse-Radewoosh sequence $ M_\\infty $ . He then picked two integers $ l $ , $ r $ , and wrote down a subsequence of this sequence $ A := ((M_\\infty)_l, (M_\\infty)_{l+1}, \\dots, (M_\\infty)_r) $ .\n\nNote that we use the $ 1 $ -based indexing both for $ M_\\infty $ and $ A $ .\n\nMateusz has his favorite sequence $ B $ with length $ n $ , and would like to see how large it is compared to $ A $ . Let's say that $ B $ majorizes sequence $ X $ of length $ n $ (let's denote it as $ B \\geq X $ ) if and only if for all $ i \\in \\{1, 2, \\dots, n\\} $ , we have $ B_i \\geq X_i $ .\n\nHe now asks himself how many integers $ x $ in the range $ [1, |A| - n + 1] $ there are such that $ B \\geq (A_x, A_{x+1}, A_{x+2}, \\dots, A_{x+n-1}) $ . As both sequences were huge, answering the question using only his pen and paper turned out to be too time-consuming. Can you help him automate his research?",
    "inputFormat": "The first line contains two integers $ d $ and $ m $ ( $ 2 \\leq d \\leq 20 $ , $ 2 \\leq m \\leq 60 $ ) \u2014 the length of the sequence $ \\mathrm{gen} $ and an integer used to perform the modular operations. The second line contains $ d $ integers $ \\mathrm{gen}_i $ ( $ 0 \\leq \\mathrm{gen}_i < m $ ). It's guaranteed that the first element of the sequence $ \\mathrm{gen} $ is equal to zero.\n\nThe third line contains one integer $ n $ ( $ 1 \\leq n \\leq 30000 $ ) \u2014 the length of the sequence $ B $ . The fourth line contains $ n $ integers $ B_i $ ( $ 0 \\leq B_i < m $ ). The fifth line contains two integers $ l $ and $ r $ ( $ 1 \\leq l \\leq r \\leq 10^{18} $ , $ r-l+1 \\geq n $ ).",
    "outputFormat": "Print a single integer \u2014 the answer to the problem.",
    "samples": [
        [
            "2 2\n0 1\n4\n0 1 1 0\n2 21\n",
            "6\n"
        ],
        [
            "3 4\n0 1 2\n2\n0 2\n6 11\n",
            "1\n"
        ]
    ],
    "hint": "Thorse-Radewoosh sequence in the first example is the standard Thue-Morse sequence, so the sequence $ A $ is as follows: $ 11010011001011010010 $ . Here are the places where the sequence $ B $ majorizes $ A $ :\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1097H/258d8a81f8e52ebbcf740c8332ed520b2aa7ae0c.png)",
    "translation": "### \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u51fa\u6574\u6570 $m,d$ \u548c\u4e00\u4e2a\u5e8f\u5217 $\\textrm{gen}$\uff0c\u4fdd\u8bc1 $\\textrm{gen}_1 = 0$\u3002\n\n\u5bf9\u4e24\u4e2a\u6574\u6570\u5e8f\u5217 $S$ \u548c $T$ \u5b9a\u4e49 $S+T$ \u8868\u793a\u5c06\u5e8f\u5217 $T$ \u62fc\u63a5\u5728\u5e8f\u5217 $S$ \u540e\u5f97\u5230\u7684\u5e8f\u5217\uff1b\n\n\u5bf9\u4e8e\u4e00\u4e2a\u6574\u6570\u5e8f\u5217 $S$ \u548c\u4e00\u4e2a\u6574\u6570 $x$ \u5b9a\u4e49 $S+x$ \u8868\u793a\u5bf9\u5e8f\u5217 $S$ \u4e2d\u7684\u6240\u6709\u6570 $p$ \u8fdb\u884c\u64cd\u4f5c $p \\leftarrow (p+x) \\bmod m$ \u5f97\u5230\u7684\u5e8f\u5217\uff1b\n\n\u5b9a\u4e49\u5e8f\u5217 $M_i$\uff1a\n\n- \u5982\u679c $i=0$\uff0c\u5219 $M_i = \\{0\\}$\n- \u5426\u5219 $M_i = (M_{i-1}+\\textrm{gen}_1)+(M_{i-1} + \\textrm{gen}_2) + \\ldots + (M_{i-1} + \\textrm{gen}_d)$\u3002\n\n\u56e0\u4e3a $\\textrm{gen}_1=0$\uff0c\u6240\u4ee5\u5bf9\u4e8e $i>0$\uff0c$M_{i-1}$ \u662f $M_i$ \u7684\u524d\u7f00\uff0c\u6545 $M_\\infty$ \u662f\u826f\u5b9a\u4e49\u7684\u3002\n\n\u63a5\u4e0b\u6765\u7ed9\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $B$ \u548c\u4e24\u4e2a\u6574\u6570 $l,r$\uff0c\u5b9a\u4e49\u5e8f\u5217 $A$ \u8868\u793a $M_\\infty$ \u4e2d\u7b2c $l$ \u5230\u7b2c $r$ \u4e2a\u5143\u7d20\u4f9d\u6b21\u5f62\u6210\u7684\u5e8f\u5217\uff0c\u6ce8\u610f\u5e8f\u5217\u4e0b\u6807\u4ece $1$ \u5f00\u59cb\u3002\n\n\u5b9a\u4e49\u5e8f\u5217 $P$ \u4e25\u683c\u5927\u4e8e\u5e8f\u5217 $Q$ \u5f53\u4e14\u4ec5\u5f53 $|P| = |Q|$ \u4e14 $\\forall i \\in[1,|Q|],P_i \\geq Q_i$\u3002\n\n\u5bf9\u4e8e\u5e8f\u5217 $A$ \u7684 $|A|-n+1$ \u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u8fde\u7eed\u5b50\u4e32\uff0c\u4f60\u9700\u8981\u7ed9\u51fa\u5176\u4e2d $B$ \u4e25\u683c\u5927\u4e8e\u7684\u5b50\u4e32\u6709\u591a\u5c11\u4e2a\u3002\n\n### \u8f93\u5165\u683c\u5f0f\n\n\u7b2c\u4e00\u884c\u4e24\u4e2a\u6574\u6570 $d,m(2 \\leq d \\leq 20,2 \\leq m \\leq 60)$\uff0c\u7b2c\u4e8c\u884c $d$ \u4e2a\u6574\u6570\u63cf\u8ff0\u5e8f\u5217 $\\textrm{gen}$\uff0c$0 < \\textrm{gen}_i \\leq 60,\\textrm{gen}_1 = 0$\u3002\n\n\u63a5\u4e0b\u6765\u4e00\u884c\u4e00\u4e2a\u6574\u6570 $n(1 \\leq n \\leq 3 \\times 10^4)$\uff0c\u63a5\u4e0b\u6765 $n$ \u4e2a\u6574\u6570\u63cf\u8ff0\u5e8f\u5217 $B,0 \\leq B_i < m$\u3002\n\n\u6700\u540e\u4e00\u884c\u4e24\u4e2a\u6574\u6570 $l,r(1 \\leq l \\leq r \\leq 10^{18},r-l+1 \\geq n)$ \u63cf\u8ff0\u5e8f\u5217 $A$\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\n\n\u4e00\u884c\u4e00\u4e2a\u6574\u6570\u8868\u793a\u7b54\u6848\u3002\n\n"
}
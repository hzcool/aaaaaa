{
    "description": "Due to the success of TWICE, JYP Entertainment has earned countless money and emerged as the biggest entertainment firm by market capitalization. Therefore, the boss, JYP, has decided to create a new nation and has appointed you to provide a design diagram.\n\nThe new nation consists of $ n $ cities and some roads between them. JYP has given some restrictions:\n\n- To guarantee efficiency while avoiding chaos, for any $ 2 $ different cities $ A $ and $ B $ , there is exactly one road between them, and it is one-directional. There are no roads connecting a city to itself.\n- The logo of rivaling companies should not appear in the plan, that is, there does not exist $ 4 $ distinct cities $ A $ , $ B $ , $ C $ , $ D $ , such that the following configuration occurs.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1338E/145532c7db8128858a07ee6d5c9ef02bb615f7ae.png)JYP has given criteria for your diagram. For two cities $ A $ , $ B $ , let $ dis(A,B) $ be the smallest number of roads you have to go through to get from $ A $ to $ B $ . If it is not possible to walk from $ A $ to $ B $ , $ dis(A,B) = 614n $ . Then, the efficiency value is defined to be the sum of $ dis(A,B) $ for all ordered pairs of distinct cities $ (A,B) $ .\n\nNote that $ dis(A,B) $ doesn't have to be equal to $ dis(B,A) $ .\n\nYou have drawn a design diagram that satisfies JYP's restrictions. Find the sum of $ dis(A,B) $ over all ordered pairs of cities $ (A,B) $ with $ A\\neq B $ .\n\nNote that the input is given in compressed form. But even though it is compressed, you'd better use fast input.",
    "inputFormat": "The first line contains a single integer $ n $ ( $ 4 \\le n \\le 8000 $ , $ n \\equiv 0 \\pmod{4} $ ) \u2014 the number of cities.\n\nA binary matrix is encrypted in the following format. Each of $ n $ next lines contains $ \\frac{n}{4} $ one-digit hexadecimal numbers (that is, these numbers can be represented either as digits from $ 0 $ to $ 9 $ or as uppercase Latin letters from $ A $ to $ F $ ). Binary representation of each of these numbers denotes next $ 4 $ elements of the matrix in the corresponding row. For example, if the number $ B $ is given, then the corresponding elements are $ 1011 $ , and if the number is $ 5 $ , then the corresponding elements are $ 0101 $ .\n\nAfter you obtain the decrypted binary matrix, the $ j $ -th character of the $ i $ -th row is $ 1 $ if the one-directional road between cities $ i $ and $ j $ is directed from $ i $ to $ j $ , and $ 0 $ otherwise. It is guaranteed that the graph satisfies the restrictions mentioned above.",
    "outputFormat": "Output one integer, representing the sum of $ dis(A,B) $ over all ordered pairs of cities $ (A,B) $ with $ A\\neq B $ .",
    "samples": [
        [
            "4\n7\n2\n1\n4",
            "7380"
        ],
        [
            "8\n7F\n3F\n1F\n0C\n06\n03\n11\n18",
            "88464"
        ]
    ],
    "hint": "The first example corresponds to the matrix:\n\n $ \\begin{matrix} 0111 \\\\ 0010 \\\\ 0001 \\\\ 0100 \\\\ \\end{matrix} $\n\nWhich corresponds to this graph:\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1338E/d8d9158bf45a880badd32ec542c01a7077e768bd.png)\n\n $ dis(1,2)=dis(1,3)=dis(1,4)=dis(2,3)=dis(3,4)=dis(4,2)=1 $\n\n $ dis(2,4)=dis(4,3)=dis(3,2)=2 $\n\n $ dis(2,1)=dis(3,1)=dis(4,1)=2456 $\n\nTherefore the answer for the diagram is $ 7380 $ .",
    "translation": "\u7ed9\u5b9a\u4e00\u5f20 $n$ \u4e2a\u70b9\u7684**\u7ade\u8d5b\u56fe**\uff0c\u7279\u522b\u5730\uff0c\u6ee1\u8db3\u56fe\u4e2d\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u56db\u4e2a\u70b9 $a, b, c, d$\uff1a\n\n- \u5176\u4e2d $a, b, c$ \u4e09\u4e2a\u70b9\u5f62\u6210\u4e09\u5143\u73af\uff0c\u5373 $a \\to b \\to c \\to a$\uff0c\u4e14\u5b83\u4eec\u90fd\u5411 $d$ \u8fde\u8fb9\uff0c\u5373 $(a, b, c) \\to d$\u3002\n\n\u4f60\u9700\u8981\u8ba1\u7b97\u6bcf\u5bf9\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u4e4b\u548c\uff0c\u5373 $\\displaystyle \\sum_{\\substack{1 \\le i, j \\le n \\\\ i \\ne j}} \\mathrm{dis}(i, j)$\u3002\n\n\u5176\u4e2d $\\mathrm{dis}(x, y)$ \u5b9a\u4e49\u4e3a $x$ \u5230 $y$ \u9700\u8981\u7ecf\u8fc7\u7684\u6700\u5c11\u8fb9\u6570\uff0c\u5982\u679c $x$ \u65e0\u6cd5\u5230\u8fbe $y$ \u5219\u89c4\u5b9a $\\mathrm{dis}(x, y) = 614 \\times n$\u3002\n\n- $3 \\le n \\le 8000$\u3002\n\n- **\u6ce8\u610f\uff1a\u4e3a\u4e86\u51cf\u5c0f\u8f93\u5165\u6587\u4ef6\u5927\u5c0f\uff0c\u8f93\u5165\u7684\u90bb\u63a5\u77e9\u9635\u88ab\u538b\u7f29\uff0c\u8bf7\u9605\u8bfb\u82f1\u6587\u67e5\u770b\u89e3\u538b\u7f29\u65b9\u6cd5\u3002**\n\n- \u8bd1\u8005\uff1a\u5c0f\u7c89\u5154"
}
{
    "description": "You are given $ n - 1 $ integers $ a_2, \\dots, a_n $ and a tree with $ n $ vertices rooted at vertex $ 1 $ . The leaves are all at the same distance $ d $ from the root.\n\nRecall that a tree is a connected undirected graph without cycles. The distance between two vertices is the number of edges on the simple path between them. All non-root vertices with degree $ 1 $ are leaves. If vertices $ s $ and $ f $ are connected by an edge and the distance of $ f $ from the root is greater than the distance of $ s $ from the root, then $ f $ is called a child of $ s $ .\n\nInitially, there are a red coin and a blue coin on the vertex $ 1 $ . Let $ r $ be the vertex where the red coin is and let $ b $ be the vertex where the blue coin is. You should make $ d $ moves. A move consists of three steps:\n\n- Move the red coin to any child of $ r $ .\n- Move the blue coin to any vertex $ b' $ such that $ dist(1, b') = dist(1, b) + 1 $ . Here $ dist(x, y) $ indicates the length of the simple path between $ x $ and $ y $ . Note that $ b $ and $ b' $ are not necessarily connected by an edge.\n- You can optionally swap the two coins (or skip this step).\n\nNote that $ r $ and $ b $ can be equal at any time, and there is no number written on the root.\n\nAfter each move, you gain $ |a_r - a_b| $ points. What's the maximum number of points you can gain after $ d $ moves?",
    "inputFormat": "The first line contains a single integer $ t $ ( $ 1 \\le t \\le 10^4 $ ) \u2014 the number of test cases.\n\nThe first line of each test case contains a single integer $ n $ ( $ 2 \\leq n \\leq 2 \\cdot 10^5 $ ) \u2014 the number of vertices in the tree.\n\nThe second line of each test case contains $ n-1 $ integers $ v_2, v_3, \\dots, v_n $ ( $ 1 \\leq v_i \\leq n $ , $ v_i \\neq i $ ) \u2014 the $ i $ -th of them indicates that there is an edge between vertices $ i $ and $ v_i $ . It is guaranteed, that these edges form a tree.\n\nThe third line of each test case contains $ n-1 $ integers $ a_2, \\dots, a_n $ ( $ 1 \\leq a_i \\leq 10^9 $ ) \u2014 the numbers written on the vertices.\n\nIt is guaranteed that the sum of $ n $ for all test cases does not exceed $ 2 \\cdot 10^5 $ .",
    "outputFormat": "For each test case, print a single integer: the maximum number of points you can gain after $ d $ moves.",
    "samples": [
        [
            "4\n14\n1 1 1 2 3 4 4 5 5 6 7 8 8\n2 3 7 7 6 9 5 9 7 3 6 6 5\n6\n1 2 2 3 4\n32 78 69 5 41\n15\n1 15 1 10 4 9 11 2 4 1 8 6 10 11\n62 13 12 43 39 65 42 86 25 38 19 19 43 62\n15\n11 2 7 6 9 8 10 1 1 1 5 3 15 2\n50 19 30 35 9 45 13 24 8 44 16 26 10 40",
            "14\n45\n163\n123"
        ]
    ],
    "hint": "In the first test case, an optimal solution is to:\n\n- move $ 1 $ : $ r = 4 $ , $ b = 2 $ ; no swap;\n- move $ 2 $ : $ r = 7 $ , $ b = 6 $ ; swap (after it $ r = 6 $ , $ b = 7 $ );\n- move $ 3 $ : $ r = 11 $ , $ b = 9 $ ; no swap.\n\nThe total number of points is $ |7 - 2| + |6 - 9| + |3 - 9| = 14 $ .\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1485E/4458e6880f21f3108c1f541006f191c7d2396ea3.png)In the second test case, an optimal solution is to:\n\n- move $ 1 $ : $ r = 2 $ , $ b = 2 $ ; no swap;\n- move $ 2 $ : $ r = 3 $ , $ b = 4 $ ; no swap;\n- move $ 3 $ : $ r = 5 $ , $ b = 6 $ ; no swap.\n\nThe total number of points is $ |32 - 32| + |78 - 69| + |5 - 41| = 45 $ .",
    "translation": "\u6709\u4e00\u68f5\u6811\uff0c\u4ee5$1$\u4e3a\u6839\uff0c\u53f6\u5b50\u7ed3\u70b9\u6df1\u5ea6\u76f8\u540c,\u7ed3\u70b9 $i$ \u6709\u6743\u503c $a_i$\u3002\u73b0\u5728\u6709\u7ea2\u84dd\u4e24\u9897\u68cb\u5b50\uff0c\u6bcf\u4e00\u6b65\u53ef\u4ee5\u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c\uff1a\n- \u628a\u7ea2\u8272\u68cb\u5b50\u79fb\u52a8\u5230\u5b83\u7684\u5b50\u8282\u70b9\n- \u628a\u84dd\u8272\u68cb\u5b50\u79fb\u52a8\u5230\u5b83\u4e0b\u4e00\u5c42\u7684\u4efb\u4f55\u4e00\u4e2a\u7ed3\u70b9\n- \u9009\u62e9\u4ea4\u6362\u6216\u4e0d\u4ea4\u6362\u7ea2\u5b50\u4e0e\u84dd\u5b50\u7684\u4f4d\u7f6e\n- \u8ba1\u7b97\u5f97\u5206\u4e3a $|a_{red}-a_{blue}|$\n\n\u95ee\u6700\u5927\u7684\u5f97\u5206\u548c\n\n\u7ffb\u8bd1 by jun\u5934\u5409\u5409"
}
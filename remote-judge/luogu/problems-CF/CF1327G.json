{
    "description": "You are given a string $ S $ and an array of strings $ [t_1, t_2, \\dots, t_k] $ . Each string $ t_i $ consists of lowercase Latin letters from a to n; $ S $ consists of lowercase Latin letters from a to n and no more than $ 14 $  question marks.\n\nEach string $ t_i $ has its cost $ c_i $ \u2014 an integer number. The value of some string $ T $ is calculated as $ \\sum\\limits_{i = 1}^{k} F(T, t_i) \\cdot c_i $ , where $ F(T, t_i) $ is the number of occurences of string $ t_i $ in $ T $ as a substring. For example, $ F(\\text{aaabaaa}, \\text{aa}) = 4 $ .\n\nYou have to replace all question marks in $ S $ with pairwise distinct lowercase Latin letters from a to n so the value of $ S $ is maximum possible.",
    "inputFormat": "The first line contains one integer $ k $ ( $ 1 \\le k \\le 1000 $ ) \u2014 the number of strings in the array $ [t_1, t_2, \\dots, t_k] $ .\n\nThen $ k $ lines follow, each containing one string $ t_i $ (consisting of lowercase Latin letters from a to n) and one integer $ c_i $ ( $ 1 \\le |t_i| \\le 1000 $ , $ -10^6 \\le c_i \\le 10^6 $ ). The sum of lengths of all strings $ t_i $ does not exceed $ 1000 $ .\n\nThe last line contains one string $ S $ ( $ 1 \\le |S| \\le 4 \\cdot 10^5 $ ) consisting of lowercase Latin letters from a to n and question marks. The number of question marks in $ S $ is not greater than $ 14 $ .",
    "outputFormat": "Print one integer \u2014 the maximum value of $ S $ after replacing all question marks with pairwise distinct lowercase Latin letters from a to n.",
    "samples": [
        [
            "4\nabc -10\na 1\nb 1\nc 3\n?b?",
            "5"
        ],
        [
            "2\na 1\na 1\n?",
            "2"
        ],
        [
            "3\na 1\nb 3\nab 4\nab",
            "8"
        ],
        [
            "1\na -1\n?????????????",
            "0"
        ],
        [
            "1\na -1\n??????????????",
            "-1"
        ]
    ],
    "hint": "",
    "translation": "## \u9898\u76ee\u63cf\u8ff0\n\n\u4f60\u6709\u4e00\u4e2a\u5b57\u7b26\u4e32 $S$ \u548c\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4 $[t_1, t_2, \\ldots, t_k]$\u3002\u6bcf\u4e2a\u5b57\u7b26\u4e32 $t_i$ \u4ec5\u5305\u542b `a` \u5230 `n` \u4ee5\u5185\u7684\u5c0f\u5199\u5b57\u6bcd\uff1b$S$ \u4e2d\u4ec5\u5305\u542b `a` \u5230 `n` \u4ee5\u5185\u7684\u5c0f\u5199\u5b57\u6bcd\u548c\u4e0d\u8d85\u8fc7 $14$ \u4e2a\u95ee\u53f7\u3002\n\n\u6bcf\u4e00\u4e2a\u5b57\u7b26\u4e32 $t_i$ \u6709\u4e00\u4e2a\u6574\u6570\u82b1\u8d39 $c_i$\u3002\u4e00\u4e2a\u5b57\u7b26\u4e32 $T$ \u7684\u4ef7\u503c\u8ba1\u7b97\u516c\u5f0f\u4e3a $\\displaystyle \\sum_{i = 1} ^ k F(T, t_i) \\cdot c_i$\uff0c\u5176\u4e2d $F(T, t_i)$ \u8868\u793a\u5b57\u7b26\u4e32 $t_i$ \u5728 $T$ \u4e2d\u7684\u51fa\u73b0\u6b21\u6570\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c$F(\\texttt{aaabaaa}, \\texttt{aa}) = 4$\u3002\n\n\u4f60\u9700\u8981\u7528 `a` \u5230 `n` \u4ee5\u5185\u7684\u5c0f\u5199\u5b57\u6bcd\u6765\u66ff\u6362 $S$ \u4e2d\u7684\u95ee\u53f7\uff0c\u6bcf\u4e2a\u5c0f\u5199\u5b57\u6bcd\u53ea\u80fd\u66ff\u6362\u4e00\u4e2a\u4f4d\u7f6e\u3002\u8bf7\u6c42\u51fa\u6240\u80fd\u5f97\u5230\u7684 $S$ \u7684\u6700\u5927\u4ef7\u503c\u3002\n\n## \u8f93\u5165\u683c\u5f0f\n\n\u7b2c\u4e00\u884c\u8f93\u5165\u4e00\u4e2a\u6b63\u6574\u6570 $k ~ (1 \\le k \\le 1000)$\uff0c\u8868\u793a\u5b57\u7b26\u4e32\u6570\u7ec4 $[t_1, t_2, \\ldots, t_k]$ \u7684\u5927\u5c0f\u3002\n\n\u63a5\u4e0b\u6765\u7684 $k$ \u884c\uff0c\u6bcf\u884c\u8f93\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32 $t_i$\uff08\u4ec5\u5305\u542b `a` \u5230 `n` \u4ee5\u5185\u7684\u5c0f\u5199\u5b57\u6bcd\uff09\u548c\u4e00\u4e2a\u6574\u6570 $c_i$ $(1 \\le \\lvert t_i \\rvert \\le 1000; -10 ^ 6 \\le c_i \\le 10 ^ 6)$\u3002\u6240\u6709 $t_i$ \u7684\u957f\u5ea6\u4e4b\u548c\u4e0d\u8d85\u8fc7 $1000$\u3002\n\n\u6700\u540e\u4e00\u884c\u8f93\u5165\u4e00\u4e2a\u4ec5\u5305\u542b `a` \u5230 `n` \u4ee5\u5185\u7684\u5c0f\u5199\u5b57\u6bcd\u548c\u95ee\u53f7\u5b57\u7b26\u4e32 $S ~ (1 \\le \\lvert S \\rvert \\le 4 \\cdot 10 ^ 5)$\u3002$S$ \u4e2d\u7684\u95ee\u53f7\u6570\u91cf\u4e0d\u8d85\u8fc7 $14$\u3002\n\n## \u8f93\u51fa\u683c\u5f0f\n\n\u8f93\u51fa\u4e00\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u4f7f\u7528 `a` \u5230 `n` \u7684\u5c0f\u5199\u5b57\u6bcd\u4e2d\u4e0d\u540c\u7684\u5b57\u6bcd\u66ff\u6362 $S$ \u4e2d\u7684\u95ee\u53f7\u540e\uff0c\u6240\u80fd\u5f97\u5230\u7684\u6700\u5927\u4ef7\u503c\u3002"
}
{
    "description": "The Elements of Harmony are six supernatural artifacts representing subjective aspects of harmony. They are arguably the most powerful force in Equestria. The inside of Elements of Harmony can be seen as a complete graph with $ n $ vertices labeled from 0 to $ n-1 $ , where $ n $ is a power of two, equal to $ 2^{m} $ .\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF453D/61f0ccb3c2db625a56073cf37959e5f86e41a2ae.png)The energy in Elements of Harmony is in constant movement. According to the ancient book, the energy of vertex $ u $ in time $ i $ $ (e_{i}[u]) $ equals to:\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF453D/f477f256b9f69645616e6b9b7f75309877ba5ea6.png)Here $ b[] $ is the transformation coefficient \u2014 an array of $ m+1 $ integers and $ f(u,v) $ is the number of ones in the binary representation of number $ (u\u00a0xor\u00a0v) $ .\n\nGiven the transformation coefficient and the energy distribution at time 0 $ (e_{0}[]) $ . Help Twilight Sparkle predict the energy distribution at time $ t $ $ (e_{t}[]) $ . The answer can be quite large, so output it modulo $ p $ .",
    "inputFormat": "The first line contains three integers $ m $ , $ t $ and $ p $ ( $ 1<=m<=20;\u00a00<=t<=10^{18};\u00a02<=p<=10^{9} $ ). The following line contains $ n $ ( $ n=2^{m} $ ) integers $ e_{0}[i] $ ( $ 1<=e_{0}[i]<=10^{9};\u00a00<=i<n $ ). The next line contains $ m+1 $ integers $ b[i] $ ( $ 0<=b[i]<=10^{9};\u00a00<=i<=m $ ).",
    "outputFormat": "Output $ n $ lines, the $ i $ -th line must contain a single integer $ e_{t}[i] $ modulo $ p $ .",
    "samples": [
        [
            "2 2 10000\n4 1 2 3\n0 1 0\n",
            "14\n6\n6\n14\n"
        ]
    ],
    "hint": "",
    "translation": "\u9898\u610f\u7ffb\u8bd1\uff1a\n\n\u8c10\u5f8b\u7cbe\u534e\u662f\u516d\u4e2a\u8d85\u81ea\u7136\u7684\u795e\u5668\uff0c\u5b83\u4eec\u4ee3\u8868\u7740\"\u548c\u8c10\"\u81ea\u8eab\u4e3b\u89c2\u7684\u610f\u5fd7\u3002\u5b83\u4eec\u88ab\u8ba4\u4e3a\u662f\u5c0f\u9a6c\u56fd\u6700\u5f3a\u5927\u7684\u529b\u91cf\u3002\n\n\u8c10\u5f8b\u7cbe\u534e\u7684\u5185\u90e8\uff0c\u53ef\u4ee5\u88ab\u770b\u4f5c\u662f\u4e00\u4e2a\u6709 $n$  \u4e2a\u8282\u70b9\u7684\u5b8c\u5168\u56fe\uff0c\u4ece $0$  \u5230 $n-1$  \u6807\u53f7\uff0c$n$  \u662f\u4e00\u4e2a\u4e8c\u7684\u5e42\u6b21\uff0c\u7b49\u4e8e $2^m$ \u3002\n\n![](https://cdn.luogu.org/upload/pic/13948.png)\n\n\u4e0a\u56fe\u662f\u516d\u4e2a\u8c10\u5f8b\u7cbe\u534e\u3002\n\n\u8c10\u5f8b\u7cbe\u534e\u4e2d\u7684\u80fd\u91cf\u5728\u4e0d\u65ad\u53d8\u5316\u3002\u6839\u636e\u53e4\u7c4d\u8bb0\u8f7d\uff0c\u8282\u70b9 $u$  \u5728\u65f6\u95f4 $i$  \u65f6\u7684\u80fd\u91cf(\u8bb0\u4f5c $e_i[u]$  )\u4e3a\uff1a\n\n$e_i[u]=\\sum_ve_{i-1}[v]\\cdot b[f(u,v)]$ \u3002\u8fd9\u91cc $b[]$  \u79f0\u4f5c\u53d8\u6362\u7cfb\u6570\u2014\u2014\u4e00\u4e2a\u6709 $m+1$  \u4e2a\u5143\u7d20\u7684\u6570\u7ec4\u3002\u800c $f(u,v)$  \u4e3a\u4e8c\u8fdb\u5236\u6570 $(u\\;xor\\;v)$  \u4e2d $1$  \u7684\u4e2a\u6570\u3002\n\n\u7ed9\u5b9a\u53d8\u6362\u7cfb\u6570 $b[]$  \u548c\u5728\u65f6\u95f4 $0$  \u65f6\u7684\u521d\u59cb\u80fd\u91cf\u5206\u5e03 $e_0[]$ \u3002\u5e2e\u52a9\u66ae\u5149\u95ea\u95ea\u9884\u6d4b\u5728\u65f6\u523b $t$  \u65f6\u7684\u80fd\u91cf\u5206\u5e03\u3002\u7b54\u6848\u53ef\u80fd\u975e\u5e38\u5927\uff0c\u4f60\u53ea\u8981\u8f93\u51fa\u7b54\u6848\u9664\u4ee5 $p$  \u7684\u4f59\u6570\u5373\u53ef\u3002\n\n**\u8f93\u5165\u683c\u5f0f\uff1a**\n\n\u7b2c\u4e00\u884c\u4e09\u4e2a\u6574\u6570 $m,t,p$  $(1\\le m\\le 20,0\\le t\\le10^{18},2\\le p\\le10^9)$ \u3002\n\n\u63a5\u4e0b\u6765\u4e00\u884c $n$  $(n=2^m)$  \u4e2a\u6574\u6570 $e_0[i]$  $1\\le e_0[i]\\le 10^9,0\\le i<n$ \u3002\n\n\u63a5\u4e0b\u6765\u4e00\u884c $m+1$  \u4e2a\u6574\u6570 $b[i]$  $(0\\le b[i]\\le 10^9,0\\le i\\le m)$ \u3002\n\n**\u8f93\u51fa\u683c\u5f0f\uff1a**\n\n\u8f93\u51fa $n$  \u884c\uff0c\u7b2c $i$  \u884c\u5305\u542b\u4e00\u4e2a\u6574\u6570\u8868\u793a $e_t[i]$  \u5bf9 $p$  \u53d6\u6a21\u7684\u7ed3\u679c\u3002\n"
}
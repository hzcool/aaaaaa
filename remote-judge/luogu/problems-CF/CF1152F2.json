{
    "description": "This problem is same as the previous one, but has larger constraints.\n\nAki is playing a new video game. In the video game, he will control Neko, the giant cat, to fly between planets in the Catniverse.\n\nThere are $ n $ planets in the Catniverse, numbered from $ 1 $ to $ n $ . At the beginning of the game, Aki chooses the planet where Neko is initially located. Then Aki performs $ k - 1 $ moves, where in each move Neko is moved from the current planet $ x $ to some other planet $ y $ such that:\n\n- Planet $ y $ is not visited yet.\n- $ 1 \\leq y \\leq x + m $ (where $ m $ is a fixed constant given in the input)\n\nThis way, Neko will visit exactly $ k $ different planets. Two ways of visiting planets are called different if there is some index $ i $ such that, the $ i $ -th planet visited in the first way is different from the $ i $ -th planet visited in the second way.\n\nWhat is the total number of ways to visit $ k $ planets this way? Since the answer can be quite large, print it modulo $ 10^9 + 7 $ .",
    "inputFormat": "The only line contains three integers $ n $ , $ k $ and $ m $ ( $ 1 \\le n \\le 10^9 $ , $ 1 \\le k \\le \\min(n, 12) $ , $ 1 \\le m \\le 4 $ ) \u2014 the number of planets in the Catniverse, the number of planets Neko needs to visit and the said constant $ m $ .",
    "outputFormat": "Print exactly one integer \u2014 the number of different ways Neko can visit exactly $ k $ planets. Since the answer can be quite large, print it modulo $ 10^9 + 7 $ .",
    "samples": [
        [
            "3 3 1\n",
            "4\n"
        ],
        [
            "4 2 1\n",
            "9\n"
        ],
        [
            "5 5 4\n",
            "120\n"
        ],
        [
            "100 1 2\n",
            "100\n"
        ]
    ],
    "hint": "In the first example, there are $ 4 $ ways Neko can visit all the planets:\n\n- $ 1 \\rightarrow 2 \\rightarrow 3 $\n- $ 2 \\rightarrow 3 \\rightarrow 1 $\n- $ 3 \\rightarrow 1 \\rightarrow 2 $\n- $ 3 \\rightarrow 2 \\rightarrow 1 $\n\nIn the second example, there are $ 9 $ ways Neko can visit exactly $ 2 $ planets:\n\n- $ 1 \\rightarrow 2 $\n- $ 2 \\rightarrow 1 $\n- $ 2 \\rightarrow 3 $\n- $ 3 \\rightarrow 1 $\n- $ 3 \\rightarrow 2 $\n- $ 3 \\rightarrow 4 $\n- $ 4 \\rightarrow 1 $\n- $ 4 \\rightarrow 2 $\n- $ 4 \\rightarrow 3 $\n\nIn the third example, with $ m = 4 $ , Neko can visit all the planets in any order, so there are $ 5! = 120 $ ways Neko can visit all the planets.\n\nIn the fourth example, Neko only visit exactly $ 1 $ planet (which is also the planet he initially located), and there are $ 100 $ ways to choose the starting planet for Neko.",
    "translation": "\u7ed9\u5b9a\u53c2\u6570 $n,k,m$\uff0c\u4f60\u9700\u8981\u6c42\u6709\u591a\u5c11\u4e2a\u5927\u5c0f\u4e3a $k$ \u7684\u5e8f\u5217 $a$ \u6ee1\u8db3\u5982\u4e0b\u4e09\u4e2a\u6761\u4ef6\uff1a\n\n1. \u4efb\u610f\u4e24\u4e2a\u5143\u7d20\u5176\u6743\u503c\u4e0d\u540c\u3002\n\n2. \u5bf9\u4e8e\u4efb\u610f $i$ \u6ee1\u8db3 $1\\le i\\le k$ \u6709 $1\\le a_i\\le n$\u3002\n\n3. \u5bf9\u4e8e\u4efb\u610f $i$ \u6ee1\u8db3 $2\\le i\\le k$ \u6709 $a_i\\le a_{i-1}+m$\u3002\n\n\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a\n\n$1\\le n\\le 10^9$\uff0c$1\\le k\\le \\min(n,12)$\uff0c$1\\le m\\le 4$\u3002\n\ntranslated by Soulist"
}
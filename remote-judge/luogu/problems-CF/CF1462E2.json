{
    "description": "This is the hard version of this problem. The only difference between the easy and hard versions is the constraints on $ k $ and $ m $ . In this version of the problem, you need to output the answer by modulo $ 10^9+7 $ .\n\nYou are given a sequence $ a $ of length $ n $ consisting of integers from $ 1 $ to $ n $ . The sequence may contain duplicates (i.e. some elements can be equal).\n\nFind the number of tuples of $ m $ elements such that the maximum number in the tuple differs from the minimum by no more than $ k $ . Formally, you need to find the number of tuples of $ m $ indices $ i_1 < i_2 < \\ldots < i_m $ , such that\n\n $ $$$\\max(a_{i_1}, a_{i_2}, \\ldots, a_{i_m}) - \\min(a_{i_1}, a_{i_2}, \\ldots, a_{i_m}) \\le k. $ $ </p><p>For example, if  $ n=4 $ ,  $ m=3 $ ,  $ k=2 $ ,  $ a=\\[1,2,4,3\\] $ , then there are two such triples ( $ i=1, j=2, z=4 $  and  $ i=2, j=3, z=4 $ ). If  $ n=4 $ ,  $ m=2 $ ,  $ k=1 $ ,  $ a=\\[1,1,1,1\\] $ , then all six possible pairs are suitable.</p><p><span class=\"tex-font-style-bf\">As the result can be very large, you should print the value modulo  $ 10^9 + 7 $  (the remainder when divided by  $ 10^9 + 7$$$).",
    "inputFormat": "The first line contains a single integer $ t $ ( $ 1 \\le t \\le 2 \\cdot 10^5 $ ) \u2014 the number of test cases. Then $ t $ test cases follow.\n\nThe first line of each test case contains three integers $ n $ , $ m $ , $ k $ ( $ 1 \\le n \\le 2 \\cdot 10^5 $ , $ 1 \\le m \\le 100 $ , $ 1 \\le k \\le n $ ) \u2014 the length of the sequence $ a $ , number of elements in the tuples and the maximum difference of elements in the tuple.\n\nThe next line contains $ n $ integers $ a_1, a_2,\\ldots, a_n $ ( $ 1 \\le a_i \\le n $ ) \u2014 the sequence $ a $ .\n\nIt is guaranteed that the sum of $ n $ for all test cases does not exceed $ 2 \\cdot 10^5 $ .",
    "outputFormat": "Output $ t $ answers to the given test cases. Each answer is the required number of tuples of $ m $ elements modulo $ 10^9 + 7 $ , such that the maximum value in the tuple differs from the minimum by no more than $ k $ .",
    "samples": [
        [
            "4\n4 3 2\n1 2 4 3\n4 2 1\n1 1 1 1\n1 1 1\n1\n10 4 3\n5 6 1 3 2 9 8 1 2 4",
            "2\n6\n1\n20"
        ]
    ],
    "hint": "",
    "translation": "\u7ed9\u5b9a $t$ \u4e2a\u957f\u4e3a $n$ \u7684\u6570\u7ec4 $a$\uff0c\u53d6\u5143\u7d20\u4e2a\u6570\u4e3a $m$ \u7684 $a$ \u7684\u5b50\u5e8f\u5217 $b$ \u6ee1\u8db3 $\\max(b_i) - \\min(b_i) \\leqslant k$ \uff0c\u95ee\u6700\u591a\u80fd\u627e\u51fa\u591a\u5c11\u7ec4\uff0c\u5e76\u53d6\u6a21 ${10}^9 + 7$\u3002"
}
{
    "description": "Parsa has a humongous tree on $ n $ vertices.\n\nOn each vertex $ v $ he has written two integers $ l_v $ and $ r_v $ .\n\nTo make Parsa's tree look even more majestic, Nima wants to assign a number $ a_v $ ( $ l_v \\le a_v \\le r_v $ ) to each vertex $ v $ such that the beauty of Parsa's tree is maximized.\n\nNima's sense of the beauty is rather bizarre. He defines the beauty of the tree as the sum of $ |a_u - a_v| $ over all edges $ (u, v) $ of the tree.\n\nSince Parsa's tree is too large, Nima can't maximize its beauty on his own. Your task is to find the maximum possible beauty for Parsa's tree.",
    "inputFormat": "The first line contains an integer $ t $ $ (1\\le t\\le 250) $ \u2014 the number of test cases. The description of the test cases follows.\n\nThe first line of each test case contains a single integer $ n $ $ (2\\le n\\le 10^5) $ \u2014 the number of vertices in Parsa's tree.\n\nThe $ i $ -th of the following $ n $ lines contains two integers $ l_i $ and $ r_i $ $ (1 \\le l_i \\le r_i \\le 10^9) $ .\n\nEach of the next $ n-1 $ lines contains two integers $ u $ and $ v $ $ (1 \\le u , v \\le n, u\\neq v) $ meaning that there is an edge between the vertices $ u $ and $ v $ in Parsa's tree.\n\nIt is guaranteed that the given graph is a tree.\n\nIt is guaranteed that the sum of $ n $ over all test cases doesn't exceed $ 2 \\cdot 10^5 $ .",
    "outputFormat": "For each test case print the maximum possible beauty for Parsa's tree.",
    "samples": [
        [
            "3\n2\n1 6\n3 8\n1 2\n3\n1 3\n4 6\n7 9\n1 2\n2 3\n6\n3 14\n12 20\n12 19\n2 12\n10 17\n3 17\n3 2\n6 5\n1 5\n2 6\n4 6",
            "7\n8\n62"
        ]
    ],
    "hint": "The trees in the example:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1528A/7830790d968daee501b061b313ebb6586c6b6ca7.png)In the first test case, one possible assignment is $ a = \\{1, 8\\} $ which results in $ |1 - 8| = 7 $ .\n\nIn the second test case, one of the possible assignments is $ a = \\{1, 5, 9\\} $ which results in a beauty of $ |1 - 5| + |5 - 9| = 8 $",
    "translation": "\u591a\u7ec4\u6570\u636e ($t$ \u7ec4)\n\n\u7ed9\u4f60\u5927\u5c0f\u4e3a $n$ \u7684\u4e00\u68f5\u6811\uff0c$i$ \u53f7\u8282\u70b9\u6709\u6743\u503c\u8303\u56f4 $[l_i,r_i]$\uff0c\u8ba9\u4f60\u5bf9\u6bcf\u4e2a\u8282\u70b9\u8d4b\u4e88\u4e00\u4e2a\u6743\u503c $a_i$\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u8282\u70b9\u6743\u503c\u90fd\u5728\u89c4\u5b9a\u7684\u8303\u56f4\u91cc\u5e76\u4e14\u5bf9\u4e8e\u6bcf\u6761\u8fb9 $(u,v)$\uff0c$\\sum{|a_u-a_v|}$ \u6700\u5927\uff0c\u5e76\u6c42\u51fa\u8fd9\u4e2a\u6700\u5927\u503c\u3002\n\n$2\\le n\\le 10^5,\\sum n\\le 2\\times 10^5,1\\le l_i\\le r_i\\le10^9$\uff0c\u65f6\u9650 $1\\text s$\uff0c\u7a7a\u9650 $256\\text{MB}$\n\nTranslated by @[ZCPB](https://www.luogu.com.cn/user/80614)"
}
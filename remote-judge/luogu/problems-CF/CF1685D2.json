{
    "description": "This is a hard version of the problem. The difference between the easy and hard versions is that in this version, you have to output the lexicographically smallest permutation with the smallest weight.\n\nYou are given a permutation $ p_1, p_2, \\ldots, p_n $ of integers from $ 1 $ to $ n $ .\n\nLet's define the weight of the permutation $ q_1, q_2, \\ldots, q_n $ of integers from $ 1 $ to $ n $ as $ $$$|q_1 - p_{q_{2}}| + |q_2 - p_{q_{3}}| + \\ldots + |q_{n-1} - p_{q_{n}}| + |q_n - p_{q_{1}}| $ $ </p><p>You want your permutation to be as lightweight as possible. Among the permutations  $ q $  with the smallest possible weight, find the lexicographically smallest.</p><p>Permutation  $ a\\_1, a\\_2, \\\\ldots, a\\_n $  is lexicographically smaller than permutation  $ b\\_1, b\\_2, \\\\ldots, b\\_n $ , if there exists some  $ 1 \\\\le i \\\\le n $  such that  $ a\\_j = b\\_j $  for all  $ 1 \\\\le j &lt; i $  and  $ a\\_i&lt;b\\_i$$$.",
    "inputFormat": "The first line of the input contains a single integer $ t $ ( $ 1 \\le t \\le 100 $ ) \u2014 the number of test cases. The description of the test cases follows.\n\nThe first line of each test case contains a single integer $ n $ ( $ 2 \\le n \\le 200 $ ) \u2014 the size of the permutation.\n\nThe second line of each test case contains $ n $ integers $ p_1, p_2, \\ldots, p_n $ ( $ 1 \\le p_i \\le n $ , all $ p_i $ are distinct) \u2014 the elements of the permutation.\n\nThe sum of $ n $ over all test cases doesn't exceed $ 400 $ .",
    "outputFormat": "For each test case, output $ n $ integers $ q_1, q_2, \\ldots, q_n $ ( $ 1 \\le q_i \\le n $ , all $ q_i $ are distinct) \u2014 the lexicographically smallest permutation with the smallest weight.",
    "samples": [
        [
            "3\n2\n2 1\n4\n2 3 1 4\n5\n5 4 3 2 1",
            "1 2 \n1 3 4 2 \n1 3 4 2 5"
        ]
    ],
    "hint": "In the first test case, there are two permutations of length $ 2 $ : $ (1, 2) $ and $ (2, 1) $ . Permutation $ (1, 2) $ has weight $ |1 - p_2| + |2 - p_1| = 0 $ , and the permutation $ (2, 1) $ has the same weight: $ |2 - p_1| + |1 - p_2| = 0 $ . In this version, you have to output the lexicographically smaller of them \u2014 $ (1, 2) $ .\n\nIn the second test case, the weight of the permutation $ (1, 3, 4, 2) $ is $ |1 - p_3| + |3 - p_4| + |4 - p_2| + |2 - p_1| = |1 - 1| + |3 - 4| + |4 - 3| + |2 - 2| = 2 $ . There are no permutations with smaller weights.\n\nIn the third test case, the weight of the permutation $ (1, 3, 4, 2, 5) $ is $ |1 - p_3| + |3 - p_4| + |4 - p_2| + |2 - p_5| + |5 - p_1| = |1 - 3| + |3 - 2| + |4 - 4| + |2 - 1| + |5 - 5| = 4 $ . There are no permutations with smaller weights.",
    "translation": "**\u8fd9\u662f\u672c\u9898\u7684\u56f0\u96be\u7248\u672c\u3002**  \n**\u7b80\u5355\u7248\u672c\u548c\u56f0\u96be\u7248\u672c\u7684\u533a\u522b\u5728\u4e8e\u5bf9\u4f60\u6240\u6784\u9020\u7684\u6392\u5217\u7684\u9650\u5236\u3002**  \n**\u5728\u672c\u9898\u4e2d\u4f60\u9700\u8981\u8f93\u51fa\u6240\u6709\u6743\u503c\u6700\u5c0f\u5316\u7684\u6392\u5217\u4e2d\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u90a3\u4e2a\u3002**\n\n### \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a\u4e00\u4e2a $1\\sim n$ \u7684\u6392\u5217 $p$\u3002  \n\u5bf9\u4e8e\u4e00\u4e2a $1\\sim n$ \u7684\u6392\u5217 $q$\uff0c\u5b9a\u4e49\u5176\u6743\u503c\u4e3a\uff1a\n\n$$|q_1-p_{q_2}|+|q_2-p_{q_3}|+|q_3-p_{q_4}|+\\cdots+|q_{n-1}-p_{q_n}|+|q_n-p_{q_1}|$$\n\n\u627e\u51fa\u6240\u6709\u6ee1\u8db3\u6743\u503c\u6700\u5c0f\u5316\u7684 $1\\sim n$ \u7684\u6392\u5217 $q$ \u4e2d **\u5b57\u5178\u5e8f\u6700\u5c0f** \u7684\u90a3\u4e2a\u3002  \n\u6211\u4eec\u79f0\u4e24\u4e2a $1\\sim n$ \u7684\u6392\u5217 $a,b$ \u6709 $a$ \u6bd4 $b$ \u5b57\u5178\u5e8f\u5c0f\u4ec5\u5f53\u5b58\u5728\u6574\u6570 $i(1\\leq i\\leq n)$ \u6ee1\u8db3 $a_i<b_i$ \u4e14\u5bf9\u4e8e\u4efb\u610f\u6574\u6570 $j(1\\leq j<i)$ \u90fd\u6709 $a_j=b_j$\u3002  \n\u6bcf\u4e2a\u6d4b\u8bd5\u70b9\u5305\u542b $t$ \u7ec4\u6570\u636e\u3002\n\n### \u8f93\u5165\u683c\u5f0f\n\n\u7b2c\u4e00\u884c\u8f93\u5165\u4e00\u4e2a\u6574\u6570 $t(1\\leq t\\leq100)$ \u8868\u793a\u6570\u636e\u7ec4\u6570\uff0c\u63a5\u4e0b\u6765\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff1a  \n\u7b2c\u4e00\u884c\u8f93\u5165\u4e00\u4e2a\u6574\u6570 $n(2\\leq n\\leq200;\\sum n\\leq400)$ \u8868\u793a\u6392\u5217\u957f\u5ea6\u3002  \n\u63a5\u4e0b\u6765\u4e00\u884c\u8f93\u5165 $n$ \u4e2a\u6574\u6570\u8868\u793a\u6392\u5217 $p(1\\leq p_i\\leq n)$\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\n\n\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff1a  \n\u8f93\u51fa $n$ \u4e2a\u6574\u6570\u8868\u793a\u4f60\u6c42\u51fa\u7684\u6743\u503c\u6700\u5c0f\u5316\u4e14\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u6392\u5217 $q$\u3002"
}
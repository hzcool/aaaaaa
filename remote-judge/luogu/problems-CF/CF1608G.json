{
    "description": "You are given $ m $ strings and a tree on $ n $ nodes. Each edge has some letter written on it.\n\nYou have to answer $ q $ queries. Each query is described by $ 4 $ integers $ u $ , $ v $ , $ l $ and $ r $ . The answer to the query is the total number of occurrences of $ str(u,v) $ in strings with indices from $ l $ to $ r $ . $ str(u,v) $ is defined as the string that is made by concatenating letters written on the edges on the shortest path from $ u $ to $ v $ (in order that they are traversed).",
    "inputFormat": "The first line of the input contains three integers $ n $ , $ m $ and $ q $ ( $ 2 \\le n \\le 10^5 $ , $ 1 \\le m,q \\le 10^5 $ ).\n\nThe $ i $ -th of the following $ n-1 $ lines contains two integers $ u_i, v_i $ and a lowercase Latin letter $ c_i $ ( $ 1 \\le u_i, v_i \\le n $ , $ u_i \\neq v_i $ ), denoting the edge between nodes $ u_i, v_i $ with a character $ c_i $ on it.\n\nIt's guaranteed that these edges form a tree.\n\nThe following $ m $ lines contain the strings consisting of lowercase Latin letters. The total length of those strings does not exceed $ 10^5 $ .\n\nThen $ q $ lines follow, each containing four integers $ u $ , $ v $ , $ l $ and $ r $ ( $ 1 \\le u,v \\le n $ , $ u \\neq v $ , $ 1 \\le l \\le r \\le m $ ), denoting the queries.",
    "outputFormat": "For each query print a single integer \u2014 the answer to the query.",
    "samples": [
        [
            "2 5 3\n1 2 a\naab\nabab\naaa\nb\na\n2 1 1 5\n1 2 1 3\n2 1 3 5",
            "8\n7\n4"
        ],
        [
            "9 5 6\n1 2 a\n2 7 c\n1 3 b\n3 4 b\n4 6 b\n3 5 a\n5 8 b\n5 9 c\nababa\ncabbb\nbac\nbbbac\nabacaba\n2 7 1 4\n2 5 1 5\n6 3 4 4\n6 9 4 5\n5 7 3 5\n5 3 1 5",
            "3\n4\n2\n1\n1\n10"
        ]
    ],
    "hint": "",
    "translation": "\u7ed9\u5b9a $m$ \u4e2a\u4ec5\u5305\u542b\u5c0f\u5199\u5b57\u6bcd\u7684\u5b57\u7b26\u4e32\u548c\u4e00\u68f5\u5305\u542b $n$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u6811\u7684\u6bcf\u6761\u8fb9\u4e0a\u90fd\u6709\u4e00\u4e2a\u5c0f\u5199\u5b57\u6bcd\u3002\u6211\u4eec\u5b9a\u4e49 $str(u,v)$ \u4e3a\u5c06\u5728\u6811\u4e0a\u4ece $u$ \u5230 $v$ \u7684\u8def\u5f84\u4e0a\u7ecf\u8fc7\u7684\u6240\u6709\u8fb9\u4e0a\u7684\u5c0f\u5199\u5b57\u6bcd\u987a\u6b64\u62fc\u63a5\u5f97\u5230\u7684\u5b57\u7b26\u4e32\u3002\u4f60\u9700\u8981\u56de\u7b54 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u5b9a $4$ \u4e2a\u6574\u6570 $u,v,l,r$\uff0c\u4f60\u9700\u8981\u56de\u7b54\u5728\u6240\u6709\u4e0b\u6807\u5728 $[l,r]$ \u7684\u5b57\u7b26\u4e32\u4e2d\uff0c$str(u,v)$ \u51fa\u73b0\u4e86\u591a\u5c11\u6b21\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a\n\n- $2\\leqslant n\\leqslant 10^5$\uff0c$1\\leqslant m,q\\leqslant 10^5$\u3002\n- $1\\leqslant u,v\\leqslant n$\uff0c$u\\neq v$\uff0c$1\\leqslant l\\leqslant r\\leqslant m$\u3002\n\nTranslated by Eason_AC"
}
{
    "description": "After a successful year of milk production, Farmer John is rewarding his cows with their favorite treat: tasty grass!\n\nOn the field, there is a row of $ n $ units of grass, each with a sweetness $ s_i $ . Farmer John has $ m $ cows, each with a favorite sweetness $ f_i $ and a hunger value $ h_i $ . He would like to pick two disjoint subsets of cows to line up on the left and right side of the grass row. There is no restriction on how many cows must be on either side. The cows will be treated in the following manner:\n\n- The cows from the left and right side will take turns feeding in an order decided by Farmer John.\n- When a cow feeds, it walks towards the other end without changing direction and eats grass of its favorite sweetness until it eats $ h_i $ units.\n- The moment a cow eats $ h_i $ units, it will fall asleep there, preventing further cows from passing it from both directions.\n- If it encounters another sleeping cow or reaches the end of the grass row, it will get upset. Farmer John absolutely does not want any cows to get upset.\n\nNote that grass does not grow back. Also, to prevent cows from getting upset, not every cow has to feed since FJ can choose a subset of them.\n\nSurprisingly, FJ has determined that sleeping cows are the most satisfied. If FJ orders optimally, what is the maximum number of sleeping cows that can result, and how many ways can FJ choose the subset of cows on the left and right side to achieve that maximum number of sleeping cows (modulo $ 10^9+7 $ )? The order in which FJ sends the cows does not matter as long as no cows get upset.",
    "inputFormat": "The first line contains two integers $ n $ and $ m $ ( $ 1 \\le n \\le 5000 $ , $ 1 \\le m \\le 5000 $ ) \u2014 the number of units of grass and the number of cows.\n\nThe second line contains $ n $ integers $ s_1, s_2, \\ldots, s_n $ ( $ 1 \\le s_i \\le n $ ) \u2014 the sweetness values of the grass.\n\nThe $ i $ -th of the following $ m $ lines contains two integers $ f_i $ and $ h_i $ ( $ 1 \\le f_i, h_i \\le n $ ) \u2014 the favorite sweetness and hunger value of the $ i $ -th cow. No two cows have the same hunger and favorite sweetness simultaneously.",
    "outputFormat": "Output two integers \u2014 the maximum number of sleeping cows that can result and the number of ways modulo $ 10^9+7 $ .",
    "samples": [
        [
            "5 2\n1 1 1 1 1\n1 2\n1 3",
            "2 2"
        ],
        [
            "5 2\n1 1 1 1 1\n1 2\n1 4",
            "1 4"
        ],
        [
            "3 2\n2 3 2\n3 1\n2 1",
            "2 4"
        ],
        [
            "5 1\n1 1 1 1 1\n2 5",
            "0 1"
        ]
    ],
    "hint": "In the first example, FJ can line up the cows as follows to achieve $ 2 $ sleeping cows:\n\n- Cow $ 1 $ is lined up on the left side and cow $ 2 $ is lined up on the right side.\n- Cow $ 2 $ is lined up on the left side and cow $ 1 $ is lined up on the right side.\n\nIn the second example, FJ can line up the cows as follows to achieve $ 1 $ sleeping cow:\n\n- Cow $ 1 $ is lined up on the left side.\n- Cow $ 2 $ is lined up on the left side.\n- Cow $ 1 $ is lined up on the right side.\n- Cow $ 2 $ is lined up on the right side.\n\nIn the third example, FJ can line up the cows as follows to achieve $ 2 $ sleeping cows:\n\n- Cow $ 1 $ and $ 2 $ are lined up on the left side.\n- Cow $ 1 $ and $ 2 $ are lined up on the right side.\n- Cow $ 1 $ is lined up on the left side and cow $ 2 $ is lined up on the right side.\n- Cow $ 1 $ is lined up on the right side and cow $ 2 $ is lined up on the left side.\n\nIn the fourth example, FJ cannot end up with any sleeping cows, so there will be no cows lined up on either side.",
    "translation": "\u5728\u4e00\u5e74\u6210\u529f\u7684\u725b\u5976\u751f\u4ea7\u540e\uff0cFarmer John \u5956\u52b1\u4ed6\u7684\u5976\u725b\u4eec\u5b83\u4eec\u6700\u559c\u6b22\u7684\u7f8e\u5473\u7684\u8349\u3002\r\n\r\n\u5728\u7530\u91cc\u6709 $n$ \u4e2a\u5355\u4f4d\u7684\u6392\u6210\u4e00\u884c\u7684\u8349\uff0c\u6bcf\u4e2a\u5355\u4f4d\u7684\u8349\u6709\u751c\u5473 $s_i$\u3002Farmer John \u6709 $m$ \u5934\u5976\u725b\uff0c\u6bcf\u53ea\u90fd\u6709\u6700\u559c\u6b22\u7684\u751c\u5473 $f_i$ \u548c\u9965\u997f\u503c $h_i$\u3002\u4ed6\u60f3\u8981\u5728\u5976\u725b\u9009\u53d6\u4e24\u4e2a\u4e0d\u76f8\u4ea4\u7684\u5b50\u96c6\uff0c\u5206\u522b\u5728\u8fd9\u884c\u8349\u7684\u5de6\u4fa7\u548c\u53f3\u4fa7\u6392\u6210\u4e00\u5217\u3002\u6ce8\u610f\u4e24\u8fb9\u7ad9\u591a\u5c11\u5976\u725b\u662f\u65e0\u5173\u7d27\u8981\u7684\u3002\u5976\u725b\u4f1a\u6309\u4ee5\u4e0b\u65b9\u5f0f\u88ab\u5582\uff1a\r\n\r\n- Farmer John \u4f1a\u6309\u7167\u6307\u5b9a\u7684\u987a\u5e8f\u4f9d\u6b21\u5582\u5976\u725b\u3002\r\n- \u5728\u5976\u725b\u88ab\u5582\u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u5f84\u76f4\u4ece\u4e00\u7aef\u8d70\u5411\u53e6\u4e00\u7aef\uff0c\u4e00\u8def\u4e0a\u628a\u751c\u5473 $s_i$ \u548c\u5b83\u559c\u7231\u7684\u751c\u5473 $f_i$ \u76f8\u540c\u7684\u8349\u5403\u6389\u3002\r\n- \u5f53\u5b83\u6070\u597d\u5403\u4e86 $h_i$ \u5355\u4f4d\u7684\u8349\uff0c\u5b83\u4f1a\u7acb\u5373\u5728\u539f\u5730\u505c\u6b62\u4e0d\u52a8\u5e76\u7761\u89c9\uff0c\u8fd9\u4f1a\u4f7f\u5f97\u5176\u5b83\u5976\u725b\u65e0\u6cd5\u901a\u8fc7\u8fd9\u4e2a\u4f4d\u7f6e\uff08\u4e0d\u8bba\u6765\u81ea\u54ea\u4e00\u4fa7\uff09\u3002\r\n- \u5982\u679c\u4e00\u4e2a\u5976\u725b\u9047\u5230\u4e86\u4e00\u4e2a\u7761\u7740\u7684\u5976\u725b\u6216\u8005\u5b83\u8d70\u5230\u4e86\u6574\u884c\u8349\u7684\u6700\u672b\u5c3e\u90fd\u6ca1\u6709\u5403\u9971\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u53d8\u5f97\u6cae\u4e27\u3002Farmer John \u7edd\u5bf9\u4e0d\u60f3\u8ba9\u4efb\u4f55\u5976\u725b\u53d8\u5f97\u6cae\u4e27\u3002\r\n\r\n\u6ce8\u610f\u8349\u4e0d\u4f1a\u957f\u56de\u6765\u3002\u5e76\u4e14\u4e3a\u4e86\u9632\u6b62\u5976\u725b\u6cae\u4e27\uff0cFarmer John \u4e0d\u5fc5\u4fdd\u8bc1\u5582\u4e86\u6240\u6709\u5976\u725b\u3002\r\n\r\n\u60ca\u4eba\u7684\u662f\uff0cFarmer John \u5df2\u7ecf\u53d1\u73b0\u7761\u7740\u7684\u5976\u725b\u662f\u6700\u6ee1\u8db3\u7684\u3002\u5982\u679c Farmer John \u5b89\u6392\u7684\u6700\u4f18\u3002\u6c42\u51fa\u6700\u591a\u7684\u7761\u7740\u7684\u5976\u725b\u6570\uff0c\u5e76\u6c42\u51fa\u5728\u6b64\u60c5\u51b5\u4e0b\u6709\u591a\u5c11\u79cd\u5de6\u53f3\u4e24\u4fa7\u5976\u725b\u7684\u65b9\u6848 Farmer John \u53ef\u4ee5\u9009\u62e9\uff08\u5bf9 $10^9+7$ \u53d6\u6a21\uff09\u3002\u53ea\u8981\u8fd9\u4e2a\u65b9\u6848\u5b58\u5728\u4e00\u79cd\u987a\u5e8f\u4f7f\u5f97\u80fd\u4e0d\u8ba9\u5976\u725b\u6cae\u4e27\u5373\u53ef\uff0cFarmer John \u5177\u4f53\u5982\u4f55\u5b89\u6392\u662f\u65e0\u5173\u7d27\u8981\u7684\u3002\r\n\r\n$n,m\\le 5000$.\r\n\r\n\uff08Translated by [@Ryoku](https://www.luogu.com.cn/user/34238)\uff09"
}
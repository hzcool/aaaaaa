{
    "description": "Today is a holiday in the residence hall \u2014 Oleh arrived, in honor of which the girls gave him a string. Oleh liked the gift a lot, so he immediately thought up and offered you, his best friend, the following problem.\n\nYou are given a string $ s $ of length $ n $ , which consists of the first $ 17 $ lowercase Latin letters { $ a $ , $ b $ , $ c $ , $ \\ldots $ , $ p $ , $ q $ } and question marks. And $ q $ queries. Each query is defined by a set of pairwise distinct lowercase first $ 17 $ letters of the Latin alphabet, which can be used to replace the question marks in the string $ s $ .\n\nThe answer to the query is the sum of the number of distinct substrings that are palindromes over all strings that can be obtained from the original string $ s $ by replacing question marks with available characters. The answer must be calculated modulo $ 998\\,244\\,353 $ .\n\nPay attention! Two substrings are different when their start and end positions in the string are different. So, the number of different substrings that are palindromes for the string aba will be $ 4 $ : a, b, a, aba.\n\nConsider examples of replacing question marks with letters. For example, from the string aba??ee when querying { $ a $ , $ b $ } you can get the strings ababaee or abaaaee but you cannot get the strings pizza,  abaee, abacaba, aba?fee, aba47ee, or abatree.\n\nRecall that a palindrome is a string that reads the same from left to right as from right to left.",
    "inputFormat": "The first line contains a single integer $ n $ ( $ 1 \\le n \\le 1\\,000 $ ) \u2014 the length of the string $ s $ .\n\nThe second line contains the string $ s $ , which consists of $ n $ lowercase Latin letters and question marks. It is guaranteed that all letters in the string belong to the set { $ a $ , $ b $ , $ c $ , $ \\ldots $ , $ p $ , $ q $ }.\n\nThe third line contains a single integer $ q $ ( $ 1 \\le q \\le 2 \\cdot 10^5 $ ) \u2014 the number of queries.\n\nThis is followed by $ q $ lines, each containing a single line $ t $ \u2014 a set of characters that can replace question marks ( $ 1 \\le |t| \\le 17 $ ). It is guaranteed that all letters in the string belong to the set { $ a $ , $ b $ , $ c $ , $ \\ldots $ , $ p $ , $ q $ } and occur at most once.",
    "outputFormat": "For each query print one number \u2014 the total numbers of palindromic substrings in all strings that can be obtained from the string $ s $ , modulo $ 998\\,244\\,353 $ .",
    "samples": [
        [
            "7\nab??aba\n8\na\nb\nab\nabc\nabcd\nabcde\nabcdef\nabcdefg",
            "14\n13\n55\n105\n171\n253\n351\n465"
        ],
        [
            "11\n???????????\n6\nabcdefghijklmnopq\necpnkhbmlidgfjao\nolehfan\ncodef\nglhf\nq",
            "900057460\n712815817\n839861037\n756843750\n70840320\n66"
        ]
    ],
    "hint": "Consider the first example and the first query in it. We can get only one string as a result of replacing the question marks \u2014 abaaaba. It has the following palindrome substrings:\n\n1. a \u2014 substring \\[ $ 1 $ ; $ 1 $ \\].\n2. b \u2014 substring \\[ $ 2 $ ; $ 2 $ \\].\n3. a \u2014 substring \\[ $ 3 $ ; $ 3 $ \\].\n4. a \u2014 substring \\[ $ 4 $ ; $ 4 $ \\].\n5. a \u2014 substring \\[ $ 5 $ ; $ 5 $ \\].\n6. b \u2014 substring \\[ $ 6 $ ; $ 6 $ \\].\n7. a \u2014 substring \\[ $ 7 $ ; $ 7 $ \\].\n8. aa \u2014 substring \\[ $ 3 $ ; $ 4 $ \\].\n9. aa \u2014 substring \\[ $ 4 $ ; $ 5 $ \\].\n10. aba \u2014 substring \\[ $ 1 $ ; $ 3 $ \\].\n11. aaa \u2014 substring \\[ $ 3 $ ; $ 5 $ \\].\n12. aba \u2014 substring \\[ $ 5 $ ; $ 7 $ \\].\n13. baaab \u2014 substring \\[ $ 2 $ ; $ 6 $ \\].\n14. abaaaba \u2014 substring \\[ $ 1 $ ; $ 7 $ \\].\n\nIn the third request, we get 4 lines: abaaaba, abababa, abbaaba, abbbaba.",
    "translation": "\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n(n\\le 1000)$ \uff0c\u4ec5\u7531\u524d $17$ \u4e2a\u82f1\u6587\u5c0f\u5199\u5b57\u6bcd\u548c\u95ee\u53f7\u7ec4\u6210\u7684\u5b57\u7b26\u4e32 $s$\u3002\u591a\u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u51fa\u4e00\u4e2a\u7531\u524d $17$ \u4e2a\u82f1\u6587\u5c0f\u5199\u5b57\u6bcd\u7ec4\u6210\u7684\u5b57\u7b26\u96c6 $A$ \uff0c\u4f60\u53ef\u4ee5\u5c06 $s$ \u4e2d\u7684\u95ee\u53f7\u4efb\u610f\u66ff\u6362\u6210 $A$ \u4e2d\u7684\u5b57\u6bcd\uff0c\u6c42\u4f60\u80fd\u5f97\u5230\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u56de\u6587\u5b50\u4e32\uff08\u4e24\u4e2a\u5b50\u4e32\u4e0d\u540c\uff0c\u5f53\u4e14\u4ec5\u5f53\u8d77\u59cb\u4f4d\u7f6e\uff0c\u957f\u5ea6\uff0c\u4e24\u4e2a\u5b50\u4e32\u7684\u5185\u5bb9\u81f3\u5c11\u4e00\u4e2a\u4e0d\u540c\uff09\u3002"
}
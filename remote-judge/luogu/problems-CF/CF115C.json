{
    "description": "Little John aspires to become a plumber! Today he has drawn a grid consisting of $ n $ rows and $ m $ columns, consisting of $ n\u00d7m $ square cells.\n\nIn each cell he will draw a pipe segment. He can only draw four types of segments numbered from $ 1 $ to $ 4 $ , illustrated as follows:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/5684a4b13082e2a77497ef1a54b7d0e8d10cf63a.png)Each pipe segment has two ends, illustrated by the arrows in the picture above. For example, segment $ 1 $ has ends at top and left side of it.\n\nLittle John considers the piping system to be leaking if there is at least one pipe segment inside the grid whose end is not connected to another pipe's end or to the border of the grid. The image below shows an example of leaking and non-leaking systems of size $ 1\u00d72 $ .\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/27e564b3757fd632050e90769548f2507e6d8614.png)Now, you will be given the grid that has been partially filled by Little John. Each cell will either contain one of the four segments above, or be empty. Find the number of possible different non-leaking final systems after Little John finishes filling all of the empty cells with pipe segments. Print this number modulo $ 1000003 $ ( $ 10^{6}+3 $ ).\n\nNote that rotations or flipping of the grid are not allowed and so two configurations that are identical only when one of them has been rotated or flipped either horizontally or vertically are considered two different configurations.",
    "inputFormat": "The first line will contain two single-space separated integers $ n $ and $ m $ ( $ 1<=n,m,n\u00b7m<=5\u00b710^{5} $ ) \u2014 the number of rows and columns respectively. Then $ n $ lines follow, each contains exactly $ m $ characters \u2014 the description of the grid. Each character describes a cell and is either one of these:\n\n- \"1\" - \"4\" \u2014 a pipe segment of one of four types as described above\n- \".\" \u2014 an empty cell",
    "outputFormat": "Print a single integer denoting the number of possible final non-leaking pipe systems modulo $ 1000003 $ ( $ 10^{6}+3 $ ). If there are no such configurations, print $ 0 $ .",
    "samples": [
        [
            "2 2\n13\n..\n",
            "2\n"
        ],
        [
            "3 1\n1\n4\n.\n",
            "0\n"
        ],
        [
            "2 2\n3.\n.1\n",
            "1\n"
        ]
    ],
    "hint": "For the first example, the initial configuration of the grid is as follows.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/ea03cb91df64d965734fe547ca6374a2eb82152f.png)The only two possible final non-leaking pipe configurations are as follows:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/61cdf177228590fa8ab090a556a9fd6e592dd21d.png) ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/023c7b7445c5e47c887c46cd5386151bace1eae5.png)For the second example, the initial grid is already leaking, so there will be no final grid that is non-leaking.\n\nFor the final example, there's only one possible non-leaking final grid as follows.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/e72e3ca7692dff7d542a5eb082c86ab442d32df7.png)",
    "translation": "### \u9898\u76ee\u63cf\u8ff0\n\u5c0f\u7ea6\u7ff0\u52b1\u5fd7\u6210\u4e3a\u4e00\u540d\u7ba1\u9053\u5de5\uff01\u4eca\u5929\u4ed6\u753b\u4e86\u4e00\u4e2a\u5305\u542b $n$ \u884c $m$ \u5217\u7684\u7f51\u683c\u3002   \n\n\u5728\u6bcf\u4e2a\u5355\u5143\u683c\u4e2d\uff0c\u4ed6\u5c06\u753b\u4e00\u6bb5\u7ba1\u9053\u3002\u4ed6\u53ea\u80fd\u753b\u56db\u79cd\u90e8\u5206\u7ba1\u9053\uff0c\u4f7f\u7528 1 \u81f3 4 \u6807\u53f7\uff0c\u5982\u56fe\u3002\n![img1](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/5684a4b13082e2a77497ef1a54b7d0e8d10cf63a.png)\n\u6bcf\u4e00\u4e2a\u7ba1\u9053\u90fd\u6709\u4e24\u7aef\uff0c\u5728\u4e0a\u56fe\u4e2d\u4f7f\u7528\u7bad\u5934\u8868\u793a\u3002\u4f8b\u5982\uff0c\u7b2c 1 \u5e45\u56fe\u7684\u7ba1\u9053\u7684\u4e24\u7aef\u5206\u522b\u5728\u4e0a\u9762\u548c\u5de6\u9762\uff0c    \n\n\u5982\u679c\u7f51\u683c\u5185\u6709\u90e8\u5206\u7ba1\u9053\u7684\u672b\u7aef\u672a\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u7ba1\u9053\u7684\u672b\u7aef\u6216\u7f51\u683c\u7684\u8fb9\u754c\uff0c\u5219\u5c0f\u7ea6\u7ff0\u8ba4\u4e3a\u7ba1\u9053\u7cfb\u7edf\u5b58\u5728\u6f0f\u6d1e\u3002\u4e0b\u9762\u8fd9\u5e45\u56fe\u5c31\u5c55\u793a\u4e86\u4e00\u4e2a\u5728 $1 \\times 2$ \u7684\u7ba1\u9053\u7ec4\u4e2d\u4e00\u4e2a\u6709\u6f0f\u6d1e\u7684\u8fde\u63a5\u548c\u6ca1\u6709\u6f0f\u6d1e\u7684\u8fde\u63a5\u3002   \n![img2](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/27e564b3757fd632050e90769548f2507e6d8614.png)\n\u73b0\u5728\u7ed9\u4f60\u4e00\u4e2a\u5c0f\u7ea6\u7ff0\u5df2\u7ecf\u5b8c\u6210\u90e8\u5206\u7684\u7ba1\u9053\u7ec4\u3002\u6bcf\u4e00\u4e2a\u7f51\u683c\u4e2d\u8981\u4e48\u6709\u6309\u8981\u6c42\u586b\u5145\u7684\u7ba1\u9053\uff0c\u8981\u4e48\u6ca1\u6709\u88ab\u586b\u5145\u3002\u60a8\u9700\u8981\u627e\u51fa\u53ef\u7ec4\u6210\u591a\u5c11\u4e2a\u6ca1\u6709\u6f0f\u6d1e\u7684\u7ba1\u9053\u3002\u5c06\u7ed3\u679c\u53d6\u4f59 $10^6 +3$\u3002    \n\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7f51\u683c\u4e0d\u5141\u8bb8\u65cb\u8f6c\u6216\u7ffb\u8f6c\u3002\u56e0\u6b64\u4ec5\u5f53\u5176\u4e2d\u4e4b\u4e00\u6c34\u5e73\u6216\u5782\u76f4\u65cb\u8f6c\u6216\u7ffb\u8f6c\u65f6\u624d\u76f8\u540c\u7684\u4e24\u4e2a\u914d\u7f6e\u88ab\u89c6\u4e3a\u4e24\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u3002   \n### \u8f93\u5165\u683c\u5f0f\n\u7b2c\u4e00\u884c\u8f93\u5165 $n$\uff0c$m$\uff08$1 <= n,m$\uff0c$n \\times m <= 5 \\times 10^5$\uff09\uff0c\u8868\u793a\u884c\u6570\u548c\u5217\u6570\u3002    \n\n\u63a5\u4e0b\u6765 $n$ \u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u5b57\u7b26\uff0c\u89e3\u91ca\u5c0f\u7ea6\u7ff0\u5df2\u7ecf\u5b8c\u6210\u7684\u90e8\u5206\u7ba1\u9053\uff0c\u548c\u9700\u8981\u5b8c\u6210\u7684\u7ba1\u9053\u3002\n\u7528 1 ~ 4 \u8868\u793a\u5df2\u7ecf\u5b8c\u6210\u7684\u7ba1\u9053\uff0c\u201c.\u201d\u8868\u793a\u672a\u5b8c\u6210\u7684\u7ba1\u9053\u3002\n### \u8f93\u51fa\u683c\u5f0f\n\u8f93\u51fa\u6700\u591a\u80fd\u6709\u591a\u5c11\u79cd\u65e0\u6f0f\u6d1e\u7684\u7684\u7ba1\u9053\u3002\u5982\u679c\u6ca1\u6709\uff0c\u8f93\u51fa 0\uff1b\u5426\u5219\uff0c\u5c06\u7b54\u6848\u53d6\u4f59 $10^6 + 3$\n### \u8bf4\u660e\u63d0\u793a\n##### \u6837\u4f8b 1 \u89e3\u91ca\n\u7f51\u683c\u521d\u59cb\u914d\u7f6e\u5982\u56fe\u3002\n![img3](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/ea03cb91df64d965734fe547ca6374a2eb82152f.png)  \n\u6240\u4ee5\u6700\u7ec8\u65e0\u6f0f\u6d1e\u914d\u7f6e\u53ea\u6709\u4e24\u79cd\uff0c\u5982\u4e0b\u56fe\u3002\n![img4](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/61cdf177228590fa8ab090a556a9fd6e592dd21d.png)\n![img5](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/023c7b7445c5e47c887c46cd5386151bace1eae5.png)\n##### \u6837\u4f8b 2 \u89e3\u91ca\n\u5c0f\u7ea6\u7ff0\u5df2\u5b8c\u6210\u7684\u7ba1\u9053\u5df2\u7ecf\u6709\u6f0f\u6d1e\u4e86\uff0c\u6240\u4ee5\u65e0\u6cd5\u62fc\u6210\u65e0\u6f0f\u6d1e\u7684\u7ba1\u9053\u7ec4\u3002\n##### \u6837\u4f8b 3 \u89e3\u91ca\n\u53ea\u6709\u4e00\u79cd\u65b9\u6cd5\uff0c\u5982\u56fe\u3002\n![img6](https://cdn.luogu.com.cn/upload/vjudge_pic/CF115C/e72e3ca7692dff7d542a5eb082c86ab442d32df7.png)   \n**\u4e25\u683c\u9075\u7167\u539f\u6587\uff0c\u672a\u52a0\u6539\u52a8**    \n\u7ffb\u8bd1\u8005\uff1a[\u701b\u6d32\u4ed9\u5b50](https://www.luogu.com.cn/user/517637)\uff0c[\u90ed\u6881](https://www.luogu.com.cn/user/284186)  \n\u63d0\u4ea4\u8005\uff1a[\u701b\u6d32\u4ed9\u5b50](https://www.luogu.com.cn/user/517637)"
}
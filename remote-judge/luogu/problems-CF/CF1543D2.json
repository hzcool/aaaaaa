{
    "description": "This is the hard version of the problem. The only difference is that here $ 2\\leq k\\leq 100 $ . You can make hacks only if both the versions of the problem are solved.\n\nThis is an interactive problem!\n\nEvery decimal number has a base $ k $ equivalent. The individual digits of a base $ k $ number are called $ k $ -its. Let's define the $ k $ -itwise XOR of two $ k $ -its $ a $ and $ b $ as $ (a + b)\\bmod k $ .\n\nThe $ k $ -itwise XOR of two base $ k $ numbers is equal to the new number formed by taking the $ k $ -itwise XOR of their corresponding $ k $ -its. The $ k $ -itwise XOR of two decimal numbers $ a $ and $ b $ is denoted by $ a\\oplus_{k} b $ and is equal to the decimal representation of the $ k $ -itwise XOR of the base $ k $ representations of $ a $ and $ b $ . All further numbers used in the statement below are in decimal unless specified.\n\nYou have hacked the criminal database of Rockport Police Department (RPD), also known as the Rap Sheet. But in order to access it, you require a password. You don't know it, but you are quite sure that it lies between $ 0 $ and $ n-1 $ inclusive. So, you have decided to guess it. Luckily, you can try at most $ n $ times without being blocked by the system. But the system is adaptive. Each time you make an incorrect guess, it changes the password. Specifically, if the password before the guess was $ x $ , and you guess a different number $ y $ , then the system changes the password to a number $ z $ such that $ x\\oplus_{k} z=y $ . Guess the password and break into the system.",
    "inputFormat": "The first line of input contains a single integer $ t $ ( $ 1\\leq t\\leq 10\\,000 $ ) denoting the number of test cases. $ t $ test cases follow.\n\nThe first line of each test case contains two integers $ n $ ( $ 1\\leq n\\leq 2\\cdot 10^5 $ ) and $ k $ $ (2\\leq k\\leq 100) $ .\n\nIt is guaranteed that the sum of $ n $ over all test cases does not exceed $ 2\\cdot 10^5 $ .",
    "outputFormat": "For each test case, first read two integers $ n $ and $ k $ . Then you may ask up to $ n $ queries.\n\nFor each query, print a single integer $ y $ ( $ 0\\leq y\\leq 2\\cdot 10^7 $ ). Let the current password be $ x $ . After that, read an integer $ r $ .\n\nIf $ x=y $ , you will read $ r=1 $ and the test case is solved. You must then continue solving the remaining test cases.\n\nElse, you will read $ r=0 $ . At this moment the password is changed to a number $ z $ such that $ x\\oplus_{k} z=y $ .\n\nAfter printing a query, do not forget to output the end of line and flush the output. Otherwise, you will get the Idleness limit exceeded verdict.\n\nTo do this, use:\n\n- fflush(stdout) or cout.flush() in C++;\n- System.out.flush() in Java;\n- flush(output) in Pascal;\n- stdout.flush() in Python;\n- see documentation for other languages.\n\nIf you ask an invalid query or exceed $ n $ queries, you will read $ r=-1 $ and you will receive the Wrong Answer verdict. Make sure to exit immediately to avoid unexpected verdicts.\n\nNote that the interactor is adaptive. That is, the original password is not fixed in the beginning and may depend on your queries. But it is guaranteed that at any moment there is at least one initial password such that all the answers to the queries are consistent.\n\nHacks:\n\nTo use hacks, use the following format of tests:\n\nThe first line should contain a single integer $ t $ ( $ 1\\leq t\\leq 10\\,000 $ ) \u2014 the number of test cases.\n\nThe first and only line of each test case should contain two integers $ n $ ( $ 1\\leq n\\leq 2\\cdot 10^5 $ ) and $ k $ ( $ 2\\leq k\\leq 100 $ ) denoting the number of queries and the base respectively. The optimal original password is automatically decided by the adaptive interactor.\n\nYou must ensure that the sum of $ n $ over all test cases does not exceed $ 2\\cdot 10^5 $ .",
    "samples": [
        [
            "2\n5 2\n\n0\n\n0\n\n1\n5 3\n\n0\n\n0\n\n1",
            "3\n\n4\n\n5\n\n\n1\n\n4\n\n6"
        ]
    ],
    "hint": "Test Case 1:\n\nIn this case, the hidden password is $ 2 $ .\n\nThe first query is $ 3 $ . It is not equal to the current password. So, $ 0 $ is returned, and the password is changed to $ 1 $ since $ 2\\oplus_2 1=3 $ .\n\nThe second query is $ 4 $ . It is not equal to the current password. So, $ 0 $ is returned, and the password is changed to $ 5 $ since $ 1\\oplus_2 5=4 $ .\n\nThe third query is $ 5 $ . It is equal to the current password. So, $ 1 $ is returned, and the job is done.\n\nTest Case 2:\n\nIn this case, the hidden password is $ 3 $ .\n\nThe first query is $ 1 $ . It is not equal to the current password. So, $ 0 $ is returned, and the password is changed to $ 7 $ since $ 3\\oplus_3 7=1 $ . $ [3=(10)_3 $ , $ 7=(21)_3 $ , $ 1=(01)_3 $ and $ (10)_3\\oplus_3 (21)_3 = (01)_3] $ .\n\nThe second query is $ 4 $ . It is not equal to the current password. So, $ 0 $ is returned, and the password is changed to $ 6 $ since $ 7\\oplus_3 6=4 $ . $ [7=(21)_3 $ , $ 6=(20)_3 $ , $ 4=(11)_3 $ and $ (21)_3\\oplus_3 (20)_3 = (11)_3] $ .\n\nThe third query is $ 6 $ . It is equal to the current password. So, $ 1 $ is returned, and the job is done.\n\nNote that these initial passwords are taken just for the sake of explanation. In reality, the grader might behave differently because it is adaptive.",
    "translation": "\u8fd9\u662f\u672c\u9898\u7684\u56f0\u96be\u7248\u672c\uff0c\u7b80\u5355\u7248\u672c\u548c\u56f0\u96be\u7248\u672c\u7684\u533a\u522b\u5728\u4e8e $k$ \u7684\u6570\u636e\u8303\u56f4\uff0c\u5728\u56f0\u96be\u7248\u672c\u4e2d $2\\leq k\\leq100$\u3002  \n\u672c\u9898\u662f\u4ea4\u4e92\u9898\u3002  \n\u5bf9\u4e8e\u5341\u8fdb\u5236\u6570 $a,b$\uff0c\u6211\u4eec\u5b9a\u4e49 $a\\oplus_kb$ \u7684\u503c\u5982\u4e0b\uff1a\n\n- \u5c06 $a,b$ \u8f6c\u6362\u4e3a $k$ \u8fdb\u5236\uff0c\u8bbe $k$ \u8fdb\u5236\u6570 $c$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $i$\uff0c$c$ \u7684\u7b2c $i$ \u4f4d\u7684\u503c\u4e3a $(a$ \u7684\u7b2c $i$ \u4f4d\u7684\u503c $+b$ \u7684\u7b2c $i$ \u4f4d\u7684\u503c $)\\mod k$\uff0c\u5219 $c$ \u5728\u5341\u8fdb\u5236\u4e0b\u7684\u503c\u5c31\u662f $a\\oplus_kb$ \u7684\u503c\u3002\n\n\u4ea4\u4e92\u5668\u4f1a\u544a\u8bc9\u4f60\u6574\u6570 $n,k$\uff0c\u540c\u65f6\u4ea4\u4e92\u5668\u6709\u4e00\u4e2a\u4f60\u4e0d\u77e5\u9053\u7684\u6574\u6570 $x$\uff0c\u4f60\u77e5\u9053 $x\\in[0,n-1]$\uff0c\u4f60\u9700\u8981\u5728 $n$ \u6b21\u731c\u6d4b\u4e2d\u731c\u51fa $x$ \u7684\u503c\u3002\u6bcf\u6b21\u731c\u6d4b\u4f60\u9700\u8981\u8f93\u51fa\u6574\u6570 $y$\uff0c\u5982\u679c $x=y$ \u90a3\u4e48\u672c\u7ec4\u6570\u636e\u4ea4\u4e92\u6b63\u786e\u7ed3\u675f\uff0c\u4ea4\u4e92\u5668\u4f1a\u8f93\u5165 $1$\uff0c\u4f60\u5e94\u8be5\u5904\u7406\u4e0b\u4e00\u7ec4\u6570\u636e\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\uff0c\u5982\u679c $x\\not=y$\uff0c\u4ea4\u4e92\u5668\u4f1a\u8f93\u5165 $0$ \u540c\u65f6\u6539\u53d8 $x$ \u7684\u503c\uff0c$x$ \u7684\u503c\u4f1a\u53d8\u4e3a\u6574\u6570 $z$\uff0c\u5176\u4e2d $x\\oplus_kz=y$\u3002$T$ \u7ec4\u6570\u636e\u3002  \n$1\\leq T\\leq10^4;1\\leq n,\\sum n\\leq2\\times10^5;2\\leq k\\leq100;$"
}
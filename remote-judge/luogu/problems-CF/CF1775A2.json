{
    "description": "This is an hard version of the problem. The difference between the versions is that the string can be longer than in the easy version. You can only do hacks if both versions of the problem are passed.\n\nKazimir Kazimirovich is a Martian gardener. He has a huge orchard of binary balanced apple trees.\n\nRecently Casimir decided to get himself three capybaras. The gardener even came up with their names and wrote them down on a piece of paper. The name of each capybara is a non-empty line consisting of letters \"a\" and \"b\".\n\nDenote the names of the capybaras by the lines $ a $ , $ b $ , and $ c $ . Then Casimir wrote the nonempty lines $ a $ , $ b $ , and $ c $ in a row without spaces. For example, if the capybara's name was \"aba\", \"ab\", and \"bb\", then the string the gardener wrote down would look like \"abaabbb\".\n\nThe gardener remembered an interesting property: either the string $ b $ is lexicographically not smaller than the strings $ a $ and $ c $ at the same time, or the string $ b $ is lexicographically not greater than the strings $ a $ and $ c $ at the same time. In other words, either $ a \\le b $ and $ c \\le b $ are satisfied, or $ b \\le a $ and $ b \\le c $ are satisfied (or possibly both conditions simultaneously). Here $ \\le $ denotes the lexicographic \"less than or equal to\" for strings. Thus, $ a \\le b $ means that the strings must either be equal, or the string $ a $ must stand earlier in the dictionary than the string $ b $ . For a more detailed explanation of this operation, see \"Notes\" section.\n\nToday the gardener looked at his notes and realized that he cannot recover the names because they are written without spaces. He is no longer sure if he can recover the original strings $ a $ , $ b $ , and $ c $ , so he wants to find any triplet of names that satisfy the above property.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1775A2/30cfa18220110323978b8133a80acdeb63f8ace5.png)",
    "inputFormat": "Each test contains multiple test cases. The first line contains the number of test cases $ t $ ( $ 1 \\le t \\le 10^4 $ ). The description of the test cases follows.\n\nThe only line of a test case contains the string $ s $ ( $ 3 \\le |s| \\le 2 \\cdot 10^5 $ ) \u2014 the names of the capybaras, written together. The string consists of English letters 'a' and 'b' only.\n\nIt is guaranteed that the sum of string lengths over all test cases does not exceed $ 4 \\cdot 10^5 $ .",
    "outputFormat": "For each test case, print three strings $ a $ , $ b $ and $ c $ on a single line, separated by spaces \u2014 names of capybaras, such that writing them without spaces results in a line $ s $ . Either $ a \\le b $ and $ c \\le b $ , or $ b \\le a $ and $ b \\le c $ must be satisfied.\n\nIf there are several ways to restore the names, print any of them. If the names cannot be recovered, print \":(\" (without quotes).",
    "samples": [
        [
            "5\nbbba\naba\naaa\nabba\nabbb",
            "b bb a\na b a\na a a\nab b a\na bb b"
        ]
    ],
    "hint": "A string $ x $ is lexicographically smaller than a string $ y $ if and only if one of the following holds:\n\n- $ x $ is a prefix of $ y $ , but $ x \\ne y $ ;\n- in the first position where $ x $ and $ y $ differ, the string $ x $ has the letter 'a', and the string $ y $ has the letter 'b'.\n\nNow let's move on to the examples.\n\nIn the first test case, one of the possible ways to split the line $ s $ into three lines \u2014is \"b\", \"bb\", \"a\".\n\nIn the third test case, we can see that the split satisfies two conditions at once (i.e., $ a \\le b $ , $ c \\le b $ , $ b \\le a $ and $ b \\le c $ are true simultaneously).",
    "translation": "\u6709\u4e09\u4e2a\u53ea\u7531\u5b57\u7b26 `a,b` \u6784\u6210\u7684\u5b57\u7b26\u4e32 $a,b,c$ \uff0c\u4e14 $a\\le b,c\\le b$ \u6216 $a\\ge b,c\\ge b$\u3002 \u5c06\u5b83\u4eec\u62fc\u5728\u4e00\u8d77\u6784\u6210\u4e86\u4e00\u4e2a\u65b0\u5b57\u7b26\u4e32 $s$\u3002\n\n\n\u73b0\u5728\u7ed9\u4f60 $s$\uff0c($3\\le |s|\\le 2\\cdot 10^5$)\uff0c\u4f60\u8981\u590d\u539f\u8fd9\u4e09\u4e2a\u5b57\u7b26\u4e32\u3002\n\n\u4e00\u5171\u6709 $T(T\\le 10^4)$ \u7ec4\u6d4b\u8bd5\u6570\u636e\uff0c\u6240\u6709\u6570\u636e\u4e2d\u5b57\u7b26\u4e32\u7684\u603b\u957f\u4e0d\u4f1a\u8d85\u8fc7 $4\\cdot 10^5$\u3002\n\n### \u8f93\u5165\u683c\u5f0f\n\n\u7b2c\u4e00\u884c\uff0c\u4e00\u4e2a\u6570 $T$\u3002  \n\u63a5\u4e0b\u6765\u7684 $T$ \u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u5b57\u7b26\u4e32 $s$\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\n\n\u5bf9\u4e8e\u6bcf\u7ec4\u6d4b\u8bd5\u6570\u636e\uff0c\u8f93\u51fa\u4e00\u884c\u4e09\u4e2a\u5b57\u7b26\u4e32\uff0c\u7528\u7a7a\u683c\u9694\u5f00\uff0c\u8868\u793a\u62c6\u51fa\u7684\u4e09\u4e2a\u5b57\u7b26\u4e32\u3002\n\n\u5982\u679c\u6709\u591a\u79cd\u62c6\u5206\u65b9\u5f0f\uff0c\u8f93\u51fa\u4efb\u610f\u4e00\u79cd\u3002\n\n\u5982\u679c\u65e0\u6cd5\u62c6\u5206\uff0c\u5219\u8f93\u51fa `:(`\u3002\n\n### \u8bf4\u660e/\u63d0\u793a\n\n\u5b9a\u4e49\u5b57\u7b26\u4e32 $x$ \u5c0f\u4e8e $y$ \uff0c\u5f53\u4e14\u4ec5\u5f53\uff1a\n\n$x$ \u662f $y$ \u7684\u524d\u7f00\uff0c\u4e14 $x \\not =y$ \u3002\n\n\u6216\n\n\u5728 $x$ \u4e0e $y$ \u7684\u7b2c\u4e00\u4e2a\u4e0d\u540c\u7684\u4f4d\u7f6e\uff0c$x$ \u7684\u8fd9\u4e00\u4f4d\u5b57\u7b26\u662f `a`\uff0c$y$ \u7684\u8fd9\u4e00\u4f4d\u5b57\u7b26\u662f `b`\u3002"
}
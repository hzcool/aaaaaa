{
    "description": "You are given a rooted tree consisting of $ n $ vertices numbered from $ 1 $ to $ n $ . Vertex $ 1 $ is the root of the tree. Each vertex has an integer value. The value of $ i $ -th vertex is $ a_i $ . You can do the following operation at most $ k $ times.\n\n- Choose a vertex $ v $ that has not been chosen before and an integer $ x $ such that $ x $ is a common divisor of the values of all vertices of the subtree of $ v $ . Multiply by $ x $ the value of each vertex in the subtree of $ v $ .\n\nWhat is the maximum possible value of the root node $ 1 $ after at most $ k $ operations? Formally, you have to maximize the value of $ a_1 $ .\n\nA tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root. The subtree of a node $ u $ is the set of all nodes $ y $ such that the simple path from $ y $ to the root passes through $ u $ . Note that $ u $ is in the subtree of $ u $ .",
    "inputFormat": "The first line contains an integer $ t $ ( $ 1 \\leq t \\leq 50\\,000 $ ) \u2014 the number of test cases. The description of the test cases follows.\n\nThe first line of each test case contains two integers $ n $ and $ k $ ( $ 2 \\leq n \\leq 10^5 $ , $ 0 \\leq k \\leq n $ ) \u2014 the number of vertices in the tree and the number of operations.\n\nThe second line contains $ n $ integers $ a_1, a_2, \\ldots, a_n $ ( $ 1 \\leq a_i \\leq 1000 $ ), where $ a_i $ denotes the value of vertex $ i $ .\n\nEach of the next $ n - 1 $ lines contains two integers $ u_i $ and $ v_i $ ( $ 1 \\leq u_i, v_i \\leq n $ , $ u_i \\neq v_i $ ), denoting the edge of the tree between vertices $ u_i $ and $ v_i $ . It is guaranteed that the given edges form a tree.\n\nIt is guaranteed that the sum of $ n $ over all test cases does not exceed $ 2 \\cdot 10^5 $ .",
    "outputFormat": "For each test case, output the maximum value of the root after performing at most $ k $ operations.",
    "samples": [
        [
            "2\n5 2\n24 12 24 6 12\n1 2\n1 3\n2 4\n2 5\n5 3\n24 12 24 6 12\n1 2\n1 3\n2 4\n2 5",
            "288\n576"
        ]
    ],
    "hint": "Both examples have the same tree:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1778F/6a70ae0aa91307af0a5148283774844759a80b11.png)For the first test case, you can do two operations as follows:\n\n- Choose the subtree of vertex $ 4 $ and $ x = 2 $ .  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1778F/efd9ed3fe3fe146d2c3ad22bdc3a0d5094263862.png)  After this operation, the node values become $ \\{24, 12, 24, 12, 12\\}. $\n- Choose the subtree of vertex $ 1 $ and $ x = 12 $ .  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1778F/448b3697478f6bf92a71b275bb4b714ad3a39227.png)  After this operation, the node values become $ \\{288, 144, 288, 144, 144\\}. $\n\n The value of the root is $ 288 $ and it is the maximum.For the second test case, you can do three operations as follows:\n\n- Choose the subtree of vertex $ 4 $ and $ x = 2 $ .  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1778F/efd9ed3fe3fe146d2c3ad22bdc3a0d5094263862.png)  After this operation, the node values become $ \\{24, 12, 24, 12, 12\\}. $\n- Choose the subtree of vertex $ 2 $ and $ x = 4 $ .  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1778F/7004889d13c9800ff61e810a176c843b3201729c.png)  After this operation, the node values become $ \\{24, 48, 24, 48, 48\\}. $\n- Choose the subtree of vertex $ 1 $ and $ x = 24 $ .  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1778F/33e11b130545753fb9dc63bbfb2deaf72c859447.png)  After this operation, the node values become $ \\{576, 1152, 576, 1152, 1152\\}. $\n\n The value of the root is $ 576 $ and it is the maximum.",
    "translation": "\u4f60\u6709\u4e00\u9897\u6709\u6839\u6811\uff0c\u6709 $n$ \u4e2a\u8282\u70b9\uff0c\u7f16\u53f7\u4e3a $1 \\sim n$\u3002\n\n\u7b2c $i$ \u4e2a\u9876\u70b9\u7684\u6743\u503c\u662f $a_i$\uff0c\u4f60\u53ef\u4ee5\u8fdb\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n\n+ \u9009\u62e9\u4e00\u4e2a\u4e4b\u524d\u6ca1\u9009\u8fc7\u7684\u8282\u70b9 $v$\uff0c\u4ee5\u53ca\u4e00\u4e2a\u6b63\u6574\u6570 $x$\uff0c\u9700\u8981\u6ee1\u8db3 $x$ \u662f $v$ \u5b50\u6811\u5185\u6240\u6709\u70b9\u7684\u6743\u503c\u7684\u516c\u7ea6\u6570\uff0c\u7136\u540e\u4ee4\u6240\u6709 $v$ \u5b50\u6811\u5185\u7684\u8282\u70b9\u7684\u6743\u503c\u90fd\u4e58 $x$\u3002\n\n\u95ee\u5728\u64cd\u4f5c $\\le k$ \u6b21\u540e $a_1$ \u7684\u6700\u5927\u53ef\u80fd\u503c\u662f\u591a\u5c11\uff1f\n\nTranslated by [Tx_Lcy](https://www.luogu.com.cn/user/253608)"
}
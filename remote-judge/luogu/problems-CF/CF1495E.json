{
    "description": "Qingshan and Daniel are going to play a card game. But it will be so boring if only two persons play this. So they will make $ n $ robots in total to play this game automatically. Robots made by Qingshan belong to the team $ 1 $ , and robots made by Daniel belong to the team $ 2 $ . Robot $ i $ belongs to team $ t_i $ . Before the game starts, $ a_i $ cards are given for robot $ i $ .\n\nThe rules for this card game are simple:\n\n- Before the start, the robots are arranged in a circle in the order or their indices. The robots will discard cards in some order, in each step one robot discards a single card. When the game starts, robot $ 1 $ will discard one of its cards. After that, robots will follow the following rules:\n- If robot $ i $ discards the card last, the nearest robot whose team is opposite from $ i $ 's will discard the card next. In another word $ j $ will discard a card right after $ i $ , if and only if among all $ j $ that satisfy $ t_i\\ne t_j $ , $ dist(i,j) $ (definition is below) is minimum.\n- The robot who has no cards should quit the game immediately. This robot won't be considered in the next steps.\n- When no robot can discard the card next, the game ends.\n\nWe define the distance from robot $ x $ to robot $ y $ as $ dist(x,y)=(y-x+n)\\bmod n $ . It is similar to the oriented distance on the circle.\n\nFor example, when $ n=5 $ , the distance from $ 1 $ to $ 3 $ is $ dist(1,3)=(3-1+5)\\bmod 5=2 $ , the distance from $ 3 $ to $ 1 $ is $ dist(3,1)=(1-3+5)\\bmod 5 =3 $ .\n\nLater, Qingshan finds out that it will take so much time to see how robots play. She wants to know the result as quickly as possible. You, as Qingshan's fan, are asked to calculate an array $ [ans_1,ans_2,\\ldots,ans_n] $ \u2014 $ ans_i $ is equal to the number of cards, that $ i $ -th robot will discard during the game. You need to hurry!\n\nTo avoid the large size of the input, the team and the number of cards of each robot will be generated in your code with some auxiliary arrays.",
    "inputFormat": "The first line contains one integer $ n $ ( $ 1 \\le n \\le 5\\cdot 10^6 $ ) \u2014 the number of robots playing this game.\n\nThe second line contains one integer $ m $ ( $ 1 \\le m \\le \\min(n,200\\,000) $ ).\n\nEach of the next $ m $ line contains four integers $ p_i $ , $ k_i $ , $ b_i $ , $ w_i $ ( $ 1 \\le p_i \\le n $ , $ 1 \\le k_i \\le 10^9+7 $ , $ 0 \\le b_i ,w_i< k_i $ ). It's guaranteed that $ p_m=n $ and $ p_{j-1}<p_{j} $ ( $ 2 \\le j \\le n $ ).\n\nArrays $ a_j $ and $ t_j $ should be generated by the following pseudo code:\n\n```\nseed = 0\nbase = 0\n\nfunction rnd():\n    ret = seed\n    seed = (seed * base + 233) mod 1000000007\n    return ret\n\np[0] = 0\nfor i = 1 to m:\n    seed = b[i]\n    base = w[i]\n    for j = p[i - 1] + 1 to p[i]:\n        t[j] = (rnd() mod 2) + 1\n        a[j] = (rnd() mod k[i]) + 1\n```",
    "outputFormat": "Print a single integer $ \\left( \\prod_{i=1}^{n} ((ans_i \\oplus i^2)+1)\\right) \\bmod 10^9+7 $ , where $ \\oplus $ denotes the [bitwise XOR operation](https://en.wikipedia.org/wiki/Bitwise_operation#XOR).",
    "samples": [
        [
            "3\n3\n1 5 2 3\n2 7 1 2\n3 2 1 1",
            "100"
        ],
        [
            "5000000\n2\n1919810 998244353 114514 19260817\n5000000 233333333 623532 7175",
            "800210675"
        ],
        [
            "1\n1\n1 1 0 0",
            "1"
        ]
    ],
    "hint": "In the first test case $ a=[5,5,1] $ and $ t=[1,2,2] $ .\n\nThe robot $ 1 $ discards the card first.\n\nThen robot $ 2 $ discards the card next. Robot $ 3 $ doesn't discard the card next because $ dist(1,2)<dist(1,3) $ .\n\nThen robot $ 1 $ discards the card next. Robot $ 3 $ doesn't discard the card next because $ t_2=t_3 $ .\n\nIf we write down the index of the robot who discards a card in time order, it will be the sequence $ [1,2,1,2,1,2,1,2] $ . So robots $ 1 $ , $ 2 $ and $ 3 $ discard $ 5 $ , $ 5 $ and $ 0 $ cards, respectively. And the answer is $ (((5 \\oplus 1^2)+1)\\times((5 \\oplus 2^2)+1)\\times((0 \\oplus 3^2)+1)) \\bmod 10^9+7=(5\\times 2 \\times 10)\\bmod 10^9+7=100 $ .",
    "translation": "$n$ \u4e2a\u673a\u5668\u4eba\u7ad9\u5728\u4e00\u4e2a\u73af\u4e0a\u6253\u4e09\u56fd\u6740\uff0c\u7b2c $i\\ (1 \\le i < n)$ \u4e2a\u673a\u5668\u4eba\u7684\u76f8\u90bb\u53f3\u4fa7\u7ad9\u7740 $i+1$ \u53f7\u673a\u5668\u4eba\u3002\u7279\u522b\u5730\uff0c$n$ \u53f7\u673a\u5668\u4eba\u7684\u76f8\u90bb\u53f3\u4fa7\u662f $1$ \u53f7\u673a\u5668\u4eba\u3002\n\n\u673a\u5668\u4eba\u5206\u4e24\u4e2a\u9635\u8425\uff0c\u7b2c $i$ \u4e2a\u673a\u5668\u4eba\u5c5e\u4e8e\u9635\u8425 $t_i$\uff0c\u521d\u59cb\u6709 $a_i$ \u5f20\u3010\u65e0\u61c8\u53ef\u51fb\u3011\u3002\n\n\u6e38\u620f\u4f1a\u4ee5\u5982\u4e0b\u65b9\u5f0f\u8fdb\u884c\uff1a\n\n- \u521d\u59cb $1$ \u53f7\u673a\u5668\u4eba\u6253\u51fa\u4e00\u5f20\u624b\u724c\u3002\n- \u5047\u8bbe\u6700\u8fd1\u4e00\u6b21\u51fa\u3010\u65e0\u61c8\u53ef\u51fb\u3011\u7684\u673a\u5668\u4eba\u662f $i$\uff0c\u627e\u5230\u5b83\u53f3\u4fa7\u79bb\u5b83\u6700\u8fd1\u4e0e\u5b83\u4e0d\u540c\u9635\u8425\u7684\u62e5\u6709\u724c\u7684\u673a\u5668\u4eba $j$\uff0c$j$  \u51fa\u4e00\u5f20\u3010\u65e0\u61c8\u53ef\u51fb\u3011\u3002\n- \u5f53\u65e0\u4eba\u80fd\u51fa\u724c\u65f6\u6e38\u620f\u505c\u6b62\u3002\n\n\u6c42\u6bcf\u4e00\u4e2a\u673a\u5668\u4eba\u6700\u7ec8\u51fa\u4e86\u591a\u5c11\u5f20\u65e0\u61c8\u53ef\u51fb\u3002\n\nImakf \u7ed9\u60a8\u7684\u8f93\u5165\u8f93\u51fa\u683c\u5f0f\u5747\u8fdb\u884c\u4e86\u538b\u7f29\uff0c\u8bf7\u81ea\u884c\u67e5\u770b\u3002"
}
{
    "description": "Railway network of one city consists of $ n $ stations connected by $ n-1 $ roads. These stations and roads forms a tree. Station $ 1 $ is a city center. For each road you know the time trains spend to pass this road. You can assume that trains don't spend time on stops. Let's define $ dist(v) $ as the time that trains spend to get from the station $ v $ to the station $ 1 $ .\n\nThis railway network is splitted into zones named by first $ k $ capital latin letters. The zone of the $ i $ -th station is $ z_i $ . City center is in the zone A. For all other stations it is guaranteed that the first station on the road from this station to the city center is either in the same zone or in the zone with lexicographically smaller name. Any road is completely owned by the zone of the most distant end from the city center.\n\nTourist will arrive at the airport soon and then he will go to the city center. Here's how the trip from station $ v $ to station $ 1 $ happends:\n\n- At the moment $ 0 $ , tourist enters the train that follows directly from the station $ v $ to the station $ 1 $ . The trip will last for $ dist(v) $ minutes.\n- Tourist can buy tickets for any subset of zones at any moment. Ticket for zone $ i $ costs $ pass_i $ euro.\n- Every $ T $ minutes since the start of the trip (that is, at the moments $ T, 2T, \\ldots $ ) the control system will scan tourist. If at the moment of scan tourist is in the zone $ i $ without zone $ i $ ticket, he should pay $ fine_i $ euro. Formally, the zone of tourist is determined in the following way: \n  - If tourist is at the station $ 1 $ , then he already at the city center so he shouldn't pay fine.\n  - If tourist is at the station $ u \\neq 1 $ , then he is in the zone $ z_u $ .\n  - If tourist is moving from the station $ x $ to the station $ y $ that are directly connected by road, then he is in the zone $ z_x $ .\n  \n   Note, that tourist can pay fine multiple times in the same zone.\n\nTourist always selects such way to buy tickets and pay fines that minimizes the total cost of trip. Let $ f(v) $ be such cost for station $ v $ .\n\nUnfortunately, tourist doesn't know the current values of $ pass_i $ and $ fine_i $ for different zones and he has forgot the location of the airport. He will ask you queries of $ 3 $ types:\n\n- $ 1 $ $ i $ $ c $ \u2014 the cost of ticket in zone $ i $ has changed. Now $ pass_i $ is $ c $ .\n- $ 2 $ $ i $ $ c $ \u2014 the cost of fine in zone $ i $ has changed. Now $ fine_i $ is $ c $ .\n- $ 3 $ $ u $ \u2014 solve the following problem for current values of $ pass $ and $ fine $ : \n  - You are given the station $ u $ . Consider all the stations $ v $ that satisfy the following conditions: \n      - $ z_v = z_u $\n      - The station $ u $ is on the path from the station $ v $ to the station $ 1 $ .\n      \n       Find the value of $ \\min(f(v)) $ over all such stations $ v $ with the following assumption: tourist has the ticket for the zone of station $ z_u $ .",
    "inputFormat": "The first line contains the single integer $ n $ ( $ 2 \\leq n \\leq 2 \\cdot 10^5 $ ) \u2014 the number of stations.\n\nEach of the next $ n - 1 $ lines contains three integers $ v_i $ , $ u_i $ , $ t_i $ ( $ 1 \\leq v_i, u_i \\leq n, 1 \\leq t_i \\leq 10^9 $ ) \u2014 the ends of the $ i $ -th road and the time it takes a train to pass this road. It is guaranteed that this roads forms a tree.\n\nThe next line contains the single integer $ k $ ( $ 1 \\leq k \\leq 26 $ ) \u2014 the number of zones.\n\nThe next line contains $ n $ symbols $ z_1z_2 \\ldots z_n $ \u2014 $ z_i $ is the name of the zone of the $ i $ -th station. It is guaranteed that the conditions from the second paragraph are satisfied.\n\nThe next line contains $ k $ integers $ pass_1 $ , $ pass_2 $ , $ \\ldots $ , $ pass_k $ ( $ 1 \\leq pass_i \\leq 10^9 $ ) \u2014 initial costs of tickets.\n\nThe next line contains $ k $ integers $ fine_1 $ , $ fine_2 $ , $ \\ldots $ , $ fine_k $ ( $ 1 \\leq fine_i \\leq 10^9 $ ) \u2014 initial fines.\n\nThe next line contains the single integer $ T $ ( $ 1 \\leq T \\leq 10^9 $ ) \u2014 the time gap between scans of control system.\n\nThe next line contains the single integer $ q $ ( $ 1 \\leq q \\leq 2 \\cdot 10^5 $ ) \u2014 the number of queries.\n\nNext $ q $ lines contains queries as described in the statement. It is guaranteed that in the queries of the first and the second type $ i $ is a correct name of the zone (one of the first $ k $ capital latin letters) and $ 1 \\leq c \\leq 10^9 $ , and in the queries of the third type $ 1 \\leq u \\leq n $ .",
    "outputFormat": "For each query of the third type print the answer to it.",
    "samples": [
        [
            "8\n1 2 7\n2 3 4\n2 4 3\n4 5 1\n5 6 6\n4 7 10\n6 8 6\n4\nAABABBDB\n11 12 10 42\n16 15 15 30\n4\n6\n3 2\n1 A 10\n3 3\n2 A 3\n3 7\n3 6",
            "0\n10\n6\n6"
        ]
    ],
    "hint": "Note, that the fine can be cheaper than the pass.\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1621H/4e226e553ba13e8de0d8153a06db90731a339f4a.png)The railway network from the example. Green color is used for stations and roads of zone A, blue color is used for zone B and red color is used for zone D. The integer near each road is time that trains spend to pass it.In the first query, the airport can be located near the station $ 2 $ or near the station $ 4 $ . During the trip, tourist will always stay in the zone A. He already has the pass for this zone so the answer is $ 0 $ .\n\nAfter the second query, the cost of the pass in the zone A has become $ 10 $ .\n\nIn the third query, the airport can be located only near the station $ 3 $ . Optimal solution will be to buy the pass for zone A. During the first $ 3 $ seconds of trip tourist will be in the zone B. Then he will move to the zone A and will be scanned there on the $ 4 $ -th and the $ 8 $ -th second of his ride. Since he have a pass for this zone, he won't pay fines.\n\nAfter the forth query, the fine in the zone A has become $ 3 $ .\n\nIn the fifth query, the airport can be located only near the station $ 7 $ and $ f(7) = 6 $ .\n\nIn the sixth query, the airport can be located near the station $ 6 $ or near the station $ 8 $ . Since $ f(6)=9 $ and $ f(8)=6 $ the answer is $ 6 $ .",
    "translation": "A \u57ce\u7684\u94c1\u8def\u7cfb\u7edf\u7531 $n$ \u4e2a\u7ad9\u70b9\u548c $n-1$ \u6761\u94c1\u8def\u7ec4\u6210\uff0c\u8fd9\u4e9b\u7ad9\u70b9\u548c\u94c1\u8def\u5171\u540c\u7ec4\u6210\u4e86\u4e00\u68f5\u6811\u3002\u7ad9\u70b9 $1$ \u662f\u5e02\u4e2d\u5fc3\u3002\u5bf9\u4e8e\u7b2c $i$ \u6761\u94c1\u8def\uff0c\u4f60\u90fd\u77e5\u9053\u5b83\u8fde\u63a5\u7684\u4e24\u4e2a\u7ad9\u70b9 $v_i,u_i$ \u4ee5\u53ca\u706b\u8f66\u7ecf\u8fc7\u5b83\u9700\u8981\u7684\u65f6\u95f4 $t_i$\uff0c\u5e76\u4e14\u4f60\u53ef\u4ee5\u5047\u8bbe**\u706b\u8f66\u505c\u9760\u7ad9\u70b9\u4e0d\u9700\u8981\u65f6\u95f4**\u3002\u6211\u4eec\u5b9a\u4e49 $dist(v)$ \u4e3a\u4ece\u7ad9\u70b9 $v$ \u5750\u706b\u8f66\u5230\u7ad9\u70b9 $1$ \u9700\u8981\u7684\u65f6\u95f4\u3002\n\n\u4e0e\u6b64\u540c\u65f6\uff0cA \u57ce\u7684\u94c1\u8def\u7cfb\u7edf\u88ab\u5206\u6210\u4e86 $k$ \u4e2a\u533a\u57df\uff0c\u6bcf\u4e2a\u533a\u57df\u4ee5\u5b57\u6bcd\u8868\u4e2d\u524d $k$ \u4e2a\u5927\u5199\u5b57\u6bcd\u4e2d\u7684\u4e00\u4e2a\u547d\u540d\u3002\u7ad9\u70b9 $i$ \u6240\u5728\u7684\u533a\u57df\u4e3a $z_i$\uff0c\u7ad9\u70b9 $1$ \u5728\u533a\u57df A\u3002\u5bf9\u4e8e\u6240\u6709\u5176\u4ed6\u7684\u7ad9\u70b9\uff0c\u4fdd\u8bc1\u4ece\u8be5\u7ad9\u70b9\u5230\u7ad9\u70b9 $1$ \u7684\u8def\u5f84\u4e0a\u7ecf\u8fc7\u7684\u7b2c\u4e00\u4e2a\u7ad9\u70b9\u6240\u5728\u7684\u533a\u57df\u540d\u548c\u8be5\u7ad9\u70b9\u76f8\u540c\u6216\u8005\u662f\u6bd4\u8be5\u7ad9\u70b9\u6240\u5728\u7684\u533a\u57df\u540d\u7684\u5b57\u5178\u5e8f\u5c0f\u7684\u5927\u5199\u5b57\u6bcd\u3002**\u4efb\u4f55\u4e00\u6761\u94c1\u8def\u90fd\u5b8c\u5168\u5c5e\u4e8e\u79bb\u5e02\u4e2d\u5fc3\u6700\u8fdc\u7684\u7ad9\u70b9\u6240\u5728\u7684\u533a\u57df**\u3002\n\n$\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u6155\u540d\u524d\u5f80 A \u57ce\uff0c\u4ed6\u5230\u8fbe\u673a\u573a\u4e4b\u540e\u5c06\u524d\u5f80\u5e02\u4e2d\u5fc3\u6e38\u89c8\u3002\u4ed6\u4ece\u7ad9\u70b9 $v$ \u5230\u7ad9\u70b9 $1$ \u7684\u884c\u7a0b\u53ef\u80fd\u662f\u8fd9\u6837\u7684\uff1a\n\n- \u5728 $0$ \u65f6\u523b\uff0c$\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u8fdb\u5165\u4ece\u7ad9\u70b9 $v$ \u76f4\u8fbe\u7ad9\u70b9 $1$ \u7684\u706b\u8f66\uff0c\u884c\u7a0b\u5c06\u6301\u7eed $dist(v)$ \u5206\u949f\u3002\n- \u5728\u4efb\u610f\u65f6\u523b\uff0c$\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u53ef\u4ee5\u4e70\u4efb\u610f\u51e0\u4e2a\u533a\u57df\u7684\u8f66\u7968\u3002\u7b2c $i$ \u4e2a\u533a\u57df\u7684\u8f66\u7968\u4ef7\u683c\u4e3a $pass_i$ \u6b27\u5143\u3002\n- \u6bcf $T$ \u4e2a\u65f6\u523b\uff0c\u63a7\u5236\u7cfb\u7edf\u5c06\u4f1a\u626b\u63cf $\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$\u3002\u5982\u679c\u6b64\u65f6 $\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u5728\u533a\u57df $i$ \u800c\u6ca1\u6709\u533a\u57df $i$ \u7684\u8f66\u7968\uff0c\u4ed6\u5c06\u4ed8 $fine_i$ \u6b27\u5143\u7684\u7f5a\u91d1\u3002\u6ce8\u610f\uff0c\u5728\u540c\u4e00\u4e2a\u533a\u57df\uff0c$\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u53ef\u80fd\u4f1a\u4ea4\u591a\u6b21\u7f5a\u91d1\u3002\u5f62\u5f0f\u5316\u7684\u8bf4\uff0c$\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u6240\u5728\u7684\u533a\u57df\u7531\u4ee5\u4e0b\u65b9\u5f0f\u51b3\u5b9a\uff1a\n    - \u5982\u679c $\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u5728\u7ad9\u70b9 $1$\uff0c\u5219\u4ed6\u5df2\u7ecf\u5230\u8fbe\u4e86\u5e02\u4e2d\u5fc3\uff0c\u56e0\u6b64\u4ed6\u4e0d\u9700\u8981\u4ea4\u4efb\u4f55\u7f5a\u91d1\u3002\n    - \u5982\u679c $\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u5728\u7ad9\u70b9 $u(u\\neq 1)$\uff0c\u5219\u4ed6\u5728\u533a\u57df $z_u$\u3002\n    - \u5982\u679c $\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u5728\u4ece\u7ad9\u70b9 $x$ \u5230\u7ad9\u70b9 $y$ \u7684\u4e00\u6761\u94c1\u8def\u4e0a\uff0c\u5219\u4ed6\u5728\u533a\u57df $z_x$\u3002\n\n\u7531\u4e8e $\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u5f88\u5f3a\uff0c\u56e0\u6b64\u4ed6\u77e5\u9053\u5982\u4f55\u8d2d\u4e70\u8f66\u7968\u548c\u652f\u4ed8\u7f5a\u91d1\u6765\u6700\u5c0f\u5316\u6574\u4e2a\u884c\u7a0b\u7684\u82b1\u8d39\u3002\u5b9a\u4e49 $f(v)$ \u4e3a $\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u4ece\u7ad9\u70b9 $v$ \u51fa\u53d1\u5230\u7ad9\u70b9 $1$ \u7684\u6700\u5c0f\u82b1\u8d39\u3002\u4e0d\u5e78\u7684\u662f\uff0c$\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u5e76\u4e0d\u77e5\u9053\u5f53\u524d $pass_i$ \u548c $fine_i$ \u7684\u503c\uff0c\u800c\u4e14\u4ed6\u4e5f\u5fd8\u8bb0\u4e86\u673a\u573a\u5728\u54ea\u4e00\u4e2a\u7ad9\u70b9\u3002\u56e0\u6b64\uff0c\u4ed6\u4f1a\u5411\u4f60\u63d0\u51fa $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u4ed6\u53ef\u4ee5\u5411\u4f60\u63d0\u51fa\u5982\u4e0b\u4e09\u79cd\u8be2\u95ee\u4e2d\u7684\u4e00\u79cd\uff1a\n\n- `1 i c`\uff1a\u5c06 $pass_i$ \u66ff\u6362\u4e3a $c$\u3002\n- `2 i c`\uff1a\u5c06 $fine_i$ \u66ff\u6362\u4e3a $c$\u3002\n- `3 u`\uff1a\u4f9d\u7167\u5f53\u524d\u7684 $pass$ \u548c $fine$ \u6570\u7ec4\u7684\u503c\u89e3\u51b3\u4e0b\u5217\u95ee\u9898\uff1a\n    - \u7ed9\u5b9a\u4e00\u4e2a\u7ad9\u70b9\u7684\u7f16\u53f7 $u$\uff0c\u5047\u8bbe $\\color{black}\\textsf{t}\\color{red}\\textsf{ourist}$ \u5df2\u7ecf\u4e70\u597d\u4e86\u533a\u57df $z_u$ \u7684\u8f66\u7968\u3002\u5bf9\u4e8e\u6240\u6709\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\u7684 $v$\uff1a\n        - $z_u=z_v$\uff1b\n        - \u7ad9\u70b9 $u$ \u5728\u4ece\u7ad9\u70b9 $v$ \u5230\u7ad9\u70b9 $1$ \u7684\u8def\u5f84\u4e0a\u3002\n        \n    \n    \u6c42 $\\min(f(v))$\u3002\n\n\u8bf7\u4f60\u5b8c\u6210\u8fd9 $q$ \u6b21\u8be2\u95ee\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a\n\n- $2\\leqslant n\\leqslant 2\\times 10^5$\uff0c$1\\leqslant k\\leqslant 26$\uff0c$1\\leqslant T\\leqslant 10^9$\uff0c$1\\leqslant q\\leqslant 2\\times 10^5$\u3002\n- $1\\leqslant t_i,pass_i,fine_i,c\\leqslant 10^9$\uff0c$1\\leqslant v_i,u_i\\leqslant n$\u3002\n\nTranslated by Eason_AC  \n2022.1.4"
}
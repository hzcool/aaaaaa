{
    "description": "The company $ X $ has $ n $ employees numbered from $ 1 $ through $ n $ . Each employee $ u $ has a direct boss $ p_u $ ( $ 1 \\le p_u \\le n $ ), except for the employee $ 1 $ who has no boss. It is guaranteed, that values $ p_i $ form a tree. Employee $ u $ is said to be in charge of employee $ v $ if $ u $ is the direct boss of $ v $ or there is an employee $ w $ such that $ w $ is in charge of $ v $ and $ u $ is the direct boss of $ w $ . Also, any employee is considered to be in charge of himself.\n\nIn addition, for each employee $ u $ we define it's level $ lv(u) $ as follow:\n\n- $ lv(1)=0 $\n- $ lv(u)=lv(p_u)+1 $ for $ u \\neq 1 $\n\nIn the near future, there are $ q $ possible plans for the company to operate. The $ i $ -th plan consists of two integers $ l_i $ and $ r_i $ , meaning that all the employees in the range $ [l_i, r_i] $ , and only they, are involved in this plan. To operate the plan smoothly, there must be a project manager who is an employee in charge of all the involved employees. To be precise, if an employee $ u $ is chosen as the project manager for the $ i $ -th plan then for every employee $ v \\in [l_i, r_i] $ , $ u $ must be in charge of $ v $ . Note, that $ u $ is not necessary in the range $ [l_i, r_i] $ . Also, $ u $ is always chosen in such a way that $ lv(u) $ is as large as possible (the higher the level is, the lower the salary that the company has to pay the employee).\n\nBefore any plan is operated, the company has JATC take a look at their plans. After a glance, he tells the company that for every plan, it's possible to reduce the number of the involved employees exactly by one without affecting the plan. Being greedy, the company asks JATC which employee they should kick out of the plan so that the level of the project manager required is as large as possible. JATC has already figured out the answer and challenges you to do the same.",
    "inputFormat": "The first line contains two integers $ n $ and $ q $ ( $ 2 \\le n \\le 100\\,000 $ , $ 1 \\le q \\le 100\\,000 $ ) \u2014 the number of employees and the number of plans, respectively.\n\nThe second line contains $ n-1 $ integers $ p_2, p_3, \\dots, p_n $ ( $ 1 \\le p_i \\le n $ ) meaning $ p_i $ is the direct boss of employee $ i $ .\n\nIt is guaranteed, that values $ p_i $ form a directed tree with the root of $ 1 $ .\n\nEach of the following $ q $ lines contains two integers $ l_i $ and $ r_i $ ( $ 1 \\le l_i<r_i \\le n $ ) \u2014 the range of the employees, involved in the corresponding plan.",
    "outputFormat": "Print $ q $ lines, each containing two integers \u2014 the number of the employee which should be kicked from the corresponding plan and the maximum possible level of the project manager in that case.\n\nIf there are more than one way to choose that employee, print any of them.",
    "samples": [
        [
            "11 5\n1 1 3 3 3 4 2 7 7 6\n4 6\n4 8\n1 11\n9 11\n8 11\n",
            "4 1\n8 1\n1 0\n11 3\n8 1\n"
        ]
    ],
    "hint": "In the example:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1062E/4564b9c828c9be95a53a01799338a14403d69e77.png) In the first query, we can choose whether $ 4 $ or $ 5 $ or $ 6 $ and the project manager will be $ 3 $ .In the second query, if we choose any employee other than the employee $ 8 $ , the project manager will be $ 1 $ . If we choose $ 8 $ , the project manager will be $ 3 $ . Since $ lv(3)=1 > lv(1)=0 $ , choosing $ 8 $ is the best strategy.\n\nIn the third query, no matter how we choose the employee, the project manager will always be $ 1 $ .\n\nIn the fourth query, if we choose $ 9 $ or $ 10 $ then the project manager will be $ 3 $ . If we choose $ 11 $ then the project manager will be $ 7 $ . Since $ lv(7)=3>lv(3)=1 $ , we choose $ 11 $ as the answer.",
    "translation": "\u7ed9\u5b9a\u4e00\u9897\u6811\uff0c\u6709\u82e5\u5e72\u4e2a\u8be2\u95ee\uff0c\u6bcf\u4e2a\u8be2\u95ee\u7ed9\u51fa $l$\uff0c$r$\uff0c\u8981\u6c42\u7f16\u53f7\u4e3a $l$~$r$ \u7684\u70b9\u4efb\u610f\u5220\u53bb\u4e00\u4e2a\u4e4b\u540e\u5269\u4f59\u70b9\u7684 $LCA$ \u6df1\u5ea6\u6700\u5927\uff0c\u8f93\u51fa\u5220\u53bb\u70b9\u7684\u7f16\u53f7\u548c $LCA$ \u7684\u6700\u5927\u6df1\u5ea6"
}
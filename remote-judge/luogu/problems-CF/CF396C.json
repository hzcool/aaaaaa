{
    "description": "You are given a rooted tree consisting of $ n $ vertices numbered from $ 1 $ to $ n $ . The root of the tree is a vertex number $ 1 $ .\n\nInitially all vertices contain number $ 0 $ . Then come $ q $ queries, each query has one of the two types:\n\n- The format of the query: $ 1 $ $ v $ $ x $ $ k $ . In response to the query, you need to add to the number at vertex $ v $ number $ x $ ; to the numbers at the descendants of vertex $ v $ at distance $ 1 $ , add $ x-k $ ; and so on, to the numbers written in the descendants of vertex $ v $ at distance $ i $ , you need to add $ x-(i\u00b7k) $ . The distance between two vertices is the number of edges in the shortest path between these vertices.\n- The format of the query: $ 2 $ $ v $ . In reply to the query you should print the number written in vertex $ v $ modulo $ 1000000007 $ $ (10^{9}+7) $ .\n\nProcess the queries given in the input.",
    "inputFormat": "The first line contains integer $ n $ ( $ 1<=n<=3\u00b710^{5} $ ) \u2014 the number of vertices in the tree. The second line contains $ n-1 $ integers $ p_{2},p_{3},...\\ p_{n} $ ( $ 1<=p_{i}&lt;i $ ), where $ p_{i} $ is the number of the vertex that is the parent of vertex $ i $ in the tree.\n\nThe third line contains integer $ q $ ( $ 1<=q<=3\u00b710^{5} $ ) \u2014 the number of queries. Next $ q $ lines contain the queries, one per line. The first number in the line is $ type $ . It represents the type of the query. If $ type=1 $ , then next follow space-separated integers $ v,x,k $ ( $ 1<=v<=n $ ; $ 0<=x&lt;10^{9}+7 $ ; $ 0<=k&lt;10^{9}+7 $ ). If $ type=2 $ , then next follows integer $ v $ ( $ 1<=v<=n $ ) \u2014 the vertex where you need to find the value of the number.",
    "outputFormat": "For each query of the second type print on a single line the number written in the vertex from the query. Print the number modulo $ 1000000007 $ $ (10^{9}+7) $ .",
    "samples": [
        [
            "3\n1 1\n3\n1 1 2 1\n2 1\n2 2\n",
            "2\n1\n"
        ]
    ],
    "hint": "You can read about a rooted tree here: http://en.wikipedia.org/wiki/Tree\\_(graph\\_theory).",
    "translation": "\u4f60\u5728\u7eb8\u4e0a\u753b\u4e86\u4e00\u68f5\u6709n\u4e2a\u70b9\u7684\u6709\u6839\u6811\uff0c\u6811\u7684\u6839\u7f16\u53f7\u4e3a1.\r\n\u4e00\u5f00\u59cb\u6bcf\u4e2a\u8282\u70b9\u4e0a\u9762\u7684\u503c\u90fd\u4e3a0\u3002\r\n\r\n\u73b0\u5728\u6709q\u4e2a\u8be2\u95ee\uff0c\u6bcf\u4e2a\u8be2\u95ee\u6709\u4e24\u79cd\u7c7b\u578b\uff1a\r\n\r\n1 v x k \r\n\u4f60\u9700\u8981\u7ed9v\u8282\u70b9\u7684\u503c\u589e\u52a0 x\uff0c\u5982\u679cv\u7684\u5b50\u5b59u\uff0c\u4e0ev\u7684\u8ddd\u79bb\u4e3ai\uff0c\u90a3\u4e48\u9700\u8981\u7ed9\u8282\u70b9u\u4e0a\u7684\u503c\u589e\u52a0 (x - i * k)\u3002\u4e24\u4e2a\u70b9\u95f4\u7684\u8ddd\u79bb\u5b9a\u4e49\u4e3a\u4e24\u70b9\u4e4b\u95f4\u7684\u6700\u77ed\u8def\u3002\r\n\r\n2 v \u8f93\u51fa\u8282\u70b9v\u4e0a\u7684\u503c\u3002\r\n\r\n\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u4f60\u9700\u8981\u8f93\u51fa mod 1000000007\u540e\u7684\u503c\u3002"
}
{
    "description": "Hongcow's teacher heard that Hongcow had learned about the cyclic shift, and decided to set the following problem for him.\n\nYou are given a list of $ n $ strings $ s_{1},s_{2},...,s_{n} $ contained in the list $ A $ .\n\nA list $ X $ of strings is called stable if the following condition holds.\n\nFirst, a message is defined as a concatenation of some elements of the list $ X $ . You can use an arbitrary element as many times as you want, and you may concatenate these elements in any arbitrary order. Let $ S_{X} $ denote the set of of all messages you can construct from the list. Of course, this set has infinite size if your list is nonempty.\n\nCall a single message good if the following conditions hold:\n\n- Suppose the message is the concatenation of $ k $ strings $ w_{1},w_{2},...,w_{k} $ , where each $ w_{i} $ is an element of $ X $ .\n- Consider the $ |w_{1}|+|w_{2}|+...+|w_{k}| $ cyclic shifts of the string. Let $ m $ be the number of these cyclic shifts of the string that are elements of $ S_{X} $ .\n- A message is good if and only if $ m $ is exactly equal to $ k $ .\n\nThe list $ X $ is called stable if and only if every element of $ S_{X} $ is good.\n\nLet $ f(L) $ be $ 1 $ if $ L $ is a stable list, and $ 0 $ otherwise.\n\nFind the sum of $ f(L) $ where $ L $ is a nonempty contiguous sublist of $ A $ (there are ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF744E/e3b4fb96ad236b842d8223d40fcab7d30a68cb22.png) contiguous sublists in total).",
    "inputFormat": "The first line of input will contain a single integer $ n $ ( $ 1<=n<=30 $ ), denoting the number of strings in the list.\n\nThe next $ n $ lines will each contain a string $ s_{i} $ (![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF744E/aa511b29228806a7ab9d89d220f5a75566cfa547.png)).",
    "outputFormat": "Print a single integer, the number of nonempty contiguous sublists that are stable.",
    "samples": [
        [
            "4\na\nab\nb\nbba\n",
            "7\n"
        ],
        [
            "5\nhh\nee\nll\nll\noo\n",
            "0\n"
        ],
        [
            "6\naab\nab\nbba\nb\nab\nc\n",
            "13\n"
        ]
    ],
    "hint": "For the first sample, there are $ 10 $ sublists to consider. Sublists \\[\"a\", \"ab\", \"b\"\\], \\[\"ab\", \"b\", \"bba\"\\], and \\[\"a\", \"ab\", \"b\", \"bba\"\\] are not stable. The other seven sublists are stable.\n\nFor example, $ X $ = \\[\"a\", \"ab\", \"b\"\\] is not stable, since the message \"ab\" + \"ab\" = \"abab\" has four cyclic shifts \\[\"abab\", \"baba\", \"abab\", \"baba\"\\], which are all elements of $ S_{X} $ .",
    "translation": "- \u8bbe $X$ \u662f\u5b57\u7b26\u4e32\u7684\u96c6\u5408\u3002\u5b9a\u4e49 $S_X=\\{x_1+\\cdots+x_k|k\\in \\mathbb{N},x_1,...,x_k\\in X\\}$\uff0c\u5373\u7531 $X$ \u4e2d\u5b57\u7b26\u4e32\u4ee5\u4efb\u610f\u987a\u5e8f\u3001\u4efb\u610f\u6b21\u6570\u80fd\u62fc\u63a5\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\u7684\u96c6\u5408\u3002\u6ce8\u610f\u5230\u5f53 $X$ \u4e0d\u7a7a\u65f6 $S_X$ \u4e00\u5b9a\u662f\u65e0\u7a77\u96c6\u5408\u3002\n- \u8fdb\u4e00\u6b65\u5730\uff0c\u8bbe $s=x_1+\\cdots+x_k$\uff0c\u5176\u4e2d $x_1,...,x_k$ \u90fd\u662f $X$ \u4e2d\u7684\u5b57\u7b26\u4e32\u3002\u663e\u7136 $s\\in S_X$\u3002\u79f0 $s$ \u5728 $X$ \u4e0b\u662f\u597d\u7684\uff0c\u5f53\u4e14\u4ec5\u5f53\u6070\u597d\u5b58\u5728 $k$ \u4e2a\u6574\u6570 $i\\in [0,|s|)$\uff0c \u4f7f\u5f97 $s$ \u5faa\u73af\u79fb\u4f4d $k$ \u4f4d\u540e\u662f $S_X$ \u4e2d\u7684\u4e32\u3002\u8fd9\u91cc\uff0c\u5b9a\u4e49\u4e00\u4e2a\u4e32\u5faa\u73af\u79fb\u4f4d $k$ \u4f4d\u6240\u5f62\u6210\u7684\u4e32\u662f\u628a\u8fd9\u4e2a\u4e32\u7684\u6700\u540e $k$ \u4e2a\u5b57\u7b26\u987a\u5e8f\u4e0d\u53d8\u5730\u79fb\u52a8\u5230\u8be5\u4e32\u5f00\u5934\u6240\u5f62\u6210\u7684\u4e32\u3002\u6ce8\u610f\u5230\u5982\u679c\u5b58\u5728 $s=x_1+\\cdots+x_{k_1}=x'_1+\\cdots+x'_{k_2}$ \u4e14 $k_1\\neq k_2$\uff0c\u90a3\u4e48 $s$ \u4e0d\u53ef\u80fd\u662f\u597d\u7684\u3002\n- \u79f0\u5b57\u7b26\u4e32\u96c6\u5408 $X$ \u662f\u597d\u7684\u5f53\u4e14\u4ec5\u5f53\u5bf9\u4e8e\u4efb\u610f\u7684 $s\\in S_X$\uff0c$s$ \u662f\u597d\u7684\u3002\n- \u7ed9\u5b9a $n$ \u4e2a\u5b57\u7b26\u4e32\u4e32 $A_1,...,A_n$\u3002\u8ba1\u7b97\u6709\u591a\u5c11\u4e2a\u533a\u95f4 $[l,r]$ \u6ee1\u8db3 $1\\leq l\\leq r\\leq n$\uff0c\u4e14\u5b57\u7b26\u4e32\u96c6\u5408 $\\{A_l,...,A_r\\}$ \u662f\u597d\u7684\u3002\n- $n\\leq 30$\uff0c$\\sum{|A_i|}\\leq 10^5$\uff0c\u4fdd\u8bc1 $A_i$ \u5747\u7531\u5c0f\u5199\u82f1\u6587\u5b57\u6bcd\u6784\u6210\u3002"
}
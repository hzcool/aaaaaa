{
    "description": "You are given an array of integers $ a $ of size $ n $ and a permutation $ p $ of size $ n $ . There are $ q $ queries of three types coming to you:\n\n1. For given numbers $ l $ and $ r $ , calculate the sum in array $ a $ on the segment from $ l $ to $ r $ : $ \\sum\\limits_{i=l}^{r} a_i $ .\n2. You are given two numbers $ v $ and $ x $ . Let's build a directed graph from the permutation $ p $ : it has $ n $ vertices and $ n $ edges $ i \\to p_i $ . Let $ C $ be the set of vertices that are reachable from $ v $ in this graph. You should add $ x $ to all $ a_u $ such that $ u $ is in $ C $ .\n3. You are given indices $ i $ and $ j $ . You should swap $ p_i $ and $ p_j $ .\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1588F/c75b348236facf766d3f0077e9eb5a499895bb8c.png)The graph corresponding to the permutation $ [2, 3, 1, 5, 4] $ .Please, process all queries and print answers to queries of type $ 1 $ .",
    "inputFormat": "The first line contains a single integer $ n $ ( $ 1 \\le n \\le 2 \\cdot 10^5 $ ) \u2014 the size of the array and permutation.\n\nThe second line contains $ n $ integers $ a_1, a_2, \\ldots, a_n $ ( $ -10^8 \\le a_i \\le 10^8 $ ).\n\nThe third line contains $ n $ distinct integers $ p_1, p_2, \\ldots, p_n $ ( $ 1 \\le p_i \\le n $ ).\n\nThe fourth line contains a single integer $ q $ \u2014 the number of queries ( $ 1 \\le q \\le 2 \\cdot 10^5 $ ).\n\nNext $ q $ lines contain description of queries. The $ i $ -th of them starts with an integer $ t_i $ ( $ 1 \\le t_i \\le 3 $ ) \u2014 the query type.\n\n- If $ t_i = 1 $ , then the $ i $ -th line also contains two integers $ l $ , $ r $ ( $ 1 \\le l \\le r \\le n $ ).\n- If $ t_i = 2 $ , then the $ i $ -th line also contains two integers $ v $ , $ x $ ( $ 1 \\le v \\le n $ , $ -10^8 \\le x \\le 10^8 $ ).\n- If $ t_i = 3 $ , then the $ i $ -th line also contains also two integers $ i $ , $ j $ ( $ 1 \\le i, j \\le n $ ).",
    "outputFormat": "For every first type query, print a single integer \u2014 the answer to this query.",
    "samples": [
        [
            "5\n6 9 -5 3 0\n2 3 1 5 4\n6\n1 1 5\n2 1 1\n1 1 5\n3 1 5\n2 1 -1\n1 1 5",
            "13\n16\n11"
        ],
        [
            "8\n-15 52 -4 3 5 9 0 5\n2 4 6 8 1 3 5 7\n10\n2 2 2\n2 5 -1\n1 1 8\n1 1 5\n1 5 8\n3 1 6\n2 1 50\n1 1 8\n2 6 -20\n1 1 8",
            "61\n45\n22\n461\n301"
        ],
        [
            "1\n1\n1\n1\n1 1 1",
            "1"
        ]
    ],
    "hint": "In the first example:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1588F/c75b348236facf766d3f0077e9eb5a499895bb8c.png)The graph corresponding to the initial permutation.There are $ 6 $ queries.\n\n1. The sum on the segment from $ 1 $ to $ 5 $ is $ a_1 + a_2 + a_3 + a_4 + a_5 = 6 + 9 + (-5) + 3 + 0 = 13 $ .\n2. If we start from $ 1 $ , we can reach $ \\{1, 2, 3\\} $ . After this query $ a $ is: $ [7, 10, -4, 3, 0] $ .\n3. The sum on the segment from $ 1 $ to $ 5 $ is $ a_1 + a_2 + a_3 + a_4 + a_5 = 6 + 9 + (-5) + 3 + 0 = 16 $ .\n4. After this query $ p = [4, 3, 1, 5, 2] $ .  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1588F/6a0b42ed3390b140eb899f9afe88974a8d8c9fc6.png)The graph corresponding to the new permutation.\n5. If we start from $ 2 $ , we can reach $ \\{1, 2, 3, 4, 5\\} $ . After this query $ a $ is: $ [6, 9, -5, 2, -1] $ .\n6. The sum on the segment from $ 1 $ to $ 5 $ is $ a_1 + a_2 + a_3 + a_4 + a_5 = 6 + 9 + (-5) + 2 + (-1) = 11 $ .",
    "translation": "\u4f60\u6709\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u7ec4 $a$ \u548c\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217 $p$\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$ \u6709\u4e00\u6709\u5411\u8fb9 $(i,p_i)$\u3002\n\n\u6709\u5982\u4e0b\u4e09\u79cd\u64cd\u4f5c\uff1a\n\n- ```1 l r``` \u8be2\u95ee $\\sum_{i=l}^r a_i$\u3002\n\n- ```2 v x``` \u5c06\u6240\u6709 $v$ \u80fd\u5230\u8fbe\u7684\u8282\u70b9\u6240\u5bf9\u5e94\u7f16\u53f7\u7684\u503c\u52a0 $x$\u3002\n\n- ```3 x y``` \u4ea4\u6362 $p_x$ \u4e0e $p_y$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00 $1$ \u64cd\u4f5c\u8f93\u51fa\u7ed3\u679c\u3002"
}
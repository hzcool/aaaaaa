{
    "description": "The only difference between easy and hard versions is the constraint on $ k $ .\n\nGildong loves observing animals, so he bought two cameras to take videos of wild animals in a forest. The color of one camera is red, and the other one's color is blue.\n\nGildong is going to take videos for $ n $ days, starting from day $ 1 $ to day $ n $ . The forest can be divided into $ m $ areas, numbered from $ 1 $ to $ m $ . He'll use the cameras in the following way:\n\n- On every odd day ( $ 1 $ -st, $ 3 $ -rd, $ 5 $ -th, ...), bring the red camera to the forest and record a video for $ 2 $ days.\n- On every even day ( $ 2 $ -nd, $ 4 $ -th, $ 6 $ -th, ...), bring the blue camera to the forest and record a video for $ 2 $ days.\n- If he starts recording on the $ n $ -th day with one of the cameras, the camera records for only one day.\n\nEach camera can observe $ k $ consecutive areas of the forest. For example, if $ m=5 $ and $ k=3 $ , he can put a camera to observe one of these three ranges of areas for two days: $ [1,3] $ , $ [2,4] $ , and $ [3,5] $ .\n\nGildong got information about how many animals will be seen in each area on each day. Since he would like to observe as many animals as possible, he wants you to find the best way to place the two cameras for $ n $ days. Note that if the two cameras are observing the same area on the same day, the animals observed in that area are counted only once.",
    "inputFormat": "The first line contains three integers $ n $ , $ m $ , and $ k $ ( $ 1 \\le n \\le 50 $ , $ 1 \\le m \\le 2 \\cdot 10^4 $ , $ 1 \\le k \\le m $ ) \u2013 the number of days Gildong is going to record, the number of areas of the forest, and the range of the cameras, respectively.\n\nNext $ n $ lines contain $ m $ integers each. The $ j $ -th integer in the $ i+1 $ -st line is the number of animals that can be seen on the $ i $ -th day in the $ j $ -th area. Each number of animals is between $ 0 $ and $ 1000 $ , inclusive.",
    "outputFormat": "Print one integer \u2013 the maximum number of animals that can be observed.",
    "samples": [
        [
            "4 5 2\n0 2 1 1 0\n0 0 3 1 2\n1 0 4 3 1\n3 3 0 0 4",
            "25"
        ],
        [
            "3 3 1\n1 2 3\n4 5 6\n7 8 9",
            "31"
        ],
        [
            "3 3 2\n1 2 3\n4 5 6\n7 8 9",
            "44"
        ],
        [
            "3 3 3\n1 2 3\n4 5 6\n7 8 9",
            "45"
        ]
    ],
    "hint": "The optimal way to observe animals in the four examples are as follows:\n\nExample 1:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1304F2/d3d7ccf6369074c42d9cb3c6953ef69b03850081.png)Example 2:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1304F2/cb62ca568d7dec1d0d903ae38c9fff43fc945cf2.png)Example 3:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1304F2/3e18878b2213816dafe01bd460999dff35151fc8.png)Example 4:\n\n ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1304F2/dc814ca536d6cd407d5a49988e0923d5d85a8629.png)",
    "translation": "\u7b80\u5355\u7248\u548c\u56f0\u96be\u7248\u552f\u4e00\u7684\u533a\u522b\u662f $k$ \u7684\u8303\u56f4\u3002\n\nGildong \u8ba1\u5212\u62cd\u6444\u68ee\u6797\u4e2d\u7684\u91ce\u751f\u52a8\u7269\u4eec\u3002\u68ee\u6797\u88ab\u5212\u5206\u4e3a $m$ \u4e2a\u5730\u533a\uff0c\u4f9d\u6b21\u7f16\u53f7\u4e3a $1$ \u5230 $m$\uff0c\u4ed6\u7684\u62cd\u6444\u8ba1\u5212\u6301\u7eed $n$ \u5929\u3002\n\n\u6bcf\u4e00\u5929\uff0c\u4ed6\u4f1a\u9009\u62e9\u68ee\u6797\u4e2d\u8fde\u7eed\u7684 $k$ \u4e2a\u5730\u533a\uff0c\u5e76\u4e14\u5f55\u4e00\u6bb5\u957f\u4e3a $2$ \u5929\u7684\u5f55\u50cf\u3002\uff08\u5982\u679c\u662f\u6700\u540e\u4e00\u5929\uff0c\u90a3\u5c31\u5f55\u4e00\u6bb5\u957f\u5ea6\u4e3a $1$ \u5929\u7684\u5f55\u50cf\uff09\u8fd9\u6837\u6240\u6709\u5728\u8fd9\u4e24\u5929\u4e4b\u5185\u5728\u8fd9 $k$ \u4e2a\u5730\u533a\u4e2d\u51fa\u73b0\u8fc7\u7684\u52a8\u7269\u90fd\u4f1a\u88ab\u62cd\u6444\u5230\u3002\n\n\u4ed6\u77e5\u9053\u672a\u6765 $n$ \u5929\u5185\u6bcf\u4e00\u5929\u6bcf\u4e00\u4e2a\u5730\u533a\u4f1a\u51fa\u73b0\u591a\u5c11\u91ce\u751f\u52a8\u7269\u3002\u4ed6\u60f3\u62cd\u6444\u4e0b\u5c3d\u53ef\u80fd\u591a\u7684\u91ce\u751f\u52a8\u7269\u3002\u6ce8\u610f\u5982\u679c\u4e00\u4e2a\u52a8\u7269\u88ab\u62cd\u6444\u4e86\u4e24\u6b21\uff0c\u90a3\u4e48\u53ea\u4f1a\u88ab\u8ba1\u7b97\u4e00\u6b21\u3002\n\n\u4f60\u7684\u4efb\u52a1\u662f\u6c42\u51fa\u62cd\u6444\u5230\u7684\u52a8\u7269\u6570\u91cf\u7684\u6700\u5927\u503c\u3002\n\n$n\\le 50,m\\le 20000,k\\le m$"
}
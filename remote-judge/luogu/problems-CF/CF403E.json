{
    "description": "You have two rooted undirected trees, each contains $ n $ vertices. Let's number the vertices of each tree with integers from $ 1 $ to $ n $ . The root of each tree is at vertex $ 1 $ . The edges of the first tree are painted blue, the edges of the second one are painted red. For simplicity, let's say that the first tree is blue and the second tree is red.\n\nEdge $ {x,y} $ is called bad for edge $ {p,q} $ if two conditions are fulfilled:\n\n1. The color of edge $ {x,y} $ is different from the color of edge $ {p,q} $ .\n2. Let's consider the tree of the same color that edge $ {p,q} $ is. Exactly one of vertices $ x $ , $ y $ lies both in the subtree of vertex $ p $ and in the subtree of vertex $ q $ .\n\nIn this problem, your task is to simulate the process described below. The process consists of several stages:\n\n1. On each stage edges of exactly one color are deleted.\n2. On the first stage, exactly one blue edge is deleted.\n3. Let's assume that at the stage $ i $ we've deleted edges $ {u_{1},v_{1}} $ , $ {u_{2},v_{2}} $ , $ ... $ , $ {u_{k},v_{k}} $ . At the stage $ i+1 $ we will delete all undeleted bad edges for edge $ {u_{1},v_{1}} $ , then we will delete all undeleted bad edges for edge $ {u_{2},v_{2}} $ and so on until we reach edge $ {u_{k},v_{k}} $ .\n\nFor each stage of deleting edges determine what edges will be removed on the stage. Note that the definition of a bad edge always considers the initial tree before it had any edges removed.",
    "inputFormat": "The first line contains integer $ n $ ( $ 2<=n<=2\u00b710^{5} $ ) \u2014 the number of vertices in each tree.\n\nThe next line contains $ n-1 $ positive integers $ a_{2},a_{3},...,a_{n} $ ( $ 1<=a_{i}<=n;\u00a0a_{i}\u2260i $ ) \u2014 the description of edges of the first tree. Number $ a_{i} $ means that the first tree has an edge connecting vertex $ a_{i} $ and vertex $ i $ .\n\nThe next line contains $ n-1 $ positive integers $ b_{2},b_{3},...,b_{n} $ ( $ 1<=b_{i}<=n;\u00a0b_{i}\u2260i $ ) \u2014 the description of the edges of the second tree. Number $ b_{i} $ means that the second tree has an edge connecting vertex $ b_{i} $ and vertex $ i $ .\n\nThe next line contains integer $ idx $ ( $ 1<=idx&lt;n $ ) \u2014 the index of the blue edge that was removed on the first stage. Assume that the edges of each tree are numbered with numbers from $ 1 $ to $ n-1 $ in the order in which they are given in the input.",
    "outputFormat": "For each stage of removing edges print its description. Each description must consist of exactly two lines. If this is the stage when blue edges are deleted, then the first line of the description must contain word $ Blue $ , otherwise \u2014 word $ Red $ . In the second line print the indexes of the edges that will be deleted on this stage in the increasing order.",
    "samples": [
        [
            "5\n1 1 1 1\n4 2 1 1\n3\n",
            "Blue\n3\nRed\n1 3\nBlue\n1 2\nRed\n2\n"
        ]
    ],
    "hint": "For simplicity let's assume that all edges of the root tree received some direction, so that all vertices are reachable from vertex $ 1 $ . Then a subtree of vertex $ v $ is a set of vertices reachable from vertex $ v $ in the resulting directed graph (vertex $ v $ is also included in the set).",
    "translation": "\u4f60\u6709\u4e24\u68f5\u6709\u6839\u6811\uff0c\u6bcf\u68f5\u5404\u6709n \u4e2a\u9876\u70b9\u3002\u8ba9\u6211\u4eec\u7528\u6574\u65701\u5230n\u7ed9\u6bcf\u68f5\u6811\u7684\u9876\u70b9\u7f16\u53f7\u3002\u4e24\u68f5\u6811\u7684\u6839\u90fd\u662f\u9876\u70b91\u3002\u7b2c\u4e00\u68f5\u6811\u7684\u8fb9\u90fd\u67d3\u6210\u84dd\u8272\uff0c\u7b2c\u4e8c\u68f5\u6811\u7684\u8fb9\u90fd\u67d3\u6210\u7ea2\u8272\u3002\u7b80\u660e\u8d77\u89c1\uff0c\u6211\u4eec\u79f0\u7b2c\u4e00\u68f5\u6811\u662f\u84dd\u8272\u7684\uff0c\u4ee5\u53ca\u7b2c\u4e8c\u68f5\u6811\u662f\u7ea2\u8272\u7684\u3002\n    \u540c\u65f6\u6ee1\u8db3\u4e0b\u9762\u7684\u4e24\u4e2a\u6761\u4ef6\u4e0b\uff0c\u8fb9(x, y) \u6709\u5bb3\u4e8e\u8fb9(p,q)\uff1a\n    1. \u8fb9(x,y)\u7684\u989c\u8272\u4e0d\u540c\u4e8e\u8fb9(p,q)\u3002\n    2. \u8003\u8651\u4e0e\u8fb9(p, q) \u989c\u8272\u76f8\u540c\u7684\u6811\uff0c\u7f16\u53f7\u4e3ax, y \u7684\u4e24\u4e2a\u9876\u70b9\u4e2d\u6070\u597d\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u540c\u65f6\u5728\u9876\u70b9p \u7684\u5b50\u6811\u4e0e\u9876\u70b9q \u7684\u5b50\u6811\u91cc\u3002\n    \u5728\u8fd9\u4e2a\u95ee\u9898\u91cc\uff0c\u4f60\u7684\u4efb\u52a1\u662f\u6a21\u62df\u4e0b\u8ff0\u8fc7\u7a0b\u3002\u6b64\u8fc7\u7a0b\u7531\u82e5\u5e72\u9636\u6bb5\u7ec4\u6210\uff1a\n    1. \u5728\u540c\u4e00\u4e2a\u9636\u6bb5\u4e2d\u5220\u9664\u7684\u8fb9\u989c\u8272\u76f8\u540c\u3002\n    2. \u5728\u7b2c\u4e00\u9636\u6bb5\uff0c\u5220\u9664\u6070\u597d\u4e00\u6761\u84dd\u8272\u7684\u8fb9\u3002\n    3. \u5047\u8bbe\u5728\u9636\u6bb5i \u6211\u4eec\u5220\u53bb\u4e86\u8fb9(u1\uff0cv1)\uff0c (u2\uff0cv2)\uff0c... \uff0c (uk\uff0cvk)\u3002\u90a3\u4e48\u5728\u9636\u6bb5i+1\u6211\u4eec\u8981\u5220\u53bb\u6709\u5bb3\u4e8e(u1\uff0cv1) \u7684\u8fb9\uff0c\u7136\u540e\u5220\u53bb\u6709\u5bb3\u4e8e(u2\uff0cv2) \u7684\u8fb9\uff0c\u63a5\u7740\u7ee7\u7eed\u5220\u5230\u5220\u5b8c\u6709\u5bb3\u4e8e(uk\uff0cvk) \u7684\u8fb9\u3002\n    \u5bf9\u4e8e\u6bcf\u4e2a\u9636\u6bb5\uff0c\u6c42\u89e3\u54ea\u4e9b\u8fb9\u5c06\u5728\u8fd9\u4e2a\u9636\u6bb5\u4e2d\u88ab\u5220\u9664\u3002\u6ce8\u610f\uff0c\u6709\u5bb3\u8fb9\u7684\u5b9a\u4e49\u53ea\u4f9d\u8d56\u4e8e\u5f00\u59cb\u5220\u8fb9\u4e4b\u524d\u7684\u521d\u59cb\u5c31\u62e5\u6709\u7684\u4e24\u68f5\u6709\u6839\u6811\u3002\n\u8f93\u5165\uff1a\u7b2c\u4e00\u884c\u4e3a\u6574\u6570n\uff082<=n<=2*10^5\uff09\u2014\u2014\u4e24\u68f5\u6811\u5206\u522b\u6709\u7684\u9876\u70b9\u6570\u76ee\u3002\n\u63a5\u4e0b\u6765\u7684\u4e00\u884c\u5305\u542bn-1\u4e2a\u6b63\u6574\u6570a2,a3,...,an(1<=ai<=n;ai<>i)\uff0c\u63cf\u8ff0\u7b2c\u4e00\u68f5\u6811\u7684\u8fb9\u3002\u6570\u5b57ai\u610f\u5473\u7740\u7b2c\u4e00\u68f5\u6811\u6709\u4e00\u6761\u8fb9\u8fde\u63a5\u9876\u70b9ai\u548c\u9876\u70b9i\u3002\n\u63a5\u4e0b\u6765\u7684\u53c8\u4e00\u884c\u5305\u542bn-1\u4e2a\u6b63\u6574\u6570b2,b3,...,bn(1<=bi<=n;bi<>i)\uff0c\u63cf\u8ff0\u7b2c\u4e8c\u68f5\u6811\u7684\u8fb9\u3002\u6570\u5b57ai\u610f\u5473\u7740\u7b2c\u4e8c\u68f5\u6811\u6709\u4e00\u6761\u8fb9\u8fde\u63a5\u9876\u70b9bi\u548c\u9876\u70b9i\u3002\n\u63a5\u4e0b\u6765\u7684\u518d\u4e00\u884c\u5305\u542b\u4e00\u4e2a\u6574\u6570idx\uff081 <=idx < n\uff09\u8868\u793a\u5728\u7b2c\u4e00\u9636\u6bb5\u4e2d\u5220\u9664\u7684\u8fb9\u7684\u7f16\u53f7\u3002\u6211\u4eec\u8ba9\u6bcf\u68f5\u6811\u7684\u6bcf\u6761\u8fb9\u6309\u7167\u4ed6\u4eec\u5728\u8f93\u5165\u4e2d\u7684\u524d\u540e\u987a\u5e8f\u4ece1 \u5230n-1 \u7f16\u53f7\u3002\n\n\u8f93\u51fa\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u9636\u6bb5\u8f93\u51fa\u4e24\u884c\u3002\u5982\u679c\u8fd9\u4e2a\u9636\u6bb5\u5220\u9664\u7684\u8fb9\u662f\u84dd\u8272\u7684\uff0c\u90a3\u4e48\u5bf9\u5e94\u8fd9\u4e00\u9636\u6bb5\u7684\u4e24\u884c\u4e2d\uff0c\u7b2c\u4e00\u884c\u5fc5\u987b\u4e3a\u5355\u8bcdBlue\uff0c\u5426\u5219\u4e3a\u5355\u8bcdRed\u3002\u5bf9\u5e94\u7684\u7b2c\u4e8c\u884c\u5305\u542b\u6240\u6709\u6b64\u9636\u6bb5\u5220\u9664\u7684\u8fb9\u7684\u7f16\u53f7\uff0c\u6309\u6570\u5b57\u9012\u589e\u987a\u5e8f\u8f93\u51fa\u3002"
}
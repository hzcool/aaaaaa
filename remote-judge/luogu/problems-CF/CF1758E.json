{
    "description": "Tannhaus, the clockmaker in the town of Winden, makes mysterious clocks that measure time in $ h $ hours numbered from $ 0 $ to $ h-1 $ . One day, he decided to make a puzzle with these clocks.\n\nThe puzzle consists of an $ n \\times m $ grid of clocks, and each clock always displays some hour exactly (that is, it doesn't lie between two hours). In one move, he can choose any row or column and shift all clocks in that row or column one hour forward $ ^\\dagger $ .\n\nThe grid of clocks is called solvable if it is possible to make all the clocks display the same time.\n\nWhile building his puzzle, Tannhaus suddenly got worried that it might not be possible to make the grid solvable. Some cells of the grid have clocks already displaying a certain initial time, while the rest of the cells are empty.\n\nGiven the partially completed grid of clocks, find the number of ways $ ^\\ddagger $ to assign clocks in the empty cells so that the grid is solvable. The answer can be enormous, so compute it modulo $ 10^9 + 7 $ .\n\n $ ^\\dagger $ If a clock currently displays hour $ t $ and is shifted one hour forward, then the clock will instead display hour $ (t+1) \\bmod h $ .\n\n $ ^\\ddagger $ Two assignments are different if there exists some cell with a clock that displays a different time in both arrangements.",
    "inputFormat": "The first line of input contains $ t $ ( $ 1 \\leq t \\leq 5 \\cdot 10^4 $ ) \u2014 the number of test cases.\n\nThe first line of each test case consists of 3 integers $ n $ , $ m $ , and $ h $ ( $ 1 \\leq n, m \\leq 2 \\cdot 10^5 $ ; $ 1 \\leq h \\leq 10^9 $ ) \u2014 the number of rows in the grid, the number of columns in the grid, and the number of the hours in the day respectively.\n\nThe next $ n $ lines each contain $ m $ integers, describing the clock grid. The integer $ x $ ( $ -1 \\leq x < h $ ) in the $ i $ -th row and the $ j $ -th column represents the initial hour of the corresponding clock, or if $ x = -1 $ , an empty cell.\n\nIt is guaranteed that the sum of $ n \\cdot m $ over all test cases does not exceed $ 2 \\cdot 10^5 $ .",
    "outputFormat": "For each test case, output the number of ways to assign clocks in the empty cells so that the grid is solvable. The answer can be huge, so output it modulo $ 10^9 + 7 $ .",
    "samples": [
        [
            "5\n2 3 4\n1 0 -1\n-1 -1 2\n2 2 10\n1 2\n3 5\n4 5 1024\n1 -1 -1 -1 -1\n-1 -1 -1 1000 -1\n-1 -1 -1 -1 69\n420 -1 -1 999 -1\n3 3 3\n-1 -1 1\n2 -1 1\n2 -1 2\n3 3 3\n1 -1 2\n-1 0 -1\n-1 1 0",
            "4\n0\n73741817\n0\n1"
        ]
    ],
    "hint": "For the first sample, this is a possible configuration for the clocks:\n\n| 1 | 0 | 3 |\n| :-----------: | :-----------: | :-----------: |\n| 0 | 3 | 2 |\n\nThis is solvable since we can:\n\n1. Move the middle column forward one hour.\n2. Move the third column forward one hour.\n3. Move the third column forward one hour.\n4. Move the second row forward one hour.\n\n After that all the clocks show one hour.For the second test case, it can be shown that there are no possible solvable clock configurations.",
    "translation": "Feyn \u662f\u4e00\u4e2a\u949f\u8868\u5320\uff0c\u4ed6\u51fa\u4e86\u4e00\u4e2a\u8c1c\u9898\uff1a\n\n\u8c1c\u9898\u5305\u542b\u4e00\u4e2a\u653e\u4e86 $n\\times m$ \u4e2a\u949f\u7684\u77e9\u9635\uff0c\u77e9\u9635\u91cc\u7684\u6bcf\u4e2a\u949f\u90fd\u6070\u597d\u6307\u5411\u67d0\u4e00\u65f6\u523b\u3002\u6ce8\u610f\u5728 Feyn \u7684\u4e16\u754c\u91cc\u949f\u662f\u4ee5 $h$ \u4e2a\u5c0f\u65f6\u4e3a\u8fdb\u5236\u7684\u3002Feyn \u6bcf\u6b21\u53ef\u4ee5\u7ed9\u77e9\u9635\u7684\u67d0\u4e00\u884c\u6216\u67d0\u4e00\u5217\u4e2d\u7684\u949f\u62e8\u5411\u4e0b\u4e00\u65f6\u523b\u3002\u8fd9\u4e2a\u77e9\u9635\u6709\u4e9b\u4f4d\u7f6e\u653e\u597d\u4e86\u949f\uff0c\u6709\u4e9b\u8fd8\u6ca1\u653e\u597d\u949f\uff0c\u8bf7\u4f60\u8ba1\u7b97\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u65b9\u6848\u6570\u4f7f\u5f97\u586b\u6ee1\u77e9\u9635\u540e Feyn \u80fd\u6309\u89c4\u5219\u628a\u6240\u6709\u949f\u62e8\u5411\u76f8\u540c\u65f6\u523b\u3002\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\u591a\u7ec4\u6570\u636e\u3002\n\n\u5982\u679c\u4e24\u4e2a\u77e9\u9635\u4e2d\u67d0\u4e2a\u949f\u521d\u59cb\u6307\u5411\u7684\u65f6\u523b\u4e0d\u540c\uff0c\u5219\u8ba4\u4e3a\u4ed6\u4eec\u662f\u4e0d\u540c\u7684\u65b9\u6848\u3002\n\n(translated by 342873)"
}
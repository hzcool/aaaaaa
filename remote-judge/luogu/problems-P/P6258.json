{
    "description": "Mr. Hobson has retired from running a stable and has invested in a more modern form of transport,trains. He has built a rail network with n stations. However, he has retained his commitment to free the passenger from the burden of too many choices: from each station, a passenger can catch a train to exactly one other station. Such a journey is referred to as a **$leg$**. Note that this is a one-way journey, and it might not be possible to get back again.\n\nHobson also offers exactly one choice of ticket, which allows a passenger to travel up to $k$ legs in one trip. At the exit from each station is an automated ticket reader (only one, so that passengers do not need\nto decide which to use). The reader checks that the distance from the initial station to the final station does not exceed $k$ legs.\n\nEach ticket reader must be programmed with a list of valid starting stations, but the more memory this list needs, the more expensive the machine will be. Help Hobson by determining, for each station $A$, the\nnumber of stations (including $A$) from which a customer can reach $A$ in at most $k$ legs.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l1j8vud2.png)",
    "inputFormat": "The first line of input contains two integers $n$ and $k$, where $n$ $(2 \\leq n \\leq 5\\times10^5)$ is the number of stations and $k$ $(1 \\leq k \\leq n \u2212 1)$ is the maximum number of legs that may be traveled on a ticket. Then follow $n$ lines, the $i^{th}$ of which contains an integer $d_i$ $(1 \\leq d_i \\leq n$ and $d_i \u2260 i)$, the station which may be reached from station $i$ in one leg.\n",
    "outputFormat": "Output $n$ lines, with the $i^{th}$ line containing the number of stations from which station $i$ can be reached in at most $k$ legs.\n",
    "samples": [
        [
            "6 2\n2\n3\n4\n5\n4\n3\n",
            "1\n2\n4\n5\n3\n1"
        ],
        [
            "5 3\n2\n3\n1\n5\n4\n",
            "3\n3\n3\n2\n2"
        ]
    ],
    "hint": "Source: ICPC World Finals 2019.",
    "translation": "**\u3010\u9898\u76ee\u63cf\u8ff0\u3011**\n\nHobson \u5148\u751f\u4ece\u7ba1\u7406\u9a6c\u53a9\u7684\u5de5\u4f5c\u4e2d\u9000\u4f11\u540e\uff0c\u6295\u8d44\u4e8e\u4e00\u79cd\u66f4\u52a0\u73b0\u4ee3\u7684\u4ea4\u901a\u65b9\u5f0f\uff1a\u706b\u8f66\u3002\n\n\u4ed6\u5df2\u7ecf\u4fee\u5efa\u4e86\u4e00\u4e2a\u5305\u542b $n$ \u4e2a\u706b\u8f66\u7ad9\u7684\u94c1\u8def\u7f51\u3002\u7136\u800c\uff0c\u4ed6\u5151\u73b0\u4e86\u8ba9\u4e58\u5ba2\u6446\u8131\u9009\u62e9\u56f0\u96be\u75c7\u7684\u627f\u8bfa\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u7ad9\u70b9\uff0c\u4e58\u5ba2\u53ea\u80fd\u4e58\u5750\u706b\u8f66\u524d\u5f80\u4e00\u4e2a\u7ad9\u70b9\uff0c\u522b\u65e0\u5176\u5b83\u9009\u62e9\u3002\n\n\u8fd9\u6837\u7684\u4e00\u6bb5\u65c5\u7a0b\u88ab\u79f0\u4f5c\u4e00\u8d9f\u3002\u8981\u6ce8\u610f\u8fd9\u662f\u5355\u5411\u7684\u65c5\u7a0b\uff0c\u53ef\u80fd\u65e0\u6cd5\u518d\u56de\u5230\u51fa\u53d1\u70b9\u3002\n\nHobson \u540c\u6837\u4e5f\u53ea\u63d0\u4f9b\u4e00\u79cd\u8f66\u7968\uff0c\u5141\u8bb8\u4e58\u5ba2\u4e00\u6b21\u65c5\u884c\u7684\u8ddd\u79bb\u4e0d\u8d85\u8fc7 $k$ \u8d9f\u3002\u5728\u6bcf\u4e2a\u7ad9\u70b9\u7684\u51fa\u53e3\u4f1a\u6709\u4e00\u4e2a\u81ea\u52a8\u8bfb\u7968\u673a\uff08\u53ea\u6709\u4e00\u4e2a\uff0c\u6240\u4ee5\u4e58\u5ba2\u5c31\u4e0d\u7528\u7ea0\u7ed3\u4e8e\u8981\u7528\u54ea\u4e2a\uff09\u3002\u673a\u5668\u4f1a\u68c0\u67e5\u4ece\u59cb\u53d1\u7ad9\u5230\u5230\u8fbe\u7ad9\u7684\u8ddd\u79bb\u662f\u5426\u4e0d\u8d85\u8fc7 $k$ \u8d9f\u3002\n\n\u6bcf\u4e2a\u8bfb\u7968\u673a\u5fc5\u987b\u7f16\u5165\u4e00\u4e2a\u5408\u6cd5\u59cb\u53d1\u7ad9\u5217\u8868\uff0c\u4f46\u662f\u5217\u8868\u6d88\u8017\u7684\u5b58\u50a8\u7a7a\u95f4\u8d8a\u591a\uff0c\u673a\u5668\u5c31\u8d8a\u8d35\u3002\n\n\u8bf7\u5e2e\u52a9 Hobson \u5148\u751f\u786e\u5b9a\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u7ad9\u70b9 $A$\uff0c\u80fd\u591f\u5728\u6700\u591a $k$ \u8d9f\u7684\u65c5\u7a0b\u4e2d\u5230\u8fbe $A$ \u7684\u7ad9\u70b9\u4e2a\u6570\uff08\u5305\u542b $A$ \u672c\u8eab\uff09\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1hewt4ho.png)\n\n\u4e0a\u56fe\u4e3a\u6837\u4f8b\u8f93\u5165 1 \u5bf9\u5e94\u7684\u793a\u610f\u56fe\u3002\u6bcf\u4e2a\u5706\u5708\u4ee3\u8868\u4e86\u4e00\u4e2a\u7ad9\u70b9\uff0c\u5706\u5708\u65c1\u8fb9\u7684\u6570\u5b57\u4e3a\u5f53 $k=2$ \u65f6\u9700\u8981\u7f16\u5165\u8bfb\u7968\u673a\u7684\u7ad9\u70b9\u7f16\u53f7\u3002\n\n**\u3010\u8f93\u5165\u683c\u5f0f\u3011**\n\n\u7b2c\u4e00\u884c\u5305\u542b\u4e24\u4e2a\u6574\u6570 $n, k$\uff0c$n$ \u4e3a\u7ad9\u70b9\u4e2a\u6570\uff0c$k$ \u4e3a\u4e00\u5f20\u7968\u5141\u8bb8\u65c5\u884c\u7684\u6700\u591a\u8d9f\u6570\u3002  \n\u63a5\u4e0b\u6765 $n$ \u884c\uff0c\u7b2c $i$ \u884c\u5305\u542b\u4e00\u4e2a\u6574\u6570 $d_i$\uff0c\u8868\u793a\u7b2c $i$ \u4e2a\u7ad9\u70b9\u7ecf\u8fc7\u4e00\u8d9f\u5230\u8fbe\u7684\u7ad9\u70b9\u3002\n\n**\u3010\u8f93\u51fa\u683c\u5f0f\u3011**\n\n\u8f93\u51fa $n$ \u884c\uff0c\u7b2c $i$ \u884c\u8f93\u51fa\u80fd\u5728 $k$ \u8d9f\u5185\u5230\u8fbe\u7ad9\u70b9 $i$ \u7684\u7ad9\u70b9\u6570\u76ee\u3002\n\n**\u3010\u8bd1\u8005\u6ce8\u3011**\n\n\u5728\u4e0d\u4fb5\u72af\u539f\u9898\u7248\u6743\u7684\u60c5\u51b5\u4e0b\uff0c\u672c\u9898\u9762\u4e2d\u6587\u7ffb\u8bd1\u57fa\u4e8e[\u77e5\u8bc6\u5171\u4eab\u7f72\u540d-\u975e\u5546\u4e1a\u6027\u4f7f\u7528-\u76f8\u540c\u65b9\u5f0f\u5171\u4eab 4.0 \u56fd\u9645\u8bb8\u53ef\u534f\u8bae](http://creativecommons.org/licenses/by-nc-sa/4.0/)\u53d1\u5e03\uff0c\u6ce8\u660e\u51fa\u5904\u65f6\u9700\u6307\u5411\u672c\u9898\u94fe\u63a5\u3002\n\nTranslate By @\u5c0f\u7c89\u5154 "
}
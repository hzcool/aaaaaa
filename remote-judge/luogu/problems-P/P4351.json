{
    "description": "A frightful matrix is a square matrix of order n where the \ufb01rst row and the \ufb01rst column are explicitly speci\ufb01ed, while the other elements are calculated using a frightful formula which is, actually, a simple recursive rule. \n\nGiven two integer sequences l and t,both of size n,as well as integer parameters a,b and c,the frightful matrix F is de\ufb01ned as follows:\n\n* The \ufb01rst column of the matrix is the sequence l: \n\n$$F[k, 1] = lk$$ \n\n* The \ufb01rst row of the matrix is the sequence t: \n\n$$F[1, k] = tk$$ \n\n* Other elements are calculated using a recursive formula: \n\n$$F[i,j]=a*F[i,j-1]+b*F[i-1,j]+c$$\n\nGiven a frightful matrix, \ufb01nd the value of the element $F[n,n]$ modulo $10^6 +3$.",
    "inputFormat": "The \ufb01rst line contains four integers n, a, b and c (2\u2264n\u2264200000, 0\u2264 a, b, c\u2264$10^6$) \u2013 the size of the matrix and the recursion parameters, as described in the problem statement. \n\nThe two following lines contain integers l1,...,ln and t1,...,tn, respectively (l1 = t1, 0\u2264lk, tk \u2264106). ",
    "outputFormat": "Output a single integer \u2013 the value of $F[n,n]$ modulo $10^6 +3$.",
    "samples": [
        [
            "3 0 0 0 \n0 0 2 \n0 3 0",
            "0"
        ],
        [
            "4 3 5 2 \n7 1 4 3 \n7 4 4 8",
            "41817"
        ]
    ],
    "hint": "Central Europe Regional Contest 2015 Problem F",
    "translation": "\n\u5b9a\u4e49\u4e00\u4e2a\u77e9\u9635 $F$\uff0c\u5176\u4e2d\u7b2c\u4e00\u884c\u548c\u7b2c\u4e00\u5217\u662f\u7ed9\u5b9a\u7684\uff0c\u8ba1\u7b97\u77e9\u9635\u65b9\u6cd5\u5982\u4e0b\uff1a\n\n\u77e9\u9635\u7684\u7b2c\u4e00\u5217\u662f\u5e8f\u5217  $l$\uff1a\n\n $F[k,1]=$  $l _ k$\n\n\u77e9\u9635\u7684\u7b2c\u4e00\u884c\u662f\u5e8f\u5217  $t$\uff1a\n\n $F[1,k]=$  $t _ k$\n\n\u5176\u4ed6\u5143\u7d20\u4f7f\u7528\u7ed9\u5b9a\u7684\u9012\u5f52\u516c\u5f0f\u8fdb\u884c\u8ba1\u7b97\uff1a\n\n$F[i,j]=a \\times F[i,j-1]+b \\times F[i-1,j]+c$\u3002\n\n\u73b0\u5728\u8981\u6c42\u627e\u6c42\u51fa $F[n,n]$ \u6a21 $10^6+3$ \u7684\u503c\u3002\n\n\u8f93\u5165\u8f93\u51fa\u683c\u5f0f\u3002\n\n\u8f93\u5165\u683c\u5f0f\uff1a\n\n\u7b2c\u4e00\u884c\u5305\u542b\u56db\u4e2a\u6574\u6570 $n$\uff0c$a$\uff0c$b$ \u548c $c(2 \\le n \\le 200000,0 \\le a,b$\uff0c$c \\le 10^6)$ \u77e9\u9635\u7684\u5927\u5c0f\u548c\u9012\u5f52\u53c2\u6570\uff0c\u5982\u95ee\u9898\u63cf\u8ff0\u4e2d\u6240\u8ff0\u3002\n\n\u4e0b\u9762\u4e24\u884c\u5206\u522b\u5305\u542b\u6574\u6570 $l_1, \\cdots ,l_n$ \u548c $t_1, \\cdots ,t_n(l_1=t_1,0 \\le lk,tk \\le 10^6)$\u3002\n\n\u8f93\u51fa\u683c\u5f0f\uff1a\n\n\u8f93\u51fa\u4e00\u4e2a\u6574\u6570\u7684\u503c\u5373 $F[n,n]$ \u6a21 $10^6+3$\u3002\n\n\u611f\u8c22 @ \u5b88\u671b\u63d0\u4f9b\u7684\u7ffb\u8bd1\u3002\n"
}
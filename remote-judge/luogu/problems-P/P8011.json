{
    "description": "\u4e3a\u4e86\u66f4\u65b9\u4fbf\u5730\u63cf\u8ff0\u9898\u610f\uff0c\u6211\u4eec\u5148\u7ed9\u51fa\u4ee5\u4e0b\u5b9a\u4e49\uff1a\n\n- **\u5b50\u6bb5**\uff1a\u6211\u4eec\u5b9a\u4e49\u6570\u7ec4 $B$ \u662f\u6570\u7ec4 $A$ \u4ece $P$ \u4f4d\u7f6e\u5f00\u59cb\u7684\u5b50\u6bb5\uff0c\u5f53\u4e14\u4ec5\u5f53 $|A| + P - 1 \\le |B|$ \u4e14 $B_1=A_P,B_2=A_{P+1},\\dots,B_{|B|}=A_{P+{|B|}-1}$\uff0e\n- **\u4f5c\u4e3a\u5b50\u6bb5\u7684\u51fa\u73b0\u6b21\u6570**\uff1a\u6211\u4eec\u5b9a\u4e49\u6570\u7ec4 $B$ \u5728\u6570\u7ec4 $A$ \u4e2d\u4f5c\u4e3a\u5b50\u6bb5\u7684\u51fa\u73b0\u6b21\u6570\u4e3a\uff1a\u521d\u59cb\u8bbe\u6b21\u6570\u4e3a $0$\uff0e\u679a\u4e3e\u6bcf\u4e2a\u4e0d\u540c\u7684 $P$\uff0c\u82e5\u6570\u7ec4 $B$ \u662f\u6570\u7ec4 $A$ \u4ece $P$ \u4f4d\u7f6e\u5f00\u59cb\u7684\u5b50\u6bb5\uff0c\u5219\u5c06\u6b21\u6570\u52a0\u4e00\uff0e\u6700\u540e\u5f97\u5230\u7684\u503c\u5373\u4e3a\u6570\u7ec4 $B$ \u5728\u6570\u7ec4 $A$ \u4e2d\u4f5c\u4e3a\u5b50\u6bb5\u7684\u51fa\u73b0\u6b21\u6570\uff0e\n- **\u57fa\u56e0\u6570\u7ec4**\uff1a\u6bcf\u4e2a\u7ec6\u83cc\u90fd\u6709\u4e00\u4e2a\u300c\u57fa\u56e0\u6570\u7ec4\u300d\uff0e\u5b83\u662f\u4e00\u4e2a\u503c\u57df\u4e3a $[1,k]$ \u7684\u6574\u6570\u6570\u7ec4\uff0e\n- **\u76ee\u6807\u6570\u7ec4**\uff1a\u300c\u76ee\u6807\u6570\u7ec4\u300d\u662f\u4e00\u4e2a\u503c\u57df\u4e3a $[1,k]$ \u7684\u6574\u6570\u6570\u7ec4\uff0e\u5728\u672c\u9898\u4e2d\uff0c\u6211\u4eec\u4f1a\u7ed9\u5b9a $m$ \u4e2a\u4e0d\u540c\u7684\u300c\u76ee\u6807\u6570\u7ec4\u300d\uff0c\u7b2c $i$ \u4e2a\u6570\u7ec4\u4e3a $g_i$\uff0e\n- **\u76ee\u6807\u7ec6\u83cc**\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u7ec6\u83cc\uff0c\u8bb0\u5b83\u7684\u300c\u57fa\u56e0\u6570\u7ec4\u300d\u4e3a $X$\uff0e\u6211\u4eec\u7edf\u8ba1\u6bcf\u4e2a\u300c\u76ee\u6807\u6570\u7ec4\u300d$g_1, g_2, \\dots, g_m$ \u5206\u522b\u5728 $X$ \u4e2d\u300c\u4f5c\u4e3a\u5b50\u6bb5\u7684\u51fa\u73b0\u6b21\u6570\u300d\uff0c\u5e76\u5c06\u5b83\u4eec\u6c42\u548c\uff0e\u82e5\u5f97\u5230\u7684\u548c\u4e3a **\u5947\u6570**\uff0c\u5219\u6211\u4eec\u79f0\u8fd9\u4e2a\u7ec6\u83cc\u4e3a\u4e00\u4e2a\u300c\u76ee\u6807\u7ec6\u83cc\u300d\uff0e\n- **\u57fa\u56e0\u7a81\u53d8**\uff1a\u300c\u57fa\u56e0\u7a81\u53d8\u300d\u662f\u4f5c\u7528\u4e8e\u4e00\u4e2a\u7ec6\u83cc\u7684\u53d8\u6362\uff0e\u7ed9\u5b9a\u4e00\u4e2a $k \\times k$ \u7684\u7a81\u53d8\u6982\u7387\u77e9\u9635 $p$\uff0e\u8bb0\u8fd9\u4e2a\u7ec6\u83cc\u7684\u300c\u57fa\u56e0\u6570\u7ec4\u300d\u4e3a $X$\uff0e\u5bf9\u4e8e $x$ \u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20 $X_i$\uff0c$X_i$ \u4f1a\u4ee5 $p_{X_i,j}$ \u7684\u6982\u7387\u66ff\u6362\u4e3a $j$\uff08$1 \\le j \\le k$\uff09\uff0e\u6839\u636e\u6b64\u5b9a\u4e49\uff0c\u663e\u7136\u6709 $\\forall i \\in [1,k], \\sum_{i=j}^k p_{i,j}=1$\uff0e\n\n\u4e00\u6b21\u5b9e\u9a8c\u7684\u8fc7\u7a0b\u5982\u4e0b\uff1a\n\n- \u9996\u5148\u5728\u4e00\u4e2a\u7a7a\u7684\u57f9\u517b\u76bf\u4e2d\u653e\u5165\u4e00\u4e2a\u6307\u5b9a\u7684\u7ec6\u83cc\uff0e\n- \u5728\u63a5\u4e0b\u6765\u7684\u6bcf\u5206\u949f\uff0c\u73b0\u6709\u7684\u6bcf\u4e2a\u7ec6\u83cc\u4f1a\u5206\u88c2\u6210\u4e24\u4e2a\u7ec6\u83cc\uff0c\u6bcf\u4e2a\u7ec6\u83cc\u7684\u300c\u57fa\u56e0\u6570\u7ec4\u300d\u4e0e\u539f\u7ec6\u83cc\u5b8c\u5168\u76f8\u540c\uff0e\u5206\u88c2\u4e4b\u540e\uff0c\u6bcf\u4e2a\u57fa\u56e0\u90fd\u4f1a\u8fdb\u884c\u4e00\u6b21\u300c\u57fa\u56e0\u7a81\u53d8\u300d\uff0e\n- $t$ \u5206\u949f\u540e\uff0c\u7edf\u8ba1\u57f9\u517b\u76bf\u4e2d\u300c\u76ee\u6807\u7ec6\u83cc\u300d\u7684\u6570\u91cf\uff0c\u5e76\u7ed3\u675f\u5b9e\u9a8c\uff0e\n\n\u73b0\u5728\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u300c\u57fa\u56e0\u6570\u7ec4\u300d$s$\uff0e\u5bf9\u4e8e $s$ \u7684\u6bcf\u4e2a\u524d\u7f00\u6570\u7ec4 $s[1,1],s[1,2],\\dots,s[1,n]$\uff0c\u5047\u8bbe\u8be5\u6570\u7ec4\u662f\u5b9e\u9a8c\u5f00\u59cb\u65f6\u653e\u5165\u7684\u7ec6\u83cc\u7684\u300c\u57fa\u56e0\u6570\u7ec4\u300d\uff0c\u8bf7\u4f60\u6c42\u51fa\u5b9e\u9a8c\u7ed3\u675f\u65f6\u5f97\u5230\u7684\u300c\u76ee\u6807\u7ec6\u83cc\u300d\u7684\u6570\u91cf\u7684\u671f\u671b\uff0c\u5bf9 $10^9+7$ \u53d6\u6a21\uff0e\n",
    "inputFormat": "- \u7b2c\u4e00\u884c\u8f93\u5165\u56db\u4e2a\u6574\u6570\uff0c$n,m,k,t$\uff0e\n- \u7b2c\u4e8c\u884c\u8f93\u5165 $n$ \u4e2a\u6574\u6570\uff0c\u63cf\u8ff0\u6570\u7ec4 $s$\uff0e\n- \u63a5\u4e0b\u6765\u8f93\u5165 $m$ \u884c\uff0e\u6bcf\u884c\u7b2c\u4e00\u4e2a\u6574\u6570 $|g_i|$ \u8868\u793a\u300c\u76ee\u6807\u6570\u7ec4\u300d$g_i$\u00a0\u7684\u957f\u5ea6\uff0e\u63a5\u4e0b\u6765 $|g_i|$\u00a0\u4e2a\u6574\u6570\u63cf\u8ff0\u300c\u76ee\u6807\u6570\u7ec4\u300d$g_i$\uff0e\n- \u7531\u4e8e $p$ \u77e9\u9635\u4e3a\u5b9e\u6570\u77e9\u9635\uff0c\u8f93\u5165\u4e0d\u65b9\u4fbf\uff0c\u56e0\u6b64\u6211\u4eec\u91c7\u7528\u53e6\u4e00\u79cd\u65b9\u5f0f\u8f93\u5165 $p$ \u77e9\u9635\uff0e\u5177\u4f53\u800c\u8a00\uff0c\u63a5\u4e0b\u6765\u8f93\u5165 $k$ \u884c\uff0c\u6bcf\u884c\u5305\u542b $k$ \u4e2a\u6574\u6570\uff0c\u63cf\u8ff0\u4e00\u4e2a $k \\times k$ \u7684\u77e9\u9635 $p'$\uff0e\u5219\u6709\n\n$$\np_{i,j}=\\frac{p'_{i,j}}{\\sum_{l=1}^k p'_{i,l}}.\n$$\n",
    "outputFormat": "- \u8f93\u51fa $n$ \u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u6574\u6570\uff0e\u8868\u793a\u5047\u8bbe\u4ee5 $s[1,i]$ \u4e3a\u521d\u59cb\u7ec6\u83cc\u7684\u300c\u57fa\u56e0\u6570\u7ec4\u300d\uff0c\u5b9e\u9a8c\u7ed3\u675f\u540e\u80fd\u5f97\u5230\u7684\u300c\u76ee\u6807\u7ec6\u83cc\u300d\u7684\u6570\u91cf\u7684\u671f\u671b\uff0c\u5bf9 $10^9+7$ \u53d6\u6a21\uff0e",
    "samples": [
        [
            "2 2 2 1\n1 1\n1 1\n2 2 2\n1 1\n1 1",
            "1\n500000005"
        ],
        [
            "5 5 5 1\n1 4 2 3 3\n3 1 1 4\n3 5 1 4\n4 1 4 1 4\n2 5 3\n1 5\n9 9 8 2 4\n4 3 5 3 2\n1 4 7 4 8\n3 6 4 7 1\n1 4 5 1 4",
            "250000002\n273809526\n931547626\n97163867\n377852186"
        ]
    ],
    "hint": "### \u6837\u4f8b\u89e3\u91ca\n\n#### \u6837\u4f8b \\#1\n\n- \u5f53\u524d\u7f00\u957f\u5ea6\u4e3a $1$ \u65f6\uff0c\u521d\u59cb\u7ec6\u83cc\u7684\u300c\u57fa\u56e0\u6570\u7ec4\u300d\u4e3a $\\{1\\}$\uff0e\u5206\u88c2\u4e00\u6b21\u540e\u53d8\u4e3a $\\{1\\}$ \u548c $\\{2\\}$ \u7684\u6982\u7387\u5747\u4e3a $\\frac 1 2$\uff0e\u82e5\u53d8\u4e3a $\\{1\\}$\uff0c\u5219\u662f\u300c\u76ee\u6807\u7ec6\u83cc\u300d\uff1b\u82e5\u53d8\u4e3a $\\{2\\}$\uff0c\u5219\u4e0d\u662f\u300c\u76ee\u6807\u7ec6\u83cc\u300d\uff0e\u5206\u88c2\u4e00\u6b21\u540e\u57f9\u517b\u76bf\u4e2d\u6709 $2$ \u4e2a\u7ec6\u83cc\uff0c\u6545\u300c\u76ee\u6807\u7ec6\u83cc\u300d\u603b\u6570\u7684\u671f\u671b\u4e3a $\\frac 1 2\\times 2=1$\uff0e  \n![](https://cdn.luogu.com.cn/upload/image_hosting/ytz7qxkl.png)\n- \u5f53\u524d\u7f00\u957f\u5ea6\u4e3a $2$ \u65f6\uff0c\u521d\u59cb\u7ec6\u83cc\u7684\u300c\u57fa\u56e0\u6570\u7ec4\u300d\u4e3a $\\{1, 1\\}$\uff0e\u5206\u88c2\u4e00\u6b21\u540e\u7684\u7ec6\u83cc\u53d8\u4e3a $\\{1, 1\\}, \\{1, 2\\}, \\{2, 1\\}, \\{2, 2\\}$ \u7684\u6982\u7387\u90fd\u4e3a $\\frac 1 4$\uff0e\u5176\u4e2d $\\{2, 2\\},\\{1,2\\},\\{2,1\\}$ \u5747\u4e3a\u300c\u76ee\u6807\u7ec6\u83cc\u300d\uff0c$\\{1,1\\}$ \u4e0d\u662f\u300c\u76ee\u6807\u7ec6\u83cc\u300d\uff08\u56e0\u4e3a\u51fa\u73b0\u4e86\u4e24\u6b21\u5b50\u4e32 $\\{1\\}$\uff09\uff0e\u5373\u5206\u88c2\u540e\u7684\u300c\u76ee\u6807\u7ec6\u83cc\u300d\u7684\u603b\u6570\u7684\u671f\u671b\u4e3a $\\frac 3 4$\uff0e\u5206\u88c2\u4e00\u6b21\u540e\u57f9\u517b\u76bf\u4e2d\u6709 $2$ \u4e2a\u7ec6\u83cc\uff0e\u5373\u6700\u540e\u300c\u76ee\u6807\u7ec6\u83cc\u300d\u6570\u91cf\u4e4b\u548c\u7684\u671f\u671b\u4e3a $\\frac 3 4\\times 2=\\frac 3 2$\uff0e  \n![](https://cdn.luogu.com.cn/upload/image_hosting/cjx85fuk.png)\n\n### \u6570\u636e\u8303\u56f4\n\n**\u672c\u9898\u91c7\u7528\u6346\u7ed1\u6d4b\u8bd5\uff0c\u4e14\u4e0d\u5b58\u5728\u4e00\u4e2a Subtask \u5305\u542b\u5176\u4ed6\u6240\u6709 Subtask \u7684\u6570\u636e\u8303\u56f4\u548c\u9650\u5236\uff0e**\n\n$$\n\\def{\\arraystretch}{1.5}\n\\begin{array}{|c|c|c|c|c|c|c|c|} \\hline\n\\textbf{Subtask} & \\textbf{\u5206\u503c} &\\bm{n\\le} & \\bm{m\\le} &\\bm{k\\le}&\\bm{t\\le} & \\bm {|g_i|\\le} &  \\textbf{\u7279\u6b8a\u6027\u8d28} \\cr \\hline\n1 & 1 & 10^5 & 10^5 & 100 & 0 & 10^5 \\cr \\hline\n2 & 14 & 5 & 5 & 5 & 1 & 5 \\cr \\hline\n3 & 15 & 10^3 & 1 & 10^3 & 1 & 100 & \\text{A} \\cr \\hline\n4 & 30 & 5\\times 10^4 & 5 & 10 & 1 & 50 & \\text{B} \\cr \\hline\n5 & 20 & 5\\times 10^4 & 5 & 10 & 10^3 & 50 \\cr \\hline\n6 & 20 & 10^3 & 10^4 & 10 & 10^3 &  10^4 & \\text{C}\\cr \\hline\n\\end{array}\n$$\n\n- **\u7279\u6b8a\u6027\u8d28** $\\textbf{A}$\uff1a\u5bf9\u4e8e $i=1,2,\\dots,m$\uff0c\u4fdd\u8bc1 $g_{i}$ \u4e2d\u6240\u6709\u6574\u6570\u5747\u4e3a $1$\n- **\u7279\u6b8a\u6027\u8d28** $\\textbf{B}$\uff1a\u5bf9\u4e8e $i=1,2,\\dots, k$\uff0c$j=1,2,\\dots,k$\uff0c\u4fdd\u8bc1 $p'_{i,j}=1$ \n- **\u7279\u6b8a\u6027\u8d28** $\\textbf{C}$\uff1a\u4fdd\u8bc1 $\\sum_{i=1}^m |g_i|\\le 10^4$\n\n\u5bf9\u4e8e\u6240\u6709\u6570\u636e\uff0c\u4fdd\u8bc1 $1\\le n,m,\\sum|g_i| \\le 10^5$\uff0e$0\\le t\\le 10^3$\uff0c$0\\le p'_{i,j} \\le 10^9$\uff0e\u4e14 $p'$ \u77e9\u9635\u4e0d\u4f1a\u51fa\u73b0\u67d0\u4e00\u884c\u7684\u548c\u5728\u6a21 $10^9+7$ \u610f\u4e49\u4e0b\u4e3a $0$\uff0e\n"
}
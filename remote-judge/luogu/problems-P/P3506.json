{
    "description": "This task is a harder version of task Monotonicity from the third stage of 17th Polish OI. It wasn't used in the contest itself.\n\nFor an integer sequence ![](http://main.edu.pl/images/OI17/mot-en-tex.1.png) we define its monotonicity scheme as the sequence    ![](http://main.edu.pl/images/OI17/mot-en-tex.2.png) of symbols ![](http://main.edu.pl/images/OI17/mot-en-tex.3.png), ![](http://main.edu.pl/images/OI17/mot-en-tex.4.png) or ![](http://main.edu.pl/images/OI17/mot-en-tex.5.png).\n\nThe symbol ![](http://main.edu.pl/images/OI17/mot-en-tex.6.png) represents the relation between ![](http://main.edu.pl/images/OI17/mot-en-tex.7.png) and ![](http://main.edu.pl/images/OI17/mot-en-tex.8.png).\n\nFor example, the monotonicity scheme of the sequence ![](http://main.edu.pl/images/OI17/mot-en-tex.9.png) is ![](http://main.edu.pl/images/OI17/mot-en-tex.10.png).\n\nWe say that an integer sequence ![](http://main.edu.pl/images/OI17/mot-en-tex.11.png) with monotonicity scheme    ![](http://main.edu.pl/images/OI17/mot-en-tex.12.png), realizes another monotonicity scheme ![](http://main.edu.pl/images/OI17/mot-en-tex.13.png)    if for every ![](http://main.edu.pl/images/OI17/mot-en-tex.14.png) it holds that ![](http://main.edu.pl/images/OI17/mot-en-tex.15.png).\n\nIn other words, the sequence ![](http://main.edu.pl/images/OI17/mot-en-tex.16.png) can be obtained by repeating the sequence    ![](http://main.edu.pl/images/OI17/mot-en-tex.17.png) and removing appropriate suffix from that repetition.\n\nFor example, the sequence ![](http://main.edu.pl/images/OI17/mot-en-tex.18.png) realizes each and every one of the following schemes:\n\n![](http://main.edu.pl/images/OI17/mot-en-tex.19.png)           ![](http://main.edu.pl/images/OI17/mot-en-tex.20.png)           ![](http://main.edu.pl/images/OI17/mot-en-tex.21.png)           ![](http://main.edu.pl/images/OI17/mot-en-tex.22.png)                  as well as many others.\n\nAn integer sequence ![](http://main.edu.pl/images/OI17/mot-en-tex.23.png) and a monotonicity scheme ![](http://main.edu.pl/images/OI17/mot-en-tex.24.png) are given.\n\nYour task is to find the longest subsequence ![](http://main.edu.pl/images/OI17/mot-en-tex.25.png) (![](http://main.edu.pl/images/OI17/mot-en-tex.26.png))    of the former that realizes the latter.\n\n\u7ed9\u51faN\u4e2a\u6b63\u6574\u6570a[1..N]\uff0c\u518d\u7ed9\u51faK\u4e2a\u5173\u7cfb\u7b26\u53f7\uff08>\u3001<\u6216=\uff09s[1..k]\u3002\n\n\u9009\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3aL\u7684\u5b50\u5e8f\u5217\uff08\u4e0d\u8981\u6c42\u8fde\u7eed\uff09\uff0c\u8981\u6c42\u8fd9\u4e2a\u5b50\u5e8f\u5217\u7684\u7b2ci\u9879\u548c\u7b2ci+1\u9879\u7684\u7684\u5927\u5c0f\u5173\u7cfb\u4e3as[(i-1)mod K+1]\u3002\n\n\u6c42\u51faL\u7684\u6700\u5927\u503c\u3002\n\n\u611f\u8c22@cn\uff1a\u82cf\u537f\u5ff5 \u63d0\u4f9bspj\n",
    "inputFormat": "The first line of the standard input holds two integers ![](http://main.edu.pl/images/OI17/mot-en-tex.27.png) and ![](http://main.edu.pl/images/OI17/mot-en-tex.28.png) (![](http://main.edu.pl/images/OI17/mot-en-tex.29.png), ![](http://main.edu.pl/images/OI17/mot-en-tex.30.png)),    separated by a single space, denoting the lengths of the sequences ![](http://main.edu.pl/images/OI17/mot-en-tex.31.png) and monotonicity scheme ![](http://main.edu.pl/images/OI17/mot-en-tex.32.png) respectively.\n\nThe second input line gives the sequence ![](http://main.edu.pl/images/OI17/mot-en-tex.33.png), i.e, it holds ![](http://main.edu.pl/images/OI17/mot-en-tex.34.png) integers ![](http://main.edu.pl/images/OI17/mot-en-tex.35.png) separated by single spaces (![](http://main.edu.pl/images/OI17/mot-en-tex.36.png)).\n\nFinally, the third lines gives the monotonicity scheme ![](http://main.edu.pl/images/OI17/mot-en-tex.37.png), i.e., it holds ![](http://main.edu.pl/images/OI17/mot-en-tex.38.png) s\u2026\n",
    "outputFormat": "In the first line of the standard output your program should print out a single integer ![](http://main.edu.pl/images/OI17/mot-en-tex.40.png),    the maximum length of a subsequence of ![](http://main.edu.pl/images/OI17/mot-en-tex.41.png) that realizes the scheme ![](http://main.edu.pl/images/OI17/mot-en-tex.42.png).\n\nIn the second line it should print out any such subsequence ![](http://main.edu.pl/images/OI17/mot-en-tex.43.png), separating its elements by single spaces.\n",
    "samples": [
        [
            "7 3\n2 4 3 1 3 5 3\n< > =",
            "6\n2 4 3 3 5 3"
        ]
    ],
    "hint": "$1 \\le n \\le 500000$\uff0c$1 \\le k \\le 500000$\uff0c$1 \\le a_i \\le 10^6$\uff0c$s_j \\in \\{<, >, =\\}$\n"
}
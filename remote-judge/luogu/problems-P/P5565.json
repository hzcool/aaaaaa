{
    "description": "\u5728\u5206\u522b\u7684\u5bb4\u4f1a\u4e0a\uff0c\u670b\u53cb\u4eec\u62ff\u51fa\u4ed6\u4eec\u628a\u591a\u5f69\u7684\u73e0\u5b50\u4e32\u6210\u7684\u5f69\u8272\u7684\u9879\u94fe\u3002\n\n\u9879\u94fe\u5728\u5915\u9633\u7684\u4f59\u6656\u91cc\u95ea\u95ea\u53d1\u5149\uff0c\u4ed4\u7ec6\u4e00\u770b\uff0c\u9879\u94fe\u5468\u56f4\u7adf\u7136\u5df2\u7ecf\u805a\u96c6\u4e86\u8bb8\u591a\u9e1f\u513f\uff0c\u9e1f\u513f\u4eec\u5e26\u7740 Madeline \u4e0e\u5979\u7684\u670b\u53cb\u4eec\u6765\u5230\u4e86\u4e00\u5904\u4ed6\u4eec\u4e0d\u66fe\u6765\u8fc7\u7684\u5730\u65b9\uff0c\u8fd9\u91cc\u6c47\u805a\u7740\u597d\u5927\u4e00\u7fa4\u9e1f\uff0c\u4f3c\u4e4e\u60f3\u8981\u5411\u4ed6\u4eec\u8868\u8fbe\u4e9b\u4ec0\u4e48\u3002\n\n\u7ecf\u8fc7 Madeline \u4ed4\u7ec6\u5730\u89c2\u5bdf\uff0c\u5b83\u53d1\u73b0\u4e00\u4e9b\u9e1f\u513f\u4eec\u98de\u52a8\u7684\u65b9\u5f0f\u597d\u50cf\u6392\u6210\u4e86\u4e00\u4e2a\u6709\u5e8f\u7684\u5f0f\u5b50\uff0c\u800c\u53e6\u4e00\u4e9b\u9e1f\u513f\u98de\u52a8\u7684\u65b9\u5f0f\u5219\u662f\u4e00\u4e9b\u7b26\u53f7\uff0c\u7b26\u53f7\u8868\u8fbe\u7740\u4e00\u4e2a\u95ee\u9898\u3002\n\n\u9e1f\u513f\u4eec\u8868\u8fbe\u7684\u95ee\u9898\u662f\u8fd9\u6837\u7684\uff1a\n\n\u9e1f\u513f\u4eec\u7ec4\u6210\u7684\u5f0f\u5b50\u4f1a\u7531 `(`,`)`,`^`,`&`,`|`,`0`,`1` \u548c\u5c0f\u5199\u5b57\u6bcd\u6784\u6210\uff0c\u5e76\u4e14\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\u3002\n\n\u5176\u4e2d\uff1a\n\n- `(`,`)` \u8868\u793a\u62ec\u53f7\uff0c\u5728\u62ec\u53f7\u4e2d\u7684\u8fd0\u7b97\u4f18\u5148\u7ea7\u63d0\u9ad8\u3002\n\n- `&`,`|`,`^` \u8868\u793a `\u4e0e`,`\u6216`,`\u5f02\u6216` \u4e09\u79cd\u4f4d\u8fd0\u7b97\uff0c\u8fd9\u4e09\u79cd\u8fd0\u7b97**\u4f18\u5148\u7ea7\u76f8\u540c**\n\n- `0`,`1` \u5373\u4e3a `0`,`1`\n\n- \u5c0f\u5199\u5b57\u6bcd\u8868\u793a\u53d8\u91cf\uff0c\u591a\u6b21\u51fa\u73b0\u7684\u540c\u4e00\u5c0f\u5199\u5b57\u6bcd\u8868\u793a**\u4e0d\u540c**\u7684\u53d8\u91cf\uff0c\u4e00\u4e2a\u53d8\u91cf\u53d6\u503c `0` \u6216 `1`\n\n- \u8868\u8fbe\u5f0f\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a\n\n    - \u4e00\u4e2a\u53d8\u91cf,`0`,`1` \u5747\u4e3a\u8868\u8fbe\u5f0f\n    - \u82e5 $T$ \u662f\u8868\u8fbe\u5f0f\uff0c\u5219 $(T)$ \u662f\u8868\u8fbe\u5f0f\n    - \u82e5 $S$,$T$ \u662f\u8868\u8fbe\u5f0f\uff0c\u5219$S\\&T$,$S|T$,$S\\ \\hat{}\\ T$\u5747\u4e3a\u8868\u8fbe\u5f0f\n    - \u4f8b\u5982\uff0c$(1\\ \\hat{}\\ 1\\&0)$ \u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5e76\u4e14\u8fd0\u7b97\u7ed3\u679c\u4e3a $0$\uff0c\u4f46 $(1\\&0$ \u4e0d\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\n\n\u9e1f\u513f\u4eec\u8ba4\u4e3a\uff0c\u8981\u80fd\u7b97\u51fa $1$ \u7684\u8868\u8fbe\u5f0f\u624d\u662f\u4f18\u7f8e\u7684\uff0c\u5b9a\u4e49\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u4f18\u7f8e\u5ea6\u4e3a\u5728\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u6240\u6709 $v$ \u4e2a\u53d8\u91cf\u7684 $2^v$ \u79cd\u53d6\u503c\u4e2d\u80fd\u7b97\u51fa $1$ \u7684\u65b9\u6848\u6570\u3002\n\n\u9e1f\u513f\u4eec\u8fd8\u8ba4\u4e3a\uff0c\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u548c\u8c10\u5ea6\u662f\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u7684\u6240\u6709**\u5b50\u8fde\u7eed\u8868\u8fbe\u5f0f**\u7684\u4f18\u7f8e\u5ea6\u7684\u548c\u3002(\u5305\u542b\u81ea\u8eab)\n\n\u9e1f\u513f\u4eec\u8fd8\u662f\u5584\u53d8\u7684\uff0c\u5b83\u4eec\u4f1a\u65f6\u4e0d\u65f6\u6539\u53d8\u4e00\u4e2a\u4f4d\u7f6e\u7684\u5b57\u7b26\uff0c\u4f46\u662f\u5b83\u4eec\u5411 Madeline \u548c\u5979\u7684\u670b\u53cb\u4eec\u4fdd\u8bc1\u5b83\u4eec\u4e0d\u4f1a\u6539\u53d8\u62ec\u53f7\uff0c\u5e76\u4e14\u8fdb\u884c\u4fee\u6539\u4e4b\u540e\u6574\u4e2a\u4e32\u4ecd\u7136\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\u3002\n\n\u4f60\u80fd\u5e2e\u52a9 Madeline \u548c\u5979\u7684\u670b\u53cb\u4eec\u7b97\u51fa\u6bcf\u6b21\u4fee\u6539\u540e\u6574\u4e2a\u8868\u8fbe\u5f0f\u7684\u548c\u8c10\u5ea6\u5417\uff1f\n\n\u9e1f\u513f\u4eec\u8fd8\u8bf4\uff0c\u56e0\u4e3a\u8868\u8fbe\u5f0f\u53ef\u80fd\u592a\u548c\u8c10\u4e86\uff0c\u56e0\u6b64 Madeline \u53ef\u4ee5\u53ea\u56de\u7b54\u548c\u8c10\u5ea6\u5bf9 $998244353$ \u53d6\u6a21\u540e\u7684\u503c\u3002",
    "inputFormat": "\u7b2c\u4e00\u884c\u4e3a\u4e00\u4e2a\u6570 $m$ ,\u8868\u793a\u4fee\u6539\u6570\n\n\u7b2c\u4e8c\u884c\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u521d\u59cb\u8868\u8fbe\u5f0f\n\n\u4e4b\u540e $m$ \u884c\uff0c\u6bcf\u4e00\u884c\u4e00\u4e2a\u6570 $a$ \u548c\u4e00\u4e2a\u5b57\u7b26 $b$ \uff0c\u8868\u793a\u9e1f\u513f\u4eec\u5c06 $a$ \u4f4d\u7f6e\u5b57\u7b26\u53d8\u6210 $b$ \n\n\u5728\u8f93\u5165\u7684\u8868\u8fbe\u5f0f\u4e2d\uff0c\u4e00\u4e2a\u5c0f\u5199\u5b57\u6bcd\u4ee3\u8868\u4e00\u4e2a\u53d8\u91cf\u3002(\u6ce8\u610f\u4e00\u4e2a\u5b57\u6bcd\u53ef\u80fd\u51fa\u73b0\u591a\u6b21\uff0c\u4f46\u4ee3\u8868**\u4e0d\u540c**\u53d8\u91cf)",
    "outputFormat": "$m$ \u884c\uff0c\u7b2c $i$ \u884c\u4e3a\u7b2c $i$ \u6b21\u4fee\u6539\u540e\u7684\u6743\u503c\u3002\u7531\u4e8e\u548c\u8c10\u5ea6\u53ef\u80fd\u5f88\u5927\uff0c\u4f60\u9700\u8981\u5bf9 $998244353$ \u53d6\u6a21\u3002",
    "samples": [
        [
            "5\n(1&b)\n3 |\n2 a\n3 &\n3 ^\n4 1",
            "6\n8\n4\n6\n4"
        ],
        [
            "10\n1|a&1&(0&0|1)&1^1^a\n1 0\n10 1\n2 &\n1 a\n14 ^\n4 |\n17 0\n4 ^\n15 a\n15 1\n",
            "29\n30\n27\n35\n35\n43\n35\n35\n56\n35"
        ],
        [
            "30\n0|0&0^(a&a&(1^0&0^0)^0&1)|0&a|1|(a&a|0|1|0^a&0&a|(a^0&1|a|a)^a|a&0&0)^a\n71 1\n51 0\n57 0\n65 &\n26 |\n5 a\n71 a\n56 |\n4 &\n41 ^\n52 |\n52 ^\n59 a\n44 0\n54 ^\n65 &\n51 a\n36 1\n16 ^\n1 1\n52 ^\n2 |\n59 0\n58 |\n37 ^\n55 1\n10 1\n26 ^\n18 |\n44 0\n",
            "21323\n10686\n5360\n5360\n5360\n8469\n16277\n16277\n16277\n16277\n16277\n16277\n16277\n8223\n8253\n8253\n16354\n8359\n8385\n8394\n8394\n8394\n4262\n4262\n4262\n4262\n2430\n2430\n2430\n2430"
        ],
        [
            "20\na^1&0^1^1&1&a&1^a|1&a|0&a^a^1^a^0&1^a&a|a|1^0|a|0^1^a|0^0&1&1&a&a|0^0&a&1&a|a&a^a|0^a^a|a^1|a|1^a|0|a^0&0&0|a|a|a^0^1&0^1&a|1&0\n8 ^\n28 |\n100 ^\n119 a\n40 &\n105 1\n31 1\n125 1\n53 1\n98 &\n98 &\n98 &\n52 &\n2 ^\n38 |\n6 ^\n58 ^\n106 |\n12 ^\n57 1",
            "957521426\n957521583\n874091659\n57281108\n57278566\n140708493\n120472431\n120472431\n561701787\n551192201\n551192201\n551192201\n551120577\n551120577\n551121853\n551121853\n551178140\n656274015\n656274025\n656222855"
        ]
    ],
    "hint": "\u8bbe $n$ \u4e3a\u8868\u8fbe\u5f0f\u4e2d\u53d8\u91cf\u548c $0,1$ \u7684\u4e2a\u6570\uff0c$len$ \u4e3a\u8868\u8fbe\u5f0f\u957f\u5ea6\n\n\u6709subtask\n\n\u5bf9\u4e8e $ 5\\% $ \u7684\u6570\u636e, $ n \\leq 12 , len \\leq 50 , m \\leq 50 $,1s\n\n\u5bf9\u4e8e\u989d\u5916 $ 10\\% $ \u7684\u6570\u636e, $ n \\leq 150,len \\leq 400,m \\leq 200$\n\n\u5bf9\u4e8e\u989d\u5916 $ 10\\% $ \u7684\u6570\u636e, $ n \\leq 10^5,len \\leq 2\\times 10^5,m \\leq 10$ ,\u6ca1\u6709\u62ec\u53f7\n\n\u5bf9\u4e8e\u989d\u5916 $ 10\\% $ \u7684\u6570\u636e, $ n \\leq 10^5,len \\leq 2\\times 10^5,m \\leq 10^5 $ ,\u6ca1\u6709\u62ec\u53f7\n\n\u5bf9\u4e8e\u524d $ 50\\% $ \u7684\u6570\u636e, $ n \\leq 10^5,len \\leq 4\\times 10^5,m \\leq 10^5 $ ,\u4fdd\u8bc1\u62ec\u53f7\u968f\u673a\u751f\u6210\n\n\u5bf9\u4e8e $ 100\\% $ \u7684\u6570\u636e, $ n \\leq 10^5,len \\leq 4\\times 10^5,m \\leq 10^5 ,len-2\\times n \\leq 2 \\times 10^5$ \n\n\u5bf9\u4e8e\u540e $ 95\\% $ \u7684\u6570\u636e\uff0c\u65f6\u9650\u4e3a3s"
}
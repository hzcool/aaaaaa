{
    "description": "City map is an undirected graph consisting of n intersections denoted with integers from 1 to n and m two-way streets. Each street is assigned a priority \u2013 a non-negative integer. When requesting a map, the client selects a threshold priority p. The original map is then copied and converted to the exported map using the following procedure:\n\n1. All streets whose priority is lower than p are deleted. \n\n2. For each intersection i from 1,2,...,n (processed in that order): \n\n(a) If the intersection i is not connected to any streets it is deleted. \n\n(b) If the intersection i is connected to exactly two different streets x and y leading to intersections a and b both different from i then the intersection i is contracted using the following procedure: \n\ni. Streets x and y are deleted. \n\nii. Intersection i is deleted. \n\niii. New street z connecting intersections a and b is added.\n\n![](https://cdn.luogu.com.cn/upload/pic/16236.png )\n\nInitially, the map does not contain loops (loop is a street that connects an intersection to itself) or parallel edges (more than one street between the same pair of intersections), but the loops and parallel edges may form during the contraction procedure. Notice that, in the step 2. (b) above, neither x nor y can be a loop (both a and b have to be different from i), but the newly added street z could be a loop (it is possible that a and b are same). \n\nGiven a map and a sequence of incoming export requests, for each request \ufb01nd the number of intersections and the number of streets in the exported map.",
    "inputFormat": "The \ufb01rst line contains two integers n (1 \u2264 n \u2264 300000) and m (1 \u2264 m \u2264 300000) \u2013 the number of intersections and the number of streets, respectively. Each of the following m lines contains three integers a, b and p (1\u2264 a,b\u2264n,0\u2264 p\u2264300000) which describe a street with priority p connecting intersections a and b. No street connects an intersection to itself. There is at most one street between every two intersections. \n\nThe following line contains an integer q (1 \u2264 q \u2264 300000) \u2013 the number of export requests. The following line contains q integers. The k-th integer tk (0\u2264tk \u2264300000) is the threshold priority of the k-th request.",
    "outputFormat": "Output should consist of q lines. The k-th line should contain two integers\u2013the number of intersections and the number of streets, respectively, in the exported map for the k-th request.",
    "samples": [
        [
            "6 7 \n1 2 20 \n2 3 80 \n2 5 100 \n3 5 50 \n3 4 100 \n5 6 90 \n4 6 100 \n4 \n25 75 85 95",
            "2 3 \n1 1 \n2 1 \n4 2\n"
        ],
        [
            "10 14 \n2 7 150 \n1 2 100 \n2 3 150 \n3 1 200 \n1 4 60 \n4 5 20 \n2 5 100 \n5 6 90 \n6 7 120 \n7 5 130 \n6 8 50 \n8 9 200 \n9 10 200 \n10 7 200 \n5 \n300 50 95 100 110",
            "0 0 \n6 9 \n4 5 \n4 5 \n5 4"
        ]
    ],
    "hint": "Central Europe Regional Contest 2015 Problem E",
    "translation": "#### \u9898\u610f\u7ffb\u8bd1\uff1a\n\nLuka \u62e5\u6709\u4e00\u4e2a\u5730\u7406\u6570\u636e\u516c\u53f8\u4fdd\u6301\u7740\u8be6\u7ec6\u7684\u57ce\u5e02\u5730\u56fe\u548c\u51fa\u53e3\u76f8\u5173\u7684\u6570\u636e\u3002\u4f46\u662f\u901a\u5e38\u5ba2\u6237\u4e0d\u60f3\u8981\u5b8c\u6574\u7684\u5730\u56fe\u3002\u76f8\u53cd\uff0c\u4ed6\u4eec\u66f4\u60f3\u8981\u4e00\u4e2a\u53ea\u5305\u542b\u4e3b\u8981\u8857\u9053\u7684\u7b80\u5355\u5730\u56fe\uff1a\n\n1. \u6240\u6709\u4f18\u5148\u7ea7\u5c0f\u4e8e $p$ \u7684\u8857\u9053\u88ab\u5220\u9664\n\n1. \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8def\u53e3\u70b9 $i$ \u4ece $1$ \u5230 $n$\uff08\u6309\u7167\u8fd9\u4e2a\u987a\u5e8f\u5904\u7406\uff09\uff1a\n\n   (a)\u5982\u679c\u8fd9\u4e2a\u8def\u53e3\u6ca1\u6709\u8fde\u63a5\u5230\u4efb\u4f55\u8857\u9053\uff0c\u5b83\u5c31\u4f1a\u88ab\u5220\u9664\u3002\n\n   (b)\u5982\u679c\u8def\u53e3 $i$ \u6b63\u597d\u8fde\u63a5\u5230\u4e24\u4e2a\u4e0d\u540c\u7684\u8857\u9053 $x$ \u548c $y$\uff0c\u5bfc\u81f4 $a$ \u548c $b$ \u4e24\u4e2a\u8def\u53e3\u90fd\u4e0e\u8def\u53e3 $i$ \u4e0d\u540c\uff0c\u90a3\u4e48 $i$ \u5c31\u4f1a\u6839\u636e\u4e0b\u9762\u7684\u8fc7\u7a0b\u8fdb\u884c\u6536\u7f29\uff1a\n\n   i.\u5220\u9664\u9053\u8def $x$ \u548c\u9053\u8def $y$\uff1b\n\n   ii.\u5220\u9664\u8def\u53e3 $i$\uff1b\n\n   iii.\u52a0\u5165\u4e00\u4e2a\u8fde\u63a5\u8def\u53e3 $a$ \u548c $b$ \u7684\u65b0\u9053\u8def $z$\uff1b\n\n\u6700\u521d\uff0c\u56fe\u4e2d\u6ca1\u6709\u73af\uff08\u5373\u4e00\u6761\u8fde\u63a5\u5230\u81ea\u8eab\u7684\u8fb9\uff09\u6216\u8005\u5e73\u884c\u7684\u8fb9\uff08\u5373\u5728\u540c\u4e00\u5bf9\u4ea4\u70b9\u4e4b\u95f4\u6709\u4e00\u6761\u4ee5\u4e0a\u7684\u8fb9\uff09\uff0c\u4f46\u5728\u6536\u7f29\u7684\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u5f62\u6210\u73af\u548c\u5e73\u884c\u8fb9\u3002\n\n\u8bf7\u6ce8\u610f\uff0c\u5728\u6b65\u9aa42.\uff08b\uff09\u4e4b\u524d\uff0c$x$ \u548c $y$ \u90fd\u4e0d\u80fd\u662f\u73af\uff08\u5373 $a$ \u548c $b$ \u5fc5\u987b\u548c $i$ \u4e0d\u540c\uff09\uff0c\u4f46\u662f\u65b0\u589e\u7684 $z$ \u53ef\u4ee5\u662f\u4e00\u4e2a\u73af\uff08\u5373 $a$ \u548c $b$ \u53ef\u80fd\u662f\u76f8\u540c\u7684\uff09\u3002\n\n\u7ed9\u5b9a\u4e00\u4e2a\u5730\u56fe\u548c\u4e00\u7cfb\u5217\u7684\u51fa\u53e3\u7684\u8be2\u95ee,\u6bcf\u4e2a\u8be2\u95ee\u627e\u5230\u8def\u53e3\u7684\u6570\u91cf\u548c\u8857\u9053\u5730\u56fe\u51fa\u53e3\u7684\u6570\u91cf\u3002\n\n#### \u8f93\u5165\u683c\u5f0f\uff1a\n\u7b2c\u4e00\u884c\u5305\u542b\u4e24\u4e2a\u6574\u6570 $n(1 \\le n\\le3\\times10^5)$ \u548c $m(1\\le m\\le 3\\times10^5)$ \u5206\u522b\u662f\u70b9\u548c\u8fb9\u7684\u6570\u91cf\u3002\n\n\u540e\u9762 $m$ \u884c\u5305\u542b\u4e09\u4e2a\u6574\u6570\u5206\u522b\u662f $a,b$ \u548c $p(1\\le a,b \\le n,0\\le p\\le 3\\times10^5)$ \u7528\u6765\u63cf\u8ff0 $a,b$ \u4e4b\u95f4\u8fb9\u7684\u4f18\u5148\u7ea7 $p$\uff0c\u6ca1\u6709\u4e00\u6761\u8fb9\u53ea\u8fde\u63a5\u4e00\u4e2a\u70b9\uff0c\u4e24\u4e2a\u70b9\u4e4b\u95f4\u6700\u591a\u6709\u4e00\u6761\u8fb9\u3002\n\n\u7b2c $m+2$ \u884c\u5305\u542b\u4e00\u4e2a\u6574\u6570 $q(1\\le q\\le 3\\times10^5)$ \u8868\u793a\u8be2\u95ee\u7684\u4e2a\u6570\uff0c\u4e0b\u4e00\u884c\u6709 $q$ \u4e2a\u6574\u6570\uff0c\u7b2c $k$ \u4e2a\u6574\u6570 $t_k(0\\le tk\\le 3\\times10^5)$ \u662f\u7b2c $k$ \u6b21\u8be2\u95ee\u7684\u4f18\u5148\u7ea7\u3002\n\n#### \u8f93\u51fa\u683c\u5f0f\uff1a\n\u8f93\u51fa\u5305\u62ec $q$ \u884c\u3002\u7b2c $k$ \u884c\u5305\u542b\u4e24\u4e2a\u6574\u6570\uff0c\u5206\u522b\u662f\u7b2c $k$ \u6b21\u8be2\u95ee\u7684\u70b9\u548c\u8fb9\u7684\u4e2a\u6570\u3002"
}
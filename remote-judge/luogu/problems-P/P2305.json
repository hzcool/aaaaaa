{
    "description": "\u4eca\u5e74\u590f\u5929\uff0cNOI \u5728 SZ \u5e02\u8fce\u6765\u4e86\u5979\u4e09\u5341\u5468\u5c81\u7684\u751f\u65e5\u3002\u6765\u81ea\u5168\u56fd $n$ \u4e2a\u57ce\u5e02\u7684 OIer \u4eec\u90fd\u4f1a\u4ece\u5404\u5730\u51fa\u53d1\uff0c\u5230 SZ \u5e02\u53c2\u52a0\u8fd9\u6b21\u76db\u4f1a\u3002\n\n\u5168\u56fd\u7684\u57ce\u5e02\u6784\u6210\u4e86\u4e00\u68f5\u4ee5 SZ \u5e02\u4e3a\u6839\u7684\u6709\u6839\u6811\uff0c\u6bcf\u4e2a\u57ce\u5e02\u4e0e\u5b83\u7684\u7236\u4eb2\u7528\u9053\u8def\u8fde\u63a5\u3002\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u5c06\u5168\u56fd\u7684 $n$ \u4e2a\u57ce\u5e02\u7528 $1\\sim n$ \u7684\u6574\u6570\u7f16\u53f7\u3002\u5176\u4e2d SZ \u5e02\u7684\u7f16\u53f7\u4e3a $1$\u3002\u5bf9\u4e8e\u9664 SZ \u5e02\u4e4b\u5916\u7684\u4efb\u610f\u4e00\u4e2a\u57ce\u5e02 $v$\uff0c\u6211\u4eec\u7ed9\u51fa\u4e86\u5b83\u5728\u8fd9\u68f5\u6811\u4e0a\u7684\u7236\u4eb2\u57ce\u5e02 $f_v$  \u4ee5\u53ca\u5230\u7236\u4eb2\u57ce\u5e02\u9053\u8def\u7684\u957f\u5ea6 $s_v$\u3002\n\n\u4ece\u57ce\u5e02 $v$ \u524d\u5f80 SZ \u5e02\u7684\u65b9\u6cd5\u4e3a\uff1a\u9009\u62e9\u57ce\u5e02 $v$ \u7684\u4e00\u4e2a\u7956\u5148 $a$\uff0c\u652f\u4ed8\u8d2d\u7968\u7684\u8d39\u7528\uff0c\u4e58\u5750\u4ea4\u901a\u5de5\u5177\u5230\u8fbe $a$\u3002\u518d\u9009\u62e9\u57ce\u5e02 $a$ \u7684\u4e00\u4e2a\u7956\u5148 $b$\uff0c\u652f\u4ed8\u8d39\u7528\u5e76\u5230\u8fbe $b$\u3002\u4ee5\u6b64\u7c7b\u63a8\uff0c\u76f4\u81f3\u5230\u8fbe SZ \u5e02\u3002\n\n\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u57ce\u5e02 $v$\uff0c\u6211\u4eec\u4f1a\u7ed9\u51fa\u4e00\u4e2a\u4ea4\u901a\u5de5\u5177\u7684\u8ddd\u79bb\u9650\u5236 $l_v$\u3002\u5bf9\u4e8e\u57ce\u5e02 $v$ \u7684\u7956\u5148 A\uff0c\u53ea\u6709\u5f53\u5b83\u4eec\u4e4b\u95f4\u6240\u6709\u9053\u8def\u7684\u603b\u957f\u5ea6\u4e0d\u8d85\u8fc7 $l_v$  \u65f6\uff0c\u4ece\u57ce\u5e02 $v$ \u624d\u53ef\u4ee5\u901a\u8fc7\u4e00\u6b21\u8d2d\u7968\u5230\u8fbe\u57ce\u5e02 A\uff0c\u5426\u5219\u4e0d\u80fd\u901a\u8fc7\u4e00\u6b21\u8d2d\u7968\u5230\u8fbe\u3002  \n\n\u5bf9\u4e8e\u6bcf\u4e2a\u57ce\u5e02 $v$\uff0c\u6211\u4eec\u8fd8\u4f1a\u7ed9\u51fa\u4e24\u4e2a\u975e\u8d1f\u6574\u6570 $p_v,q_v$  \u4f5c\u4e3a\u7968\u4ef7\u53c2\u6570\u3002\u82e5\u57ce\u5e02 $v$ \u5230\u57ce\u5e02 A \u6240\u6709\u9053\u8def\u7684\u603b\u957f\u5ea6\u4e3a $d$\uff0c\u90a3\u4e48\u4ece\u57ce\u5e02 $v$ \u5230\u57ce\u5e02 A \u8d2d\u4e70\u7684\u7968\u4ef7\u4e3a $dp_v+q_v$\u3002\n\n\u6bcf\u4e2a\u57ce\u5e02\u7684 OIer \u90fd\u5e0c\u671b\u81ea\u5df1\u5230\u8fbe SZ \u5e02\u65f6\uff0c\u7528\u4e8e\u8d2d\u7968\u7684\u603b\u8d44\u91d1\u6700\u5c11\u3002\u4f60\u7684\u4efb\u52a1\u5c31\u662f\uff0c\u544a\u8bc9\u6bcf\u4e2a\u57ce\u5e02\u7684 OIer \u4ed6\u4eec\u6240\u82b1\u7684\u6700\u5c11\u8d44\u91d1\u662f\u591a\u5c11\u3002\n",
    "inputFormat": "\u7b2c\u4e00\u884c\u5305\u542b\u4e24\u4e2a\u975e\u8d1f\u6574\u6570 $n,t$\uff0c\u5206\u522b\u8868\u793a\u57ce\u5e02\u7684\u4e2a\u6570\u548c\u6570\u636e\u7c7b\u578b\uff08\u5176\u610f\u4e49\u5c06\u5728\u300c\u63d0\u793a\u4e0e\u8bf4\u660e\u300d\u4e2d\u63d0\u5230\uff09\u3002\n\n\u63a5\u4e0b\u6765 $2 \\sim n$ \u884c\uff0c\u6bcf\u884c\u63cf\u8ff0\u4e00\u4e2a\u9664 SZ \u4e4b\u5916\u7684\u57ce\u5e02\u3002\u5176\u4e2d\u7b2c $v$ \u884c\u5305\u542b\u4e94\u4e2a\u975e\u8d1f\u6574\u6570 $f_v,s_v,p_v,q_v,l_v$\uff0c\u5206\u522b\u8868\u793a\u57ce\u5e02 $v$ \u7684\u7236\u4eb2\u57ce\u5e02\uff0c\u5b83\u5230\u7236\u4eb2\u57ce\u5e02\u9053\u8def\u7684\u957f\u5ea6\uff0c\u7968\u4ef7\u7684\u4e24\u4e2a\u53c2\u6570\u548c\u8ddd\u79bb\u9650\u5236\u3002\n\n\u8bf7\u6ce8\u610f\uff1a\u8f93\u5165\u4e0d\u5305\u542b\u7f16\u53f7\u4e3a 1 \u7684 SZ \u5e02\uff0c\u7b2c $2\\sim n$ \u884c\u5206\u522b\u63cf\u8ff0\u7684\u662f\u57ce\u5e02 $2$ \u5230\u57ce\u5e02 $n$\u3002\n",
    "outputFormat": "\u8f93\u51fa\u5305\u542b $n-1$ \u884c\uff0c\u6bcf\u884c\u5305\u542b\u4e00\u4e2a\u6574\u6570\u3002\n\n\u5176\u4e2d\u7b2c $v$ \u884c\u8868\u793a\u4ece\u57ce\u5e02 $v+1$ \u51fa\u53d1\uff0c\u5230\u8fbe SZ \u5e02\u6700\u5c11\u7684\u8d2d\u7968\u8d39\u7528\u3002\n\n\u540c\u6837\u8bf7\u6ce8\u610f\uff1a\u8f93\u51fa\u4e0d\u5305\u542b\u7f16\u53f7\u4e3a 1 \u7684 SZ \u5e02\u3002\n",
    "samples": [
        [
            "7 3 \n1 2 20 0 3 \n1 5 10 100 5 \n2 4 10 10 10 \n2 9 1 100 10 \n3 5 20 100 10 \n4 4 20 0 10 \n",
            "40 \n150 \n70 \n149 \n300 \n150"
        ]
    ],
    "hint": "\u4ece\u6bcf\u4e2a\u57ce\u5e02\u51fa\u53d1\u5230\u8fbe SZ \u7684\u8def\u7ebf\u5982\u4e0b\uff08\u5176\u4e2d\u7bad\u5934\u8868\u793a\u4e00\u6b21\u76f4\u8fbe\uff09\uff1a\n\n\u57ce\u5e02 $2$\uff1a\u53ea\u80fd\u9009\u62e9 $2 \\rightarrow 1$\uff0c\u82b1\u8d39\u4e3a $2 \\times 20 + 0 = 40$\u3002\n\n\u57ce\u5e02 $3$\uff1a\u53ea\u80fd\u9009\u62e9 $3 \\rightarrow 1$\uff0c\u82b1\u8d39\u4e3a $5 \\times 10 + 100 = 150$\u3002\n\n\u57ce \u5e02 $4$ \uff1a \u7531\u4e8e $4 + 2 =6 \\leq l_4 = 10$\uff0c\u6545\u53ef\u4ee5\u9009\u62e9 $4\\rightarrow1$\u3002\u82e5\u9009\u62e9 $4 \\rightarrow 1$\uff0c\u82b1\u8d39\u4e3a $(4 +2) \\times 10 + 10 = 70$ \uff1b \u82e5\u9009\u62e9 $4 \\rightarrow 2 \\rightarrow 1$\uff0c\u5219\u82b1\u8d39\u4e3a $(4\\times 10 + 10) + (2 \\times  20 + 0) =90$\uff1b\u56e0\u6b64\u9009\u62e9 $4 \\rightarrow 1$\u3002\n\n\u57ce\u5e02 $5$\uff1a\u53ea\u80fd\u9009\u62e9 $5\\rightarrow 2\\rightarrow 1$\uff0c\u82b1\u8d39\u4e3a $(9 \\times 1 +100) + (2 \\times  20 + 0) = 149$\uff1b\u65e0\u6cd5\u9009\u62e9 $5 \\rightarrow 1$\uff0c\u56e0\u4e3a $l_5 =10$\uff0c\u800c\u57ce\u5e02 $5$ \u5230\u57ce\u5e02 $1$ \u603b\u8def\u7a0b\u4e3a $9 + 2 = 11 \\gt 5$\uff0c\u57ce\u5e02 $5$ \u4e0d\u80fd\u76f4\u8fbe\u57ce\u5e02 $1$\u3002\n\n\u57ce\u5e02 $6$\uff1a\u82e5\u9009\u62e9 $6 \\rightarrow 1$\uff0c\u82b1\u8d39\u4e3a $(5 + 5) \\times 20 + 100 = 300$\uff1b\u82e5\u9009\u62e9 $6 \\rightarrow 3 \\rightarrow 1$\uff0c\u82b1\u8d39\u4e3a $(5 \\times 20 + 100) + (5 \\times 10 + 100) = 350$\uff1b\u56e0\u6b64\u9009\u62e9 $6 \\rightarrow 1$\u3002\n\n\u57ce\u5e02 $7$\uff1a\u9009\u62e9 $7 \\rightarrow 4 \\rightarrow 1$\uff0c\u82b1\u8d39\u4e3a $(4 \\times 20 + 0) + ((4 + 2) \\times 10 + 10) = 150$\uff1b\n\n\u5176\u4ed6\u65b9\u6848\u5747\u6bd4\u8be5\u65b9\u6848\u5dee\u3002\n\n ![](https://cdn.luogu.com.cn/upload/pic/2592.png) \n\n### \u6570\u636e\u8303\u56f4\n\n![](https://cdn.luogu.com.cn/upload/pic/2591.png)\n\n\u5bf9\u4e8e\u6240\u6709\u6570\u636e\uff0c$n\\leq 2 \\times 10^5, 0 \\leq p_v \\leq 10^6,\\ 0 \\leq q_v \\leq 10^{12},\\ 1\\leq f_v<v,\\ 0<s_v\\leq lv \\leq 2 \\times 10^{11}$\uff0c\u4e14\u4efb\u610f\u57ce\u5e02\u5230 SZ \u5e02\u7684\u603b\u8def\u7a0b\u957f\u5ea6\u4e0d\u8d85\u8fc7 $2 \\times 10^{11}$\u3002\n\n\u8f93\u5165\u7684 $t$ \u8868\u793a\u6570\u636e\u7c7b\u578b\uff0c$0\\leq t<4$\uff0c\u5176\u4e2d\uff1a\n- \u5f53 $t=0$ \u6216 $2$ \u65f6\uff0c\u5bf9\u8f93\u5165\u7684\u6240\u6709\u57ce\u5e02 $v$\uff0c\u90fd\u6709 $f_v=v-1$\uff0c\u5373\u6240\u6709\u57ce\u5e02\u6784\u6210\u4e00\u4e2a\u4ee5 SZ \u5e02\u4e3a\u7ec8\u70b9\u7684\u94fe\uff1b\n- \u5f53 $t=0$ \u6216 $1$ \u65f6\uff0c\u5bf9\u8f93\u5165\u7684\u6240\u6709\u57ce\u5e02 $v$\uff0c\u90fd\u6709 $l_v=2 \\times 10^{11}$\uff0c\u5373\u6ca1\u6709\u79fb\u52a8\u7684\u8ddd\u79bb\u9650\u5236\uff0c\u6bcf\u4e2a\u57ce\u5e02\u90fd\u80fd\u5230\u8fbe\u5b83\u7684\u6240\u6709\u7956\u5148\uff1b\n- \u5f53 $t=3$ \u65f6\uff0c\u6570\u636e\u6ca1\u6709\u7279\u6b8a\u6027\u8d28\u3002"
}
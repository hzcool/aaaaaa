{
    "description": "Farmer John has recently been experimenting with cultivating different types of grass on his farm, realizing that different types of cows like different types of grass. However, he must be careful to ensure that different types of grass are planted sufficiently far away from each-other, in order to prevent them from being inextricably mixed.\n\n\nFJ's farm consists of $N$ fields ($1 \\leq N \\leq 200,000$), where $M$ pairs of  fields are connected by bi-directional pathways ($1 \\leq M \\leq 200,000$).  Using these pathways, it is possible to walk from any field to any other field. Each pathway has an integer length in the range $1 \\ldots 1,000,000$. Any pair of fields will be linked by at most one direct pathway.\n\n\nIn each field, FJ initially plants one of $K$ types of grass ($1 \\leq K \\leq N$). Over time, however, he might decide to switch the grass in some field to a different type. He calls this an \"update\"  peration. He might perform several updates over the course of time, which are all cumulative in nature.\n\n\nAfter each update, FJ would like to know the length of the shortest path between two fields having different grass types. That is, among all pairs of fields having different grass types, he wants to know which two are closest. Ideally,\n\nthis number is large, so he can prevent grass of one type from mixing with grass of another type. It is guaranteed that the farm will always have at least two fields with different grass types.\n\n\nIn 30 percent of the input cases, each field will be directly connected to at most 10 pathways.\n\n\n",
    "inputFormat": "The first line of input contains four integers, $N$, $M$, $K$, and $Q$, where $Q$ is the number of updates ($1 \\leq Q \\leq 200,000$).\n\nThe next $M$ lines describe the paths; each one contains three integers $A$, $B$, and $L$, indicating a path from field $A$ to field $B$ (both integers in the range $1 \\ldots N$) of length $L$.\n\nThe next line indicates the initial type of grass growing in each field ($N$ integers in the range $1 \\ldots K$).\n\nFinally, the last $Q$ lines each describe an update, specified by two integers $A$ and $B$, where the grass in field $A$ is to be updated to type $B$.\n",
    "outputFormat": "For each update, print the length of the shortest path between two fields with different types of grass, after the update is applied.\n",
    "samples": [
        [
            "3 2 3 4\n1 2 3\n2 3 1\n1 1 2\n3 3\n2 3\n1 2\n2 2",
            "1\n3\n3\n1"
        ]
    ],
    "hint": "\u611f\u8c22 @\u2211\u2235\u2234\u2237  \u7684\u7ffb\u8bd1\u3002\n\n\u7b80\u4ecb\u7ffb\u8bd1by cc123321 :\n\n\u7ed9\u5b9a\u4e00\u5f20\u5e26\u6743\u65e0\u5411\u56fe\uff0c\u6bcf\u4e2a\u70b9\u6709\u4e00\u4e2a\u989c\u8272\uff0c\u6bcf\u6b21\u6539\u53d8\u4e00\u4e2a\u70b9\u7684\u989c\u8272\uff0c\u8981\u6c42\u4f60\u5728\u64cd\u4f5c\u540e\u8f93\u51fa\u8fd9\u4e2a\u56fe\u4e2d\u6700\u8fd1\u5f02\u8272\u70b9\u5bf9\u4e4b\u95f4\u7684\u8ddd\u79bb\u6700\u8fd1\u5f02\u8272\u70b9\u5bf9\u5b9a\u4e49\u4e3a\uff1a\u4e00\u5bf9\u70b9\u989c\u8272\u4e0d\u540c\uff0c\u4e14\u8ddd\u79bb\u6700\u5c0f\n",
    "translation": "\u519c\u592b\u7ea6\u7ff0\u6700\u8fd1\u4e00\u76f4\u5728\u5728\u4ed6\u7684\u519c\u573a\u8bd5\u79cd\u5404\u79cd\u7c7b\u578b\u7684\u8349\uff0c\u4ed6\u53d1\u73b0\u4e0d\u540c\u7c7b\u578b\u7684\u725b\uff0c\u559c\u6b22\u4e0d\u540c\u7c7b\u578b\u7684\u8349\u3002 \u7136\u800c\uff0c\u4ed6\u5fc5\u987b\u6ce8\u610f\uff0c\u5728\u79cd\u8349\u65f6\uff0c\u4e0d\u540c\u7c7b\u578b\u7684\u8349\uff0c\u8981\u4fdd\u6301\u8db3\u591f\u8fdc\u7684\u8ddd\u79bb\uff0c\u4ee5\u9632\u6b62\u5b83\u4eec\u6df7\u5408\u3002\n\n\n\u4ed6\u7684\u519c\u573a\u7531N\uff081\u2264N\u2264200,200\uff09\u5757\u7530\u5730\u7ec4\u6210\uff0c\u5176\u4e2d\u6709M\uff081\u2264M\u2264200,000\uff09\u5bf9\u7530\u5730\u4e2d\u7528\u5c0f\u8def\u8fde\u63a5\u3002\u4f7f\u7528\u8fd9\u4e9b\u5c0f\u8def\uff0c\u53ef\u4ee5\u4ece\u4efb\u4f55\u7530\u5730\u8d70\u5230\u4efb\u4f55\u5176\u4ed6\u7530\u5730\u3002\u6bcf\u6761\u8def\u7684\u957f\u5ea6\u57281~1,000\uff0c000\u8303\u56f4\u5185\u3002 \u4efb\u4f55\u7530\u5730\u5bf9\u5c06\u7531\u9876\u591a\u4e00\u6761\u5c0f\u8def\u8fde\u63a5\u3002\n\n\n\u5728\u6bcf\u4e2a\u9886\u57df\uff0c\u4ed6\u6700\u521d\u90fd\u662f\u79cd\u690dK\u67f1\u8349\uff081\u2264K\u2264N\uff09\u3002 \u7136\u800c\uff0c\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\uff0c\u4ed6\u53ef\u80fd\u51b3\u5b9a\u5728\u67d0\u4e9b\u9886\u57df\u5c06\u8349\u8f6c\u53d8\u4e3a\u4e0d\u540c\u54c1\u79cd\u3002 \u4ed6\u79f0\u4e4b\u4e3a\u201c\u66f4\u65b0\u201d\u3002 \u4ed6\u53ef\u80fd\u4f1a\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u6267\u884c\u591a\u4e2a\u66f4\u65b0\uff0c\u8fd9\u4e9b\u90fd\u662f\u7d2f\u79ef\u7684\u3002\n\n\n\u5728\u6bcf\u6b21\u66f4\u65b0\u4e4b\u540e\uff0c\u4ed6\u60f3\u77e5\u9053\u5177\u6709\u4e0d\u540c\u8349\u54c1\u79cd\u7684\u4e24\u4e2a\u7530\u5730\u4e4b\u95f4\u7684\u6700\u77ed\u8def\u5f84\u7684\u957f\u5ea6\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u5177\u6709\u4e0d\u540c\u8349\u54c1\u79cd\u7684\u6240\u6709\u7530\u5730\u4e2d\uff0c\u4ed6\u60f3\u77e5\u9053\u54ea\u4e24\u4e2a\u662f\u6700\u63a5\u8fd1\u7684\u3002 \u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u6570\u91cf\u5f88\u5927\uff0c\u6240\u4ee5\u4ed6\u53ef\u4ee5\u9632\u6b62\u4e00\u79cd\u54c1\u79cd\u7684\u8349\u4e0e\u53e6\u4e00\u54c1\u79cd\u8349\u7684\u6df7\u5408\u3002 \u4fdd\u8bc1\u519c\u573a\u5c06\u603b\u662f\u5177\u6709\u81f3\u5c11\u4e24\u4e2a\u5177\u6709\u4e0d\u540c\u8349\u54c1\u79cd\u7684\u7530\u5730\u3002\n\n\n\u572830\uff05\u7684\u8f93\u5165\u6570\u636e\u4e2d\uff0c\u6bcf\u4e2a\u7530\u5730\u5c06\u8fde\u63a5\u5230\u6700\u591a10\u6761\u5c0f\u8def\u3002"
}
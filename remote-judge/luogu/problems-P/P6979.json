{
    "description": "\n\nLittle Roman is studying linear congruential generators -- one of the oldest and best known pseudorandom number generator algorithms. Linear congruential generator (LCG) starts with a non-negative integer number $x_{0}$ also known as seed and produces an infinite sequence of non-negative integer numbers $x_{i} (0 \\le x_{i} < c)$ which are given by the following recurrence relation:\n\n$x_{i+1} = (ax_{i} + b)$ mod $c$\n\nhere a , $b$ , and $c$ are non-negative integer numbers and $0 \\le x_{0} < c$ .\n\nRoman is curious about relations between sequences generated by different LCGs. In particular, he has $n$ different LCGs with parameters $a^{(j)}, b^{(j)},$ and $c^{(j)}$ for $1 \\le j \\le n$ , where the j-th LCG is generating a sequence $x_{i}^{(j)}.$ He wants to pick one number from each of the sequences generated by each LCG so that the sum of the numbers is the maximum one, but is not divisible by the given integer number $k$ .\n\nFormally, Roman wants to find integer numbers $t_{j} \\ge 0$ for $1 \\le j \\le n$ to maximize $s = \u03a3^{n}_{j=1} x_{t_{j}}^{(j)} \u00a0subject$ to constraint that $s$ mod $k \u2260 0$ .\n\n",
    "inputFormat": "\n\nThe first line of the input file contains two integer numbers $n$ and $k (1 \\le n \\le 10 000 , 1 \\le k \\le 10^{9}).$ The following $n$ lines describe LCGs. Each line contains four integer numbers $x_{0}^{(j)}, a^{(j)}, b^{(j)},$ and $c^{(j)} (0 \\le a^{(j)}, b^{(j)} \\le 1000 , 0 \\le x_{0}^{(j)}\u00a0< c^{(j)} \\le 1000)$ .\n\n",
    "outputFormat": "\n\nIf Roman's problem has a solution, then write on the first line of the output file a single integer $s$ -- the maximum sum not divisible by $k$ , followed on the next line by $n$ integer numbers $t_{j} (0 \\le t_{j} \\le 10^{9})$ specifying some solution with this sum.\n\nOtherwise, write to the output file a single line with the number $\u22121$ .\n\n",
    "samples": [
        [
            "2 3\n1 1 1 6\n2 4 0 5\n",
            "8\n4 1\n"
        ],
        [
            "2 2\n0 7 2 8\n2 5 0 6\n",
            "-1\n"
        ]
    ],
    "hint": "Time limit: 1 s, Memory limit: 256 MB. \n\n",
    "translation": "### \u9898\u76ee\u63cf\u8ff0\n\n\u7f57\u66fc\u5728\u5b66\u4e60\u7ebf\u6027\u540c\u4f59\u53d1\u751f\u5668\u2014\u2014\u6700\u53e4\u8001\uff0c\u4e5f\u662f\u6700\u5e7f\u4e3a\u4eba\u77e5\u7684\u4f2a\u968f\u673a\u6570\u751f\u6210\u7b97\u6cd5\u4e4b\u4e00\u3002\u7ebf\u6027\u540c\u4f59\u53d1\u751f\u5668\uff08LCG\uff09\u4ee5 $x_0$ \u4e3a\u968f\u673a\u79cd\u5b50\uff0c\u751f\u6210\u5f88\u591a\u975e\u8d1f\u6574\u6570 $x_i$ ,\u5b83\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a\n\n\u7ed9\u5b9a\u975e\u8d1f\u6574\u6570 $a,b,c\\space(0\u2264x_0<c)$ \uff0c\n$x_{i+1} = (ax_i+b)\\space mod \\space c$\n\n\u7f57\u66fc\u5f88\u597d\u5947\u7531\u4e0d\u540cLCG\u4ea7\u751f\u7684\u5e8f\u5217\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\u7279\u522b\u5730\uff0c\u4ed6\u6709 $n$ \u4e2a\u4e0d\u540c\u7684LCG\uff0c\u542b\u6709\u53c2\u6570 $a^{(j)}, b^{(j)}, c^{(j)}\\space(1\u2264j\u2264n)$\u3002\u7b2c $j$ \u4e2aLCG\u4f1a\u751f\u6210\u4e00\u4e2a\u5e8f\u5217 $x_i^{(j)}$ \u3002\n\n\u4ed6\u5e0c\u671b\u80fd\u4ece\u6bcf\u4e2aLCG\u4ea7\u751f\u7684\u5e8f\u5217\u4e2d\u6311\u51fa\u4e00\u4e2a\u6570\uff0c\u4f7f\u4ed6\u4eec\u7684\u548c\u6700\u5927\uff0c\u4e14\u4e0d\u88ab\u7ed9\u5b9a\u7684 $k$ \u6574\u9664\u3002\n\n**\u683c\u5f0f\u5316\u4e00\u70b9\u6765\u8bf4**\uff0c\u4ed6\u5e0c\u671b\u627e\u5230\u6574\u6570 $t_j \\space(t_j>0,1\u2264j\u2264n)$ \uff0c\u4f7f$s=\\sum\\limits_{j=1}^nx_{t_j}^{(j)}$\u6700\u5927\uff0c\u4e14$s\\not\\equiv0(mod\\space k)$\u3002\n\n### \u8f93\u5165\u683c\u5f0f \n\n\u7b2c $1$ \u884c\u5305\u62ec\u4e24\u4e2a\u6574\u6570$n,k$\u3002\n\n$(1\u2264n\u226410000,1\u2264k\u226410^9)$\n\n\n\u63a5\u4e0b\u6765 $n$ \u884c\u63cf\u8ff0LCG\uff0c\u6bcf\u884c\u5305\u62ec4\u4e2a\u6574\u6570\uff1a$x_0^{(j)},a^{(j)}, b^{(j)}, c^{(j)}$ \u3002\n\n$(0\u2264a^{(j)}, b^{(j)}\u22641000,0\u2264x_0^{(j)}<c^{(j)}\u22641000)$\n\n### \u8f93\u51fa\u683c\u5f0f \n\n\u5982\u679c\u6709\u89e3\uff0c\u7b2c $1$ \u884c\u8f93\u51fa $s$\uff0c\u7b2c $2$ \u884c\u8f93\u51fa $n$ \u4e2a $t_j$ \u3002\n\n$(0\u2264t_j\u226410^9)$ \u3002\n\n\u5982\u679c\u65e0\u89e3\uff0c\u8f93\u51fa $-1$ \u3002\n\n### \u8bf4\u660e/\u63d0\u793a\n\u65f6\u95f4\u9650\u5236\uff1a1\u79d2\n\n\u7a7a\u95f4\u9650\u5236\uff1a256MB"
}
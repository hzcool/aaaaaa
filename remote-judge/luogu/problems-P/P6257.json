{
    "description": "In the Royal Family, names are very important! As the Royal Historian you have been charged with analyzing the patterns in the names of the Royal Ladies in the realm.\n\nThere have been n Royal Ladies, for convenience numbered from 1 to $n$. The name of each Lady is anuppercase letter concatenated with the name of her mother. The exception is the Lady numbered 1, the\nfounder of the Royal Family, whose name is just a single uppercase letter.\n\nFor example, ENERYS could be the mother of AENERYS (as the name AENERYS consists of the single uppercase letter 'A' concatenated with ENERYS, which is her mother's name). Similarly, AENERYS could be the mother of DAENERYS and YAENERYS.\n\nYou are given the description of all the Royal Ladies. Your task is to determine, for certain interesting strings $s$, the number of Royal Ladies for whom s is a prefix of their name.\n\nFor example, consider Sample Input 1 below, with a Royal Line that goes straight from the founder S to AENERYS (through YS, RYS, ERYS, NERYS and ENERYS), with each Lady having exactly one daughter. Then AENERYS has two daughters\u2014DAENERYS and YAENERYS, with the latter havingone daughter, RYAENERYS.\n\nIn such a family, RY is a prefix of the names of two ladies: RYS and RYAENERYS. E is a prefix of the names of ERYS and ENERYS. N is a prefix only of NERYS's name, while S is a prefix only of the nameof the founder, S. AY is not a prefix of any Royal Lady's name.\n",
    "inputFormat": "The first line of input contains two integers $n$ and $k$, where $n$ $(1 \\leq n \\leq 10^6)$ is the total number of Royal Ladies and $k$ $(1 \\leq k \\leq 10^6)$ is the number of query strings.\n\nThen follow n lines describing the Royal Ladies. The $i^{th}$ of these lines describes the Royal Lady numbered $i$, and contains an uppercase letter $c_i$ ('A'\u2013'Z') and an integer $p_i$, where $c_i$ is the first letter of the name of Lady $i$, and $p_i$ $(p1 = 0$ and $1 \\leq pi \\lt i$ for $i \\gt 1)$ is the number of her mother (or $0$, in the case\nof the First Lady). All the names are unique.\n\nThe remaining $k$ lines each contain one nonempty query string, consisting only of uppercase letters. The sum of the lengths of the query strings is at most $10^6$.",
    "outputFormat": "Output $k$ lines, with the $i^{th}$ line containing the number of Royal Ladies who have the $i^{th}$ query string as a prefix of their name.",
    "samples": [
        [
            "10 5\nS 0\nY 1\nR 2\nE 3\nN 4\nE 5\nA 6\nD 7\nY 7\nR 9\nRY\nE\nN\nS\nAY",
            "2\n2\n1\n1\n0"
        ]
    ],
    "hint": "Source: ICPC World Finals 2019.",
    "translation": "**\u9898\u76ee\u63cf\u8ff0**\r\n\r\n\u4f17\u6240\u5468\u77e5\uff0c\u7687\u5ba4\u5bb6\u65cf\u7684\u540d\u5b57\u975e\u5e38\u6709\u8bb2\u7a76\u3002\u800c\u4f5c\u4e3a\u7814\u7a76\u7687\u5ba4\u7684\u5386\u53f2\u5b66\u5bb6\u7684\u4f60\uff0c\u6700\u8fd1\u63a5\u5230\u4e86\u4e00\u4e2a\u8270\u5de8\u7684\u4efb\u52a1\u2014\u2014\u5206\u6790\u738b\u56fd\u5386\u53f2\u4e2d\u6240\u6709\u7687\u5ba4\u592b\u4eba\u7684\u540d\u5b57\u3002\r\n\r\n\u738b\u56fd\u5386\u53f2\u4e0a\u6709 $n$ \u4f4d\u7687\u5ba4\u592b\u4eba\uff0c\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u5c06\u5176\u4ece $1$ \u81f3 $n$ \u7f16\u53f7\u3002\u9664\u4e86 $1$ \u53f7\u592b\u4eba\u5916\uff0c\u5176\u4f59\u592b\u4eba\u7684\u540d\u5b57\u5747\u4e3a\u4e00\u4e2a\u5927\u5199\u5b57\u6bcd\u8fde\u63a5\u7740\u5979\u6bcd\u4eb2\u7684\u540d\u5b57\u3002\u800c $1$ \u53f7\u592b\u4eba\u4f5c\u4e3a\u738b\u56fd\u7684\u9996\u4efb\u738b\u540e\uff0c\u5979\u7684\u540d\u5b57\u53ea\u6709\u4e00\u4e2a\u5927\u5199\u5b57\u6bcd\u3002\r\n\r\n\u4f8b\u5982\uff0c\u7531\u4e8e `AENERYS` \u7531 `A` \u4e0e `ENERYS` \u7ec4\u6210\uff0c\u56e0\u6b64 `ENERYS` \u662f `AENERYS` \u7684\u6bcd\u4eb2\u3002\u76f8\u4f3c\u5730\uff0c`AENERYS` \u662f `DAENERYS` \u4e0e `YAENERYS` \u7684\u6bcd\u4eb2\u3002\r\n\r\n\u4f60\u77e5\u9053\u738b\u56fd\u5386\u53f2\u4e0a\u6240\u6709\u7687\u5ba4\u592b\u4eba\u7684\u59d3\u540d\u4e0e\u5173\u7cfb\uff0c\u800c\u4f60\u9700\u8981\u5b8c\u6210\u7684\u4efb\u52a1\u662f\uff0c\u5bf9\u4e8e\u5176\u4ed6\u5386\u53f2\u5b66\u5bb6\u611f\u5174\u8da3\u7684\u540d\u5b57\u4e32 $s$\uff0c\u603b\u5171\u6709\u591a\u5c11\u4f4d\u592b\u4eba\u7684\u540d\u5b57\u662f\u4ee5 $s$ \u8d77\u59cb\u7684\u3002\r\n\r\n\u4f8b\u5982\u5728\u6837\u4f8b\u7684\u7687\u5ba4\u65cf\u8c31\u4e2d\uff0c`S` \u81f3 `AENERYS` \u7684\u8fd9\u4e00\u652f\uff08\u5305\u542b `YS`\u3001`RYS`\u3001`ERYS`\u3001`NERYS` \u4e0e `ENERYS` \u8fd9\u51e0\u4f4d\u592b\u4eba\uff09\u5747\u53ea\u6709\u4e00\u4f4d\u5973\u513f\u3002\u63a5\u4e0b\u6765 `AENERYS` \u6709\u4e24\u4f4d\u5973\u513f\uff0c\u5206\u522b\u662f `DAENERYS`\uff0c\u4ee5\u53ca\u5973\u513f\u662f `RYAENERYS` \u7684 `YAENERYS`\u3002\r\n\r\n\u5728\u8fd9\u4e2a\u7687\u5ba4\u5bb6\u65cf\u5185\uff0c\u6709\u4e24\u4f4d\u592b\u4eba\u7684\u540d\u5b57\u4ee5 `RY` \u8d77\u59cb\uff0c\u5979\u4eec\u662f `RYS` \u4e0e `RYAENERYS`\u3002\u800c `ERYS` \u4e0e `ENERYS` \u5747\u4ee5 `E` \u8d77\u59cb\u3002\u540d\u5b57\u4ee5 `N` \u8d77\u59cb\u7684\u4ec5\u6709\u4e00\u4f4d\u592b\u4eba `NERYS`\u3002\u540c\u6837\u5730\uff0c\u4ee5 `S` \u8d77\u59cb\u7684\u4ec5\u6709\u9996\u4f4d\u738b\u540e `S`\u3002\u800c\u6ca1\u6709\u4efb\u4f55\u4e00\u4f4d\u592b\u4eba\u7684\u540d\u5b57\u4ee5 `AY` \u8d77\u59cb\u3002\r\n\r\n**\u8f93\u5165\u683c\u5f0f**\r\n\r\n\u7b2c\u4e00\u884c\u6709\u4e24\u4e2a\u6574\u6570 $n,k$\uff0c\u5206\u522b\u4ee3\u8868\u738b\u56fd\u5386\u53f2\u4e0a\u7687\u5ba4\u592b\u4eba\u603b\u6570\uff0c\u4ee5\u53ca\u5176\u4ed6\u5386\u53f2\u5b66\u5bb6\u611f\u5174\u8da3\u7684\u540d\u5b57\u4e32\u7684\u4e2a\u6570\u3002\r\n\r\n\u63a5\u4e0b\u6765 $n$ \u884c\u63cf\u8ff0\u6240\u6709\u7687\u5ba4\u592b\u4eba\u7684\u59d3\u540d\u4e0e\u5173\u7cfb\u3002\u7b2c $i+1$ \u884c\u63cf\u8ff0\u7b2c $i$ \u4f4d\u592b\u4eba\u7684\u8d44\u6599 $c_i$ \u4e0e $p_i$\uff0c\u5176\u4e2d\u5b57\u7b26 $c_i$ \u8868\u793a\u5979\u540d\u5b57\u7684\u9996\u4f4d\u5b57\u6bcd\uff0c$p_i$ \u4e3a\u5979\u6bcd\u4eb2\u7684\u7f16\u53f7\u3002\u5bf9\u4e8e\u7f16\u53f7\u4e3a $1$ \u7684\u9996\u4f4d\u738b\u540e\uff0c$p_1=0$\u3002\u6240\u6709\u592b\u4eba\u7684\u540d\u5b57\u5747\u4e0d\u91cd\u590d\u3002\r\n\r\n\u63a5\u4e0b\u6765 $k$ \u884c\uff0c\u6bcf\u884c\u4e3a\u4e00\u4e2a\u5927\u5199\u5b57\u6bcd\u6784\u6210\u7684\u975e\u7a7a\u4e32\uff0c\u4ee3\u8868\u4e00\u4e2a\u5176\u4ed6\u5386\u53f2\u5b66\u5bb6\u611f\u5174\u8da3\u7684\u540d\u5b57\u4e32\u3002\r\n\r\n**\u8f93\u51fa\u683c\u5f0f**\r\n\r\n\u8f93\u51fa $k$ \u884c\uff0c\u7b2c $i$ \u884c\u4e3a\u4e00\u4e2a\u6574\u6570\uff0c\u4ee3\u8868\u603b\u5171\u6709\u591a\u5c11\u4f4d\u592b\u4eba\u7684\u540d\u5b57\u662f\u4ee5\u7b2c $i$ \u4e2a\u611f\u5174\u8da3\u7684\u540d\u5b57\u4e32\u8d77\u59cb\u7684\u3002\r\n\r\n**\u6570\u636e\u8303\u56f4**\r\n\r\n$1\\leq n\\leq 10^6$\uff0c$1\\leq k\\leq 10^6$\uff0c$p_1=0$\uff0c\u7279\u522b\u5730\uff0c\u5bf9\u4e8e $1\\lt i\\leq n$\uff0c\u4fdd\u8bc1\u6709 $1\\leq p_i\\lt i$\u3002\u611f\u5174\u8da3\u7684\u540d\u5b57\u4e32\u603b\u957f\u4e0d\u8d85\u8fc7 $10^6$\u3002"
}
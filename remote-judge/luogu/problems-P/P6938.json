{
    "description": "\n\nTwo years ago, you helped install the nation's very first Flubber pipe network in your hometown, to great success. Polls show that everyone loves having their own Flubber dispenser in their kitchen, and now a few enterprising citizens have discovered a use for it. Apparently Flubber, when mixed with water, can help extinguish fires! This is a very timely discovery, as out-of-control fires have lately been surprisingly common.\n\nYour hometown's city council would like to make use of this property of Flubber by creating the $Flubber/water$ mixture at a centrally located station. This station, which is called the Flubber Department (FD) will also have specialized employees trained to travel to the locations of fires and make use of their processed Flubber to control the blazes.\n\nThe pipes are already in place all around the city. You are given a layout of the pipes, and must determine how to route Flubber from the Flubber factory and water from a local source through the pipes to the FD.\n\nNote that both Flubber and water will be flowing through the same network of pipes, perhaps even the same pipe. All pipes are bidirectional, but Flubber and water cannot move in opposite directions through the same pipe. Furthermore, if both liquids are sent in the same direction through the same pipe, they will inevitably mix. Therefore the nodes in the network have been equipped with special membranes and filters that enable you to separate and reorganize all incoming mixtures as you see fit. The network is a closed system, so the total rate of each fluid going into a node must equal the total rate of that fluid going out, except at the source of that fluid and the destination (the FD).\n\nEach pipe has a certain capacity. Flubber, being somewhat sluggish, has a viscosity value $v$ , so a pipe that can transport $v liters/second$ of water can transport only $1 liter/second$ of Flubber. The pipe's capacity scales linearly for mixtures of the two. To be precise, if $c$ denotes the water capacity of the pipe and $f$ and $w$ are the rates of Flubber and water moving through the pipe (all measured in $liters/second),$ then the capacity constraint is given by the inequality $v \u00b7 f + w \\le c$ .\n\nYour main concern is balancing the mixture that reaches the FD. You would like as much total liquid as possible, but you also need a sufficient amount of water $-$ because undiluted Flubber is highly flammable $-$ and a sufficient amount of Flubber $-$ because it would not be much of a `Flubber Department` without Flubber! You have come up with a formula to measure the `value` of the final mixture: $F^{a} \u00b7 W^{1\u2212a},$ where $F$ is the rate of incoming Flubber in $liters/second, W$ is the rate of incoming water in $liters/second,$ and a is a given constant between $0$ and $1$ .\n\nDetermine the maximum value of $F^{a} \u00b7 W^{1\u2212a}$ that can be achieved and how to route the Flubber and water to achieve it.\n\n",
    "inputFormat": "\n\nThe input starts with a line containing the number of locations $n (3 \\le n \\le 200)$ , the number of pipes $p (n \u2212 1 \\le p \\le $ n(n $\u2212 1)/2)$ , and the real values $v (1 \\le v \\le 10)$ and a ($0$ . $01 \\le $ a $ \\le 0$ . $99$) . Locations are numbered from $1$ to $n$ ; $1$ is the Flubber factory, $2$ is the water source, and $3$ is the FD. The real values have at most $10$ digits after the decimal point.\n\nThe following $p$ lines each describe one pipe. Each line contains two integers $j$ and $k (1 \\le j < k \\le n)$ , giving the locations connected by the pipe, and an integer $c (1 \\le c \\le 10)$ , giving the water capacity of the pipe in $liters/second.$\n\nNo two pipes connect the same pair of locations. Furthermore, it is guaranteed that the network is connected.\n\n",
    "outputFormat": "\n\nFirst, for each pipe (in the order given in the input), display two values: the rate of Flubber moving through it, and the rate of water moving through it (negative if the liquid is moving from $k$ to $j)$ , such that $F^{a} \u00b7W^{1\u2212a}$ is maximized. Then display that maximum value accurate to within an absolute error of $10^{\u22124}.$\n\nIf there are multiple solutions, any one will be accepted. All constraints (not sending Flubber and water in opposite directions along the same pipe, flow conservation, pipe capacities, and consistency between the constructed solution and its claimed value) must be satisfied within an absolute error of $10^{\u22124}.$\n\n",
    "samples": [
        [
            "6 6 3.0 0.66\n2 4 8\n4 6 1\n3 6 1\n4 5 5\n1 5 7\n3 5 3\n",
            "0.000000000 1.360000000\n0.000000000 1.000000000\n0.000000000 -1.000000000\n0.000000000 0.360000000\n0.880000000 0.000000000\n-0.880000000 -0.360000000\n1.02037965897\n"
        ],
        [
            "5 5 1.0 0.5\n1 2 10\n2 3 10\n3 4 10\n4 5 10\n3 5 10\n",
            "5 0\n5 5\n4.2 3.14159\n4.2 3.14159\n-4.2 -3.14159\n5\n"
        ]
    ],
    "hint": "Time limit: 5 s, Memory limit: 512 MB. \n\n",
    "translation": "### \u9898\u76ee\u63cf\u8ff0\n\u4e24\u5e74\u4ee5\u524d\uff0c\u4f60\u5e2e\u52a9\u4f60\u7684\u5bb6\u4e61\u5b89\u88c5\u4e86\u56fd\u5185\u7684\u7b2c\u4e00\u4e2a Flubber \u7ba1\u9053\u7f51\u7edc\uff0c\u83b7\u5f97\u4e86\u5de8\u5927\u6210\u529f\u3002\u6295\u7968\u8868\u660e\u6bcf\u4e2a\u4eba\u90fd\u559c\u6b22\u5728\u81ea\u5df1\u5bb6\u7684\u53a8\u623f\u91cc\u88c5\u4e0a Flubber \u5206\u914d\u5668\uff0c\u800c\u73b0\u5728\u4e00\u4e9b\u6709\u8fdb\u53d6\u5fc3\u7684\u5e02\u6c11\u53d1\u73b0\u4e86\u4e00\u79cd\u65b0\u7684\u7528\u9014\u2014\u2014Flubber \u548c\u6c34\u6df7\u5408\u540e\u4f3c\u4e4e\u53ef\u4ee5\u5e2e\u52a9\u706d\u706b\uff01\u8fd9\u662f\u4e00\u4e2a\u5f88\u53ca\u65f6\u7684\u53d1\u73b0\uff0c\u56e0\u4e3a\u6700\u8fd1\u65e0\u6cd5\u63a7\u5236\u7684\u5927\u706b\u51fa\u5947\u5730\u5e38\u89c1\u3002\n\n\u4f60\u5bb6\u4e61\u7684\u5e02\u8bae\u4f1a\u60f3\u5728\u4e00\u4e2a\u4f4d\u4e8e\u4e2d\u592e\u7684\u5730\u65b9\u5236\u9020 Flubber \u548c\u6c34\u7684\u6df7\u5408\u7269\u4ee5\u5229\u7528 Flubber \u7684\u8fd9\u4e2a\u5c5e\u6027\u3002\u8fd9\u4e2a\u88ab\u79f0\u4e3a Flubber \u90e8\u95e8\u7684\u5730\u65b9\u62e5\u6709\u4e13\u95e8\u8bad\u7ec3\u7684\u5458\u5de5\u53bb\u5f80\u7740\u706b\u7684\u5730\u70b9\u5e76\u4e14\u5229\u7528\u7ecf\u8fc7\u5904\u7406\u7684 Flubber \u6765\u63a7\u5236\u706b\u52bf\u3002\n\n\u7ba1\u9053\u5df2\u7ecf\u5728\u57ce\u5e02\u4e2d\u94fa\u8bbe\u597d\u3002\u4f60\u4f1a\u5f97\u5230\u7ba1\u9053\u5e03\u5c40\uff0c\u800c\u4f60\u9700\u8981\u51b3\u5b9a\u5982\u4f55\u5c06 Flubber \u4ece Flubber \u5de5\u5382\u3001\u5c06\u6c34\u4ece\u4e00\u4e2a\u672c\u5730\u6c34\u6e90\u901a\u8fc7\u7ba1\u9053\u8fd0\u9001\u81f3 Flubber \u90e8\u95e8\u3002\n\n\u6ce8\u610f Flubber \u548c\u6c34\u4f1a\u5728\u540c\u4e00\u7ba1\u9053\u7f51\u7edc\u4e2d\uff0c\u751a\u81f3\u53ef\u80fd\u5728\u540c\u4e00\u6761\u7ba1\u9053\u4e2d\u6d41\u52a8\u3002\u6240\u6709\u7ba1\u9053\u662f\u53cc\u5411\u7684\uff0c\u4f46\u662f Flubber \u548c\u6c34\u4e0d\u80fd\u5728\u540c\u4e00\u6761\u7ba1\u9053\u4e2d\u5f02\u5411\u6d41\u52a8\u3002\u6b64\u5916\uff0c\u5982\u679c\u4e24\u79cd\u6db2\u4f53\u540c\u5411\u6d41\u8fc7\u4e00\u6761\u7ba1\u9053\uff0c\u5b83\u4eec\u4f1a\u4e0d\u53ef\u907f\u514d\u5730\u6df7\u5408\uff0c\u56e0\u6b64\u7f51\u7edc\u4e2d\u7684\u6240\u6709\u8282\u70b9\u914d\u5907\u4e86\u7279\u6b8a\u7684\u819c\u548c\u7b5b\uff0c\u5982\u4f60\u6240\u89c1\uff0c\u53ef\u4ee5\u5206\u79bb\u548c\u91cd\u65b0\u7ec4\u7ec7\u6240\u6709\u6d41\u5165\u7684\u6df7\u5408\u7269\u3002\u7ba1\u9053\u7f51\u7edc\u662f\u4e2a\u5c01\u95ed\u7cfb\u7edf\uff0c\u56e0\u6b64\u5728\u6bcf\u4e2a\u8282\u70b9\u5904\u6bcf\u79cd\u6db2\u4f53\u7684\u603b\u6d41\u5165\u901f\u7387\u5fc5\u987b\u7b49\u4e8e\u603b\u6d41\u51fa\u901f\u7387\uff0c\u9664\u4e86\u6bcf\u79cd\u6db2\u4f53\u5404\u81ea\u7684\u6e90\u5934\u548c\u76ee\u7684\u5730\uff08Flubber \u90e8\u95e8\uff09\u3002\n\n\u6bcf\u6761\u7ba1\u9053\u6709\u67d0\u4e2a\u5bb9\u91cf\uff0c\u6709\u4e9b\u7c98\u7a20\u7684 Flubber \u6709\u4e00\u4e2a\u7c98\u5ea6\u503c v\uff0c\u6240\u4ee5\u80fd\u8fd0\u8f93 v \u5347\u6bcf\u79d2\u7684\u6c34\u7684\u7ba1\u9053\u53ea\u80fd\u8fd0\u8f93 1 \u5347\u6bcf\u79d2\u7684 Flubber\u3002\u7ba1\u9053\u5bf9\u4e8e\u6df7\u5408\u7269\u7684\u5bb9\u91cf\u662f\u7ebf\u6027\u53d8\u5316\u7684\u3002\u66f4\u7cbe\u786e\u5730\uff0c\u5047\u8bbe c \u8868\u793a\u7ba1\u9053\u5bf9\u4e8e\u6c34\u7684\u5bb9\u91cf\uff0cf \u548c w \u5206\u522b\u8868\u793a Flubber \u548c\u6c34\u6d41\u8fc7\u7ba1\u9053\u7684\u901f\u7387\uff08\u5355\u4f4d\u5747\u4e3a\u5347\u6bcf\u79d2\uff09\uff0c\u5219\u5bb9\u91cf\u7684\u9650\u5236\u7528\u4e0d\u7b49\u5f0f v\u22c5f+w\u2264c \u8868\u793a\u3002\n\n\u4f60\u4e3b\u8981\u5173\u5fc3\u7684\u662f\u5e73\u8861\u6d41\u5230 Flubber \u90e8\u95e8\u7684\u6df7\u5408\u7269\u3002\u4f60\u60f3\u8981\u5c3d\u53ef\u80fd\u591a\u7684\u6df7\u5408\u6db2\u4f53\uff0c\u4f46\u662f\u4e5f\u9700\u8981\u8db3\u591f\u7684\u6c34\u2014\u2014\u56e0\u4e3a\u672a\u7ecf\u7a00\u91ca\u7684 Flubber \u662f\u9ad8\u5ea6\u6613\u71c3\u7684\u2014\u2014\u4e5f\u9700\u8981\u8db3\u591f\u7684 Flubber\u2014\u2014\u56e0\u4e3a Flubber \u90e8\u95e8\u53ef\u4e0d\u80fd\u6ca1\u4e86 Flubber\uff01\u4f60\u60f3\u51fa\u4e86\u4e00\u4e2a\u516c\u5f0f\u6765\u8861\u91cf\u6700\u7ec8\u6df7\u5408\u7269\u7684\u4ef7\u503c\uff1a$F^a\u22c5W^{1\u2212a}$\uff0c\u5176\u4e2d F \u662f\u4ee5\u5347\u6bcf\u79d2\u4e3a\u5355\u4f4d\u7684 Flubber \u7684\u6d41\u5165\u901f\u7387\uff0cW \u662f\u4ee5\u5347\u6bcf\u79d2\u4e3a\u5355\u4f4d\u7684\u6c34\u7684\u6d41\u5165\u901f\u7387\uff0ca \u662f\u4e00\u4e2a\u7ed9\u5b9a\u7684\u4ecb\u4e8e 0 \u548c 1 \u4e4b\u95f4\u7684\u5e38\u6570\u3002\n\n\u6c42\u51fa $F^a\u22c5W^{1\u2212a}$ \u80fd\u8fbe\u5230\u7684\u6700\u5927\u503c\u4ee5\u53ca\u5982\u4f55\u5b89\u6392 Flubber \u548c\u6c34\u7684\u8def\u5f84\u6765\u8fbe\u5230\u5b83\u3002\n\n### \u8f93\u5165\u683c\u5f0f\n\u8f93\u5165\u7684\u7b2c\u4e00\u884c\u5305\u542b\u5730\u70b9\u7684\u6570\u91cf n (3\u2264n\u2264300)\uff0c\u7ba1\u9053\u7684\u6570\u91cf $p (n\u22121\u2264p\u2264\\frac12n(n\u22121))$\uff0c\u548c\u5b9e\u6570 v (1\u2264v\u226410) \u548c a (0.01\u2264a\u22640.99)\u3002\u5730\u70b9\u4ece 1 \u5230 n \u6807\u53f7\uff1b1 \u662f Flubber \u5de5\u5382\uff0c2 \u662f\u6c34\u6e90\uff0c3 \u662f Flutter \u90e8\u95e8\u3002\u5b9e\u6570\u7684\u5c0f\u6570\u70b9\u540e\u6700\u591a\u6709\u5341\u4f4d\u3002\n\n\u63a5\u4e0b\u6765\u7684 p \u884c\u6bcf\u884c\u63cf\u8ff0\u4e86\u4e00\u6761\u7ba1\u9053\u3002\u6bcf\u884c\u6709\u4e24\u4e2a\u6574\u6570 j \u548c k (1\u2264j<k\u2264n)\uff0c\u8868\u793a\u7ba1\u9053\u8fde\u63a5\u7684\u5730\u70b9\uff0c\u548c\u4e00\u4e2a\u6574\u6570 c (1\u2264c\u226410)\uff0c\u8868\u793a\u8fd9\u6761\u7ba1\u9053\u7684\u6c34\u5bb9\u91cf\uff0c\u4ee5\u5347\u6bcf\u79d2\u4e3a\u5355\u4f4d\u3002\n\n\u6ca1\u6709\u4e24\u6761\u7ba1\u9053\u8fde\u63a5\u76f8\u540c\u7684\u4e24\u4e2a\u5730\u70b9\uff0c\u6b64\u5916\uff0c\u8fd8\u4fdd\u8bc1\u7f51\u7edc\u662f\u8fde\u901a\u7684\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\n\u9996\u5148\uff0c\u5bf9\u4e8e\u6bcf\u6761\u7ba1\u9053\uff08\u6309\u7167\u8f93\u5165\u7684\u987a\u5e8f\uff09\uff0c\u8f93\u51fa\u4e24\u4e2a\u503c\uff1a\u5176\u4e2d Flubber \u6d41\u8fc7\u7684\u901f\u7387\u548c\u5176\u4e2d\u6c34\u6d41\u8fc7\u7684\u901f\u7387 \uff08\u5982\u679c\u4ece k \u6d41\u5230 j \u5219\u4e3a\u8d1f\u6570\uff09\uff0c\u4f7f\u5f97 $F^a\u22c5W^{1\u2212a}$ \u6700\u5927\u5316\u3002\u7136\u540e\u8f93\u51fa\u5176\u6700\u5927\u503c\uff0c\u5728 $10^{\u22124}$ \u7684\u7edd\u5bf9\u8bef\u5dee\u4ee5\u5185\u3002\n\n\u5982\u679c\u6709\u591a\u89e3\uff0c\u8f93\u51fa\u4efb\u610f\u4e00\u79cd\u5747\u53ef\u3002\u6240\u6709\u9650\u5236\uff08Flubber \u548c\u6c34\u6ca1\u6709\u5728\u540c\u4e00\u6761\u7ba1\u9053\u5185\u5f02\u5411\u6d41\u52a8\u3001\u6d41\u91cf\u5b88\u6052\u3001\u7ba1\u9053\u5bb9\u91cf\u4ee5\u53ca\u6784\u9020\u7684\u89e3\u548c\u5176\u58f0\u79f0\u7684\u503c\u7684\u4e00\u81f4\u6027\uff09\u9700\u8981\u5728 $10^{\u22124}$ \u7684\u7edd\u5bf9\u8bef\u5dee\u5185\u6ee1\u8db3\u3002"
}
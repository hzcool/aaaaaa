{
    "description": "\n\nThe $J$ programming language, developed in the early $1990s$ by Kenneth $E$ . Iverson and Roger Hui, is a synthesis of APL (also by Iverson) and the FP and FL function-level languages created by John Backus.\n\nWikipedia. $J$ (programming language)\n\nAPL language family is famous for its support of advanced operations on vectors and arrays, and $J$ is not an exception. For example, all unary and binary numeric operations in these languages by default are applicable to vectors and arrays of different dimensions. Plus operation $(\u2018+')$ can add not only scalars, like in other languages, but also scalars and vectors (the scalar is added to each component of the vector), or vectors and vectors (the vectors are added component-wise).\n\nThe expressive power of $J$ is amazing (as well as its cryptic syntax), but for this problem we need just a small subset of the language. We consider a single expression, where we may use one vector variable $X$ , one scalar variable $N$ -- the length of the vector $X$ , and the following operations:\n\nWe can add $(\u2018+'),$ subtract $(\u2018-')$ or multiply $(\u2018 \\times ')$ two vectors, vector and scalar, or two scalars.\n\nWe can use unary minus $(\u2018-')$ and unary squaring operations $(\u2018 \\times :')$ for scalars and vectors $(component-wise).$\n\nWe can fold a vector with plus operation $(\u2018+/')$ -- that is, compute the sum of a vector (unary operation).\n\nOperations are evaluated right-to-left, natural precedence of operations is ignored in $J$ . The order of evaluation can be altered by parentheses. More precisely the syntax is specified in the following BNF.\n\n$\u2329expressio_n\u232a ::= \u2329ter_m\u232a | \u2329ter_m\u232a (\u2018+' | \u2018-' | \u2018 \\times ') \u2329expressio_n\u232a | (\u2018-' | \u2018 \\times :' | \u2018+/') \u2329expressio_n\u232a$\n\n$\u2329ter_m\u232a ::= \u2018('\u2329expressio_n\u232a\u2018)' | \u2018X' | \u2018N' | \u2329number\u232a$\n\n$\u2329number\u232a ::= (\u20180' | \u20181' |$ . . . $| \u20189')^{+}$\n\nTo correctly impose one more limitation on expression syntax, let us define complexity of an expression:\n\ncomplexity of scalars (numbers, $\u2018N',$ and result of fold) is zero;\n\ncomplexity of $\u2018X'$ is one;\n\ncomplexity of addition and subtraction is the maximum of their operands' complexities;\n\ncomplexity of multiplication is the sum of its operands' complexities;\n\ncomplexity of unary squaring is twice the complexity of its operand.\n\nFor example, the complexity of expression $`(3-+/ \\times : \\times :X)-X \\times \\times :X`$ is $3$ , while the complexity of its subexpression $` \\times : \\times :X`$ is $4$ .\n\nYour program is given a scalar-valued expression and a value of the vector $X$ , and it should compute the expression result modulo $10^{9}.$ The complexity of each subexpression in the given expression does not exceed $10$ .\n\n",
    "inputFormat": "\n\nThe first line contains one integer number $N (1 \\le N \\le 10^{5})$ -- the length of the vector $X$ .\n\nThe second line contains $N$ integers -- components of the vector $X (0 \\le X_{i} < 10^{9}).$\n\nThe third line contains the expression to be computed, a non-empty string of not more than $105$ symbols. Each number in the expression is less than $109$ . The fold is never applied to a scalar.\n\n",
    "outputFormat": "\n\nOutput a single integer number -- the expression result modulo $10^{9}.$\n\n",
    "samples": [
        [
            "5\n1 2 3 4 5\n+/*:X\n",
            "55\n"
        ],
        [
            "5\n1 2 3 4 5\nN++/X-X+1\n",
            "0\n"
        ],
        [
            "3\n11 56 37\n+/(3-+/*:*:X)-X**:X\n",
            "964602515\n"
        ]
    ],
    "hint": "Time limit: 2 s, Memory limit: 256 MB. \n\n",
    "translation": "\u672c\u9898\u4e2d\uff0cJ \u8bed\u8a00\u4e3a\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u6ee1\u8db3\u5982\u4e0b\u7684 Backus-Naur \u8303\u5f0f\uff1a\n```\n<expression> ::= <term> | <term> ('+' | '-' | '*') <expression> | ('-' | > '*:' | '+/') <expression>\n<term> ::= '(' <expression> ')' | 'X' | 'N' | <number>\n<number> ::= ('0' | '1' | ... | '9')+\n```\n\u5bf9\u4e8e\u4e00\u4e2a\u53cc\u76ee\u8fd0\u7b97\u7b26\uff0c\u5f53\u64cd\u4f5c\u6570\u4e3a\u6570\u503c\u548c\u5411\u91cf\u65f6\uff0c\u5b83\u7684\u6548\u679c\u662f\u5c06\u6570\u503c\u548c\u5411\u91cf\u4e2d\u7684\u6bcf\u4e00\u7ef4\u5206\u91cf\u5206\u522b\u505a\u8fd0\u7b97\uff1b\u5f53\u64cd\u4f5c\u6570\u4e3a\u4e24\u4e2a\u5411\u91cf\u65f6\uff0c\u5b83\u7684\u6548\u679c\u662f\u5c06\u5411\u91cf\u4e2d\u7684\u6bcf\u4e00\u7ef4\u5206\u91cf\u5bf9\u5e94\u505a\u8fd0\u7b97\u3002\u7279\u522b\u5730\uff0c\u5728\u672c\u9898\u4e2d\uff0c\u6240\u6709\u7684\u5411\u91cf\u5747\u76f8\u540c\u3002  \n\nBackus-Naur \u8303\u5f0f\u4e2d\u51fa\u73b0\u7684\u8bb0\u53f7\u89e3\u91ca\u5982\u4e0b\uff1a\n- \u52a0\u6cd5\u3001\u51cf\u6cd5\u3001\u4e58\u6cd5\u8fd0\u7b97 `'+','-','*'`\n- \u5355\u76ee\u8fd0\u7b97 `'-','*:','+/'`\u3002`-A` \u8868\u793a\u5bf9 A \u53d6\u8d1f\uff0c`*:A` \u8868\u793a\u5bf9 A \u6c42\u5e73\u65b9\uff0c`+/` A \u79f0\u4e3a**\u6298\u53e0**\uff0c\u8868\u793a\u5bf9\u5411\u91cf A \u7684\u6240\u6709\u5206\u91cf\u6c42\u548c\u3002\n- \u62ec\u53f7 `'(',')'`\u3002\u6ca1\u6709\u62ec\u53f7\u65f6\uff0c\u6240\u6709\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u76f8\u540c\uff0c\u62ec\u53f7\u53ef\u4ee5\u6539\u53d8\u8fd0\u7b97\u987a\u5e8f\uff0c\u6548\u679c\u540c\u901a\u5e38\u7684\u62ec\u53f7\u3002\n- \u6570\u5b57\u3002\n- \u5b57\u6bcd `'N','X'`\u3002N \u5728\u5904\u7406\u65f6\u7b49\u4ef7\u4e8e\u4e00\u4e2a\u4e8b\u5148\u88ab\u7ed9\u5b9a\u7684\u6570\u5b57\uff0cX \u5219\u7b49\u4ef7\u4e8e\u4e00\u4e2a\u4e8b\u5148\u88ab\u7ed9\u5b9a\u7684\u5411\u91cf\u3002\n- \u5355\u5143\u3002\u8868\u8fbe\u5f0f\u3001\u6570\u5b57\u548c\u5b57\u6bcd\u88ab\u7edf\u79f0\u4e3a\u5355\u5143\u3002\n- \u8868\u8fbe\u5f0f\u3002\u82e5\u5e72\u4e2a\u5355\u5143\u7528\u53cc\u76ee\u548c\u5355\u76ee\u8fd0\u7b97\u7b26\u6309\u7167\u7b26\u5408\u8bed\u6cd5\u89c4\u5219\u7684\u65b9\u5f0f\u8fde\u63a5\u8d77\u6765\uff0c\u6240\u5f97\u5230\u7684\u5b57\u7b26\u4e32\u79f0\u4e3a\u4e00\u4e2a\u8868\u8fbe\u5f0f\u3002\u8868\u8fbe\u5f0f\u4e2d\u4e0d\u5f97\u5305\u542b\u4e0a\u6587\u4e2d\u6ca1\u6709\u63d0\u5230\u7684\u5176\u4ed6\u5b57\u7b26\u3002\n- \u6ce8\u610f\uff1aJ \u8bed\u8a00\u7684\u8868\u8fbe\u5f0f\u662f**\u53f3\u7ed3\u5408**\u7684\uff0c\u4f60\u53ef\u4ee5\u7406\u89e3\u4e3a\u4ece\u53f3\u5f80\u5de6\u8ba1\u7b97\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e0d\u6ee1\u8db3\u4ea4\u6362\u5f8b\u7684\u51cf\u6cd5\u64cd\u4f5c\uff0c\u6211\u4eec\u89c4\u5b9a `A-B` \u4ecd\u7136\u8868\u793a\u7528 A \u51cf\u53bb B \u800c\u4e0d\u662f B \u51cf\u53bb A\u3002\u5bf9\u4e8e\u4e00\u4e2a\u6570\u5b57\uff0c\u6211\u4eec\u89c4\u5b9a\u5b83\u4ecd\u7136\u662f\u4ece\u5de6\u5f80\u53f3\u8bfb\u7684\u3002\u6bd4\u5982 `123` \u5e94\u5f53\u7406\u89e3\u4e3a 100+20+3 \u800c\u4e0d\u662f 300+20+1\u3002\n\n\u6bcf\u4e2a\u8868\u8fbe\u5f0f\u88ab\u5b9a\u4e49\u4e86\u4e00\u4e2a**\u590d\u6742\u5ea6**\uff0c\u6211\u4eec\u89c4\u5b9a\u6240\u6709\u6570\u503c\uff08\u6807\u91cf\uff09\u7684\u590d\u6742\u5ea6\u4e3a 0\uff0c`X` \u7684\u590d\u6742\u5ea6\u4e3a 1\uff0c\u52a0\u6cd5\u8fd0\u7b97\u548c\u51cf\u6cd5\u8fd0\u7b97 `A+B,A-B` \u7684\u590d\u6742\u5ea6\u4e3a `A` \u548c `B` \u590d\u6742\u5ea6\u7684\u6700\u5927\u503c\u3002`A*B` \u7684\u590d\u6742\u5ea6\u4e3a\u4e24\u8005\u590d\u6742\u5ea6\u4e4b\u548c\uff0c\u5355\u76ee\u53d6\u53cd\u8fd0\u7b97\u4e0d\u6539\u53d8\u8868\u8fbe\u5f0f\u7684\u590d\u6742\u5ea6\uff0c\u5e73\u65b9\u8fd0\u7b97\u5c06\u8868\u8fbe\u5f0f\u7684\u590d\u6742\u5ea6\u53d8\u6210\u5b83\u7684\u4e24\u500d\uff0c\u6298\u53e0\u8fd0\u7b97\u5c06\u8868\u8fbe\u5f0f\u7684\u590d\u6742\u5ea6\u53d8\u6210 0\u3002\n\n\u4f60\u9996\u5148\u9700\u8981\u8bfb\u5165 $N,X(N\\le10^5)$\uff0c\u4fdd\u8bc1 N \u7b49\u4e8e X \u7684\u957f\u5ea6\u3002X \u4e2d\u6240\u6709\u5206\u91cf\u5168\u4e3a\u4e0d\u8d85\u8fc7 $10^9$ \u7684\u6b63\u6574\u6570\u3002\u7136\u540e\u4e00\u884c\u8bfb\u5165\u4e00\u4e2a\u8868\u8fbe\u5f0f `expr`\uff0c\u4fdd\u8bc1\u5b83\u7684\u590d\u6742\u5ea6\u4e0d\u8d85\u8fc7 10\uff0c\u5e76\u4e14\u957f\u5ea6\u4e0d\u8d85\u8fc7 $10^5$ \u4e2a\u5b57\u7b26\uff0c\u4e14\u5b8c\u5168\u7b26\u5408\u8bed\u6cd5\u89c4\u5219\u3002\u4f60\u9700\u8981\u6c42\u51fa `expr` \u7684\u503c\u6a21 $10^9$ \u7684\u7ed3\u679c\uff08\u4fdd\u8bc1\u503c\u4e00\u5b9a\u662f\u4e2a\u6807\u91cf\u800c\u4e0d\u662f\u5411\u91cf\uff09\u3002\n\ntranslated by @Starlight237"
}
{
    "description": "\u6df1\u9083\u7684\u661f\u7a7a\u53ef\u4ee5\u88ab\u89c6\u4f5c\u4e00\u5f20\u6709\u5411\u56fe\uff0c\u56fe\u4e0a\u7684\u8282\u70b9\u5c31\u662f\u70b9\u70b9\u6052\u661f\u3002\u70b9\u65e0\u70b9\u6743\uff0c\u8fb9\u6709\u8fb9\u6743\u3002\u56fe\u7684\u70b9\u6570\u4e3a $n$\uff0c\u8fb9\u6570\u4e3a $m$\uff0c\u56fe\u53ef\u80fd\u6709\u91cd\u8fb9\u81ea\u73af\u3002\u4f46\u4fdd\u8bc1\u81f3\u5c11\u6709\u4e00\u6761\u8def\u5f84\u53ef\u4ee5\u4ece $s$ \u8d70\u5230 $t$\uff08$s$\u3001$t$ \u5728\u8f93\u5165\u4e2d\u7ed9\u5b9a\uff09\u3002\u7b2c $i$ \u6761\u6709\u5411\u8fb9\u8d77\u70b9\u4e3a $u_i$\uff0c\u7ec8\u70b9\u4e3a $v_i$\uff0c\u5b83\u7684\u6743\u503c\u7528\u4e00\u4e2a\u6709\u5e8f\u4e09\u5143\u7ec4 $(l_i,r_i,w_i)$ \u8868\u793a\u3002\n\n\u83b2\u5b50\u8981\u4ece\u70b9 $s$ \u51fa\u53d1\uff0c\u7ecf\u8fc7\u4e86\u82e5\u5e72\u6761\u8fb9\u5230\u8fbe\u70b9 $t$\u3002\u5979\u5e26\u6709\u4e00\u4e2a\u521d\u59cb\u503c\u5747\u4e3a $0$ \u7684\u957f\u5ea6\u4e3a $k$ \u7684\u6570\u7ec4 $a$\uff0c\u6bcf\u6b21\u7ecf\u8fc7\u7f16\u53f7\u4e3a $i$ \u7684\u8fb9\uff0c\u5c31\u4f1a\u6267\u884c\u5c06 $a$ \u6570\u7ec4\u7684\u533a\u95f4 $[l_i,r_i]$ \u52a0 $w_i$ \u7684\u64cd\u4f5c\u3002\u5979\u4f7f\u7528\u4e86\u4e00\u68f5**\u5e26\u61d2\u6807\u8bb0**\u7684\u7ebf\u6bb5\u6811\u6765\u7ef4\u62a4\u8fd9\u4e00\u64cd\u4f5c\u3002\u7ebf\u6bb5\u6811\u7684\u5199\u6cd5\u4f1a\u5728\u63a5\u4e0b\u6765\u7ed9\u51fa\u3002\n\n\u4f60\u9700\u8981\u6784\u9020\u4e00\u6761\u4ece $s$ \u5230 $t$ \u7684\u8def\u5f84\uff0c\u6ee1\u8db3\u8fbe\u5230\u7ed3\u70b9 $t$ \u65f6\uff0c\u5176\u7ebf\u6bb5\u6811\u4e0a\u6240\u6709\u6807\u8bb0\u7684\u548c\u7684\u6700\u5c0f\u3002\u8f93\u51fa\u8fd9\u4e2a\u6700\u5c0f\u503c\u3002\n\n\u4ee5\u4e0b\u662f\u7ebf\u6bb5\u6811\u7684\u4f2a\u4ee3\u7801\uff1a\uff08\u4e3a\u4e86\u65b9\u4fbf\u9009\u624b\u9605\u8bfb\uff0c\u9898\u76ee\u9644\u4ef6\u4e2d\u7ed9\u51fa\u4e86\u7ebf\u6bb5\u6811\u7684 C++ \u6e90\u4ee3\u7801\uff09\n\n$$\n\\begin{array}{l}\\hline\\hline\\\\[-0.8em]\n\\textbf{Algorithm: }\\text{SegTree}\\\\\\hline\\\\[-0.5em]\n\\begin{array}{rl}\n1& \\mathbf{Input.} \\text{ \u957f\u5ea6\u4e3a $k$ \u7684 $a$ \u6570\u7ec4\uff0c\u521d\u59cb\u5168\u4e3a $0$}\\\\\n2& \\mathbf{Output.} \\text{ $a$ \u6570\u7ec4\u8fdb\u884c\u82e5\u5e72\u6b21\u533a\u95f4\u52a0\u64cd\u4f5c\u540e\u5f97\u5230\u7684\u7ed3\u679c}\\\\\n3& \\mathbf{Method.}\\\\\n4& \\mathrm{Add}(L,R,x)\\\\\n5& \\quad\\mathrm{Add0}(L,R,x,root,1,k)\\\\\n6& \\mathrm{Add0}(L,R,x,u,l,r)\\\\\n7& \\quad\\mathbf{if}\\ L \\le l\\ \\mathbf{and}\\ r\\le R\\\\\n8& \\quad\\quad \\mathrm{tag}(u) \\gets \\mathrm{tag}(u) + x\\\\\n9& \\quad\\quad \\mathbf{return}\\\\\n10& \\quad mid \\gets \\lfloor\\frac{l+r} 2\\rfloor\\\\\n11& \\quad \\mathrm{tag}(\\mathrm{lson}(u)) \\gets \\mathrm{tag}(\\mathrm{lson}(u))+\\mathrm{tag}(u)\\\\\n12& \\quad \\mathrm{tag}(\\mathrm{rson}(u)) \\gets \\mathrm{tag}(\\mathrm{rson}(u))+\\mathrm{tag}(u)\\\\\n13& \\quad \\mathrm{tag}(u) \\gets 0\\\\\n14& \\quad\\mathbf{if}\\ L \\le mid\\\\\n15& \\quad\\quad\\mathrm{Add0}(L,R,x,\\mathrm{lson}(u),l,mid)\\\\\n16& \\quad\\mathbf{if}\\ mid < R\\\\\n17& \\quad\\quad\\mathrm{Add0}(L,R,x,\\mathrm{rson}(u),mid+1,r)\\\\\n\\end{array}\\\\\\hline\\hline\n\\end{array}\n$$",
    "inputFormat": "- \u7b2c\u4e00\u884c\u4e94\u4e2a\u6574\u6570 $n,m,k,s,t$\u3002\n- \u63a5\u4e0b\u6765 $m$ \u884c\uff0c\u6bcf\u884c\u4e94\u4e2a\u6574\u6570 $u_i,v_i,l_i,r_i,w_i$\u3002",
    "outputFormat": "- \u5171\u4e00\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u6cbf\u7740\u4f60\u6784\u9020\u7684\u8def\u5f84\u4ece $s$ \u5230\u8fbe $t$ \u540e\u7ebf\u6bb5\u6811\u4e0a\u6240\u6709\u61d2\u6807\u8bb0\u7684\u6743\u503c\u4e4b\u548c\u3002",
    "samples": [
        [
            "4 4 5 1 4\n1 2 1 2 2\n1 3 4 5 1\n2 4 2 3 1\n3 4 3 5 2",
            "5"
        ],
        [
            "10 19 5 6 1\n2 1 1 3 592\n6 8 3 5 488\n10 9 4 4 548\n10 4 1 4 442\n6 5 1 3 422\n9 7 1 4 529\n5 8 1 1 559\n5 9 1 5 560\n5 8 2 3 434\n5 9 3 3 592\n4 7 2 2 594\n7 9 5 5 595\n4 1 4 4 501\n3 9 1 2 410\n10 6 2 4 509\n6 10 4 5 455\n2 4 2 5 444\n4 3 4 5 541\n8 7 1 1 463\n",
            "2295\n"
        ]
    ],
    "hint": "### \u6837\u4f8b\u89e3\u91ca\n\n#### \u6837\u4f8b \\#1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/npzajpom.png)\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u6837\u4f8b $1$ \u4e2d\u6709\u4e14\u4ec5\u6709\u4e24\u6761\u53ef\u80fd\u7684\u8def\u5f84\uff1a$1\\to 2\\to 4$ \u4e0e $1\\to 3\\to 4$\u3002\u4e0b\u9762\u5206\u522b\u8ba1\u7b97\u8fd9\u4e24\u6761\u8def\u5f84\u6700\u7ec8 $\\text{tag}$ \u7684\u6743\u503c\u548c\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2fq7okad.png)\n\n\u8003\u8651\u753b\u51fa\u8fd9\u68f5 $k=5$ \u7684\u7ebf\u6bb5\u6811\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ys42i046.png)\n\n\u8d70\u4e86\u8fb9 $1\\to 2$ \u540e\uff0c$[1,2]$ \u8282\u70b9\u88ab\u6253\u4e0a\u4e86\u6743\u503c\u4e3a $2$ \u7684 $\\text{tag}$\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/02sqysh5.png)\n\n\u8d70\u4e86 $2\\to 4$ \u540e\uff0c$[2,2]$ \u8282\u70b9\u548c $[3,3]$ \u8282\u70b9\u88ab\u6253\u4e0a\u4e86\u503c\u4e3a $1$ \u7684 $\\text{tag}$\uff1b\u4f46\u662f $[1,2]$ \u8282\u70b9\u7684\u6807\u8bb0\u8fdb\u884c\u4e86\u4e0b\u63a8\uff08\u56e0\u4e3a\u4f7f $[2,3]$ \u533a\u95f4 $+1$ \u7684\u65f6\u5019\u4f1a\u8bbf\u95ee\u5230 $[1,2]$ \u8282\u70b9\uff0c\u800c $[1,2]\\nsubseteq[2,3]$\uff0c\u6545\u800c\u53d1\u751f\u6807\u8bb0\u4e0b\u63a8\uff09\uff0c\u56e0\u6b64 $[1,1]$ \u8282\u70b9\u548c $[2,2]$ \u8282\u70b9\u7684 $\\text{tag}$ \u5206\u522b\u52a0\u4e0a\u4e86 $2$\uff0c\u6700\u7ec8\u6210\u4e86\u5982\u56fe\u6240\u793a\u7684\u6a21\u6837\u3002\n\n\u56e0\u6b64\u8d70\u5230 $4$ \u4e4b\u540e\u6240\u6709\u7ed3\u70b9\u7684 $\\text{tag}$ \u4e4b\u548c\u4e3a $2+3+1=6$\u3002\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3va7fa03.png)\n\n\u5bf9\u4e8e\u53e6\u5916\u4e00\u6761\u8def\u5f84\uff0c\u9996\u5148\u5bf9 $[4,5]$ \u52a0\u4e0a $1$\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o1cw3s03.png)\n\n\u63a5\u7740\u5bf9 $[3,5]$ \u52a0\u4e0a $2$\u3002\u672a\u53d1\u751f\u5e26\u6709 $\\text{tag}$ \u7684\u8282\u70b9\u7684\u6807\u8bb0\u4e0b\u63a8\uff0c\u56e0\u6b64\u6700\u7ec8\u7684\u6743\u503c\u4e3a $2+3=5$\u3002\n\n\u7531\u4e8e $6>5$\uff0c\u56e0\u800c\u6700\u7ec8\u7684\u7b54\u6848\u4e3a $5$\u3002\n\n### \u6570\u636e\u8303\u56f4\u53ca\u7ea6\u5b9a\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|c|c|}\\hline\n\\textbf{subtask}& \\textbf{\u5206\u503c}& {\\bm n\\le} & {\\bm m\\le} & {\\bm k\\le} & \\textbf{\u7279\u6b8a\u6027\u8d28} & \\textbf{subtask \u4f9d\u8d56}\\cr\\hline\n1 & 10& 10 & 30 & 5 & - & -\\cr\\hline\n2 & 5&30 & 30 & 12 & \\textbf{AB} &-\\cr\\hline\n3 & 20&30 & 500 & 12 & \\textbf{B} &2 \\cr\\hline\n4 & 15&200 & 3\\times 10^3 & 25 & \\textbf{B}&3\\cr\\hline\n5 & 50&200 & 3\\times 10^3 & 25 & - &4\\cr\\hline\n\\end{array}\n$$\n\n- **\u7279\u6b8a\u6027\u8d28** $\\textbf{A}$\uff1a\u4fdd\u8bc1\u6709\u4e14\u4ec5\u6709\u4e00\u6761\u4ece $s$ \u5230 $t$ \u7684\u8def\u5f84\u3002\n- **\u7279\u6b8a\u6027\u8d28** $\\textbf{B}$\uff1a\u4fdd\u8bc1\u56fe\u4e2d\u4e0d\u5b58\u5728\u73af\u3002\n\n\u5bf9\u4e8e $100\\%$ \u7684\u6570\u636e\uff0c\u6709 $1 \\le s,t,u_i,v_i \\leq n \\leq 200$\uff0c$1 \\leq m \\leq 3\\times 10^3$\uff0c$1 \\leq l_i\\le r_i \\leq k \\leq 25$\uff0c$1 \\leq w_i \\leq 10^3$\u3002\n\n### \u63d0\u793a\n\n\u5728\u9644\u4ef6\u4e2d\u6709\u4e24\u4e2a\u7248\u672c\u7684\u7ebf\u6bb5\u6811\u3002$\\text{Lite}$ \u7248\u672c**\u4ec5**\u5305\u542b\u4e86\u5728\u672c\u9898\u4e2d\u4f60\u4f1a\u7528\u5230\u7684\u4e0b\u63a8\u6807\u8bb0\u7684\u64cd\u4f5c\uff0c\u800c\u6807\u51c6\u7248\u5219\u8f83\u4e3a\u5b8c\u6574\u5730\u652f\u6301\u533a\u95f4\u52a0\u3001\u533a\u95f4\u6c42\u548c\u3002\u9009\u624b\u53ef\u6839\u636e\u81ea\u5df1\u7684\u559c\u597d\u4f7f\u7528\u3002"
}
{
    "description": "In ancient times, when alchemists were searching for gold, the world was familiar with a total\nof \u200bN distinct substances, denoted with 1 to \u200bN\u200b. During many years of hard work, searching for\nthe secret formula, alchemists discovered a series of interesting regularities - \u200balchemical\nreactions\n\u200b. In one reaction, it\u2019s possible to transform substance set {\n$X_1$\u200b,$X_2$\u200b, \u2026, $X_L$\u200b} to another\nsubstance set {$Y_1$\u200b, $Y_2$\u200b, \u2026, \u200b$Y_R$\u200b}. For example, the substance set {1, 4, 5} might react once and\ncreate the new substance set {2, 6}.\n\nJo\u0161ko is a modern alchemist and has \u200bM distinct substances denoted with \u200b$A_1$\u200b, $A_2$\u200b, \u2026, \u200b$A_M$\u200b. He\nhas an unlimited quantity of each substance from that set. Jo\u0161ko wants to know which\nsubstances he can create using a list of reactions of ancient alchemists, so he\u2019s asking you\nto help him solve this problem.",
    "inputFormat": "The first line of input contains two integers N and M (1 \u2264 M \u2264 N \u2264 100 000), the numbers from the task.\n\nThe second line of input contains M integers $A_i$ (1 \u2264 $A_i$ \u2264 N), labels of the substances Jo\u0161ko has in the beginning.\n\nThe third line of input contains the integer K (1 \u2264 K \u2264 100 000), the number of known\nreactions.\n\nThe following 3\u00b7K lines contain a list of reactions. Each reaction is described with 3 lines in the following way:\n\n- The first line contains the integers L and R (1 \u2264 L, R \u2264 N).\n- The second line contains L distinct integers $X_i$ (1 \u2264 $X_i$ \u2264 N).\n- The third line contains R distinct integers $Y_i$ (1 \u2264 $Y_i$ \u2264 N).\n- This describes the reaction with which the substance set {$X_1$, $X_2$, \u2026, $X_L$} transforms into substance set {$Y_1$, $Y_2$, \u2026, $Y_R$}.\n\nThe sum of all L values won\u2019t exceed 100 000.\n\nThe sum of all R values won\u2019t exceed 100 000.",
    "outputFormat": "The first line of output must contain the integer X, the number of obtainable substances.\n\nThe second line of output must contain X distinct integers $B_i$, sorted ascendingly, that represent the labels of the obtainable substances.\n",
    "samples": [
        [
            "4 2\n1 2\n2\n2 1\n1 2\n3\n2 1\n1 3\n4\n",
            "4\n1 2 3 4"
        ],
        [
            "6 3\n1 4 5\n3\n3 2\n2 3 4\n1 6\n1 3\n4\n1 5 6\n1 1\n6\n2\n",
            "5\n1 2 4 5 6"
        ]
    ],
    "hint": "In test cases worth 60% of total points, it will hold:\n\n- N, K \u2264 500.\n- The sum of all L values and the sum of all R values won\u2019t exceed 500.\n\n**Clarification of the first test case:**\n\nThere are 2 reactions.\n\nThe first reaction transforms substance set {1, 2} into substance set {3}.\n\nThe second reaction transforms substance set {1, 3} into substance set {4}.\n\nJo\u0161ko initially has substances from the set {1, 2}.\n\nUsing the first reaction, Jo\u0161ko can obtain substance 3, after which he has substances from the set {1, 2, 3}.\n\nAfter that, using the second reaction, he can also obtain substance 4.\n\n**Clarification of the second test case:**\n\nJo\u0161ko initially has substances from the set {1, 4, 5}.\n\nUsing the second reaction, it is possible to obtain substance 6, after which it is possible to apply the third reaction, giving substance 2.\n\nThe first reaction is impossible to apply because Jo\u0161ko doesn\u2019t have substance 3.",
    "translation": "\u4e00\u5171\u5b58\u5728 $N$ \u79cd\u5143\u7d20\uff0c\u73b0\u5728\u4f60\u53ea\u62e5\u6709\u5176\u4e2d\u7684 $M$ \u4e2a\u3002\u73b0\u5728\u7ed9\u4f60 $K$ \u4e2a\u5f0f\u5b50\uff0c\u6bcf\u4e2a\u5f0f\u5b50\u90fd\u6709\u4e24\u6392\uff0c\u7b2c\u4e00\u6392\u4e3a\u4ed6\u6240\u9700\u8981\u7684\u5143\u7d20\uff0c\u7b2c\u4e8c\u6392\u4e3a\u4ed6\u6240\u53ef\u4ee5\u83b7\u5f97\u7684\u5143\u7d20\u3002\u4f60\u7684\u5143\u7d20\u662f\u65e0\u9650\u7684\uff0c\u95ee\u4f60\u6700\u540e\u6700\u591a\u53ef\u4ee5\u83b7\u5f97\u54ea\u4e9b\u5143\u7d20\uff1f"
}
{
    "description": "\u7ed9\u5b9a\u4e00\u68f5\u5305\u542b $n$ \u4e2a\u70b9\u7684\u7531\u6709\u6839\u6811\u6784\u6210\u7684\u68ee\u6797\uff08\u521d\u59cb\u6ca1\u6709\u8fb9\uff0c\u6bcf\u4e2a\u9876\u70b9\u662f\u4e00\u68f5\u6709\u6839\u6811\u7684\u6839\uff09\uff0c\u9876\u70b9\u7531 $1$ \u5230 $n$ \u7684\u6574\u6570\u7f16\u53f7\u8868\u793a\u3002\n\u4f60\u9700\u8981\u7ef4\u62a4\u68ee\u6797\u7684\u8f7b\u91cd\u94fe\u5256\u5206\u7ed3\u6784\uff0c\u5177\u4f53\u5982\u4e0b\uff1a\n\n\u5bf9\u6bcf\u4e2a\u9876\u70b9 $w\\;(1\\le w\\le n)$\uff0c\u8bb0\u5176\u5b69\u5b50\u6784\u6210\u7684\u96c6\u5408\u4e3a $\\mathrm{children}(w)$\uff0c\u5bf9 $w$ \u82e5 $w$ \u4e0d\u662f\u6839\u5219\u8bb0\u5176\u7236\u4eb2\u4e3a $\\mathrm{father}(w)$\uff1b\n\n\u4e00\u4e2a\u9876\u70b9 $w$ \u7684\u5b50\u6811\u89c4\u6a21 $\\mathrm{size(w)}$ \u5b9a\u4e49\u4e3a $1+\\sum\\limits_{u\\in\\mathrm{children}(w)}\\mathrm{size(u)}$\uff1b\n\n\u4e00\u4e2a\u9876\u70b9 $w$ \u5982\u679c\u4e0d\u662f\u53f6\u5b50\uff08\u5373 $\\mathrm{children}(w)\\ne\\varnothing$\uff09\uff0c\u5219\u5b83\u7684\u91cd\u5b69\u5b50 $\\mathrm{hc}(w)$ \u88ab\u5b9a\u4e49\u4e3a $\\mathrm{arg}\\max_{u\\in\\mathrm{children}(w)}size(u)\\cdot n+\\max(u,\\mathrm{hc}(u),\\mathrm{hc}(\\mathrm{hc}(u)),\\dots)$\uff0c\u5373\u5b50\u6811\u89c4\u6a21\u6700\u5927\u7684\u5b69\u5b50\uff08\u82e5\u6709\u591a\u4e2a\u5b69\u5b50 $u$ \u7684\u5b50\u6811\u89c4\u6a21\u76f8\u540c\u5219\u53d6\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c$u$ \u6240\u5728\u91cd\u94fe\u4e2d\u6700\u5927\u7684\u7f16\u53f7\u6700\u5927\uff09\uff1b\n\n\u91cd\u94fe\u662f\u4e00\u4e2a\u7531\u9876\u70b9\u6784\u6210\u7684\u5e8f\u5217 $w_1,w_2,\\dots,w_k\\;(k>0)$\uff0c\u6ee1\u8db3\u6761\u4ef6\uff1a\n\n- $w_1$ \u662f\u6839\u6216 $w_1\\ne \\mathrm{hc}(\\mathrm{father}(w_1))$\n- $w_i=\\mathrm{hc}(w_{i-1})\\;(2\\le i\\le k)$\n\n\u5bf9\u4e00\u68f5\u6811\uff0c\u6bcf\u4e2a\u9876\u70b9\u6070\u597d\u5c5e\u4e8e\u4e00\u6761\u91cd\u94fe\u3002\n\u91cd\u94fe\u7684\u6743\u503c\u4e3a $w_1\\oplus w_2\\oplus\\dots\\oplus w_k$\uff0c\u5373\u5e8f\u5217\u4e2d\u9876\u70b9\u7f16\u53f7\u7684\u6309\u4f4d\u5f02\u6216\u548c\u3002\n\n\u9700\u8981\u4f9d\u6b21\u8fdb\u884c $2m$ \u6b21\u64cd\u4f5c\uff0c\u64cd\u4f5c\u7c7b\u578b\u5982\u4e0b\uff1a\n\n- \u52a0\u8fb9\uff1a\u7ed9\u51fa\u4e24\u4e2a\u9876\u70b9 $a,b$\uff0c\u4ee4 $b$ \u6210\u4e3a $b$ \u6240\u5728\u6709\u6839\u6811\u7684\u6839\uff08\u8bbe\u9876\u70b9\u6784\u6210\u7684\u5e8f\u5217 $t_1,t_2,\\dots,t_l$ \u6ee1\u8db3 $t_l=b$\uff0c\u4e14 $t_1$ \u4e3a\u6839\uff0c$(t_i,t_{i+1}),\\;1\\le i<l$ \u662f $b$ \u6240\u5728\u6709\u6839\u6811\u4e0a\u7684\u6709\u5411\u8fb9\uff0c\u5c06\u8fd9\u4e9b\u8fb9\u7684\u65b9\u5411\u53cd\u8f6c\u4e3a $(t_{i+1},t_i)$ \u5373\u53ef\u4ee4 $b$ \u6210\u4e3a\u6839\uff09\uff0c\u7136\u540e\u52a0\u5165 $a$ \u5230 $b$ \u7684\u6709\u5411\u8fb9 $(a,b)$\uff0c\u4fdd\u8bc1\u64cd\u4f5c\u524d $a,b$ \u5728\u4e0d\u540c\u7684\u6709\u6839\u6811\u4e0a\uff1b\n- \u5220\u8fb9\uff1a\u7ed9\u51fa\u4e24\u4e2a\u9876\u70b9 $a,b$\uff0c\u5220\u9664 $a,b$ \u95f4\u7684\u6709\u5411\u8fb9\uff08\u53ef\u80fd\u4e3a $(a,b)$ \u6216 $(b,a)$ \uff09\uff0c\u4fdd\u8bc1\u8fd9\u6761\u8fb9\u4e4b\u524d\u5b58\u5728\uff1b\n- \u67e5\u8be2\uff1a\u7ed9\u51fa\u4e00\u4e2a\u6574\u6570 $k$\uff0c\u8bbe\u5f53\u524d\u5171\u6709 $N$ \u6761\u91cd\u94fe\uff0c\u8be2\u95ee\u5c06\u5f53\u524d\u5b58\u5728\u7684\u6240\u6709\u91cd\u94fe\u6309\u6743\u503c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u540e\uff0c\u7b2c $((k-1) \\mod N)+1$ \u5c0f\u7684\u6743\u503c\u3002",
    "inputFormat": "\u7b2c $1$ \u884c\u6709\u4e24\u4e2a\u6574\u6570 `n m` \uff1b\n\n\u63a5\u4e0b\u6765 $m$ \u884c\uff0c\u6bcf\u884c\u56db\u4e2a\u6574\u6570 `o a b k` \uff0c\u82e5 $o=1$ \u5219\u8868\u793a\u5148\u52a0\u8fb9 $a,b$\uff0c\u7136\u540e\u67e5\u8be2 $k$\uff0c\u82e5 $o=0$ \u5219\u8868\u793a\u5148\u5220\u8fb9 $a,b$\uff0c\u7136\u540e\u67e5\u8be2 $k$\u3002",
    "outputFormat": "\u5171 $m$ \u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u4f9d\u6b21\u4e3a\u6bcf\u6b21\u67e5\u8be2\u64cd\u4f5c\u7684\u7ed3\u679c\u3002",
    "samples": [
        [
            "5 10\n1 4 2 5\n1 1 4 2\n1 2 5 3\n0 4 2 3\n1 4 3 4\n1 1 5 3\n0 1 5 4\n0 5 2 4\n0 1 4 1\n1 5 2 3\n",
            "1\n5\n2\n7\n7\n6\n7\n2\n1\n7\n"
        ]
    ],
    "hint": "Idea\uff1anzhtl1477\uff0cSolution\uff1accz181078\uff0cCode\uff1accz181078\uff0cData\uff1accz181078\n\n\u672c\u9898\u91c7\u7528\u5b50\u4efb\u52a1\u8bc4\u6d4b\u3002\n\n\u5171 $31$ \u4e2a\u6d4b\u8bd5\u70b9\uff0c\u6240\u6709\u6d4b\u8bd5\u70b9\u6ee1\u8db3 $1\\le n\\le 10^5$\uff0c$1\\le m\\le 5\\times 10^5$\uff0c$0\\le o\\le 1$\uff0c$1\\le a\\le n$\uff0c$1\\le b \\le n$\uff0c$1\\le k\\le n$\uff0c$n,m,o,a,b,k$ \u5747\u4e3a\u6574\u6570\uff1b\n\n\u6d4b\u8bd5\u70b9\u53ef\u80fd\u5177\u6709\u4ee5\u4e0b\u6027\u8d28\uff1a\n\n- \u6027\u8d281\uff1a\u64cd\u4f5c\u4f7f\u7528\u4ee5\u4e0b\u7b56\u7565\u968f\u673a\u751f\u6210\uff0c\u91cd\u590d\u76f4\u5230\u751f\u6210\u4e86 $m$ \u884c\u7684\u64cd\u4f5c\u5e8f\u5217\uff1a\n\n- \u5728 $[1,n]$ \u4e2d\u7b49\u6982\u7387\u9009\u53d6\u4e09\u4e2a\u6574\u6570 $x,y,k$\uff0c\u82e5 $x,y$ \u5728\u4e0d\u540c\u7684\u6709\u6839\u6811\u4e0a\uff0c\u5219\u751f\u6210\u4e00\u884c `1 x y k`\uff0c\u5426\u5219\u82e5 $x$ \u4e0d\u662f\u6839\uff0c\u7b49\u6982\u7387\u5730\u751f\u6210\u4e00\u884c `0 x father(x) k` \u6216 `0 father(x) x k` \u4e4b\u4e00\uff0c\u5426\u5219\u4e0d\u8fdb\u884c\u64cd\u4f5c\u3002\n\n- \u6027\u8d282\uff1a$m=n-1$\uff0c\u4e14\u5bf9 $2\\le i\\le n$\uff0c\u6570\u636e\u7684\u7b2c $i$ \u884c\u4e3a `1 a i k`\uff0c\u5176\u4e2d $a$ \u5728 $[1,i-1]$ \u4e2d\u7684\u6574\u6570\u7b49\u6982\u7387\u9009\u53d6\uff1b\n- \u6027\u8d283\uff1a$m=n-1$\uff0c\u4e14\u5bf9 $2\\le i\\le n$\uff0c\u6570\u636e\u7684\u7b2c $i$ \u884c\u4e3a `1 i b k`\uff0c\u5176\u4e2d $b$ \u5728 $[1,i-1]$ \u4e2d\u7684\u6574\u6570\u7b49\u6982\u7387\u9009\u53d6\uff1b\n- \u5176\u5b83\u5bf9 $n,m$ \u7684\u9650\u5236\u3002\n\n\u6bcf\u4e2a\u6d4b\u8bd5\u70b9\u7684\u6027\u8d28\u5982\u4e0b\uff1a\n\n\u7b2c1\u4e2a\u6d4b\u8bd5\u70b9\uff0c$n=10,\\;m=50$\uff0c\u6ee1\u8db3\u6027\u8d281\uff0c\u517110\u5206\uff1b\n\n\u7b2c2\u4e2a\u6d4b\u8bd5\u70b9\uff0c$n=100,\\;m=500$\uff0c\u6ee1\u8db3\u6027\u8d281\uff0c\u517110\u5206\uff1b\n\n\u7b2c3\u4e2a\u6d4b\u8bd5\u70b9\uff0c$n=1000,\\;m=5000$\uff0c\u6ee1\u8db3\u6027\u8d281\uff0c\u517110\u5206\uff1b\n\n\u7b2c4\u4e2a\u6d4b\u8bd5\u70b9\uff0c\u6ee1\u8db3\u6027\u8d282\uff0c\u517115\u5206\uff1b\n\n\u7b2c5\u4e2a\u6d4b\u8bd5\u70b9\uff0c\u6ee1\u8db3\u6027\u8d283\uff0c\u517115\u5206\uff1b\n\n\u7b2c6~10\u4e2a\u6d4b\u8bd5\u70b9\uff0c\u6ee1\u8db3\u6027\u8d281\uff0c\u517120\u5206\uff1b\n\n\u7b2c11~31\u4e2a\u6d4b\u8bd5\u70b9\u6ca1\u6709\u7279\u6b8a\u9650\u5236\uff0c\u517120\u5206\u3002"
}
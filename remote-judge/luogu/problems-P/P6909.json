{
    "description": "How many keystrokes are necessary to type a text message? You may think that it is equal to the number of characters in the text, but this is correct only if one keystroke generates one character. With pocket-size devices, the possibilities for typing text are often limited. Some devices provide only a few buttons, significantly fewer than the number of letters in the alphabet. For such devices, several strokes may be needed to type a single character. One mechanism to deal with these limitations is a virtual keyboard displayed on a screen, with a cursor that can be moved from key to key to select characters. Four arrow buttons control the movement of the cursor, and when the cursor is positioned over an appropriate key, pressing the fifth button selects the corresponding character and appends it to the end of the text. To terminate the text, the user must navigate to and select the Enter key. This provides users with an arbitrary set of characters and enables them to type text of any length with only five hardware buttons.\n\nIn this problem, you are given a virtual keyboard layout and your task is to determine the minimal number of strokes needed to type a given text, where pressing any of the five hardware buttons constitutes a stroke. The keys are arranged in a rectangular grid, such that each virtual key occupies one or more connected unit squares of the grid. The cursor starts in the upper left corner of the keyboard and moves in the four cardinal directions, in such a way that it always skips to the next unit square in that direction that belongs to a different key. If there is no such unit square, the cursor does not move.\n\n  ![](https://vj.z180.cn/4393d80e3f068a496c9b906fdca621d9?v=1603457188) \n\n   Figure 1: Sample Input 1. An example virtual keyboard and hardware buttons. \n\nFigure 1, illustrating Sample Input 1, shows a possible way to type CONTEST using 30 strokes on an example virtual keyboard. The red dots represent the virtual keys where the select button was pressed.",
    "inputFormat": "The first line of the input contains two integers $r$ and $c$ ($1 \\leq r, c \\leq 50$), giving the number of rows and columns of the virtual keyboard grid. The virtual keyboard is specified in the next $r$ lines, each of which contains $c$ characters. The possible values of these characters are uppercase letters, digits, a dash, and an asterisk (representing Enter). There is only one key corresponding to any given character. Each key is made up of one or more grid squares, which will always form a connected region. The last line of the input contains the text to be typed. This text is a non-empty string of at most $10\\, 000$ of the available characters other than the asterisk.",
    "outputFormat": "Display the minimal number of strokes necessary to type the whole text, including the Enter key at the end. It is guaranteed that the text can be typed.",
    "samples": [
        [
            "4 7\nABCDEFG\nHIJKLMN\nOPQRSTU\nVWXYZ**\nCONTEST\n",
            "30\n"
        ],
        [
            "5 20\n12233445566778899000\nQQWWEERRTTYYUUIIOOPP\n-AASSDDFFGGHHJJKKLL*\n--ZZXXCCVVBBNNMM--**\n--------------------\nACM-ICPC-WORLD-FINALS-2015\n",
            "160\n"
        ],
        [
            "2 19\nABCDEFGHIJKLMNOPQZY\nX*****************Y\nAZAZ\n",
            "19\n"
        ],
        [
            "6 4\nAXYB\nBBBB\nKLMB\nOPQB\nDEFB\nGHI*\nAB\n",
            "7\n"
        ]
    ],
    "hint": "Time limit: 3000 ms, Memory limit: 1048576 kB. \n\n International Collegiate Programming Contest (ACM-ICPC) World Finals 2015",
    "translation": "\u7ed9\u5b9a\u4e00\u4e2a $r$ \u884c $c$ \u5217\u7684\u5728\u7535\u89c6\u4e0a\u7684\u300c\u865a\u62df\u952e\u76d8\u300d\uff0c\u901a\u8fc7\u300c\u4e0a\uff0c\u4e0b\uff0c\u5de6\uff0c\u53f3\uff0c\u9009\u62e9\u300d\u5171 $5$ \u4e2a\u63a7\u5236\u952e\uff0c\u4f60\u53ef\u4ee5\u79fb\u52a8\u7535\u89c6\u5c4f\u5e55\u4e0a\u7684\u5149\u6807\u6765\u6253\u5370\u6587\u672c\u3002\u4e00\u5f00\u59cb\uff0c\u5149\u6807\u5728\u952e\u76d8\u7684\u5de6\u4e0a\u89d2\uff0c\u6bcf\u6b21\u6309\u65b9\u5411\u952e\uff0c\u5149\u6807\u603b\u662f\u8df3\u5230\u4e0b\u4e00\u4e2a\u5728\u8be5\u65b9\u5411\u4e0a\u4e0e\u5f53\u524d\u4f4d\u7f6e\u4e0d\u540c\u7684\u5b57\u7b26\uff0c\u82e5\u4e0d\u5b58\u5728\u5219\u4e0d\u79fb\u52a8\u3002\u6bcf\u6b21\u6309\u9009\u62e9\u952e\uff0c\u5219\u5c06\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u7684\u5b57\u7b26\u6253\u5370\u51fa\u6765\u3002  \n\u73b0\u5728\u6c42\u6253\u5370\u7ed9\u5b9a\u6587\u672c\uff08\u8981\u5728\u7ed3\u5c3e\u6253\u5370\u6362\u884c\u7b26\uff09\u7684\u6700\u5c11\u6309\u952e\u6b21\u6570\u3002"
}
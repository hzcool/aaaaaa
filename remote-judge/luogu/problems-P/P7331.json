{
    "description": "Dream abstracts the fabric of spacetime as a directed rooted tree (arborescence) with $N$ nodes (numbered $1$ through $N$). Node $1$ is the root and for each $i$ ($1 \\le i \\le N-1$), the parent of node $i+1$ is $f_i$. All edges of this tree are directed away from the root.\n\nThen, Dream employs a magical superpower and adds $M$ directed edges to this tree in such a way that the resulting directed graph remains acyclic (a DAG).\n\nLet's call a node of this DAG an *event* and further call a simple path on this DAG an *era*. Dream considers a pair of events $(i,j)$ to be *plausible* if there is an era whose first event is $i$ and last event is $j$. Note that $i \\lt j$ does not have to hold for a plausible pair.\n\nDream now wants you to answer $Q$ queries. In each query, he gives you two positive integers $l$ and $r$, where $l \\leq r$, and he wishes to know the number of plausible pairs of events $(i,j)$ such that $l \\leq i \\lt j \\leq r$.",
    "inputFormat": "The first line of the input contains two space-separated integers $N$ and $M$.\n\nThe second line contains $N-1$ space-separated integers $f_1, f_2, \\ldots, f_{N-1}$.\n\n$M$ lines follow. Each of these lines contains two space-separated integers $u$ and $v$ describing an additional edge from node $u$ to node $v$.\n\nThe following line contains a single integer $Q$.\n\n$Q$ lines follow. Each of these lines contains two space-separated integers $l$ and $r$ describing a query.",
    "outputFormat": "For each query, print a single line containing one integer \u2015 the number of plausible pairs $(i,j)$ such that $l \\leq i \\lt j \\leq r$.",
    "samples": [
        [
            "8 2\n1 2 5 1 4 3 3\n2 4\n4 7\n3\n4 6\n5 7\n1 8",
            "2\n2\n18"
        ]
    ],
    "hint": " - $2 \\leq N \\leq 7 \\cdot 10^5$\n - $1 \\leq Q \\leq 7 \\cdot 10^5$\n - $0 \\leq M \\leq 20$\n - $1 \\le f_i \\le N$ for each valid $i$\n - $1 \\le u, v \\le N$\n - the graph described on the input is acyclic\n - $1 \\le l \\le r \\le N$\n\n### Subtasks\n\n**Subtask #1 (17 points):** $N,Q\\le3\\cdot 10^5$\n\n**Subtask #2 (83 points):** original constraints\n"
}
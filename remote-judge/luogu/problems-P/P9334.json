{
    "description": "Mizuyokan is a Japanese confectionery made of azuki beans paste. It was made by cooking azuki beans paste with agar, and solidifying them in a rectangular-shaped form.\n\nNow, JOI-kun has a mizuyokan machine. Using it, JOI-kun can make a horizontally long rectangular-shaped mizuyokan with $N - 1$ vertical cutlines. The length of the mizuyokan and the positions of the cutlines are determined by the $N$ parameters $d_1, d_2, \\dots, d_N$ set on the machine. The length of the mizuyokan is $d_1 + d_2 + \\dots + d_N$. The distance between the $(i - 1)$-th cutline $(1 \\le i \\le N)$ from the left and the $i$-th cutline from the left is $d_i$. Here, we consider the leftmost edge of the mizuyokan as the $0$-th cutline, and the rightmost edge of the mizuyokan as the $N$-th cutline. In the beginning, the parameters of the mizuyokan machine satisfy $d_i = L_i \\ (1 \\le i \\le N)$.\n\nJOI-kun has a plan to organize $Q$ tea parties. The $j$-th tea party $(1 \\le j \\le Q)$ is described by the integers $X_j, Y_j, A_j, B_j$. It proceeds as follows.\n\n1. The parameter $d_{X_j}$ of the mizuyokan machine is updated, and it is set as $Y_j$.\n2. JOI-kun makes a new mizuyokan using the mizuyokan machine. He takes the part of the mizuyokan 0between the $A_j$-th cutline and the $B_j$-th cutline, and uses it for the tea party. He eats the rest.\n3. JOI-kun cuts the part of the mizuyokan for the tea party along some of the cutlines. He cuts the part of the mizuyokan into one or more pieces. In this process, the following condition should be satisfied: if the pieces are ordered from the left as in the original positions, the sequence of the lengths of the pieces is **zigzag**.\n\nHere, a sequence is called zigzag if the elements of the sequence increase and decrease alternately. For example, the sequences $(2, 9, 2, 7), (7, 1, 9, 4, 6), (5), (2, 1)$ are zigzag, but the sequences $(1, 2, 3), (7, 1, 4, 4, 6), (2, 2)$ are not zigzag. Precisely, a sequence $(x_1, x_2, \\dots, x_m)$ is called zigzag if one (or the both) of the following conditions are satisfied:\n\n- For $k = 1, 2, \\dots, m - 1$, the inequality $x_k < x_{k + 1}$ is satisfied if $k$ is odd, and the inequality $x_k > x_{k + 1}$ is satisfied if $k$ is even.\n- For $k = 1, 2, \\dots, m - 1$, the inequality $x_k > x_{k + 1}$ is satisfied if $k$ is odd, and the inequality $x_k < x_{k + 1}$ is satisfied if $k$ is even.\n\nSince JOI-kun wants to give mizuyokan to as many friends as possible, he wants to maximize the number of pieces obtained by the procedure 3. of the tea party.\n\nWrite a program which, given information of the initial parameters of the mizuyokan machine and the plan of the tea parties, calculates, for each tea party, the maximum possible number of pieces obtained by cutting the part of the mizuyokan so that the condition is satisfied. Note that, under the constraints of this task, it is always possible to cut the part of the mizuyokan so that the condition is satisfied.",
    "inputFormat": "Read the following data from the standard input.\n\n> $N$\n>\n> $L_1 \\ L_2 \\ \\cdots \\ L_N$\n>\n> $Q$\n>\n> $X_1 \\ Y_1 \\ A_1 \\ B_1$\n>\n> $X_2 \\ Y_2 \\ A_2 \\ B_2$\n>\n> $\\vdots$\n>\n> $X_Q \\ Y_Q \\ A_Q \\ B_Q$",
    "outputFormat": "Write $Q$ lines to the standard output. The $j$-th line $(1 \\le j \\le Q)$ of output corresponds to the $j$-th tea party. It contains the maximum possible number of pieces obtained by cutting the part of the mizuyokan in the $j$-th tea party so that the condition is satisfied.",
    "samples": [
        [
            "6\n5 6 8 7 4 9\n1\n6 9 0 5\n",
            "3\n"
        ],
        [
            "4\n6 2 3 6\n3\n3 2 1 3\n4 5 1 4\n1 1 0 4\n",
            "1\n2\n3\n"
        ]
    ],
    "hint": "**\u3010\u6837\u4f8b\u89e3\u91ca #1\u3011**\n\nIn the first tea party, the parameters of the mizuyokan machine is set as $(d_1, d_2, d_3, d_4, d_5, d_6) = (5, 6, 8, 7, 4, 9)$.\n\nJOI-kun uses the part of the mizuyokan between the $0$-th cutline and the $5$-th cutline as in Figure 1.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/52j3fpkl.png)\n\nFor example, JOI-kun can cut the part of the mizuyokan as follows.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/phx1owbf.png)\n\nIn Method 1, the lengths of the pieces are $5, 14, 7, 4$. Since this sequence is not zigzag, it does not satisfy the condition. On the other hand, in Method 2, the lengths of the pieces are $11, 8, 11$. Since this sequence is zigzag, it satisfies the condition. In Method 3, the length of the piece is $30$. Since this sequence is zigzag, it also satisfies the condition.\n\nIf JOI-kun cuts the part of the mizuyokan by Method 2, he gets $3$ pieces. Since it is not possible for him to cut the part of the mizuyokan so that the condition is satisfied and he gets more than or equal to $4$ pieces, output $3$ in the first line.\n\n\u8be5\u6837\u4f8b\u6ee1\u8db3\u6240\u6709\u5b50\u4efb\u52a1\u7684\u9650\u5236\u3002\n\n**\u3010\u6837\u4f8b\u89e3\u91ca #2\u3011**\n\nIn the first tea party, the length of the part of the mizuyokan for the tea party is $4$. There is a cutline whose distance is $2$ from the leftmost edge. If JOI-kun uses the mizuyokan without cutting it, he gets one piece. The sequence of the lengths of the pieces is $(4)$, which is zigzag. Since he cannot obtain more than one pieces, output $1$.\n\nIn the second tea party, the length of the part of the mizuyokan for the tea party is $9$. There are two cutlines whose distances are $2, 4$ from the leftmost edge. If JOI-kun cuts the mizuyokan at the cutline whose distance is $4$ from the leftmost edge, he gets two pieces. The sequence of the lengths of the pieces is $(4, 5)$, which is zigzag. Since he cannot obtain more than two pieces, output $2$.\n\nIn the third tea party, the length of the part of the mizuyokan for the tea party is $10$. There are three cutlines whose distances are $1, 3, 5$ from the leftmost edge. If JOI-kun cuts the mizuyokan at the cutlines whose distances are $3, 5$ from the leftmost edge, he gets three pieces. The sequence of the lengths of the pieces is $(3, 2, 5)$, which is zigzag. Since he cannot obtain more than three pieces, output $3$.\n\n\u8be5\u6837\u4f8b\u6ee1\u8db3\u5b50\u4efb\u52a1 $1, 2, 3, 5, 6$ \u7684\u9650\u5236\u3002\n\n**\u3010\u6570\u636e\u8303\u56f4\u3011**\n\n\u5bf9\u4e8e\u6240\u6709\u6d4b\u8bd5\u6570\u636e\uff0c\u6ee1\u8db3 $1 \\le N \\le 2.5 \\times 10 ^ 5$\uff0c$1 \\le L_i \\le 10 ^ 9$\uff0c$1 \\le Q \\le 5 \\times 10 ^ 4$\uff0c$1 \\le X_j \\le N$\uff0c$1 \\le Y_j \\le 10 ^ 9$\uff0c$0 \\le A_j < B_j \\le N$\uff0c\u4fdd\u8bc1\u6240\u6709\u8f93\u5165\u5747\u4e3a\u6574\u6570\u3002\n\n|\u5b50\u4efb\u52a1\u7f16\u53f7|\u5206\u503c|\u9650\u5236|\n|:-:|:-:|:-:|\n|$1$|$6$|$N \\le 200$\uff0c$Q \\le 10$|\n|$2$|$9$|$N \\le 2000$\uff0c$Q \\le 10$|\n|$3$|$13$|$Q \\le 10$|\n|$4$|$32$|$Y_j = L_{X_j}$|\n|$5$|$29$|$L_i, Y_j \\le 1.2 \\times 10 ^ 5$|\n|$6$|$11$|\u65e0|",
    "translation": "#### \u9898\u76ee\u63cf\u8ff0\n\n\u6c34\u7f8a\u7fb9\u662f\u4e00\u79cd\u65e5\u672c\u751c\u70b9\uff0c\u662f\u7528\u7ea2\u8c46\u7cca\u548c\u743c\u8102\u5236\u6210\u7684\u3002\u5b83\u7684\u505a\u6cd5\u662f\u5148\u5c06\u7ea2\u8c46\u7cca\u4e0e\u743c\u8102\u6df7\u5408\u540e\u6405\u62cc\u5747\u5300\uff0c\u7136\u540e\u5012\u5165\u957f\u65b9\u5f62\u6a21\u5177\u4e2d\uff0c\u7b49\u5f85\u5b83\u4eec\u51dd\u56fa\u6210\u578b\u3002\n\n\u73b0\u5728\uff0cJOI \u541b\u6709\u4e86\u4e00\u4e2a\u5236\u4f5c\u6c34\u7f8a\u7fb9\u7684\u673a\u5668\u3002\u4ed6\u53ef\u4ee5\u7528\u8be5\u673a\u5668\u5236\u4f5c\u4e00\u5757\u957f\u5ea6\u4e3a $d_1+d_2+\u22ef+d_N$ \u7684\u6c34\u7f8a\u7fb9\u3002JOI \u541b\u53ef\u4ee5\u8ba9\u8fd9\u5757\u6c34\u7f8a\u7fb9\u6cbf\u7740 $N\u22121$ \u6761\u5782\u76f4\u7684\u5207\u5272\u7ebf\uff08\u4e0d\u5305\u62ec\u4e24\u7aef\uff09\u5206\u5272\u6210 NN \u6bb5\u957f\u5ea6\u4e3a $d_1,d_2,\u2026,d_N$ \u7684\u7ad6\u6761\u5f62\u72b6\u7684\u5c0f\u7247\u3002\n\nJOI \u541b\u5e0c\u671b\u5728\u6709 $Q$ \u573a\u8336\u4f1a\u4e0a\u9001\u7ed9\u5c3d\u53ef\u80fd\u591a\u7684\u670b\u53cb\u6c34\u7f8a\u7fb9\u3002\u6bcf\u573a\u8336\u4f1a\u5bf9\u5e94 $(X_j,Y_j,A_j,B_j)$\uff0c\u5176\u4e2d\uff1a\n\n+ JOI \u541b\u4f1a\u66f4\u65b0\u673a\u5668\u4e0a\u7b2c $X_j$ \u6761\u5207\u5272\u7ebf\u7684\u4f4d\u7f6e\u4e3a $Y_j$\uff0c\u4ee5\u6b64\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u6c34\u7f8a\u7fb9\u3002\n\n+ JOI \u541b\u6311\u9009\u51fa\u539f\u6c34\u7f8a\u7fb9\u4e2d\u4ece\u7b2c $A_j$ \u6761\u5207\u5272\u7ebf\u5230\u7b2c $B_j$ \u6761\u5207\u5272\u7ebf\u4e4b\u95f4\u7684\u90e8\u5206\uff0c\u4f5c\u4e3a\u8336\u4f1a\u4e2d\u7684\u6c34\u7f8a\u7fb9\u3002\u5269\u4f59\u90e8\u5206\u88ab\u4ed6\u81ea\u5df1\u5403\u6389\u3002\n\n+ JOI \u541b\u9700\u5c06\u6240\u9009\u5c0f\u7247\u6cbf\u7740\u4e00\u4e9b\u5207\u5272\u7ebf\u5206\u5272\u6210\u82e5\u5e72\u6bb5\u8ba9\u670b\u53cb\u54c1\u5c1d\u3002\u5728\u8fd9\u4e00\u8fc7\u7a0b\u4e2d\u5e94\u5f53\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\uff1a\u5982\u679c\u6309\u987a\u5e8f\u6392\u5217\uff0c\u5206\u5272\u540e\u6bcf\u4e2a\u5c0f\u7247\u957f\u5ea6\u7684\u5927\u5c0f\u5e94\u5f53\u662f\u4e00\u4e2a\u201c\u4e4b\u201d\u5b57\u5f62\uff0c\u5373\u8fde\u7eed\u4e24\u4e2a\u7247\u6bb5\u957f\u5ea6\u5148\u9012\u589e\u518d\u9012\u51cf\uff0c\u4ea6\u6216\u8005\u5148\u9012\u51cf\u518d\u9012\u589e\u3002\n\n\u5177\u4f53\u5730\uff0c\u4ee4 $(x_1,x_2,\u2026,x_m)$ \u662f\u5206\u5272\u540e\u5c0f\u7247\u957f\u5ea6\u7ec4\u6210\u7684\u5e8f\u5217\uff0c$(x_1,x_2,\u2026,x_m)$ \u662f\u201c\u4e4b\u201d\u5b57\u5f62\u5f53\u4e14\u4ec5\u5f53\u5b83\u6ee1\u8db3\u4ee5\u4e0b\u4e00\u4e2a\u6216\u4e24\u4e2a\u6761\u4ef6\uff1a\n\n+ \u5bf9\u4e8e\u6240\u6709 $k=1,2,\u2026,m\u22121$\uff0c\u5982\u679c $k$ \u4e3a\u5947\u6570\uff0c\u5219 $x_k<x_{k+1}$\uff0c\u5426\u5219 $x_k>x_{k+1}$\u3002\n\n+ \u5bf9\u4e8e\u6240\u6709 $k=1,2,\u2026,m\u22121$\uff0c\u5982\u679c $k$ \u4e3a\u5947\u6570\uff0c\u5219 $x_k>x_{k+1}$\uff0c\u5426\u5219 $x_k<x_{k+1}$\u3002\n\n\u56e0\u4e3a JOI \u541b\u5e0c\u671b\u7ed9\u5c3d\u53ef\u80fd\u591a\u7684\u670b\u53cb\u54c1\u5c1d\u5230\u6c34\u7f8a\u7fb9\uff0c\u6240\u4ee5\u4ed6\u5e0c\u671b\u4f9b\u54c1\u7684\u5c0f\u7247\u6570\u91cf\u6700\u5927\u5316\u3002\n\n\u8bf7\u5b8c\u6210\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u5b83\u4f1a\u8bfb\u5165\u6c34\u7f8a\u7fb9\u673a\u5668\u7684\u53c2\u6570\u548c\u8336\u4f1a\u8ba1\u5212\uff0c\u5e76\u5bf9\u6bcf\u4e00\u573a\u8336\u4f1a\u8f93\u51fa\u53ef\u4f9b\u54c1\u5c1d\u7684\u5c0f\u7247\u7684\u6700\u5927\u6570\u91cf\u3002\u8bf7\u6ce8\u610f\uff0c\u5728\u4efb\u52a1\u7684\u9650\u5236\u4e0b\uff0c\u53ef\u4ee5\u603b\u662f\u627e\u5230\u4e00\u79cd\u5408\u9002\u7684\u65b9\u6cd5\u5c06\u6240\u9009\u5c0f\u7247\u5206\u5272\u6210\u7b26\u5408\u201c\u4e4b\u201d\u5b57\u5f62\u6761\u4ef6\u7684\u82e5\u5e72\u5c0f\u7247\u3002\n\n#### \u8f93\u5165\u683c\u5f0f\n\n\u4ece\u6807\u51c6\u8f93\u5165\u4e2d\u8bfb\u5165\u4ee5\u4e0b\u6570\u636e\uff1a\n\n> $N$\n>\n> $L_1 \\ L_2 \\ \\cdots \\ L_N$\n>\n> $Q$\n>\n> $X_1 \\ Y_1 \\ A_1 \\ B_1$\n>\n> $X_2 \\ Y_2 \\ A_2 \\ B_2$\n>\n> $\\vdots$\n>\n> $X_Q \\ Y_Q \\ A_Q \\ B_Q$\n\n#### \u8f93\u51fa\u683c\u5f0f\n\n\u7a0b\u5e8f\u5e94\u8be5\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u8f93\u51fa $Q$ \u884c\u3002\u7b2c $j$ \u884c $(1\u2264j\u2264Q)$ \u5e94\u5f53\u5305\u542b\u7b2c $j$ \u573a\u8336\u4f1a\u4e2d\u7684\u6240\u9009\u5c0f\u7247\u7684\u6700\u5927\u6570\u91cf\u3002\n\nTranslate by @[ZeXic_B](https://www.luogu.com.cn/user/661274)"
}
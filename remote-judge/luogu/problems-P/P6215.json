{
    "description": "\u6709\u4e24\u4e2a\u957f\u5ea6\u5747\u4e3a $n$ \u7684\u6743\u503c\u5e8f\u5217 $a,b$\uff0c\u5e38\u6570 $p,k$\uff0c\u4ee5\u53ca\u4e24\u4e2a\u51fd\u6570\uff1a\n\n$$g(x) = \\sum_{i=1}^x p^i \\times a_i$$\n\n$$f(x) = \\sum_{i=1}^x g(i) ^ k \\times b_i$$\n\n\u6709 $m$ \u4e2a\u64cd\u4f5c\uff0c\u64cd\u4f5c\u6709\u4ee5\u4e0b\u4e09\u79cd\uff1a\n\n*  $1\\ x\\ y$\uff0c\u8868\u793a\u5c06 $a_x$ \u4fee\u6539\u4e3a $y$\u3002\n\n*  $2\\ x\\ y$\uff0c\u8868\u793a\u5c06 $b_x$ \u4fee\u6539\u4e3a $y$\u3002\n\n*  $3\\ x$\uff0c\u8868\u793a\u67e5\u8be2 $f(x)$ \u5bf9 $10 ^ 9 + 7$ \u53d6\u6a21\u7684\u503c\u3002",
    "inputFormat": "\u7b2c\u4e00\u884c\u56db\u4e2a\u6574\u6570\uff0c$n,m,p,k$\u3002\n\n\u7b2c\u4e8c\u884c $n$ \u4e2a\u6574\u6570\uff0c\u8868\u793a\u5e8f\u5217 $a$\u3002\n\n\u7b2c\u4e09\u884c $n$ \u4e2a\u6574\u6570\uff0c\u8868\u793a\u5e8f\u5217 $b$\u3002\n\n\u63a5\u4e0b\u6765 $m$ \u884c\uff0c\u6bcf\u884c\u63cf\u8ff0\u4e00\u4e2a\u64cd\u4f5c\u3002",
    "outputFormat": "\u5bf9\u4e8e\u6bcf\u4e2a $3\\ x$ \u64cd\u4f5c\uff0c\u8f93\u51fa\u7b54\u6848\u3002",
    "samples": [
        [
            "10 10 1 1\n0 1 8 8 5 6 6 8 0 1 \n9 2 8 8 6 2 5 0 1 8 \n3 9\n1 2 3\n3 10\n3 5\n2 10 0\n3 10\n1 5 9\n2 9 7\n3 9\n3 4\n",
            "610\n1034\n390\n674\n1018\n246\n"
        ],
        [
            "10 10 873892251 2\n393158301 365328187 234823508 38818450 963771276 826653462 358628534 626503513 239326879 647251399 \n1 1 1 1 1 1 1 1 1 1 \n1 6 861625956\n1 2 300158647\n1 2 84103073\n3 8\n1 1 942644245\n1 9 883742604\n1 2 974963615\n3 5\n1 8 710319943\n3 1\n",
            "35415628\n483475596\n154061492\n"
        ],
        [
            "10 10 480345252 3\n494173949 364489100 93066339 249297520 207335443 117096873 864460454 113006173 214332928 582507765 \n5658914 222040024 221653308 296560771 594076100 151232714 410372721 23331041 374481229 184401699 \n3 6\n3 8\n1 1 931776921\n1 6 44943479\n1 6 946828878\n1 4 9046748\n3 3\n1 7 692410213\n1 10 483672045\n3 10\n",
            "214010503\n321766325\n894782746\n274293582\n"
        ]
    ],
    "hint": "**\u3010\u6837\u4f8b\u89e3\u91ca\u3011**\n\n   \u8fd9\u662f\u6837\u4f8b\u4e00\u64cd\u4f5c\u56db\u540e\u7684\u7ed3\u679c\uff1a\n\n| $/$  | $1$ | $2$ | $3$ | $4$ | $5$ |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $a_i$ | $0$ | $3$ |  $8$ | $8$ | $5$ |\n| $b_i$ | $9$ | $2$ |  $8$ | $8$ | $6$ |\n| $g(i)$ | $0$ | $3$ |  $11$ | $19$ | $24$ |\n| $f(i)$ | $0$ | $6$ |  $94$ | $246$ | $390$ |\n\n----------------------\n\n**\u3010\u6570\u636e\u8303\u56f4\u3011**\n\n- \u5bf9\u4e8e $100\\%%$ \u7684\u6570\u636e\uff1a\n\n    $1 \\le n,m \\le 2 \\times 10 ^ 5$\u3002\n\n    $0 \\le a_i,b_i,p \\le 10 ^ 9 + 6$\u3002\n\n    $1 \\le x \\le n$\uff0c$0 \\le y \\le 10 ^ 9 + 6$\u3002\n\n    $1 \\le k \\le 3$\u3002\n\n- **\u8be6\u7ec6\u7684\u6570\u636e\u8303\u56f4\uff1a**\n\n     \u6d4b\u8bd5\u70b9\u7f16\u53f7 | $n,m \\le$ | $k$ | \u7279\u6b8a\u6027\u8d28 \n     :-: | :-: | :-: | :-:\n     $1$ | $300$ | $\\le 3$ |  \u65e0\n     $2$ | $300$ | $\\le 3$ |  \u65e0\n     $3$ | $3 \\times 10 ^ 3$ | $\\le 3$ |  \u65e0\n     $4$ | $3 \\times 10 ^ 3$ | $\\le 3$ |  \u65e0\n     $5$ | $7 \\times 10 ^ 4$ | $= 1$ | A\n     $6$ | $7 \\times 10 ^ 4$ | $= 1$ |  A\n     $7$ | $7 \\times 10 ^ 4$ | $= 1$ |  A\n     $8$ | $7 \\times 10 ^ 4$ | $= 2$ |  A \n     $9$ | $7 \\times 10 ^ 4$ | $= 3$ |  A\n     $10$ | $7 \\times 10 ^ 4$ | $= 1$ |  B\n     $11$ | $7 \\times 10 ^ 4$ | $= 1$ |  B\n     $12$ | $7 \\times 10 ^ 4$ | $= 2$ | B\n     $13$ | $7 \\times 10 ^ 4$ | $= 3$ |  B\n     $14$ | $7 \\times 10 ^ 4$ | $= 3$ |  B\n     $15$ | $7 \\times 10 ^ 4$ | $= 1$ |  \u65e0\n     $16$ | $7 \\times 10 ^ 4$ | $= 2$ |  \u65e0\n     $17$ | $7 \\times 10 ^ 4$ | $= 3$ |  \u65e0\n     $18$ | $2 \\times 10 ^ 5$ | $= 1$ |  \u65e0\n     $19$ | $2 \\times 10 ^ 5$ | $= 2$ |  \u65e0\n     $20$ | $2 \\times 10 ^ 5$ | $= 3$ |  \u65e0\n\n     A\uff1a\u4efb\u610f\u65f6\u523b\u6240\u6709 $b_i = 1$\u3002\n\n     B\uff1a\u65e0\u64cd\u4f5c\u4e8c\u3002\n\n---------------------\n\n**\u3010\u63d0\u793a\u3011**\n\n\u6837\u4f8b\u4e8c\u6ee1\u8db3A\u7c7b\u6027\u8d28\uff0c\u6837\u4f8b\u4e09\u6ee1\u8db3B\u7c7b\u6027\u8d28\u3002"
}
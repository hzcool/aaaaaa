{
    "description": "\u672c\u9898\u7684\u6545\u4e8b\u53d1\u751f\u5728\u9b54\u529b\u4e4b\u90fd\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u5c06\u4e3a\u4f60\u4ecb\u7ecd\u4e00\u4e9b\u5fc5\u8981\u7684\u8bbe\u5b9a\u3002\n\n\u9b54\u529b\u4e4b\u90fd\u53ef\u4ee5\u62bd\u8c61\u6210\u4e00\u4e2a $n$ \u4e2a\u8282\u70b9\u3001$m$ \u6761\u8fb9\u7684\u65e0\u5411\u8fde\u901a\u56fe\uff08\u8282\u70b9\u7684\u7f16\u53f7\u4ece $1$ \u81f3 $n$\uff09\u3002\u6211\u4eec\u4f9d\u6b21\u7528 $l,a$ \u63cf\u8ff0\u4e00\u6761\u8fb9\u7684**\u957f\u5ea6\u3001\u6d77\u62d4**\u3002\n\n\u4f5c\u4e3a\u5b63\u98ce\u6c14\u5019\u7684\u4ee3\u8868\u57ce\u5e02\uff0c\u9b54\u529b\u4e4b\u90fd\u65f6\u5e38\u6709\u96e8\u6c34\u76f8\u4f34\uff0c\u56e0\u6b64\u9053\u8def\u79ef\u6c34\u603b\u662f\u4e0d\u53ef\u907f\u514d\u7684\u3002\u7531\u4e8e\u6574\u4e2a\u57ce\u5e02\u7684\u6392\u6c34\u7cfb\u7edf\u8fde\u901a\uff0c\u56e0\u6b64**\u6709\u79ef\u6c34\u7684\u8fb9\u4e00\u5b9a\u662f\u6d77\u62d4\u76f8\u5bf9\u6700\u4f4e\u7684\u4e00\u4e9b\u8fb9**\u3002\u6211\u4eec\u7528**\u6c34\u4f4d\u7ebf**\u6765\u63cf\u8ff0\u964d\u96e8\u7684\u7a0b\u5ea6\uff0c\u5b83\u7684\u610f\u4e49\u662f\uff1a\u6240\u6709\u6d77\u62d4**\u4e0d\u8d85\u8fc7**\u6c34\u4f4d\u7ebf\u7684\u8fb9\u90fd\u662f**\u6709\u79ef\u6c34**\u7684\u3002\n\nYazid \u662f\u4e00\u540d\u6765\u81ea\u9b54\u529b\u4e4b\u90fd\u7684 OIer\uff0c\u521a\u53c2\u52a0\u5b8c ION2018 \u7684\u4ed6\u5c06\u8e0f\u4e0a\u5f52\u7a0b\uff0c\u56de\u5230\u4ed6\u6e29\u6696\u7684\u5bb6\u3002Yazid \u7684\u5bb6\u6070\u597d\u5728\u9b54\u529b\u4e4b\u90fd\u7684 $1$ \u53f7\u8282\u70b9\u3002\u5bf9\u4e8e\u63a5\u4e0b\u6765 $Q$ \u5929\uff0c\u6bcf\u4e00\u5929 Yazid \u90fd\u4f1a\u544a\u8bc9\u4f60\u4ed6\u7684\u51fa\u53d1\u70b9 $v$ \uff0c\u4ee5\u53ca\u5f53\u5929\u7684\u6c34\u4f4d\u7ebf $p$\u3002\n\n\u6bcf\u4e00\u5929\uff0cYazid \u5728\u51fa\u53d1\u70b9\u90fd\u62e5\u6709\u4e00\u8f86\u8f66\u3002\u8fd9\u8f86\u8f66\u7531\u4e8e\u4e00\u4e9b\u6545\u969c\u4e0d\u80fd\u7ecf\u8fc7\u6709\u79ef\u6c34\u7684\u8fb9\u3002Yazid \u53ef\u4ee5\u5728\u4efb\u610f\u8282\u70b9\u4e0b\u8f66\uff0c\u8fd9\u6837\u63a5\u4e0b\u6765\u4ed6\u5c31\u53ef\u4ee5\u6b65\u884c\u7ecf\u8fc7\u6709\u79ef\u6c34\u7684\u8fb9\u3002\u4f46\u8f66\u4f1a\u88ab\u7559\u5728\u4ed6\u4e0b\u8f66\u7684\u8282\u70b9\u5e76\u4e0d\u4f1a\u518d\u88ab\u4f7f\u7528\u3002\n\u9700\u8981\u7279\u6b8a\u8bf4\u660e\u7684\u662f\uff0c\u7b2c\u4e8c\u5929\u8f66\u4f1a\u88ab\u91cd\u7f6e\uff0c\u8fd9\u610f\u5473\u7740\uff1a\n- \u8f66\u4f1a\u5728\u65b0\u7684\u51fa\u53d1\u70b9\u88ab\u51c6\u5907\u597d\u3002\n- Yazid \u4e0d\u80fd\u5229\u7528\u4e4b\u524d\u5728\u67d0\u5904\u505c\u653e\u7684\u8f66\u3002\n\nYazid \u975e\u5e38\u8ba8\u538c\u5728\u96e8\u5929\u6b65\u884c\uff0c\u56e0\u6b64\u4ed6\u5e0c\u671b\u5728\u5b8c\u6210\u56de\u5bb6\u8fd9\u4e00\u76ee\u6807\u7684\u540c\u65f6\uff0c\u6700\u5c0f\u5316\u4ed6**\u6b65\u884c\u7ecf\u8fc7\u7684\u8fb9**\u7684\u603b\u957f\u5ea6\u3002\u8bf7\u4f60\u5e2e\u52a9 Yazid \u8fdb\u884c\u8ba1\u7b97\u3002\n\n\u672c\u9898\u7684\u90e8\u5206\u6d4b\u8bd5\u70b9\u5c06\u5f3a\u5236\u5728\u7ebf\uff0c\u5177\u4f53\u7ec6\u8282\u8bf7\u89c1\u3010\u8f93\u5165\u683c\u5f0f\u3011\u548c\u3010\u5b50\u4efb\u52a1\u3011\u3002",
    "inputFormat": "\u5355\u4e2a\u6d4b\u8bd5\u70b9\u4e2d\u5305\u542b\u591a\u7ec4\u6570\u636e\u3002\u8f93\u5165\u7684\u7b2c\u4e00\u884c\u4e3a\u4e00\u4e2a\u975e\u8d1f\u6574\u6570 $T$\uff0c\u8868\u793a\u6570\u636e\u7684\u7ec4\u6570\u3002\n\n\u63a5\u4e0b\u6765\u4f9d\u6b21\u63cf\u8ff0\u6bcf\u7ec4\u6570\u636e\uff0c\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff1a\n\n\u7b2c\u4e00\u884c $2$ \u4e2a\u975e\u8d1f\u6574\u6570 $n,m$\uff0c\u5206\u522b\u8868\u793a\u8282\u70b9\u6570\u3001\u8fb9\u6570\u3002\n\n\u63a5\u4e0b\u6765 $m$ \u884c\uff0c\u6bcf\u884c $4$ \u4e2a\u6b63\u6574\u6570 $u, v, l, a$\uff0c\u63cf\u8ff0\u4e00\u6761\u8fde\u63a5\u8282\u70b9 $u, v$ \u7684\u3001\u957f\u5ea6\u4e3a $l$\u3001\u6d77\u62d4\u4e3a $a$ \u7684\u8fb9\u3002\n\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u4fdd\u8bc1 $1 \\leq u,v \\leq n$\u3002\n\n\u63a5\u4e0b\u6765\u4e00\u884c $3$ \u4e2a\u975e\u8d1f\u6570 $Q, K, S$ \uff0c\u5176\u4e2d $Q$ \u8868\u793a\u603b\u5929\u6570\uff0c$K \\in {0,1}$ \u662f\u4e00\u4e2a\u4f1a\u5728\u4e0b\u9762\u88ab\u7528\u5230\u7684\u7cfb\u6570\uff0c$S$ \u8868\u793a\u7684\u662f\u53ef\u80fd\u7684\u6700\u9ad8\u6c34\u4f4d\u7ebf\u3002\n\n\u63a5\u4e0b\u6765 $Q$ \u884c\u4f9d\u6b21\u63cf\u8ff0\u6bcf\u5929\u7684\u72b6\u51b5\u3002\u6bcf\u884c $2$ \u4e2a\u6574\u6570 $v_0,  p_0$ \u63cf\u8ff0\u4e00\u5929\uff1a\n- \u8fd9\u4e00\u5929\u7684\u51fa\u53d1\u8282\u70b9\u4e3a $v = (v_0 + K \\times \\mathrm{lastans} - 1) \\bmod n + 1$\u3002    \n- \u8fd9\u4e00\u5929\u7684\u6c34\u4f4d\u7ebf\u4e3a $p = (p_0 + K \\times \\mathrm{lastans}) \\bmod (S + 1)$\u3002    \n\n\u5176\u4e2d $\\mathrm{lastans}$ \u8868\u793a\u4e0a\u4e00\u5929\u7684\u7b54\u6848\uff08\u6700\u5c0f\u6b65\u884c\u603b\u8def\u7a0b\uff09\u3002\u7279\u522b\u5730\uff0c\u6211\u4eec\u89c4\u5b9a\u7b2c $1$ \u5929\u65f6 $\\mathrm{lastans} = 0$\u3002 \n\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u4fdd\u8bc1 $1 \\leq v_0 \\leq n$\uff0c$0 \\leq p_0 \\leq S$\u3002\n\n\u5bf9\u4e8e\u8f93\u5165\u4e2d\u7684\u6bcf\u4e00\u884c\uff0c\u5982\u679c\u8be5\u884c\u5305\u542b\u591a\u4e2a\u6570\uff0c\u5219\u7528\u5355\u4e2a\u7a7a\u683c\u5c06\u5b83\u4eec\u9694\u5f00\u3002",
    "outputFormat": "\u4f9d\u6b21\u8f93\u51fa\u5404\u7ec4\u6570\u636e\u7684\u7b54\u6848\u3002\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff1a\n\n- \u8f93\u51fa $Q$ \u884c\u6bcf\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u4f9d\u6b21\u8868\u793a\u6bcf\u5929\u7684\u6700\u5c0f\u6b65\u884c\u603b\u8def\u7a0b\u3002",
    "samples": [
        [
            "1\n4 3\n1 2 50 1\n2 3 100 2\n3 4 50 1\n5 0 2\n3 0\n2 1\n4 1\n3 1\n3 2",
            "0\n50\n200\n50\n150"
        ],
        [
            "1\n5 5\n1 2 1 2\n2 3 1 2\n4 3 1 2\n5 3 1 2\n1 5 2 1\n4 1 3\n5 1\n5 2\n2 0\n4 0",
            "0\n2\n3\n1"
        ]
    ],
    "hint": "### \u66f4\u591a\u6837\u4f8b\n\n\u66f4\u591a\u6837\u4f8b\u8bf7\u5728\u9644\u52a0\u6587\u4ef6\u4e2d\u4e0b\u8f7d\u3002\n\n#### \u6837\u4f8b 3\n\n\u89c1\u9644\u52a0\u6587\u4ef6\u4e2d\u7684 `return3.in` \u4e0e `return3.ans`\u3002\n\n\u8be5\u6837\u4f8b\u6ee1\u8db3\u6d77\u62d4\u4e3a\u4e00\u79cd\uff0c\u4e14\u4e0d\u5f3a\u5236\u5728\u7ebf\u3002\n\n#### \u6837\u4f8b 4\n\n\u89c1\u9644\u52a0\u6587\u4ef6\u4e2d\u7684 `return4.in` \u4e0e `return4.ans`\u3002\n\n\u8be5\u6837\u4f8b\u6ee1\u8db3\u56fe\u5f62\u6001\u4e3a\u4e00\u6761\u94fe\uff0c\u4e14\u5f3a\u5236\u5728\u7ebf\u3002\n\n#### \u6837\u4f8b 5\n\n\u89c1\u9644\u52a0\u6587\u4ef6\u4e2d\u7684 `return5.in` \u4e0e `return5.ans`\u3002\n\n\u8be5\u6837\u4f8b\u6ee1\u8db3\u4e0d\u5f3a\u5236\u5728\u7ebf\u3002\n\n### \u6837\u4f8b 1 \u89e3\u91ca\n\n\u7b2c\u4e00\u5929\u6ca1\u6709\u964d\u6c34\uff0cYazid \u53ef\u4ee5\u5750\u8f66\u76f4\u63a5\u56de\u5230\u5bb6\u4e2d\u3002\n\n\u7b2c\u4e8c\u5929\u3001\u7b2c\u4e09\u5929\u3001\u7b2c\u56db\u5929\u7684\u79ef\u6c34\u60c5\u51b5\u76f8\u540c\uff0c\u5747\u4e3a\u8fde\u63a5 1\uff0c2 \u53f7\u8282\u70b9\u7684\u8fb9\u3001\u8fde\u63a5 3\uff0c4 \u53f7\u70b9\u7684\u8fb9\u6709\u79ef\u6c34\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u5929\uff0cYazid \u4ece 2 \u53f7\u70b9\u51fa\u53d1\u5750\u8f66\u53ea\u80fd\u53bb\u5f80 3 \u53f7\u8282\u70b9\uff0c\u5bf9\u56de\u5bb6\u6ca1\u6709\u5e2e\u52a9\u3002\u56e0\u6b64 Yazid \u53ea\u80fd\u7eaf\u9760\u5f92\u6b65\u56de\u5bb6\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e09\u5929\uff0c\u4ece 4 \u53f7\u8282\u70b9\u51fa\u53d1\u7684\u552f\u4e00\u4e00\u6761\u8fb9\u662f\u6709\u79ef\u6c34\u7684\uff0c\u8f66\u4e5f\u5c31\u53d8\u5f97\u65e0\u7528\u4e86\u3002Yazid \u53ea\u80fd\u7eaf\u9760\u5f92\u6b65\u56de\u5bb6\u3002\n\n\u5bf9\u4e8e\u7b2c\u56db\u5929\uff0cYazid \u53ef\u4ee5\u5750\u8f66\u5148\u5230\u8fbe 2 \u53f7\u8282\u70b9\uff0c\u518d\u6b65\u884c\u56de\u5bb6\u3002\n\n\u7b2c\u4e94\u5929\u6240\u6709\u7684\u8fb9\u90fd\u79ef\u6c34\u4e86\uff0c\u56e0\u6b64 Yazid \u53ea\u80fd\u7eaf\u9760\u5f92\u6b65\u56de\u5bb6\u3002\n\n### \u6837\u4f8b 2 \u89e3\u91ca\n\n\u672c\u7ec4\u6570\u636e\u5f3a\u5236\u5728\u7ebf\u3002\n\n\u7b2c\u4e00\u5929\u7684\u7b54\u6848\u662f $0$\uff0c\u56e0\u6b64\u7b2c\u4e8c\u5929\u7684 $v=\\left( 5+0-1\\right)\\bmod 5+1=5$\uff0c$p=\\left(2+0\\right)\\bmod\\left(3+1\\right)=2$\u3002\n\n\u7b2c\u4e8c\u5929\u7684\u7b54\u6848\u662f $2$\uff0c\u56e0\u6b64\u7b2c\u4e09\u5929\u7684 $v=\\left( 2+2-1\\right)\\bmod 5+1=4$\uff0c$p=\\left(0+2\\right)\\bmod\\left(3+1\\right)=2$\u3002\n\n\u7b2c\u4e09\u5929\u7684\u7b54\u6848\u662f $3$\uff0c\u56e0\u6b64\u7b2c\u56db\u5929\u7684 $v=\\left( 4+3-1\\right)\\bmod 5+1=2$\uff0c$p=\\left(0+3\\right)\\bmod\\left(3+1\\right)=3$\u3002\n\n### \u6570\u636e\u8303\u56f4\u4e0e\u7ea6\u5b9a\n\n\u6240\u6709\u6d4b\u8bd5\u70b9\u5747\u4fdd\u8bc1 $T\\leq 3$\uff0c\u6240\u6709\u6d4b\u8bd5\u70b9\u4e2d\u7684\u6240\u6709\u6570\u636e\u5747\u6ee1\u8db3\u5982\u4e0b\u9650\u5236\uff1a\n\n- $n\\leq 2\\times 10^5$\uff0c$m\\leq 4\\times 10^5$\uff0c$Q\\leq 4\\times 10^5$\uff0c$K\\in\\left\\{0,1\\right\\}$\uff0c$1\\leq S\\leq 10^9$\u3002\n- \u5bf9\u4e8e\u6240\u6709\u8fb9\uff1a$l\\leq 10^4$\uff0c$a\\leq 10^9$\u3002\n- \u4efb\u610f\u4e24\u70b9\u4e4b\u95f4\u90fd\u76f4\u63a5\u6216\u95f4\u63a5\u901a\u8fc7\u8fb9\u76f8\u8fde\u3002\n\n**\u4e3a\u4e86\u65b9\u4fbf\u4f60\u5feb\u901f\u7406\u89e3\uff0c\u6211\u4eec\u5728\u8868\u683c\u4e2d\u4f7f\u7528\u4e86\u4e00\u4e9b\u7b80\u5355\u6613\u61c2\u7684\u8868\u8ff0\u3002\u5728\u6b64\uff0c\u6211\u4eec\u5bf9\u8fd9\u4e9b\u5185\u5bb9\u4f5c\u5f62\u5f0f\u5316\u7684\u8bf4\u660e\uff1a**\n\n- \u56fe\u5f62\u6001\uff1a\u5bf9\u4e8e\u8868\u683c\u4e2d\u8be5\u9879\u4e3a \u201c\u4e00\u68f5\u6811\u201d \u6216 \u201c\u4e00\u6761\u94fe\u201d \u7684\u6d4b\u8bd5\u70b9\uff0c\u4fdd\u8bc1 $m = n-1$\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd9\u4e24\u7c7b\u6d4b\u8bd5\u70b9\u5206\u522b\u6ee1\u8db3\u5982\u4e0b\u9650\u5236\uff1a\n  - \u4e00\u68f5\u6811\uff1a\u4fdd\u8bc1\u8f93\u5165\u7684\u56fe\u662f\u4e00\u68f5\u6811\uff0c\u5373\u4fdd\u8bc1\u8fb9\u4e0d\u4f1a\u6784\u6210\u56de\u8def\u3002\n  - \u4e00\u6761\u94fe\uff1a\u4fdd\u8bc1\u6240\u6709\u8fb9\u6ee1\u8db3 $u + 1 = v$\u3002\n- \u6d77\u62d4\uff1a\u5bf9\u4e8e\u8868\u683c\u4e2d\u8be5\u9879\u4e3a \u201c\u4e00\u79cd\u201d \u7684\u6d4b\u8bd5\u70b9\uff0c\u4fdd\u8bc1\u5bf9\u4e8e\u6240\u6709\u8fb9\u6709 $a = 1$\u3002\n- \u5f3a\u5236\u5728\u7ebf\uff1a\u5bf9\u4e8e\u8868\u683c\u4e2d\u8be5\u9879\u4e3a \u201c\u662f\u201d \u7684\u6d4b\u8bd5\u70b9\uff0c\u4fdd\u8bc1 $K = 1$\uff1b\u5982\u679c\u8be5\u9879\u4e3a \u201c\u5426\u201d\uff0c\u5219\u6709 $K = 0$\u3002\n- \u5bf9\u4e8e\u6240\u6709\u6d4b\u8bd5\u70b9\uff0c\u5982\u679c\u4e0a\u8ff0\u5bf9\u5e94\u9879\u4e3a \u201c\u4e0d\u4fdd\u8bc1\u201d\uff0c\u5219\u5bf9\u8be5\u9879\u5185\u5bb9\u4e0d\u4f5c\u4efb\u4f55\u4fdd\u8bc1\u3002\n\n$n$|$m$|$Q=$|\u6d4b\u8bd5\u70b9|\u5f62\u6001|\u6d77\u62d4|\u5f3a\u5236\u5728\u7ebf\n-|-|-|-|-|-|-\n$\\leq 1$|$\\leq 0$|$0$|1|\u4e0d\u4fdd\u8bc1|\u4e00\u79cd|\u5426\n$\\leq 6$|$\\leq 10$|$10$|2|\u4e0d\u4fdd\u8bc1|\u4e00\u79cd|\u5426\n$\\leq 50$|$\\leq 150$|$100$|3|\u4e0d\u4fdd\u8bc1|\u4e00\u79cd|\u5426\n$\\leq 100$|$\\leq 300$|$200$|4|\u4e0d\u4fdd\u8bc1|\u4e00\u79cd|\u5426\n$\\leq 1500$|$\\leq 4000$|$2000$|5|\u4e0d\u4fdd\u8bc1|\u4e00\u79cd|\u5426\n$\\leq 200000$|$\\leq 400000$|$100000$|6|\u4e0d\u4fdd\u8bc1|\u4e00\u79cd|\u5426\n$\\leq 1500$|$=n-1$|$2000$|7|\u4e00\u6761\u94fe|\u4e0d\u4fdd\u8bc1|\u5426\n$\\leq 1500$|$=n-1$|$2000$|8|\u4e00\u6761\u94fe|\u4e0d\u4fdd\u8bc1|\u5426\n$\\leq 1500$|$=n-1$|$2000$|9|\u4e00\u6761\u94fe|\u4e0d\u4fdd\u8bc1|\u5426\n$\\leq 200000$|$=n-1$|$100000$|10|\u4e00\u68f5\u6811|\u4e0d\u4fdd\u8bc1|\u5426\n$\\leq 200000$|$=n-1$|$100000$|11|\u4e00\u68f5\u6811|\u4e0d\u4fdd\u8bc1|\u662f\n$\\leq 200000$|$\\leq 400000$|$100000$|12|\u4e0d\u4fdd\u8bc1|\u4e0d\u4fdd\u8bc1|\u5426\n$\\leq 200000$|$\\leq 400000$|$100000$|13|\u4e0d\u4fdd\u8bc1|\u4e0d\u4fdd\u8bc1|\u5426\n$\\leq 200000$|$\\leq 400000$|$100000$|14|\u4e0d\u4fdd\u8bc1|\u4e0d\u4fdd\u8bc1|\u5426\n$\\leq 1500$|$\\leq 4000$|$2000$|15|\u4e0d\u4fdd\u8bc1|\u4e0d\u4fdd\u8bc1|\u662f\n$\\leq 1500$|$\\leq 4000$|$2000$|16|\u4e0d\u4fdd\u8bc1|\u4e0d\u4fdd\u8bc1|\u662f\n$\\leq 200000$|$\\leq 400000$|$100000$|17|\u4e0d\u4fdd\u8bc1|\u4e0d\u4fdd\u8bc1|\u662f\n$\\leq 200000$|$\\leq 400000$|$100000$|18|\u4e0d\u4fdd\u8bc1|\u4e0d\u4fdd\u8bc1|\u662f\n$\\leq 200000$|$\\leq 400000$|$400000$|19|\u4e0d\u4fdd\u8bc1|\u4e0d\u4fdd\u8bc1|\u662f\n$\\leq 200000$|$\\leq 400000$|$400000$|20|\u4e0d\u4fdd\u8bc1|\u4e0d\u4fdd\u8bc1|\u662f\n"
}
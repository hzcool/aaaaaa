{
    "description": "\n\nNEERC had featured a number of problems in previous years about cactuses -- connected undirected graphs in which every edge belongs to at most one simple cycle. Intuitively, cactus is a generalization of a tree where some cycles are allowed.\n\nIn $2005$ , the first year where problems about cactuses had appeared, the problem was called simply `Cactus`. In $2007$ it was `Cactus Reloaded` and in $2010$ it was called `Cactus Revolution`. An example of cactus from NEERC $2007$ problem is given on the picture below.\n\n![](/upload/images2/cac.png)\n\nThe challenge that judges face when preparing test cases for those problems is that some wrong solutions may depend on the numbering of vertices in the input file. So, for the most interesting test cases judges typically include several inputs with the same graph, but having a different numbering of vertices. However, some graphs are so regular that the graph remains the same even if you renumber its vertices. Judges need some metric about the graph that tells how regular the given graph is in order to make an objective decision about the number of test cases that need to be created for this graph.\n\nThe metric you have to compute is the number of graph automorphisms. Given an undirected graph $(V , E)$ , where $V$ is a set of vertices and $E$ is a set of edges, where each edge is a set of two distinct vertices ${v_{1}, v_{2}} (v_{1}, v_{2} \u2208 V ),$ graph automorphism is a bijection $m$ from $V$ onto $V$ , such that for each pair of vertices $v_{1}$ and $v_{2}$ that are connected by an edge (so ${v_{1}, v_{2}} \u2208 E)$ the following condition holds: ${m(v_{1}), m(v_{2})} \u2208 E$ .\n\nEach graph has at least one automorphism (one where $m$ is an identity function) and may have up to $n$ ! automorphisms for a graph with $n$ vertices. Because the number of automorphisms may be a very big number, the answer must be presented as a prime factorization $\u220f^{k}_{i=1} p_{i}^{q_{i}},$ where $p_{i}$ are prime numbers in ascending order $(p_{i} \\ge 2 , p_{i} 0)$ .\n\n",
    "inputFormat": "\n\nThe first line of the input file contains two integer numbers $n$ and $m (1 \\le n \\le 50 000 , 0 \\le m \\le 50 000)$ . Here $n$ is the number of vertices in the graph. Vertices are numbered from $1$ to $n$ . Edges of the graph are represented by a set of edge-distinct paths, where $m$ is the number of such paths.\n\nEach of the following $m$ lines contains a path in the graph. A path starts with an integer number $k_{i} (2 \\le k_{i} \\le 1000)$ followed by $k_{i}$ integers from $1$ to $n$ . These $k_{i}$ integers represent vertices of a path. Adjacent vertices in a path are distinct. Path can go to the same vertex multiple times, but every edge is traversed exactly once in the whole input file. There are no multiedges in the graph (there is at most one edge between any two vertices).\n\nThe graph in the input file is a cactus.\n\n",
    "outputFormat": "\n\nOn the first line of the output file write number $k$ -- the number of prime factors in the factorization of the number of graph automorphisms. Write $0$ if the number of graph automorphisms is $1$ . On the following $k$ lines write prime numbers $p_{i}$ and their powers $q_i$ separated by a space. Prime numbers must be given in ascending order.\n\n",
    "samples": [
        [
            "15 3\n9 1 2 3 4 5 6 7 8 3\n7 2 9 10 11 12 13 10\n5 2 14 9 15 10\n",
            "1\n2 2\n"
        ],
        [
            "2 1\n2 1 2\n",
            "1\n2 1\n"
        ],
        [
            "15 7\n3 1 2 3\n3 4 2 5\n3 6 2 7\n3 8 2 9\n3 10 2 11\n3 12 2 13\n3 14 2 15\n",
            "6\n2 11\n3 5\n5 2\n7 2\n11 1\n13 1\n"
        ]
    ],
    "hint": "Time limit: 5 s, Memory limit: 256 MB. \n\n",
    "translation": "- **\u4ed9\u4eba\u638c**\u662f\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\u7684\u65e0\u5411\u7b80\u5355\u8fde\u901a\u56fe\uff1a\u6bcf\u6761\u8fb9\u88ab\u5305\u542b\u4e8e\u81f3\u591a\u4e00\u4e2a\u7b80\u5355\u73af\u4e2d\u3002\n- \u8bbe\u6709\u65e0\u5411\u56fe $G=(V,E)$\u3002\u79f0\u53cc\u5c04 $f:V\\rightarrow V$ \u662f $G$ \u7684**\u81ea\u540c\u6784**\uff0c\u5f53\u4e14\u4ec5\u5f53 $\\forall v_1,v_2\\in V$\uff0c\u90fd\u6709 $(v_1,v_2)\\in E\\Leftrightarrow (f(v_1),f(v_2))\\in E$\u3002\u79f0\u4e24\u4e2a\u81ea\u540c\u6784 $f_1,f_2$ \u76f8\u540c\uff0c\u5f53\u4e14\u4ec5\u5f53 $\\forall v\\in V$ \u5747\u6709 $f_1(v)=f_2(v)$\u3002\n- \u7ed9\u5b9a\u6709 $n$ \u4e2a\u8282\u70b9\u7684\u4ed9\u4eba\u638c\uff0c\u6c42\u5b83\u7684\u4e0d\u540c\u7684\u81ea\u540c\u6784\u6570\u3002\u7531\u4e8e\u7ed3\u679c\u53ef\u80fd\u5f88\u5927\uff0c\u4f60\u9700\u8981\u8f93\u51fa\u5b83\u7684\u8d28\u56e0\u5b50\u5206\u89e3\u7684\u7ed3\u679c\u3002\n- \u8f93\u5165\u4ed9\u4eba\u638c\u7684\u65b9\u5f0f\u4e3a\uff1a\u7ed9\u5b9a $m$ \u6761\u8def\u5f84\uff0c\u8fd9\u4e9b\u8def\u5f84\u6240\u8986\u76d6\u7684\u8fb9\u5373\u4e3a\u4ed9\u4eba\u638c\u7684\u5168\u90e8\u8fb9\u3002\u4fdd\u8bc1\u8fd9\u4e9b\u8def\u5f84\u4e0d\u4f1a\u91cd\u590d\u7ecf\u8fc7\u4e00\u6761\u8fb9\u4e24\u6b21\uff0c\u4e14\u8f93\u5165\u7684\u56fe\u662f\u4ed9\u4eba\u638c\u3002\n- $n,m\\leq 5\\times 10^4$\u3002"
}
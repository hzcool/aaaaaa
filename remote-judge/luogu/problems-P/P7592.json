{
    "description": "\u5b9a\u4e49\u4e00\u68f5\u6811 $\\mathcal T$ \u4e3a $k_1-k_2$ \u53c9\u6811\uff0c\u5f53\u4e14\u4ec5\u5f53\u6bcf\u4e2a\u8282\u70b9 $p\\in \\mathcal T$ \u6709\u513f\u5b50\uff0c\u8981\u4e48\u6709 $k_1$ \u4e2a\u513f\u5b50\uff0c\u8981\u4e48\u6709 $k_2$ \u4e2a\u513f\u5b50\uff0c$k_1 \\ne k_2$\u3002\u6211\u4eec\u5b9a\u4e49\u4e24\u68f5 $k_1-k_2$ \u6811\u540c\u6784\uff0c\u5f53\u4e14\u4ec5\u5f53\u4ee5\u4e0b\u4f2a\u4ee3\u7801\u8fd4\u56de\u7684\u5b57\u7b26\u4e32\u76f8\u540c\uff1a\n$$\n\\begin{array}{ll}\n1 &  \\textbf{Input. } \\text{The edges of the tree } \\mathcal T  \\\\\n2 &  \\textbf{Output. } \\text{The eigenvalue of tree } \\mathcal T.\\\\\n3 &  \\textbf{Algorithm. }  \\text{dfs}(u)\\\\\n4 &  \\qquad result \\gets \\texttt{'('} \\\\\n5 &  \\qquad \\textbf{for} \\text{ each } (u, v) \\text{ in the  } \\mathcal T \\\\\n6 &  \\qquad \\qquad \\textbf{if }  v \\text{ is not the father of  } u \\\\\n7 &  \\qquad \\qquad\\qquad  result \\gets result\\  +\\ \\mathrm{dfs}(v) \\\\\n8 &  \\qquad result\\gets result\\ +\\ \\texttt{')'} \\\\\n9 & \\qquad \\textbf{return }  result \\\\\n10 & \\textbf{Method. } \\text{check}(\\mathcal T) \\\\\n11 & \\qquad \\textbf{return } \\text{dfs(the root of the tree } \\mathcal T\\text{)}\n\\end{array}\n$$\n\n\u5f62\u5f0f\u5316\u5730\uff0c$k_1-k_2$ \u53c9\u6811\u6709**\u786e\u5b9a\u7684\u6839\u8282\u70b9**\uff0c\u6bcf\u4e2a\u8282\u70b9\u7684\u82e5\u5e72\u513f\u5b50\u4e4b\u95f4**\u6709\u987a\u5e8f**\uff0c\u4f46\u662f\u8282\u70b9**\u6ca1\u6709\u6807\u53f7**\u3002\n\n\u82e5 $k_1-k_2$ \u53c9\u6811 $\\mathcal T$ \u6709\u4e00\u4e2a $k_1$ \u53c9\u8282\u70b9\uff0c\u5219\u5f97\u5206 $a$\uff0c\u82e5\u6709\u4e00\u4e2a $k_2$ \u53c9\u8282\u70b9\uff0c\u5219\u5f97\u5206 $b$\uff0c\u53f6\u8282\u70b9\u65e0\u5f97\u5206\u3002\u5b9a\u4e49\u4e00\u68f5\u6811\u7684\u5f97\u5206\u4e3a\u5176\u6240\u6709\u8282\u70b9\u7684\u5f97\u5206\u4e4b\u548c\uff0c\u8bb0\u4e3a $v(\\mathcal T)$\u3002\n\n\u73b0\u5728\u6211\u4eec\u5728\u6240\u6709\u4e92\u4e0d\u540c\u6784\u7684 $n$ \u4e2a\u8282\u70b9\u7684 $k_1-k_2$ \u53c9\u6811\u4e2d\u7b49\u6982\u7387\u968f\u673a\u751f\u6210\u4e00\u68f5 $\\mathcal T$\uff0c\u8bb0 $v(\\mathcal T)$ \u7684\u671f\u671b\u503c\u4e3a $\\mathbb{E}(v(\\mathcal T))$\u3002\n\n\u53ef\u4ee5\u8bc1\u660e $\\mathbb{E}(v(\\mathcal T))$ \u4e3a\u6709\u7406\u6570\u3002\u5f53 $\\mathbb{E}(v(\\mathcal T))$ \u4e0d\u4e3a\u96f6\u65f6\uff0c\u4ee4\u7b54\u6848 $\\mathbb{E}(v(\\mathcal T)) = p/q$\uff0c\u5176\u4e2d $p$ \u4e0e $q$ \u4e92\u8d28\u3002\u4f60\u9700\u8981\u8f93\u51fa\u6700\u5c0f\u7684\u81ea\u7136\u6570 $x$ \u4f7f\u5f97 $p\\equiv qx\\pmod P$\uff0c\u5176\u4e2d $P=998244353$\uff0c\u53ef\u4ee5\u8bc1\u660e\u8fd9\u6837\u7684\u81ea\u7136\u6570 $x$ \u5fc5\u5b9a\u5b58\u5728\u3002",
    "inputFormat": "\u8f93\u5165\u5305\u542b\u4e94\u4e2a\u6574\u6570 $k_1,\\ k_2,\\ n,\\ a,\\ b$\uff0c\u5176\u542b\u4e49\u5982\u9898\u76ee\u63cf\u8ff0\u6240\u793a\u3002",
    "outputFormat": "\u8f93\u51fa\u4e00\u4e2a\u6574\u6570 $x$\uff0c\u8868\u793a\u65b9\u7a0b $p\\equiv qx\\pmod P$ \u7684\u6700\u5c0f\u81ea\u7136\u6570\u89e3\uff0c\u5176\u4e2d $P=998244353$\u3002",
    "samples": [
        [
            "2 3 6 1 2",
            "3"
        ]
    ],
    "hint": "**\u6837\u4f8b\u8bf4\u660e**\n\n\u5177\u6709 $6$ \u4e2a\u7ed3\u70b9\u7684\u4e0d\u540c\u6784 $2-3$ \u53c9\u6811\u5171\u6709 $5$ \u68f5\uff0c\u6bcf\u68f5\u5f97\u5206\u5747\u4e3a $3$ \u5206\uff0c\u5219 $\\mathbb{E}(v(\\mathcal T))=15/5=3$\uff0c\u6545 $p=3$ \u4e14 $q=1$\uff0c\u5219 $x=3$\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nqywy0df.png)\n\n------------\n\n**\u6570\u636e\u8303\u56f4**\n\n\u5171 $10$ \u4e2a\u6d4b\u8bd5\u70b9\u3002\n\n\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 $1$\uff0c\u6ee1\u8db3 $1 \\le k_1,\\ k_2<n\\leq 10$\u3002\n\n\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 $2$\uff0c\u6ee1\u8db3 $1 \\le k_1,\\ k_2<n\\leq 15$\u3002\n\n\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 $3\\sim 4$\uff0c\u6ee1\u8db3 $1 \\le k_1,\\ k_2<n\\leq 5 \\times 10^3$\u3002\n\n\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 $5\\sim 6$\uff0c\u6ee1\u8db3 $a=b=1,\\ 1 \\le k_1,\\ k_2<n\\leq 10^5$\u3002\n\n\u5bf9\u4e8e $100\\%$ \u7684\u6570\u636e\uff0c\u6ee1\u8db3 $1 \\le k_1,\\ k_2<n\\leq 10^7,\\ k_1 \\ne k_2, \\ k_1+k_2 \\le n, \\  \\ 1 \\le \\ a,\\ b\\leq 10^7$\u3002\n\n\n------------\n\n**\u7ea6\u5b9a**\n\n- \u6d4b\u8bd5\u6570\u636e\u4fdd\u8bc1 $\\mathbb{E}(v(\\mathcal T))$ \u4e0d\u4e3a\u96f6\u3002\n"
}
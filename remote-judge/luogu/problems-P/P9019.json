{
    "description": "**Note: The time limit for this problem is 4s, twice the default. The memory limit for this problem is 512MB, twice the default.**\n\nFarmer John has $N\n(2 \\le N \\le 2 \\cdot 10^5)$ tractors, where the $i$-th tractor can only be used within the inclusive interval $[l_i,r_i]$. The tractor intervals have left endpoints $l_1<l_2<\\cdots <l_N$ and right endpoints $r_1<r_2< \\cdots <r_N$. Some of the tractors are special.\n\nTwo tractors $i$ and $j$ are said to be adjacent if $[l_i,r_i]$ and $[l_j,r_j]$ intersect. Farmer John can transfer from one tractor to any adjacent tractor. A path between two tractors $a$ and $b$ consists of a sequence of transfers such that the first tractor in the sequence is $a$, the last tractor in the sequence is $b$, and every two consecutive tractors in the sequence are adjacent. It is guaranteed that there is a path between tractor $1$ and tractor $N$. The length of a path is the number of transfers (or equivalently, the number of tractors within it minus one). \n\nYou are given $Q (1 \\le Q \\le 2 \\cdot 10^5)$ queries, each specifying a pair of tractors $a$ and $b (1 \\le a<b \\le N)$. For each query, output two integers: \n\n - The length of any shortest path between tractor $a$ to tractor $b$.\n - The number of special tractors such that there exists at least one shortest path from tractor $a$ to tractor $b$ containing it. ",
    "inputFormat": "The first line contains $N$ and $Q$.\n\nThe next line contains a string of length $2N$ consisting of Ls and Rs, representing the left and right endpoints in sorted order. It is guaranteed that for each proper prefix of this string, the number of Ls exceeds the number of Rs.\n\nThe next line contains a bit string of length $N$, representing for each tractor whether it is special or not.\n\nThe next $Q$ lines each contain two integers $a$ and $b$, specifying a query. ",
    "outputFormat": " For each query, the two quantities separated by spaces. ",
    "samples": [
        [
            "8 10\nLLLLRLLLLRRRRRRR\n11011010\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7\n1 8\n2 3\n2 4\n2 5",
            "1 2\n1 1\n1 2\n2 4\n2 3\n2 4\n2 3\n1 1\n1 2\n1 2"
        ]
    ],
    "hint": "### Explanation for Sample 1\n\nThe $8$ tractor intervals, in order, are $[1,5],[2,10],[3,11],[4,12],[6,13],[7,14],[8,15],[9,16]$.\n\nFor the 4th query, there are three shortest paths between the 1st and 5th tractor: $1$ to $2$ to $5$, $1$ to $3$ to $5$, and $1$ to $4$ to $5$. These shortest paths all have length $2$.\n\nAdditionally, every tractor $1,2,3,4,5$\nis part of one of the three shortest paths mentioned earlier, and since $1,2,4,5$ are special, there are $4$ special tractors such that there exists at least one shortest path from tractor $1$ to $5$ containing it. \n\n### Scoring\n\n - Inputs $2-3$: $N,Q \\le 5000$\n - Inputs $4-7$: There are at most $10$ special tractors.\n - Inputs $8-16$: No additional constraints.",
    "translation": "\u6709 $n$ \u4e2a\u533a\u95f4\uff0c\u7b2c $i$ \u4e2a\u533a\u95f4\u4e3a $[l_i,r_i]$\u3002\u4fdd\u8bc1 $l_1<l_2<\\cdots<l_n$ \u4e14 $r_1<r_2<\\cdots<r_n$\u3002\u5176\u4e2d\u4e00\u90e8\u5206\u533a\u95f4\u662f\u7279\u6b8a\u7684\uff0c\u8f93\u5165\u4f1a\u7ed9\u5b9a\u3002\n\n\u5982\u679c\u7b2c $i$ \u4e2a\u533a\u95f4\u548c\u7b2c $j$ \u4e2a\u533a\u95f4\u76f8\u4ea4\uff0c\u90a3\u4e48 $i,j$ \u4e4b\u95f4\u6709\u4e00\u6761\u8fb9\u3002\u4fdd\u8bc1 $1,n$ \u8054\u901a\u3002 \n\n\u7ed9\u5b9a $Q$ \u7ec4\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u5b9a $a,b$ \u6ee1\u8db3 $1\\le a < b\\le n$\uff0c\u4f60\u9700\u8981\u56de\u7b54 $a$ \u5230 $b$ \u81f3\u5c11\u8981\u7ecf\u8fc7\u591a\u5c11\u6761\u8fb9\uff0c\u4ee5\u53ca\u6709\u591a\u5c11\u4e2a\u7279\u6b8a\u533a\u95f4\u5bf9\u5e94\u7684\u70b9\uff0c\u4f7f\u5f97\u8fd9\u4e2a\u70b9\u53ef\u80fd\u5728 $a$ \u5230 $b$ \u7684\u6700\u77ed\u8def\u5f84\u4e0a\u3002\n\n$n,Q\\le 2\\times 10^5$\u3002"
}